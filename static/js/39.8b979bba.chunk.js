(this["webpackJsonp@jbrowse/web"]=this["webpackJsonp@jbrowse/web"]||[]).push([[39],{1720:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return q}));var n=r(86),a=r(2),c=r(82),s=r(81),i=r(11),u=r(88),o=r(89),f=r(80),d=r.n(f),p=r(905),h=r(936),l=r.n(h),b=r(117),v=r(105),g=r(126),m=r(119),y=r(436),k=r(168),j=r(79),w=r(633),O=["fields"],S=["chromStart","chromEnd","chrom"];function _(e){return e.get("thickStart")&&e.get("blockCount")&&0!==e.get("strand")}var q=function(e){Object(u.a)(r,e);var t=Object(o.a)(r);function r(){var e;Object(s.a)(this,r);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).cached=void 0,e}return Object(i.a)(r,[{key:"configurePre",value:function(){var e=Object(c.a)(d.a.mark((function e(t){var r,n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new p.BigBed({filehandle:Object(v.openLocation)(Object(j.readConfObject)(this.config,"bigBedLocation"),this.pluginManager)}),e.next=3,r.getHeader(t);case 3:return n=e.sent,a=new l.a({autoSql:n.autoSql}),e.abrupt("return",{bigbed:r,header:n,parser:a});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"configure",value:function(){var e=Object(c.a)(d.a.mark((function e(t){var r=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.cached||(this.cached=this.configurePre(t).catch((function(e){throw r.cached=void 0,e}))),e.abrupt("return",this.cached);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRefNames",value:function(){var e=Object(c.a)(d.a.mark((function e(t){var r,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.configure(t);case 2:return r=e.sent,n=r.header,e.abrupt("return",Object.keys(n.refsByName));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getHeader",value:function(){var e=Object(c.a)(d.a.mark((function e(t){var r,c,s,i,u,o,f,p;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.configure(t);case 2:return r=e.sent,c=r.parser,s=r.header,i=s.version,u=s.fileType,o=c.autoSql,f=o.fields,p=Object(a.a)(o,O),e.abrupt("return",{version:i,fileType:u,autoSql:Object(n.a)({},p),fields:Object.fromEntries(f.map((function(e){return[e.name,e.comment]})))});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getFeatures",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=e.refName,i=e.start,u=e.end,o=r.signal;return Object(g.ObservableCreate)(function(){var e=Object(c.a)(d.a.mark((function e(c){var f,p,h;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.configure(r);case 3:return f=e.sent,p=f.parser,h=f.bigbed,e.next=8,h.getFeatureStream(s,i,u,{signal:o,basesPerSpan:u-i});case 8:e.sent.pipe(Object(y.a)(),Object(k.a)((function(e){var r=p.parseLine("".concat(s,"\t").concat(e.start,"\t").concat(e.end,"\t").concat(e.rest),{uniqueId:e.uniqueId}),c=r.blockCount,i=r.blockSizes,u=r.blockStarts,o=r.chromStarts;if(c){var f=o||u||[],d=i,h=e.start;r.subfeatures=[];for(var l=0;l<c;l+=1){var b=(f[l]||0)+h,v=b+(d[l]||0);r.subfeatures.push({uniqueId:"".concat(e.uniqueId,"-").concat(l),start:b,end:v,type:"block"})}}if(void 0===e.uniqueId)throw new Error("invalid bbi feature");r.chromStart,r.chromEnd,r.chrom;var g=Object(a.a)(r,S),y=new m.a({id:"".concat(t.id,"-").concat(e.uniqueId),data:Object(n.a)(Object(n.a)({},g),{},{start:e.start,end:e.end,refName:s})});return _(y)?Object(w.a)(y):y}))).subscribe(c),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),c.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),r.signal)}},{key:"freeResources",value:function(){}}]),r}(b.BaseFeatureDataAdapter)},633:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(119);function a(e){var t=e.children(),r=e.get("thickStart"),a=e.get("thickEnd");if(!r&&!a)return e;var c=t?t.filter((function(e){return"block"===e.get("type")})).sort((function(e,t){return e.get("start")-t.get("start")})):[],s=[];c.forEach((function(t){var n=t.get("start"),c=t.get("end");if(r>=c){var i=e.get("strand")>0?"five":"three";s.push({type:"".concat(i,"_prime_UTR"),start:n,end:c})}else if(r>n&&r<c&&a>=c){var u=e.get("strand")>0?"five":"three";s.push({type:"".concat(u,"_prime_UTR"),start:n,end:r},{type:"CDS",start:r,end:c})}else if(r<=n&&a>=c)s.push({type:"CDS",start:n,end:c});else if(r>n&&r<c&&a<c){var o=e.get("strand")>0?"five":"three",f=e.get("strand")>0?"three":"five";s.push({type:"".concat(o,"_prime_UTR"),start:n,end:r},{type:"CDS",start:r,end:a},{type:"".concat(f,"_prime_UTR"),start:a,end:c})}else if(r<=n&&a>n&&a<c){var d=e.get("strand")>0?"three":"five";s.push({type:"CDS",start:n,end:a},{type:"".concat(d,"_prime_UTR"),start:a,end:c})}else if(a<=n){var p=e.get("strand")>0?"three":"five";s.push({type:"".concat(p,"_prime_UTR"),start:n,end:c})}}));var i={};return e.tags().forEach((function(t){i[t]=e.get(t)})),i.subfeatures=s,i.type="mRNA",i.uniqueId=e.id(),delete i.chromStarts,delete i.chromStart,delete i.chromEnd,delete i.chrom,delete i.blockStarts,delete i.blockSizes,delete i.blockCount,delete i.thickStart,delete i.thickEnd,new n.a({data:i,id:e.id()})}}}]);
//# sourceMappingURL=39.8b979bba.chunk.js.map