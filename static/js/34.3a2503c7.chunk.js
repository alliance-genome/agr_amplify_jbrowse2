(this["webpackJsonp@jbrowse/web"]=this["webpackJsonp@jbrowse/web"]||[]).push([[34],{1593:function(e,t,a){"use strict";var n=a(90),r=a(93);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=r(a(1)),l=(0,n(a(94)).default)(c.createElement("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"}),"Email");t.default=l},1756:function(e,t,a){"use strict";a.r(t);var n=a(86),r=a(103),c=a(83),l=a(29),s=a(2),u=a(80),o=a.n(u),i=a(1),b=a.n(i),m=a(104),p=a(1686),f=a(1638),h=a(51),E=a(814),g=a(1647),v=a(860),y=a(1636),d=a(1652),j=a(1748),k=a(82),O=a(435),w=a(1575),x=a(1675),S=a(1676),L=a(1677),T=a(1678),M=a(1642),C=a(1593),R=a.n(C),_=a(600),U=a.n(_),z=a(808),A=a.n(z);var H=function(e){var t=Object(i.useState)(null),a=Object(l.a)(t,2),n=a[0],r=a[1],s=Object(i.useState)(null),u=Object(l.a)(s,2),h=u[0],E=u[1],g=e.hub,v=g.url,y=g.longLabel,d=g.shortLabel;return Object(i.useEffect)((function(){function e(){return(e=Object(c.a)(o.a.mark((function e(){var t,a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=Object(m.openLocation)({uri:v,locationType:"UriLocation"}),e.next=4,a.readFile("utf8");case 4:t=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),E(b.a.createElement("span",null,b.a.createElement("strong",null,"Error retrieving hub")," ",e.t0.message," ",b.a.createElement("br",null),v)),e.abrupt("return");case 11:try{n=new w.HubFile(t),r(n)}catch(c){E(b.a.createElement("span",null,b.a.createElement("strong",null,"Could not parse genomes file:")," ",b.a.createElement("br",null),c.message," ",b.a.createElement("br",null),v))}case 12:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[v]),h?b.a.createElement(x.a,null,b.a.createElement(L.a,null,b.a.createElement(f.a,{color:"error"},h))):n?b.a.createElement(x.a,null,b.a.createElement(T.a,{title:d}),b.a.createElement(L.a,null,b.a.createElement("div",{__dangerouslySetInnerHTML:A.a.sanitize(y)})),b.a.createElement(S.a,null,b.a.createElement(M.a,{href:"mailto:".concat(n.get("email")),rel:"noopener noreferrer",target:"_blank",color:"secondary"},b.a.createElement(R.a,null)),n.get("descriptionUrl")?b.a.createElement(M.a,{href:new URL(n.get("descriptionUrl"),new URL(v)).href,rel:"noopener noreferrer",target:"_blank"},b.a.createElement(U.a,{color:"secondary"})):null)):b.a.createElement(p.a,{variant:"query"})},N=a(1648),F=a(1646),I=a(1633),J=a(1757),q=Object(h.a)((function(e){return{formControl:{minWidth:192,marginLeft:e.spacing(2),marginRight:e.spacing(2)}}}));var P=function(e){var t=e.selectList,a=e.selectedItem,n=e.handleSelect,r=e.label,c=e.helpText,l=q();return b.a.createElement(E.a,{className:l.formControl},b.a.createElement(F.a,null,r),b.a.createElement(J.a,{value:a,onChange:n},t.map((function(e){var t,a;return e.name&&(t=e.name,a="".concat(e.name," (").concat(e.synonyms.join(" "),")")),b.a.createElement(I.a,{key:a||e,value:t||e},a||e)}))),b.a.createElement(N.a,null,a?"":c))},B=["children"];function D(e){var t=e.status;return b.a.createElement(b.a.Fragment,null,b.a.createElement(p.a,{variant:"query"}),b.a.createElement(f.a,null,t))}function V(e){return(0,e.children)(Object(s.a)(e,B))}var W=Object(h.a)((function(e){return{hubList:{maxHeight:400,overflowY:"auto"},genomeSelector:{marginTop:e.spacing(1)}}}));t.default=function(e){var t=e.model,a=e.setModelReady,s=Object(i.useState)(null),u=Object(l.a)(s,2),p=u[0],h=u[1],w=Object(i.useState)(null),x=Object(l.a)(w,2),S=x[0],L=x[1],T=Object(i.useState)(""),M=Object(l.a)(T,2),C=M[0],R=M[1],_=Object(i.useState)(""),U=Object(l.a)(_,2),z=U[0],A=U[1],N=Object(i.useState)(new Map),F=Object(l.a)(N,2),I=F[0],J=F[1],q=Object(i.useState)(!1),B=Object(l.a)(q,2),G=B[0],Y=B[1],K=Object(i.useState)(""),Q=Object(l.a)(K,2),X=Q[0],Z=Q[1],$=W();function ee(e,t){return te.apply(this,arguments)}function te(){return(te=Object(c.a)(o.a.mark((function e(t,a){var n,c,l,s,u,i,b;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 10,n=a?new Map:new Map(I),c=Math.floor(I.size/10)+1,e.next=5,re("https://www.trackhubregistry.org/api/search",{page:c,entries_per_page:10},{body:JSON.stringify({assembly:z}),signal:t});case 5:if(!(l=e.sent)){e.next=38;break}s=Object(r.a)(l.items),e.prev=8,s.s();case 10:if((u=s.n()).done){e.next=28;break}if(!(i=u.value).hub.url.startsWith("ftp://")){e.next=16;break}i.error="JBrowse cannot add connections from FTP sources",e.next=25;break;case 16:return b=Object(m.openLocation)({uri:i.hub.url,locationType:"UriLocation"}),e.prev=17,e.next=20,b.stat();case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(17),i.error=e.t0.message;case 25:n.set(i.id,i);case 26:e.next=10;break;case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(8),s.e(e.t1);case 33:return e.prev=33,s.f(),e.finish(33);case 36:J(n),n.size===l.total_entries&&Y(!0);case 38:case"end":return e.stop()}}),e,null,[[8,30,33,36],[17,22]])})))).apply(this,arguments)}function ae(e){return ne.apply(this,arguments)}function ne(){return ne=Object(c.a)(o.a.mark((function e(t){var a,n,r,c,l=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},n=l.length>2&&void 0!==l[2]?l[2]:{},c=Object.keys(a).map((function(e){return"".concat(e,"=").concat(a[e])})).join(";"),e.prev=3,e.next=6,fetch("".concat(t).concat(c?"?".concat(c):""),n);case 6:r=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),Object(k.isAbortException)(e.t0)||h(b.a.createElement("span",null,b.a.createElement("strong",null,"Network connection error.")," ",b.a.createElement("br",null),e.t0.message," ",b.a.createElement("br",null),t)),e.abrupt("return",null);case 13:if(r.ok){e.next=16;break}return h(b.a.createElement("span",null,b.a.createElement("strong",null,"Error connecting to the URL.")," ",b.a.createElement("br",null),r.status,": ",r.statusText," ",b.a.createElement("br",null),t)),e.abrupt("return",null);case 16:return e.abrupt("return",r.json());case 17:case"end":return e.stop()}}),e,null,[[3,9]])}))),ne.apply(this,arguments)}function re(e){return ce.apply(this,arguments)}function ce(){return ce=Object(c.a)(o.a.mark((function e(t){var a,r,c,l,s=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>1&&void 0!==s[1]?s[1]:{},r=s.length>2&&void 0!==s[2]?s[2]:{},l=Object.keys(a).map((function(e){return"".concat(e,"=").concat(a[e])})).join(";"),e.prev=3,e.next=6,fetch("".concat(t).concat(l?"?".concat(l):""),Object(n.a)(Object(n.a)({},r),{},{method:"POST"}));case 6:c=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),Object(k.isAbortException)(e.t0)||h(b.a.createElement("span",null,b.a.createElement("strong",null,"Network connection error.")," ",b.a.createElement("br",null),e.t0.message," ",b.a.createElement("br",null),t)),e.abrupt("return",null);case 13:if(c.ok){e.next=16;break}return h(b.a.createElement("span",null,b.a.createElement("strong",null,"Error connecting to the URL.")," ",b.a.createElement("br",null),c.status,": ",c.statusText," ",b.a.createElement("br",null),t)),e.abrupt("return",null);case 16:return e.abrupt("return",c.json());case 17:case"end":return e.stop()}}),e,null,[[3,9]])}))),ce.apply(this,arguments)}Object(i.useEffect)((function(){a(!!X)}),[X,a]),Object(i.useEffect)((function(){var e=new AbortController,t=e.signal;function a(){return(a=Object(c.a)(o.a.mark((function e(){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae("https://www.trackhubregistry.org/api/info/ping",void 0,{signal:t});case 2:if(a=e.sent){e.next=5;break}return e.abrupt("return");case 5:if(1===a.ping){e.next=8;break}return h("Registry is not available"),e.abrupt("return");case 8:return e.next=10,ae("https://www.trackhubregistry.org/api/info/assemblies",void 0,{signal:t});case 10:(n=e.sent)&&L(n);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return function(){a.apply(this,arguments)}(),function(){e.abort()}}),[]),Object(i.useEffect)((function(){var e=new AbortController,t=e.signal;return p||(z&&!I.size?ee(t,!0):I.size&&!G&&ee(t)),function(){e.abort()}}));var le=[b.a.createElement(f.a,{key:"heading",variant:"h6"},"The Track Hub Registry")];if(p)return le.push(b.a.createElement(f.a,{key:"errorMessage",color:"error"},p)),b.a.createElement("div",null,le);if(!S)return le.push(b.a.createElement(D,{key:"queryStatus",status:"Connecting to registry..."})),b.a.createElement("div",null,le);var se=Object.keys(S).sort().filter((function(e){return e.toLowerCase().includes("sapiens")}));if(le.push(b.a.createElement(P,{key:"speciesSelect",selectList:se,selectedItem:C,handleSelect:function(e){R(e.target.value),A(""),J(new Map),Z(""),Y(!1)},label:"Species",helpText:"Select a species"})),C){var ue=S[C].filter((function(e){return!("GRCh37"===e.name&&"hg38"===e.synonyms[0])}));le.push(b.a.createElement(P,{key:"assemblySelect",selectList:ue,selectedItem:z,handleSelect:function(e){A(e.target.value),J(new Map),Z(""),Y(!1)},label:"Assembly",helpText:"Select an assembly"}))}return z&&(le.push(b.a.createElement("div",{key:"hubSelect"},b.a.createElement(E.a,null,b.a.createElement(g.a,null,"Hubs:"),b.a.createElement("div",{className:$.hubList},b.a.createElement(v.a,{value:X,onChange:function(e){var a=e.target.value;Z(a),t.target.name.set(I.get(a).hub.shortLabel),t.target.assemblyNames.set([z]),t.target.trackDbId.set(a)}},Array.from(I.values()).filter((function(e){return e.assembly.name===z||e.assembly.synonyms.includes(z)})).map((function(e){var t=e.error,a=e.id,n=e.hub,r=n.shortLabel,c=n.longLabel;return b.a.createElement(V,{key:a,value:a},(function(e){return b.a.createElement(y.a,{title:t||b.a.createElement(O.a,{html:c}),placement:"left",interactive:!0},b.a.createElement(d.a,Object.assign({key:a,value:a,label:b.a.createElement(O.a,{html:r}),disabled:Boolean(t),control:b.a.createElement(j.a,null)},e)))}))}))))))),G||le.push(b.a.createElement(D,{key:"hubStatus",status:"Retrieving hubs"}))),X&&le.push(b.a.createElement(H,{key:"hubDetails",hub:I.get(X).hub})),b.a.createElement(b.a.Fragment,null,le)}}}]);
//# sourceMappingURL=34.3a2503c7.chunk.js.map