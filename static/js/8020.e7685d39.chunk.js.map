{"version":3,"file":"static/js/8020.e7685d39.chunk.js","mappings":"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","sources":["../../../packages/core/BaseFeatureWidget/SequenceFeatureDetails/util.ts","../../../packages/core/BaseFeatureWidget/SequenceFeatureDetails/CDNASequence.tsx","../../../packages/core/BaseFeatureWidget/SequenceFeatureDetails/ProteinSequence.tsx","../../../packages/core/BaseFeatureWidget/SequenceFeatureDetails/GenomicSequence.tsx","../../../packages/core/BaseFeatureWidget/SequenceFeatureDetails/CDSSequence.tsx","../../../packages/core/BaseFeatureWidget/SequenceFeatureDetails/SequencePanel.tsx"],"sourcesContent":["// note that these are currently put into the style section instead of being\n// defined in classes to aid copy and paste to an external document e.g. word\nexport const intronColor = undefined\nexport const utrColor = 'rgb(200,240,240)'\nexport const proteinColor = 'rgb(220,160,220)'\nexport const cdsColor = 'rgb(220,220,180)'\nexport const updownstreamColor = 'rgba(250,200,200)'\nexport const genomeColor = 'rgb(200,280,200)'\n","import React from 'react'\nimport { Feat } from '../util'\nimport { cdsColor, intronColor, updownstreamColor, utrColor } from './util'\n\nexport default function CDNASequence({\n  utr,\n  cds,\n  exons,\n  sequence,\n  upstream,\n  downstream,\n  includeIntrons,\n  collapseIntron,\n  intronBp,\n}: {\n  utr: Feat[]\n  cds: Feat[]\n  exons: Feat[]\n  sequence: string\n  upstream?: string\n  downstream?: string\n  includeIntrons?: boolean\n  collapseIntron?: boolean\n  intronBp: number\n}) {\n  const chunks = (\n    cds.length ? [...cds, ...utr].sort((a, b) => a.start - b.start) : exons\n  ).filter(f => f.start !== f.end)\n  return (\n    <>\n      {upstream ? (\n        <span style={{ background: updownstreamColor }}>{upstream}</span>\n      ) : null}\n\n      {chunks.map((chunk, idx) => {\n        const intron = sequence.slice(chunk.end, chunks[idx + 1]?.start)\n\n        return (\n          <React.Fragment key={JSON.stringify(chunk)}>\n            <span\n              style={{\n                background: chunk.type === 'CDS' ? cdsColor : utrColor,\n              }}\n            >\n              {sequence.slice(chunk.start, chunk.end)}\n            </span>\n            {includeIntrons && idx < chunks.length - 1 ? (\n              <span style={{ background: intronColor }}>\n                {collapseIntron && intron.length > intronBp * 2\n                  ? `${intron.slice(0, intronBp)}...${intron.slice(-intronBp)}`\n                  : intron}\n              </span>\n            ) : null}\n          </React.Fragment>\n        )\n      })}\n\n      {downstream ? (\n        <span style={{ background: updownstreamColor }}>{downstream}</span>\n      ) : null}\n    </>\n  )\n}\n","import React from 'react'\nimport { Feat, stitch } from '../util'\nimport { proteinColor } from './util'\n\nexport default function ProteinSequence({\n  cds,\n  sequence,\n  codonTable,\n}: {\n  cds: Feat[]\n  sequence: string\n  codonTable: { [key: string]: string }\n}) {\n  const str = stitch(cds, sequence)\n  let protein = ''\n  for (let i = 0; i < str.length; i += 3) {\n    // use & symbol for undefined codon, or partial slice\n    protein += codonTable[str.slice(i, i + 3)] || '&'\n  }\n\n  return <span style={{ background: proteinColor }}>{protein}</span>\n}\n","import React from 'react'\nimport { genomeColor, updownstreamColor } from './util'\n\nexport default function GenomicSequence({\n  sequence,\n  upstream,\n  downstream,\n}: {\n  sequence: string\n  upstream?: string\n  downstream?: string\n}) {\n  return (\n    <>\n      {upstream ? (\n        <span style={{ background: updownstreamColor }}>{upstream}</span>\n      ) : null}\n\n      <span style={{ background: genomeColor }}>{sequence}</span>\n\n      {downstream ? (\n        <span style={{ background: updownstreamColor }}>{downstream}</span>\n      ) : null}\n    </>\n  )\n}\n","import React from 'react'\nimport { cdsColor } from './util'\nimport { Feat, stitch } from '../util'\n\nexport default function CDSSequence({\n  cds,\n  sequence,\n}: {\n  cds: Feat[]\n  sequence: string\n}) {\n  return <span style={{ background: cdsColor }}>{stitch(cds, sequence)}</span>\n}\n","import React from 'react'\n\nimport { defaultCodonTable, generateCodonTable, revcom } from '../../util'\nimport {\n  ParentFeat,\n  SeqState,\n  calculateUTRs,\n  calculateUTRs2,\n  dedupe,\n  revlist,\n} from '../util'\nimport CDNASequence from './CDNASequence'\nimport ProteinSequence from './ProteinSequence'\nimport GenomicSequence from './GenomicSequence'\nimport CDSSequence from './CDSSequence'\n\ninterface SeqPanelProps {\n  sequence: SeqState\n  feature: ParentFeat\n  mode: string\n  intronBp?: number\n}\nconst SeqPanel = React.forwardRef<HTMLDivElement, SeqPanelProps>(\n  function (props, ref) {\n    const { feature, mode, intronBp = 10 } = props\n    let {\n      sequence: { seq, upstream = '', downstream = '' },\n    } = props\n    const { subfeatures = [] } = feature\n\n    const children = subfeatures\n      .sort((a, b) => a.start - b.start)\n      .map(sub => ({\n        ...sub,\n        start: sub.start - feature.start,\n        end: sub.end - feature.start,\n      }))\n\n    // we filter duplicate entries in cds and exon lists duplicate entries may be\n    // rare but was seen in Gencode v36 track NCList, likely a bug on GFF3 or\n    // probably worth ignoring here (produces broken protein translations if\n    // included)\n    //\n    // position 1:224,800,006..225,203,064 gene ENSG00000185842.15 first\n    // transcript ENST00000445597.6\n    //\n    // http://localhost:3000/?config=test_data%2Fconfig.json&session=share-FUl7G1isvF&password=HXh5Y\n\n    let cds = dedupe(children.filter(sub => sub.type === 'CDS'))\n    let utr = dedupe(children.filter(sub => sub.type.match(/utr/i)))\n    let exons = dedupe(children.filter(sub => sub.type === 'exon'))\n\n    if (!utr.length && cds.length && exons.length) {\n      utr = calculateUTRs(cds, exons)\n    }\n    if (!utr.length && cds.length && !exons.length) {\n      utr = calculateUTRs2(cds, {\n        start: 0,\n        end: feature.end - feature.start,\n        type: 'gene',\n      })\n    }\n\n    if (feature.strand === -1) {\n      // doing this in a single assignment is needed because downstream and\n      // upstream are swapped so this avoids a temp variable\n      ;[seq, upstream, downstream] = [\n        revcom(seq),\n        revcom(downstream),\n        revcom(upstream),\n      ]\n      cds = revlist(cds, seq.length)\n      exons = revlist(exons, seq.length)\n      utr = revlist(utr, seq.length)\n    }\n    const codonTable = generateCodonTable(defaultCodonTable)\n\n    return (\n      <div ref={ref} data-testid=\"sequence_panel\">\n        <div\n          style={{\n            /* raw styles instead of className so that html copy works */\n            fontFamily: 'monospace',\n            wordWrap: 'break-word',\n            overflow: 'auto',\n            color: 'black',\n            fontSize: 12,\n            maxWidth: 600,\n            maxHeight: 300,\n          }}\n        >\n          <span style={{ background: 'white' }}>\n            {`>${\n              feature.name ||\n              feature.id ||\n              `${feature.refName}:${feature.start + 1}-${feature.end}`\n            }-${mode}\\n`}\n          </span>\n          <br />\n          {mode === 'genomic' ? (\n            <GenomicSequence sequence={seq} />\n          ) : mode === 'genomic_sequence_updownstream' ? (\n            <GenomicSequence\n              sequence={seq}\n              upstream={upstream}\n              downstream={downstream}\n            />\n          ) : mode === 'cds' ? (\n            <CDSSequence cds={cds} sequence={seq} />\n          ) : mode === 'cdna' ? (\n            <CDNASequence\n              exons={exons}\n              cds={cds}\n              utr={utr}\n              sequence={seq}\n              intronBp={intronBp}\n            />\n          ) : mode === 'protein' ? (\n            <ProteinSequence cds={cds} codonTable={codonTable} sequence={seq} />\n          ) : mode === 'gene' ? (\n            <CDNASequence\n              exons={exons}\n              cds={cds}\n              utr={utr}\n              sequence={seq}\n              includeIntrons\n              intronBp={intronBp}\n            />\n          ) : mode === 'gene_collapsed_intron' ? (\n            <CDNASequence\n              exons={exons}\n              cds={cds}\n              sequence={seq}\n              utr={utr}\n              includeIntrons\n              collapseIntron\n              intronBp={intronBp}\n            />\n          ) : mode === 'gene_updownstream' ? (\n            <CDNASequence\n              exons={exons}\n              cds={cds}\n              sequence={seq}\n              utr={utr}\n              upstream={upstream}\n              downstream={downstream}\n              includeIntrons\n              intronBp={intronBp}\n            />\n          ) : mode === 'gene_updownstream_collapsed_intron' ? (\n            <CDNASequence\n              exons={exons}\n              cds={cds}\n              sequence={seq}\n              utr={utr}\n              upstream={upstream}\n              downstream={downstream}\n              includeIntrons\n              collapseIntron\n              intronBp={intronBp}\n            />\n          ) : (\n            <div>Unknown type</div>\n          )}\n        </div>\n      </div>\n    )\n  },\n)\n\nexport default SeqPanel\n"],"names":["cdsColor","updownstreamColor","CDNASequence","_ref","utr","cds","exons","sequence","upstream","downstream","includeIntrons","collapseIntron","intronBp","chunks","length","concat","_toConsumableArray","sort","a","b","start","filter","f","end","_jsxs","_Fragment","children","_jsx","style","background","map","chunk","idx","_chunks","intron","slice","React","type","undefined","JSON","stringify","ProteinSequence","codonTable","str","stitch","protein","i","GenomicSequence","CDSSequence","props","ref","feature","mode","_props$intronBp","_props$sequence","seq","_props$sequence$upstr","_props$sequence$downs","_feature$subfeatures","subfeatures","sub","_objectSpread","dedupe","match","calculateUTRs","calculateUTRs2","strand","revcom","revlist","generateCodonTable","defaultCodonTable","fontFamily","wordWrap","overflow","color","fontSize","maxWidth","maxHeight","name","id","refName"],"sourceRoot":""}