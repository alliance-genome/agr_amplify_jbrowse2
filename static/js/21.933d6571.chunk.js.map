{"version":3,"sources":["../../src/index.ts","../../../node_modules/@gmod/binary-parser/dist/binary_parser.js","../../../node_modules/@gmod/binary-parser/vm-browser.js","../../../node_modules/@gmod/binary-parser/dist/context.js","../../src/twoBitFile.ts"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","Buffer","require","vm","Context","Long","window","self","PRIMITIVE_TYPES","UInt8","UInt16LE","UInt16BE","UInt32LE","UInt32BE","Int8","Int16LE","Int16BE","Int32LE","Int32BE","FloatLE","FloatBE","DoubleLE","DoubleBE","UInt64","Int64","aliasRegistry","FUNCTION_PREFIX","BIT_RANGE","i","push","NAME_MAP","Object","keys","concat","String","Array","Skip","Choice","Nest","Bit","Itf8","Ltf8","forEach","type","toLowerCase","Parser","this","varName","options","next","head","compiled","endian","constructorFn","alias","start","setNextParser","typeWithoutEndian","replace","toString","length","namely","skip","assert","Error","string","zeroTerminated","greedy","stripNull","encoding","buffer","readUntil","array","lengthInBytes","indexOf","choice","arguments","tag","choices","key","nest","endianess","create","Function","getCode","ctx","pushCode","generateError","addAliasedCode","addRawCode","code","generate","resolveReferences","markResolved","references","getUnresolvedReferences","markRequested","compile","src","runInThisContext","sizeOf","size","NaN","elementSize","parse","parser","generateAssert","generateVariable","formatter","generateFormatter","generateNext","generateBit","JSON","stringify","bitFields","sum","p","val","generateTmpVariable","val1","val2","bitOffset","isBigEndian","generateSkip","generateOption","generateString","name","generateBuffer","clone","generateArray","counter","lhs","item","isHash","undefined","tempVar","addReference","pushScope","popScope","generateChoiceCase","pushPath","popPath","generateChoice","t","Number","isNaN","parseInt","defaultChoice","generateNest","nestVar","isInteger","match","itf8","generateItf8","countFlags","ltf8","generateLtf8","exports","module","call","globalThis","scopes","isAsync","tmpVariableCount","arr","apply","test","pop","join","args","slice","err","interpolate","resolved","requested","aliasList","bind","filter","s","re","matches","params","index","substr","TWOBIT_MAGIC","tinyMemoize","_class","methodName","method","memoAttrName","twoBit","byteTo4Bases","maskedByteTo4Bases","map","bases","TwoBitFile","filehandle","path","LocalFile","_getParsers","read","allocUnsafe","ret","readInt32LE","version","readInt32BE","_detectEndianness","lebe","indexEntryParser","uint8","uint32","header","int32","m","v","record1","record2","record3","_getParser","headerParser","result","getHeader","maxIndexLength","sequenceCount","indexParser","indexData","offsetBytes","long","fromBytes","greaterThan","MAX_SAFE_INTEGER","toNumber","offset","getIndex","seqNames","sizePromises","values","_getSequenceSize","Promise","all","sizes","returnObject","seqName","_parseItem","rec1","dnaSize","rec2DataLength","nBlockCount","rec2","rec3DataLength","maskBlockCount","rec3","rec","nBlocks","starts","nBlockStarts","nBlockSizes","maskBlocks","maskBlockStarts","maskBlockSizes","dnaPosition","parserName","regionStart","regionEnd","_getSequenceRecord","record","TypeError","_getOverlappingBlocks","baseBytes","Math","ceil","baseBytesOffset","floor","sequenceBases","genomicPosition","end","shift","baseIsMasked","currentNBlock","bytePosition","subPosition","byte","blockStarts","blockSizes","startIndex","endIndex","blockStart","blocks","blockNum"],"mappings":"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","file":"static/js/21.933d6571.chunk.js","sourcesContent":[null,"\"use strict\";function _typeof(obj) {if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} //= =======================================================================================\n// Globals\n//= =======================================================================================\nvar _require = require(\"buffer\"),Buffer = _require.Buffer;\nvar vm = require(\"vm\");\n\nvar Context = require(\"./context\").Context;\nvar Long = require(\"long\");\n\nif (typeof window !== \"undefined\") window.Buffer = Buffer;\nif (typeof self !== \"undefined\") self.Buffer = Buffer; // this is for webworker, and also is not an elseif to avoid window polyfills in webworker\n\nvar PRIMITIVE_TYPES = {\n  UInt8: 1,\n  UInt16LE: 2,\n  UInt16BE: 2,\n  UInt32LE: 4,\n  UInt32BE: 4,\n  Int8: 1,\n  Int16LE: 2,\n  Int16BE: 2,\n  Int32LE: 4,\n  Int32BE: 4,\n  FloatLE: 4,\n  FloatBE: 4,\n  DoubleLE: 8,\n  DoubleBE: 8,\n  UInt64: 8,\n  Int64: 8 };\n\n\nvar SPECIAL_TYPES = {\n  String: null,\n  Buffer: null,\n  Array: null,\n  Skip: null,\n  Choice: null,\n  Nest: null,\n  Bit: null,\n  Itf8: null,\n  Ltf8: null };\n\n\nvar aliasRegistry = {};\nvar FUNCTION_PREFIX = \"___parser_\";\n\nvar BIT_RANGE = [];\n(function () {\n  var i;\n  for (i = 1; i <= 32; i++) {\n    BIT_RANGE.push(i);\n  }\n})();\n\n// Converts Parser's method names to internal type names\nvar NAME_MAP = {};\nObject.keys(PRIMITIVE_TYPES).\nconcat(Object.keys(SPECIAL_TYPES)).\nforEach(function (type) {\n  NAME_MAP[type.toLowerCase()] = type;\n});\n\n//= =======================================================================================\n// class Parser\n//= =======================================================================================\n\n//----------------------------------------------------------------------------------------\n// constructor\n//----------------------------------------------------------------------------------------\n\nvar Parser = function Parser() {\n  this.varName = \"\";\n  this.type = \"\";\n  this.options = {};\n  this.next = null;\n  this.head = null;\n  this.compiled = null;\n  this.endian = \"le\";\n  this.constructorFn = null;\n  this.alias = null;\n};\n\n//----------------------------------------------------------------------------------------\n// public methods\n//----------------------------------------------------------------------------------------\n\nParser.start = function () {\n  return new Parser();\n};\n\nObject.keys(PRIMITIVE_TYPES).forEach(function (type) {\n  Parser.prototype[type.toLowerCase()] = function (varName, options) {\n    return this.setNextParser(type.toLowerCase(), varName, options);\n  };\n\n  var typeWithoutEndian = type.replace(/BE|LE/, \"\").toLowerCase();\n  if (!(typeWithoutEndian in Parser.prototype)) {\n    Parser.prototype[typeWithoutEndian] = function (varName, options) {\n      return this[typeWithoutEndian + this.endian](varName, options);\n    };\n  }\n});\n\nBIT_RANGE.forEach(function (i) {\n  Parser.prototype[\"bit\".concat(i.toString())] = function (varName, options) {\n    if (!options) {\n      options = {};\n    }\n    options.length = i;\n    return this.setNextParser(\"bit\", varName, options);\n  };\n});\n\nParser.prototype.namely = function (alias) {\n  aliasRegistry[alias] = this;\n  this.alias = alias;\n  return this;\n};\n\nParser.prototype.skip = function (length, options) {\n  if (options && options.assert) {\n    throw new Error(\"assert option on skip is not allowed.\");\n  }\n\n  return this.setNextParser(\"skip\", \"\", { length: length });\n};\n\nParser.prototype.string = function (varName, options) {\n  if (!options.zeroTerminated && !options.length && !options.greedy) {\n    throw new Error(\n    \"Neither length, zeroTerminated, nor greedy is defined for string.\");\n\n  }\n  if ((options.zeroTerminated || options.length) && options.greedy) {\n    throw new Error(\n    \"greedy is mutually exclusive with length and zeroTerminated for string.\");\n\n  }\n  if (options.stripNull && !(options.length || options.greedy)) {\n    throw new Error(\n    \"Length or greedy must be defined if stripNull is defined.\");\n\n  }\n  options.encoding = options.encoding || \"utf8\";\n\n  return this.setNextParser(\"string\", varName, options);\n};\n\nParser.prototype.buffer = function (varName, options) {\n  if (!options.length && !options.readUntil) {\n    throw new Error(\"Length nor readUntil is defined in buffer parser\");\n  }\n\n  return this.setNextParser(\"buffer\", varName, options);\n};\n\nParser.prototype.array = function (varName, options) {\n  if (!options.readUntil && !options.length && !options.lengthInBytes) {\n    throw new Error(\"Length option of array is not defined.\");\n  }\n  if (!options.type) {\n    throw new Error(\"Type option of array is not defined.\");\n  }\n  if (\n  typeof options.type === \"string\" &&\n  !aliasRegistry[options.type] &&\n  Object.keys(PRIMITIVE_TYPES).indexOf(NAME_MAP[options.type]) < 0)\n  {\n    throw new Error(\"Specified primitive type \\\"\".concat(\n    options.type, \"\\\" is not supported.\"));\n\n  }\n\n  return this.setNextParser(\"array\", varName, options);\n};\n\nParser.prototype.choice = function (varName, options) {\n  if (arguments.length === 1 && _typeof(varName) === \"object\") {\n    options = varName;\n    varName = null;\n  }\n\n  if (!options.tag) {\n    throw new Error(\"Tag option of array is not defined.\");\n  }\n  if (!options.choices) {\n    throw new Error(\"Choices option of array is not defined.\");\n  }\n\n  Object.keys(options.choices).forEach(function (key) {\n    // if (isNaN(parseInt(key, 10))) {\n    //   throw new Error(\"Key of choices must be a number.\");\n    // }\n    if (!options.choices[key]) {\n      throw new Error(\"Choice Case \".concat(key, \" of \").concat(varName, \" is not valid.\"));\n    }\n\n    if (\n    typeof options.choices[key] === \"string\" &&\n    !aliasRegistry[options.choices[key]] &&\n    Object.keys(PRIMITIVE_TYPES).indexOf(NAME_MAP[options.choices[key]]) < 0)\n    {\n      throw new Error(\"Specified primitive type \\\"\".concat(\n      options.choices[key], \"\\\" is not supported.\"));\n\n    }\n  }, this);\n\n  return this.setNextParser(\"choice\", varName, options);\n};\n\nParser.prototype.nest = function (varName, options) {\n  if (arguments.length === 1 && _typeof(varName) === \"object\") {\n    options = varName;\n    varName = null;\n  }\n\n  if (!options.type) {\n    throw new Error(\"Type option of nest is not defined.\");\n  }\n  if (!(options.type instanceof Parser) && !aliasRegistry[options.type]) {\n    throw new Error(\"Type option of nest must be a Parser object.\");\n  }\n  if (!(options.type instanceof Parser) && !varName) {\n    throw new Error(\n    \"options.type must be a object if variable name is omitted.\");\n\n  }\n\n  return this.setNextParser(\"nest\", varName, options);\n};\n\nParser.prototype.endianess = function (endianess) {\n  switch (endianess.toLowerCase()) {\n    case \"little\":\n      this.endian = \"le\";\n      break;\n    case \"big\":\n      this.endian = \"be\";\n      break;\n    default:\n      throw new Error(\"Invalid endianess: \".concat(endianess));}\n\n\n  return this;\n};\n\nParser.prototype.create = function (constructorFn) {\n  if (!(constructorFn instanceof Function)) {\n    throw new Error(\"Constructor must be a Function object.\");\n  }\n\n  this.constructorFn = constructorFn;\n\n  return this;\n};\n\nParser.prototype.getCode = function () {\n  var ctx = new Context();\n\n  ctx.pushCode(\"if (!Buffer.isBuffer(buffer)) {\");\n  ctx.generateError('\"argument buffer is not a Buffer object\"');\n  ctx.pushCode(\"}\");\n\n  if (!this.alias) {\n    this.addRawCode(ctx);\n  } else {\n    this.addAliasedCode(ctx);\n  }\n\n  if (this.alias) {\n    ctx.pushCode(\"return {0}(0)\", FUNCTION_PREFIX + this.alias);\n  } else {\n    ctx.pushCode(\"return { offset: offset, result: vars };\");\n  }\n\n  return ctx.code;\n};\n\nParser.prototype.addRawCode = function (ctx) {\n  ctx.pushCode(\"var offset = 0;\");\n\n  if (this.constructorFn) {\n    ctx.pushCode(\"var vars = new constructorFn();\");\n  } else {\n    ctx.pushCode(\"var vars = {};\");\n  }\n\n  this.generate(ctx);\n\n  this.resolveReferences(ctx);\n\n  ctx.pushCode(\"return { offset: offset, result: vars };\");\n};\n\nParser.prototype.addAliasedCode = function (ctx) {\n  ctx.pushCode(\"function {0}(offset) {\", FUNCTION_PREFIX + this.alias);\n\n  if (this.constructorFn) {\n    ctx.pushCode(\"var vars = new constructorFn();\");\n  } else {\n    ctx.pushCode(\"var vars = {};\");\n  }\n\n  this.generate(ctx);\n\n  ctx.markResolved(this.alias);\n  this.resolveReferences(ctx);\n\n  ctx.pushCode(\"return { offset: offset, result: vars };\");\n  ctx.pushCode(\"}\");\n\n  return ctx;\n};\n\nParser.prototype.resolveReferences = function (ctx) {\n  var references = ctx.getUnresolvedReferences();\n  ctx.markRequested(references);\n  references.forEach(function (alias) {\n    var parser = aliasRegistry[alias];\n    parser.addAliasedCode(ctx);\n  });\n};\n\nParser.prototype.compile = function () {\n  var src = \"(function(buffer, constructorFn, Long) { \".concat(this.getCode(), \" })\");\n  this.compiled = vm.runInThisContext(src);\n};\n\nParser.prototype.sizeOf = function () {\n  var size = NaN;\n\n  if (Object.keys(PRIMITIVE_TYPES).indexOf(this.type) >= 0) {\n    size = PRIMITIVE_TYPES[this.type];\n\n    // if this is a fixed length string\n  } else if (\n  this.type === \"String\" &&\n  typeof this.options.length === \"number\")\n  {\n    size = this.options.length;\n\n    // if this is a fixed length buffer\n  } else if (\n  this.type === \"Buffer\" &&\n  typeof this.options.length === \"number\")\n  {\n    size = this.options.length;\n\n    // if this is a fixed length array\n  } else if (this.type === \"Array\" && typeof this.options.length === \"number\") {\n    var elementSize = NaN;\n    if (typeof this.options.type === \"string\") {\n      elementSize = PRIMITIVE_TYPES[NAME_MAP[this.options.type]];\n    } else if (this.options.type instanceof Parser) {\n      elementSize = this.options.type.sizeOf();\n    }\n    size = this.options.length * elementSize;\n\n    // if this a skip\n  } else if (this.type === \"Skip\") {\n    size = this.options.length;\n\n    // if this is a nested parser\n  } else if (this.type === \"Nest\") {\n    size = this.options.type.sizeOf();\n  } else if (!this.type) {\n    size = 0;\n  }\n\n  if (this.next) {\n    size += this.next.sizeOf();\n  }\n\n  return size;\n};\n\n// Follow the parser chain till the root and start parsing from there\nParser.prototype.parse = function (buffer) {\n  if (!this.compiled) {\n    this.compile();\n  }\n\n  return this.compiled(buffer, this.constructorFn, Long);\n};\n\n//----------------------------------------------------------------------------------------\n// private methods\n//----------------------------------------------------------------------------------------\n\nParser.prototype.setNextParser = function (type, varName, options) {\n  var parser = new Parser();\n\n  parser.type = NAME_MAP[type];\n  parser.varName = varName;\n  parser.options = options || parser.options;\n  parser.endian = this.endian;\n\n  if (this.head) {\n    this.head.next = parser;\n  } else {\n    this.next = parser;\n  }\n  this.head = parser;\n\n  return this;\n};\n\n// Call code generator for this parser\nParser.prototype.generate = function (ctx) {\n  if (this.type) {\n    this[\"generate\".concat(this.type)](ctx);\n    this.generateAssert(ctx);\n  }\n\n  var varName = ctx.generateVariable(this.varName);\n  if (this.options.formatter) {\n    this.generateFormatter(ctx, varName, this.options.formatter);\n  }\n\n  return this.generateNext(ctx);\n};\n\nParser.prototype.generateAssert = function (ctx) {\n  if (!this.options.assert) {\n    return;\n  }\n\n  var varName = ctx.generateVariable(this.varName);\n\n  switch (_typeof(this.options.assert)) {\n    case \"function\":\n      ctx.pushCode(\n      \"if (!({0}).call(vars, {1})) {\",\n      this.options.assert,\n      varName);\n\n      break;\n    case \"number\":\n      ctx.pushCode(\"if ({0} !== {1}) {\", this.options.assert, varName);\n      break;\n    case \"string\":\n      ctx.pushCode('if (\"{0}\" !== {1}) {', this.options.assert, varName);\n      break;\n    default:\n      throw new Error(\n      \"Assert option supports only strings, numbers and assert functions.\");}\n\n\n  ctx.generateError('\"Assert error: {0} is \" + {0}', varName);\n  ctx.pushCode(\"}\");\n};\n\n// Recursively call code generators and append results\nParser.prototype.generateNext = function (ctx) {\n  if (this.next) {\n    ctx = this.next.generate(ctx);\n  }\n\n  return ctx;\n};\n\nObject.keys(PRIMITIVE_TYPES).forEach(function (type) {\n  Parser.prototype[\"generate\".concat(type)] = function (ctx) {\n    if (type === \"UInt64\") {\n      ctx.pushCode(\n      \"{0} = Long.fromBytes(buffer.slice(offset,offset+8), true, this.endian === 'le').toNumber();\",\n      ctx.generateVariable(this.varName),\n      type);\n\n    } else if (type === \"Int64\") {\n      ctx.pushCode(\n      \"{0} = Long.fromBytes(buffer.slice(offset,offset+8), false, this.endian === 'le').toNumber();\",\n      ctx.generateVariable(this.varName),\n      type);\n\n    } else {\n      ctx.pushCode(\n      \"{0} = buffer.read{1}(offset);\",\n      ctx.generateVariable(this.varName),\n      type);\n\n    }\n    ctx.pushCode(\"offset += {0};\", PRIMITIVE_TYPES[type]);\n  };\n});\n\nParser.prototype.generateBit = function (ctx) {\n  // TODO find better method to handle nested bit fields\n  var parser = JSON.parse(JSON.stringify(this));\n  parser.varName = ctx.generateVariable(parser.varName);\n  ctx.bitFields.push(parser);\n\n  if (\n  !this.next ||\n  this.next && [\"Bit\", \"Nest\"].indexOf(this.next.type) < 0)\n  {\n    var sum = 0;\n    ctx.bitFields.forEach(function (p) {\n      sum += p.options.length;\n    });\n\n    var val = ctx.generateTmpVariable();\n\n    if (sum <= 8) {\n      ctx.pushCode(\"var {0} = buffer.readUInt8(offset);\", val);\n      sum = 8;\n    } else if (sum <= 16) {\n      ctx.pushCode(\"var {0} = buffer.readUInt16BE(offset);\", val);\n      sum = 16;\n    } else if (sum <= 24) {\n      var val1 = ctx.generateTmpVariable();\n      var val2 = ctx.generateTmpVariable();\n      ctx.pushCode(\"var {0} = buffer.readUInt16BE(offset);\", val1);\n      ctx.pushCode(\"var {0} = buffer.readUInt8(offset + 2);\", val2);\n      ctx.pushCode(\"var {2} = ({0} << 8) | {1};\", val1, val2, val);\n      sum = 24;\n    } else if (sum <= 32) {\n      ctx.pushCode(\"var {0} = buffer.readUInt32BE(offset);\", val);\n      sum = 32;\n    } else {\n      throw new Error(\n      \"Currently, bit field sequence longer than 4-bytes is not supported.\");\n\n    }\n    ctx.pushCode(\"offset += {0};\", sum / 8);\n\n    var bitOffset = 0;\n    var isBigEndian = this.endian === \"be\";\n    ctx.bitFields.forEach(function (p) {\n      ctx.pushCode(\n      \"{0} = {1} >> {2} & {3};\",\n      p.varName,\n      val,\n      isBigEndian ? sum - bitOffset - p.options.length : bitOffset,\n      (1 << p.options.length) - 1);\n\n      bitOffset += p.options.length;\n    });\n\n    ctx.bitFields = [];\n  }\n};\n\nParser.prototype.generateSkip = function (ctx) {\n  var length = ctx.generateOption(this.options.length);\n  ctx.pushCode(\"offset += {0};\", length);\n};\n\nParser.prototype.generateString = function (ctx) {\n  var name = ctx.generateVariable(this.varName);\n  var start = ctx.generateTmpVariable();\n\n  if (this.options.length && this.options.zeroTerminated) {\n    ctx.pushCode(\"var {0} = offset;\", start);\n    ctx.pushCode(\n    \"while(buffer.readUInt8(offset++) !== 0 && offset - {0}  < {1});\",\n    start,\n    this.options.length);\n\n    ctx.pushCode(\n    \"{0} = buffer.toString('{1}', {2}, offset - {2} < {3} ? offset - 1 : offset);\",\n    name,\n    this.options.encoding,\n    start,\n    this.options.length);\n\n  } else if (this.options.length) {\n    ctx.pushCode(\n    \"{0} = buffer.toString('{1}', offset, offset + {2});\",\n    name,\n    this.options.encoding,\n    ctx.generateOption(this.options.length));\n\n    ctx.pushCode(\"offset += {0};\", ctx.generateOption(this.options.length));\n  } else if (this.options.zeroTerminated) {\n    ctx.pushCode(\"var {0} = offset;\", start);\n    ctx.pushCode(\"while(buffer.readUInt8(offset++) !== 0);\");\n    ctx.pushCode(\n    \"{0} = buffer.toString('{1}', {2}, offset - 1);\",\n    name,\n    this.options.encoding,\n    start);\n\n  } else if (this.options.greedy) {\n    ctx.pushCode(\"var {0} = offset;\", start);\n    ctx.pushCode(\"while(buffer.length > offset++);\");\n    ctx.pushCode(\n    \"{0} = buffer.toString('{1}', {2}, offset);\",\n    name,\n    this.options.encoding,\n    start);\n\n  }\n  if (this.options.stripNull) {\n    ctx.pushCode(\"{0} = {0}.replace(/\\\\x00+$/g, '')\", name);\n  }\n};\n\nParser.prototype.generateBuffer = function (ctx) {\n  if (this.options.readUntil === \"eof\") {\n    ctx.pushCode(\n    \"{0} = buffer.slice(offset);\",\n    ctx.generateVariable(this.varName));\n\n  } else {\n    ctx.pushCode(\n    \"{0} = buffer.slice(offset, offset + {1});\",\n    ctx.generateVariable(this.varName),\n    ctx.generateOption(this.options.length));\n\n    ctx.pushCode(\"offset += {0};\", ctx.generateOption(this.options.length));\n  }\n\n  if (this.options.clone) {\n    ctx.pushCode(\"{0} = Buffer.from({0});\", ctx.generateVariable(this.varName));\n  }\n};\n\nParser.prototype.generateArray = function (ctx) {\n  var length = ctx.generateOption(this.options.length);\n  var lengthInBytes = ctx.generateOption(this.options.lengthInBytes);\n  var type = this.options.type;\n  var counter = ctx.generateTmpVariable();\n  var lhs = ctx.generateVariable(this.varName);\n  var item = ctx.generateTmpVariable();\n  var key = this.options.key;\n  var isHash = typeof key === \"string\";\n\n  if (isHash) {\n    ctx.pushCode(\"{0} = {};\", lhs);\n  } else {\n    ctx.pushCode(\"{0} = [];\", lhs);\n  }\n  if (typeof this.options.readUntil === \"function\") {\n    ctx.pushCode(\"do {\");\n  } else if (this.options.readUntil === \"eof\") {\n    ctx.pushCode(\"for (var {0} = 0; offset < buffer.length; {0}++) {\", counter);\n  } else if (lengthInBytes !== undefined) {\n    ctx.pushCode(\n    \"for (var {0} = offset; offset - {0} < {1}; ) {\",\n    counter,\n    lengthInBytes);\n\n  } else {\n    ctx.pushCode(\"for (var {0} = 0; {0} < {1}; {0}++) {\", counter, length);\n  }\n\n  if (typeof type === \"string\") {\n    if (!aliasRegistry[type]) {\n      ctx.pushCode(\"var {0} = buffer.read{1}(offset);\", item, NAME_MAP[type]);\n      ctx.pushCode(\"offset += {0};\", PRIMITIVE_TYPES[NAME_MAP[type]]);\n    } else {\n      var tempVar = ctx.generateTmpVariable();\n      ctx.pushCode(\"var {0} = {1}(offset);\", tempVar, FUNCTION_PREFIX + type);\n      ctx.pushCode(\"var {0} = {1}.result; offset = {1}.offset;\", item, tempVar);\n      if (type !== this.alias) ctx.addReference(type);\n    }\n  } else if (type instanceof Parser) {\n    ctx.pushCode(\"var {0} = {};\", item);\n\n    ctx.pushScope(item);\n    type.generate(ctx);\n    ctx.popScope();\n  }\n\n  if (isHash) {\n    ctx.pushCode(\"{0}[{2}.{1}] = {2};\", lhs, key, item);\n  } else {\n    ctx.pushCode(\"{0}.push({1});\", lhs, item);\n  }\n\n  ctx.pushCode(\"}\");\n\n  if (typeof this.options.readUntil === \"function\") {\n    ctx.pushCode(\n    \" while (!({0}).call(this, {1}, buffer.slice(offset)));\",\n    this.options.readUntil,\n    item);\n\n  }\n};\n\nParser.prototype.generateChoiceCase = function (ctx, varName, type) {\n  if (typeof type === \"string\") {\n    if (!aliasRegistry[type]) {\n      ctx.pushCode(\n      \"{0} = buffer.read{1}(offset);\",\n      ctx.generateVariable(this.varName),\n      NAME_MAP[type]);\n\n      ctx.pushCode(\"offset += {0};\", PRIMITIVE_TYPES[NAME_MAP[type]]);\n    } else {\n      var tempVar = ctx.generateTmpVariable();\n      ctx.pushCode(\"var {0} = {1}(offset);\", tempVar, FUNCTION_PREFIX + type);\n      ctx.pushCode(\n      \"{0} = {1}.result; offset = {1}.offset;\",\n      ctx.generateVariable(this.varName),\n      tempVar);\n\n      if (type !== this.alias) ctx.addReference(type);\n    }\n  } else if (type instanceof Parser) {\n    ctx.pushPath(varName);\n    type.generate(ctx);\n    ctx.popPath(varName);\n  }\n};\n\nParser.prototype.generateChoice = function (ctx) {\n  var tag = ctx.generateOption(this.options.tag);\n  if (this.varName) {\n    ctx.pushCode(\"{0} = {};\", ctx.generateVariable(this.varName));\n  }\n  ctx.pushCode(\"switch({0}) {\", tag);\n  Object.keys(this.options.choices).forEach(function (t) {\n    var type = this.options.choices[t];\n    if (Number.isNaN(parseInt(t, 10))) {\n      ctx.pushCode(\"case '{0}':\", t);\n    } else {\n      ctx.pushCode(\"case {0}:\", t);\n    }\n    this.generateChoiceCase(ctx, this.varName, type);\n    ctx.pushCode(\"break;\");\n  }, this);\n  ctx.pushCode(\"default:\");\n  if (this.options.defaultChoice) {\n    this.generateChoiceCase(ctx, this.varName, this.options.defaultChoice);\n  } else {\n    ctx.generateError('\"Met undefined tag value \" + {0} + \" at choice\"', tag);\n  }\n  ctx.pushCode(\"}\");\n};\n\nParser.prototype.generateNest = function (ctx) {\n  var nestVar = ctx.generateVariable(this.varName);\n\n  if (this.options.type instanceof Parser) {\n    if (this.varName) {\n      ctx.pushCode(\"{0} = {};\", nestVar);\n    }\n    ctx.pushPath(this.varName);\n    this.options.type.generate(ctx);\n    ctx.popPath(this.varName);\n  } else if (aliasRegistry[this.options.type]) {\n    var tempVar = ctx.generateTmpVariable();\n    ctx.pushCode(\n    \"var {0} = {1}(offset);\",\n    tempVar,\n    FUNCTION_PREFIX + this.options.type);\n\n    ctx.pushCode(\"{0} = {1}.result; offset = {1}.offset;\", nestVar, tempVar);\n    if (this.options.type !== this.alias) ctx.addReference(this.options.type);\n  }\n};\n\nParser.prototype.generateFormatter = function (ctx, varName, formatter) {\n  if (typeof formatter === \"function\") {\n    ctx.pushCode(\"{0} = ({1}).call(this, {0});\", varName, formatter);\n  }\n};\n\nParser.prototype.isInteger = function () {\n  return !!this.type.match(/U?Int[8|16|32][BE|LE]?|Bit\\d+/);\n};\n\n// /////////////////// CRAM-specific types //////////////////////////\n//\nParser.prototype.itf8 = function (varName, options) {\n  return this.setNextParser(\"itf8\", varName, options);\n};\nParser.prototype.itf8 = function (varName, options) {\n  return this.setNextParser(\"itf8\", varName, options);\n};\n\nParser.prototype.generateItf8 = function (ctx) {\n  var name = ctx.generateVariable(this.varName);\n  var countFlags = ctx.generateTmpVariable();\n  ctx.pushCode(\"\\n    var \".concat(\n  countFlags, \" = buffer[offset];\\n    if (\").concat(\n  countFlags, \" < 0x80) {\\n      \").concat(\n  name, \" = \").concat(countFlags, \";\\n      offset += 1;\\n    } else if (\").concat(\n\n  countFlags, \" < 0xc0) {\\n      \").concat(\n  name, \" = ((\").concat(countFlags, \"<<8) | buffer[offset+1]) & 0x3fff;\\n      offset += 2;\\n    } else if (\").concat(\n\n  countFlags, \" < 0xe0) {\\n      \").concat(\n  name, \" = ((\").concat(countFlags, \"<<16) | (buffer[offset+1]<< 8) |  buffer[offset+2]) & 0x1fffff;\\n      offset += 3;\\n    } else if (\").concat(\n\n  countFlags, \" < 0xf0) {\\n      \").concat(\n  name, \" = ((\").concat(countFlags, \"<<24) | (buffer[offset+1]<<16) | (buffer[offset+2]<<8) | buffer[offset+3]) & 0x0fffffff;\\n      offset += 4\\n    } else {\\n      \").concat(\n\n\n  name, \" = ((\").concat(countFlags, \" & 0x0f)<<28) | (buffer[offset+1]<<20) | (buffer[offset+2]<<12) | (buffer[offset+3]<<4) | (buffer[offset+4] & 0x0f);\\n      // x=((0xff & 0x0f)<<28) | (0xff<<20) | (0xff<<12) | (0xff<<4) | (0x0f & 0x0f);\\n      // TODO *val_p = uv < 0x80000000UL ? uv : -((int32_t) (0xffffffffUL - uv)) - 1;\\n      offset += 5\\n    }\\n  \"));\n\n\n\n\n\n};\n\nParser.prototype.ltf8 = function (varName, options) {\n  return this.setNextParser(\"ltf8\", varName, options);\n};\n\nParser.prototype.generateLtf8 = function (ctx) {\n  var name = ctx.generateVariable(this.varName);\n  var countFlags = ctx.generateTmpVariable();\n  ctx.pushCode(\"\\n  var \".concat(\n  countFlags, \" = buffer[offset];\\n  if (\").concat(\n  countFlags, \" < 0x80) {\\n    \").concat(\n  name, \" = \").concat(countFlags, \";\\n    offset += 1;\\n  } else if (\").concat(\n\n  countFlags, \" < 0xc0) {\\n    \").concat(\n  name, \" = ((buffer[offset]<<8) | buffer[offset+1]) & 0x3fff;\\n    offset += 2;\\n  } else if (\").concat(\n\n  countFlags, \" < 0xe0) {\\n    \").concat(\n  name, \" = ((buffer[offset]<<16) | (buffer[offset+1]<<8) | buffer[offset+2]) & 0x1fffff;\\n    \").concat(\n  name, \" = (((\").concat(countFlags, \" & 63) << 16) | buffer.readUInt16LE(offset + 1));\\n    offset += 3;\\n  } else if (\").concat(\n\n  countFlags, \" < 0xf0) {\\n    \").concat(\n  name, \" = ((buffer[offset]<<24) | (buffer[offset+1]<<16) | (buffer[offset+2]<<8) | buffer[offset+3]) & 0x0fffffff;\\n    offset += 4;\\n  } else if (\").concat(\n\n  countFlags, \" < 0xf8) {\\n    \").concat(\n  name, \" = (((buffer[offset] & 15) * Math.pow(2,32))) +\\n      (buffer[offset+1]<<24) | (buffer[offset+2]<<16 | buffer[offset+3]<<8 | buffer[offset+4])\\n    // TODO *val_p = uv < 0x80000000UL ? uv : -((int32_t) (0xffffffffUL - uv)) - 1;\\n    offset += 5;\\n  } else if (\").concat(\n\n\n\n  countFlags, \" < 0xfc) {\\n    \").concat(\n  name, \" = ((((buffer[offset] & 7) << 8) | buffer[offset+1] )) * Math.pow(2,32) +\\n      (buffer[offset+2]<<24) | (buffer[offset+3]<<16 | buffer[offset+4]<<8 | buffer[offset+5])\\n    offset += 6;\\n  } else if (\").concat(\n\n\n  countFlags, \" < 0xfe) {\\n    \").concat(\n  name, \" = ((((buffer[offset] & 3) << 16) | buffer[offset+1]<<8 | buffer[offset+2])) * Math.pow(2,32) +\\n      (buffer[offset+3]<<24) | (buffer[offset+4]<<16 | buffer[offset+5]<<8 | buffer[offset+6])\\n    offset += 7;\\n  } else if (\").concat(\n\n\n  countFlags, \" < 0xff) {\\n    \").concat(\n  name, \" = Long.fromBytesBE(buffer.slice(offset+1,offset+8));\\n    if (\").concat(\n  name, \".greaterThan(Number.MAX_SAFE_INTEGER) || \").concat(name, \".lessThan(Number.MIN_SAFE_INTEGER))\\n      throw new Error('integer overflow')\\n    \").concat(\n\n  name, \" = \").concat(name, \".toNumber()\\n    offset += 8;\\n  } else {\\n    \").concat(\n\n\n  name, \" = Long.fromBytesBE(buffer.slice(offset+1,offset+9));\\n    if (\").concat(\n  name, \".greaterThan(Number.MAX_SAFE_INTEGER) || \").concat(name, \".lessThan(Number.MIN_SAFE_INTEGER))\\n      throw new Error('integer overflow')\\n    \").concat(\n\n  name, \" = \").concat(name, \".toNumber()\\n    offset += 9;\\n  }\\n  \"));\n\n\n\n};\n\n//= =======================================================================================\n// Exports\n//= =======================================================================================\n\nexports.Parser = Parser;","// https://github.com/ionic-team/rollup-plugin-node-polyfills/blob/9b5fe1a9cafffd4871e6d65613ed224f807ea251/polyfills/vm.js#L129-L132\nfunction runInThisContext(code) {\n  const fn = new Function('code', 'return eval(code);');\n  return fn.call(globalThis, code);\n}\n\nmodule.exports.runInThisContext = runInThisContext;\n","\"use strict\";function _typeof(obj) {if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} //= =======================================================================================\n// class Context\n//= =======================================================================================\n\n//----------------------------------------------------------------------------------------\n// constructor\n//----------------------------------------------------------------------------------------\n\nvar Context = function Context() {\n  this.code = \"\";\n  this.scopes = [[\"vars\"]];\n  this.isAsync = false;\n  this.bitFields = [];\n  this.tmpVariableCount = 0;\n  this.references = {};\n};\n\n//----------------------------------------------------------------------------------------\n// public methods\n//----------------------------------------------------------------------------------------\n\nContext.prototype.generateVariable = function (name) {\n  var arr = [];\n\n  Array.prototype.push.apply(arr, this.scopes[this.scopes.length - 1]);\n\n  // $parent. prefixes allow sub-parsers to access values of their parent parsers\n  while (/^\\$parent\\./.test(name)) {\n    arr.pop();\n    name = name.replace(/^\\$parent\\./, \"\");\n  }\n\n  if (name) {\n    arr.push(name);\n  }\n\n  return arr.join(\".\");\n};\n\nContext.prototype.generateOption = function (val) {\n  switch (_typeof(val)) {\n    case \"number\":\n      return val.toString();\n    case \"string\":\n      return this.generateVariable(val);\n    case \"function\":\n      return \"(\".concat(val, \").call(\").concat(this.generateVariable(), \", vars)\");\n    default:\n      return undefined;}\n\n};\n\nContext.prototype.generateError = function () {\n  var args = Array.prototype.slice.call(arguments);\n  var err = Context.interpolate.apply(this, args);\n\n  if (this.isAsync) {\n    this.pushCode(\"return process.nextTick(function() { callback(new Error(\".concat(\n    err, \"), vars); });\"));\n\n  } else {\n    this.pushCode(\"throw new Error(\".concat(err, \");\"));\n  }\n};\n\nContext.prototype.generateTmpVariable = function () {\n  return \"$tmp\".concat(this.tmpVariableCount++);\n};\n\nContext.prototype.pushCode = function () {\n  var args = Array.prototype.slice.call(arguments);\n\n  this.code += \"\".concat(Context.interpolate.apply(this, args), \"\\n\");\n};\n\nContext.prototype.pushPath = function (name) {\n  if (name) {\n    this.scopes[this.scopes.length - 1].push(name);\n  }\n};\n\nContext.prototype.popPath = function (name) {\n  if (name) {\n    this.scopes[this.scopes.length - 1].pop();\n  }\n};\n\nContext.prototype.pushScope = function (name) {\n  this.scopes.push([name]);\n};\n\nContext.prototype.popScope = function () {\n  this.scopes.pop();\n};\n\nContext.prototype.addReference = function (alias) {\n  if (this.references[alias]) return;\n  this.references[alias] = { resolved: false, requested: false };\n};\n\nContext.prototype.markResolved = function (alias) {\n  this.references[alias].resolved = true;\n};\n\nContext.prototype.markRequested = function (aliasList) {\n  aliasList.forEach(\n  function (alias) {\n    this.references[alias].requested = true;\n  }.bind(this));\n\n};\n\nContext.prototype.getUnresolvedReferences = function () {\n  var references = this.references;\n  return Object.keys(this.references).filter(function (alias) {\n    return !references[alias].resolved && !references[alias].requested;\n  });\n};\n\n//----------------------------------------------------------------------------------------\n// private methods\n//----------------------------------------------------------------------------------------\n\nContext.interpolate = function (s) {\n  var re = /{\\d+}/g;\n  var matches = s.match(re);\n  var params = Array.prototype.slice.call(arguments, 1);\n\n  if (matches) {\n    matches.forEach(function (match) {\n      var index = parseInt(match.substr(1, match.length - 2), 10);\n      s = s.replace(match, params[index].toString());\n    });\n  }\n\n  return s;\n};\n\nexports.Context = Context;",null],"sourceRoot":""}