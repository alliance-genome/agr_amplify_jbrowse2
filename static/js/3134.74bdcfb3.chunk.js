"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[3134],{83134:function(e,t,r){r.r(t),r.d(t,{default:function(){return D}});var n=r(41361),s=r(33028),a=r(32723),c=r(34795),i=r(96234),o=r(59740),u=r(30969),l=r(33528),h=r(94103),p=r(80975),f=r(22714),x=r(28224),b=r(75654),d=r(55788),j=r(317),g=r(93717),v=r(18189),Z=r(81073),m=r(36174),y=r(8118),w=r(34122),k=r(14721),S=r(23957),L=r(34808),T=r(32343),C=r(25399),E=r(67897),_=r(35167),M=r.n(_),R=r(37574);var U=function(e){var t=(0,u.useState)(null),r=(0,i.Z)(t,2),n=r[0],s=r[1],o=(0,u.useState)(null),f=(0,i.Z)(o,2),x=f[0],b=f[1],d=e.hub,j=d.url,g=d.longLabel,v=d.shortLabel;return(0,u.useEffect)((function(){function e(){return(e=(0,c.Z)((0,a.Z)().mark((function e(){var t,r,n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=(0,l.openLocation)({uri:j,locationType:"UriLocation"}),e.next=4,r.readFile("utf8");case 4:t=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),b((0,R.jsxs)("span",{children:[(0,R.jsx)("strong",{children:"Error retrieving hub"})," ",e.t0.message," ",(0,R.jsx)("br",{}),j]})),e.abrupt("return");case 11:try{n=new y.HubFile(t),s(n)}catch(a){b((0,R.jsxs)("span",{children:[(0,R.jsx)("strong",{children:"Could not parse genomes file:"})," ",(0,R.jsx)("br",{}),a.message," ",(0,R.jsx)("br",{}),j]}))}case 12:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[j]),x?(0,R.jsx)(w.Z,{children:(0,R.jsx)(S.Z,{children:(0,R.jsx)(p.Z,{color:"error",children:x})})}):n?(0,R.jsxs)(w.Z,{children:[(0,R.jsx)(L.Z,{title:v}),(0,R.jsx)(S.Z,{children:(0,R.jsx)("div",{__dangerouslySetInnerHTML:M().sanitize(g)})}),(0,R.jsxs)(k.Z,{children:[(0,R.jsx)(T.Z,{href:"mailto:".concat(n.get("email")),rel:"noopener noreferrer",target:"_blank",color:"secondary",children:(0,R.jsx)(C.Z,{})}),n.get("descriptionUrl")?(0,R.jsx)(T.Z,{href:new URL(n.get("descriptionUrl"),new URL(j)).href,rel:"noopener noreferrer",target:"_blank",children:(0,R.jsx)(E.Z,{color:"secondary"})}):null]})]}):(0,R.jsx)(h.Z,{variant:"query"})},z=r(98302),A=r(57071),H=r(1720),N=r(43175),F=(0,f.Z)((function(e){return{formControl:{minWidth:192,marginLeft:e.spacing(2),marginRight:e.spacing(2)}}}));var I=function(e){var t=e.selectList,r=e.selectedItem,n=e.handleSelect,s=e.label,a=e.helpText,c=F();return(0,R.jsxs)(x.Z,{className:c.formControl,children:[(0,R.jsx)(A.Z,{children:s}),(0,R.jsx)(N.Z,{value:r,onChange:n,children:t.map((function(e){var t,r;return e.name&&(t=e.name,r="".concat(e.name," (").concat(e.synonyms.join(" "),")")),(0,R.jsx)(H.Z,{value:t||e,children:r||e},r||e)}))}),(0,R.jsx)(z.Z,{children:r?"":a})]})},O=["children"];function q(e){var t=e.status;return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(h.Z,{variant:"query"}),(0,R.jsx)(p.Z,{children:t})]})}function P(e){return(0,e.children)((0,o.Z)(e,O))}var B=(0,f.Z)((function(e){return{hubList:{maxHeight:400,overflowY:"auto"},genomeSelector:{marginTop:e.spacing(1)}}}));var D=function(e){var t=e.model,r=e.setModelReady,o=(0,u.useState)(null),h=(0,i.Z)(o,2),f=h[0],y=h[1],w=(0,u.useState)(null),k=(0,i.Z)(w,2),S=k[0],L=k[1],T=(0,u.useState)(""),C=(0,i.Z)(T,2),E=C[0],_=C[1],M=(0,u.useState)(""),z=(0,i.Z)(M,2),A=z[0],H=z[1],N=(0,u.useState)(new Map),F=(0,i.Z)(N,2),O=F[0],D=F[1],J=(0,u.useState)(!1),V=(0,i.Z)(J,2),W=V[0],G=V[1],Y=(0,u.useState)(""),K=(0,i.Z)(Y,2),Q=K[0],X=K[1],$=B();function ee(e,t){return te.apply(this,arguments)}function te(){return(te=(0,c.Z)((0,a.Z)().mark((function e(t,r){var s,c,i,o,u,h,p;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 10,s=r?new Map:new Map(O),c=Math.floor(O.size/10)+1,e.next=5,se("https://www.trackhubregistry.org/api/search",{page:c,entries_per_page:10},{body:JSON.stringify({assembly:A}),signal:t});case 5:if(!(i=e.sent)){e.next=38;break}o=(0,n.Z)(i.items),e.prev=8,o.s();case 10:if((u=o.n()).done){e.next=28;break}if(!(h=u.value).hub.url.startsWith("ftp://")){e.next=16;break}h.error="JBrowse cannot add connections from FTP sources",e.next=25;break;case 16:return p=(0,l.openLocation)({uri:h.hub.url,locationType:"UriLocation"}),e.prev=17,e.next=20,p.stat();case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(17),h.error=e.t0.message;case 25:s.set(h.id,h);case 26:e.next=10;break;case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(8),o.e(e.t1);case 33:return e.prev=33,o.f(),e.finish(33);case 36:D(s),s.size===i.total_entries&&G(!0);case 38:case"end":return e.stop()}}),e,null,[[8,30,33,36],[17,22]])})))).apply(this,arguments)}function re(e){return ne.apply(this,arguments)}function ne(){return ne=(0,c.Z)((0,a.Z)().mark((function e(t){var r,n,s,c,i=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},n=i.length>2&&void 0!==i[2]?i[2]:{},c=Object.keys(r).map((function(e){return"".concat(e,"=").concat(r[e])})).join(";"),e.prev=3,e.next=6,fetch("".concat(t).concat(c?"?".concat(c):""),n);case 6:s=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),(0,Z.isAbortException)(e.t0)||y((0,R.jsxs)("span",{children:[(0,R.jsx)("strong",{children:"Network connection error."})," ",(0,R.jsx)("br",{}),e.t0.message," ",(0,R.jsx)("br",{}),t]})),e.abrupt("return",null);case 13:if(s.ok){e.next=16;break}return y((0,R.jsxs)("span",{children:[(0,R.jsx)("strong",{children:"Error connecting to the URL."})," ",(0,R.jsx)("br",{}),s.status,": ",s.statusText," ",(0,R.jsx)("br",{}),t]})),e.abrupt("return",null);case 16:return e.abrupt("return",s.json());case 17:case"end":return e.stop()}}),e,null,[[3,9]])}))),ne.apply(this,arguments)}function se(e){return ae.apply(this,arguments)}function ae(){return ae=(0,c.Z)((0,a.Z)().mark((function e(t){var r,n,c,i,o=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:{},n=o.length>2&&void 0!==o[2]?o[2]:{},i=Object.keys(r).map((function(e){return"".concat(e,"=").concat(r[e])})).join(";"),e.prev=3,e.next=6,fetch("".concat(t).concat(i?"?".concat(i):""),(0,s.Z)((0,s.Z)({},n),{},{method:"POST"}));case 6:c=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),(0,Z.isAbortException)(e.t0)||y((0,R.jsxs)("span",{children:[(0,R.jsx)("strong",{children:"Network connection error."})," ",(0,R.jsx)("br",{}),e.t0.message," ",(0,R.jsx)("br",{}),t]})),e.abrupt("return",null);case 13:if(c.ok){e.next=16;break}return y((0,R.jsxs)("span",{children:[(0,R.jsx)("strong",{children:"Error connecting to the URL."})," ",(0,R.jsx)("br",{}),c.status,": ",c.statusText," ",(0,R.jsx)("br",{}),t]})),e.abrupt("return",null);case 16:return e.abrupt("return",c.json());case 17:case"end":return e.stop()}}),e,null,[[3,9]])}))),ae.apply(this,arguments)}(0,u.useEffect)((function(){r(!!Q)}),[Q,r]),(0,u.useEffect)((function(){var e=new AbortController,t=e.signal;function r(){return(r=(0,c.Z)((0,a.Z)().mark((function e(){var r,n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re("https://www.trackhubregistry.org/api/info/ping",void 0,{signal:t});case 2:if(r=e.sent){e.next=5;break}return e.abrupt("return");case 5:if(1===r.ping){e.next=8;break}return y("Registry is not available"),e.abrupt("return");case 8:return e.next=10,re("https://www.trackhubregistry.org/api/info/assemblies",void 0,{signal:t});case 10:(n=e.sent)&&L(n);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return function(){r.apply(this,arguments)}(),function(){e.abort()}}),[]),(0,u.useEffect)((function(){var e=new AbortController,t=e.signal;return f||(A&&!O.size?ee(t,!0):O.size&&!W&&ee(t)),function(){e.abort()}}));var ce=[(0,R.jsx)(p.Z,{variant:"h6",children:"The Track Hub Registry"},"heading")];if(f)return ce.push((0,R.jsx)(p.Z,{color:"error",children:f},"errorMessage")),(0,R.jsx)("div",{children:ce});if(!S)return ce.push((0,R.jsx)(q,{status:"Connecting to registry..."},"queryStatus")),(0,R.jsx)("div",{children:ce});var ie=Object.keys(S).sort().filter((function(e){return e.toLowerCase().includes("sapiens")}));if(ce.push((0,R.jsx)(I,{selectList:ie,selectedItem:E,handleSelect:function(e){_(e.target.value),H(""),D(new Map),X(""),G(!1)},label:"Species",helpText:"Select a species"},"speciesSelect")),E){var oe=S[E].filter((function(e){return!("GRCh37"===e.name&&"hg38"===e.synonyms[0])}));ce.push((0,R.jsx)(I,{selectList:oe,selectedItem:A,handleSelect:function(e){H(e.target.value),D(new Map),X(""),G(!1)},label:"Assembly",helpText:"Select an assembly"},"assemblySelect"))}return A&&(ce.push((0,R.jsx)("div",{children:(0,R.jsxs)(x.Z,{children:[(0,R.jsx)(b.Z,{children:"Hubs:"}),(0,R.jsx)("div",{className:$.hubList,children:(0,R.jsx)(d.Z,{value:Q,onChange:function(e){var r=e.target.value;X(r),t.target.name.set(O.get(r).hub.shortLabel),t.target.assemblyNames.set([A]),t.target.trackDbId.set(r)},children:Array.from(O.values()).filter((function(e){return e.assembly.name===A||e.assembly.synonyms.includes(A)})).map((function(e){var t=e.error,r=e.id,n=e.hub,a=n.shortLabel,c=n.longLabel;return(0,R.jsx)(P,{value:r,children:function(e){return(0,R.jsx)(j.ZP,{title:t||(0,R.jsx)(m.Z,{html:c}),placement:"left",interactive:!0,children:(0,R.jsx)(g.Z,(0,s.Z)({value:r,label:(0,R.jsx)(m.Z,{html:a}),disabled:Boolean(t),control:(0,R.jsx)(v.Z,{})},e),r)})}},r)}))})})]})},"hubSelect")),W||ce.push((0,R.jsx)(q,{status:"Retrieving hubs"},"hubStatus"))),Q&&ce.push((0,R.jsx)(U,{hub:O.get(Q).hub},"hubDetails")),(0,R.jsx)(R.Fragment,{children:ce})}},25399:function(e,t,r){var n=r(14859),s=r(93291);t.Z=void 0;var a=s(r(30969)),c=(0,n(r(87131)).default)(a.createElement("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"}),"Email");t.Z=c}}]);
//# sourceMappingURL=3134.74bdcfb3.chunk.js.map