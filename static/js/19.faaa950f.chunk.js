(this["webpackJsonp@jbrowse/web"]=this["webpackJsonp@jbrowse/web"]||[]).push([[19],{1606:function(e,t,r){"use strict";var n=r(29),a=r(83),s=r(86),i=r(81),c=r(11),u=r(291),o=r(297),h=r(260),f=r(80),l=r.n(f),v=r(354),p=r.n(v),b=r(195),d=r.n(b),k=r(176),x=r.n(k),m=r(12),y=r(361);function w(e,t){return g.apply(this,arguments)}function g(){return g=Object(a.a)(l.a.mark((function e(t,r){var n,a,s,i,c=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>2&&void 0!==c[2]?c[2]:{},a=n.defaultContent,s=void 0===a?{}:a,e.prev=2,e.next=5,r(t,{encoding:"utf8"});case 5:return i=e.sent,e.abrupt("return",JSON.parse(i));case 9:if(e.prev=9,e.t0=e.catch(2),"ENOENT"!==e.t0.code&&404!==e.t0.status){e.next=13;break}return e.abrupt("return",s);case 13:throw e.t0;case 14:case"end":return e.stop()}}),e,null,[[2,9]])}))),g.apply(this,arguments)}var j=function(){function e(t){var r=t.readFile,n=t.cacheSize,a=void 0===n?100:n;if(Object(i.a)(this,e),this.topList=[],this.chunkCache=new x.a({cache:new d.a({maxSize:a}),fill:this.readChunkItems.bind(this)}),this.readFile=r,!this.readFile)throw new Error('must provide a "readFile" function')}return Object(c.a)(e,[{key:"importExisting",value:function(e,t,r,n,a){this.topList=e,this.attrs=t,this.start=t.makeFastGetter("Start"),this.end=t.makeFastGetter("End"),this.lazyClass=a,this.baseURL=r,this.lazyUrlTemplate=n}},{key:"binarySearch",value:function(e,t,r){for(var n,a=-1,s=e.length;s-a>1;)r(e[n=a+s>>>1])>=t?s=n:a=n;return r===this.end?s:a}},{key:"readChunkItems",value:function(e){return w(p.a.resolve(this.baseURL,this.lazyUrlTemplate.replace(/\{Chunk\}/gi,e)),this.readFile,{defaultContent:[]})}},{key:"iterateSublist",value:function(e,t,r,a,s,i,c){var f=this;return Object(o.a)(l.a.mark((function o(){var v,p,b,d,k,x,w,g,j,O;return l.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:v=f.attrs.makeGetter("Chunk"),p=f.attrs.makeGetter("Sublist"),b=[],d=f.binarySearch(e,t,s);case 4:if(!(d<e.length&&d>=0&&a*i(e[d])<a*r)){o.next=17;break}if(e[d][0]!==f.lazyClass){o.next=9;break}!function(){var t=v(e[d]),r=f.chunkCache.get(t,t).then((function(e){return[e,t]}));b.push(r)}(),o.next=11;break;case 9:return o.next=11,[e[d],c.concat(d)];case 11:if(!(k=p(e[d]))){o.next=14;break}return o.delegateYield(Object(y.a)(Object(h.a)(f.iterateSublist(k,t,r,a,s,i,c.concat(d))),u.a),"t0",14);case 14:d+=a,o.next=4;break;case 17:x=0;case 18:if(!(x<b.length)){o.next=30;break}return o.next=21,Object(u.a)(b[x]);case 21:if(w=o.sent,g=Object(n.a)(w,2),j=g[0],O=g[1],!j){o.next=27;break}return o.delegateYield(Object(y.a)(Object(h.a)(f.iterateSublist(j,t,r,a,s,i,[].concat(Object(m.a)(c),[O]))),u.a),"t1",27);case 27:x+=1,o.next=18;break;case 30:case"end":return o.stop()}}),o)})))()}},{key:"iterate",value:function(e,t){var r=this;return Object(o.a)(l.a.mark((function n(){var a,s,i;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e>t?-1:1,s=e>t?r.start:r.end,i=e>t?r.end:r.start,!(r.topList.length>0)){n.next=5;break}return n.delegateYield(Object(y.a)(Object(h.a)(r.iterateSublist(r.topList,e,t,a,s,i,[0])),u.a),"t0",5);case 5:case"end":return n.stop()}}),n)})))()}},{key:"histogram",value:function(){var e=Object(a.a)(l.a.mark((function e(t,r,n){var a,s,i,c,u,o,f,v,p,b,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=new Array(n)).fill(0),s=(r-t)/n,i=!1,c=!1,e.prev=5,o=Object(h.a)(this.iterate(t,r));case 7:return e.next=9,o.next();case 9:if(!(i=!(f=e.sent).done)){e.next=17;break}for(v=f.value,p=Math.max(0,(this.start(v)-t)/s|0),b=Math.min(n,(this.end(v)-t)/s|0),d=p;d<=b;d+=1)a[d]+=1;case 14:i=!1,e.next=7;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(5),c=!0,u=e.t0;case 23:if(e.prev=23,e.prev=24,!i||null==o.return){e.next=28;break}return e.next=28,o.return();case 28:if(e.prev=28,!c){e.next=31;break}throw u;case 31:return e.finish(28);case 32:return e.finish(23);case 33:return e.abrupt("return",a);case 34:case"end":return e.stop()}}),e,this,[[5,19,23,33],[24,,28,32]])})));return function(t,r,n){return e.apply(this,arguments)}}()}]),e}(),O=function(){function e(t){Object(i.a)(this,e),this.classes=t,this.fields=[];for(var r=0;r<t.length;r+=1){this.fields[r]={};for(var n=0;n<t[r].attributes.length;n+=1)this.fields[r][t[r].attributes[n]]=n+1;void 0===t[r].proto&&(t[r].proto={}),void 0===t[r].isArrayAttr&&(t[r].isArrayAttr={})}}return Object(c.a)(e,[{key:"attrIndices",value:function(e){return this.classes.map((function(t){return t.attributes.indexOf(e)+1||t.attributes.indexOf(e.toLowerCase())+1||void 0}))}},{key:"get",value:function(e,t){if(t in this.fields[e[0]])return e[this.fields[e[0]][t]];var r=t.toLowerCase();if(r in this.fields[e[0]])return e[this.fields[e[0]][r]];var n=this.classes[e[0]].attributes.length+1;return n>=e.length||!(t in e[n])?t in this.classes[e[0]].proto?this.classes[e[0]].proto[t]:void 0:e[n][t]}},{key:"makeSetter",value:function(e){var t=this;return function(r,n){t.set(r,e,n)}}},{key:"makeGetter",value:function(e){var t=this;return function(r){return t.get(r,e)}}},{key:"makeFastGetter",value:function(e){var t=this.attrIndices(e);return function(e){if(void 0!==t[e[0]])return e[t[e[0]]]}}},{key:"accessors",value:function(){return this._accessors||(this._accessors=this._makeAccessors()),this._accessors}},{key:"_makeAccessors",value:function(){var e={},t={get:function(e){var t=this.get.field_accessors[e.toLowerCase()];if(t)return t.call(this)},set:function(e,t){var r=this.set.field_accessors[e];if(r)return r.call(this,t)},tags:function(){return r[this[0]]||[]}};t.get.field_accessors={},t.set.field_accessors={},this.classes.forEach((function(t,r){(t.attributes||[]).forEach((function(t,n){e[t]=e[t]||[],e[t][r]=n+1,t=t.toLowerCase(),e[t]=e[t]||[],e[t][r]=n+1}))}));var r=this.classes.map((function(e){return e.attributes}));return Object.keys(e).forEach((function(r){var n=e[r];t.get.field_accessors[r]=n?function(){return this[n[this[0]]]}:function(){}})),t}}]),e}(),C=function(){function e(t,r){var n=t.urlTemplate,a=t.chunkSize,s=t.length,c=t.cacheSize,u=void 0===c?100:c,o=t.readFile;if(Object(i.a)(this,e),this.urlTemplate=n,this.chunkSize=a,this.length=s,this.baseUrl=void 0===r?"":r,this.readFile=o,!o)throw new Error("must provide readFile callback");this.chunkCache=new x.a({cache:new d.a({maxSize:u}),fill:this.getChunk.bind(this)})}return Object(c.a)(e,[{key:"index",value:function(e,t,r){this.range(e,e,t,void 0,r)}},{key:"range",value:function(e,t){var r=this;return Object(o.a)(l.a.mark((function a(){var s,i,c,o,f,v,p,b,d;return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:for(e=Math.max(0,e),t=Math.min(t,r.length-1),s=Math.floor(e/r.chunkSize),i=Math.floor(t/r.chunkSize),c=[],o=s;o<=i;o+=1)c.push(r.chunkCache.get(o,o));f=0;case 7:if(!(f<c.length)){a.next=18;break}return a.next=10,Object(u.a)(c[f]);case 10:return v=a.sent,p=Object(n.a)(v,2),b=p[0],d=p[1],a.delegateYield(Object(y.a)(Object(h.a)(r.filterChunkData(e,t,b,d)),u.a),"t0",15);case 15:f+=1,a.next=7;break;case 18:case"end":return a.stop()}}),a)})))()}},{key:"getChunk",value:function(){var e=Object(a.a)(l.a.mark((function e(t){var r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.urlTemplate.replace(/\{Chunk\}/gi,t),this.baseUrl&&(r=p.a.resolve(this.baseUrl,r)),e.next=4,w(r,this.readFile);case 4:return n=e.sent,e.abrupt("return",[t,n]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"filterChunkData",value:l.a.mark((function e(t,r,n,a){var s,i,c,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=n*this.chunkSize,i=Math.max(0,t-s),c=Math.min(r-s,this.chunkSize-1),u=i;case 4:if(!(u<=c)){e.next=10;break}return e.next=7,[u+s,a[u]];case 7:u+=1,e.next=4;break;case 10:case"end":return e.stop()}}),e,this)}))}]),e}();function S(){return this._uniqueID}function _(){return this._parent}function z(){return this.get("subfeatures")}var F=function(){function e(t){var r=t.baseUrl,n=t.urlTemplate,a=t.readFile,s=t.cacheSize,c=void 0===s?10:s;if(Object(i.a)(this,e),this.baseUrl=r,this.urlTemplates={root:n},this.readFile=a,!this.readFile)throw new Error('must provide a "readFile" function argument');this.dataRootCache=new x.a({cache:new d.a({maxSize:c}),fill:this.fetchDataRoot.bind(this)})}return Object(c.a)(e,[{key:"makeNCList",value:function(){return new j({readFile:this.readFile})}},{key:"loadNCList",value:function(e,t,r){e.nclist.importExisting(t.intervals.nclist,e.attrs,r,t.intervals.urlTemplate,t.intervals.lazyClass)}},{key:"getDataRoot",value:function(e){return this.dataRootCache.get(e,e)}},{key:"fetchDataRoot",value:function(e){var t=this,r=p.a.resolve(this.baseUrl,this.urlTemplates.root.replace(/{\s*refseq\s*}/g,e));return w(r,this.readFile).then((function(e){return t.parseTrackInfo(e,r)}))}},{key:"parseTrackInfo",value:function(e,t){var r={nclist:this.makeNCList(),stats:{featureCount:e.featureCount||0}};e.intervals&&(r.attrs=new O(e.intervals.classes),this.loadNCList(r,e,t));var n=e.histograms;if(n&&n.meta){for(var a=0;a<n.meta.length;a+=1)n.meta[a].lazyArray=new C(Object(s.a)(Object(s.a)({},n.meta[a].arrayParams),{},{readFile:this.readFile}),t);r._histograms=n}return r._histograms&&Object.keys(r._histograms).forEach((function(e){r._histograms[e].forEach((function(e){Object.keys(e).forEach((function(t){"string"===typeof e[t]&&String(Number(e[t]))===e[t]&&(e[t]=Number(e[t]))}))}))})),r}},{key:"getRegionStats",value:function(){var e=Object(a.a)(l.a.mark((function e(t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDataRoot(t.ref);case 2:return r=e.sent,e.abrupt("return",r.stats);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRegionFeatureDensities",value:function(){var e=Object(a.a)(l.a.mark((function e(t){var r,a,s,i,c,u,o,f,v,p,b,d,k,x,m,y,w,g,j,O,C,S,_;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.refName,a=t.start,s=t.end,i=t.numBins,c=t.basesPerBin,e.next=3,this.getDataRoot(r);case 3:if(u=e.sent,!i){e.next=8;break}c=(s-a)/i,e.next=13;break;case 8:if(!c){e.next=12;break}i=Math.ceil((s-a)/c),e.next=13;break;case 12:throw new TypeError("numBins or basesPerBin arg required for getRegionFeatureDensities");case 13:for(o=u._histograms.stats||[],f=o.find((function(e){return e.basesPerBin>=c})),v=u._histograms.meta[0],p=0;p<u._histograms.meta.length;p+=1)c>=u._histograms.meta[p].basesPerBin&&(v=u._histograms.meta[p]);if(!((b=c/v.basesPerBin)>.9&&Math.abs(b-Math.round(b))<1e-4)){e.next=52;break}for(d=Math.floor(a/v.basesPerBin),b=Math.round(b),k=[],x=0;x<i;x+=1)k[x]=0;m=!1,y=!1,e.prev=25,g=Object(h.a)(v.lazyArray.range(d,d+b*i-1));case 27:return e.next=29,g.next();case 29:if(!(m=!(j=e.sent).done)){e.next=35;break}O=Object(n.a)(j.value,2),C=O[0],S=O[1],k[Math.floor((C-d)/b)]+=S;case 32:m=!1,e.next=27;break;case 35:e.next=41;break;case 37:e.prev=37,e.t0=e.catch(25),y=!0,w=e.t0;case 41:if(e.prev=41,e.prev=42,!m||null==g.return){e.next=46;break}return e.next=46,g.return();case 46:if(e.prev=46,!y){e.next=49;break}throw w;case 49:return e.finish(46);case 50:return e.finish(41);case 51:return e.abrupt("return",{bins:k,stats:f});case 52:return e.next=54,u.nclist.histogram(a,s,i);case 54:return _=e.sent,e.abrupt("return",{bins:_,stats:f});case 56:case"end":return e.stop()}}),e,this,[[25,37,41,51],[42,,46,50]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getFeatures",value:function(e){var t=this,r=e.refName,a=e.start,s=e.end;return Object(o.a)(l.a.mark((function e(){var i,c,o,f,v,p,b,d,k,x,m;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)(t.getDataRoot(r));case 2:i=e.sent,c=i.attrs&&i.attrs.accessors(),o=!1,f=!1,e.prev=6,p=Object(h.a)(i.nclist.iterate(a,s));case 8:return e.next=10,Object(u.a)(p.next());case 10:if(!(o=!(b=e.sent).done)){e.next=18;break}return d=Object(n.a)(b.value,2),k=d[0],x=d[1],k.decorated||(m=x.join(","),t.decorateFeature(c,k,"".concat(r,",").concat(m))),e.next=15,k;case 15:o=!1,e.next=8;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(6),f=!0,v=e.t0;case 24:if(e.prev=24,e.prev=25,!o||null==p.return){e.next=29;break}return e.next=29,Object(u.a)(p.return());case 29:if(e.prev=29,!f){e.next=32;break}throw v;case 32:return e.finish(29);case 33:return e.finish(24);case 34:case"end":return e.stop()}}),e,null,[[6,20,24,34],[25,,29,33]])})))()}},{key:"decorateFeature",value:function(e,t,r,n){var a=this;t.get=e.get,t.tags=e.tags,t._uniqueID=r,t.id=S,t._parent=n,t.parent=_,t.children=z,(t.get("subfeatures")||[]).forEach((function(n,s){a.decorateFeature(e,n,"".concat(r,"-").concat(s),t)})),t.decorated=!0}}]),e}();t.a=F},195:function(e,t,r){"use strict";var n=r(80),a=r(146).default,s=r(208).default,i=r(100).default,c=r(102).default,u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(i(this,t),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}return c(t,[{key:"_set",value:function(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}},{key:"get",value:function(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){var t=this.oldCache.get(e);return this.oldCache.delete(e),this._set(e,t),t}}},{key:"set",value:function(e,t){return this.cache.has(e)?this.cache.set(e,t):this._set(e,t),this}},{key:"has",value:function(e){return this.cache.has(e)||this.oldCache.has(e)}},{key:"peek",value:function(e){return this.cache.has(e)?this.cache.get(e):this.oldCache.has(e)?this.oldCache.get(e):void 0}},{key:"delete",value:function(e){var t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}},{key:"clear",value:function(){this.cache.clear(),this.oldCache.clear(),this._size=0}},{key:"keys",value:n.mark((function e(){var t,r,i,c;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=s(this),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return i=a(r.value,1),c=i[0],e.next=7,c;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"values",value:n.mark((function e(){var t,r,i,c;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=s(this),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return i=a(r.value,2),c=i[1],e.next=7,c;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:e,value:n.mark((function e(){var t,r,i,c,u,o,h,f;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=s(this.cache),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return i=r.value,e.next=7,i;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:c=s(this.oldCache),e.prev=18,c.s();case 20:if((u=c.n()).done){e.next=28;break}if(o=u.value,h=a(o,1),f=h[0],this.cache.has(f)){e.next=26;break}return e.next=26,o;case 26:e.next=20;break;case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(18),c.e(e.t1);case 33:return e.prev=33,c.f(),e.finish(33);case 36:case"end":return e.stop()}}),e,this,[[1,11,14,17],[18,30,33,36]])}))},{key:"size",get:function(){var e,t=0,r=s(this.oldCache.keys());try{for(r.s();!(e=r.n()).done;){var n=e.value;this.cache.has(n)||t++}}catch(a){r.e(a)}finally{r.f()}return this._size+t}}]),t}(Symbol.iterator);e.exports=u},260:function(e,t,r){"use strict";function n(e){var t,r,n,s=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);s--;){if(r&&null!=(t=e[r]))return t.call(e);if(n&&null!=(t=e[n]))return new a(t.call(e));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function a(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return a=function(e){this.s=e,this.n=e.next},a.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new a(e)}r.d(t,"a",(function(){return n}))},291:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(360);function a(e){return new n.a(e)}},297:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(360);function a(e){var t,r;function a(t,r){try{var i=e[t](r),c=i.value,u=c instanceof n.a;Promise.resolve(u?c.wrapped:c).then((function(e){u?a("return"===t?"return":"next",e):s(i.done?"return":"normal",e)}),(function(e){a("throw",e)}))}catch(o){s("throw",o)}}function s(e,n){switch(e){case"return":t.resolve({value:n,done:!0});break;case"throw":t.reject(n);break;default:t.resolve({value:n,done:!1})}(t=t.next)?a(t.key,t.arg):r=null}this._invoke=function(e,n){return new Promise((function(s,i){var c={key:e,arg:n,resolve:s,reject:i,next:null};r?r=r.next=c:(t=r=c,a(e,n))}))},"function"!==typeof e.return&&(this.return=void 0)}function s(e){return function(){return new a(e.apply(this,arguments))}}a.prototype["function"===typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},a.prototype.next=function(e){return this._invoke("next",e)},a.prototype.throw=function(e){return this._invoke("throw",e)},a.prototype.return=function(e){return this._invoke("return",e)}},360:function(e,t,r){"use strict";function n(e){this.wrapped=e}r.d(t,"a",(function(){return n}))},361:function(e,t,r){"use strict";function n(e,t){var r={},n=!1;function a(r,a){return n=!0,a=new Promise((function(t){t(e[r](a))})),{done:!1,value:t(a)}}return r["undefined"!==typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},r.next=function(e){return n?(n=!1,e):a("next",e)},"function"===typeof e.throw&&(r.throw=function(e){if(n)throw n=!1,e;return a("throw",e)}),"function"===typeof e.return&&(r.return=function(e){return n?(n=!1,e):a("return",e)}),r}r.d(t,"a",(function(){return n}))}}]);
//# sourceMappingURL=19.faaa950f.chunk.js.map