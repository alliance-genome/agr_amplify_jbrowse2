"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[6936],{99836:function(e,n,t){t.r(n),t.d(n,{ConfigurationReference:function(){return r.B},ConfigurationSchema:function(){return r.c},getConf:function(){return o.bc},getTypeNamesFromExplicitlyTypedUnion:function(){return o.G},isBareConfigurationSchemaType:function(){return o.Pb},isConfigurationModel:function(){return o.yt},isConfigurationSchemaType:function(){return o.qN},isConfigurationSlotType:function(){return o.mu},readConfObject:function(){return o.pS}});var r=t(9159),o=t(29558)},95439:function(e,n,t){t.d(n,{Iy:function(){return i},ie:function(){return c},k$:function(){return a}});var r=0,o=new WeakMap;function i(e,n){var t=o.get(e);return t||(r+=1,o.set(e,r),t=r,e.addEventListener("abort",(function(){var t=o.get(e);void 0!==t&&n("signalAbort",t)}))),{abortSignalId:t}}function a(e){return"object"===typeof e&&null!==e&&"abortSignalId"in e&&"number"===typeof e.abortSignalId}var s=new Map;function c(e){var n=e.abortSignalId,t=s.get(n);return t||(t=new AbortController,s.set(n,t)),t.signal}},78884:function(e,n,t){var r=t(33028),o=t(96234),i=t(96902),a=t(66519),s=t(15996),c=t(4782),u=t(91188),l=t(99836),f=t(97531),d=t(29938),p=(0,u.ZL)()({importFormEntry:{minWidth:180}}),h=(0,c.observer)((function(e){var n=e.session,t=e.onChange,c=e.selected,u=e.InputProps,h=e.TextFieldProps,v=e.localStorageKey,g=e.helperText,m=void 0===g?"Select assembly to view":g,y=p().classes,b=n.assemblyNames,w=n.assemblyManager,x=new URLSearchParams(window.location.search).get("config"),k="undefined"===typeof jest&&v?(0,f.useLocalStorage)("lastAssembly-".concat([window.location.host+window.location.pathname,x,v].join("-")),c):(0,i.useState)(c),Z=(0,o.Z)(k,2),S=Z[0],C=Z[1],T=b.includes(S||"")?S:c;(0,i.useEffect)((function(){T&&T!==c&&t(T)}),[T,t,c]);var A=b.length?"":"No configured assemblies";return(0,d.jsx)(a.Z,(0,r.Z)((0,r.Z)({select:!0,label:"Assembly",variant:"outlined",helperText:A||m,value:T||"",inputProps:{"data-testid":"assembly-selector"},onChange:function(e){return C(e.target.value)},error:!!A,InputProps:u,disabled:!!A,className:y.importFormEntry},h),{},{children:b.map((function(e){var n=w.get(e),t=n?(0,l.getConf)(n,"displayName"):"";return(0,d.jsx)(s.Z,{value:e,children:t||e},e)}))}))}));n.Z=h},46751:function(e,n,t){var r=t(33028),o=t(59740),i=t(96902),a=t(15996),s=t(45985),c=t(5966),u=t(12546),l=t(71610),f=t(52080),d=t(41590),p=t(98517),h=t(67918),v=t(48785),g=t(29938),m=["onClick"],y=["title","inset","popupId"],b=["popupState","onMenuItemClick","menuItems","classes"],w=["popupState","onMenuItemClick","menuItems"],x=["onMenuItemClick","menuItems"],k=i.createContext({parentPopupState:null,rootPopupState:null});function Z(e){var n=e.onClick,t=(0,o.Z)(e,m),s=(0,i.useContext)(k).rootPopupState;if(!s)throw new Error("must be used inside a CascadingMenu");var c=(0,i.useCallback)((function(e){s.close(),null===n||void 0===n||n(e)}),[s,n]);return(0,g.jsx)(a.Z,(0,r.Z)((0,r.Z)({},t),{},{onClick:c}))}function S(e){var n=e.title,t=e.inset,c=e.popupId,u=(0,o.Z)(e,y),l=i.useContext(k).parentPopupState,f=(0,p.o_)({popupId:c,variant:"popover",parentPopupState:l});return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(a.Z,(0,r.Z)((0,r.Z)((0,r.Z)({},(0,p.b8)(f)),(0,p.bs)(f)),{},{children:[(0,g.jsx)(s.Z,{primary:n,inset:t}),(0,g.jsx)(v.Z,{})]})),(0,g.jsx)(C,(0,r.Z)((0,r.Z)({},u),{},{anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},popupState:f}))]})}function C(e){var n=e.popupState,t=(e.onMenuItemClick,e.menuItems,e.classes,(0,o.Z)(e,b)),a=(0,i.useContext)(k).rootPopupState,s=(0,i.useMemo)((function(){return{rootPopupState:a||n,parentPopupState:n}}),[a,n]);return(0,g.jsx)(k.Provider,{value:s,children:(0,g.jsx)(h.Z,(0,r.Z)((0,r.Z)({},t),(0,p.wK)(n)))})}function T(e){var n=e.popupState,t=(e.onMenuItemClick,e.menuItems,(0,o.Z)(e,w)),a=i.useContext(k).rootPopupState,s=i.useMemo((function(){return{rootPopupState:a||n,parentPopupState:n}}),[a,n]);return(0,g.jsx)(k.Provider,{value:s,children:(0,g.jsx)(c.Z,(0,r.Z)((0,r.Z)({},t),(0,p.wK)(n)))})}function A(e){var n=e.item;return"subMenu"in n?(0,g.jsx)(d.J,{type:"subMenu"}):"checkbox"===n.type||"radio"===n.type?(0,g.jsx)(d.J,{type:n.type,checked:n.checked,disabled:n.disabled}):null}function j(e){var n=e.onMenuItemClick,t=e.menuItems,i=(0,o.Z)(e,x);var a=t.some((function(e){return"icon"in e&&e.icon}));return(0,g.jsx)(g.Fragment,{children:t.map((function(e,t){return"subMenu"in e?(0,g.jsx)(S,{popupId:"subMenu-".concat(e.label),title:e.label,inset:a,onMenuItemClick:n,menuItems:e.subMenu,children:(0,g.jsx)(j,(0,r.Z)((0,r.Z)({},i),{},{onMenuItemClick:n,menuItems:e.subMenu}))},"subMenu-".concat(e.label,"-").concat(t)):"divider"===e.type?(0,g.jsx)(u.Z,{component:"li"},"divider-".concat(t)):"subHeader"===e.type?(0,g.jsx)(l.Z,{children:e.label},"subHeader-".concat(e.label,"-").concat(t)):(0,g.jsxs)(Z,{onClick:"onClick"in e?(o=e.onClick,function(e){n(e,o)}):void 0,disabled:Boolean(e.disabled),children:[e.icon?(0,g.jsx)(f.Z,{children:(0,g.jsx)(e.icon,{})}):null," ",(0,g.jsx)(s.Z,{primary:e.label,secondary:e.subLabel,inset:a&&!e.icon}),(0,g.jsx)("div",{style:{flexGrow:1,minWidth:10}}),(0,g.jsx)(A,{item:e})]},"".concat(e.label,"-").concat(t));var o}))})}n.Z=function(e){return(0,g.jsx)(T,(0,r.Z)((0,r.Z)({},e),{},{children:(0,g.jsx)(j,(0,r.Z)({},e))}))}},43971:function(e,n,t){var r=t(33028),o=(t(96902),t(99826)),i=t(51479),a=t(83674),s=t(25322),c=t(12546),u=t(4782),l=t(91188),f=t(69029),d=t(47057),p=t(66379),h=t(29938),v=(0,l.ZL)()((function(e){return{closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}));function g(e){var n=e.error;return(0,h.jsx)("div",{style:{width:800,margin:40},children:(0,h.jsx)(p.default,{error:n})})}n.Z=(0,u.observer)((function(e){var n=v().classes,t=e.title,u=e.children,l=e.onClose;return(0,h.jsx)(o.Z,(0,r.Z)((0,r.Z)({},e),{},{children:(0,h.jsxs)(i.Z,{children:[(0,h.jsxs)(a.Z,{children:[t,l?(0,h.jsx)(s.Z,{className:n.closeButton,onClick:function(){l()},children:(0,h.jsx)(d.Z,{})}):null]}),(0,h.jsx)(c.Z,{}),(0,h.jsx)(f.ErrorBoundary,{FallbackComponent:g,children:u})]})}))}))},35130:function(e,n,t){var r=t(33028),o=t(96234),i=t(59740),a=t(96902),s=t(88636),c=t(35388),u=t(14368),l=t(91188),f=t(29938),d=["value","setValue","variant"],p=(0,l.ZL)()((function(e){return{input:{},inputBase:{},typography:{top:6,left:2,position:"absolute",whiteSpace:"nowrap",visibility:"hidden"},inputRoot:{padding:e.spacing(.5)},inputFocused:{borderStyle:"solid",borderWidth:2}}})),h=a.forwardRef((function(e,n){var t=e.value,l=e.setValue,h=e.variant,v=(0,i.Z)(e,d),g=(0,a.useState)(),m=(0,o.Z)(g,2),y=m[0],b=m[1],w=(0,a.useState)(null),x=(0,o.Z)(w,2),k=x[0],Z=x[1],S=(0,a.useState)(null),C=(0,o.Z)(S,2),T=C[0],A=C[1],j=(0,a.useState)(!1),E=(0,o.Z)(j,2),P=E[0],M=E[1];(0,a.useEffect)((function(){P&&(null===T||void 0===T||T.blur(),M(!1))}),[P,T]);var I=p(e,{props:e}).classes,R=(0,s.Z)(),N=(null===k||void 0===k?void 0:k.clientWidth)||0,D=void 0===y?t:y;return(0,f.jsxs)("div",(0,r.Z)((0,r.Z)({},v),{},{ref:n,children:[(0,f.jsx)("div",{style:{position:"relative"},children:(0,f.jsx)(c.Z,{ref:function(e){return Z(e)},component:"span",variant:h,className:I.typography,children:D})}),(0,f.jsx)(u.ZP,{inputRef:function(e){return A(e)},className:I.inputBase,inputProps:{style:(0,r.Z)({width:N},h&&"inherit"!==h?R.typography[h]:{})},classes:{input:I.input,root:I.inputRoot,focused:I.inputFocused},value:D,onChange:function(e){return b(e.target.value)},onKeyDown:function(e){"Enter"===e.key?null===T||void 0===T||T.blur():"Escape"===e.key&&(b(void 0),M(!0))},onBlur:function(){l(y||t||""),b(void 0)}})]}))}));n.Z=h},66379:function(e,n,t){t.r(n);t(96902);var r=t(29938);n.default=function(e){var n=e.error,t="",o="".concat(n),i="is not assignable",a=o.indexOf(i);if(-1!==a){var s=o.slice(0,a+i.length),c=s.match(/.*at path "(.*)" snapshot `(.*)` is not assignable/m);c&&(o="Failed to load element at ".concat(c[1],"...Failed element had snapshot"),t=c[2]);var u=s.match(/.*snapshot `(.*)` is not assignable/);u&&(o="Failed to load element...Failed element had snapshot",t=u[1])}return(0,r.jsxs)("div",{style:{padding:4,margin:4,overflow:"auto",maxHeight:200,background:"#f88",border:"1px solid black"},children:[o.slice(0,1e4),t?(0,r.jsx)("pre",{style:{background:"lightgrey",border:"1px solid black",margin:20},children:JSON.stringify(JSON.parse(t),null,2)}):null]})}},97342:function(e,n,t){t(96902);var r=t(52809),o=t(92735),i=t(99688),a=t(44536),s=t(43971),c=t(29938);n.Z=function(e){var n=e.onClose,t=e.open,u=e.onFactoryReset;function l(e){"reset"===e&&u(),n()}return(0,c.jsxs)(s.Z,{title:"Reset",onClose:function(){return l()},open:t,children:[(0,c.jsx)(r.Z,{children:(0,c.jsx)(o.Z,{children:"Are you sure you want to reset? This will restore the default configuration."})}),(0,c.jsxs)(i.Z,{children:[(0,c.jsx)(a.Z,{onClick:function(){return l()},color:"primary",children:"Cancel"}),(0,c.jsx)(a.Z,{onClick:function(){return l("reset")},color:"primary",variant:"contained",children:"OK"})]})]})}},23642:function(e,n,t){t.d(n,{GD:function(){return s},pt:function(){return a},sB:function(){return c}});var r=t(33028),o=t(66026),i=(t(96902),t(29938));function a(e){return(0,i.jsx)(o.Z,(0,r.Z)((0,r.Z)({},e),{},{children:(0,i.jsx)("path",{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"})}))}function s(e){return(0,i.jsx)(o.Z,(0,r.Z)((0,r.Z)({},e),{},{children:(0,i.jsx)("path",{d:"M21 19v-2H8v2h13m0-6v-2H8v2h13M8 7h13V5H8v2M4 5v2h2V5H4M3 5a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V5m1 6v2h2v-2H4m-1 0a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1v-2m1 6v2h2v-2H4m-1 0a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1v-2z"})}))}function c(e){return(0,i.jsx)(o.Z,(0,r.Z)((0,r.Z)({},e),{},{children:(0,i.jsx)("path",{d:"M20 5V4c0-.55-.45-1-1-1h-2c-.55 0-1 .45-1 1v1h-1v4c0 .55.45 1 1 1h1v7c0 1.1-.9 2-2 2s-2-.9-2-2V7c0-2.21-1.79-4-4-4S5 4.79 5 7v7H4c-.55 0-1 .45-1 1v4h1v1c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-1h1v-4c0-.55-.45-1-1-1H7V7c0-1.1.9-2 2-2s2 .9 2 2v10c0 2.21 1.79 4 4 4s4-1.79 4-4v-7h1c.55 0 1-.45 1-1V5h-1z"})}))}},16690:function(e,n,t){t.d(n,{c:function(){return i},e:function(){return a}});t(96902);var r=t(29938);function o(e){return"black"===e?{midnight:"#808080",forrest:"#666666",grape:"#4d4d4d",mandarin:"#333333",gray:"#1a1a1a"}:"white"===e?{midnight:"#ffffff",forrest:"#e6e6e6",grape:"#cccccc",mandarin:"#b3b3b3",gray:"#999999"}:{midnight:"#0d233f",forrest:"#135560",grape:"#721e63",mandarin:"#ffb11d",gray:"#dadada"}}function i(e){var n=e.variant;return(0,r.jsx)("svg",{viewBox:"0 0 175 175",children:(0,r.jsx)(s,{variant:n})})}function a(e){var n=e.variant;return(0,r.jsxs)("svg",{viewBox:"0 0 641 175",children:[(0,r.jsx)(c,{variant:n}),(0,r.jsx)(s,{variant:n})]})}function s(e){var n=o(e.variant);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{style:{fill:n.midnight},d:"M120.5,57.5c.168,0,.333.012.5.013V40.506c-.167,0-.333-.006-.5-.006a98.325,98.325,0,0,0-77.4,37.565q-2.664,3.378-5.023,6.994l14.206,9.327Q54.043,91.709,56,89.179A81.363,81.363,0,0,1,120.5,57.5Z"}),(0,r.jsx)("path",{style:{fill:n.forrest},d:"M148.668,86.223c.308.133.6.283.908.42l6.746-15.618c-.153-.067-.3-.143-.454-.21a81.36,81.36,0,0,0-71.777,3.5q-2.8,1.544-5.469,3.309l9.249,14.054A63.93,63.93,0,0,1,148.668,86.223Z"}),(0,r.jsx)("path",{style:{fill:n.grape},d:"M170.894,109.37A63.929,63.929,0,0,0,113.4,88.861l2.336,15.474a48.456,48.456,0,0,1,44.322,15.42c.111.125.214.255.324.381l11.16-10C171.323,109.879,171.118,109.62,170.894,109.37Z"}),(0,r.jsx)("path",{style:{fill:n.mandarin},d:"M150.921,150.314c.04.163.07.326.107.489l16.509-4.058c-.039-.163-.067-.326-.107-.489A48.457,48.457,0,0,0,135.575,111.8l-5.515,15.591A32.466,32.466,0,0,1,150.921,150.314Z"}),(0,r.jsx)("path",{style:{fill:n.gray},d:"M134.1,138.129l-9.779,13.213a32.486,32.486,0,0,1,7.823,14.463l15.147.852c.012-.166.032-.331.041-.5A32.464,32.464,0,0,0,134.1,138.129Z"})]})}function c(e){var n=o(e.variant);return(0,r.jsxs)("g",{"aria-label":"JBrowse",transform:"translate(213.084 144.241)",style:{fill:n.midnight},children:[(0,r.jsx)("path",{d:"m 26.355,-71.505 v 54.075 2.835 q 0,6.825 -0.42,10.185 -0.735,5.67 -2.835,9.135 -3.255,5.355 -8.505,8.4 -4.83,2.73 -11.55,3.57 L 1.47,11.76 Q 7.35,10.185 9.24,4.2 10.605,-0.105 10.605,-9.975 v -5.565 -55.965 q 1.785,0 4.62,0.315 2.835,0.21 3.255,0.21 1.785,0 2.94,-0.105 4.515,-0.42 4.935,-0.42 z"}),(0,r.jsx)("path",{d:"m 60.68836,-65.415 v 24.78 h 3.255 q 2.94,0 4.935,-0.525 2.1,-0.525 3.885,-2.1 2.31,-1.995 3.36,-4.83 1.155,-2.835 1.155,-6.09 0,-5.565 -2.94,-8.61 -2.94,-3.045 -8.295,-3.045 -2.52,0 -5.355,0.42 z m 0,30.87 V -6.09 h 5.25 q 4.725,0 8.505,-3.675 3.885,-3.78 3.885,-10.08 0,-8.19 -4.62,-11.655 -4.095,-3.045 -13.02,-3.045 z M 44.93836,0 v -71.505 h 27.09 q 9.135,0 14.385,3.255 6.51,3.99 6.51,12.6 0,7.035 -5.25,11.655 -4.62,4.095 -11.97,5.145 v 0.945 q 7.56,0.735 12.285,3.99 6.615,4.62 6.615,13.335 0,10.185 -7.98,15.75 -6.93,4.83 -17.43,4.83 z"}),(0,r.jsx)("path",{d:"M 109.44281,0.525 V -50.4 q 1.785,0.21 3.99,0.42 2.31,0.105 3.255,0.105 2.31,0 4.2,-0.21 1.89,-0.21 3.045,-0.315 v 13.02 q 1.89,-6.51 5.46,-9.87 4.41,-4.095 11.655,-4.095 -0.315,2.73 -0.42,6.825 -0.105,3.99 -0.105,7.455 l -0.945,0.84 q -0.945,-0.735 -2.415,-1.05 -1.47,-0.315 -2.94,-0.315 -3.57,0 -6.195,1.89 -2.52,1.785 -3.465,5.04 -0.42,1.155 -0.525,3.15 -0.105,1.89 -0.105,4.515 v 4.515 19.005 q -1.785,-0.21 -2.625,-0.21 -3.675,-0.315 -4.62,-0.315 -2.31,0 -4.2,0.21 -1.89,0.21 -3.045,0.315 z"}),(0,r.jsx)("path",{d:"m 173.77337,1.47 q -11.655,0 -18.585,-6.825 -6.93,-6.825 -6.93,-18.48 0,-12.6 6.72,-20.055 6.825,-7.455 18.9,-7.455 11.97,0 18.9,6.72 6.93,6.72 6.93,18.48 0,12.285 -6.72,19.74 -7.14,7.875 -19.215,7.875 z m 0.735,-48.09 q -5.88,0 -8.505,6.51 -2.205,5.565 -2.205,15.96 0,8.19 1.47,12.915 2.415,7.98 8.505,7.98 5.565,0 8.19,-7.875 2.205,-6.51 2.205,-16.695 0,-8.505 -2.1,-13.23 -2.52,-5.565 -7.56,-5.565 z"}),(0,r.jsx)("path",{d:"m 222.03563,-50.4 10.5,36.015 q 3.675,-11.235 5.67,-17.85 2.415,-8.085 5.04,-18.165 1.05,0.105 3.045,0.315 2.1,0.21 2.835,0.21 1.995,0 3.15,-0.105 1.26,-0.21 2.73,-0.42 l 10.71,36.015 q 5.88,-17.43 10.71,-36.015 l 4.2,0.315 4.095,-0.315 q -5.145,13.125 -9.135,24.57 -5.04,14.28 -8.505,26.355 -1.89,-0.21 -3.36,-0.42 -1.365,-0.105 -2.205,-0.105 -1.89,0 -3.36,0.21 -1.365,0.21 -2.31,0.315 l -10.605,-34.755 q -4.41,13.65 -6.72,21.105 -2.31,7.35 -4.095,13.65 -1.89,-0.21 -3.36,-0.42 -1.365,-0.105 -2.31,-0.105 -1.995,0 -3.465,0.21 -1.365,0.21 -2.31,0.315 -3.78,-12.81 -5.04,-17.01 -2.205,-7.245 -5.46,-17.01 -2.835,-8.4 -5.88,-16.905 1.575,0 4.305,0.315 2.73,0.21 3.36,0.21 1.47,0 4.305,-0.21 2.835,-0.315 3.465,-0.315 z"}),(0,r.jsx)("path",{d:"m 292.84172,-12.81 h 2.625 q 1.47,4.095 4.62,6.51 3.15,2.415 7.35,2.415 2.94,0 5.46,-1.785 2.625,-1.89 2.625,-4.62 0,-3.885 -6.195,-6.615 -10.395,-4.62 -11.655,-5.46 -6.405,-4.515 -6.405,-12.285 0,-7.77 5.25,-12.18 5.25,-4.515 12.81,-4.515 3.99,0 8.085,1.365 4.095,1.26 7.14,3.57 l -2.52,9.24 h -2.94 q -0.63,-3.57 -3.57,-6.195 -2.835,-2.625 -6.405,-2.625 -3.15,0 -5.46,1.575 -2.31,1.47 -2.31,4.515 0,3.885 6.405,6.51 10.185,4.095 11.865,5.25 6.405,4.41 6.405,12.81 0,7.455 -5.46,12.18 -5.355,4.62 -14.805,4.62 -8.19,0 -14.49,-4.305 z"}),(0,r.jsx)("path",{d:"m 349.61228,-29.925 h 15.54 q 0,-6.51 -1.05,-10.395 -1.68,-6.3 -5.88,-6.3 -5.04,0 -7.14,6.195 -1.47,4.305 -1.47,10.5 z m 30.03,5.04 h -30.03 q 0,9.135 3.045,13.86 3.57,5.67 11.55,5.67 3.255,0 6.405,-1.26 3.15,-1.26 5.88,-3.465 l 1.26,0.945 -2.31,5.88 q -6.72,4.725 -15.015,4.725 -12.915,0 -19.635,-7.245 -6.72,-7.245 -6.72,-20.37 0,-11.235 6.405,-18.165 6.51,-7.035 17.64,-7.035 11.655,0 16.905,7.56 4.62,6.615 4.62,18.9 z"})]})}},41590:function(e,n,t){t.d(n,{J:function(){return T}});var r=t(59740),o=t(33028),i=t(96234),a=t(96902),s=t(56537),c=t(12546),u=t(71610),l=t(52080),f=t(15996),d=t(45985),p=t(8281),h=t(6880),v=t(78566),g=t(91188),m=t(90001),y=t(26838),b=t(87851),w=t(24667),x=t(77668),k=t(97531),Z=t(29938),S=["open","onClose","menuItems","onMenuItemClick"],C=(0,g.ZL)()({paper:{position:"fixed",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",top:0,left:0,outline:0},menuItemEndDecoration:{padding:0,margin:0,height:16}});function T(e){var n,t,r,o=C().classes,i=e.type;if("checked"in e&&(n=e.checked,t=e.disabled),"subMenu"===i)r=(0,Z.jsx)(m.Z,{color:"action"});else if("checkbox"===i)if(n){var a=t?"inherit":void 0;r=(0,Z.jsx)(y.Z,{color:a})}else r=(0,Z.jsx)(b.Z,{color:"action"});else if("radio"===i)if(n){var s=t?"inherit":void 0;r=(0,Z.jsx)(w.Z,{color:s})}else r=(0,Z.jsx)(x.Z,{color:"action"});return(0,Z.jsx)("div",{className:o.menuItemEndDecoration,children:r})}var A=a.forwardRef((function(e,n){var t=(0,a.useState)(),r=(0,i.Z)(t,2),v=r[0],g=r[1],m=(0,a.useState)(),y=(0,i.Z)(m,2),b=y[0],w=y[1],x=(0,a.useState)(!1),S=(0,i.Z)(x,2),j=S[0],E=S[1],P=(0,a.useState)(),M=(0,i.Z)(P,2),I=M[0],R=M[1],N=(0,a.useState)(),D=(0,i.Z)(N,2),L=D[0],O=D[1],W=(0,a.useRef)(null),U=C().classes,z=e.menuItems,_=e.onMenuItemClick,B=e.open,V=e.onClose,q=e.anchorEl,G=e.top,F=void 0!==G&&G;(0,a.useEffect)((function(){B||(g(void 0),w(void 0))}),[B]),(0,a.useEffect)((function(){var e,n=B&&Boolean(v);return n&&!j?e=setTimeout((function(){E(!0)}),300):!n&&j&&(e=setTimeout((function(){E(!1)}),300)),function(){clearTimeout(e)}}),[j,B,v]),(0,a.useEffect)((function(){if(q){var e=q.getBoundingClientRect();L&&e.top===L.top&&e.left+e.width===L.left||O({top:e.top,left:e.left+e.width})}else L||O({})}),[L,q]);var J=z.some((function(e){return"icon"in e&&e.icon})),H={};var Q=(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(s.Z,{autoFocusItem:B&&!j,dense:!0,children:z.sort((function(e,n){return(n.priority||0)-(e.priority||0)})).map((function(e,n){if("divider"===e.type)return(0,Z.jsx)(c.Z,{component:"li"},"divider-".concat(n));if("subHeader"===e.type)return(0,Z.jsx)(u.Z,{children:e.label},"subHeader-".concat(e.label,"-").concat(n));var t=null,r=null;if(e.icon){var o=e.icon;t=(0,Z.jsx)(l.Z,{children:(0,Z.jsx)(o,{})})}"subMenu"in e?r=(0,Z.jsx)(T,{type:"subMenu"}):"checkbox"!==e.type&&"radio"!==e.type||(r=(0,Z.jsx)(T,{type:e.type,checked:e.checked,disabled:e.disabled}));var i,a="onClick"in e?(i=e.onClick,function(e){_(e,i)}):void 0;return(0,Z.jsxs)(f.Z,{style:H,selected:n===I,onClick:a,onMouseMove:function(t){t.currentTarget!==document.activeElement&&(t.currentTarget.focus(),R(n)),"subMenu"in e?b!==n&&(g(t.currentTarget),w(n)):(g(void 0),w(void 0))},onKeyDown:function(t){if("ArrowLeft"===t.key||"Escape"===t.key)V&&V(t,"escapeKeyDown");else if("ArrowUp"===t.key)R(function(e,n){return(0,k.findLastIndex)(e.slice(0,n),(function(e){return"divider"!==e.type&&"subHeader"!==e.type&&!e.disabled}))}(z,n));else if("ArrowDown"===t.key){var r=function(e,n){var t=e.slice(n+1).findIndex((function(e){return"divider"!==e.type&&"subHeader"!==e.type&&!e.disabled}));return-1===t?t:n+1+t}(z,n);R(r)}else"subMenu"in e&&("ArrowRight"!==t.key&&"Enter"!==t.key||(g(t.currentTarget),w(n),E(!0)))},disabled:Boolean(e.disabled),children:[t,(0,Z.jsx)(d.Z,{primary:e.label,secondary:e.subLabel,inset:J&&!e.icon}),r]},e.label)}))}),z.map((function(e,n){var t=null;return"subMenu"in e&&(t=(0,Z.jsx)(A,{anchorEl:v,open:j&&b===n,onClose:function(){E(!1),g(void 0)},onMenuItemClick:_,menuItems:e.subMenu},e.label)),t}))]});return F?Q:(0,Z.jsx)(p.Z,{in:B,style:{transformOrigin:"0 0 0"},ref:n,children:(0,Z.jsx)(h.Z,{elevation:8,ref:W,className:U.paper,style:(0,o.Z)({},L),children:Q})})}));n.Z=function(e){var n=e.open,t=e.onClose,i=e.menuItems,a=e.onMenuItemClick,s=(0,r.Z)(e,S);return(0,Z.jsx)(v.ZP,(0,o.Z)((0,o.Z)({open:n,onClose:t,BackdropProps:{invisible:!0},anchorOrigin:(0,o.Z)({vertical:"bottom",horizontal:"right"},s.anchorOrigin),transformOrigin:(0,o.Z)({vertical:"top",horizontal:"left"},s.transformOrigin)},s),{},{children:(0,Z.jsx)(A,{open:n,onClose:t,menuItems:i,onMenuItemClick:a,top:!0})}))}},54896:function(e,n,t){var r=t(33028),o=t(96234),i=t(59740),a=t(96902),s=t(91188),c=t(29938),u=["onDrag","vertical","flexbox","className"],l=(0,s.ZL)()({horizontalHandle:{cursor:"row-resize",width:"100%"},verticalHandle:{cursor:"col-resize",height:"100%"},flexbox_verticalHandle:{cursor:"col-resize",alignSelf:"stretch"},flexbox_horizontalHandle:{cursor:"row-resize",alignSelf:"stretch"}});n.Z=function(e){var n,t=e.onDrag,s=e.vertical,f=void 0!==s&&s,d=e.flexbox,p=void 0!==d&&d,h=e.className,v=(0,i.Z)(e,u),g=(0,a.useState)(!1),m=(0,o.Z)(g,2),y=m[0],b=m[1],w=(0,a.useRef)(0),x=l(),k=x.classes,Z=x.cx;return(0,a.useEffect)((function(){function e(e){e.preventDefault();var n=f?e.clientX:e.clientY,r=n-w.current;r&&(t(r),w.current=n)}function n(){b(!1)}return y?(window.addEventListener("mousemove",e,!0),window.addEventListener("mouseup",n,!0),function(){window.removeEventListener("mousemove",e,!0),window.removeEventListener("mouseup",n,!0)}):function(){}}),[y,t,f]),n=p?f?k.flexbox_verticalHandle:k.flexbox_horizontalHandle:f?k.verticalHandle:k.horizontalHandle,(0,c.jsx)("div",(0,r.Z)({"data-resizer":"true",onMouseDown:function(e){e.preventDefault(),w.current=f?e.clientX:e.clientY,b(!0)},className:Z(n,h)},v))}},46186:function(e,n,t){t.r(n),t.d(n,{App:function(){return w},AssemblySelector:function(){return x.Z},CascadingMenu:function(){return k.Z},Dialog:function(){return Z.Z},EditableTypography:function(){return S.Z},ErrorMessage:function(){return C.default},FactoryResetDialog:function(){return T.Z},FatalErrorDialog:function(){return A.Z},FileSelector:function(){return G},LoadingEllipses:function(){return F.Z},LogoFull:function(){return o.e},Logomark:function(){return o.c},Menu:function(){return J.Z},MenuItemEndDecoration:function(){return J.J},PrerenderedCanvas:function(){return Q},ResizeHandle:function(){return oe.Z},ReturnToImportFormDialog:function(){return re},SanitizedHTML:function(){return fe},Tooltip:function(){return $},createJBrowseBaseTheme:function(){return r.PS},createJBrowseTheme:function(){return r.qD},defaultThemes:function(){return r.kG}});var r=t(53724),o=t(16690),i=t(33028),a=t(96902),s=t(19459),c=t(50543),u=t(88539),l=t(91188),f=t(8019),d=t(4782),p=t(86106),h=t(22084),v=t(7947),g=t(2880),m=t(80659),y=t(29938),b=(0,l.ZL)()((function(e){return{root:{fontFamily:"Roboto",display:"grid",height:"100vh",width:"100%",colorScheme:e.palette.mode},fabLeft:{zIndex:1e4,position:"fixed",bottom:e.spacing(2),left:e.spacing(2)},fabRight:{zIndex:1e4,position:"fixed",bottom:e.spacing(2),right:e.spacing(2)},menuBarAndComponents:{gridColumn:"main",display:"grid",gridTemplateRows:"[menubar] min-content [components] auto",height:"100vh"},menuBar:{gridRow:"menubar"},components:{overflowY:"auto",gridRow:"components"},appBar:{flexGrow:1}}})),w=(0,d.observer)((function(e){var n,t,r=e.session,o=b().classes,l=r.minimized,d=r.visibleWidget,w=r.drawerWidth,x=r.activeWidgets,k=r.views,Z=r.drawerPosition,S=d&&!l;return"right"===Z?t=["[main] 1fr",S?"[drawer] ".concat(w,"px"):void 0]:"left"===Z&&(t=[S?"[drawer] ".concat(w,"px"):void 0,"[main] 1fr"]),(0,y.jsxs)("div",{className:o.root,style:{gridTemplateColumns:null===(n=t)||void 0===n?void 0:n.filter((function(e){return!!e})).join(" ")},children:[S&&"left"===Z?(0,y.jsx)(p.Z,{session:r}):null,r.DialogComponent?(0,y.jsx)(a.Suspense,{fallback:(0,y.jsx)("div",{}),children:(0,y.jsx)(r.DialogComponent,(0,i.Z)({},r.DialogProps))}):null,(0,y.jsxs)("div",{className:o.menuBarAndComponents,children:[(0,y.jsx)("div",{className:o.menuBar,children:(0,y.jsx)(s.Z,{className:o.appBar,position:"static",children:(0,y.jsx)(h.Z,(0,i.Z)({},e))})}),(0,y.jsxs)("div",{className:o.components,children:[k.length?k.map((function(e){return(0,y.jsx)(m.Z,{view:e,session:r},"view-".concat(e.id))})):(0,y.jsx)(g.Z,(0,i.Z)({},e)),(0,y.jsx)("div",{style:{height:300}})]})]}),x.size>0&&l?(0,y.jsx)(c.Z,{title:"Open drawer widget",children:(0,y.jsx)(u.Z,{className:"right"===Z?o.fabRight:o.fabLeft,color:"primary","data-testid":"drawer-maximize",onClick:function(){return r.showWidgetDrawer()},children:(0,y.jsx)(f.Z,{})})}):null,S&&"right"===Z?(0,y.jsx)(p.Z,{session:r}):null,(0,y.jsx)(v.Z,{session:r})]})})),x=t(78884),k=t(46751),Z=t(43971),S=t(35130),C=t(66379),T=t(97342),A=t(90264),j=t(68079),E=t(96234),P=t(59740),M=t(72540),I=t(37676),R=t(36276),N=t(52868),D=t(5966),L=t(15996),O=t(82793),W=t(73),U=t(50811),z=t(58865),_=t(74859),B=["title","children"];function V(e){var n=e.title,t=e.children,r=(0,P.Z)(e,B);return(0,y.jsx)(c.Z,{title:n||"",children:(0,y.jsx)(M.Z,(0,i.Z)((0,i.Z)({},r),{},{children:t}))})}function q(e,n){return"string"===typeof e&&e.length>n?"".concat(e.substring(0,n),"\u2026"):e}var G=(0,d.observer)((function(e){var n=e.location,t=e.name,r=e.description,o=e.rootModel,s=e.setLocation,c=!n||(0,W.hb)(n)?"url":"file",u=(0,a.useState)(n&&"internetAccountId"in n&&n.internetAccountId?n.internetAccountId:c),l=(0,E.Z)(u,2),f=l[0],d=l[1],p=(0,W.dc)(o)?o.internetAccounts.slice():[],h=(0,a.useState)(p.slice(0,2)),v=(0,E.Z)(h,2),g=v[0],m=v[1],b=(0,a.useState)(p.slice(2)),w=(0,E.Z)(b,2),x=w[0],k=w[1],Z=(0,a.useState)(null),S=(0,E.Z)(Z,2),C=S[0],T=S[1],A=p.find((function(e){return e.internetAccountId===f})),P=function(e){s((0,i.Z)((0,i.Z)({},e),{},{internetAccountId:A?A.internetAccountId:void 0}))};n&&A&&(0,W.hb)(n)&&n.internetAccountId!==A.internetAccountId&&P(n);var B=(0,y.jsx)(z.Z,(0,i.Z)((0,i.Z)({},e),{},{setLocation:P,label:null===A||void 0===A?void 0:A.selectorLabel}));if("file"===f&&(B=(0,y.jsx)(U.Z,(0,i.Z)({},e))),null!==A&&void 0!==A&&A.SelectorComponent){var G=A.SelectorComponent;B=(0,y.jsx)(G,(0,i.Z)((0,i.Z)({},e),{},{setLocation:P}))}return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(I.Z,{display:"flex",children:(0,y.jsx)(R.Z,{shrink:!0,children:t})}),(0,y.jsx)(I.Z,{display:"flex",flexDirection:"row",children:(0,y.jsxs)(I.Z,{children:[(0,y.jsxs)(N.Z,{value:f,exclusive:!0,onChange:function(e,t){t&&d(t),(0,W.hb)(n)&&P(n)},"aria-label":"file, url, or account picker",children:[new URLSearchParams(window.location.search).get("adminKey")?null:(0,y.jsx)(M.Z,{value:"file","aria-label":"local file",children:"File"}),(0,y.jsx)(M.Z,{value:"url","aria-label":"url",children:"URL"}),g.map((function(e){var n=e.internetAccountId,t=e.toggleContents,r=e.name;return(0,y.jsx)(V,{value:n,"aria-label":r,title:r,children:"string"===typeof t?q(t,5):t||q(r,5)},n)})),x.length?(0,y.jsxs)(M.Z,{onClick:function(e){return T(e.target)},selected:!1,children:["More",(0,y.jsx)(_.Z,{})]}):null]}),(0,y.jsx)(D.Z,{open:Boolean(C),anchorEl:C,onClose:function(){return T(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:null===x||void 0===x?void 0:x.map((function(e,n){return(0,y.jsx)(L.Z,{value:e.internetAccountId,onClick:function(){var t=g[g.length-1];m([].concat((0,j.Z)(g.slice(0,g.length-1)),[e])),k([t].concat((0,j.Z)(x.slice(0,n)),(0,j.Z)(x.slice(n+1)))),d(e.internetAccountId),T(null)},children:e.name},e.internetAccountId)}))})]})}),B,(0,y.jsx)(O.Z,{children:r})]})})),F=t(20893),J=t(41590),H=t(15446);var Q=function(e){var n=e.width,t=e.height,r=e.highResolutionScaling,o=void 0===r?1:r,s=e.style,c=void 0===s?{}:s,u=e.imageData,l=e.blockKey,f=e.showSoftClip,d=(0,a.useState)(!1),p=(0,E.Z)(d,2),h=p[0],v=p[1],g=(0,a.useRef)(null);(0,a.useEffect)((function(){if(u){var e=g.current;if(e){var n=e.getContext("2d");n&&((0,H.kv)(u,n),v(!0))}}}),[u]);var m=l?"_"+l:"",b="prerendered_canvas".concat(f?"_softclipped":"").concat(m).concat(h?"_done":"");return(0,y.jsx)("canvas",{"data-testid":b,ref:g,width:n*o,height:t*o,style:(0,i.Z)({width:n,height:t},c)})},K=t(99836),Y=(0,l.ZL)()({hoverLabel:{border:"1px solid black",position:"absolute",background:"#fffa",pointerEvents:"none",zIndex:1e4}}),$=(0,d.observer)((function(e){var n=e.offsetX,t=e.offsetY,r=e.configuration,o=e.feature,i=e.timeout,s=void 0===i?300:i,c=Y().classes,u=(0,a.useState)(!1),l=(0,E.Z)(u,2),f=l[0],d=l[1];if((0,a.useEffect)((function(){var e=setTimeout((function(){return d(!0)}),s);return function(){return clearTimeout(e)}})),o&&f){var p=(0,K.readConfObject)(r,"mouseover",{feature:o});return(0,y.jsx)("div",{className:c.hoverLabel,style:{left:n,top:t},children:p})}return null})),X=t(52809),ee=t(35388),ne=t(99688),te=t(44536);var re=(0,d.observer)((function(e){var n=e.model,t=e.handleClose;return(0,y.jsxs)(Z.Z,{maxWidth:"xl",open:!0,onClose:t,title:"Reference sequence",children:[(0,y.jsx)(X.Z,{children:(0,y.jsx)(ee.Z,{children:"Are you sure you want to return to the import form? This will lose your current view"})}),(0,y.jsxs)(ne.Z,{children:[(0,y.jsx)(te.Z,{onClick:function(){n.clearView(),t()},variant:"contained",color:"primary",autoFocus:!0,children:"OK"}),(0,y.jsx)(te.Z,{onClick:function(){return t()},color:"secondary",variant:"contained",children:"Cancel"})]})]})})),oe=t(54896),ie=t(1599),ae=t.n(ie),se=t(57244),ce=t.n(se),ue=!1,le=new RegExp(["a","b","br","code","div","em","h1","h2","h3","h4","h5","h6","i","img","li","p","pre","span","small","strong","table","tbody","sup","sub","td","tfoot","th","thead","tr","u","ul"].map((function(e){return"<".concat(e,"\\b[^>]*>")})).join("|"),"i");function fe(e){var n,t=e.html,r=(n=t,le.test(n)?t:ae()(t));return ue||(ue=!0,ce().addHook("afterSanitizeAttributes",(function(e){"A"===e.tagName&&(e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank"))}))),(0,y.jsx)("span",{dangerouslySetInnerHTML:{__html:ce().sanitize(r)}})}},53724:function(e,n,t){t.d(n,{PS:function(){return b},kG:function(){return y},qD:function(){return w}});var r=t(33028),o=t(67092),i=t(31253),a=t(61298),s=t(2911),c=t(36282),u=t(72635),l=t(67928),f=t.n(l),d="#0D233F",p="#721E63",h="#135560",v="#FFB11D",g=(0,u.Z)();function m(){return{palette:{mode:void 0,primary:{main:d},secondary:{main:p},tertiary:g.palette.augmentColor({color:{main:h}}),quaternary:g.palette.augmentColor({color:{main:v}}),stopCodon:"#e22",startCodon:"#3e3",bases:{A:g.palette.augmentColor({color:o.Z}),C:g.palette.augmentColor({color:i.Z}),G:g.palette.augmentColor({color:a.Z}),T:g.palette.augmentColor({color:s.Z})}},components:{MuiLink:{styleOverrides:{root:function(e){return{color:e.theme.palette.tertiary.main}}}}}}}var y={default:(0,r.Z)({name:"Default (from config)"},m()),lightStock:(0,r.Z)({name:"Light (stock)"},m()),lightMinimal:{name:"Light (minimal)",palette:{primary:{main:c.Z[900]},secondary:{main:c.Z[800]},tertiary:g.palette.augmentColor({color:{main:c.Z[900]}}),quaternary:g.palette.augmentColor({color:{main:v}}),stopCodon:"#e22",startCodon:"#3e3",bases:{A:g.palette.augmentColor({color:o.Z}),C:g.palette.augmentColor({color:i.Z}),G:g.palette.augmentColor({color:a.Z}),T:g.palette.augmentColor({color:s.Z})}}},darkMinimal:{name:"Dark (minimal)",palette:{mode:"dark",primary:{main:c.Z[700]},secondary:{main:c.Z[800]},tertiary:g.palette.augmentColor({color:{main:c.Z[900]}}),quaternary:g.palette.augmentColor({color:{main:v}}),stopCodon:"#e22",startCodon:"#3e3",bases:{A:g.palette.augmentColor({color:o.Z}),C:g.palette.augmentColor({color:i.Z}),G:g.palette.augmentColor({color:a.Z}),T:g.palette.augmentColor({color:s.Z})}}},darkStock:{name:"Dark (stock)",palette:{mode:"dark",primary:{main:d},secondary:{main:p},tertiary:g.palette.augmentColor({color:{main:h}}),quaternary:g.palette.augmentColor({color:{main:v}}),stopCodon:"#e22",startCodon:"#3e3",bases:{A:g.palette.augmentColor({color:o.Z}),C:g.palette.augmentColor({color:i.Z}),G:g.palette.augmentColor({color:a.Z}),T:g.palette.augmentColor({color:s.Z})}},components:{MuiAppBar:{defaultProps:{enableColorOnDark:!0},styleOverrides:{primary:function(e){return e.theme.palette.primary.main}}}}}};function b(e){return f()((0,r.Z)({palette:null===e||void 0===e?void 0:e.palette,typography:{fontSize:12},spacing:4},function(e){var n,t,r,o,i,a;return{components:{MuiButton:{defaultProps:{size:"small"},styleOverrides:{root:function(e){var n=e.theme;return"dark"===n.palette.mode?{color:n.palette.text.primary}:void 0}}},MuiAccordion:{defaultProps:{disableGutters:!0,TransitionProps:{timeout:150}}},MuiFilledInput:{defaultProps:{margin:"dense"}},MuiFormControl:{defaultProps:{margin:"dense",size:"small"}},MuiFormHelperText:{defaultProps:{margin:"dense"}},MuiIconButton:{defaultProps:{size:"small"}},MuiInputBase:{defaultProps:{margin:"dense"}},MuiAutocomplete:{defaultProps:{size:"small"}},MuiInputLabel:{defaultProps:{margin:"dense"}},MuiToolbar:{defaultProps:{variant:"dense"}},MuiListItem:{defaultProps:{dense:!0}},MuiOutlinedInput:{defaultProps:{margin:"dense"}},MuiFab:{defaultProps:{size:"small"},styleOverrides:{secondary:{backgroundColor:null===e||void 0===e||null===(n=e.palette)||void 0===n||null===(t=n.quaternary)||void 0===t?void 0:t.main}}},MuiTable:{defaultProps:{size:"small"}},MuiPopover:{defaultProps:{transitionDuration:0}},MuiMenu:{defaultProps:{transitionDuration:0}},MuiMenuList:{defaultProps:{dense:!0}},MuiMenuItem:{defaultProps:{dense:!0}},MuiTextField:{defaultProps:{margin:"dense",variant:"standard"}},MuiLink:{styleOverrides:{root:function(e){return{color:e.theme.palette.text.secondary}}}},MuiCheckbox:{styleOverrides:{root:function(e){var n=e.theme;return"dark"===n.palette.mode?{color:n.palette.text.secondary,"&.Mui-checked":{color:n.palette.text.secondary}}:void 0}}},MuiRadio:{styleOverrides:{root:function(e){var n=e.theme;return"dark"===n.palette.mode?{color:n.palette.text.secondary,"&.Mui-checked":{color:n.palette.text.secondary}}:void 0}}},MuiFormLabel:{styleOverrides:{root:function(e){var n=e.theme;return"dark"===n.palette.mode?{color:n.palette.text.secondary,"&.Mui-focused":{color:n.palette.text.secondary}}:void 0}}},MuiAccordionSummary:{styleOverrides:{root:{backgroundColor:null===e||void 0===e||null===(r=e.palette)||void 0===r||null===(o=r.tertiary)||void 0===o?void 0:o.main},content:{color:null===e||void 0===e||null===(i=e.palette)||void 0===i||null===(a=i.tertiary)||void 0===a?void 0:a.contrastText}}},MuiToggleButtonGroup:{defaultProps:{size:"small"}}}}}(e)),e||{})}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default";return(0,u.Z)(b("default"===t?f()(n.default,x(e)):function(){var e,n,t,r,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o=x(o),null!==(e=o)&&void 0!==e&&null!==(n=e.palette)&&void 0!==n&&n.quaternary||(o=f()(o,{palette:{quaternary:g.palette.augmentColor({color:{main:"#aaa"}})}}));null!==(t=o)&&void 0!==t&&null!==(r=t.palette)&&void 0!==r&&r.tertiary||(o=f()(o,{palette:{tertiary:g.palette.augmentColor({color:{main:"#aaa"}})}}));return o}(n[t])||n.default))}function x(){var e,n,t,r,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return null!==(e=o)&&void 0!==e&&null!==(n=e.palette)&&void 0!==n&&n.tertiary&&(o=f()(o,{palette:{tertiary:g.palette.augmentColor("color"in o.palette.tertiary?o.palette.tertiary:{color:o.palette.tertiary})}})),null!==(t=o)&&void 0!==t&&null!==(r=t.palette)&&void 0!==r&&r.quaternary&&(o=f()(o,{palette:{quaternary:g.palette.augmentColor("color"in o.palette.quaternary?o.palette.quaternary:{color:o.palette.quaternary})}})),o}},10361:function(e,n,t){t.d(n,{Z:function(){return f}});var r=t(68079),o=t(32723),i=t(96234),a=t(41361),s=t(9249),c=t(87371),u=t(45754),l=t(13820),f=function(e,n,t){(0,u.Z)(d,e);var f=(0,l.Z)(d);function d(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,s.Z)(this,d),e=f.call(this),!(n.maxSize&&n.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"===typeof n.maxAge&&0===n.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");return e.maxSize=n.maxSize,e.maxAge=n.maxAge||Number.POSITIVE_INFINITY,e.onEviction=n.onEviction,e.cache=new Map,e.oldCache=new Map,e._size=0,e}return(0,c.Z)(d,[{key:"_emitEvictions",value:function(e){if("function"===typeof this.onEviction){var n,t=(0,a.Z)(e);try{for(t.s();!(n=t.n()).done;){var r=(0,i.Z)(n.value,2),o=r[0],s=r[1];this.onEviction(o,s.value)}}catch(c){t.e(c)}finally{t.f()}}}},{key:"_deleteIfExpired",value:function(e,n){return"number"===typeof n.expiry&&n.expiry<=Date.now()&&("function"===typeof this.onEviction&&this.onEviction(e,n.value),this.delete(e))}},{key:"_getOrDeleteIfExpired",value:function(e,n){if(!1===this._deleteIfExpired(e,n))return n.value}},{key:"_getItemValue",value:function(e,n){return n.expiry?this._getOrDeleteIfExpired(e,n):n.value}},{key:"_peek",value:function(e,n){var t=n.get(e);return this._getItemValue(e,t)}},{key:"_set",value:function(e,n){this.cache.set(e,n),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}},{key:"_moveToRecent",value:function(e,n){this.oldCache.delete(e),this._set(e,n)}},{key:"_entriesAscending",value:(0,o.Z)().mark((function e(){var n,t,r,s,c,u,l,f,d,p,h,v;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,a.Z)(this.oldCache),e.prev=1,n.s();case 3:if((t=n.n()).done){e.next=13;break}if(r=t.value,s=(0,i.Z)(r,2),c=s[0],u=s[1],this.cache.has(c)){e.next=11;break}if(!1!==this._deleteIfExpired(c,u)){e.next=11;break}return e.next=11,r;case 11:e.next=3;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),n.e(e.t0);case 18:return e.prev=18,n.f(),e.finish(18);case 21:l=(0,a.Z)(this.cache),e.prev=22,l.s();case 24:if((f=l.n()).done){e.next=33;break}if(d=f.value,p=(0,i.Z)(d,2),h=p[0],v=p[1],!1!==this._deleteIfExpired(h,v)){e.next=31;break}return e.next=31,d;case 31:e.next=24;break;case 33:e.next=38;break;case 35:e.prev=35,e.t1=e.catch(22),l.e(e.t1);case 38:return e.prev=38,l.f(),e.finish(38);case 41:case"end":return e.stop()}}),e,this,[[1,15,18,21],[22,35,38,41]])}))},{key:"get",value:function(e){if(this.cache.has(e)){var n=this.cache.get(e);return this._getItemValue(e,n)}if(this.oldCache.has(e)){var t=this.oldCache.get(e);if(!1===this._deleteIfExpired(e,t))return this._moveToRecent(e,t),t.value}}},{key:"set",value:function(e,n){var t=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).maxAge,r=void 0===t?this.maxAge:t,o="number"===typeof r&&r!==Number.POSITIVE_INFINITY?Date.now()+r:void 0;this.cache.has(e)?this.cache.set(e,{value:n,expiry:o}):this._set(e,{value:n,expiry:o})}},{key:"has",value:function(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):!!this.oldCache.has(e)&&!this._deleteIfExpired(e,this.oldCache.get(e))}},{key:"peek",value:function(e){return this.cache.has(e)?this._peek(e,this.cache):this.oldCache.has(e)?this._peek(e,this.oldCache):void 0}},{key:"delete",value:function(e){var n=this.cache.delete(e);return n&&this._size--,this.oldCache.delete(e)||n}},{key:"clear",value:function(){this.cache.clear(),this.oldCache.clear(),this._size=0}},{key:"resize",value:function(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");var n=(0,r.Z)(this._entriesAscending()),t=n.length-e;t<0?(this.cache=new Map(n),this.oldCache=new Map,this._size=n.length):(t>0&&this._emitEvictions(n.slice(0,t)),this.oldCache=new Map(n.slice(t)),this.cache=new Map,this._size=0),this.maxSize=e}},{key:"keys",value:(0,o.Z)().mark((function e(){var n,t,r,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,a.Z)(this),e.prev=1,n.s();case 3:if((t=n.n()).done){e.next=9;break}return r=(0,i.Z)(t.value,1),s=r[0],e.next=7,s;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"values",value:(0,o.Z)().mark((function e(){var n,t,r,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,a.Z)(this),e.prev=1,n.s();case 3:if((t=n.n()).done){e.next=9;break}return r=(0,i.Z)(t.value,2),s=r[1],e.next=7,s;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:n,value:(0,o.Z)().mark((function(){var e,n,t,r,s,c,u,l,f,d,p,h;return(0,o.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:e=(0,a.Z)(this.cache),o.prev=1,e.s();case 3:if((n=e.n()).done){o.next=12;break}if(t=n.value,r=(0,i.Z)(t,2),s=r[0],c=r[1],!1!==this._deleteIfExpired(s,c)){o.next=10;break}return o.next=10,[s,c.value];case 10:o.next=3;break;case 12:o.next=17;break;case 14:o.prev=14,o.t0=o.catch(1),e.e(o.t0);case 17:return o.prev=17,e.f(),o.finish(17);case 20:u=(0,a.Z)(this.oldCache),o.prev=21,u.s();case 23:if((l=u.n()).done){o.next=33;break}if(f=l.value,d=(0,i.Z)(f,2),p=d[0],h=d[1],this.cache.has(p)){o.next=31;break}if(!1!==this._deleteIfExpired(p,h)){o.next=31;break}return o.next=31,[p,h.value];case 31:o.next=23;break;case 33:o.next=38;break;case 35:o.prev=35,o.t1=o.catch(21),u.e(o.t1);case 38:return o.prev=38,u.f(),o.finish(38);case 41:case"end":return o.stop()}}),c,this,[[1,14,17,20],[21,35,38,41]])}))},{key:"entriesDescending",value:(0,o.Z)().mark((function e(){var n,t,a,s,c,u,l,f,d,p,h;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,r.Z)(this.cache),t=n.length-1;case 2:if(!(t>=0)){e.next=12;break}if(a=n[t],s=(0,i.Z)(a,2),c=s[0],u=s[1],!1!==this._deleteIfExpired(c,u)){e.next=9;break}return e.next=9,[c,u.value];case 9:--t,e.next=2;break;case 12:n=(0,r.Z)(this.oldCache),l=n.length-1;case 14:if(!(l>=0)){e.next=25;break}if(f=n[l],d=(0,i.Z)(f,2),p=d[0],h=d[1],this.cache.has(p)){e.next=22;break}if(!1!==this._deleteIfExpired(p,h)){e.next=22;break}return e.next=22,[p,h.value];case 22:--l,e.next=14;break;case 25:case"end":return e.stop()}}),e,this)}))},{key:"entriesAscending",value:(0,o.Z)().mark((function e(){var n,t,r,s,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,a.Z)(this._entriesAscending()),e.prev=1,n.s();case 3:if((t=n.n()).done){e.next=9;break}return r=(0,i.Z)(t.value,2),s=r[0],c=r[1],e.next=7,[s,c.value];case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"size",get:function(){if(!this._size)return this.oldCache.size;var e,n=0,t=(0,a.Z)(this.oldCache.keys());try{for(t.s();!(e=t.n()).done;){var r=e.value;this.cache.has(r)||n++}}catch(o){t.e(o)}finally{t.f()}return Math.min(this._size+n,this.maxSize)}},{key:"entries",value:function(){return this.entriesAscending()}},{key:"forEach",value:function(e){var n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,r=(0,a.Z)(this.entriesAscending());try{for(r.s();!(n=r.n()).done;){var o=(0,i.Z)(n.value,2),s=o[0],c=o[1];e.call(t,c,s,this)}}catch(u){r.e(u)}finally{r.f()}}},{key:t,get:function(){return JSON.stringify((0,r.Z)(this.entriesAscending()))}}]),d}((0,t(30364).Z)(Map),Symbol.iterator,Symbol.toStringTag)},97531:function(e,n,t){t.r(n),t.d(n,{AuthNeededError:function(){return v.yb},ImageBitmapType:function(){return L.Ck},ReactRendering:function(){return O.AN},RetryError:function(){return v.Ms},SimpleFeature:function(){return h.Z},abortBreakPoint:function(){return T},assembleLocString:function(){return Q},assembleLocStringFast:function(){return K},avg:function(){return en},blobToDataURL:function(){return Se},bpSpanPx:function(){return le},bpToPx:function(){return te},bytesForRegions:function(){return Le},cartesianToPolar:function(){return ce},checkAbortSignal:function(){return S},clamp:function(){return ne},compareLocStrings:function(){return ee},compareLocs:function(){return X},complement:function(){return Ze},createCanvas:function(){return L.vL},createImageBitmap:function(){return L.MC},dedupe:function(){return D.D},defaultCodonTable:function(){return Pe},defaultStarts:function(){return je},defaultStops:function(){return Ee},degToRad:function(){return ae},doesIntersect2:function(){return N.qY},drawImageOntoCanvasContext:function(){return L.kv},featureSpanPx:function(){return ue},findLastIndex:function(){return de},findParentThat:function(){return B},findParentThatIs:function(){return q},generateCodonTable:function(){return Me},getBpDisplayStr:function(){return Ue},getContainingDisplay:function(){return H},getContainingTrack:function(){return J},getContainingView:function(){return F},getEnv:function(){return He},getLayoutId:function(){return Ve},getSerializedSvg:function(){return O.E9},getSession:function(){return G},getStr:function(){return Fe},getTickDisplayStr:function(){return _e},getUriLink:function(){return Ge},getViewParams:function(){return Be},hashCode:function(){return Ne},inDevelopment:function(){return W},inProduction:function(){return U},intersection2:function(){return N.U0},isAbortException:function(){return P},isAbstractMenuManager:function(){return v.J0},isAppRootModel:function(){return v.dc},isAuthNeededException:function(){return v.PK},isContainedWithin:function(){return N.J7},isDisplayModel:function(){return v.yZ},isElectron:function(){return we},isFeature:function(){return h.T},isRetryException:function(){return v.Z6},isRootModelWithInternetAccounts:function(){return v.At},isSelectionContainer:function(){return v.zL},isSessionModel:function(){return v.k$},isSessionModelWithConfigEditing:function(){return v.cX},isSessionModelWithConnections:function(){return v.gC},isSessionModelWithWidgets:function(){return v.gI},isSessionWithAddTracks:function(){return v._L},isSessionWithSessionPlugins:function(){return v.uF},isTrackModel:function(){return v.d6},isTrackViewModel:function(){return v.Um},isUriLocation:function(){return v.hb},isViewContainer:function(){return v.BQ},isViewModel:function(){return v.zN},iterMap:function(){return fe},localStorageGetItem:function(){return Qe},localStorageSetItem:function(){return Ke},makeAbortError:function(){return j},makeAbortableReaction:function(){return pe},max:function(){return Ye},measureGridWidth:function(){return Je},measureText:function(){return Ae},min:function(){return $e},minmax:function(){return me},objectHash:function(){return De},observeAbortSignal:function(){return E},parseLocString:function(){return $},parseLocStringOneBased:function(){return Y},polarToCartesian:function(){return se},rIC:function(){return Ce},radToDeg:function(){return ie},renameRegionIfNeeded:function(){return he},renameRegionsIfNeeded:function(){return ve},renderToAbstractCanvas:function(){return O.Cj},revcom:function(){return xe},reverse:function(){return ke},shorten:function(){return ye},springAnimate:function(){return V},stringify:function(){return be},sum:function(){return Xe},supportedIndexingAdapters:function(){return We},toLocale:function(){return ze},updateStatus:function(){return Ie},useDebounce:function(){return z},useDebouncedCallback:function(){return _},useLocalStorage:function(){return qe},when:function(){return M},whenPresent:function(){return I}});var r=t(33028),o=t(32723),i=t(34795),a=t(41361),s=t(68079),c=t(96234),u=t(96902),l=t(71112),f=t.n(l),d=t(63680),p=t(75717),h=t(43430),v=t(73),g=t(87371),m=t(9249),y=t(45754),b=t(13820),w=t(30364),x=t(6160),k=t(70307),Z=function(e){(0,y.Z)(t,e);var n=(0,b.Z)(t);function t(){var e;(0,m.Z)(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=n.call.apply(n,[this].concat(o))).code=void 0,e}return(0,g.Z)(t)}((0,w.Z)(Error));function S(e){if(e){if(!(e instanceof AbortSignal))throw new TypeError("must pass an AbortSignal");if(e.aborted)throw j()}}function C(e){return new Promise((function(n){return setTimeout(n,e)}))}function T(e){return A.apply(this,arguments)}function A(){return(A=(0,i.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(1);case 2:S(n);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(){if("undefined"!==typeof DOMException)return new DOMException("aborted","AbortError");var e=new Z("aborted");return e.code="ERR_ABORTED",e}function E(e){return e?(0,k.R)(e,"abort"):x.y.create()}function P(e){return e instanceof Error&&("AbortError"===e.name||"ERR_ABORTED"===e.code||!!e.message.match(/\b(aborted|AbortError)\b/i))}function M(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.timeout,r=n.signal,o=n.name;return new Promise((function(n,i){var a,s=!1,c=(0,p.when)(e),u=function(){};t&&(a=setTimeout((function(){s||(s=!0,c.cancel(),i(new Error("timed out waiting for ".concat(o||"whenPresent"))))}),t),u=function(){return a&&clearTimeout(a)}),r&&r.addEventListener("abort",(function(){s||(s=!0,c.cancel(),u(),i(j()))})),c.then((function(){s||(s=!0,u(),n(!0))})).catch((function(e){s||(s=!0,u(),i(e))}))}))}function I(e){return R.apply(this,arguments)}function R(){return R=(0,i.Z)((0,o.Z)().mark((function e(n){var t,r=arguments;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>1&&void 0!==r[1]?r[1]:{},e.next=3,M((function(){var e=n();return void 0!==e&&null!==e}),t);case 3:return e.abrupt("return",n());case 4:case"end":return e.stop()}}),e)}))),R.apply(this,arguments)}var N=t(23995),D=t(29943),L=t(15446),O=t(31440),W="object"===typeof t(80341)&&{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}&&!1,U=!W;function z(e,n){var t=(0,u.useState)(e),r=(0,c.Z)(t,2),o=r[0],i=r[1];return(0,u.useEffect)((function(){var t=setTimeout((function(){i(e)}),n);return function(){clearTimeout(t)}}),[e,n]),o}function _(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,t=(0,u.useRef)(),r=(0,u.useRef)();function o(){r.current&&clearTimeout(r.current)}return(0,u.useEffect)((function(){return o}),[]),function(){for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];t.current=a,o(),r.current=setTimeout((function(){t.current&&e.apply(void 0,(0,s.Z)(t.current))}),n)}}function B(e,n){if(!(0,d.hasParent)(e))throw new Error("node does not have parent");for(var t=(0,d.getParent)(e);t&&(0,d.isAlive)(t);){if(n(t))return t;if(!(0,d.hasParent)(t))break;t=(0,d.getParent)(t)}throw new Error("no matching node found")}function V(e,n,t){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:170,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:26,c=1;function u(e){var l=Date.now(),f=e.lastPosition,d=e.lastTime||l,p=e.lastVelocity||0;l>d+64&&(d=l);for(var h=Math.floor(l-d),v=0;v<h;++v){f+=1*(p+=1*((-a*(f-n)+-s*p)/c)/1e3)/1e3}var g=Math.abs(p)<=i,m=0===a||Math.abs(n-f)<=i;g&&m?(t(n),o()):(t(f),r=requestAnimationFrame((function(){return u({lastPosition:f,lastTime:l,lastVelocity:p})})))}return i||(i=Math.abs(n-e)/1e3),[function(){return u({lastPosition:e})},function(){return cancelAnimationFrame(r)}]}function q(e,n){return B(e,n)}function G(e){try{return q(e,v.k$)}catch(n){throw new Error("no session model found!")}}function F(e){try{return q(e,v.zN)}catch(n){throw new Error("no containing view found")}}function J(e){try{return q(e,v.d6)}catch(n){throw new Error("no containing track found")}}function H(e){try{return q(e,v.yZ)}catch(n){throw new Error("no containing display found")}}function Q(e){return K(e,ze)}function K(e){var n,t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e},o=e.assemblyName,i=e.refName,a=e.start,s=e.end,c=e.reversed,u=o?"{".concat(o,"}"):"";n=void 0!==a?":".concat(r(a+1)):void 0!==s?":1":"",t=void 0!==s?void 0!==a&&a+1===s?"":"..".concat(r(s)):void 0!==a?"..":"";var l="";return c&&(l="[rev]"),"".concat(u).concat(i).concat(n).concat(t).concat(l)}function Y(e,n){if(!e)throw new Error("no location string provided, could not parse");var t=!1;e.endsWith("[rev]")&&(t=!0,e=e.replace(/\[rev\]$/,""));var r=(e=e.replace(/\s/,"")).match(/(\{(.+)\})?(.+)/);if(!r)throw new Error('invalid location string: "'.concat(e,'"'));var o=(0,c.Z)(r,4),i=o[2],a=o[3];if(!i&&a.startsWith("{}"))throw new Error('no assembly name was provided in location "'.concat(a,'"'));var s=a.lastIndexOf(":");if(-1===s){if(n(a,i))return{assemblyName:i,refName:a,reversed:t};throw new Error('Unknown reference sequence "'.concat(a,'"'))}var u=a.slice(0,s),l=a.slice(s+1);if(n(u,i)&&n(a,i))throw new Error('ambiguous location string: "'.concat(e,'"'));if(n(u,i)){if(!l)return{assemblyName:i,refName:u,reversed:t};var f=l.match(/^(-?(\d+|\d{1,3}(,\d{3})*))(\.\.|-)(-?(\d+|\d{1,3}(,\d{3})*))$/),d=l.match(/^(-?(\d+|\d{1,3}(,\d{3})*))(\.\.|-)?$/);if(f){var p=(0,c.Z)(f,6),h=p[1],v=p[5];if(void 0!==h&&void 0!==v)return{assemblyName:i,refName:u,start:+h.replace(/,/g,""),end:+v.replace(/,/g,""),reversed:t}}else{if(!d)throw new Error('could not parse range "'.concat(l,'" on location "').concat(e,'"'));var g=(0,c.Z)(d,5),m=g[1],y=g[4];if(void 0!==m)return y?{assemblyName:i,refName:u,start:+m.replace(/,/g,""),reversed:t}:{assemblyName:i,refName:u,start:+m.replace(/,/g,""),end:+m.replace(/,/g,""),reversed:t}}}else if(n(a,i))return{assemblyName:i,refName:a,reversed:t};throw new Error('unknown reference sequence name in location "'.concat(e,'"'))}function $(e,n){var t=Y(e,n);return"number"===typeof t.start&&(t.start-=1),t}function X(e,n){var t=e.assemblyName||n.assemblyName?(e.assemblyName||"").localeCompare(n.assemblyName||""):0;if(t)return t;var r=e.refName||n.refName?(e.refName||"").localeCompare(n.refName||""):0;if(r)return r;if(void 0!==e.start&&void 0!==n.start){var o=e.start-n.start;if(o)return o}if(void 0!==e.end&&void 0!==n.end){var i=e.end-n.end;if(i)return i}return 0}function ee(e,n,t){return X($(e,t),$(n,t))}function ne(e,n,t){return e<n?n:e>t?t:e}function te(e,n,t){var r,o=n.reversed,i=n.end,a=void 0===i?0:i,s=n.start;return r=(o?a-e:e-(void 0===s?0:s))/t,Math.round(10*r)/10}var re=180/Math.PI,oe=Math.PI/180;function ie(e){return e*re%360}function ae(e){return e*oe%(2*Math.PI)}function se(e,n){return[e*Math.cos(n),e*Math.sin(n)]}function ce(e,n){return[Math.sqrt(e*e+n*n),Math.atan(n/e)]}function ue(e,n,t){return le(e.get("start"),e.get("end"),n,t)}function le(e,n,t,r){var o=te(e,t,r),i=te(n,t,r);return t.reversed?[i,o]:[o,i]}function fe(e,n,t){var r,o=t?new Array(t):[],i=0,s=(0,a.Z)(e);try{for(s.s();!(r=s.n()).done;){var c=r.value;o[i]=n(c),i+=1}}catch(u){s.e(u)}finally{s.f()}return o}function de(e,n){for(var t=e.length;t--;)if(n(e[t],t,e))return t;return-1}function pe(e,n,t,r,a,s,c){var u;function l(n){P(n)||((0,d.isAlive)(e)?c(n):console.error(n))}(0,d.addDisposer)(e,(0,p.reaction)((function(){try{return n(e)}catch(t){return void l(t)}}),function(){var n=(0,i.Z)((0,o.Z)().mark((function n(r,i){var c,f;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(u&&!u.signal.aborted&&u.abort(),(0,d.isAlive)(e)){n.next=3;break}return n.abrupt("return");case 3:return u=new AbortController,a(c=u),n.prev=6,n.next=9,t(r,c.signal,e,i);case 9:f=n.sent,S(c.signal),(0,d.isAlive)(e)&&s(f),n.next=18;break;case 14:n.prev=14,n.t0=n.catch(6),c&&!c.signal.aborted&&c.abort(),l(n.t0);case 18:case"end":return n.stop()}}),n,null,[[6,14]])})));return function(e,t){return n.apply(this,arguments)}}(),r)),(0,d.addDisposer)(e,(function(){u&&!u.signal.aborted&&u.abort()}))}function he(e,n){if((0,d.isStateTreeNode)(n)&&!(0,d.isAlive)(n))return n;if(n&&e&&e[n.refName]){var t=e[(n=(0,d.isStateTreeNode)(n)?(0,r.Z)({},(0,d.getSnapshot)(n)):(0,r.Z)({},n)).refName];if(t)return(0,r.Z)((0,r.Z)({},n),{},{refName:t,originalRefName:n.refName})}return n}function ve(e,n){return ge.apply(this,arguments)}function ge(){return ge=(0,i.Z)((0,o.Z)().mark((function e(n,t){var a,s,c,u,l;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.regions,s=void 0===a?[]:a,c=t.adapterConfig,t.sessionId){e.next=3;break}throw new Error("sessionId is required");case 3:return u=s.map((function(e){return e.assemblyName})),e.t0=Object,e.next=7,Promise.all(u.map(function(){var e=(0,i.Z)((0,o.Z)().mark((function e(r){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=r,e.next=3,n.getRefNameMapForAdapter(c,r,t);case 3:return e.t1=e.sent,e.abrupt("return",[e.t0,e.t1]);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 7:return e.t1=e.sent,l=e.t0.fromEntries.call(e.t0,e.t1),e.abrupt("return",(0,r.Z)((0,r.Z)({},t),{},{regions:s.map((function(e,n){return he(l[u[n]],e)}))}));case 10:case"end":return e.stop()}}),e)}))),ge.apply(this,arguments)}function me(e,n){return[Math.min(e,n),Math.max(e,n)]}function ye(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:70,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;return e.length>n?e.slice(0,t)+"..."+e.slice(-t):e}function be(e){var n=e.refName,t=e.coord,r=e.oob;return n?"".concat(ye(n),":").concat(ze(t)).concat(r?" (out of bounds)":""):""}var we=/electron/i.test("undefined"!==typeof navigator?navigator.userAgent:"");function xe(e){return ke(Ze(e))}function ke(e){return e.split("").reverse().join("")}var Ze=function(){var e=/[ACGT]/gi,n={S:"S",w:"w",T:"A",r:"y",a:"t",N:"N",K:"M",x:"x",d:"h",Y:"R",V:"B",y:"r",M:"K",h:"d",k:"m",C:"G",g:"c",t:"a",A:"T",n:"n",W:"W",X:"X",m:"k",v:"b",B:"V",s:"s",H:"D",c:"g",D:"H",b:"v",R:"Y",G:"C"};return function(t){return t.replace(e,(function(e){return n[e]||""}))}}();function Se(e){var n=new FileReader;return new Promise((function(t,r){n.onload=function(e){e.target?t(e.target.result):r(new Error("unknown result reading blob from canvas"))},n.readAsDataURL(e)}))}var Ce="undefined"===typeof jest?"undefined"!==typeof window&&window.requestIdleCallback?window.requestIdleCallback:function(e){return setTimeout((function(){return e()}),1)}:function(e){return e()},Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2796875,.2765625,.3546875,.5546875,.5546875,.8890625,.665625,.190625,.3328125,.3328125,.3890625,.5828125,.2765625,.3328125,.2765625,.3015625,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.2765625,.2765625,.584375,.5828125,.584375,.5546875,1.0140625,.665625,.665625,.721875,.721875,.665625,.609375,.7765625,.721875,.2765625,.5,.665625,.5546875,.8328125,.721875,.7765625,.665625,.7765625,.721875,.665625,.609375,.721875,.665625,.94375,.665625,.665625,.609375,.2765625,.3546875,.2765625,.4765625,.5546875,.3328125,.5546875,.5546875,.5,.5546875,.5546875,.2765625,.5546875,.5546875,.221875,.240625,.5,.221875,.8328125,.5546875,.5546875,.5546875,.5546875,.3328125,.5,.2765625,.5546875,.5,.721875,.5,.5,.5,.3546875,.259375,.353125,.5890625];function Ae(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,t=String(e),r=0,o=0;o<t.length;o++){var i,a=t.charCodeAt(o);r+=null!==(i=Te[a])&&void 0!==i?i:.5279276315789471}return r*n}var je=["ATG"],Ee=["TAA","TAG","TGA"],Pe={TCA:"S",TCC:"S",TCG:"S",TCT:"S",TTC:"F",TTT:"F",TTA:"L",TTG:"L",TAC:"Y",TAT:"Y",TAA:"*",TAG:"*",TGC:"C",TGT:"C",TGA:"*",TGG:"W",CTA:"L",CTC:"L",CTG:"L",CTT:"L",CCA:"P",CCC:"P",CCG:"P",CCT:"P",CAC:"H",CAT:"H",CAA:"Q",CAG:"Q",CGA:"R",CGC:"R",CGG:"R",CGT:"R",ATA:"I",ATC:"I",ATT:"I",ATG:"M",ACA:"T",ACC:"T",ACG:"T",ACT:"T",AAC:"N",AAT:"N",AAA:"K",AAG:"K",AGC:"S",AGT:"S",AGA:"R",AGG:"R",GTA:"V",GTC:"V",GTG:"V",GTT:"V",GCA:"A",GCC:"A",GCG:"A",GCT:"A",GAC:"D",GAT:"D",GAA:"E",GAG:"E",GGA:"G",GGC:"G",GGG:"G",GGT:"G"};function Me(e){var n={};return Object.keys(e).forEach((function(t){for(var r=e[t],o=[],i=0;i<3;i++){var a=t.charAt(i);o[i]=[],o[i][0]=a.toUpperCase(),o[i][1]=a.toLowerCase()}for(var s=0;s<2;s++)for(var c=o[0][s],u=0;u<2;u++)for(var l=o[1][u],f=0;f<2;f++){var d=o[2][f];n[c+l+d]=r}})),n}function Ie(e,n,t){return Re.apply(this,arguments)}function Re(){return(Re=(0,i.Z)((0,o.Z)().mark((function e(n,t,r){var i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(n),e.next=3,r();case 3:return i=e.sent,t(""),e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ne(e){var n=0;if(0===e.length)return n;for(var t=0;t<e.length;t++){n=(n<<5)-n+e.charCodeAt(t),n|=0}return n}function De(e){return"".concat(Ne(JSON.stringify(e)))}function Le(e,n){return Oe.apply(this,arguments)}function Oe(){return(Oe=(0,i.Z)((0,o.Z)().mark((function e(n,t){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(n.map((function(e){return t.blocksForRange(e.refName,e.start,e.end)})));case 2:return r=e.sent,e.abrupt("return",r.flat().map((function(e){return{start:e.minv.blockPosition,end:e.maxv.blockPosition+65535}})).reduce((function(e,n){return e+n.end-n.start}),0));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function We(e){return["Gff3TabixAdapter","VcfTabixAdapter","Gff3Adapter","VcfAdapter"].includes(e)}function Ue(e){return Math.floor(e/1e6)>0?"".concat(parseFloat((e/1e6).toPrecision(3)),"Mbp"):Math.floor(e/1e3)>0?"".concat(parseFloat((e/1e3).toPrecision(3)),"Kbp"):"".concat(ze(Math.floor(e)),"bp")}function ze(e){return e.toLocaleString("en-US")}function _e(e,n){return Math.floor(n/1e3)>0?"".concat(ze(parseFloat((e/1e6).toFixed(2))),"M"):"".concat(ze(Math.floor(e)))}function Be(e,n){var t=F(e),r=t.dynamicBlocks,o=t.staticBlocks,i=t.offsetPx,a=(null===r||void 0===r?void 0:r.contentBlocks[0])||{},s=(null===o||void 0===o?void 0:o.contentBlocks[0])||{},c=(null===o||void 0===o?void 0:o.contentBlocks[1])||{};return{offsetPx:n?0:i-s.offsetPx,offsetPx1:n?0:i-c.offsetPx,start:a.start,end:a.end}}function Ve(e){return e.sessionId+"-"+e.layoutId}function qe(e,n){var t=(0,u.useState)((function(){if("undefined"===typeof window)return n;try{var t=window.localStorage.getItem(e);return t?JSON.parse(t):n}catch(r){return console.error(r),n}})),r=(0,c.Z)(t,2),o=r[0],i=r[1];return[o,function(n){try{var t=n instanceof Function?n(o):n;i(t),"undefined"!==typeof window&&window.localStorage.setItem(e,JSON.stringify(t))}catch(r){console.error(r)}}]}function Ge(e){var n,t=e.uri,r=e.baseUri,o=void 0===r?"":r;try{n=new URL(t,o).href}catch(i){n=t}return n}function Fe(e){return f()(e)?(0,v.hb)(e)?Ge(e):JSON.stringify(e):String(e)}function Je(e,n){var t=n||{},r=t.padding,o=void 0===r?30:r,i=t.minWidth,a=void 0===i?80:i,s=t.fontSize,c=void 0===s?12:s,u=t.maxWidth,l=void 0===u?1e3:u,f=t.stripHTML,d=void 0!==f&&f;return Ye(e.map((function(e){return Fe(e)})).map((function(e){return d?e.replace(/(<([^>]+)>)/gi,""):e})).map((function(e){return Ae(e,c)})).map((function(e){return Math.min(Math.max(e+o,a),l)})))}function He(e){return(0,d.getEnv)(e)}function Qe(e){return"undefined"!==typeof localStorage?localStorage.getItem(e):void 0}function Ke(e,n){return"undefined"!==typeof localStorage?localStorage.setItem(e,n):void 0}function Ye(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0,t=0;t<e.length;t++)n=e[t]>n?e[t]:n;return n}function $e(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,t=0;t<e.length;t++)n=e[t]<n?e[t]:n;return n}function Xe(e){for(var n=0,t=0;t<e.length;t++)n+=e[t];return n}function en(e){return Xe(e)/e.length}},15446:function(e,n,t){t.d(n,{Ck:function(){return i},MC:function(){return o},kv:function(){return f},vL:function(){return r}});var r,o,i,a=t(32723),s=t(34795),c=t(19522),u=t.n(c),l=t(31910);function f(e,n){e.serializedCommands?new l.CanvasSequence(e.serializedCommands).execute(n):n.drawImage(e,0,0)}var d="function"===typeof OffscreenCanvas,p=u();d?(r=function(e,n){return new OffscreenCanvas(e,n)},o=window.createImageBitmap||self.createImageBitmap,i=window.ImageBitmap||self.ImageBitmap):p?(r=function(){return nodeCreateCanvas.apply(void 0,arguments)},o=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(n){var t,r,o=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.length<=1||!(o.length-1)){e.next=2;break}throw new Error("only one-argument uses of createImageBitmap are supported by the node offscreencanvas ponyfill");case 2:return t=n.toDataURL(),r=new nodeImage,e.abrupt("return",new Promise((function(e,n){r.onload=function(){return e(r)},r.onerror=n,r.src=t})));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()):(r=function(e,n){var t=new l.CanvasSequence;return{width:e,height:n,getContext:function(){return t}}},o=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(n){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.getContext("2d"),e.abrupt("return",{height:n.height,width:n.width,serializedCommands:t.toJSON(),containsNoTransferables:!0});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),i=String)},31440:function(e,n,t){t.d(n,{AN:function(){return v},Cj:function(){return f},E9:function(){return p}});var r=t(32723),o=t(33028),i=t(34795),a=t(96902),s=t(31910),c=t(15446),u=t(97531),l=t(29938);function f(e,n,t,r){return d.apply(this,arguments)}function d(){return(d=(0,i.Z)((0,r.Z)().mark((function e(n,t,i,a){var f,d,p,h,v,g,m,y,b,w,x,k,Z;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f=i.exportSVG,d=i.highResolutionScaling,p=void 0===d?1:d,!f){e.next=43;break}if(f.rasterizeLayers){e.next=10;break}return h=new s.CanvasSequence,e.next=6,a(h);case 6:return v=e.sent,e.abrupt("return",(0,o.Z)((0,o.Z)({},v),{},{canvasRecordedData:h.toJSON()}));case 10:if(g=f.scale||p,m=(0,c.vL)(Math.ceil(n*g),t*g),y=m.getContext("2d")){e.next=15;break}throw new Error("2d canvas rendering not supported on this platform");case 15:return y.scale(g,g),e.next=18,a(y);case 18:if(b=e.sent,e.t0=o.Z,e.t1=(0,o.Z)({},b),e.t2={},e.t3=l.jsx,e.t4=n,e.t5=t,!("convertToBlob"in m)){e.next=35;break}return e.t7=u.blobToDataURL,e.next=29,m.convertToBlob({type:"image/png"});case 29:return e.t8=e.sent,e.next=32,(0,e.t7)(e.t8);case 32:e.t6=e.sent,e.next=36;break;case 35:e.t6=m.toDataURL("image/png");case 36:return e.t9=e.t6,e.t10={width:e.t4,height:e.t5,xlinkHref:e.t9},e.t11=(0,e.t3)("image",e.t10),e.t12={reactElement:e.t11},e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t12));case 41:e.next=60;break;case 43:if(w=p,x=(0,c.vL)(Math.ceil(n*w),t*w),k=x.getContext("2d")){e.next=48;break}throw new Error("2d canvas rendering not supported on this platform");case 48:return k.scale(w,w),e.next=51,a(k);case 51:return Z=e.sent,e.t13=o.Z,e.t14=(0,o.Z)({},Z),e.t15={},e.next=57,(0,c.MC)(x);case 57:return e.t16=e.sent,e.t17={imageData:e.t16},e.abrupt("return",(0,e.t13)(e.t14,e.t15,e.t17));case 60:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return h.apply(this,arguments)}function h(){return(h=(0,i.Z)((0,r.Z)().mark((function e(n){var o,i,a,c,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.width,i=n.height,a=n.canvasRecordedData,e.next=3,t.e(7911).then(t.t.bind(t,47911,23));case 3:return c=e.sent,u=new c.default(o,i),new s.CanvasSequence(a).execute(u),e.abrupt("return",u.getSvg().innerHTML);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){var n=e.rendering;return(0,l.jsx)(l.Fragment,{children:a.isValidElement(n.reactElement)?n.reactElement:(0,l.jsx)("g",{dangerouslySetInnerHTML:{__html:n.html||""}})})}},73:function(e,n,t){t.d(n,{At:function(){return Z},BQ:function(){return l},J0:function(){return S},Ms:function(){return A},PK:function(){return j},Um:function(){return x},Z6:function(){return E},_L:function(){return p},cX:function(){return d},d6:function(){return b},dc:function(){return k},gC:function(){return v},gI:function(){return h},hb:function(){return C},k$:function(){return f},uF:function(){return g},yZ:function(){return w},yb:function(){return T},zL:function(){return m},zN:function(){return y}});var r=t(87371),o=t(9249),i=t(80753),a=t(45754),s=t(13820),c=t(30364),u=t(63680);function l(e){return(0,u.isStateTreeNode)(e)&&"removeView"in e&&"addView"in e&&"views"in e}function f(e){return"object"===typeof e&&null!==e&&"rpcManager"in e&&"configuration"in e}function d(e){return f(e)&&"editConfiguration"in e}function p(e){return f(e)&&"addTrackConf"in e&&!e.disableAddTracks}function h(e){return f(e)&&"widgets"in e}function v(e){return f(e)&&"addConnectionConf"in e}function g(e){return f(e)&&"sessionPlugins"in e}function m(e){return"object"===typeof e&&null!==e&&"selection"in e&&"setSelection"in e}function y(e){return"object"===typeof e&&null!==e&&"width"in e&&"setWidth"in e}function b(e){return"object"===typeof e&&null!==e&&"configuration"in e&&e.configuration.trackId}function w(e){return"object"===typeof e&&null!==e&&"configuration"in e&&e.configuration.displayId}function x(e){return"object"===typeof e&&null!==e&&"showTrack"in e&&"hideTrack"in e}function k(e){return"object"===typeof e&&null!==e&&"isAssemblyEditing"in e&&"findAppropriateInternetAccount"in e}function Z(e){return"object"===typeof e&&null!==e&&"internetAccounts"in e&&"findAppropriateInternetAccount"in e}function S(e){return"object"===typeof e&&null!==e&&"appendMenu"in e&&"appendToSubMenu"in e}function C(e){return"object"===typeof e&&null!==e&&"uri"in e&&!!e.uri}var T=function(e){(0,a.Z)(t,e);var n=(0,s.Z)(t);function t(e,r){var a;return(0,o.Z)(this,t),(a=n.call(this,e)).message=e,a.url=r,a.name="AuthNeededError",Object.setPrototypeOf((0,i.Z)(a),t.prototype),a}return(0,r.Z)(t)}((0,c.Z)(Error)),A=function(e){(0,a.Z)(t,e);var n=(0,s.Z)(t);function t(e,r){var i;return(0,o.Z)(this,t),(i=n.call(this,e)).message=e,i.internetAccountId=r,i.name="RetryError",i}return(0,r.Z)(t)}((0,c.Z)(Error));function j(e){return e instanceof Error&&("AuthNeededError"===e.name||void 0!==e.url)}function E(e){return"RetryError"===e.name||void 0!==e.internetAccountId}},13942:function(e,n,t){t.r(n),t.d(n,{Loader:function(){return tr},default:function(){return cr}});var r=t(68079),o=t(32723),i=t(34795),a=t(33028),s=t(59740),c=t(96234),u=t(96902),l=t(41361),f=t(9249),d=t(87371),p=t(63680),h=t(57173),v=t(5868),g=t(55385),m=t(95984),y=t(65317),b=t(26347),w=t(73561),x=t(62145),k=t(7857),Z=t(28204),S=t(6769),C=t(99836),T=t(20167),A=t(99245),j=t(47901),E=function(){function e(){(0,f.Z)(this,e),this.phaseCallbacks=new Map,this.phaseOrder=[];for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];this.phaseOrder=t}return(0,d.Z)(e,[{key:"add",value:function(e,n){if(!this.phaseOrder.includes(e))throw new Error("unknown phase ".concat(e));var t=this.phaseCallbacks.get(e);t||(t=[],this.phaseCallbacks.set(e,t)),t.push(n)}},{key:"run",value:function(){var e=this;this.phaseOrder.forEach((function(n){var t;null===(t=e.phaseCallbacks.get(n))||void 0===t||t.forEach((function(e){return e()}))}))}}]),e}(),P=function(){function e(n,t){(0,f.Z)(this,e),this.typeName=n,this.baseClass=t,this.registeredTypes={}}return(0,d.Z)(e,[{key:"add",value:function(e,n){this.registeredTypes[e]=n}},{key:"has",value:function(e){return e in this.registeredTypes}},{key:"get",value:function(e){if(!this.has(e))throw new Error("".concat(this.typeName," '").concat(e,"' not found, perhaps its plugin is not loaded or its plugin has not added it."));return this.registeredTypes[e]}},{key:"all",value:function(){return Object.values(this.registeredTypes)}}]),e}(),M=function(){function e(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,f.Z)(this,e),this.plugins=[],this.jexl=(0,j.Z)(),this.pluginMetadata={},this.runtimePluginDefinitions=[],this.elementCreationSchedule=new E("renderer","adapter","text search adapter","display","track","connection","view","widget","rpc method","internet account","add track workflow"),this.rendererTypes=new P("RendererType",h.default),this.adapterTypes=new P("AdapterType",v.Z),this.textSearchAdapterTypes=new P("TextSearchAdapterType",Z.Z),this.trackTypes=new P("TrackType",g.Z),this.displayTypes=new P("DisplayType",m.Z),this.connectionTypes=new P("ConnectionType",w.Z),this.viewTypes=new P("ViewType",y.Z),this.widgetTypes=new P("WidgetType",b.Z),this.rpcMethods=new P("RpcMethodType",x.Z),this.addTrackWidgets=new P("AddTrackWorkflow",S.Z),this.internetAccountTypes=new P("InternetAccountType",k.Z),this.configured=!1,this.rootModel=void 0,this.extensionPoints=new Map,this.jbrequireCache=new Map,this.lib=T.Z,this.load=function(e){return n.jbrequireCache.has(e)||n.jbrequireCache.set(e,e(n)),n.jbrequireCache.get(e)},this.jbrequire=function(e){if("string"===typeof e){var t=n.lib[e];if(!t)throw new TypeError("No jbrequire re-export defined for package '".concat(e,"'. If this package must be shared between plugins, add it to ReExports.js. If it does not need to be shared, just import it normally."));return t}if("function"===typeof e)return n.load(e);if(e.default)return n.jbrequire(e.default);throw new TypeError("lib passed to jbrequire must be either a string or a function")},this.addPlugin({plugin:new A.Z,metadata:{isCore:!0}}),t.forEach((function(e){n.addPlugin(e)}))}return(0,d.Z)(e,[{key:"pluginConfigurationSchemas",value:function(){var e={};return this.plugins.forEach((function(n){n.configurationSchema&&(e[n.name]=n.configurationSchema)})),e}},{key:"addPlugin",value:function(e){if(this.configured)throw new Error("JBrowse already configured, cannot add plugins");var n="install"in e&&"configure"in e?[e,{}]:[e.plugin,e.metadata],t=(0,c.Z)(n,2),r=t[0],o=t[1],i=void 0===o?{}:o;if(this.plugins.includes(r))throw new Error("plugin already installed");return this.pluginMetadata[r.name]=i,"definition"in e&&this.runtimePluginDefinitions.push(e.definition),r.install(this),this.plugins.push(r),this}},{key:"getPlugin",value:function(e){return this.plugins.find((function(n){return n.name===e}))}},{key:"hasPlugin",value:function(e){return void 0!==this.getPlugin(e)}},{key:"createPluggableElements",value:function(){return this.elementCreationSchedule&&(this.elementCreationSchedule.run(),delete this.elementCreationSchedule),this}},{key:"setRootModel",value:function(e){this.rootModel=e}},{key:"configure",value:function(){var e=this;if(this.configured)throw new Error("already configured");return this.plugins.forEach((function(n){return n.configure(e)})),this.configured=!0,this}},{key:"getElementTypeRecord",value:function(e){switch(e){case"adapter":return this.adapterTypes;case"text search adapter":return this.textSearchAdapterTypes;case"connection":return this.connectionTypes;case"widget":return this.widgetTypes;case"renderer":return this.rendererTypes;case"display":return this.displayTypes;case"track":return this.trackTypes;case"view":return this.viewTypes;case"rpc method":return this.rpcMethods;case"internet account":return this.internetAccountTypes;case"add track workflow":return this.addTrackWidgets;default:throw new Error("invalid element type '".concat(e,"'"))}}},{key:"addElementType",value:function(e,n){var t,r=this;if("function"!==typeof n)throw new Error("must provide a callback function that returns the new type object");var o=this.getElementTypeRecord(e);return null===(t=this.elementCreationSchedule)||void 0===t||t.add(e,(function(){var t=n(r);if(!t.name)throw new Error("cannot add a ".concat(e," with no name"));if(o.has(t.name))throw new Error("".concat(e," ").concat(t.name," already registered, cannot register it again"));o.add(t.name,r.evaluateExtensionPoint("Core-extendPluggableElement",t))})),this}},{key:"getElementType",value:function(e,n){return this.getElementTypeRecord(e).get(n)}},{key:"getElementTypesInGroup",value:function(e){return this.getElementTypeRecord(e).all()}},{key:"getTrackElements",value:function(){return this.getElementTypesInGroup("track")}},{key:"getAddTrackWorkflowElements",value:function(){return this.getElementTypesInGroup("add track workflow")}},{key:"getRpcElements",value:function(){return this.getElementTypesInGroup("rpc method")}},{key:"getDisplayElements",value:function(){return this.getElementTypesInGroup("display")}},{key:"getAdapterElements",value:function(){return this.getElementTypesInGroup("adapter")}},{key:"pluggableMstType",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p.types.maybe(p.types.null),o=this.getElementTypeRecord(e).all().map((function(e){return e[n]})).filter((function(e){return(0,p.isType)(e)&&(0,p.isModelType)(e)}));return 0===o.length&&"undefined"===typeof jest?(console.warn("No pluggable types found matching ('".concat(e,"','").concat(n,"')")),t):p.types.union.apply(p.types,(0,r.Z)(o))}},{key:"pluggableConfigSchemaType",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"configSchema",t=this.getElementTypeRecord(e).all().map((function(e){return e[n]})).filter((function(e){return(0,C.isBareConfigurationSchemaType)(e)}));return 0===t.length&&t.push((0,C.ConfigurationSchema)("Null",{})),p.types.union.apply(p.types,(0,r.Z)(t))}},{key:"getRendererType",value:function(e){return this.rendererTypes.get(e)}},{key:"getRendererTypes",value:function(){return this.rendererTypes.all()}},{key:"getAdapterType",value:function(e){return this.adapterTypes.get(e)}},{key:"getTextSearchAdapterType",value:function(e){return this.textSearchAdapterTypes.get(e)}},{key:"getTrackType",value:function(e){return this.trackTypes.get(e)}},{key:"getDisplayType",value:function(e){return this.displayTypes.get(e)}},{key:"getViewType",value:function(e){return this.viewTypes.get(e)}},{key:"getAddTrackWorkflow",value:function(e){return this.addTrackWidgets.get(e)}},{key:"getWidgetType",value:function(e){return this.widgetTypes.get(e)}},{key:"getConnectionType",value:function(e){return this.connectionTypes.get(e)}},{key:"getRpcMethodType",value:function(e){return this.rpcMethods.get(e)}},{key:"getInternetAccountType",value:function(e){return this.internetAccountTypes.get(e)}},{key:"addRendererType",value:function(e){return this.addElementType("renderer",e)}},{key:"addAdapterType",value:function(e){return this.addElementType("adapter",e)}},{key:"addTextSearchAdapterType",value:function(e){return this.addElementType("text search adapter",e)}},{key:"addTrackType",value:function(e){var n=this;return this.addElementType("track",(function(){var t=e(n);return n.getElementTypesInGroup("display").forEach((function(e){e.trackType!==t.name||t.displayTypes.includes(e)||t.addDisplayType(e)})),t}))}},{key:"addDisplayType",value:function(e){return this.addElementType("display",e)}},{key:"addViewType",value:function(e){var n=this;return this.addElementType("view",(function(){var t=e(n);return n.getElementTypesInGroup("display").forEach((function(e){e.viewType!==t.name&&e.viewType!==t.extendedName||t.displayTypes.includes(e)||t.addDisplayType(e)})),t}))}},{key:"addWidgetType",value:function(e){return this.addElementType("widget",e)}},{key:"addConnectionType",value:function(e){return this.addElementType("connection",e)}},{key:"addRpcMethod",value:function(e){return this.addElementType("rpc method",e)}},{key:"addInternetAccountType",value:function(e){return this.addElementType("internet account",e)}},{key:"addAddTrackWorkflowType",value:function(e){return this.addElementType("add track workflow",e)}},{key:"addToExtensionPoint",value:function(e,n){var t=this.extensionPoints.get(e);t||(t=[],this.extensionPoints.set(e,t)),t.push(n)}},{key:"evaluateExtensionPoint",value:function(e,n,t){var r=this.extensionPoints.get(e),o=n;if(r){var i,a=(0,l.Z)(r);try{for(a.s();!(i=a.n()).done;){var s=i.value;try{o=s(o,t)}catch(c){console.error(c)}}}catch(u){a.e(u)}finally{a.f()}}return o}},{key:"evaluateAsyncExtensionPoint",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n,t,r){var i,a,s,c,u;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.extensionPoints.get(n),a=t,!i){e.next=27;break}s=(0,l.Z)(i),e.prev=4,s.s();case 6:if((c=s.n()).done){e.next=19;break}return u=c.value,e.prev=8,e.next=11,u(a,r);case 11:a=e.sent,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(8),console.error(e.t0);case 17:e.next=6;break;case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(4),s.e(e.t1);case 24:return e.prev=24,s.f(),e.finish(24);case 27:return e.abrupt("return",a);case 28:case"end":return e.stop()}}),e,this,[[4,21,24,27],[8,14]])})));return function(n,t,r){return e.apply(this,arguments)}}()}]),e}(),I=t(4782),R=t(97531),N=t(69029),D=t(52044),L=t(79261),O=t(46186),W=(t(72519),t(60332),t(26968)),U=t.n(W);function z(){return(z=(0,i.Z)((0,o.Z)().mark((function e(n,t,r){var i,a,s,c,u,l,f,d,p,h;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"https://analytics.jbrowse.org/api/v1",i=n.jbrowse.tracks.filter((function(e){return((0,C.readConfObject)(e,"assemblyNames")||[]).length>1})).length,a=Object.keys(localStorage).filter((function(e){return e.includes("localSaved-")})).length,s=n.jbrowse,c=n.session,u=n.version,l=s.tracks,f=s.assemblies,d=s.plugins,p={ver:u,"plugins-count":(null===d||void 0===d?void 0:d.length)||0,"plugin-names":null===d||void 0===d?void 0:d.map((function(e){return e.name})).join(","),"assemblies-count":f.length,"tracks-count":l.length,"session-tracks-count":(null===c||void 0===c?void 0:c.sessionTracks.length)||0,"open-views":(null===c||void 0===c?void 0:c.views.length)||0,"synteny-tracks-count":i,"saved-sessions-count":a,"existing-session-param-type":(null===r||void 0===r?void 0:r.split("-")[0])||"none","scn-h":window.screen.height,"scn-w":window.screen.width,"win-h":window.innerHeight,"win-w":window.innerWidth,electron:R.isElectron,loadTime:(Date.now()-t)/1e3,jb2:!0},l.forEach((function(e){var n="track-types-".concat(e.type);p[n]=p[n]+1||1})),null===c||void 0===c||c.sessionTracks.forEach((function(e){var n="sessionTrack-types-".concat(e.type);p[n]=p[n]+1||1})),h=Object.keys(p).map((function(e){return"".concat(e,"=").concat(p[e])})).join("&"),e.next=12,fetch("".concat("https://analytics.jbrowse.org/api/v1","?").concat(h));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("Failed to write analytics to AWS.",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}function _(){return(_=(0,i.Z)((0,o.Z)().mark((function e(n,t){var r,i,a,s,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"UA-7115575-5",i={"tracks-count":n.jbrowse.tracks.length,ver:n.version,electron:R.isElectron,loadTime:Date.now()-t,pluginNames:(null===(r=n.jbrowse.plugins)||void 0===r?void 0:r.map((function(e){return e.name})))||""},a="(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){",a+="(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),",a+="m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)",a+="})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');",a+="ga('create', '".concat("UA-7115575-5","', 'auto', 'jbrowseTracker');"),s={},"tracks-count ver electron loadTime pluginNames","tracks-count ver electron loadTime pluginNames".split(/\s+/).forEach((function(e,n){s["dimension".concat(n+1)]=i[e]})),s.metric1=Math.round(i.loadTime),a+="ga('jbrowseTracker.send', 'pageview',".concat(JSON.stringify(s),");"),(c=document.createElement("script")).innerHTML=a,document.getElementsByTagName("head")[0].appendChild(c);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e,n,t){e&&!(0,C.readConfObject)(e.jbrowse.configuration,"disableAnalytics")&&(function(e,n,t){z.apply(this,arguments)}(e,n,t),function(e,n){_.apply(this,arguments)}(e,n))}var V=t(24965),q=t(24839),G=t(44965),F=t(93799),J=t(12496),H=t(17636),Q=t(30474),K=t(97620),Y=t(45754),$=t(13820),X=t(87977),ee=t(82412),ne=t(97447),te=t(69218),re=t(32979),oe=t(19497),ie=(0,u.lazy)((function(){return t.e(791).then(t.bind(t,40791))})),ae=(0,u.lazy)((function(){return t.e(869).then(t.bind(t,80869))})),se=function(e){(0,Y.Z)(t,e);var n=(0,$.Z)(t);function t(){var e;(0,f.Z)(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=n.call.apply(n,[this].concat(o))).name="DataManagementPlugin",e.exports={AssemblyManager:ae,SetDefaultSession:ie},e}return(0,d.Z)(t,[{key:"install",value:function(e){(0,ee.Z)(e),(0,ne.Z)(e),(0,oe.ZP)(e),(0,te.Z)(e),(0,re.Z)(e)}},{key:"configure",value:function(e){}}]),t}(X.Z),ce=t(82356),ue=t(58214),le=t(31951),fe=t(78215),de=t(92777),pe=t(74221),he=t(47356),ve=t(36526),ge=t(26340),me=t(65886),ye=t(67109),be=t(57482),we=t(52465),xe=t(6479),ke=t(46323),Ze=t(2085),Se=t(49113),Ce=t(15578),Te=t(89782),Ae=t(43568),je=[be.ZP,de.ZP,q.ZP,G.ZP,F.Z,H.ZP,Q.ZP,se,ce.Z,ue.Z,le.Z,fe.Z,pe.Z,he.Z,ve.Z,ge.Z,me.Z,ye.Z,we.Z,xe.ZP,ke.Z,Ze.Z,Se.Z,J.Z,Ce.Z,Te.Z,Ae.Z,K.Z],Ee=t(68094),Pe=t(7583),Me=t(52809),Ie=t(92735),Re=t(25322),Ne=t(13655),De=t(99782),Le=t(80367),Oe=t(12221),We=t(35388),Ue=t(66519),ze=t(99688),_e=t(44536),Be=t(21051),Ve=t.n(Be),qe=t(16644),Ge=t(91188),Fe=t(43647),Je=t(80726),He=t(25471),Qe=t(23642);function Ke(e){var n=0;switch(e.length%4){case 3:n=1;break;case 2:n=2;break;case 0:n=0;break;default:throw new Error("base64 not a valid length")}return e+"=".repeat(n)}function Ye(e){return $e.apply(this,arguments)}function $e(){return($e=(0,i.Z)((0,o.Z)().mark((function e(n){var r,i,a,s,c,u,l;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ke(n.replace(/-/g,"+").replace(/_/g,"/")),e.next=3,Promise.resolve().then(t.t.bind(t,95145,19));case 3:return i=e.sent,a=i.toByteArray,e.next=7,t.e(7221).then(t.t.bind(t,67221,23));case 7:return s=e.sent,c=s.inflate,u=a(r),l=c(u),e.abrupt("return",(new TextDecoder).decode(l));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xe(e){return en.apply(this,arguments)}function en(){return(en=(0,i.Z)((0,o.Z)().mark((function e(n){var r,i,a,s,c,u,l,f;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(new TextEncoder).encode(n),e.next=3,t.e(7221).then(t.t.bind(t,67221,23));case 3:return i=e.sent,a=i.deflate,e.next=7,Promise.resolve().then(t.t.bind(t,95145,19));case 7:return s=e.sent,c=s.fromByteArray,u=a(r),l=c(u),f=l.indexOf("="),e.abrupt("return",f>0?l.slice(0,f).replace(/\+/g,"-").replace(/\//g,"_"):l.replace(/\+/g,"-").replace(/\//g,"_"));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function nn(e,n){if(void 0!==e)if((0,p.isArrayType)(n)){var t=e,r=(0,p.getChildType)(e);if((0,p.isReferenceType)(r))for(var o=function(e){(0,p.isValidReference)((function(){return t[e]}))?e+=1:t.splice(e,1),i=e},i=0;i<t.length;)o(i);t.forEach((function(e){nn(e,r)}))}else if((0,p.isMapType)(n)){var a=e,s=(0,p.getChildType)(a);if((0,p.isReferenceType)(s)){var u=function(e){(0,p.isValidReference)((function(){return a.get(e)}))||a.delete(e)};for(var l in a.keys())u(l)}a.forEach((function(e){nn(e,s)}))}else if((0,p.isModelType)(n)){var f=(0,p.getPropertyMembers)(e).properties;Object.entries(f).forEach((function(n){var t=(0,c.Z)(n,2),r=t[0],o=t[1];nn(e[r],o)}))}}var tn=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n,r){var i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(8682),t.e(6125)]).then(t.t.bind(t,66125,23));case 2:return i=e.sent,e.abrupt("return",i.encrypt(n,r).toString());case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),rn=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n,r){var i,a,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(8682),t.e(6125)]).then(t.t.bind(t,66125,23));case 2:return i=e.sent,e.next=5,t.e(25).then(t.t.bind(t,90025,23));case 5:return a=e.sent,s=i.decrypt(n,r),e.abrupt("return",s.toString(a));case 8:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}();function on(e){try{return JSON.parse(e).message}catch(n){return e}}function an(e,n,t){return sn.apply(this,arguments)}function sn(){return(sn=(0,i.Z)((0,o.Z)().mark((function e(n,t,r){var i,a,s,c,u,l,f;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xe(JSON.stringify(n));case 2:return i=e.sent,o=5,a=window.btoa(Array.from(window.crypto.getRandomValues(new Uint8Array(2*o))).map((function(e){return String.fromCharCode(e)})).join("")).replace(/[+/]/g,"").substring(0,o),e.next=6,tn(i,a);case 6:return s=e.sent,(c=new FormData).append("session",s),c.append("dateShared","".concat(Date.now())),c.append("referer",r),e.next=13,fetch("".concat(t,"share"),{method:"POST",mode:"cors",body:c});case 13:if((u=e.sent).ok){e.next=19;break}return e.next=17,u.text();case 17:throw l=e.sent,new Error(on(l));case 19:return e.next=21,u.json();case 21:return f=e.sent,e.abrupt("return",{json:f,encryptedSession:s,password:a});case 23:case"end":return e.stop()}var o}),e)})))).apply(this,arguments)}function cn(e,n,t,r){return un.apply(this,arguments)}function un(){return(un=(0,i.Z)((0,o.Z)().mark((function e(n,t,r,i){var a,s,c,u,l;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.split("share-")[1],s="".concat(n,"?sessionId=").concat(encodeURIComponent(a)),e.next=4,fetch(s,{signal:i});case 4:if((c=e.sent).ok){e.next=10;break}return e.next=8,c.text();case 8:throw u=e.sent,new Error(on(u));case 10:return e.next=12,c.json();case 12:return l=e.sent,e.abrupt("return",rn(l.session,r));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ln=t(29938),fn=(0,Ge.ZL)()((function(e){return{shareDiv:{textAlign:"center",paddingLeft:"2px"},shareButton:{backgroundColor:(0,qe.Fq)(e.palette.primary.contrastText,e.palette.action.hoverOpacity),"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}},loadingMessage:{padding:e.spacing(5)}}})),dn="jbrowse-shareURL";function pn(e){var n=e.onClose,t=e.open,r=e.currentSetting,o=(0,u.useState)(r),i=(0,c.Z)(o,2),a=i[0],s=i[1],l=(0,u.useState)(!1),f=(0,c.Z)(l,2),d=f[0],p=f[1];return(0,ln.jsxs)(ln.Fragment,{children:[(0,ln.jsx)(O.Dialog,{onClose:function(){localStorage.setItem(dn,a),n(a)},open:t,title:"Configure session sharing",children:(0,ln.jsxs)(Me.Z,{children:[(0,ln.jsxs)(Ie.Z,{children:["Select between generating long or short URLs for the session sharing",(0,ln.jsx)(Re.Z,{onClick:function(){return p(!0)},children:(0,ln.jsx)(Je.Z,{})})]}),(0,ln.jsx)(Ne.Z,{component:"fieldset",children:(0,ln.jsxs)(De.Z,{value:a,onChange:function(e){var n=e.target.value;s(n)},children:[(0,ln.jsx)(Le.Z,{value:"short",control:(0,ln.jsx)(Oe.Z,{}),label:"Short URL"}),(0,ln.jsx)(Le.Z,{value:"long",control:(0,ln.jsx)(Oe.Z,{}),label:"Long URL"})]})})]})}),(0,ln.jsx)(hn,{open:d,onClose:function(){p(!1)}})]})}function hn(e){var n=e.onClose,t=e.open;return(0,ln.jsx)(O.Dialog,{onClose:function(){return n()},open:t,title:"Info about session URLs",children:(0,ln.jsxs)(Me.Z,{children:[(0,ln.jsx)(Ie.Z,{children:"Because everything about the JBrowse session is encoded in the URL (e.g. state of the tracks, views, features selected, etc.) the sessions can get very long. Therefore, we created a URL shortener, both as a convenience and because long URLs can break some programs. Note that both the long and short URLs encode the same data, but due to long URLs causing problems with some programs, we recommend sharing short URLs."}),(0,ln.jsx)(Ie.Z,{children:'We generate the short URLs in a secure manner which involves encrypting the session on the client side with a random password string and uploading them to a central database. Then the random password is added to the URL but is not uploaded to the central database, making these short URLs effectively "end-to-end encrypted"'}),(0,ln.jsx)(Ie.Z,{children:"Only users with a share link can read the session."})]})})}var vn=(0,I.observer)((function(e){var n=e.handleClose,t=e.session,r=(0,u.useState)(""),a=(0,c.Z)(r,2),s=a[0],l=a[1],f=(0,u.useState)(""),d=(0,c.Z)(f,2),h=d[0],v=d[1],g=(0,u.useState)(!0),m=(0,c.Z)(g,2),y=m[0],b=m[1],w=(0,u.useState)(),x=(0,c.Z)(w,2),k=x[0],Z=x[1],S=(0,u.useState)(!1),C=(0,c.Z)(S,2),T=C[0],A=C[1],j=t.shareURL,E=localStorage.getItem(dn)||"short",P=(0,p.getSnapshot)(t);return(0,u.useEffect)((function(){var e=!1;return(0,i.Z)((0,o.Z)().mark((function n(){var t,r,i;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("short"!==E){n.next=16;break}return n.prev=1,b(!0),t=new URL(window.location.href),n.next=6,an(P,j,t.href);case 6:r=n.sent,e||((i=new URLSearchParams(t.search)).set("session","share-".concat(r.json.sessionId)),i.set("password",r.password),t.search=i.toString(),l(t.href)),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),Z(n.t0);case 13:return n.prev=13,b(!1),n.finish(13);case 16:case"end":return n.stop()}}),n,null,[[1,10,13,16]])})))(),function(){e=!0}}),[E,j,P]),(0,u.useEffect)((function(){var e=!1;return(0,i.Z)((0,o.Z)().mark((function n(){var r,i,a;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Xe(JSON.stringify((0,p.getSnapshot)(t)));case 3:r=n.sent,i=new URL(window.location.href),(a=new URLSearchParams(i.search)).set("session","encoded-".concat(r)),i.search=a.toString(),e||v(i.toString()),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(0),Z(n.t0);case 14:case"end":return n.stop()}}),n,null,[[0,11]])})))(),function(){e=!0}}),[t]),(0,ln.jsxs)(ln.Fragment,{children:[(0,ln.jsxs)(O.Dialog,{maxWidth:"xl",open:!0,onClose:n,title:"JBrowse Shareable Link","data-testid":"share-dialog",children:[(0,ln.jsxs)(Me.Z,{children:[(0,ln.jsxs)(Ie.Z,{children:["Copy the URL below to share your current JBrowse session.",(0,ln.jsx)(Re.Z,{onClick:function(){return A(!0)},children:(0,ln.jsx)(He.Z,{})})]}),"short"===E?k?(0,ln.jsx)(We.Z,{color:"error",children:"".concat(k)}):y?(0,ln.jsx)(We.Z,{children:"Generating short URL..."}):(0,ln.jsx)(Ue.Z,{label:"URL",value:s,InputProps:{readOnly:!0},variant:"filled",style:{width:"100%"},onClick:function(e){e.target.select()}}):(0,ln.jsx)(Ue.Z,{label:"URL",value:h,InputProps:{readOnly:!0},variant:"filled",style:{width:"100%"},onClick:function(e){e.target.select()}})]}),(0,ln.jsxs)(ze.Z,{children:[(0,ln.jsx)(_e.Z,{onClick:function(){Ve()(s||h.toString()),t.notify("Copied to clipboard","success")},color:"primary",startIcon:(0,ln.jsx)(Qe.pt,{}),disabled:"short"===E&&y,children:"Copy URL to Clipboard"}),(0,ln.jsx)(_e.Z,{onClick:n,color:"primary",autoFocus:!0,children:"Close"})]})]}),(0,ln.jsx)(pn,{open:T,onClose:function(){A(!1)},currentSetting:E})]})})),gn=(0,I.observer)((function(e){var n=(0,u.useState)(!1),t=(0,c.Z)(n,2),r=t[0],a=t[1],s=e.session,l=fn().classes;return(0,ln.jsxs)("div",{className:l.shareDiv,children:[(0,ln.jsx)(_e.Z,{onClick:(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a(!0));case 1:case"end":return e.stop()}}),e)}))),size:"small",color:"inherit",startIcon:(0,ln.jsx)(Fe.Z,{}),classes:{root:l.shareButton},children:"Share"}),r?(0,ln.jsx)(vn,{handleClose:function(){return a(!1)},session:s}):null]})}));var mn=(0,I.observer)((function(e){var n=e.pluginManager.rootModel,t=n,r=t.isAssemblyEditing,o=t.isDefaultSessionEditing,i=t.setDefaultSessionEditing,a=t.setAssemblyEditing;return(0,ln.jsxs)(ln.Fragment,{children:[r?(0,ln.jsx)(ae,{rootModel:n,onClose:function(){return a(!1)}}):null,o?(0,ln.jsx)(ie,{rootModel:n,onClose:function(){return i(!1)}}):null]})})),yn=(0,I.observer)((function(e){var n=e.pluginManager,t=(0,D.useQueryParam)("adminKey",D.StringParam),r=(0,c.Z)(t,1)[0],a=(0,D.useQueryParam)("adminServer",D.StringParam),s=(0,c.Z)(a,1)[0],l=(0,D.useQueryParam)("config",D.StringParam),f=(0,c.Z)(l,1)[0],d=(0,D.useQueryParam)("session",D.StringParam),h=(0,c.Z)(d,2)[1],v=n.rootModel,g=v||{},m=g.error,y=g.jbrowse,b=null===v||void 0===v?void 0:v.session,w=b.id;if((0,u.useEffect)((function(){h("local-".concat(w)),window.JBrowseRootModel=v,window.JBrowseSession=b}),[w,v,b,h]),(0,u.useEffect)((function(){if(y&&r)return(0,p.onSnapshot)(y,function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n){var t,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(s||"/updateConfig",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminKey:r,configPath:f,config:n})});case 3:if((t=e.sent).ok){e.next=9;break}return e.next=7,t.text();case 7:throw i=e.sent,new Error("HTTP ".concat(t.status," (").concat(i,")"));case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),null===b||void 0===b||b.notify("Admin server error: ".concat(e.t0));case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(n){return e.apply(this,arguments)}}())}),[y,b,r,s,f]),m)throw m;if(!v)throw new Error("No rootModel found");if(!b)throw new Error("No session found");return(0,ln.jsxs)(Ee.Z,{theme:b.theme,children:[(0,ln.jsx)(Pe.ZP,{}),(0,ln.jsx)(O.App,{session:b,HeaderButtons:(0,ln.jsx)(gn,{session:b})}),r?(0,ln.jsx)(mn,{pluginManager:n}):null]})})),bn=t(64837),wn=t(75717),xn=t(43586),kn=t.n(xn),Zn=t(64926),Sn=t.n(Zn),Cn=t(10361),Tn=["signal","statusCallback"],An=new RegExp("[0-9A-Za-z!#$%&+./:;?@^_|~-][0-9A-Za-z!#$%&*+./:;=?@^_|~-]*"),jn=["rgb(153, 102, 0)","rgb(102, 102, 0)","rgb(153, 153, 30)","rgb(204, 0, 0)","rgb(255, 0, 0)","rgb(255, 0, 204)","rgb(165, 132, 132)","rgb(204, 122, 0)","rgb(178, 142, 0)","rgb(153, 153, 0)","rgb(122, 153, 0)","rgb(0, 165, 0)","rgb(53, 128, 0)","rgb(0, 0, 204)","rgb(96, 145, 242)","rgb(107, 142, 178)","rgb(0, 165, 165)","rgb(122, 153, 153)","rgb(153, 0, 204)","rgb(204, 51, 255)","rgb(173, 130, 216)","rgb(102, 102, 102)","rgb(145, 145, 145)","rgb(142, 142, 142)","rgb(142, 142, 107)","rgb(96, 163, 48)"];function En(e,n,t,r){return Pn.apply(this,arguments)}function Pn(){return(Pn=(0,i.Z)((0,o.Z)().mark((function e(n,t,r,i){var s,u,l,f;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.sessionId,e.next=3,(0,R.when)((function(){return!(!n.regions||!n.refNameAliases)}),{signal:i,name:"when assembly ready"});case 3:return e.next=5,n.rpcManager.call(s,"CoreGetRefNames",(0,a.Z)({adapterConfig:t,signal:i},r),{timeout:1e6});case 5:if(u=e.sent,n.refNameAliases){e.next=9;break}throw new Error("error loading assembly ".concat(n.name,"'s refNameAliases"));case 9:return l=Object.fromEntries(u.map((function(e){return Mn(e),[n.getCanonicalRefName(e),e]}))),f=Object.fromEntries(Object.entries(l).map((function(e){var n=(0,c.Z)(e,2),t=n[0];return[n[1],t]}))),e.abrupt("return",{forwardMap:l,reverseMap:f});case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Mn(e){if(!e.match(An))throw new Error('Encountered invalid refName: "'.concat(e,'"'))}function In(e,n){var t=new(Sn())({cache:new Cn.Z({maxSize:1e3}),fill:function(e,n,t){return(0,i.Z)((0,o.Z)().mark((function r(){var i,s,c;return(0,o.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=e.adapterConf,s=e.self,c=e.options,r.abrupt("return",En(s,i,(0,a.Z)((0,a.Z)({},c),{},{statusCallback:t}),n));case 2:case"end":return r.stop()}}),r)})))()}});return p.types.model({configuration:p.types.safeReference(e)}).volatile((function(){return{error:void 0,loaded:!1,loadingP:void 0,volatileRegions:void 0,refNameAliases:void 0,lowerCaseRefNameAliases:void 0,cytobands:void 0}})).views((function(e){return{get initialized(){return e.load(),!!e.refNameAliases},get name(){return(0,C.getConf)(e,"name")},get regions(){return e.load(),e.volatileRegions},get aliases(){return(0,C.getConf)(e,"aliases")},get displayName(){return(0,C.getConf)(e,"displayName")},hasName:function(e){return this.allAliases.includes(e)},get allAliases(){return[this.name].concat((0,r.Z)(this.aliases))},get allRefNames(){return e.refNameAliases?Object.keys(e.refNameAliases):void 0},get lowerCaseRefNames(){return e.lowerCaseRefNameAliases?Object.keys(e.lowerCaseRefNameAliases||{}):void 0},get allRefNamesWithLowerCase(){return this.allRefNames&&this.lowerCaseRefNames?(0,r.Z)(new Set([].concat((0,r.Z)(this.allRefNames),(0,r.Z)(this.lowerCaseRefNames)))):void 0},get rpcManager(){return(0,p.getParent)(e,2).rpcManager},get refNameColors(){var n=(0,C.getConf)(e,"refNameColors");return 0===n.length?jn:n}}})).views((function(e){return{get refNames(){var n;return null===(n=e.regions)||void 0===n?void 0:n.map((function(e){return e.refName}))}}})).views((function(e){return{getCanonicalRefName:function(n){if(!e.refNameAliases||!e.lowerCaseRefNameAliases)throw new Error("aliases not loaded, we expect them to be loaded before getCanonicalRefName can be called");return e.refNameAliases[n]||e.lowerCaseRefNameAliases[n]},getRefNameColor:function(n){if(e.refNames){var t=e.refNames.findIndex((function(e){return e===n}));if(-1!==t)return e.refNameColors[t%e.refNameColors.length]}},isValidRefName:function(n){if(!e.refNameAliases)throw new Error("isValidRefName cannot be called yet, the assembly has not finished loading");return!!this.getCanonicalRefName(n)}}})).actions((function(e){return{setLoaded:function(n){var t=n.adapterRegionsWithAssembly,r=n.refNameAliases,o=n.lowerCaseRefNameAliases,i=n.cytobands;e.loaded=!0,this.setRegions(t),this.setRefNameAliases(r,o),this.setCytobands(i)},setError:function(n){console.error(n),e.error=n},setRegions:function(n){e.volatileRegions=n},setRefNameAliases:function(n,t){e.refNameAliases=n,e.lowerCaseRefNameAliases=t},setCytobands:function(n){e.cytobands=n},setLoadingP:function(n){e.loadingP=n},load:function(){var n=this;return e.loadingP||(e.loadingP=this.loadPre().catch((function(e){n.setLoadingP(void 0),n.setError(e)}))),e.loadingP},loadPre:function(){var t=this;return(0,i.Z)((0,o.Z)().mark((function r(){var i,s,u,l,f,d,p,h,v,g,m,y,b;return(0,o.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u=e.configuration,l=null===(i=u.refNameAliases)||void 0===i?void 0:i.adapter,f=null===(s=u.cytobands)||void 0===s?void 0:s.adapter,d=u.sequence.adapter,p=e.name,r.next=7,On(d,n);case 7:return h=r.sent,v=h.map((function(e){return Mn(e.refName),(0,a.Z)((0,a.Z)({},e),{},{assemblyName:p})})),g={},r.next=12,Rn(l,n);case 12:return m=r.sent,r.next=15,Dn(f,n);case 15:y=r.sent,m.forEach((function(e){var n=e.refName;e.aliases.forEach((function(e){Mn(e),g[e]=n}))})),v.forEach((function(e){g[e.refName]=e.refName})),b=Object.fromEntries(Object.entries(g).map((function(e){var n=(0,c.Z)(e,2),t=n[0],r=n[1];return[t.toLowerCase(),r]}))),t.setLoaded({adapterRegionsWithAssembly:v,refNameAliases:g,lowerCaseRefNameAliases:b,cytobands:y});case 20:case"end":return r.stop()}}),r)})))()}}})).views((function(e){return{getAdapterMapEntry:function(n,r){r.signal;var o=r.statusCallback,i=(0,s.Z)(r,Tn);if(!r.sessionId)throw new Error("sessionId is required");var a=function(e){return kn()(e)}(n);return t.get(a,{adapterConf:n,self:e,options:i},void 0,o)},getRefNameMapForAdapter:function(e,n){var t=this;return(0,i.Z)((0,o.Z)().mark((function r(){var i;return(0,o.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n&&n.sessionId){r.next=2;break}throw new Error("sessionId is required");case 2:return r.next=4,t.getAdapterMapEntry(e,n);case 4:return i=r.sent,r.abrupt("return",i.forwardMap);case 6:case"end":return r.stop()}}),r)})))()},getReverseRefNameMapForAdapter:function(e,n){var t=this;return(0,i.Z)((0,o.Z)().mark((function r(){var i;return(0,o.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getAdapterMapEntry(e,n);case 2:return i=r.sent,r.abrupt("return",i.reverseMap);case 4:case"end":return r.stop()}}),r)})))()}}}))}function Rn(e,n,t){return Nn.apply(this,arguments)}function Nn(){return(Nn=(0,i.Z)((0,o.Z)().mark((function e(n,t,r){var i,a,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.getAdapterType(n.type),e.next=3,i.getAdapterClass();case 3:return a=e.sent,s=new a(n,void 0,t),e.abrupt("return",s.getRefNameAliases({signal:r}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Dn(e,n){return Ln.apply(this,arguments)}function Ln(){return(Ln=(0,i.Z)((0,o.Z)().mark((function e(n,t){var r,i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.getAdapterType(n.type),e.next=3,r.getAdapterClass();case 3:return i=e.sent,a=new i(n,void 0,t),e.abrupt("return",a.getData());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function On(e,n,t){return Wn.apply(this,arguments)}function Wn(){return(Wn=(0,i.Z)((0,o.Z)().mark((function e(n,t,r){var i,a,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.getAdapterType(n.type),e.next=3,i.getAdapterClass();case 3:return a=e.sent,s=new a(n,void 0,t),e.abrupt("return",s.getRegions({signal:r}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Un=function(e,n){return p.types.model({assemblies:p.types.array(In(e,n))}).views((function(e){return{get:function(n){return e.assemblies.find((function(e){return e.hasName(n)}))},get assemblyNamesList(){return this.assemblyList.map((function(e){return e.name}))},get assemblyList(){var n=(0,p.getParent)(e),t=n.jbrowse.assemblies,o=n.session,i=void 0===o?{}:o,a=i.sessionAssemblies,s=void 0===a?[]:a,c=i.temporaryAssemblies,u=void 0===c?[]:c;return[].concat((0,r.Z)(t),(0,r.Z)(s),(0,r.Z)(u))},get rpcManager(){return(0,p.getParent)(e).rpcManager}}})).views((function(e){return{waitForAssembly:function(n){return(0,i.Z)((0,o.Z)().mark((function t(){var r;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}throw new Error("no assembly name supplied to waitForAssembly");case 2:if(r=e.get(n)){t.next=12;break}return t.prev=4,t.next=7,(0,R.when)((function(){return Boolean(e.get(n))}),{timeout:1e3});case 7:r=e.get(n),t.next=12;break;case 10:t.prev=10,t.t0=t.catch(4);case 12:if(r){t.next=14;break}return t.abrupt("return",void 0);case 14:return t.next=16,r.load();case 16:return t.next=18,(0,R.when)((function(){var e,n;return Boolean((null===(e=r)||void 0===e?void 0:e.regions)&&r.refNameAliases)||!(null===(n=r)||void 0===n||!n.error)}));case 18:if(!r.error){t.next=20;break}throw r.error;case 20:return t.abrupt("return",r);case 21:case"end":return t.stop()}}),t,null,[[4,10]])})))()},getRefNameMapForAdapter:function(e,n,t){var r=this;return(0,i.Z)((0,o.Z)().mark((function i(){var a;return(0,o.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!n){o.next=5;break}return o.next=3,r.waitForAssembly(n);case 3:return a=o.sent,o.abrupt("return",null===a||void 0===a?void 0:a.getRefNameMapForAdapter(e,t));case 5:return o.abrupt("return",{});case 6:case"end":return o.stop()}}),i)})))()},getReverseRefNameMapForAdapter:function(e,n,t){var r=this;return(0,i.Z)((0,o.Z)().mark((function i(){var a;return(0,o.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!n){o.next=5;break}return o.next=3,r.waitForAssembly(n);case 3:return a=o.sent,o.abrupt("return",null===a||void 0===a?void 0:a.getReverseRefNameMapForAdapter(e,t));case 5:return o.abrupt("return",{});case 6:case"end":return o.stop()}}),i)})))()},isValidRefName:function(n,t){var r=e.get(t);if(r)return r.isValidRefName(n);throw new Error("isValidRefName for ".concat(t," failed, assembly does not exist"))}}})).actions((function(e){return{afterAttach:function(){var n=this;(0,p.addDisposer)(e,(0,wn.reaction)((function(){return e.assemblyList}),(function(t){e.assemblies.forEach((function(e){e.configuration||n.removeAssembly(e)})),t.forEach((function(t){-1===e.assemblies.findIndex((function(e){return e.name===(0,C.readConfObject)(t,"name")}))&&n.addAssembly(t)}))}),{fireImmediately:!0,name:"assemblyManagerAfterAttach"}))},removeAssembly:function(n){e.assemblies.remove(n)},addAssembly:function(n){e.assemblies.push({configuration:n})},replaceAssembly:function(n,t){e.assemblies[n]=(0,p.cast)({configuration:t})}}}))};var zn=function(e){return(0,C.ConfigurationSchema)("BaseAssembly",{aliases:{type:"stringArray",defaultValue:[],description:"Other possible names for the assembly"},sequence:e.getTrackType("ReferenceSequenceTrack").configSchema,refNameColors:{type:"stringArray",defaultValue:[],description:"Define custom colors for each reference sequence. Will cycle through this list if there are not enough colors for every sequence."},refNameAliases:(0,C.ConfigurationSchema)("RefNameAliases",{adapter:e.pluggableConfigSchemaType("adapter")},{preProcessSnapshot:function(e){return e.adapter?e:{adapter:{type:"RefNameAliasAdapter"}}}}),cytobands:(0,C.ConfigurationSchema)("Cytoband",{adapter:e.pluggableConfigSchemaType("adapter")},{preProcessSnapshot:function(e){return e.adapter?e:{adapter:{type:"CytobandAdapter"}}}}),displayName:{type:"string",defaultValue:"",description:'A human readable display name for the assembly e.g. "Homo sapiens (hg38)" while the assembly name may just be "hg38"'}},{explicitIdentifier:"name"})};var _n=(0,C.ConfigurationSchema)("BaseRpcDriver",{workerCount:{type:"number",description:"The number of workers to use. If 0 (the default) JBrowse will decide how many workers to use.",defaultValue:0}},{explicitlyTyped:!0});var Bn=(0,C.ConfigurationSchema)("WebWorkerRpcDriver",{},{baseConfiguration:_n,explicitlyTyped:!0});var Vn=(0,C.ConfigurationSchema)("MainThreadRpcDriver",{},{baseConfiguration:_n,explicitlyTyped:!0});var qn=(0,C.ConfigurationSchema)("RpcOptions",{defaultDriver:{type:"string",description:"the RPC driver to use for tracks and tasks that are not configured to use a specific RPC backend",defaultValue:"MainThreadRpcDriver"},drivers:p.types.optional(p.types.map(p.types.union(Vn,Bn)),{MainThreadRpcDriver:{type:"MainThreadRpcDriver"},WebWorkerRpcDriver:{type:"WebWorkerRpcDriver"}})},{actions:function(e){return{addDriverConfig:function(n,t){e.drivers.set(n,t)}}}}),Gn=t(93069),Fn=t(95058),Jn=t(93375),Hn=t(96699),Qn=t(95439);function Kn(e){return"function"!==typeof e&&!(e instanceof Error)}function Yn(e,n,t){return $n.apply(this,arguments)}function $n(){return($n=(0,i.Z)((0,o.Z)().mark((function e(n,t,r){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,n.call("ping",[],{timeout:2*t,rpcDriverClassName:r});case 3:return e.next=5,new Promise((function(e){return setTimeout(e,t)}));case 5:e.next=0;break;case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Xn=function(){function e(n){(0,f.Z)(this,e),this.driver=n,this.workerP=void 0}return(0,d.Z)(e,[{key:"getWorker",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var n=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.workerP||(this.workerP=this.driver.makeWorker().then((function(e){return Yn(e,n.driver.maxPingTime,n.driver.name).catch((function(t){e&&(console.error("worker did not respond, killing and generating new one"),console.error(t),e.destroy(),e.status="killed",e.error=t,n.workerP=void 0)})),e})).catch((function(e){throw n.workerP=void 0,e}))),e.abrupt("return",this.workerP);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),et=function(){function e(n){(0,f.Z)(this,e),this.name=void 0,this.lastWorkerAssignment=-1,this.workerAssignments=new Map,this.workerPool=void 0,this.maxPingTime=3e4,this.workerCheckFrequency=5e3,this.config=void 0,this.config=n.config}return(0,d.Z)(e,[{key:"filterArgs",value:function(e,n){var t=this;if(Array.isArray(e))return e.filter(Kn).map((function(e){return t.filterArgs(e,n)}));if("object"===typeof e&&null!==e){if(e instanceof AbortSignal)return(0,Qn.Iy)(e,this.remoteAbort.bind(this,n));if((0,p.isStateTreeNode)(e)&&!(0,p.isAlive)(e))throw new Error("dead state tree node passed to RPC call");return e instanceof File?e:Object.fromEntries(Object.entries(e).filter((function(e){return Kn(e[1])})).map((function(e){var r=(0,c.Z)(e,2),o=r[0],i=r[1];return[o,t.filterArgs(i,n)]})))}return e}},{key:"remoteAbort",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n,t,r){var i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getWorker(n);case 2:return i=e.sent,e.next=5,i.call(t,{signalId:r},{timeout:1e6,rpcDriverClassName:this.name});case 5:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()},{key:"createWorkerPool",value:function(){var e=this,n=function(){var e="undefined"!==typeof window,n=e&&"hardwareConcurrency"in window.navigator;return e&&n?window.navigator.hardwareConcurrency:1}(),t=(0,C.readConfObject)(this.config,"workerCount")||(0,R.clamp)(1,Math.max(1,n-1),5);return(0,r.Z)(new Array(t)).map((function(){return new Xn(e)}))}},{key:"getWorkerPool",value:function(){if(!this.workerPool){var e=this.createWorkerPool();return this.workerPool=e,e}return this.workerPool}},{key:"getWorker",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n){var t,r,i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getWorkerPool(),void 0===(r=this.workerAssignments.get(n))&&(i=(this.lastWorkerAssignment+1)%t.length,this.workerAssignments.set(n,i),this.lastWorkerAssignment=i,r=i),a=t[r].getWorker()){e.next=6;break}throw new Error("no web workers registered for RPC");case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"call",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n,t,r,i){var s,c,u,l,f,d,p,h,v,g,m=this,y=arguments;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=y.length>4&&void 0!==y[4]?y[4]:{},t){e.next=3;break}throw new TypeError("sessionId is required");case 3:return c=!1,e.next=6,this.getWorker(t);case 6:return u=e.sent,l=n.getRpcMethodType(r),e.next=10,l.serializeArguments(i,this.name);case 10:return f=e.sent,d=this.filterArgs(f,t),p=u.call(r,d,(0,a.Z)({timeout:3e5,statusCallback:i.statusCallback,rpcDriverClassName:this.name},s)).finally((function(){c=!0})),v=new Promise((function(e,n){h=setInterval((function(){"killed"===u.status?n(new Error("operation timed out, worker process stopped responding, ".concat(u.error))):c&&e(!0)}),m.workerCheckFrequency)})).finally((function(){clearInterval(h)})),g=Promise.race([p,v]),e.abrupt("return",l.deserializeReturn(g,i,this.name));case 16:case"end":return e.stop()}}),e,this)})));return function(n,t,r,o){return e.apply(this,arguments)}}()}]),e}(),nt=function(e){(0,Y.Z)(t,e);var n=(0,$.Z)(t);function t(){return(0,f.Z)(this,t),n.apply(this,arguments)}return(0,d.Z)(t,[{key:"destroy",value:function(){this.workers[0].terminate()}},{key:"call",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n,r,i){var s,c,u,l,f;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=i.statusCallback,c=i.rpcDriverClassName,u="message-".concat(U().generate()),l=function(e){null===s||void 0===s||s(e)},this.on(u,l),e.next=6,(0,Gn.Z)((0,Fn.Z)(t.prototype),"call",this).call(this,n,(0,a.Z)((0,a.Z)({},r),{},{channel:u,rpcDriverClassName:c}),i);case 6:return f=e.sent,this.off(u,l),e.abrupt("return",f);case 9:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()}]),t}(Jn.Z.Client),tt=function(e){(0,Y.Z)(t,e);var n=(0,$.Z)(t);function t(e,r){var o;return(0,f.Z)(this,t),(o=n.call(this,e)).workerBootConfiguration=r,o.name="WebWorkerRpcDriver",o.makeWorkerInstance=void 0,o.makeWorkerInstance=e.makeWorkerInstance,o}return(0,d.Z)(t,[{key:"makeWorker",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var n,t,r=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.makeWorkerInstance(),t=new nt({workers:[n]}),/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&console.log("console logging the webworker handle avoids the track going into an infinite loading state, this is a hacky workaround for safari",n),e.abrupt("return",new Promise((function(e,n){t.workers[0].addEventListener("message",(function o(i){"ready"===i.data.message?(e(t),t.workers[0].removeEventListener("message",o)):"readyForConfig"===i.data.message?t.workers[0].postMessage({message:"config",config:r.workerBootConfiguration}):"error"===i.data.message&&n((0,Hn.deserializeError)(i.data.error))}))})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(et),rt=function(){function e(){(0,f.Z)(this,e)}return(0,d.Z)(e,[{key:"destroy",value:function(){}},{key:"call",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n,t){var r=arguments;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.length>2&&void 0!==r[2]?r[2]:{},e.abrupt("return",void 0);case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()}]),e}(),ot=function(e){(0,Y.Z)(t,e);var n=(0,$.Z)(t);function t(e){var r;return(0,f.Z)(this,t),(r=n.call(this,e)).name="MainThreadRpcDriver",r.makeWorker=void 0,r.makeWorker=(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new rt);case 1:case"end":return e.stop()}}),e)}))),r}return(0,d.Z)(t,[{key:"call",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n,t,r,i){var a,s,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new TypeError("sessionId is required");case 2:return a=n.getRpcMethodType(r),e.next=5,a.serializeArguments(i,this.name);case 5:return s=e.sent,e.next=8,a.execute(s,this.name);case 8:return c=e.sent,e.abrupt("return",a.deserializeReturn(c,i,this.name));case 10:case"end":return e.stop()}}),e,this)})));return function(n,t,r,o){return e.apply(this,arguments)}}()}]),t}(et),it=function(){function e(n,t,r){if((0,f.Z)(this,e),this.pluginManager=n,this.mainConfiguration=t,this.backendConfigurations=r,this.driverObjects=void 0,!t)throw new Error("RpcManager requires at least a main configuration");this.driverObjects=new Map}return(0,d.Z)(e,[{key:"getDriver",value:function(e){var n,t=this.driverObjects.get(e);if(t)return t;var r=this.mainConfiguration.drivers.get("WebWorkerRpcDriver");if("MainThreadRpcDriver"===e){var o=this.backendConfigurations.MainThreadRpcDriver;if(!o)throw new Error('requested RPC driver "'.concat(e,'" is missing config'));n=new ot((0,a.Z)((0,a.Z)({},o),{},{config:r}))}else{if("WebWorkerRpcDriver"!==e)throw new Error('requested RPC driver "'.concat(e,'" is not installed'));var i=this.backendConfigurations.WebWorkerRpcDriver;if(!i)throw new Error('requested RPC driver "'.concat(e,'" is missing config'));n=new tt((0,a.Z)((0,a.Z)({},i),{},{config:r}),{plugins:this.pluginManager.runtimePluginDefinitions,windowHref:window.location.href})}return this.driverObjects.set(e,n),n}},{key:"getDriverForCall",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n,t,r){var i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.rpcDriverName||(0,C.readConfObject)(this.mainConfiguration,"defaultDriver"),e.abrupt("return",this.getDriver(i));case 2:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()},{key:"call",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n,t,r){var i,a,s=arguments;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=s.length>3&&void 0!==s[3]?s[3]:{},n){e.next=3;break}throw new Error("sessionId is required");case 3:return e.next=5,this.getDriverForCall(n,t,r);case 5:return a=e.sent,e.abrupt("return",a.call(this.pluginManager,n,t,r,i));case 7:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()}]),e}();it.configSchema=qn;var at=function(){function e(n){(0,f.Z)(this,e),this.pluginManager=n,this.adapterCache=new Cn.Z({maxSize:15})}return(0,d.Z)(e,[{key:"loadTextSearchAdapters",value:function(e){var n=this,t=this.pluginManager;return this.relevantAdapters(e).map((function(e){var r=(0,C.readConfObject)(e,"textSearchAdapterId"),o=n.adapterCache.get(r);if(o)return o;var i=new(0,t.getTextSearchAdapterType(e.type).AdapterClass)(e,void 0,t);return n.adapterCache.set(r,i),i}))}},{key:"relevantAdapters",value:function(e){var n,t=null===(n=this.pluginManager.rootModel)||void 0===n?void 0:n.jbrowse,o=t.aggregateTextSearchAdapters,i=t.tracks,a=e.assemblyName;return[].concat((0,r.Z)(this.getAdaptersWithAssembly(a,o)),(0,r.Z)(this.getTrackAdaptersWithAssembly(a,i)))}},{key:"getAdaptersWithAssembly",value:function(e,n){return n.filter((function(n){var t;return null===(t=(0,C.readConfObject)(n,"assemblyNames"))||void 0===t?void 0:t.includes(e)}))}},{key:"getTrackAdaptersWithAssembly",value:function(e,n){return n.filter((function(n){var t;return null===(t=(0,C.readConfObject)(n,["textSearching","textSearchAdapter","assemblyNames"]))||void 0===t?void 0:t.includes(e)})).map((function(e){return e.textSearching.textSearchAdapter}))}},{key:"search",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n,t,r){var i,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.loadTextSearchAdapters(t),e.next=3,Promise.all(i.map((function(e){return e.searchIndex(n)})));case 3:return a=e.sent,e.abrupt("return",this.sortResults(a.flat(),r));case 5:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()},{key:"sortResults",value:function(e,n){return n(e.sort((function(e,n){return-n.getLabel().localeCompare(e.getLabel())}))).sort((function(e,n){return e.getScore()-n.getScore()}))}}]),e}();var st=p.types.model("TimeTraveller",{undoIdx:-1,targetPath:""}).volatile((function(){return{history:[],notTrackingUndo:!1}})).views((function(e){return{get canUndo(){return e.undoIdx>0&&!e.notTrackingUndo},get canRedo(){return e.undoIdx<e.history.length-1&&!e.notTrackingUndo}}})).actions((function(e){var n,t,r=!1;return{stopTrackingUndo:function(){e.notTrackingUndo=!0},resumeTrackingUndo:function(){e.notTrackingUndo=!1},addUndoState:function(n){e.notTrackingUndo||(r?r=!1:(e.history.splice(e.undoIdx+1),e.history.push(n),e.history.length>20&&e.history.shift(),e.undoIdx=e.history.length-1))},beforeDestroy:function(){t()},initialize:function(){var r=this;if(!(n=e.targetPath?(0,p.resolvePath)(e,e.targetPath):(0,p.getEnv)(e).targetStore))throw new Error("Failed to find target store for TimeTraveller. Please provide `targetPath` property, or a `targetStore` in the environment");t=(0,p.onSnapshot)(n,function(e){var n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];clearTimeout(n),n=setTimeout((function(){return e.apply(void 0,o)}),t)}}((function(e){return r.addUndoState(e)}),300)),0===e.history.length&&this.addUndoState((0,p.getSnapshot)(n))},undo:function(){e.undoIdx--,r=!0,(0,p.applySnapshot)(n,e.history[e.undoIdx])},redo:function(){e.undoIdx++,r=!0,(0,p.applySnapshot)(n,e.history[e.undoIdx])}}})),ct=st,ut=t(51467),lt=t(41181),ft=t(49181),dt=t(93472),pt=t(14393),ht=t(73823),vt=t(18563),gt=t(74119),mt=t(59978),yt=t(78748),bt=t(55824);function wt(){return new Worker(new URL(t.p+t.u(5981),t.b))}var xt=t(73636),kt=t.n(xt);function Zt(e,n){for(var t in e)t===n?delete e[t]:"object"===typeof e[t]&&Zt(e[t],n);return e}function St(e,n,t){var r=p.types.model("JBrowseWeb",{configuration:(0,C.ConfigurationSchema)("Root",(0,a.Z)({rpc:it.configSchema,highResolutionScaling:{type:"number",defaultValue:2},shareURL:{type:"string",defaultValue:"https://share.jbrowse.org/api/v1/"},featureDetails:(0,C.ConfigurationSchema)("FeatureDetails",{sequenceTypes:{type:"stringArray",defaultValue:["mRNA","transcript","gene","CDS"]}}),formatDetails:(0,C.ConfigurationSchema)("FormatDetails",{feature:{type:"frozen",description:"adds extra fields to the feature details",defaultValue:{},contextVariable:["feature"]},subfeatures:{type:"frozen",description:"adds extra fields to the subfeatures of a feature",defaultValue:{},contextVariable:["feature"]},depth:{type:"number",defaultValue:2,description:"depth to iterate on subfeatures"}}),formatAbout:(0,C.ConfigurationSchema)("FormatAbout",{config:{type:"frozen",description:"formats configuration object in about dialog",defaultValue:{},contextVariable:["config"]},hideUris:{type:"boolean",defaultValue:!1}}),disableAnalytics:{type:"boolean",defaultValue:!1},theme:{type:"frozen",defaultValue:{}},extraThemes:{type:"frozen",defaultValue:{}},logoPath:{type:"fileLocation",defaultValue:{uri:"",locationType:"UriLocation"}}},e.pluginConfigurationSchemas())),plugins:p.types.array(p.types.frozen()),assemblies:p.types.array(t),tracks:p.types.array(e.pluggableConfigSchemaType("track")),internetAccounts:p.types.array(e.pluggableConfigSchemaType("internet account")),aggregateTextSearchAdapters:p.types.array(e.pluggableConfigSchemaType("text search adapter")),connections:p.types.array(e.pluggableConfigSchemaType("connection")),defaultSession:p.types.optional(p.types.frozen(n),{name:"New session"})}).views((function(e){return{get assemblyNames(){return e.assemblies.map((function(e){return(0,C.readConfObject)(e,"name")}))},get rpcManager(){return(0,p.getParent)(e).rpcManager}}})).actions((function(e){return{afterCreate:function(){var n=[];e.assemblyNames.forEach((function(e){if(!e)throw new Error('Encountered an assembly with no "name" defined');if(n.includes(e))throw new Error("Found two assemblies with the same name: ".concat(e));n.push(e)}))},addAssemblyConf:function(n){var t=n.name;if(!t)throw new Error('Can\'t add assembly with no "name"');var r=e.assemblies.find((function(e){return e.name===t}));if(r)return r;var o=e.assemblies.push((0,a.Z)((0,a.Z)({},n),{},{sequence:(0,a.Z)({type:"ReferenceSequenceTrack",trackId:"".concat(t,"-").concat(Date.now())},n.sequence||{})}));return e.assemblies[o-1]},removeAssemblyConf:function(n){var t=e.assemblies.find((function(e){return e.name===n}));t&&e.assemblies.remove(t)},addTrackConf:function(n){var t=n.type;if(!t)throw new Error("unknown track type ".concat(t));var r=e.tracks.find((function(e){return e.trackId===n.trackId}));if(r)return r;var o=e.tracks.push(n);return e.tracks[o-1]},addDisplayConf:function(n,t){var r=t.type;if(!r)throw new Error("unknown display type ".concat(r));var o=e.tracks.find((function(e){return e.trackId===n}));if(!o)throw new Error("could not find track with id ".concat(n));return o.addDisplayConf(t)},addConnectionConf:function(n){var t=n.type;if(!t)throw new Error("unknown connection type ".concat(t));var r=e.connections.push(n);return e.connections[r-1]},deleteConnectionConf:function(n){var t=e.connections.findIndex((function(e){return e.id===n.id}));if(-1!==t)return e.connections.splice(t,1)},deleteTrackConf:function(n){var t=n.trackId,r=e.tracks.findIndex((function(e){return e.trackId===t}));if(-1!==r)return e.tracks.splice(r,1)},setDefaultSessionConf:function(n){var t;if(!(t=(0,p.getParent)(e).session.name===n.name?(0,p.getSnapshot)(n):(0,wn.toJS)(n)).name)throw new Error("unable to set default session to ".concat(t.name));e.defaultSession=(0,p.cast)(t)},addPlugin:function(n){e.plugins.push(n),(0,p.getRoot)(e).setPluginsUpdated(!0)},removePlugin:function(n){e.plugins=(0,p.cast)(e.plugins.filter((function(e){return e.url!==n.url||e.umdUrl!==n.umdUrl||e.cjsUrl!==n.cjsUrl||e.esmUrl!==n.esmUrl}))),(0,p.getParent)(e).setPluginsUpdated(!0)},addInternetAccountConf:function(n){var t=n.type;if(!t)throw new Error("unknown internetAccount type ".concat(t));var r=e.internetAccounts.push(n);return e.internetAccounts[r-1]},deleteInternetAccountConf:function(n){var t=e.internetAccounts.findIndex((function(e){return e.id===n.id}));if(-1!==t)return e.internetAccounts.splice(t,1)}}}));return p.types.snapshotProcessor(r,{postProcessor:function(e){return Zt(kt()(e),"baseUri")}})}window.getSnapshot=p.getSnapshot,window.resolveIdentifier=p.resolveIdentifier;var Ct=t(53724);function Tt(e){return e.extend((function(){return function(e){return{views:{get snackbarMessages(){return e}},actions:{notify:function(e,n,t){var r=this;this.pushSnackbarMessage(e,n,t),"info"!==n&&"success"!==n||setTimeout((function(){r.removeSnackbarMessage(e)}),5e3)},pushSnackbarMessage:function(n,t,r){return e.push([n,t,r])},popSnackbarMessage:function(){return e.pop()},removeSnackbarMessage:function(n){var t=e.find((function(e){return e[0]===n}));t&&e.remove(t)}}}}(wn.observable.array())}))}var At=t(31946),jt=t(47306),Et=["connectionInstances"],Pt=(0,u.lazy)((function(){return Promise.all([t.e(534),t.e(4514),t.e(952),t.e(7660),t.e(8941),t.e(8170)]).then(t.bind(t,58170))}));var Mt=(0,u.lazy)((function(){return t.e(6656).then(t.bind(t,56656))}));function It(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=zn(e),o=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.types.frozen(),t=p.types.model("JBrowseWebSessionModel",{id:p.types.optional(p.types.identifier,U()()),name:p.types.string,margin:0,drawerWidth:p.types.optional(p.types.refinement(p.types.integer,(function(e){return e>=128})),384),views:p.types.array(e.pluggableMstType("view","stateModel")),widgets:p.types.map(e.pluggableMstType("widget","stateModel")),activeWidgets:p.types.map(p.types.safeReference(e.pluggableMstType("widget","stateModel"))),connectionInstances:p.types.array(e.pluggableMstType("connection","stateModel")),sessionTracks:p.types.array(e.pluggableConfigSchemaType("track")),sessionConnections:p.types.array(e.pluggableConfigSchemaType("connection")),sessionAssemblies:p.types.array(n),temporaryAssemblies:p.types.array(n),sessionPlugins:p.types.array(p.types.frozen()),minimized:p.types.optional(p.types.boolean,!1),drawerPosition:p.types.optional(p.types.string,(function(){return(0,R.localStorageGetItem)("drawerPosition")||"right"}))}).volatile((function(){return{sessionThemeName:(0,R.localStorageGetItem)("themeName")||"default",selection:void 0,task:void 0,queueOfDialogs:wn.observable.array([])}})).views((function(e){return{get jbrowse(){return(0,p.getParent)(e).jbrowse}}})).views((function(e){return{allThemes:function(){var n=(0,C.getConf)(e.jbrowse,"extraThemes");return(0,a.Z)((0,a.Z)({},Ct.kG),n)}}})).views((function(e){return{get themeName(){var n=e.sessionThemeName;return e.allThemes()[n]?n:"default"}}})).views((function(e){return{get theme(){var n=(0,C.getConf)(e.jbrowse,"theme"),t=e.allThemes();return(0,Ct.qD)(n,t,e.themeName)},get DialogComponent(){if(e.queueOfDialogs.length){var n=e.queueOfDialogs[0];return n&&n[0]}},get DialogProps(){if(e.queueOfDialogs.length){var n=e.queueOfDialogs[0];return n&&n[1]}},get shareURL(){return(0,C.getConf)(e.jbrowse,"shareURL")},get rpcManager(){return e.jbrowse.rpcManager},get configuration(){return e.jbrowse.configuration},get assemblies(){return e.jbrowse.assemblies},get assemblyNames(){var n=(0,p.getParent)(e).jbrowse.assemblyNames,t=e.sessionAssemblies.map((function(e){return(0,C.readConfObject)(e,"name")}));return[].concat((0,r.Z)(n),(0,r.Z)(t))},get tracks(){return[].concat((0,r.Z)(e.sessionTracks),(0,r.Z)((0,p.getParent)(e).jbrowse.tracks))},get textSearchManager(){return(0,p.getParent)(e).textSearchManager},get connections(){return[].concat((0,r.Z)(e.sessionConnections),(0,r.Z)(e.jbrowse.connections))},get adminMode(){return(0,p.getParent)(e).adminMode},get savedSessions(){return(0,p.getParent)(e).savedSessions},get previousAutosaveId(){return(0,p.getParent)(e).previousAutosaveId},get savedSessionNames(){return(0,p.getParent)(e).savedSessionNames},get history(){return(0,p.getParent)(e).history},get menus(){return(0,p.getParent)(e).menus},get assemblyManager(){return(0,p.getParent)(e).assemblyManager},get version(){return(0,p.getParent)(e).version},renderProps:function(){return{theme:this.theme}},get visibleWidget(){if((0,p.isAlive)(e))return Array.from(e.activeWidgets.values())[e.activeWidgets.size-1]},getReferring:function(n){var t=[];return(0,p.walk)((0,p.getParent)(e),(function(e){if((0,p.isModelType)((0,p.getType)(e))){var r=(0,p.getMembers)(e);Object.entries(r.properties).forEach((function(r){var o=(0,c.Z)(r,2),i=o[0],a=o[1];(0,p.isReferenceType)(a)&&e[i]===n&&t.push({node:e,key:i})}))}})),t}}})).actions((function(n){return{setThemeName:function(e){n.sessionThemeName=e},moveViewUp:function(e){var t=n.views.findIndex((function(n){return n.id===e}));-1!==t&&t>0&&n.views.splice(t-1,2,n.views[t],n.views[t-1])},moveViewDown:function(e){var t=n.views.findIndex((function(n){return n.id===e}));-1!==t&&t<n.views.length-1&&n.views.splice(t,2,n.views[t+1],n.views[t])},setDrawerPosition:function(e){n.drawerPosition=e},queueDialog:function(e){var t=e((function(){return n.queueOfDialogs.shift()})),r=(0,c.Z)(t,2),o=r[0],i=r[1];n.queueOfDialogs.push([o,i])},setName:function(e){n.name=e},addAssembly:function(e){var t=n.sessionAssemblies.find((function(n){return n.name===e.name}));if(t)return console.warn("Assembly ".concat(e.name," was already existing")),t;var r=n.sessionAssemblies.push(e);return n.sessionAssemblies[r-1]},addTemporaryAssembly:function(e){var t=n.sessionAssemblies.find((function(n){return n.name===e.name}));if(t)return console.warn("Assembly ".concat(e.name," was already existing")),t;var r=n.temporaryAssemblies.push(e);return n.temporaryAssemblies[r-1]},addSessionPlugin:function(e){if(n.sessionPlugins.find((function(n){return n.name===e.name})))throw new Error("session plugin cannot be installed twice");n.sessionPlugins.push(e),(0,p.getRoot)(n).setPluginsUpdated(!0)},removeAssembly:function(e){var t=n.sessionAssemblies.findIndex((function(n){return n.name===e}));-1!==t&&n.sessionAssemblies.splice(t,1)},removeTemporaryAssembly:function(e){var t=n.temporaryAssemblies.findIndex((function(n){return n.name===e}));-1!==t&&n.temporaryAssemblies.splice(t,1)},removeSessionPlugin:function(e){n.sessionPlugins=(0,p.cast)(n.sessionPlugins.filter((function(n){return n.url!==e.url||n.umdUrl!==e.umdUrl||n.cjsUrl!==e.cjsUrl||n.esmUrl!==e.esmUrl}))),(0,p.getParent)(n).setPluginsUpdated(!0)},makeConnection:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=t.type;if(!o)throw new Error("track configuration has no `type` listed");var i=(0,C.readConfObject)(t,"name");if(!e.getConnectionType(o))throw new Error("unknown connection type ".concat(o));var s=(0,a.Z)((0,a.Z)({},r),{},{name:i,type:o,configuration:t}),c=n.connectionInstances.push(s);return n.connectionInstances[c-1]},removeReferring:function(e,t,r,o){var i=this;e.forEach((function(e){var a=e.node,s=!1;try{var c="open track(s)",u=(0,R.getContainingView)(a);r.push((function(){return u.hideTrack(t.trackId)})),s=!0,o[c]||(o[c]=0),o[c]+=1}catch(f){}if(n.widgets.has(a.id)){var l="configuration editor widget(s)";r.push((function(){return i.hideWidget(a)})),s=!0,o[l]||(o[l]=0),o[l]+=1}if(!s)throw new Error("Error when closing this connection, the following node is still referring to a track configuration: ".concat(JSON.stringify((0,p.getSnapshot)(a))))}))},prepareToBreakConnection:function(e){var t=this,r=[],o={},i=(0,C.readConfObject)(e,"name"),a=n.connectionInstances.find((function(e){return e.name===i}));if(a)return a.tracks.forEach((function(e){var i=n.getReferring(e);t.removeReferring(i,e,r,o)})),[function(){r.forEach((function(e){return e()})),t.breakConnection(e)},o]},breakConnection:function(e){var t=(0,C.readConfObject)(e,"name"),r=n.connectionInstances.find((function(e){return e.name===t}));n.connectionInstances.remove(r)},deleteConnection:function(e){var t;if(n.adminMode&&(t=(0,p.getParent)(n).jbrowse.deleteConnectionConf(e)),!t){var r=e.connectionId,o=n.sessionConnections.findIndex((function(e){return e.connectionId===r}));if(-1===o)return;return n.sessionConnections.splice(o,1)}return t},updateDrawerWidth:function(e){if(e===n.drawerWidth)return n.drawerWidth;var t=e;return t<128&&(t=128),n.drawerWidth=t,t},resizeDrawer:function(e){"left"===n.drawerPosition&&(e*=-1);var t=n.drawerWidth;return t-this.updateDrawerWidth(t-e)},addView:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.getElementType("view",t))throw new Error("unknown view type ".concat(t));var o=n.views.push((0,a.Z)((0,a.Z)({},r),{},{type:t}));return n.views[o-1]},removeView:function(e){var t,r=(0,l.Z)(n.activeWidgets);try{for(r.s();!(t=r.n()).done;){var o=(0,c.Z)(t.value,2)[1];o.view&&o.view.id===e.id&&this.hideWidget(o)}}catch(i){r.e(i)}finally{r.f()}n.views.remove(e)},addAssemblyConf:function(e){return(0,p.getParent)(n).jbrowse.addAssemblyConf(e)},addTrackConf:function(e){if(n.adminMode)return(0,p.getParent)(n).jbrowse.addTrackConf(e);var t=e.trackId,r=e.type;if(!r)throw new Error("unknown track type ".concat(r));var o=n.sessionTracks.find((function(e){return e.trackId===t}));if(o)return o;var i=n.sessionTracks.push(e);return n.sessionTracks[i-1]},deleteTrackConf:function(e){var t=[],r=n.getReferring(e);if(this.removeReferring(r,e,t,{}),t.forEach((function(e){return e()})),n.adminMode)return(0,p.getParent)(n).jbrowse.deleteTrackConf(e);var o=e.trackId,i=n.sessionTracks.findIndex((function(e){return e.trackId===o}));return-1!==i?n.sessionTracks.splice(i,1):void 0},addConnectionConf:function(e){if(n.adminMode)return(0,p.getParent)(n).jbrowse.addConnectionConf(e);var t=e.connectionId,r=e.type;if(!r)throw new Error("unknown connection type ".concat(r));var o=n.sessionTracks.find((function(e){return e.connectionId===t}));if(o)return o;var i=n.sessionConnections.push(e);return n.sessionConnections[i-1]},addLinearGenomeViewOfAssembly:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addViewOfAssembly("LinearGenomeView",e,n)},addViewOfAssembly:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.assemblies.find((function(e){return(0,C.readConfObject)(e,"name")===t}));if(!o)throw new Error('Could not add view of assembly "'.concat(t,'", assembly name not found'));return r.displayRegionsFromAssemblyName=(0,C.readConfObject)(o,"name"),this.addView(e,r)},addViewFromAnotherView:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(0,a.Z)({},t);return r.displayedRegions=(0,p.getSnapshot)(n.displayedRegions),this.addView(e,r)},addWidget:function(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{type:t};if(!e.getElementType("widget",t))throw new Error("unknown widget type ".concat(t));var s=(0,a.Z)((0,a.Z)({},o),{},{id:r,type:t,configuration:i});return n.widgets.set(r,s),n.widgets.get(r)},showWidget:function(e){n.activeWidgets.has(e.id)&&n.activeWidgets.delete(e.id),n.activeWidgets.set(e.id,e),n.minimized=!1},hasWidget:function(e){return n.activeWidgets.has(e.id)},hideWidget:function(e){n.activeWidgets.delete(e.id)},minimizeWidgetDrawer:function(){n.minimized=!0},showWidgetDrawer:function(){n.minimized=!1},hideAllWidgets:function(){n.activeWidgets.clear()},setSelection:function(e){n.selection=e},clearSelection:function(){n.selection=void 0},clearConnections:function(){n.connectionInstances.length=0},addSavedSession:function(e){return(0,p.getParent)(n).addSavedSession(e)},removeSavedSession:function(e){return(0,p.getParent)(n).removeSavedSession(e)},renameCurrentSession:function(e){return(0,p.getParent)(n).renameCurrentSession(e)},duplicateCurrentSession:function(){return(0,p.getParent)(n).duplicateCurrentSession()},activateSession:function(e){return(0,p.getParent)(n).activateSession(e)},setDefaultSession:function(){return(0,p.getParent)(n).setDefaultSession()},saveSessionToLocalStorage:function(){return(0,p.getParent)(n).saveSessionToLocalStorage()},loadAutosaveSession:function(){return(0,p.getParent)(n).loadAutosaveSession()},setSession:function(e){return(0,p.getParent)(n).setSession(e)}}})).actions((function(e){return{editConfiguration:function(n){if(!(0,C.isConfigurationModel)(n))throw new Error("must pass a configuration model to editConfiguration");var t=e,r=t.addWidget("ConfigurationEditorWidget","configEditor",{target:n});t.showWidget(r)},editTrackConfiguration:function(n){var t=e.adminMode,r=e.sessionTracks;if(!t&&-1===r.indexOf(n))throw new Error("Can't edit the configuration of a non-session track");this.editConfiguration(n)}}})).views((function(e){return{getTrackActionMenuItems:function(n){var t=e.adminMode,r=e.sessionTracks,o=t||r.find((function(e){return e.trackId===n.trackId})),i="ReferenceSequenceTrack"===(0,C.readConfObject)(n,"type");return[{label:"About track",onClick:function(){e.queueDialog((function(e){return[Pt,{config:n,handleClose:e}]}))},icon:jt.Z},{label:"Settings",disabled:!o,onClick:function(){return e.editTrackConfiguration(n)},icon:He.Z},{label:"Delete track",disabled:!o||i,onClick:function(){return e.deleteTrackConf(n)},icon:At.Z},{label:"Copy track",disabled:i,onClick:function(){var t=kt()((0,p.getSnapshot)(n)),r=Date.now();t.trackId+="-".concat(r),t.displays.forEach((function(e){e.displayId+="-".concat(r)})),e.adminMode||(t.trackId+="-sessionTrack",t.category=void 0),t.name+=" (copy)",e.addTrackConf(t)},icon:ft.Z}]}}})).actions((function(e){return{afterAttach:function(){(0,p.addDisposer)(e,(0,wn.autorun)((function(){(0,R.localStorageSetItem)("drawerPosition",e.drawerPosition),(0,R.localStorageSetItem)("themeName",e.themeName)})))}}})),o=e.evaluateExtensionPoint("Core-extendSession",t);return p.types.snapshotProcessor(Tt(o),{preProcessor:function(e){if(e){var n=e||{},t=n.connectionInstances,r=(0,s.Z)(n,Et);if(!Array.isArray(t))return r}return e}})}(e,t),i=Un(t,e);return p.types.model("Root",{jbrowse:St(e,o,t),configPath:p.types.maybe(p.types.string),session:p.types.maybe(o),assemblyManager:p.types.optional(i,{}),version:p.types.maybe(p.types.string),internetAccounts:p.types.array(e.pluggableMstType("internet account","stateModel")),history:p.types.optional(ct,{targetPath:"../session"})}).volatile((function(n){return{isAssemblyEditing:!1,isDefaultSessionEditing:!1,pluginsUpdated:!1,rpcManager:new it(e,n.jbrowse.configuration.rpc,{WebWorkerRpcDriver:{makeWorkerInstance:wt},MainThreadRpcDriver:{}}),savedSessionsVolatile:wn.observable.map({}),textSearchManager:new at(e),error:void 0}})).views((function(e){return{get savedSessions(){return Array.from(e.savedSessionsVolatile.values())},localStorageId:function(n){return"localSaved-".concat(n,"-").concat(e.configPath)},get autosaveId(){return"autosave-".concat(e.configPath)},get previousAutosaveId(){return"previousAutosave-".concat(e.configPath)}}})).views((function(e){return{get savedSessionNames(){return e.savedSessions.map((function(e){return e.name}))},get currentSessionId(){var e,n=new URL(window.location.href),t=new URLSearchParams(n.search);return null===t||void 0===t||null===(e=t.get("session"))||void 0===e?void 0:e.split("local-")[1]}}})).actions((function(n){return{afterCreate:function(){var e=this;document.addEventListener("keydown",(function(e){var t=e.ctrlKey||e.metaKey;n.history.canRedo&&(t&&e.shiftKey&&"KeyZ"===e.code||e.ctrlKey&&!e.shiftKey&&"KeyY"===e.code)&&n.history.redo(),n.history.canUndo&&t&&!e.shiftKey&&"KeyZ"===e.code&&n.history.undo()})),Object.entries(localStorage).filter((function(e){var n=(0,c.Z)(e,2),t=n[0];n[1];return t.startsWith("localSaved-")})).filter((function(e){return-1!==(0,c.Z)(e,1)[0].indexOf(n.configPath||"undefined")})).forEach((function(e){var t=(0,c.Z)(e,2),r=t[0],o=t[1];try{var i=JSON.parse(o).session;n.savedSessionsVolatile.set(r,i)}catch(a){console.error("bad session encountered",r,o)}})),(0,p.addDisposer)(n,(0,wn.autorun)((function(){var e,t=(0,l.Z)(n.savedSessionsVolatile.entries());try{for(t.s();!(e=t.n()).done;){var r=(0,c.Z)(e.value,2)[1];try{var o=n.localStorageId(r.name);localStorage.setItem(o,JSON.stringify({session:r}))}catch(i){"22"!==i.code&&"1024"!==i.code||alert('Local storage is full! Please use the "Open sessions" panel to remove old sessions')}}}catch(a){t.e(a)}finally{t.f()}}))),(0,p.addDisposer)(n,(0,wn.autorun)((function(){n.session&&n.history.initialize()}))),(0,p.addDisposer)(n,(0,wn.autorun)((function(){if(n.session){var e=(0,p.getSnapshot)(n.session)||{name:"empty"};sessionStorage.setItem("current",JSON.stringify({session:e})),localStorage.setItem("autosave-".concat(n.configPath),JSON.stringify({session:(0,a.Z)((0,a.Z)({},e),{},{name:"".concat(e.name,"-autosaved")})})),n.pluginsUpdated&&window.location.reload()}}),{delay:400})),(0,p.addDisposer)(n,(0,wn.autorun)((function(){n.jbrowse.internetAccounts.forEach((function(n){e.initializeInternetAccount(n)}))})))},setSession:function(e){var t=n.session;if(n.session=(0,p.cast)(e),n.session)try{nn(n.session,(0,p.getType)(n.session))}catch(r){throw n.session=t,r}},initializeInternetAccount:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.getInternetAccountType(t.type))throw new Error("unknown internet account type ".concat(t.type));var o=n.internetAccounts.push((0,a.Z)((0,a.Z)({},r),{},{type:t.type,configuration:t}));return n.internetAccounts[o-1]},createEphemeralInternetAccount:function(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;try{r=new URL(i).origin}catch(l){}var s=t.split("-"),c={type:s[0],internetAccountId:t,name:s.slice(1).join("-"),description:"",domains:r?[r]:[]},u=e.getInternetAccountType(c.type).stateModel.create((0,a.Z)((0,a.Z)({},o),{},{type:c.type,configuration:c}));return n.internetAccounts.push(u),u},setAssemblyEditing:function(e){n.isAssemblyEditing=e},setDefaultSessionEditing:function(e){n.isDefaultSessionEditing=e},setPluginsUpdated:function(e){n.pluginsUpdated=e},setDefaultSession:function(){var e=n.jbrowse.defaultSession,t=(0,a.Z)((0,a.Z)({},e),{},{name:"".concat(e.name," ").concat((new Date).toLocaleString())});this.setSession(t)},renameCurrentSession:function(e){if(n.session){var t=JSON.parse(JSON.stringify((0,p.getSnapshot)(n.session)));t.name=e,this.setSession(t)}},addSavedSession:function(e){var t=n.localStorageId(e.name);n.savedSessionsVolatile.set(t,e)},removeSavedSession:function(e){var t=n.localStorageId(e.name);localStorage.removeItem(t),n.savedSessionsVolatile.delete(t)},duplicateCurrentSession:function(){if(n.session){var e=JSON.parse(JSON.stringify((0,p.getSnapshot)(n.session))),t="".concat(n.session.name," (copy)");if(n.savedSessionNames.includes(t)){var r=2;do{t="".concat(n.session.name," (copy ").concat(r,")"),r+=1}while(n.savedSessionNames.includes(t))}e.name=t,this.setSession(e)}},activateSession:function(e){var t=n.localStorageId(e),r=localStorage.getItem(t);if(!r)throw new Error("Can't activate session ".concat(e,", it is not in the savedSessions"));this.setSession(JSON.parse(r).session)},saveSessionToLocalStorage:function(){if(n.session){var e=n.localStorageId(n.session.name);n.savedSessionsVolatile.set(e,(0,p.getSnapshot)(n.session))}},loadAutosaveSession:function(){var e=localStorage.getItem(n.previousAutosaveId),t=e?JSON.parse(e).session:{},r=t.name;t.name="".concat(r.replace("-autosaved",""),"-restored"),this.setSession(t)},setError:function(e){n.error=e},findAppropriateInternetAccount:function(e){var t=e.internetAccountId;if(t){var r=n.internetAccounts.find((function(e){return e.internetAccountId===t}));if(r)return r}var o,i=(0,l.Z)(n.internetAccounts);try{for(i.s();!(o=i.n()).done;){var a=o.value;if(a.handlesLocation(e))return a}}catch(s){i.e(s)}finally{i.f()}return t?this.createEphemeralInternetAccount(t,{},e.uri):null}}})).volatile((function(e){return{menus:[{label:"File",menuItems:[{label:"New session",icon:ut.Z,onClick:function(n){var t=localStorage.getItem(e.autosaveId);t&&localStorage.setItem(e.previousAutosaveId,t),n.setDefaultSession()}},{label:"Import session\u2026",icon:ht.Z,onClick:function(e){var n=e.addWidget("ImportSessionWidget","importSessionWidget");e.showWidget(n)}},{label:"Export session",icon:pt.Z,onClick:function(e){var n=new Blob([JSON.stringify({session:(0,p.getSnapshot)(e)},null,2)],{type:"text/plain;charset=utf-8"});(0,bn.saveAs)(n,"session.json")}},{label:"Open session\u2026",icon:dt.Z,onClick:function(e){var n=e.addWidget("SessionManager","sessionManager");e.showWidget(n)}},{label:"Save session",icon:mt.Z,onClick:function(n){e.saveSessionToLocalStorage(),n.notify('Saved session "'.concat(n.name,'"'),"success")}},{label:"Duplicate session",icon:ft.Z,onClick:function(e){e.duplicateCurrentSession&&e.duplicateCurrentSession()}},{type:"divider"},{label:"Open track...",icon:gt.Z,onClick:function(e){if(0===e.views.length)e.notify("Please open a view to add a track first");else if(e.views.length>=1){var n=e.addWidget("AddTrackWidget","addTrackWidget",{view:e.views[0].id});e.showWidget(n),e.views.length>1&&e.notify("This will add a track to the first view. Note: if you want to open a track in a specific view open the track selector for that view and use the add track (plus icon) in the bottom right")}}},{label:"Open connection...",icon:Qe.sB,onClick:function(e){var n=e.addWidget("AddConnectionWidget","addConnectionWidget");e.showWidget(n)}},{type:"divider"},{label:"Return to splash screen",icon:lt.Z,onClick:function(){return e.setSession(void 0)}}]}].concat((0,r.Z)(n?[{label:"Admin",menuItems:[{label:"Open assembly manager",onClick:function(){return e.setAssemblyEditing(!0)}},{label:"Set default session",onClick:function(){return e.setDefaultSessionEditing(!0)}}]}]:[]),[{label:"Add",menuItems:[]},{label:"Tools",menuItems:[{label:"Undo",icon:yt.Z,onClick:function(){e.history.canUndo&&e.history.undo()}},{label:"Redo",icon:bt.Z,onClick:function(){e.history.canRedo&&e.history.redo()}},{type:"divider"},{label:"Plugin store",icon:vt.Z,onClick:function(){if(e.session){var n=e.session.addWidget("PluginStoreWidget","pluginStoreWidget");e.session.showWidget(n)}}},{label:"Preferences",icon:He.Z,onClick:function(){e.session&&e.session.queueDialog((function(n){return[Mt,{session:e.session,handleClose:n}]}))}}]}]),adminMode:n}})).actions((function(e){return{setMenus:function(n){e.menus=n},appendMenu:function(n){return e.menus.push({label:n,menuItems:[]})},insertMenu:function(n,t){return e.menus.splice((t<0?e.menus.length:0)+t,0,{label:n,menuItems:[]}),e.menus.length},appendToMenu:function(n,t){var r=e.menus.find((function(e){return e.label===n}));return r?r.menuItems.push(t):(e.menus.push({label:n,menuItems:[t]}),1)},insertInMenu:function(n,t,r){var o=e.menus.find((function(e){return e.label===n}));if(!o)return e.menus.push({label:n,menuItems:[t]}),1;var i=r<0?o.menuItems.length+r:r;return o.menuItems.splice(i,0,t),o.menuItems.length},appendToSubMenu:function(n,t){var r=e.menus.find((function(e){return e.label===n[0]}));if(!r){var o=this.appendMenu(n[0]);r=e.menus[o-1]}var i=r.menuItems,a=[n[0]];return n.slice(1).forEach((function(e){a.push(e);var n=i.find((function(n){return"label"in n&&n.label===e}));if(!n){var t=i.push({label:e,subMenu:[]});n=i[t-1]}if(!("subMenu"in n))throw new Error('"'.concat(e,'" in path "').concat(a,'" is not a subMenu'));i=n.subMenu})),i.push(t)},insertInSubMenu:function(n,t,r){var o=e.menus.find((function(e){return e.label===n[0]}));if(!o){var i=this.appendMenu(n[0]);o=e.menus[i-1]}var a=o.menuItems,s=[n[0]];return n.slice(1).forEach((function(e){s.push(e);var n=a.find((function(n){return"label"in n&&n.label===e}));if(!n){var t=a.push({label:e,subMenu:[]});n=a[t-1]}if(!("subMenu"in n))throw new Error('"'.concat(e,'" in path "').concat(s,'" is not a subMenu'));a=n.subMenu})),a.splice(r,0,t),a.length}}}))}var Rt="2.4.0";function Nt(){return Dt.apply(this,arguments)}function Dt(){return(Dt=(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.location=window.location.pathname;case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Lt=t(95694),Ot=t.n(Lt);function Wt(e){return(void 0!==e.umdUrl||void 0!==e.url||void 0!==e.umdLoc)&&void 0!==e.name}function Ut(e){return void 0!==e.esmUrl||void 0!==e.esmLoc}function zt(e){return void 0!==e.cjsUrl}var _t=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;(0,f.Z)(this,e),this.definitions=[],this.fetchESM=void 0,this.fetchCJS=void 0,this.fetchESM=null===t||void 0===t?void 0:t.fetchESM,this.fetchCJS=null===t||void 0===t?void 0:t.fetchCJS,this.definitions=JSON.parse(JSON.stringify(n))}return(0,d.Z)(e,[{key:"loadScript",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Boolean("WorkerGlobalScope"in globalThis)){e.next=2;break}return e.abrupt("return",Ot()(n));case 2:if(null===globalThis||void 0===globalThis||!globalThis.importScripts){e.next=6;break}return e.next=5,globalThis.importScripts(n);case 5:return e.abrupt("return");case 6:throw new Error("cannot figure out how to load external JS scripts in this environment");case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},{key:"loadCJSPlugin",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n,t){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("http:"===(r=new URL(n.cjsUrl,t)).protocol||"https:"===r.protocol){e.next=3;break}throw new Error('Cannot load plugins using protocol "'.concat(r.protocol,'"'));case 3:if(this.fetchCJS){e.next=5;break}throw new Error("No fetchCJS callback provided");case 5:return e.abrupt("return",this.fetchCJS(r.href));case 6:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"loadESMPlugin",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n,t){var r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("http:"===(r="esmUrl"in n?new URL(n.esmUrl,t):new URL(n.esmLoc.uri,n.esmLoc.baseUri)).protocol||"https:"===r.protocol){e.next=3;break}throw new Error('cannot load plugins using protocol "'.concat(r.protocol,'"'));case 3:if(this.fetchESM){e.next=5;break}throw new Error("No ESM fetcher installed");case 5:return e.next=7,this.fetchESM(r.href);case 7:if(i=e.sent){e.next=10;break}throw new Error("Could not load ESM plugin: ".concat(r));case 10:return e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"loadUMDPlugin",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n,t){var r,i,a,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("http:"===(r="url"in n?new URL(n.url,t):"umdUrl"in n?new URL(n.umdUrl,t):new URL(n.umdLoc.uri,n.umdLoc.baseUri)).protocol||"https:"===r.protocol){e.next=3;break}throw new Error('cannot load plugins using protocol "'.concat(r.protocol,'"'));case 3:if(i=n.name,a="JBrowsePlugin".concat(i),"undefined"===typeof jest){e.next=9;break}globalThis[a]={default:X.Z},e.next=11;break;case 9:return e.next=11,this.loadScript(r.href);case 11:if(s=globalThis[a]){e.next=14;break}throw new Error("Failed to load UMD bundle for ".concat(i,", ").concat(a," is undefined"));case 14:return e.abrupt("return",s);case 15:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"loadPlugin",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n,t){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!R.isElectron||!zt(n)){e.next=6;break}return e.next=3,this.loadCJSPlugin(n,t);case 3:case 9:case 15:r=e.sent,e.next=23;break;case 6:if(!Ut(n)){e.next=12;break}return e.next=9,this.loadESMPlugin(n,t);case 12:if(!Wt(n)){e.next=18;break}return e.next=15,this.loadUMDPlugin(n,t);case 18:if(R.isElectron||!zt(n)){e.next=22;break}throw new Error("CommonJS plugin found, but not in a NodeJS environment: ".concat(JSON.stringify(n)));case 22:throw new Error("Could not determine plugin type: ".concat(JSON.stringify(n)));case 23:return e.abrupt("return",r.default);case 24:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"installGlobalReExports",value:function(e){e.JBrowseExports=Object.fromEntries(Object.entries(T.Z).map((function(e){var n=(0,c.Z)(e,2);return[n[0],n[1]]})))}},{key:"load",value:function(){var e=(0,i.Z)((0,o.Z)().mark((function e(n){var t=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(this.definitions.map(function(){var e=(0,i.Z)((0,o.Z)().mark((function e(r){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.loadPlugin(r,n);case 2:return e.t0=e.sent,e.t1=r,e.abrupt("return",{plugin:e.t0,definition:e.t1});case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())));case 1:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()}]),e}(),Bt=t(32145);function Vt(e,n){if("object"===typeof e)for(var t=0,r=Object.keys(e);t<r.length;t++){var o=r[t];"object"===typeof e[o]?Vt(e[o],n):"uri"===o&&(e.baseUri=n.href)}}function qt(e,n,t){var r=e.configuration;return(void 0===r?{}:r)[n]||t}function Gt(){return Ft.apply(this,arguments)}function Ft(){return(Ft=(0,i.Z)((0,o.Z)().mark((function e(){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://jbrowse.org/plugin-store/plugins.json");case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("HTTP ".concat(n.status," ").concat(n.statusText," fetching plugins"));case 5:return e.abrupt("return",n.json());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Jt(e){return Ht.apply(this,arguments)}function Ht(){return(Ht=(0,i.Z)((0,o.Z)().mark((function e(n){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==n.length){e.next=2;break}return e.abrupt("return",!0);case 2:return e.next=4,Gt();case 4:return t=e.sent,e.abrupt("return",n.every((function(e){return Wt(e)?Boolean(t.plugins.find((function(n){return Wt(e)&&("url"in n&&"url"in e&&e.url===n.url||"umdUrl"in n&&"umdUrl"in e&&e.umdUrl===n.umdUrl)}))):Ut(e)?Boolean(t.plugins.find((function(n){return Ut(e)&&"esmUrl"in e&&e.esmUrl===n.esmUrl}))):!!zt(e)&&Boolean(t.plugins.find((function(n){return zt(e)&&e.cjsUrl===n.cjsUrl})))})));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Qt=p.types.model({configPath:p.types.maybe(p.types.string),sessionQuery:p.types.maybe(p.types.string),password:p.types.maybe(p.types.string),adminKey:p.types.maybe(p.types.string),loc:p.types.maybe(p.types.string),sessionTracks:p.types.maybe(p.types.string),assembly:p.types.maybe(p.types.string),tracks:p.types.maybe(p.types.string)}).volatile((function(){return{blankSession:!1,sessionTriaged:void 0,shareWarningOpen:!1,configSnapshot:void 0,sessionSnapshot:void 0,sessionSpec:void 0,runtimePlugins:[],sessionPlugins:[],sessionError:void 0,configError:void 0,bc1:window.BroadcastChannel&&new window.BroadcastChannel("jb_request_session"),bc2:window.BroadcastChannel&&new window.BroadcastChannel("jb_respond_session")}})).views((function(e){return{get isSharedSession(){var n;return!(null===(n=e.sessionQuery)||void 0===n||!n.startsWith("share-"))},get isSpecSession(){var n;return!(null===(n=e.sessionQuery)||void 0===n||!n.startsWith("spec-"))},get isJb1StyleSession(){return!!e.loc},get isEncodedSession(){var n;return!(null===(n=e.sessionQuery)||void 0===n||!n.startsWith("encoded-"))},get isJsonSession(){var n;return!(null===(n=e.sessionQuery)||void 0===n||!n.startsWith("json-"))},get isLocalSession(){var n;return!(null===(n=e.sessionQuery)||void 0===n||!n.startsWith("local-"))},get ready(){return Boolean(this.isSessionLoaded&&!e.configError)},get error(){return e.configError||e.sessionError},get isSessionLoaded(){return Boolean(e.sessionError||e.sessionSnapshot||e.blankSession||e.sessionSpec)},get isConfigLoaded(){return Boolean(e.configError||e.configSnapshot)},get sessionTracksParsed(){return e.sessionTracks?JSON.parse(e.sessionTracks):[]}}})).actions((function(e){return{setSessionQuery:function(n){e.sessionQuery=n},setConfigError:function(n){e.configError=n},setSessionError:function(n){e.sessionError=n},setRuntimePlugins:function(n){e.runtimePlugins=n},setSessionPlugins:function(n){e.sessionPlugins=n},setConfigSnapshot:function(n){e.configSnapshot=n},setBlankSession:function(n){e.blankSession=n},setSessionTriaged:function(n){e.sessionTriaged=n},setSessionSnapshotSuccess:function(n){e.sessionSnapshot=n}}})).actions((function(e){return{fetchPlugins:function(n){return(0,i.Z)((0,o.Z)().mark((function t(){var i,a;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(i=new _t(n.plugins,{fetchESM:function(e){return import(e)}})).installGlobalReExports(window),t.next=5,i.load(window.location.href);case 5:a=t.sent,e.setRuntimePlugins((0,r.Z)(a)),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0),e.setConfigError(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()},fetchSessionPlugins:function(n){return(0,i.Z)((0,o.Z)().mark((function t(){var i,a;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(i=new _t(n.sessionPlugins||[],{fetchESM:function(e){return import(e)}})).installGlobalReExports(window),t.next=5,i.load(window.location.href);case 5:a=t.sent,e.setSessionPlugins((0,r.Z)(a)),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0),e.setConfigError(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()},setSessionSnapshot:function(n,t){var r=this;return(0,i.Z)((0,o.Z)().mark((function i(){var a,s;return(0,o.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,a=n.sessionPlugins,s=void 0===a?[]:a,o.next=4,Jt(s);case 4:if(!o.sent&&!t){o.next=11;break}return o.next=8,r.fetchSessionPlugins(n);case 8:e.setSessionSnapshotSuccess(n),o.next=12;break;case 11:e.setSessionTriaged({snap:n,origin:"session",reason:s});case 12:o.next=18;break;case 14:o.prev=14,o.t0=o.catch(0),console.error(o.t0),e.setConfigError(o.t0);case 18:case"end":return o.stop()}}),i,null,[[0,14]])})))()},fetchConfig:function(){var n=this;return(0,i.Z)((0,o.Z)().mark((function t(){var r,i,a,s,c,u;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.configPath,i=void 0===r?"config.json":r,window.__jbrowseCacheBuster&&(i+="?rand=".concat(Math.random())),t.next=4,(0,Bt.openLocation)({uri:i,locationType:"UriLocation"}).readFile("utf8");case 4:if(a=t.sent,s=JSON.parse(a),c=new URL(i,window.location.href),Vt(s,c),c.hostname===window.location.hostname){t.next=15;break}return u=s.plugins||[],t.next=12,Jt(u);case 12:if(t.sent){t.next=15;break}return t.abrupt("return",e.setSessionTriaged({snap:s,origin:"config",reason:u}));case 15:return t.next=17,n.fetchPlugins(s);case 17:e.setConfigSnapshot(s);case 18:case"end":return t.stop()}}),t)})))()},fetchSessionStorageSession:function(){var n=this;return(0,i.Z)((0,o.Z)().mark((function t(){var r,i,s,c;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=sessionStorage.getItem("current"),i=e.sessionQuery.replace("local-",""),!r){t.next=6;break}if(s=JSON.parse(r).session||{},i!==s.id){t.next=6;break}return t.abrupt("return",n.setSessionSnapshot(s));case 6:if(!e.bc1){t.next=17;break}return e.bc1.postMessage(i),t.prev=8,t.next=11,new Promise((function(n,t){e.bc2&&(e.bc2.onmessage=function(e){n(e.data)}),setTimeout((function(){return t()}),1e3)}));case 11:return c=t.sent,t.abrupt("return",n.setSessionSnapshot((0,a.Z)((0,a.Z)({},c),{},{id:U()()})));case 15:t.prev=15,t.t0=t.catch(8);case 17:throw new Error("Local storage session not found");case 18:case"end":return t.stop()}}),t,null,[[8,15]])})))()},fetchSharedSession:function(){var n=this;return(0,i.Z)((0,o.Z)().mark((function t(){var r,i;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"https://share.jbrowse.org/api/v1/",t.next=3,cn("".concat(qt(e.configSnapshot,"shareURL","https://share.jbrowse.org/api/v1/"),"load"),e.sessionQuery||"",e.password||"");case 3:return r=t.sent,t.t0=JSON,t.next=7,Ye(r);case 7:return t.t1=t.sent,i=t.t0.parse.call(t.t0,t.t1),t.next=11,n.setSessionSnapshot((0,a.Z)((0,a.Z)({},i),{},{id:U()()}));case 11:case"end":return t.stop()}}),t)})))()},decodeEncodedUrlSession:function(){var n=this;return(0,i.Z)((0,o.Z)().mark((function t(){var r;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=JSON,t.next=3,Ye(e.sessionQuery.replace("encoded-",""));case 3:return t.t1=t.sent,r=t.t0.parse.call(t.t0,t.t1),t.next=7,n.setSessionSnapshot((0,a.Z)((0,a.Z)({},r),{},{id:U()()}));case 7:case"end":return t.stop()}}),t)})))()},decodeSessionSpec:function(){e.sessionQuery&&(e.sessionSpec=JSON.parse(e.sessionQuery.replace("spec-","")))},decodeJb1StyleSession:function(){var n=e.loc,t=e.tracks,r=e.assembly,o=e.sessionTracksParsed;n&&(e.sessionSpec={sessionTracks:o,views:[{type:"LinearGenomeView",tracks:null===t||void 0===t?void 0:t.split(","),sessionTracks:o,loc:n,assembly:r}]})},decodeJsonUrlSession:function(){var n=this;return(0,i.Z)((0,o.Z)().mark((function t(){var r;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=JSON.parse(e.sessionQuery.replace("json-","")),t.next=3,n.setSessionSnapshot((0,a.Z)((0,a.Z)({},r.session),{},{id:U()()}));case 3:case"end":return t.stop()}}),t)})))()},afterCreate:function(){var n=this;return(0,i.Z)((0,o.Z)().mark((function t(){var r,a;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{r=e.configPath,(a=localStorage.getItem("autosave-".concat(r)))&&localStorage.setItem("previousAutosave-".concat(r),a)}catch(s){console.error("failed to create previousAutosave",s)}return t.prev=1,t.next=4,n.fetchConfig();case 4:t.next=11;break;case 6:return t.prev=6,t.t0=t.catch(1),console.error(t.t0),e.setConfigError(t.t0),t.abrupt("return");case 11:(0,p.addDisposer)(e,(0,wn.autorun)((0,i.Z)((0,o.Z)().mark((function t(){var r,i,a,s,c,u,l;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=e.isLocalSession,i=e.isEncodedSession,a=e.isSpecSession,s=e.isSharedSession,c=e.isJsonSession,u=e.isJb1StyleSession,l=e.sessionQuery,e.configSnapshot){t.next=4;break}return t.abrupt("return");case 4:if(e.bc1&&(e.bc1.onmessage=function(n){var t=JSON.parse(sessionStorage.getItem("current")||"{}").session||{};t.id===n.data&&e.bc2&&e.bc2.postMessage(t)}),!s){t.next=10;break}return t.next=8,n.fetchSharedSession();case 8:t.next=38;break;case 10:if(!a){t.next=14;break}n.decodeSessionSpec(),t.next=38;break;case 14:if(!u){t.next=18;break}n.decodeJb1StyleSession(),t.next=38;break;case 18:if(!i){t.next=23;break}return t.next=21,n.decodeEncodedUrlSession();case 21:t.next=38;break;case 23:if(!c){t.next=28;break}return t.next=26,n.decodeJsonUrlSession();case 26:t.next=38;break;case 28:if(!r){t.next=33;break}return t.next=31,n.fetchSessionStorageSession();case 31:t.next=38;break;case 33:if(!l){t.next=37;break}throw new Error("unrecognized session format");case 37:e.setBlankSession(!0);case 38:t.next=44;break;case 40:t.prev=40,t.t0=t.catch(0),console.error(t.t0),e.setSessionError(t.t0);case 44:case"end":return t.stop()}}),t,null,[[0,40]])})))));case 12:case"end":return t.stop()}}),t,null,[[1,6]])})))()}}}));var Kt=["config"],Yt=(0,u.lazy)((function(){return t.e(4583).then(t.bind(t,74583))})),$t=(0,u.lazy)((function(){return t.e(8969).then(t.bind(t,98969))})),Xt=(0,u.lazy)((function(){return Promise.resolve().then(t.bind(t,66379))})),er=(0,u.lazy)((function(){return Promise.all([t.e(8581),t.e(1462)]).then(t.bind(t,26213))}));function nr(){return(0,ln.jsxs)("div",{children:[(0,ln.jsx)("h4",{children:"Configuration not found. You may have arrived here if you requested a config that does not exist or you have not set up your JBrowse yet."}),R.inDevelopment?(0,ln.jsxs)(ln.Fragment,{children:[(0,ln.jsx)("div",{children:"Sample JBrowse configs:"}),(0,ln.jsx)("ul",{children:[["test_data/volvox/config.json","Volvox sample data"],["test_data/volvoxhub/config.json","Volvox hub sample data"],["test_data/config.json","Human basic"],["test_data/config_demo.json","Human sample data"],["test_data/tomato/config.json","Tomato SVs"],["test_data/breakpoint/config.json","Breakpoint"],["test_data/config_dotplot.json","Grape/Peach dotplot"],["test_data/config_synteny_grape_peach.json","Grape/Peach synteny"],["test_data/human_vs_mouse.json","Human vs mouse synteny"],["test_data/yeast_synteny/config.json","Yeast synteny"],["test_data/config_many_contigs.json","Many contigs"],["test_data/config_honeybee.json","Honeybee"],["test_data/config_wormbase.json","Wormbase"],["test_data/config_human_dotplot.json","Human dotplot"],["test_data/volvox/theme.json","Theme test (wild color)"],["test_data/volvox/theme2.json","Theme test (wormbase color)"],["test_data/wgbs/config.json","WGBS methylation"]].map((function(e){var n=(0,c.Z)(e,2),t=n[0],r=n[1],o=window.location,i=o.href,u=o.search,l=Object.fromEntries(new URLSearchParams(u)),f=(l.config,(0,s.Z)(l,Kt)),d=i.split("?")[0],p=new URLSearchParams(Object.entries((0,a.Z)((0,a.Z)({},f),{},{config:t})));return(0,ln.jsx)("li",{children:(0,ln.jsx)("a",{href:"".concat(d,"?").concat(p),children:r})},r)}))})]}):(0,ln.jsxs)(ln.Fragment,{children:[(0,ln.jsx)("div",{children:"Sample JBrowse config:"}),(0,ln.jsx)("ul",{children:(0,ln.jsx)("li",{children:(0,ln.jsx)("a",{href:"?config=test_data/volvox/config.json",children:"Volvox sample data"})})})]})]})}function tr(e){var n=e.initialTimestamp,t=void 0===n?Date.now():n,r=function(e){return null===e?void 0:e},o=D.StringParam,i=(0,D.useQueryParam)("config",o),a=(0,c.Z)(i,1)[0],s=(0,D.useQueryParam)("session",o),l=(0,c.Z)(s,1)[0],f=(0,D.useQueryParam)("adminKey",o),d=(0,c.Z)(f,1)[0],p=(0,D.useQueryParam)("password",o),h=(0,c.Z)(p,2),v=h[0],g=h[1],m=(0,D.useQueryParam)("loc",o),y=(0,c.Z)(m,2),b=y[0],w=y[1],x=(0,D.useQueryParam)("sessionTracks",o),k=(0,c.Z)(x,2),Z=k[0],S=k[1],C=(0,D.useQueryParam)("assembly",o),T=(0,c.Z)(C,2),A=T[0],j=T[1],E=(0,D.useQueryParam)("tracks",o),P=(0,c.Z)(E,2),M=P[0],I=P[1],R=Qt.create({configPath:r(a),sessionQuery:r(l),password:r(v),adminKey:r(d),loc:r(b),assembly:r(A),tracks:r(M),sessionTracks:r(Z)});return(0,u.useEffect)((function(){w(void 0),I(void 0),j(void 0),g(void 0),S(void 0)}),[j,w,I,g,S]),(0,ln.jsx)(ar,{loader:R,initialTimestamp:t,initialSessionQuery:l})}var rr=function(e){var n=e.loader,t=e.handleClose;return(0,ln.jsx)(u.Suspense,{fallback:(0,ln.jsx)("div",{}),children:(0,ln.jsx)(Yt,{onConfirm:(0,i.Z)((0,o.Z)().mark((function e(){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=JSON.parse(JSON.stringify(n.sessionTriaged.snap)),e.next=3,n.setSessionSnapshot((0,a.Z)((0,a.Z)({},r),{},{id:U()()}),!0);case 3:t();case 4:case"end":return e.stop()}}),e)}))),onCancel:function(){n.setBlankSession(!0),t()},reason:n.sessionTriaged.reason})})},or=function(e){var n=e.error;return(0,ln.jsxs)(ln.Fragment,{children:[(0,ln.jsx)(nr,{}),"".concat(n).match(/HTTP 404 fetching config.json/)?(0,ln.jsxs)("div",{style:{margin:8,padding:8,border:"1px solid black",background:"#9f9"},children:["No config.json found. If you want to learn how to complete your setup, visit our"," ",(0,ln.jsx)("a",{href:"https://jbrowse.org/jb2/docs/quickstart_web/",children:"quick start guide"}),"."]}):(0,ln.jsx)(u.Suspense,{fallback:(0,ln.jsx)(O.LoadingEllipses,{}),children:(0,ln.jsx)(Xt,{error:n})})]})};function ir(e){var n=e.loader,t=e.handleClose;return(0,ln.jsx)(u.Suspense,{fallback:(0,ln.jsx)("div",{}),children:(0,ln.jsx)($t,{onConfirm:(0,i.Z)((0,o.Z)().mark((function e(){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=JSON.parse(JSON.stringify(n.sessionTriaged.snap)),e.next=3,n.fetchPlugins(r);case 3:n.setConfigSnapshot((0,a.Z)((0,a.Z)({},r),{},{id:U()()})),t();case 5:case"end":return e.stop()}}),e)}))),onCancel:(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Nt();case 2:t();case 3:case"end":return e.stop()}}),e)}))),reason:n.sessionTriaged.reason})})}var ar=(0,I.observer)((function(e){var n=e.loader,t=e.initialTimestamp,s=e.initialSessionQuery,l=n.sessionError,f=n.configError,d=n.ready,p=n.shareWarningOpen,h=(0,u.useState)(),v=(0,c.Z)(h,2),g=v[0],m=v[1],y=(0,u.useState)(),b=(0,c.Z)(y,2),w=b[0],x=b[1];(0,u.useEffect)((function(){try{var e=n.runtimePlugins,c=n.sessionPlugins,u=n.adminKey,f=n.configSnapshot,h=n.sessionSnapshot,v=n.configPath,g=n.sessionSpec;if(d){var y=new M([].concat((0,r.Z)(je.map((function(e){return{plugin:new e,metadata:{isCore:!0}}}))),(0,r.Z)(e.map((function(e){var n=e.plugin,t=e.definition;return{plugin:new n,definition:t,metadata:{url:t.url}}}))),(0,r.Z)(c.map((function(e){var n=e.plugin,t=e.definition;return{plugin:new n,definition:t,metadata:{url:t.url}}})))));y.createPluggableElements();var b=It(y,!!u);if(f){var w,k,Z=b.create({jbrowse:f,version:Rt,configPath:v},{pluginManager:y});if(null===f||void 0===f||null===(w=f.configuration)||void 0===w||null===(k=w.rpc)||void 0===k||!k.defaultDriver)Z.jbrowse.configuration.rpc.defaultDriver.set("WebWorkerRpcDriver");var S=function(){};try{var C,T;l?(Z.setDefaultSession(),Z.session.notify("Error loading session: ".concat(l,'. If you\n                received this URL from another user, request that they send you\n                a session generated with the "Share" button instead of copying\n                and pasting their URL'))):h&&!p?Z.setSession(h):g?S=function(e,n){var t=e.views,r=e.sessionTracks,s=void 0===r?[]:r;return(0,i.Z)((0,o.Z)().mark((function e(){var r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.rootModel){e.next=3;break}throw new Error("rootModel not initialized");case 3:return e.prev=3,r.setSession({name:"New session ".concat((new Date).toLocaleString())}),s.forEach((function(e){return r.session.addTrackConf(e)})),e.next=8,Promise.all(t.map((function(e){return n.evaluateAsyncExtensionPoint("LaunchView-"+e.type,(0,a.Z)((0,a.Z)({},e),{},{session:r.session}))})));case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),console.error(e.t0),null===(i=r.session)||void 0===i||i.notify("".concat(e.t0));case 14:case"end":return e.stop()}}),e,null,[[3,10]])})))}(g,y):null!==(C=Z.jbrowse.defaultSession)&&void 0!==C&&null!==(T=C.views)&&void 0!==T&&T.length&&Z.setDefaultSession()}catch(E){var A;Z.setDefaultSession();var j="".concat(E).replace("[mobx-state-tree] ","").replace(/\(.+/,"");null===(A=Z.session)||void 0===A||A.notify("Session could not be loaded. ".concat(j.length>1e3?"".concat(j.slice(0,1e3),"...see more in console"):j)),console.error(E)}B(Z,t,s),y.setRootModel(Z),y.configure(),m(y),S()}}}catch(E){x(E),console.error(E)}}),[n,p,d,l,t,s]);var k,Z=f||w;return Z?(0,ln.jsx)(or,{error:Z}):n.sessionTriaged?"session"===n.sessionTriaged.origin?(0,ln.jsx)(rr,{loader:n,handleClose:function(){return n.setSessionTriaged(void 0)}}):(0,ln.jsx)(ir,{loader:n,handleClose:function(){return n.setSessionTriaged(void 0)}}):g?null!==(k=g.rootModel)&&void 0!==k&&k.session?(0,ln.jsx)(yn,{pluginManager:g}):(0,ln.jsx)(u.Suspense,{fallback:(0,ln.jsx)(O.LoadingEllipses,{}),children:(0,ln.jsx)(er,{rootModel:g.rootModel,onFactoryReset:Nt})}):(0,ln.jsx)(V.Z,{})})),sr=function(e){return(0,ln.jsx)(O.FatalErrorDialog,(0,a.Z)({resetButtonText:"Reset Session",onFactoryReset:Nt},e))},cr=function(e){var n=e.initialTimestamp;return(0,ln.jsx)(N.ErrorBoundary,{FallbackComponent:sr,children:(0,ln.jsx)(D.QueryParamProvider,{adapter:L.V,children:(0,ln.jsx)(tr,{initialTimestamp:n})})})}}}]);
//# sourceMappingURL=6936.748e9078.chunk.js.map