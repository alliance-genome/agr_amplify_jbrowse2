"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[7704],{7704:function(e,t,n){n.d(t,{pC:function(){return F}});var r=n(32723),a=n(34795),i=n(9249),o=n(87371),s=n(64926),u=n.n(s),c=n(97779),f=n.n(c),h=n(18973),l=n(16959),d=n(45754),p=n(13820);function v(e){if(e.greaterThan(Number.MAX_SAFE_INTEGER)||e.lessThan(Number.MIN_SAFE_INTEGER))throw new Error("integer overflow");return e.toNumber()}var m=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n)}((0,n(30364).Z)(Error));function b(e){if(e&&e.aborted){if("undefined"!==typeof DOMException)throw new DOMException("aborted","AbortError");var t=new m("aborted");throw t.code="ERR_ABORTED",t}}function x(e,t){var n=[],r=null;return 0===e.length?e:(e.sort((function(e,t){var n=e.minv.blockPosition-t.minv.blockPosition;return 0!==n?n:e.minv.dataPosition-t.minv.dataPosition})),e.forEach((function(e){var a,i;(!t||e.maxv.compareTo(t)>0)&&(null===r?(n.push(e),r=e):(a=r,(i=e).minv.blockPosition-a.maxv.blockPosition<65e3&&i.maxv.blockPosition-a.minv.blockPosition<5e6?e.maxv.compareTo(r.maxv)>0&&(r.maxv=e.maxv):(n.push(e),r=e)))})),n)}var k=n(96234),w=n(41361),g=n(62094),y=n.n(g),Z=function(){function e(t,n){(0,i.Z)(this,e),this.blockPosition=t,this.dataPosition=n}return(0,o.Z)(e,[{key:"toString",value:function(){return"".concat(this.blockPosition,":").concat(this.dataPosition)}},{key:"compareTo",value:function(e){return this.blockPosition-e.blockPosition||this.dataPosition-e.dataPosition}}],[{key:"min",value:function(){for(var e,t=0,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];for(;!e;t+=1)e=r[t];for(;t<r.length;t+=1)e.compareTo(r[t])>0&&(e=r[t]);return e}}]),e}();function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(n)throw new Error("big-endian virtual file offsets not implemented");return new Z(1099511627776*e[t+7]+4294967296*e[t+6]+16777216*e[t+5]+65536*e[t+4]+256*e[t+3]+e[t+2],e[t+1]<<8|e[t])}var E=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;(0,i.Z)(this,e),this.minv=t,this.maxv=n,this.bin=r,this._fetchedSize=a}return(0,o.Z)(e,[{key:"toUniqueString",value:function(){return"".concat(this.minv,"..").concat(this.maxv," (bin ").concat(this.bin,", fetchedSize ").concat(this.fetchedSize(),")")}},{key:"toString",value:function(){return this.toUniqueString()}},{key:"compareTo",value:function(e){return this.minv.compareTo(e.minv)||this.maxv.compareTo(e.maxv)||this.bin-e.bin}},{key:"fetchedSize",value:function(){return void 0!==this._fetchedSize?this._fetchedSize:this.maxv.blockPosition+65536-this.minv.blockPosition}}]),e}(),S=n(59740),T=["indices"],L=function(){function e(t){var n=t.filehandle,r=t.renameRefSeqs,a=void 0===r?function(e){return e}:r;(0,i.Z)(this,e),this.filehandle=n,this.renameRefSeq=a}return(0,o.Z)(e,[{key:"getMetadata",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t,n,a,i=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},e.next=3,this.parse(t);case 3:return n=e.sent,n.indices,a=(0,S.Z)(n,T),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_findFirstData",value:function(e,t){return e?e.compareTo(t)>0?t:e:t}},{key:"parse",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t,n=this,a=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},this._parseCache||(this._parseCache=new(u())({cache:new(f())({maxSize:1}),fill:function(){return n._parse(t)}})),e.abrupt("return",this._parseCache.get("index",null,void 0));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"hasRefSeq",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},e.next=3,this.parse(n);case 3:if(e.t1=t,e.t0=e.sent.indices[e.t1],e.t0){e.next=7;break}e.t0={};case 7:return e.abrupt("return",!!e.t0.binIndex);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),C=21578324;function N(e,t){return[[0,0],[1+((e+=1)>>26),1+((t-=1)>>26)],[9+(e>>23),9+(t>>23)],[73+(e>>20),73+(t>>20)],[585+(e>>17),585+(t>>17)],[4681+(e>>14),4681+(t>>14)]]}var P=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"lineCount",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,i,o,s=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},e.next=3,this.parse(n);case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return",-1);case 6:if(i=a.refNameToId[t],a.indices[i]){e.next=10;break}return e.abrupt("return",-1);case 10:if(!(o=a.indices[i].stats)){e.next=13;break}return e.abrupt("return",o.lineCount);case 13:return e.abrupt("return",-1);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_parse",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t,n,a,i,o,s,u,c,f,h,d,p,v,m,x,k,w,g,y,Z,S=this,T=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=T.length>0&&void 0!==T[0]?T[0]:{},e.t0=l.unzip,e.next=4,this.filehandle.readFile(t);case 4:return e.t1=e.sent,e.next=7,(0,e.t0)(e.t1);case 7:if(n=e.sent,b(t.signal),n.readUInt32LE(0)===C){e.next=11;break}throw new Error("Not a TBI file");case 11:if(a=n.readInt32LE(4),i=n.readInt32LE(8),o=65536&i?"zero-based-half-open":"1-based-closed",s={0:"generic",1:"SAM",2:"VCF"}[15&i]){e.next=18;break}throw new Error("invalid Tabix preset format flags ".concat(i));case 18:return u={ref:n.readInt32LE(12),start:n.readInt32LE(16),end:n.readInt32LE(20)},c=n.readInt32LE(24),h=((1<<3*((f=5)+1))-1)/7,d=Math.pow(2,14+3*f),p=c?String.fromCharCode(c):null,v=n.readInt32LE(28),m=n.readInt32LE(32),x=this._parseNameBytes(n.slice(36,36+m)),k=x.refNameToId,w=x.refIdToName,g=36+m,Z=new Array(a).fill(0).map((function(){var e=n.readInt32LE(g);g+=4;for(var t,r={},a=0;a<e;a+=1){var i=n.readUInt32LE(g);if(g+=4,i>h+1)throw new Error("tabix index contains too many bins, please use a CSI index");if(i===h+1){var o=n.readInt32LE(g);g+=4,2===o&&(t=S.parsePseudoBin(n,g)),g+=16*o}else{var s=n.readInt32LE(g);g+=4;for(var u=new Array(s),c=0;c<s;c+=1){var f=I(n,g),l=I(n,g+8);g+=16,y=S._findFirstData(y,f),u[c]=new E(f,l,i)}r[i]=u}}var d=n.readInt32LE(g);g+=4;for(var p=new Array(d),v=0;v<d;v+=1)p[v]=I(n,g),g+=8,y=S._findFirstData(y,p[v]);return{binIndex:r,linearIndex:p,stats:t}})),e.abrupt("return",{indices:Z,metaChar:p,maxBinNumber:h,maxRefLength:d,skipLines:v,firstDataLine:y,columnNumbers:u,coordinateType:o,format:s,refIdToName:w,refNameToId:k,maxBlockSize:65536});case 30:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"parsePseudoBin",value:function(e,t){return{lineCount:v(y().fromBytesLE(e.slice(t+16,t+24),!0))}}},{key:"_parseNameBytes",value:function(e){for(var t=0,n=0,r=[],a={},i=0;i<e.length;i+=1)if(!e[i]){if(n<i){var o=e.toString("utf8",n,i);o=this.renameRefSeq(o),r[t]=o,a[o]=t}n=i+1,t+=1}return{refNameToId:a,refIdToName:r}}},{key:"blocksForRange",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n,a){var i,o,s,u,c,f,h,l,d,p,v,m,b,g,y,I,S,T,L,C,P=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=P.length>3&&void 0!==P[3]?P[3]:{},n<0&&(n=0),e.next=4,this.parse(i);case 4:if(o=e.sent){e.next=7;break}return e.abrupt("return",[]);case 7:if(s=o.refNameToId[t],u=o.indices[s]){e.next=11;break}return e.abrupt("return",[]);case 11:(u.linearIndex.length?u.linearIndex[n>>14>=u.linearIndex.length?u.linearIndex.length-1:n>>14]:new Z(0,0))||console.warn("querying outside of possible tabix range"),c=N(n,a),f=[],h=(0,w.Z)(c);try{for(h.s();!(l=h.n()).done;)for(d=(0,k.Z)(l.value,2),p=d[0],v=d[1],m=p;m<=v;m++)if(u.binIndex[m])for(b=u.binIndex[m],g=0;g<b.length;++g)f.push(new E(b[g].minv,b[g].maxv,m))}catch(r){h.e(r)}finally{h.f()}for(y=u.linearIndex.length,I=null,S=Math.min(n>>14,y-1),T=Math.min(a>>14,y-1),L=S;L<=T;++L)(C=u.linearIndex[L])&&(!I||C.compareTo(I)<0)&&(I=C);return e.abrupt("return",x(f,I));case 23:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(L),_=n(33028),R=21582659,z=38359875;function B(e,t){return Math.floor(e/Math.pow(2,t))}var M=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).maxBinNumber=0,r.depth=0,r.minShift=0,r}return(0,o.Z)(n,[{key:"lineCount",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,i,o,s=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},e.next=3,this.parse(n);case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return",-1);case 6:if(i=a.refNameToId[t],a.indices[i]){e.next=10;break}return e.abrupt("return",-1);case 10:if(!(o=a.indices[i].stats)){e.next=13;break}return e.abrupt("return",o.lineCount);case 13:return e.abrupt("return",-1);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"indexCov",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("CSI indexes do not support indexcov");case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"parseAuxData",value:function(e,t,n){if(n<30)return{refIdToName:[],refNameToId:{}};var r=e.readInt32LE(t),a=65536&r?"zero-based-half-open":"1-based-closed",i={0:"generic",1:"SAM",2:"VCF"}[15&r];if(!i)throw new Error("invalid Tabix preset format flags ".concat(r));var o={ref:e.readInt32LE(t+4),start:e.readInt32LE(t+8),end:e.readInt32LE(t+12)},s=e.readInt32LE(t+16),u=s?String.fromCharCode(s):"",c=e.readInt32LE(t+20),f=e.readInt32LE(t+24),h=this._parseNameBytes(e.slice(t+28,t+28+f));return{refIdToName:h.refIdToName,refNameToId:h.refNameToId,skipLines:c,metaChar:u,columnNumbers:o,format:i,coordinateType:a}}},{key:"_parseNameBytes",value:function(e){for(var t=0,n=0,r=[],a={},i=0;i<e.length;i+=1)if(!e[i]){if(n<i){var o=e.toString("utf8",n,i);o=this.renameRefSeq(o),r[t]=o,a[o]=t}n=i+1,t+=1}return{refNameToId:a,refIdToName:r}}},{key:"_parse",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t,n,a,i,o,s,u,c,f,h,d=this,p=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:{},e.t0=l.unzip,e.next=4,this.filehandle.readFile(t);case 4:return e.t1=e.sent,e.next=7,(0,e.t0)(e.t1);case 7:if((n=e.sent).readUInt32LE(0)!==R){e.next=12;break}a=1,e.next=17;break;case 12:if(n.readUInt32LE(0)!==z){e.next=16;break}a=2,e.next=17;break;case 16:throw new Error("Not a CSI file");case 17:return this.minShift=n.readInt32LE(4),this.depth=n.readInt32LE(8),this.maxBinNumber=((1<<3*(this.depth+1))-1)/7,i=Math.pow(2,this.minShift+3*this.depth),o=n.readInt32LE(12),s={refIdToName:[],refNameToId:{}},o&&(s=this.parseAuxData(n,16,o)),u=n.readInt32LE(16+o),f=16+o+4,h=new Array(u).fill(0).map((function(){var e=n.readInt32LE(f);f+=4;for(var t,r={},a=0;a<e;a+=1){var i=n.readUInt32LE(f);if(i>d.maxBinNumber)t=d.parsePseudoBin(n,f+4),f+=48;else{var o=I(n,f+4);c=d._findFirstData(c,o);var s=n.readInt32LE(f+12);f+=16;for(var u=new Array(s),h=0;h<s;h+=1){var l=I(n,f),p=I(n,f+8);f+=16,u[h]=new E(l,p,i)}r[i]=u}}return{binIndex:r,stats:t}})),e.abrupt("return",(0,_.Z)((0,_.Z)({},s),{},{csi:!0,refCount:u,maxBlockSize:65536,firstDataLine:c,csiVersion:a,indices:h,depth:this.depth,maxBinNumber:this.maxBinNumber,maxRefLength:i}));case 28:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"parsePseudoBin",value:function(e,t){return{lineCount:v(y().fromBytesLE(Array.prototype.slice.call(e,t+28,t+36),!0))}}},{key:"blocksForRange",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n,a){var i,o,s,u,c,f,h,l,d,p,v,m,b,g,y=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=y.length>3&&void 0!==y[3]?y[3]:{},n<0&&(n=0),e.next=4,this.parse(i);case 4:if(o=e.sent){e.next=7;break}return e.abrupt("return",[]);case 7:if(s=o.refNameToId[t],u=o.indices[s]){e.next=11;break}return e.abrupt("return",[]);case 11:c=this.reg2bins(n,a),f=[],h=(0,w.Z)(c);try{for(h.s();!(l=h.n()).done;)for(d=(0,k.Z)(l.value,2),p=d[0],v=d[1],m=p;m<=v;m++)if(u.binIndex[m])for(b=u.binIndex[m],g=0;g<b.length;++g)f.push(new E(b[g].minv,b[g].maxv,m))}catch(r){h.e(r)}finally{h.f()}return e.abrupt("return",x(f,new Z(0,0)));case 16:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"reg2bins",value:function(e,t){(e-=1)<1&&(e=1),t>Math.pow(2,50)&&(t=Math.pow(2,34)),t-=1;for(var n,r=0,a=0,i=this.minShift+3*this.depth,o=[];r<=this.depth;i-=3,a+=(n=3*r,1*Math.pow(2,n)),r+=1){var s=a+B(e,i),u=a+B(t,i);if(u-s+o.length>this.maxBinNumber)throw new Error("query ".concat(e,"-").concat(t," is too large for current binning scheme (shift ").concat(this.minShift,", depth ").concat(this.depth,"), try a smaller query or a coarser index binning scheme"));o.push([s,u])}return o}}]),n}(L),q=n(97960).lW;function A(e){return new Promise((function(t){setTimeout(t,e)}))}var F=function(){function e(t){var n=t.path,r=t.filehandle,a=t.tbiPath,o=t.tbiFilehandle,s=t.csiPath,c=t.csiFilehandle,l=t.chunkSizeLimit,d=void 0===l?5e7:l,p=t.renameRefSeqs,v=void 0===p?function(e){return e}:p,m=t.chunkCacheSize,b=void 0===m?5*Math.pow(2,20):m;if((0,i.Z)(this,e),r)this.filehandle=r;else{if(!n)throw new TypeError("must provide either filehandle or path");this.filehandle=new h.S9(n)}if(o)this.index=new P({filehandle:o,renameRefSeqs:v});else if(c)this.index=new M({filehandle:c,renameRefSeqs:v});else if(a)this.index=new P({filehandle:new h.S9(a),renameRefSeqs:v});else if(s)this.index=new M({filehandle:new h.S9(s),renameRefSeqs:v});else{if(!n)throw new TypeError("must provide one of tbiFilehandle, tbiPath, csiFilehandle, or csiPath");this.index=new P({filehandle:new h.S9("".concat(n,".tbi")),renameRefSeqs:v})}this.chunkSizeLimit=d,this.renameRefSeq=v,this.chunkCache=new(u())({cache:new(f())({maxSize:Math.floor(b/65536)}),fill:this.readChunk.bind(this)})}return(0,o.Z)(e,[{key:"getLines",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n,a,i){var o,s,u,c,f,h,l,d,p,v,m,x,k,w,g,y,Z,I,E,S,T,L,C;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s={},"undefined"!==typeof i){e.next=3;break}throw new TypeError("line callback must be provided");case 3:if("function"===typeof i?u=i:(s=i,u=i.lineCallback),void 0!==t){e.next=6;break}throw new TypeError("must provide a reference sequence name");case 6:if(u){e.next=8;break}throw new TypeError("line callback must be provided");case 8:return e.next=10,this.index.getMetadata(s);case 10:if(c=e.sent,b(o),n||(n=0),a||(a=c.maxRefLength),n<=a){e.next=16;break}throw new TypeError("invalid start and end coordinates. start must be less than or equal to end");case 16:if(n!==a){e.next=18;break}return e.abrupt("return");case 18:return e.next=20,this.index.blocksForRange(t,n,a,s);case 20:f=e.sent,b(o),h=0;case 23:if(!(h<f.length)){e.next=30;break}if(!((l=f[h].fetchedSize())>this.chunkSizeLimit)){e.next=27;break}throw new Error("Too much data. Chunk size ".concat(l.toLocaleString()," bytes exceeds chunkSizeLimit of ").concat(this.chunkSizeLimit.toLocaleString(),"."));case 27:h+=1,e.next=23;break;case 30:d=Date.now(),p=0;case 32:if(!(p<f.length)){e.next=72;break}return v=void 0,m=f[p],e.next=37,this.chunkCache.get(m.toString(),m,o);case 37:x=e.sent,k=x.buffer,w=x.cpositions,g=x.dpositions,(y=("undefined"!==typeof TextDecoder?new TextDecoder("utf-8").decode(k):k.toString()).split("\n")).pop(),b(o),Z=m.minv.dataPosition,I=void 0,E=0;case 47:if(!(E<y.length)){e.next=69;break}for(S=y[E],I=0;Z>=g[I];I+=1);if(T=this.checkLine(c,t,n,a,S),L=T.startCoordinate,C=T.overlaps,!(void 0!==v&&void 0!==L&&v>L)){e.next=53;break}throw new Error("Lines not sorted by start coordinate (".concat(v," > ").concat(L,"), this file is not usable with Tabix."));case 53:if(v=L,!C){e.next=58;break}u(S.trim(),256*w[I]+(Z-g[I])),e.next=60;break;case 58:if(!(void 0!==L&&L>=a)){e.next=60;break}return e.abrupt("return");case 60:if(Z+=S.length+1,!(d-Date.now()>500)){e.next=66;break}return d=Date.now(),b(o),e.next=66,A(1);case 66:E+=1,e.next=47;break;case 69:p+=1,e.next=32;break;case 72:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"getMetadata",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t,n=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.abrupt("return",this.index.getMetadata(t));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeaderBuffer",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t,n,a,i,o,s,u,c,f,h,d,p=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:{},e.next=3,this.getMetadata(t);case 3:return n=e.sent,a=n.firstDataLine,i=n.metaChar,o=n.maxBlockSize,b(t.signal),s=a&&a.blockPosition?a.blockPosition+o:o,e.next=11,this._readRegion(0,s,t);case 11:return u=e.sent,b(t.signal),e.prev=13,e.next=16,(0,l.unzip)(u);case 16:u=e.sent,e.next=23;break;case 19:throw e.prev=19,e.t0=e.catch(13),console.error(e.t0),new Error("error decompressing block ".concat(e.t0.code," at 0 (length ").concat(s,") ").concat(e.t0));case 23:if(!i){e.next=36;break}c=-1,f="\n".charCodeAt(0),h=i.charCodeAt(0),d=0;case 28:if(!(d<u.length)){e.next=35;break}if(d!==c+1||u[d]===h){e.next=31;break}return e.abrupt("break",35);case 31:u[d]===f&&(c=d);case 32:d+=1,e.next=28;break;case 35:u=u.slice(0,c+1);case 36:return e.abrupt("return",u);case 37:case"end":return e.stop()}}),e,this,[[13,19]])})));return function(){return e.apply(this,arguments)}}()},{key:"getHeader",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t,n,a=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,this.getHeaderBuffer(t);case 3:return n=e.sent,b(t.signal),e.abrupt("return",n.toString("utf8"));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getReferenceSequenceNames",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t,n,a=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,this.getMetadata(t);case 3:return n=e.sent,e.abrupt("return",n.refIdToName);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkLine",value:function(e,t,n,r,a){var i=e.columnNumbers,o=e.metaChar,s=e.coordinateType,u=e.format;if(a.charAt(0)===o)return{overlaps:!1};var c=i.ref,f=i.start,h=i.end;c||(c=0),f||(f=0),h||(h=0),"VCF"===u&&(h=8);for(var l=Math.max(c,f,h),d=1,p=0,v="",m=-1/0,b=0;b<a.length+1;b+=1)if("\t"===a[b]||b===a.length){if(d===c){if(this.renameRefSeq(a.slice(p,b))!==t)return{overlaps:!1}}else if(d===f){if(m=parseInt(a.slice(p,b),10),"1-based-closed"===s&&(m-=1),m>=r)return{startCoordinate:m,overlaps:!1};if((0===h||h===f)&&m+1<=n)return{startCoordinate:m,overlaps:!1}}else if("VCF"===u&&4===d)v=a.slice(p,b);else if(d===h){if(("VCF"===u?this._getVcfEnd(m,v,a.slice(p,b)):parseInt(a.slice(p,b),10))<=n)return{overlaps:!1}}if(p=b+1,(d+=1)>l)break}return{startCoordinate:m,overlaps:!0}}},{key:"_getVcfEnd",value:function(e,t,n){var r=e+t.length,a=-1!==n.indexOf("SVTYPE=TRA");if("."===n[0]||a){if(a)return e+1}else for(var i=";",o=0;o<n.length;o+=1){if(";"===i&&"END="===n.slice(o,o+4)){var s=n.indexOf(";",o);-1===s&&(s=n.length),r=parseInt(n.slice(o+4,s),10);break}i=n[o]}return r}},{key:"lineCount",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},e.abrupt("return",this.index.lineCount(t,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_readRegion",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n){var a,i,o,s,u=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=u.length>2&&void 0!==u[2]?u[2]:{},e.next=3,this.filehandle.read(q.alloc(n),0,n,t,a);case 3:return i=e.sent,o=i.bytesRead,s=i.buffer,e.abrupt("return",o<n?s.slice(0,o):s);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"readChunk",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,i=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},e.next=3,this._readRegion(t.minv.blockPosition,t.fetchedSize(),n);case 3:return a=e.sent,e.prev=4,e.abrupt("return",(0,l.unzipChunkSlice)(a,t));case 8:throw e.prev=8,e.t0=e.catch(4),new Error("error decompressing chunk ".concat(t.toString()," ").concat(e.t0));case 11:case"end":return e.stop()}}),e,this,[[4,8]])})));return function(t){return e.apply(this,arguments)}}()}]),e}()}}]);
//# sourceMappingURL=7704.cc1d7023.chunk.js.map