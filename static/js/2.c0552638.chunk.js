(this["webpackJsonp@jbrowse/web"]=this["webpackJsonp@jbrowse/web"]||[]).push([[2],{1556:function(e,t,r){"use strict";(function(e){var n=r(80),a=r(158).default,i=r(100).default,s=r(102).default,o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=o(r(176)),c=o(r(195)),f=r(164),l=r(152),h=r(637),d=o(r(938)),p=o(r(942));function v(e){return new Promise((function(t){setTimeout(t,e)}))}var b=function(){function t(e){var r=e.path,n=e.filehandle,a=e.tbiPath,s=e.tbiFilehandle,o=e.csiPath,l=e.csiFilehandle,h=e.chunkSizeLimit,v=void 0===h?5e7:h,b=e.renameRefSeqs,m=void 0===b?function(e){return e}:b,x=e.chunkCacheSize,k=void 0===x?5*Math.pow(2,20):x;if(i(this,t),n)this.filehandle=n;else{if(!r)throw new TypeError("must provide either filehandle or path");this.filehandle=new f.LocalFile(r)}if(s)this.index=new d.default({filehandle:s,renameRefSeqs:m});else if(l)this.index=new p.default({filehandle:l,renameRefSeqs:m});else if(a)this.index=new d.default({filehandle:new f.LocalFile(a),renameRefSeqs:m});else if(o)this.index=new p.default({filehandle:new f.LocalFile(o),renameRefSeqs:m});else{if(!r)throw new TypeError("must provide one of tbiFilehandle, tbiPath, csiFilehandle, or csiPath");this.index=new d.default({filehandle:new f.LocalFile("".concat(r,".tbi")),renameRefSeqs:m})}this.chunkSizeLimit=v,this.renameRefSeq=m,this.chunkCache=new u.default({cache:new c.default({maxSize:Math.floor(k/65536)}),fill:this.readChunk.bind(this)})}return s(t,[{key:"getLines",value:function(){var e=a(n.mark((function e(t,r,a,i){var s,o,u,c,f,l,d,p,b,m,x,k,y,w,g,_,S,I,E,T,C,L,P;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o={},"undefined"!==typeof i){e.next=3;break}throw new TypeError("line callback must be provided");case 3:if("function"===typeof i?u=i:(o=i,u=i.lineCallback),void 0!==t){e.next=6;break}throw new TypeError("must provide a reference sequence name");case 6:if(u){e.next=8;break}throw new TypeError("line callback must be provided");case 8:return e.next=10,this.index.getMetadata(o);case 10:if(c=e.sent,(0,h.checkAbortSignal)(s),r||(r=0),a||(a=c.maxRefLength),r<=a){e.next=16;break}throw new TypeError("invalid start and end coordinates. start must be less than or equal to end");case 16:if(r!==a){e.next=18;break}return e.abrupt("return");case 18:return e.next=20,this.index.blocksForRange(t,r,a,o);case 20:f=e.sent,(0,h.checkAbortSignal)(s),l=0;case 23:if(!(l<f.length)){e.next=30;break}if(!((d=f[l].fetchedSize())>this.chunkSizeLimit)){e.next=27;break}throw new Error("Too much data. Chunk size ".concat(d.toLocaleString()," bytes exceeds chunkSizeLimit of ").concat(this.chunkSizeLimit.toLocaleString(),"."));case 27:l+=1,e.next=23;break;case 30:p=Date.now(),b=0;case 32:if(!(b<f.length)){e.next=72;break}return m=void 0,x=f[b],e.next=37,this.chunkCache.get(x.toString(),x,s);case 37:k=e.sent,y=k.buffer,w=k.cpositions,g=k.dpositions,(_=("undefined"!==typeof TextDecoder?new TextDecoder("utf-8").decode(y):y.toString()).split("\n")).pop(),(0,h.checkAbortSignal)(s),S=x.minv.dataPosition,I=void 0,E=0;case 47:if(!(E<_.length)){e.next=69;break}for(T=_[E],I=0;S>=g[I];I+=1);if(C=this.checkLine(c,t,r,a,T),L=C.startCoordinate,P=C.overlaps,!(void 0!==m&&void 0!==L&&m>L)){e.next=53;break}throw new Error("Lines not sorted by start coordinate (".concat(m," > ").concat(L,"), this file is not usable with Tabix."));case 53:if(m=L,!P){e.next=58;break}u(T.trim(),256*w[I]+(S-g[I])),e.next=60;break;case 58:if(!(void 0!==L&&L>=a)){e.next=60;break}return e.abrupt("return");case 60:if(S+=T.length+1,!(p-Date.now()>500)){e.next=66;break}return p=Date.now(),(0,h.checkAbortSignal)(s),e.next=66,v(1);case 66:E+=1,e.next=47;break;case 69:b+=1,e.next=32;break;case 72:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"getMetadata",value:function(){var e=a(n.mark((function e(){var t,r=arguments;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:{},e.abrupt("return",this.index.getMetadata(t));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeaderBuffer",value:function(){var e=a(n.mark((function e(){var t,r,a,i,s,o,u,c,f,d,p,v=arguments;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=v.length>0&&void 0!==v[0]?v[0]:{},e.next=3,this.getMetadata(t);case 3:return r=e.sent,a=r.firstDataLine,i=r.metaChar,s=r.maxBlockSize,(0,h.checkAbortSignal)(t.signal),o=a&&a.blockPosition?a.blockPosition+s:s,e.next=11,this._readRegion(0,o,t);case 11:return u=e.sent,(0,h.checkAbortSignal)(t.signal),e.prev=13,e.next=16,(0,l.unzip)(u);case 16:u=e.sent,e.next=23;break;case 19:throw e.prev=19,e.t0=e.catch(13),console.error(e.t0),new Error("error decompressing block ".concat(e.t0.code," at 0 (length ").concat(o,") ").concat(e.t0));case 23:if(!i){e.next=36;break}c=-1,f="\n".charCodeAt(0),d=i.charCodeAt(0),p=0;case 28:if(!(p<u.length)){e.next=35;break}if(p!==c+1||u[p]===d){e.next=31;break}return e.abrupt("break",35);case 31:u[p]===f&&(c=p);case 32:p+=1,e.next=28;break;case 35:u=u.slice(0,c+1);case 36:return e.abrupt("return",u);case 37:case"end":return e.stop()}}),e,this,[[13,19]])})));return function(){return e.apply(this,arguments)}}()},{key:"getHeader",value:function(){var e=a(n.mark((function e(){var t,r,a=arguments;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,this.getHeaderBuffer(t);case 3:return r=e.sent,(0,h.checkAbortSignal)(t.signal),e.abrupt("return",r.toString("utf8"));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getReferenceSequenceNames",value:function(){var e=a(n.mark((function e(){var t,r,a=arguments;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,this.getMetadata(t);case 3:return r=e.sent,e.abrupt("return",r.refIdToName);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkLine",value:function(e,t,r,n,a){var i=e.columnNumbers,s=e.metaChar,o=e.coordinateType,u=e.format;if(a.charAt(0)===s)return{overlaps:!1};var c=i.ref,f=i.start,l=i.end;c||(c=0),f||(f=0),l||(l=0),"VCF"===u&&(l=8);for(var h=Math.max(c,f,l),d=1,p=0,v="",b=-1/0,m=0;m<a.length+1;m+=1)if("\t"===a[m]||m===a.length){if(d===c){if(this.renameRefSeq(a.slice(p,m))!==t)return{overlaps:!1}}else if(d===f){if(b=parseInt(a.slice(p,m),10),"1-based-closed"===o&&(b-=1),b>=n)return{startCoordinate:b,overlaps:!1};if((0===l||l===f)&&b+1<=r)return{startCoordinate:b,overlaps:!1}}else if("VCF"===u&&4===d)v=a.slice(p,m);else if(d===l){if(("VCF"===u?this._getVcfEnd(b,v,a.slice(p,m)):parseInt(a.slice(p,m),10))<=r)return{overlaps:!1}}if(p=m+1,(d+=1)>h)break}return{startCoordinate:b,overlaps:!0}}},{key:"_getVcfEnd",value:function(e,t,r){var n=e+t.length,a=-1!==r.indexOf("SVTYPE=TRA");if("."===r[0]||a){if(a)return e+1}else for(var i=";",s=0;s<r.length;s+=1){if(";"===i&&"END="===r.slice(s,s+4)){var o=r.indexOf(";",s);-1===o&&(o=r.length),n=parseInt(r.slice(s+4,o),10);break}i=r[s]}return n}},{key:"lineCount",value:function(){var e=a(n.mark((function e(t){var r,a=arguments;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:{},e.abrupt("return",this.index.lineCount(t,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_readRegion",value:function(){var t=a(n.mark((function t(r,a){var i,s,o,u,c=arguments;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=c.length>2&&void 0!==c[2]?c[2]:{},t.next=3,this.filehandle.read(e.alloc(a),0,a,r,i);case 3:return s=t.sent,o=s.bytesRead,u=s.buffer,t.abrupt("return",o<a?u.slice(0,o):u);case 7:case"end":return t.stop()}}),t,this)})));return function(e,r){return t.apply(this,arguments)}}()},{key:"readChunk",value:function(){var e=a(n.mark((function e(t){var r,a,i=arguments;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},e.next=3,this._readRegion(t.minv.blockPosition,t.fetchedSize(),r);case 3:return a=e.sent,e.prev=4,e.abrupt("return",(0,l.unzipChunkSlice)(a,t));case 8:throw e.prev=8,e.t0=e.catch(4),new Error("error decompressing chunk ".concat(t.toString()," ").concat(e.t0));case 11:case"end":return e.stop()}}),e,this,[[4,8]])})));return function(t){return e.apply(this,arguments)}}()}]),t}();t.default=b}).call(this,r(99).Buffer)},195:function(e,t,r){"use strict";var n=r(80),a=r(146).default,i=r(208).default,s=r(100).default,o=r(102).default,u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(s(this,t),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}return o(t,[{key:"_set",value:function(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}},{key:"get",value:function(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){var t=this.oldCache.get(e);return this.oldCache.delete(e),this._set(e,t),t}}},{key:"set",value:function(e,t){return this.cache.has(e)?this.cache.set(e,t):this._set(e,t),this}},{key:"has",value:function(e){return this.cache.has(e)||this.oldCache.has(e)}},{key:"peek",value:function(e){return this.cache.has(e)?this.cache.get(e):this.oldCache.has(e)?this.oldCache.get(e):void 0}},{key:"delete",value:function(e){var t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}},{key:"clear",value:function(){this.cache.clear(),this.oldCache.clear(),this._size=0}},{key:"keys",value:n.mark((function e(){var t,r,s,o;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i(this),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return s=a(r.value,1),o=s[0],e.next=7,o;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"values",value:n.mark((function e(){var t,r,s,o;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i(this),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return s=a(r.value,2),o=s[1],e.next=7,o;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:e,value:n.mark((function e(){var t,r,s,o,u,c,f,l;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i(this.cache),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return s=r.value,e.next=7,s;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:o=i(this.oldCache),e.prev=18,o.s();case 20:if((u=o.n()).done){e.next=28;break}if(c=u.value,f=a(c,1),l=f[0],this.cache.has(l)){e.next=26;break}return e.next=26,c;case 26:e.next=20;break;case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(18),o.e(e.t1);case 33:return e.prev=33,o.f(),e.finish(33);case 36:case"end":return e.stop()}}),e,this,[[1,11,14,17],[18,30,33,36]])}))},{key:"size",get:function(){var e,t=0,r=i(this.oldCache.keys());try{for(r.s();!(e=r.n()).done;){var n=e.value;this.cache.has(n)||t++}}catch(a){r.e(a)}finally{r.f()}return this._size+t}}]),t}(Symbol.iterator);e.exports=u},295:function(e,t){e.exports=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a},e.exports.__esModule=!0,e.exports.default=e.exports},636:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CSI=t.TBI=t.TabixIndexedFile=void 0;var a=n(r(1556));t.TabixIndexedFile=a.default;var i=n(r(938));t.TBI=i.default;var s=n(r(942));t.CSI=s.default},637:function(e,t,r){"use strict";var n=r(80),a=r(158).default,i=r(102).default,s=r(100).default,o=r(153).default,u=r(185).default,c=r(352).default;Object.defineProperty(t,"__esModule",{value:!0}),t.optimizeChunks=t.canMergeBlocks=t.abortBreakPoint=t.checkAbortSignal=t.longToNumber=void 0,t.longToNumber=function(e){if(e.greaterThan(Number.MAX_SAFE_INTEGER)||e.lessThan(Number.MIN_SAFE_INTEGER))throw new Error("integer overflow");return e.toNumber()};var f=function(e){o(r,e);var t=u(r);function r(){return s(this,r),t.apply(this,arguments)}return i(r)}(c(Error));function l(e){if(e&&e.aborted){if("undefined"!==typeof DOMException)throw new DOMException("aborted","AbortError");var t=new f("aborted");throw t.code="ERR_ABORTED",t}}function h(){return(h=a(n.mark((function e(t){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve();case 2:l(t);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e,t){return t.minv.blockPosition-e.maxv.blockPosition<65e3&&t.maxv.blockPosition-e.minv.blockPosition<5e6}t.checkAbortSignal=l,t.abortBreakPoint=function(e){return h.apply(this,arguments)},t.canMergeBlocks=d,t.optimizeChunks=function(e,t){var r=[],n=null;return 0===e.length?e:(e.sort((function(e,t){var r=e.minv.blockPosition-t.minv.blockPosition;return 0!==r?r:e.minv.dataPosition-t.minv.dataPosition})),e.forEach((function(e){(!t||e.maxv.compareTo(t)>0)&&(null===n?(r.push(e),n=e):d(n,e)?e.maxv.compareTo(n.maxv)>0&&(n.maxv=e.maxv):(r.push(e),n=e))})),r)}},638:function(e,t,r){var n=r(295);e.exports=function(e,t){if(null==e)return{};var r,a,i=n(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i},e.exports.__esModule=!0,e.exports.default=e.exports},938:function(e,t,r){"use strict";var n=r(146).default,a=r(208).default,i=r(80),s=r(158).default,o=r(100).default,u=r(102).default,c=r(153).default,f=r(185).default,l=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),h=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),d=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&l(t,e,r);return h(t,e),t},p=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var v=p(r(211)),b=d(r(939)),m=p(r(940)),x=r(152),k=r(637),y=p(r(941)),w=21578324;function g(e,t){return[[0,0],[1+((e+=1)>>26),1+((t-=1)>>26)],[9+(e>>23),9+(t>>23)],[73+(e>>20),73+(t>>20)],[585+(e>>17),585+(t>>17)],[4681+(e>>14),4681+(t>>14)]]}var _=function(e){c(r,e);var t=f(r);function r(){return o(this,r),t.apply(this,arguments)}return u(r,[{key:"lineCount",value:function(){var e=s(i.mark((function e(t){var r,n,a,s,o=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:{},e.next=3,this.parse(r);case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return",-1);case 6:if(a=n.refNameToId[t],n.indices[a]){e.next=10;break}return e.abrupt("return",-1);case 10:if(!(s=n.indices[a].stats)){e.next=13;break}return e.abrupt("return",s.lineCount);case 13:return e.abrupt("return",-1);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_parse",value:function(){var e=s(i.mark((function e(){var t,r,n,a,s,o,u,c,f,l,h,d,p,v,y,g,_,S,I,E,T=this,C=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=C.length>0&&void 0!==C[0]?C[0]:{},e.t0=x.unzip,e.next=4,this.filehandle.readFile(t);case 4:return e.t1=e.sent,e.next=7,(0,e.t0)(e.t1);case 7:if(r=e.sent,(0,k.checkAbortSignal)(t.signal),r.readUInt32LE(0)===w){e.next=11;break}throw new Error("Not a TBI file");case 11:if(n=r.readInt32LE(4),a=r.readInt32LE(8),s=65536&a?"zero-based-half-open":"1-based-closed",o={0:"generic",1:"SAM",2:"VCF"}[15&a]){e.next=18;break}throw new Error("invalid Tabix preset format flags ".concat(a));case 18:return u={ref:r.readInt32LE(12),start:r.readInt32LE(16),end:r.readInt32LE(20)},c=r.readInt32LE(24),l=((1<<3*((f=5)+1))-1)/7,h=Math.pow(2,14+3*f),d=c?String.fromCharCode(c):null,p=r.readInt32LE(28),v=r.readInt32LE(32),y=this._parseNameBytes(r.slice(36,36+v)),g=y.refNameToId,_=y.refIdToName,S=36+v,E=new Array(n).fill(0).map((function(){var e=r.readInt32LE(S);S+=4;for(var t,n={},a=0;a<e;a+=1){var i=r.readUInt32LE(S);if(S+=4,i>l+1)throw new Error("tabix index contains too many bins, please use a CSI index");if(i===l+1){var s=r.readInt32LE(S);S+=4,2===s&&(t=T.parsePseudoBin(r,S)),S+=16*s}else{var o=r.readInt32LE(S);S+=4;for(var u=new Array(o),c=0;c<o;c+=1){var f=(0,b.fromBytes)(r,S),h=(0,b.fromBytes)(r,S+8);S+=16,I=T._findFirstData(I,f),u[c]=new m.default(f,h,i)}n[i]=u}}var d=r.readInt32LE(S);S+=4;for(var p=new Array(d),v=0;v<d;v+=1)p[v]=(0,b.fromBytes)(r,S),S+=8,I=T._findFirstData(I,p[v]);return{binIndex:n,linearIndex:p,stats:t}})),e.abrupt("return",{indices:E,metaChar:d,maxBinNumber:l,maxRefLength:h,skipLines:p,firstDataLine:I,columnNumbers:u,coordinateType:s,format:o,refIdToName:_,refNameToId:g,maxBlockSize:65536});case 30:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"parsePseudoBin",value:function(e,t){return{lineCount:(0,k.longToNumber)(v.default.fromBytesLE(e.slice(t+16,t+24),!0))}}},{key:"_parseNameBytes",value:function(e){for(var t=0,r=0,n=[],a={},i=0;i<e.length;i+=1)if(!e[i]){if(r<i){var s=e.toString("utf8",r,i);s=this.renameRefSeq(s),n[t]=s,a[s]=t}r=i+1,t+=1}return{refNameToId:a,refIdToName:n}}},{key:"blocksForRange",value:function(){var e=s(i.mark((function e(t,r,s){var o,u,c,f,l,h,d,p,v,x,y,w,_,S,I,E,T,C,L,P,N=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=N.length>3&&void 0!==N[3]?N[3]:{},r<0&&(r=0),e.next=4,this.parse(o);case 4:if(u=e.sent){e.next=7;break}return e.abrupt("return",[]);case 7:if(c=u.refNameToId[t],f=u.indices[c]){e.next=11;break}return e.abrupt("return",[]);case 11:(f.linearIndex.length?f.linearIndex[r>>14>=f.linearIndex.length?f.linearIndex.length-1:r>>14]:new b.default(0,0))||console.warn("querying outside of possible tabix range"),l=g(r,s),h=[],d=a(l);try{for(d.s();!(p=d.n()).done;)for(v=n(p.value,2),x=v[0],y=v[1],w=x;w<=y;w++)if(f.binIndex[w])for(_=f.binIndex[w],S=0;S<_.length;++S)h.push(new m.default(_[S].minv,_[S].maxv,w))}catch(i){d.e(i)}finally{d.f()}for(I=f.linearIndex.length,E=null,T=Math.min(r>>14,I-1),C=Math.min(s>>14,I-1),L=T;L<=C;++L)(P=f.linearIndex[L])&&(!E||P.compareTo(E)<0)&&(E=P);return e.abrupt("return",(0,k.optimizeChunks)(h,E));case 23:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),r}(y.default);t.default=_},939:function(e,t,r){"use strict";var n=r(100).default,a=r(102).default;Object.defineProperty(t,"__esModule",{value:!0}),t.fromBytes=void 0;var i=function(){function e(t,r){n(this,e),this.blockPosition=t,this.dataPosition=r}return a(e,[{key:"toString",value:function(){return"".concat(this.blockPosition,":").concat(this.dataPosition)}},{key:"compareTo",value:function(e){return this.blockPosition-e.blockPosition||this.dataPosition-e.dataPosition}}],[{key:"min",value:function(){for(var e,t=0,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];for(;!e;t+=1)e=n[t];for(;t<n.length;t+=1)e.compareTo(n[t])>0&&(e=n[t]);return e}}]),e}();t.default=i,t.fromBytes=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(r)throw new Error("big-endian virtual file offsets not implemented");return new i(1099511627776*e[t+7]+4294967296*e[t+6]+16777216*e[t+5]+65536*e[t+4]+256*e[t+3]+e[t+2],e[t+1]<<8|e[t])}},940:function(e,t,r){"use strict";var n=r(100).default,a=r(102).default;Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(t,r,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;n(this,e),this.minv=t,this.maxv=r,this.bin=a,this._fetchedSize=i}return a(e,[{key:"toUniqueString",value:function(){return"".concat(this.minv,"..").concat(this.maxv," (bin ").concat(this.bin,", fetchedSize ").concat(this.fetchedSize(),")")}},{key:"toString",value:function(){return this.toUniqueString()}},{key:"compareTo",value:function(e){return this.minv.compareTo(e.minv)||this.maxv.compareTo(e.maxv)||this.bin-e.bin}},{key:"fetchedSize",value:function(){return void 0!==this._fetchedSize?this._fetchedSize:this.maxv.blockPosition+65536-this.minv.blockPosition}}]),e}();t.default=i},941:function(e,t,r){"use strict";var n=r(80),a=r(638).default,i=r(158).default,s=r(100).default,o=r(102).default,u=["indices"],c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=c(r(176)),l=c(r(195)),h=function(){function e(t){var r=t.filehandle,n=t.renameRefSeqs,a=void 0===n?function(e){return e}:n;s(this,e),this.filehandle=r,this.renameRefSeq=a}return o(e,[{key:"getMetadata",value:function(){var e=i(n.mark((function e(){var t,r,i,s=arguments;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},e.next=3,this.parse(t);case 3:return r=e.sent,r.indices,i=a(r,u),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_findFirstData",value:function(e,t){return e?e.compareTo(t)>0?t:e:t}},{key:"parse",value:function(){var e=i(n.mark((function e(){var t,r=this,a=arguments;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},this._parseCache||(this._parseCache=new f.default({cache:new l.default({maxSize:1}),fill:function(){return r._parse(t)}})),e.abrupt("return",this._parseCache.get("index",null,void 0));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"hasRefSeq",value:function(){var e=i(n.mark((function e(t){var r,a=arguments;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:{},e.next=3,this.parse(r);case 3:if(e.t1=t,e.t0=e.sent.indices[e.t1],e.t0){e.next=7;break}e.t0={};case 7:return e.abrupt("return",!!e.t0.binIndex);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();t.default=h},942:function(e,t,r){"use strict";var n=r(146).default,a=r(208).default,i=r(350).default,s=r(80),o=r(158).default,u=r(100).default,c=r(102).default,f=r(153).default,l=r(185).default,h=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),d=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),p=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&h(t,e,r);return d(t,e),t},v=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var b=v(r(211)),m=r(152),x=p(r(939)),k=v(r(940)),y=r(637),w=v(r(941)),g=21582659,_=38359875;function S(e,t){return Math.floor(e/Math.pow(2,t))}var I=function(e){f(r,e);var t=l(r);function r(e){var n;return u(this,r),(n=t.call(this,e)).maxBinNumber=0,n.depth=0,n.minShift=0,n}return c(r,[{key:"lineCount",value:function(){var e=o(s.mark((function e(t){var r,n,a,i,o=arguments;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:{},e.next=3,this.parse(r);case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return",-1);case 6:if(a=n.refNameToId[t],n.indices[a]){e.next=10;break}return e.abrupt("return",-1);case 10:if(!(i=n.indices[a].stats)){e.next=13;break}return e.abrupt("return",i.lineCount);case 13:return e.abrupt("return",-1);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"indexCov",value:function(){var e=o(s.mark((function e(){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("CSI indexes do not support indexcov");case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"parseAuxData",value:function(e,t,r){if(r<30)return{refIdToName:[],refNameToId:{}};var n=e.readInt32LE(t),a=65536&n?"zero-based-half-open":"1-based-closed",i={0:"generic",1:"SAM",2:"VCF"}[15&n];if(!i)throw new Error("invalid Tabix preset format flags ".concat(n));var s={ref:e.readInt32LE(t+4),start:e.readInt32LE(t+8),end:e.readInt32LE(t+12)},o=e.readInt32LE(t+16),u=o?String.fromCharCode(o):"",c=e.readInt32LE(t+20),f=e.readInt32LE(t+24),l=this._parseNameBytes(e.slice(t+28,t+28+f));return{refIdToName:l.refIdToName,refNameToId:l.refNameToId,skipLines:c,metaChar:u,columnNumbers:s,format:i,coordinateType:a}}},{key:"_parseNameBytes",value:function(e){for(var t=0,r=0,n=[],a={},i=0;i<e.length;i+=1)if(!e[i]){if(r<i){var s=e.toString("utf8",r,i);s=this.renameRefSeq(s),n[t]=s,a[s]=t}r=i+1,t+=1}return{refNameToId:a,refIdToName:n}}},{key:"_parse",value:function(){var e=o(s.mark((function e(){var t,r,n,a,o,u,c,f,l,h,d=this,p=arguments;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:{},e.t0=m.unzip,e.next=4,this.filehandle.readFile(t);case 4:return e.t1=e.sent,e.next=7,(0,e.t0)(e.t1);case 7:if((r=e.sent).readUInt32LE(0)!==g){e.next=12;break}n=1,e.next=17;break;case 12:if(r.readUInt32LE(0)!==_){e.next=16;break}n=2,e.next=17;break;case 16:throw new Error("Not a CSI file");case 17:return this.minShift=r.readInt32LE(4),this.depth=r.readInt32LE(8),this.maxBinNumber=((1<<3*(this.depth+1))-1)/7,a=Math.pow(2,this.minShift+3*this.depth),o=r.readInt32LE(12),u={refIdToName:[],refNameToId:{}},o&&(u=this.parseAuxData(r,16,o)),c=r.readInt32LE(16+o),l=16+o+4,h=new Array(c).fill(0).map((function(){var e=r.readInt32LE(l);l+=4;for(var t,n={},a=0;a<e;a+=1){var i=r.readUInt32LE(l);if(i>d.maxBinNumber)t=d.parsePseudoBin(r,l+4),l+=48;else{var s=(0,x.fromBytes)(r,l+4);f=d._findFirstData(f,s);var o=r.readInt32LE(l+12);l+=16;for(var u=new Array(o),c=0;c<o;c+=1){var h=(0,x.fromBytes)(r,l),p=(0,x.fromBytes)(r,l+8);l+=16,u[c]=new k.default(h,p,i)}n[i]=u}}return{binIndex:n,stats:t}})),e.abrupt("return",i(i({},u),{},{csi:!0,refCount:c,maxBlockSize:65536,firstDataLine:f,csiVersion:n,indices:h,depth:this.depth,maxBinNumber:this.maxBinNumber,maxRefLength:a}));case 28:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"parsePseudoBin",value:function(e,t){return{lineCount:(0,y.longToNumber)(b.default.fromBytesLE(Array.prototype.slice.call(e,t+28,t+36),!0))}}},{key:"blocksForRange",value:function(){var e=o(s.mark((function e(t,r,i){var o,u,c,f,l,h,d,p,v,b,m,w,g,_,S=arguments;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=S.length>3&&void 0!==S[3]?S[3]:{},r<0&&(r=0),e.next=4,this.parse(o);case 4:if(u=e.sent){e.next=7;break}return e.abrupt("return",[]);case 7:if(c=u.refNameToId[t],f=u.indices[c]){e.next=11;break}return e.abrupt("return",[]);case 11:l=this.reg2bins(r,i),h=[],d=a(l);try{for(d.s();!(p=d.n()).done;)for(v=n(p.value,2),b=v[0],m=v[1],w=b;w<=m;w++)if(f.binIndex[w])for(g=f.binIndex[w],_=0;_<g.length;++_)h.push(new k.default(g[_].minv,g[_].maxv,w))}catch(s){d.e(s)}finally{d.f()}return e.abrupt("return",(0,y.optimizeChunks)(h,new x.default(0,0)));case 16:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"reg2bins",value:function(e,t){(e-=1)<1&&(e=1),t>Math.pow(2,50)&&(t=Math.pow(2,34)),t-=1;for(var r,n=0,a=0,i=this.minShift+3*this.depth,s=[];n<=this.depth;i-=3,a+=(r=3*n,1*Math.pow(2,r)),n+=1){var o=a+S(e,i),u=a+S(t,i);if(u-o+s.length>this.maxBinNumber)throw new Error("query ".concat(e,"-").concat(t," is too large for current binning scheme (shift ").concat(this.minShift,", depth ").concat(this.depth,"), try a smaller query or a coarser index binning scheme"));s.push([o,u])}return s}}]),r}(w.default);t.default=I}}]);
//# sourceMappingURL=2.c0552638.chunk.js.map