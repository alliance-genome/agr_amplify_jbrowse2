"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[2796,9202],{63409:function(e,t,a){var n=a(96234),r=a(41361),s=a(9249),i=a(87371),c=a(77162),u=a.n(c),o=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,s.Z)(this,t),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}return(0,i.Z)(t,[{key:"_set",value:function(e,t){this.cache.set(e,t),this._size+=1,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}},{key:"get",value:function(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){var t=this.oldCache.get(e);return this.oldCache.delete(e),this._set(e,t),t}}},{key:"set",value:function(e,t){return this.cache.has(e)?this.cache.set(e,t):this._set(e,t),this}},{key:"has",value:function(e){return this.cache.has(e)||this.oldCache.has(e)}},{key:"peek",value:function(e){return this.cache.has(e)?this.cache.get(e):this.oldCache.has(e)?this.oldCache.get(e):void 0}},{key:"delete",value:function(e){var t=this.cache.delete(e);return t&&(this._size-=1),this.oldCache.delete(e)||t}},{key:"clear",value:function(){this.cache.clear(),this.oldCache.clear(),this._size=0}},{key:"keys",value:u().mark((function e(){var t,a,s,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,r.Z)(this),e.prev=1,t.s();case 3:if((a=t.n()).done){e.next=9;break}return s=(0,n.Z)(a.value,1),i=s[0],e.next=7,i;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"values",value:u().mark((function e(){var t,a,s,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,r.Z)(this),e.prev=1,t.s();case 3:if((a=t.n()).done){e.next=9;break}return s=(0,n.Z)(a.value,2),i=s[1],e.next=7,i;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:e,value:u().mark((function e(){var t,a,s,i,c,o,h,f;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,r.Z)(this.cache),e.prev=1,t.s();case 3:if((a=t.n()).done){e.next=9;break}return s=a.value,e.next=7,s;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:i=(0,r.Z)(this.oldCache),e.prev=18,i.s();case 20:if((c=i.n()).done){e.next=28;break}if(o=c.value,h=(0,n.Z)(o,1),f=h[0],this.cache.has(f)){e.next=26;break}return e.next=26,o;case 26:e.next=20;break;case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(18),i.e(e.t1);case 33:return e.prev=33,i.f(),e.finish(33);case 36:case"end":return e.stop()}}),e,this,[[1,11,14,17],[18,30,33,36]])}))},{key:"size",get:function(){var e,t=0,a=(0,r.Z)(this.oldCache.keys());try{for(a.s();!(e=a.n()).done;){var n=e.value;this.cache.has(n)||(t+=1)}}catch(s){a.e(s)}finally{a.f()}return this._size+t}}]),t}(Symbol.iterator);t.Z=o},2796:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});var n=a(87371),r=a(9249),s=a(45754),i=a(86906),c=a(39577),u=a(33528),o=a(9077),h=function(e){(0,s.Z)(a,e);var t=(0,i.Z)(a);function a(e,n,s){var i;(0,r.Z)(this,a),i=t.call(this,e,n,s);var h=(0,o.readConfObject)(e,"fastaLocation"),f=(0,o.readConfObject)(e,"faiLocation"),v=(0,o.readConfObject)(e,"gziLocation");if(!h)throw new Error("must provide fastaLocation");if(!f)throw new Error("must provide faiLocation");if(!v)throw new Error("must provide gziLocation");var l={fasta:(0,u.openLocation)(h,i.pluginManager),fai:(0,u.openLocation)(f,i.pluginManager),gzi:(0,u.openLocation)(v,i.pluginManager)};return i.fasta=new c.BgzipIndexedFasta(l),i}return(0,n.Z)(a)}(a(29202).default)},29202:function(e,t,a){a.r(t),a.d(t,{default:function(){return b}});var n=a(33028),r=a(34795),s=a(9249),i=a(87371),c=a(45754),u=a(86906),o=a(77162),h=a.n(o),f=a(39577),v=a(29598),l=a(33528),p=a(26131),d=a(14956),k=a(9077),x=a(89410),g=a.n(x),w=a(63409),b=function(e){(0,c.Z)(a,e);var t=(0,u.Z)(a);function a(e,i,c){var u;(0,s.Z)(this,a),(u=t.call(this,e,i,c)).fasta=void 0,u.seqCache=new(g())({cache:new w.Z({maxSize:200}),fill:function(){var e=(0,r.Z)(h().mark((function e(t,a){var r,s,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.refName,s=t.start,i=t.end,e.abrupt("return",u.fasta.getSequence(r,s,i,(0,n.Z)((0,n.Z)({},t),{},{signal:a})));case 2:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()});var o=(0,k.readConfObject)(e,"fastaLocation"),v=(0,k.readConfObject)(e,"faiLocation"),p={fasta:(0,l.openLocation)(o,u.pluginManager),fai:(0,l.openLocation)(v,u.pluginManager)};return u.fasta=new f.IndexedFasta(p),u}return(0,i.Z)(a,[{key:"getRefNames",value:function(e){return this.fasta.getSequenceNames(e)}},{key:"getRegions",value:function(){var e=(0,r.Z)(h().mark((function e(t){var a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fasta.getSequenceSizes(t);case 2:return a=e.sent,e.abrupt("return",Object.keys(a).map((function(e){return{refName:e,start:0,end:a[e]}})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getFeatures",value:function(e,t){var a=this,n=e.refName,s=e.start,i=e.end;return(0,p.ObservableCreate)(function(){var e=(0,r.Z)(h().mark((function e(r){var c,u,o,f,v,l,p,k,x;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.fasta.getSequenceSize(n,t);case 2:for(c=e.sent,u=void 0!==c?Math.min(c,i):i,o=[],l=i+((f=128e3)-i%f),p=v=s-s%f;p<l;p+=f)k={refName:n,start:p,end:p+f},o.push(a.seqCache.get(JSON.stringify(k),k,null===t||void 0===t?void 0:t.signal));return e.next=11,Promise.all(o);case 11:(x=e.sent.join("").slice(s-v).slice(0,i-s))&&r.next(new d.Z({id:"".concat(n," ").concat(s,"-").concat(u),data:{refName:n,start:s,end:u,seq:x}})),r.complete();case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"freeResources",value:function(){}}]),a}(v.BaseSequenceAdapter)}}]);
//# sourceMappingURL=2796.1092ab6a.chunk.js.map