"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[138],{10138:function(e,t,n){n.r(t),n.d(t,{default:function(){return me}});var r=n(96234),o=n(96902),s=n(46186),i=n(4782),a=n(75717),c=n(91188),l=n(45298),d=n.n(l),u=n(13655),h=n(2868),f=n(99782),m=n(80367),x=n(12221),v=n(34592),p=n(54417),y=n(6880),b=n(44536),j=n(97531),g=n(88315),k=n.n(g),Z=n(35388),w=n(29938);function S(e){var t=e.radioOption,n=e.assembly1,r=e.assembly2,o=e.fileLocation,s=e.bed1Location,i=e.bed2Location;if(".paf"===t)return{type:"PAFAdapter",pafLocation:o,queryAssembly:n,targetAssembly:r};if(".out"===t)return{type:"MashMapAdapter",outLocation:o,queryAssembly:n,targetAssembly:r};if(".delta"===t)return{type:"DeltaAdapter",deltaLocation:o,queryAssembly:n,targetAssembly:r};if(".chain"===t)return{type:"ChainAdapter",chainLocation:o,queryAssembly:n,targetAssembly:r};if(".anchors"===t)return{type:"MCScanAnchorsAdapter",mcscanAnchorsLocation:o,bed1Location:s,bed2Location:i,assemblyNames:[n,r]};if(".anchors.simple"===t)return{type:"MCScanSimpleAnchorsAdapter",mcscanSimpleAnchorsLocation:o,bed1Location:s,bed2Location:i,assemblyNames:[n,r]};throw new Error("Unknown type")}var C=(0,i.observer)((function(e){e.sessionTrackData;var t=e.assembly1,n=e.assembly2,i=e.setSessionTrackData,a=(0,o.useState)(),c=(0,r.Z)(a,2),l=c[0],d=c[1],u=(0,o.useState)(),h=(0,r.Z)(u,2),v=h[0],b=h[1],j=(0,o.useState)(),g=(0,r.Z)(j,2),C=g[0],L=g[1],P=(0,o.useState)(""),M=(0,r.Z)(P,2),N=M[0],A=M[1],B=(0,o.useState)(),T=(0,r.Z)(B,2),R=T[0],E=T[1],D=function(e){return e?e.uri||e.localPath||e.name:void 0}(C),I=N||(D?k().extname(function(e){return e.endsWith(".gz")?e.slice(0,e.length-3):e}(D)):"");return(0,o.useEffect)((function(){try{if(C){var e=D?k().basename(D):"MyTrack",r="".concat(e,"-").concat(Date.now());E(void 0),i({trackId:r,name:e,assemblyNames:[n,t],type:"SyntenyTrack",adapter:S({radioOption:I,assembly1:t,assembly2:n,fileLocation:C,bed1Location:v,bed2Location:l})})}}catch(o){console.error(o),E(o)}}),[D,t,n,v,l,C,I,i]),(0,w.jsxs)(y.Z,{style:{padding:12},children:[R?(0,w.jsx)(s.ErrorMessage,{error:R}):null,(0,w.jsx)(Z.Z,{style:{textAlign:"center"},children:"Add a .paf, .out (MashMap), .delta (Mummer), .chain, .anchors or .anchors.simple (MCScan) file to view in the dotplot. These file types can also be gzipped. The first assembly should be the query sequence (e.g. left column of the PAF) and the second assembly should be the target sequence (e.g. right column of the PAF)"}),(0,w.jsx)(f.Z,{value:I,onChange:function(e){return A(e.target.value)},children:(0,w.jsxs)(p.ZP,{container:!0,justifyContent:"center",children:[(0,w.jsx)(p.ZP,{item:!0,children:(0,w.jsx)(m.Z,{value:".paf",control:(0,w.jsx)(x.Z,{}),label:".paf"})}),(0,w.jsx)(p.ZP,{item:!0,children:(0,w.jsx)(m.Z,{value:".out",control:(0,w.jsx)(x.Z,{}),label:".out"})}),(0,w.jsx)(p.ZP,{item:!0,children:(0,w.jsx)(m.Z,{value:".delta",control:(0,w.jsx)(x.Z,{}),label:".delta"})}),(0,w.jsx)(p.ZP,{item:!0,children:(0,w.jsx)(m.Z,{value:".chain",control:(0,w.jsx)(x.Z,{}),label:".chain"})}),(0,w.jsx)(p.ZP,{item:!0,children:(0,w.jsx)(m.Z,{value:".anchors",control:(0,w.jsx)(x.Z,{}),label:".anchors"})}),(0,w.jsx)(p.ZP,{item:!0,children:(0,w.jsx)(m.Z,{value:".anchors.simple",control:(0,w.jsx)(x.Z,{}),label:".anchors.simple"})})]})}),(0,w.jsx)(p.ZP,{container:!0,justifyContent:"center",children:(0,w.jsx)(p.ZP,{item:!0,children:".anchors"===N||".anchors.simple"===N?(0,w.jsxs)("div",{children:[(0,w.jsxs)("div",{style:{margin:20},children:["Open the ",N," and .bed files for both genome assemblies from the MCScan (Python version) pipeline"," ",(0,w.jsx)("a",{href:"https://github.com/tanghaibao/jcvi/wiki/MCscan-(Python-version)",children:"(more info)"})]}),(0,w.jsxs)("div",{style:{display:"flex"},children:[(0,w.jsx)("div",{children:(0,w.jsx)(s.FileSelector,{name:".anchors file",description:"",location:C,setLocation:function(e){return L(e)}})}),(0,w.jsx)("div",{children:(0,w.jsx)(s.FileSelector,{name:"genome 1 .bed (left column of anchors file)",description:"",location:v,setLocation:function(e){return b(e)}})}),(0,w.jsx)("div",{children:(0,w.jsx)(s.FileSelector,{name:"genome 2 .bed (right column of anchors file)",description:"",location:l,setLocation:function(e){return d(e)}})})]})]}):(0,w.jsx)(s.FileSelector,{name:N?N+" location":"",description:"",location:C,setLocation:function(e){return L(e)}})})})]})})),L=n(68079),P=n(33266),M=n(15996),N=n(16151),A=n(99836),B=n(23642);var T=(0,i.observer)((function(e){var t,n=e.model,i=e.assembly1,a=e.assembly2,c=e.setShowTrackId,l=(0,j.getSession)(n),d=l.tracks,u=l.sessionTracks,h=[].concat((0,L.Z)(d),(0,L.Z)(u)).filter((function(e){return function(e,t,n){var r=(0,A.readConfObject)(e,"assemblyNames");return r.includes(t)&&r.includes(n)&&e.type.includes("Synteny")}(e,a,i)})),f=(null===(t=h[0])||void 0===t?void 0:t.trackId)||"",m=(0,o.useState)(f),x=(0,r.Z)(m,2),v=x[0],p=x[1];return(0,o.useEffect)((function(){p(f)}),[f]),(0,o.useEffect)((function(){c(v)}),[v,c]),(0,w.jsxs)(y.Z,{style:{padding:12},children:[(0,w.jsx)(Z.Z,{paragraph:!0,children:'Select a track from the select box below, the track will be shown when you hit "Launch".'}),(0,w.jsxs)(Z.Z,{paragraph:!0,children:["Note: there is a track selector ",(0,w.jsx)("i",{children:"inside"})," the DotplotView, which can turn on one or more SyntenyTracks (more than one can be displayed at once). Look for the track selector icon ",(0,w.jsx)(B.GD,{})]}),h.length?(0,w.jsx)(P.Z,{value:v,onChange:function(e){return p(e.target.value)},children:h.map((function(e){return(0,w.jsx)(M.Z,{value:e.trackId,children:(0,N.getTrackName)(e,l)},e.trackId)}))}):(0,w.jsx)(s.ErrorMessage,{error:"No synteny tracks found for ".concat(i,",").concat(a)})]})})),R=(0,c.ZL)()((function(e){return{importFormContainer:{padding:e.spacing(4),margin:"0 auto"},assemblySelector:{width:"75%",margin:"0 auto"}}}));function E(e){var t=e.setSessionTrackData,n=e.setShowTrackId,s=e.sessionTrackData,i=e.assembly1,a=e.assembly2,c=e.model,l=(0,o.useState)("none"),d=(0,r.Z)(l,2),v=d[0],p=d[1];return(0,o.useEffect)((function(){"none"===v&&(t(void 0),n(void 0))}),[v,t,n]),(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(u.Z,{children:[(0,w.jsx)(h.Z,{id:"group-label",children:"(Optional) Select or add a synteny track"}),(0,w.jsxs)(f.Z,{row:!0,value:v,onChange:function(e){return p(e.target.value)},"aria-labelledby":"group-label",children:[(0,w.jsx)(m.Z,{value:"none",control:(0,w.jsx)(x.Z,{}),label:"None"}),(0,w.jsx)(m.Z,{value:"tracklist",control:(0,w.jsx)(x.Z,{}),label:"Existing track"}),(0,w.jsx)(m.Z,{value:"custom",control:(0,w.jsx)(x.Z,{}),label:"New track"})]})]}),"custom"===v?(0,w.jsx)(C,{setSessionTrackData:t,sessionTrackData:s,assembly2:a,assembly1:i}):null,"tracklist"===v?(0,w.jsx)(T,{model:c,assembly1:i,assembly2:a,setShowTrackId:n}):null]})}var D=(0,i.observer)((function(e){var t=e.model,n=R().classes,i=(0,j.getSession)(t),c=i.assemblyNames,l=(0,o.useState)(c[0]||""),d=(0,r.Z)(l,2),h=d[0],f=d[1],m=(0,o.useState)(c[0]||""),x=(0,r.Z)(m,2),g=x[0],k=x[1],Z=(0,o.useState)(),S=(0,r.Z)(Z,2),C=S[0],L=S[1],P=(0,o.useState)(),M=(0,r.Z)(P,2),N=M[0],A=M[1],B=(0,o.useState)(),T=(0,r.Z)(B,2),D=T[0],I=T[1];var F=C||t.error;return(0,w.jsxs)(v.Z,{className:n.importFormContainer,children:[F?(0,w.jsx)(s.ErrorMessage,{error:F}):null,(0,w.jsx)(p.ZP,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",className:n.assemblySelector,children:(0,w.jsxs)(p.ZP,{item:!0,children:[(0,w.jsxs)(y.Z,{style:{padding:12},children:[(0,w.jsx)("p",{style:{textAlign:"center"},children:"Select assemblies for dotplot view"}),(0,w.jsxs)(p.ZP,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",children:[(0,w.jsx)(p.ZP,{item:!0,children:(0,w.jsx)(s.AssemblySelector,{selected:g,onChange:function(e){return k(e)},session:i})}),(0,w.jsx)(p.ZP,{item:!0,children:(0,w.jsx)(s.AssemblySelector,{selected:h,onChange:function(e){return f(e)},session:i})}),(0,w.jsx)(p.ZP,{item:!0,children:(0,w.jsx)(u.Z,{children:(0,w.jsx)(b.Z,{onClick:function(){try{if(!(0,j.isSessionWithAddTracks)(i))return;L(void 0),t.setError(void 0),(0,a.transaction)((function(){N?(i.addTrackConf(N),t.toggleTrack(N.trackId)):D&&t.showTrack(D),t.setViews([{bpPerPx:.1,offsetPx:0},{bpPerPx:.1,offsetPx:0}]),t.setAssemblyNames(h,g)}))}catch(e){console.error(e),L(e)}},variant:"contained",color:"primary",children:"Launch"})})})]})]}),(0,w.jsx)(E,{setShowTrackId:I,assembly2:h,assembly1:g,setSessionTrackData:A,sessionTrackData:N,model:t})]})})]})})),I=n(25322),F=n(49408),O=n(30156),z=n(96050),V=n(38238),H=n(33028),q=n(66026);function W(e){return(0,w.jsx)(q.Z,(0,H.Z)((0,H.Z)({},e),{},{children:(0,w.jsx)("path",{fill:"currentColor",d:"M13,6V11H18V7.75L22.25,12L18,16.25V13H13V18H16.25L12,22.25L7.75,18H11V13H6V16.25L1.75,12L6,7.75V11H11V6H7.75L12,1.75L16.25,6H13Z"})}))}function J(e){return(0,w.jsx)(q.Z,(0,H.Z)((0,H.Z)({},e),{},{children:(0,w.jsx)("path",{fill:"currentColor",d:"M10.07,14.27C10.57,14.03 11.16,14.25 11.4,14.75L13.7,19.74L15.5,18.89L13.19,13.91C12.95,13.41 13.17,12.81 13.67,12.58L13.95,12.5L16.25,12.05L8,5.12V15.9L9.82,14.43L10.07,14.27M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z"})}))}var X=(0,o.lazy)((function(){return Promise.all([n.e(534),n.e(9883),n.e(4514),n.e(5898)]).then(n.bind(n,85898))})),Y=(0,c.ZL)()({iconButton:{margin:5},bp:{display:"flex",alignItems:"center",marginLeft:10},spacer:{flexGrow:1},headerBar:{display:"flex"}}),_=(0,i.observer)((function(e){var t=e.model,n=Y().classes,i=(0,o.useState)(),a=(0,r.Z)(i,2),c=a[0],l=a[1];return(0,w.jsxs)("div",{children:[(0,w.jsx)(I.Z,{onClick:t.zoomOutButton,className:n.iconButton,children:(0,w.jsx)(O.Z,{})}),(0,w.jsx)(I.Z,{onClick:t.zoomInButton,className:n.iconButton,title:"zoom in",children:(0,w.jsx)(z.Z,{})}),(0,w.jsx)(I.Z,{onClick:t.activateTrackSelector,className:n.iconButton,title:"Open track selector","data-testid":"circular_track_select",children:(0,w.jsx)(B.GD,{})}),(0,w.jsx)(I.Z,{onClick:function(e){return l(e.currentTarget)},className:n.iconButton,children:(0,w.jsx)(V.Z,{})}),c?(0,w.jsx)(s.Menu,{anchorEl:c,open:!0,onMenuItemClick:function(e,t){t(),l(void 0)},menuItems:[{onClick:function(){return t.squareView()},label:"Square view - same base pairs per pixel"},{onClick:function(){return t.squareViewProportional()},label:"Rectanglular view - same total bp"},{onClick:function(){return t.showAllRegions()},label:"Show all regions"},{onClick:function(){return t.setDrawCigar(!t.drawCigar)},type:"checkbox",label:"Draw CIGAR",checked:t.drawCigar},{onClick:function(){return t.setCursorMode("move")},label:"Cursor mode - click and drag to move",icon:W,type:"radio",checked:"move"===t.cursorMode},{onClick:function(){return t.setCursorMode("crosshair")},label:"Cursor mode - select region",icon:J,type:"radio",checked:"crosshair"===t.cursorMode}],onClose:function(){return l(void 0)}}):null]})})),G=(0,i.observer)((function(e){var t=e.model.tracks.filter((function(e){var t;return null===(t=e.displays[0].warnings)||void 0===t?void 0:t.length})),n=(0,o.useState)(!1),s=(0,r.Z)(n,2),i=s[0],a=s[1];return t.length?(0,w.jsxs)(F.Z,{severity:"warning",children:["Warnings during render"," ",(0,w.jsx)(b.Z,{onClick:function(){return a(!0)},children:"More info"}),i?(0,w.jsx)(X,{tracksWithWarnings:t,handleClose:function(){return a(!1)}}):null]}):null})),U=(0,i.observer)((function(e){var t=e.model,n=e.selection,r=Y().classes,o=t.hview,s=t.vview;return(0,w.jsxs)("div",{className:r.headerBar,children:[(0,w.jsx)(_,{model:t}),(0,w.jsxs)(Z.Z,{className:r.bp,variant:"body2",color:"textSecondary",children:["x: ",o.assemblyNames.join(",")," ",(0,j.getBpDisplayStr)(o.currBp),(0,w.jsx)("br",{}),"y: ",s.assemblyNames.join(",")," ",(0,j.getBpDisplayStr)(s.currBp)]}),n?(0,w.jsxs)(Z.Z,{className:r.bp,variant:"body2",color:"textSecondary",children:["width:".concat((0,j.getBpDisplayStr)(o.bpPerPx*n.width))," ",(0,w.jsx)("br",{}),"height:".concat((0,j.getBpDisplayStr)(s.bpPerPx*n.height))]}):null,(0,w.jsx)("div",{className:r.spacer}),(0,w.jsx)(G,{model:t})]})})),$=n(88636),K=(0,i.observer)((function(e){var t,n,r=e.model,o=e.children,s=r.viewWidth,i=r.viewHeight,a=r.hview,c=r.vview,l=a.dynamicBlocks.contentBlocks,d=c.dynamicBlocks.contentBlocks,u=a.displayedRegionsTotalPx-a.offsetPx,h=c.displayedRegionsTotalPx-c.offsetPx,f=(null===(t=l[0])||void 0===t?void 0:t.offsetPx)-a.offsetPx,m=(null===(n=d[0])||void 0===n?void 0:n.offsetPx)-c.offsetPx,x=(0,$.Z)(),v=x.palette.divider,p=Math.max(f,0),y=Math.max(i-h,0),b=Math.min(u-f,s),j=Math.min(i-m-y,i),g=1/0,k=1/0;return(0,w.jsxs)("svg",{style:{background:"rgba(0,0,0,0.12)"},width:s,height:i,children:[(0,w.jsx)("rect",{x:p,y:y,width:b,height:j,fill:x.palette.background.default}),(0,w.jsxs)("g",{children:[l.map((function(e){var t=e.offsetPx-a.offsetPx,n=Math.floor(t)!==Math.floor(g);return n&&(g=t),n?(0,w.jsx)("line",{x1:t,y1:0,x2:t,y2:i,stroke:v},JSON.stringify(e)):null})),d.map((function(e){var t=i-(e.offsetPx-c.offsetPx),n=Math.floor(t)!==Math.floor(k);return n&&(k=t),n?(0,w.jsx)("line",{x1:0,y1:t,x2:s,y2:t,stroke:v},JSON.stringify(e)):null})),(0,w.jsx)("line",{x1:u,y1:0,x2:u,y2:i,stroke:v}),(0,w.jsx)("line",{x1:0,y1:i-h,x2:s,y2:i-h,stroke:v})]}),o]})})),Q=n(63680),ee=n(98103),te=n(44529),ne=(0,c.ZL)()((function(){return{vtext:{gridColumn:"1/2",gridRow:"1/2",pointerEvents:"none",userSelect:"none"},htext:{gridColumn:"2/2",gridRow:"2/2",pointerEvents:"none",userSelect:"none"}}})),re=(0,i.observer)((function(e){var t=e.model,n=ne().classes,r=t.viewWidth,o=t.borderX,s=t.borderY,i=t.hview,a=t.htextRotation,c=t.hticks,l=i.offsetPx,d=i.width,u=i.dynamicBlocks,h=i.bpPerPx,f=u.contentBlocks,m=(0,te.F$)(f,r,l),x=(0,$.Z)(),v=(0,H.Z)((0,H.Z)({},(0,Q.getSnapshot)(i)),{},{width:d,staticBlocks:i.staticBlocks});return(0,w.jsxs)("svg",{width:r,height:s,className:n.htext,children:[f.filter((function(e){return!m.has(e.key)})).map((function(e){var t=e.offsetPx,n=Math.floor(t-i.offsetPx);return(0,w.jsx)("text",{transform:"rotate(".concat(a,",").concat(n,",").concat(0,")"),x:n,y:1,fill:x.palette.text.primary,dominantBaseline:"hanging",textAnchor:"end",children:[e.refName,0!==e.start?Math.floor(e.start).toLocaleString("en-US"):""].filter((function(e){return!!e})).join(":")},JSON.stringify(e))})),c.map((function(e){var t,n=((null===(t=(0,ee.R)({refName:e.refName,coord:e.base,self:v}))||void 0===t?void 0:t.offsetPx)||0)-l;return(0,w.jsx)("line",{x1:n,x2:n,y1:0,y2:"major"===e.type?6:4,strokeWidth:1,stroke:x.palette.divider,"data-bp":e.base},"line-".concat(JSON.stringify(e)))})),c.filter((function(e){return"major"===e.type})).map((function(e){var t,n=((null===(t=(0,ee.R)({refName:e.refName,coord:e.base,self:v}))||void 0===t?void 0:t.offsetPx)||0)-l;return n>10?(0,w.jsx)("text",{x:n-7,y:0,transform:"rotate(".concat(a,",").concat(n,",").concat(0,")"),fill:x.palette.text.primary,fontSize:11,dominantBaseline:"middle",textAnchor:"end",children:(0,j.getTickDisplayStr)(e.base+1,h)},"text-".concat(JSON.stringify(e))):null})),(0,w.jsx)("text",{y:s-12,x:(r-o)/2,fill:x.palette.text.primary,textAnchor:"middle",dominantBaseline:"hanging",children:i.assemblyNames.join(",")})]})})),oe=(0,i.observer)((function(e){var t=e.model,n=ne().classes,r=t.borderX,o=t.viewHeight,s=t.borderY,i=t.vview,a=t.vtextRotation,c=t.vticks,l=i.offsetPx,d=i.width,u=i.dynamicBlocks,h=i.bpPerPx,f=u.contentBlocks,m=(0,te.F$)(f,o,l),x=(0,$.Z)(),v=(0,H.Z)((0,H.Z)({},(0,Q.getSnapshot)(i)),{},{width:d,staticBlocks:i.staticBlocks});return(0,w.jsxs)("svg",{className:n.vtext,width:r,height:o,children:[f.filter((function(e){return!m.has(e.key)})).map((function(e){var t=e.offsetPx,n=r,s=Math.floor(o-t+l);return(0,w.jsx)("text",{transform:"rotate(".concat(a,",").concat(n,",").concat(t,")"),x:n,y:s,fill:x.palette.text.primary,textAnchor:"end",children:[e.refName,0!==e.start?Math.floor(e.start).toLocaleString("en-US"):""].filter((function(e){return!!e})).join(":")},JSON.stringify(e))})),c.map((function(e){var t,n=((null===(t=(0,ee.R)({refName:e.refName,coord:e.base,self:v}))||void 0===t?void 0:t.offsetPx)||0)-l;return(0,w.jsx)("line",{y1:o-n,y2:o-n,x1:r,x2:r-("major"===e.type?6:4),strokeWidth:1,stroke:x.palette.divider,"data-bp":e.base},"line-".concat(JSON.stringify(e)))})),c.filter((function(e){return"major"===e.type})).map((function(e){var t,n=((null===(t=(0,ee.R)({refName:e.refName,coord:e.base,self:v}))||void 0===t?void 0:t.offsetPx)||0)-l;return n>10?(0,w.jsx)("text",{y:o-n-3,x:r-7,textAnchor:"end",fill:x.palette.text.primary,dominantBaseline:"hanging",fontSize:11,children:(0,j.getTickDisplayStr)(e.base+1,h)},"text-".concat(JSON.stringify(e))):null})),(0,w.jsx)("text",{y:(o-s)/2,x:12,fill:x.palette.text.primary,transform:"rotate(-90,12,".concat((o-s)/2,")"),textAnchor:"middle",children:i.assemblyNames.join(",")})]})})),se=(0,c.ZL)()((function(e){return{popover:{background:e.palette.background.paper,maxWidth:400,wordBreak:"break-all",zIndex:1e3,border:"1px solid ".concat(e.palette.action.active),pointerEvents:"none",position:"absolute"}}})),ie={left:0,top:0,width:0,height:0},ae=(0,i.observer)((function(e){var t,n=e.model,r=e.mouserect,s=e.xdistance,i=e.ydistance,a=se().classes,c=n.hview,l=n.vview,d=n.viewHeight,u=(0,o.useRef)(null),h=((null===(t=u.current)||void 0===t?void 0:t.getBoundingClientRect())||ie).height+12;return(0,w.jsx)(w.Fragment,{children:r?(0,w.jsxs)("div",{ref:u,className:a.popover,style:{left:6+r[0]-(s<0?h:0),top:6+r[1]-(i<0?h:0)},children:["x - ".concat((0,te.c4)(r[0],c)),(0,w.jsx)("br",{}),"y - ".concat((0,te.c4)(d-r[1],l)),(0,w.jsx)("br",{})]}):null})})),ce=(0,i.observer)((function(e){var t,n=e.model,r=e.mousedown,s=e.xdistance,i=e.ydistance,a=se().classes,c=n.hview,l=n.vview,d=n.viewHeight,u=(0,o.useRef)(null),h=(null===(t=u.current)||void 0===t?void 0:t.getBoundingClientRect())||ie;return(0,w.jsx)(w.Fragment,{children:r&&Math.abs(s)>3&&Math.abs(i)>3?(0,w.jsxs)("div",{ref:u,className:a.popover,style:{left:r[0]-(s<0?0:h.width),top:r[1]-(i<0?0:h.height)},children:["x - ".concat((0,te.c4)(r[0],c)),(0,w.jsx)("br",{}),"y - ".concat((0,te.c4)(d-r[1],l)),(0,w.jsx)("br",{})]}):null})})),le={left:0,top:0,width:0,height:0},de=(0,c.ZL)()((function(e){return{spacer:{gridColumn:"1/2",gridRow:"2/2"},root:{position:"relative",marginBottom:e.spacing(1),overflow:"hidden"},container:{display:"grid",padding:5,position:"relative"},overlay:{pointerEvents:"none",overflow:"hidden",display:"flex",width:"100%",gridRow:"1/2",gridColumn:"2/2",zIndex:100,"& path":{cursor:"crosshair",fill:"none"}},content:{position:"relative",gridColumn:"2/2",gridRow:"1/2"}}}));function ue(e,t){return e&&[e[0]-t.left,e[1]-t.top]}var he=(0,i.observer)((function(e){var t=e.model,n=de().classes;return(0,w.jsx)("div",{className:n.overlay,children:t.tracks.map((function(e){var t=(0,r.Z)(e.displays,1)[0],n=t.RenderingComponent;return n?(0,w.jsx)(n,{model:t},e.configuration.trackId):null}))})})),fe=(0,i.observer)((function(e){var t,n=e.model,i=n.cursorMode,c=de().classes,l=(0,o.useState)(),u=(0,r.Z)(l,2),h=u[0],f=u[1],m=(0,o.useState)(),x=(0,r.Z)(m,2),v=x[0],p=x[1],y=(0,o.useState)(!1),b=(0,r.Z)(y,2),j=b[0],g=b[1],k=(0,o.useState)(),Z=(0,r.Z)(k,2),S=Z[0],C=Z[1],L=(0,o.useRef)(null),P=(0,o.useRef)(null),M=(0,o.useRef)(0),N=(0,o.useRef)(0),A=(0,o.useRef)(!1),B=(null===(t=L.current)||void 0===t?void 0:t.getBoundingClientRect())||le,T=ue(v,B),R=ue(h,B),E=ue(S,B),D=E||R,I=T&&D?D[0]-T[0]:0,F=T&&D?D[1]-T[1]:0,O=n.hview,z=n.vview;return(0,o.useEffect)((function(){function e(e){var t=d()(e);e.preventDefault(),M.current+=t.pixelX,N.current-=t.pixelY,A.current||(A.current=!0,window.requestAnimationFrame((function(){(0,a.transaction)((function(){O.scroll(M.current),z.scroll(N.current)})),A.current=!1,M.current=0,N.current=0})))}if(L.current){var t=L.current;return t.addEventListener("wheel",e),function(){return t.removeEventListener("wheel",e)}}return function(){}}),[O,z]),(0,o.useEffect)((function(){function e(e){f([e.clientX,e.clientY]),h&&v&&"move"===i&&(O.scroll(-e.clientX+h[0]),z.scroll(e.clientY-h[1]))}return window.addEventListener("mousemove",e),function(){return window.removeEventListener("mousemove",e)}}),[h,v,i,O,z]),(0,o.useEffect)((function(){var e=function(){};function t(e){Math.abs(I)>3&&Math.abs(F)>3&&"crosshair"===i?C([e.clientX,e.clientY]):p(void 0)}return T&&!E&&(window.addEventListener("mouseup",t,!0),e=function(){return window.removeEventListener("mouseup",t,!0)}),e}),[T,R,E,I,F,i]),(0,w.jsxs)("div",{children:[(0,w.jsx)(U,{model:n,selection:"move"!==i&&T&&D?{width:Math.abs(I),height:Math.abs(F)}:void 0}),(0,w.jsxs)("div",{ref:P,className:c.root,onMouseLeave:function(){return g(!1)},onMouseEnter:function(){return g(!0)},children:[(0,w.jsxs)("div",{className:c.container,style:{transform:"scaleX(".concat(O.scaleFactor,") scaleY(").concat(z.scaleFactor,")")},children:[(0,w.jsx)(oe,{model:n}),(0,w.jsx)(re,{model:n}),(0,w.jsxs)("div",{ref:L,className:c.content,children:[j&&"crosshair"===i?(0,w.jsx)(ae,{model:n,mouserect:D,xdistance:I,ydistance:F}):null,"crosshair"===i?(0,w.jsx)(ce,{model:n,mousedown:T,xdistance:I,ydistance:F}):null,(0,w.jsx)("div",{style:{cursor:i},onMouseDown:function(e){if(0===e.button){var t=e.clientX,n=e.clientY;p([t,n]),f([t,n])}},children:(0,w.jsx)(K,{model:n,children:"crosshair"===i&&T&&D?(0,w.jsx)("rect",{fill:"rgba(255,0,0,0.3)",x:Math.min(D[0],T[0]),y:Math.min(D[1],T[1]),width:Math.abs(I),height:Math.abs(F)}):null})}),(0,w.jsx)("div",{className:c.spacer})]}),(0,w.jsx)(he,{model:n}),(0,w.jsx)(s.Menu,{open:Boolean(E),onMenuItemClick:function(e,t){t(),C(void 0),p(void 0)},onClose:function(){C(void 0),p(void 0)},anchorReference:"anchorPosition",anchorPosition:S?{top:S[1]+30,left:S[0]+30}:void 0,style:{zIndex:1e4},menuItems:[{label:"Zoom in",onClick:function(){T&&E&&n.zoomIn(T,E)}},{label:"Open linear synteny view",onClick:function(){T&&E&&n.onDotplotView(T,E)}}]})]}),(0,w.jsx)(s.ResizeHandle,{onDrag:function(e){return n.setHeight(n.height+e)},style:{height:4,background:"#ccc",boxSizing:"border-box",borderTop:"1px solid #fafafa"}})]})]})})),me=(0,i.observer)((function(e){var t=e.model,n=t.initialized,r=t.loading,o=t.error;return!n&&!r||o?(0,w.jsx)(D,{model:t}):r?(0,w.jsx)(s.LoadingEllipses,{variant:"h5"}):(0,w.jsx)(fe,{model:t})}))}}]);
//# sourceMappingURL=138.789fe39f.chunk.js.map