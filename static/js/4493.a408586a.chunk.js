"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[4493],{34493:function(e,n,t){t.r(n),t.d(n,{default:function(){return T}});var r=t(33028),o=t(96234),i=t(30969),s=t(90550),a=t(9077),l=t(22714),c=t(40909),d=t(24998),u=t(53239),v=t(317),f=t(80975),p=t(2296),m=t(81073),h=t(37574),x=(0,l.Z)((function(e){return{rubberBand:{height:"100%",background:e.palette.tertiary?(0,u.Fq)(e.palette.tertiary.main,.7):(0,u.Fq)(e.palette.primary.main,.7),position:"absolute",zIndex:10,textAlign:"center",overflow:"hidden"},rubberBandControl:{cursor:"crosshair",width:"100%",minHeight:8},rubberBandText:{color:e.palette.tertiary?e.palette.tertiary.contrastText:e.palette.primary.contrastText},popover:{mouseEvents:"none",cursor:"crosshair"},paper:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},guide:{pointerEvents:"none",height:"100%",width:1,position:"absolute",zIndex:10},sm:{fontSize:10}}})),g=(0,s.observer)((function(e){var n=e.model,t=e.coordX,r=x();return(0,h.jsx)(v.ZP,{open:!0,placement:"top",title:n.views.map((function(e){return e.pxToBp(t)})).map((function(e){return(0,h.jsx)(f.Z,{className:r.sm,children:(0,m.stringify)(e)},JSON.stringify(e))})),arrow:!0,children:(0,h.jsx)("div",{className:r.guide,style:{left:t,background:"red"}})})}));var b=(0,s.observer)((function(e){var n=e.model,t=e.ControlComponent,r=void 0===t?(0,h.jsx)("div",{}):t,s=(0,i.useState)(),a=(0,o.Z)(s,2),l=a[0],c=a[1],u=(0,i.useState)(),v=(0,o.Z)(u,2),b=v[0],j=v[1],w=(0,i.useState)(),y=(0,o.Z)(w,2),C=y[0],B=y[1],N=(0,i.useState)(),Z=(0,o.Z)(N,2),M=Z[0],k=Z[1],E=(0,i.useRef)(null),O=(0,i.useRef)(null),R=x(),S=void 0!==l&&void 0===C;function T(e){e.preventDefault(),e.stopPropagation();var n=e.clientX-e.target.getBoundingClientRect().left;c(n),j(n)}function z(e){var n=e.target;k(e.clientX-n.getBoundingClientRect().left)}function L(){k(void 0),n.views.forEach((function(e){return e.setOffsets(void 0,void 0)}))}function X(){B(void 0),c(void 0),j(void 0)}(0,i.useEffect)((function(){function e(e){if(E.current&&S){var n=e.clientX-E.current.getBoundingClientRect().left;j(n)}}function t(e){if(void 0!==l&&E.current){var t=e.clientX,r=e.clientY,o=t-E.current.getBoundingClientRect().left;B({offsetX:o,clientX:t,clientY:r}),n.views.forEach((function(e){var n=function(e,n){if(void 0!==l){var t=l,r=e;if(r<t){var o=[r,t];t=o[0],r=o[1]}return{leftOffset:n.pxToBp(t),rightOffset:n.pxToBp(r)}}}(o,e);if(n){var t=n.leftOffset,r=n.rightOffset;e.setOffsets(t,r)}})),k(void 0)}}return S?(window.addEventListener("mousemove",e),window.addEventListener("mouseup",t),function(){window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t)}):function(){}}),[l,S,C,n]),(0,i.useEffect)((function(){!S&&void 0!==b&&void 0!==l&&Math.abs(b-l)<=3&&X()}),[S,b,l]);var F=Boolean(C);if(void 0===l)return(0,h.jsxs)(h.Fragment,{children:[void 0!==M?(0,h.jsx)(g,{model:n,coordX:M}):null,(0,h.jsx)("div",{"data-testid":"rubberBand_controls",className:R.rubberBandControl,role:"presentation",ref:E,onMouseDown:T,onMouseOut:L,onMouseMove:z,children:r})]});var I=C?C.offsetX:b||0,P=I<l?I:l,H=Math.abs(I-l),_=n.views,V=_.map((function(e){return e.pxToBp(P)})),q=_.map((function(e){return e.pxToBp(P+H)})),A=_.map((function(e){return Math.ceil(H*e.bpPerPx)}));return(0,h.jsxs)(h.Fragment,{children:[O.current?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(p.ZP,{className:R.popover,classes:{paper:R.paper},open:!0,anchorEl:O.current,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"right"},keepMounted:!0,disableRestoreFocus:!0,children:V.map((function(e){return(0,h.jsx)(f.Z,{children:(0,m.stringify)(e)},JSON.stringify(e))}))}),(0,h.jsx)(p.ZP,{className:R.popover,classes:{paper:R.paper},open:!0,anchorEl:O.current,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,disableRestoreFocus:!0,children:q.map((function(e){return(0,h.jsx)(f.Z,{children:(0,m.stringify)(e)},JSON.stringify(e))}))})]}):null,(0,h.jsx)("div",{ref:O,className:R.rubberBand,style:{left:P,width:H},children:(0,h.jsx)(f.Z,{variant:"h6",className:R.rubberBandText,children:A.map((function(e,n){return(0,h.jsx)(f.Z,{children:"".concat(e.toLocaleString("en-US"),"bp")},"".concat(e,"_").concat(n))}))})}),(0,h.jsx)("div",{"data-testid":"rubberBand_controls",className:R.rubberBandControl,role:"presentation",ref:E,onMouseDown:T,onMouseOut:L,onMouseMove:z,children:r}),C?(0,h.jsx)(d.Menu,{anchorReference:"anchorPosition",anchorPosition:{left:C.clientX,top:C.clientY},onMenuItemClick:function(e,n){n(),X()},open:F,onClose:X,menuItems:n.rubberBandMenuItems()}):null]})})),j=t(32343),w=t(59917),y=t(77977),C=t(8623),B=t(79582),N=(0,l.Z)((function(){return{headerBar:{gridArea:"1/1/auto/span 2",display:"flex"},spacer:{flexGrow:1},bp:{display:"flex",alignItems:"center",marginLeft:10},searchContainer:{marginLeft:5},searchBox:{display:"flex"}}})),Z=(0,s.observer)((function(e){var n=e.model;return(0,h.jsx)(j.Z,{onClick:n.toggleLinkViews,title:"Toggle linked scrolls and behavior across views",children:n.linkViews?(0,h.jsx)(C.Z,{color:"secondary"}):(0,h.jsx)(y.Z,{color:"secondary"})})})),M=(0,s.observer)((function(e){var n=e.model;return(0,h.jsx)(j.Z,{onClick:n.squareView,title:"Square view (make both the same zoom level)",children:(0,h.jsx)(B.Z,{color:"secondary"})})})),k=(0,s.observer)((function(e){var n=e.model,t=e.ExtraButtons,r=N(),o=n.views.some((function(e){return!e.hideHeader}));return(0,h.jsxs)("div",{className:r.headerBar,children:[(0,h.jsx)(Z,{model:n}),(0,h.jsx)(M,{model:n}),t,o?null:n.views.map((function(e){return(0,h.jsxs)("div",{className:r.searchBox,children:[(0,h.jsx)("div",{className:r.searchContainer,children:(0,h.jsx)(w.Rj,{model:e,showHelp:!1})}),(0,h.jsx)("div",{className:r.bp,children:(0,h.jsxs)(f.Z,{variant:"body2",color:"textSecondary",className:r.bp,children:[Math.round(e.coarseTotalBp).toLocaleString("en-US")," bp"]})})]},e.id)})),(0,h.jsx)("div",{className:r.spacer})]})})),E=(0,l.Z)((function(){return{container:{display:"grid"},overlay:{zIndex:100,gridArea:"1/1"},content:{gridArea:"1/1",position:"relative"},grid:{display:"grid"},relative:{position:"relative"},rubberbandContainer:{position:"relative",overflow:"hidden"}}})),O=(0,s.observer)((function(e){var n=e.model,t=E();return(0,h.jsx)(h.Fragment,{children:n.tracks.map((function(e){var r=(0,o.Z)(e.displays,1)[0],i=r.RenderingComponent,s=(0,a.getConf)(e,"trackId");return i?(0,h.jsx)("div",{className:t.overlay,style:{height:n.middleComparativeHeight,overflow:"hidden"},children:(0,h.jsx)(i,{model:r})},s):null}))})})),R=(0,s.observer)((function(e){var n=e.model,t=e.ExtraButtons,r=E(),o=n.views,i=(0,c.getEnv)(n).pluginManager.getViewType(o[0].type).ReactComponent;return(0,h.jsxs)("div",{className:r.rubberbandContainer,children:[(0,h.jsx)(k,{ExtraButtons:t,model:n}),(0,h.jsx)(b,{model:n,ControlComponent:(0,h.jsx)("div",{style:{width:"100%",height:15}})}),(0,h.jsxs)("div",{className:r.container,children:[(0,h.jsx)(i,{model:o[0]}),(0,h.jsx)("div",{className:r.grid,children:(0,h.jsx)(O,{model:n})}),(0,h.jsx)(d.ResizeHandle,{onDrag:function(e){return n.setMiddleComparativeHeight(n.middleComparativeHeight+e)},style:{height:4,background:"#ccc"}}),(0,h.jsx)(i,{model:o[1]})]})]})})),S=(0,s.observer)((function(e){var n=e.model,t=e.ExtraButtons,r=E(),o=n.views,i=(0,c.getEnv)(n).pluginManager;return(0,h.jsxs)("div",{className:r.rubberbandContainer,children:[(0,h.jsx)(k,{model:n,ExtraButtons:t}),(0,h.jsx)(b,{model:n,ControlComponent:(0,h.jsx)("div",{style:{width:"100%",height:15}})}),(0,h.jsx)("div",{className:r.container,children:(0,h.jsxs)("div",{className:r.content,children:[(0,h.jsx)("div",{className:r.relative,children:o.map((function(e){var n=i.getViewType(e.type).ReactComponent;return(0,h.jsx)(n,{model:e},e.id)}))}),(0,h.jsx)(O,{model:n})]})})]})})),T=(0,s.observer)((function(e){return e.model.tracks.some((function(e){return e.displays.some((function(e){return(0,a.getConf)(e,"middle")}))}))?(0,h.jsx)(R,(0,r.Z)({},e)):(0,h.jsx)(S,(0,r.Z)({},e))}))}}]);
//# sourceMappingURL=4493.a408586a.chunk.js.map