(this["webpackJsonp@jbrowse/web"]=this["webpackJsonp@jbrowse/web"]||[]).push([[46],{1719:function(e,t,n){"use strict";n.r(t);var a=n(29),o=n(86),r=n(80),c=n.n(r),l=n(1),i=n.n(l),s=n(51),d=n(1638),u=n(1636),m=n(1652),f=n(1747),b=n(1642),g=n(1665),h=n(1263),v=n(1633),k=n(1645),E=n(1685),p=n(348),C=n.n(p),j=n(237),O=n.n(j),y=n(441),x=n.n(y),w=n(822),T=n.n(w),W=n(827),I=n.n(W),S=n(1573),N=n.n(S),B=n(1574),A=n.n(B),L=n(1572),M=n(233),D=n(82),H=n(79),F=n(84),P=n(1605),z=Object(l.lazy)((function(){return n.e(61).then(n.bind(null,1600))})),R=Object(l.lazy)((function(){return n.e(62).then(n.bind(null,1601))})),J=Object(l.lazy)((function(){return n.e(63).then(n.bind(null,1602))})),U=Object(l.lazy)((function(){return n.e(64).then(n.bind(null,1603))})),_=Object(s.a)((function(e){var t,n;return{searchBox:{marginBottom:e.spacing(2)},menuIcon:{marginRight:e.spacing(1),marginBottom:0},fab:{position:"absolute",bottom:e.spacing(6),right:e.spacing(6)},compactCheckbox:{padding:0},checkboxLabel:{marginRight:0,"&:hover":{backgroundColor:"#eee"}},accordionBase:{display:"flex"},accordionCard:{padding:3,cursor:"pointer",display:"flex"},nestingLevelMarker:{position:"absolute",borderLeft:"1.5px solid #555"},accordionColor:{background:null===(t=e.palette.tertiary)||void 0===t?void 0:t.main,color:null===(n=e.palette.tertiary)||void 0===n?void 0:n.contrastText,width:"100%",display:"flex",paddingLeft:5},accordionText:{margin:"auto 0"}}})),q=function(e){var t=e.data,n=e.isOpen,a=e.style,o=e.setOpen,r=t.isLeaf,c=t.nestingLevel,l=t.checked,s=t.id,g=t.name,h=t.onChange,v=t.toggleCollapse,k=t.conf,E=t.onMoreInfo,p=t.drawerPosition,C=_(),j=10*c+(r?10:0),O=g&&(g.endsWith("(Unsupported)")||g.endsWith("(Unknown)")),y=k&&Object(H.readConfObject)(k,["description"])||"";return i.a.createElement("div",{style:a,className:r?void 0:C.accordionBase},new Array(c).fill(0).map((function(e,t){return i.a.createElement("div",{key:"mark-".concat(t),style:{left:10*t+4,height:a.height},className:C.nestingLevelMarker})})),i.a.createElement("div",{className:r?void 0:C.accordionCard,onClick:function(){v(s),o(!n)},style:{marginLeft:j,whiteSpace:"nowrap",width:"100%"}},i.a.createElement("div",{className:r?void 0:C.accordionColor},r?i.a.createElement(i.a.Fragment,null,i.a.createElement(u.a,{title:y,placement:"left"===p?"right":"left"},i.a.createElement(m.a,{className:C.checkboxLabel,control:i.a.createElement(f.a,{className:C.compactCheckbox,checked:l,onChange:function(){return h(s)},color:"primary",disabled:O,inputProps:{"data-testid":"htsTrackEntry-".concat(s)}}),label:g})),i.a.createElement(b.a,{onClick:function(e){return E({target:e.currentTarget,id:s,conf:k})},color:"secondary","data-testid":"htsTrackEntryMenu-".concat(s)},i.a.createElement(N.a,null))):i.a.createElement("div",{className:C.accordionText},i.a.createElement(d.a,null,n?i.a.createElement(x.a,null):i.a.createElement(T.a,null),g)))))},G=function(e,t,n){var a=!!e.conf;return{data:Object(o.a)(Object(o.a)({defaultHeight:a?22:40,isLeaf:a,isOpenByDefault:!0,nestingLevel:t},e),n),nestingLevel:t,node:e}},K=Object(F.observer)((function(e){var t,n=e.height,o=e.tree,r=e.model,s=r.filterText,d=r.view,u=Object(l.useRef)(null),m=Object(l.useState)(),f=Object(a.a)(m,2),b=f[0],g=f[1],h=Object(D.getSession)(r),v=h.drawerPosition,k=Object(l.useMemo)((function(){return{onChange:function(e){return d.toggleTrack(e)},toggleCollapse:function(e){return r.toggleCategory(e)},onMoreInfo:g,drawerPosition:v}}),[d,r,v]),E=Object(l.useCallback)(c.a.mark((function e(){var t,n,a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<o.children.length)){e.next=7;break}return e.next=4,G(o.children[t],0,k);case 4:t++,e.next=1;break;case 7:return void(e.next=10);case 10:n=e.sent,a=0;case 12:if(!(a<n.node.children.length)){e.next=19;break}return r=n.node.children[a],e.next=16,G(r,n.nestingLevel+1,k);case 16:a++,e.next=12;break;case 19:e.next=7;break;case 21:case"end":return e.stop()}}),e)})),[o,k]),p=null===b||void 0===b?void 0:b.conf,C=p&&(null===(t=h.getTrackActionMenuItems)||void 0===t?void 0:t.call(h,p))||[];return Object(l.useEffect)((function(){u.current.recomputeTree({refreshNodes:!0,useDefaultHeight:!0})}),[o,s]),i.a.createElement(i.a.Fragment,null,i.a.createElement(P.a,{ref:u,treeWalker:E,height:n},q),i.a.createElement(M.a,{anchorEl:null===b||void 0===b?void 0:b.target,menuItems:C,onMenuItemClick:function(e,t){t(),g(void 0)},open:Boolean(b),onClose:function(){return g(void 0)}}))})),Q=function(e){var t=e.tree,n=e.model,a=e.offset;return"undefined"===typeof jest?i.a.createElement(L.a,{disableWidth:!0},(function(e){var o=e.height;return i.a.createElement(K,{height:o-a,model:n,tree:t})})):i.a.createElement(K,{height:9e3,model:n,tree:t})},V=function(e){var t=e.overrideDimensions,n=e.children;return t?i.a.createElement("div",{style:Object(o.a)({},t)},n):i.a.createElement(i.a.Fragment,null,n)},X=Object(F.observer)((function(e){var t=e.model,n=e.toolbarHeight,o=e.overrideDimensions,r=_(),c=Object(D.getSession)(t),s=Object(l.useState)(null),d=Object(a.a)(s,2),u=d[0],m=d[1];function f(){m(null)}return i.a.createElement(V,{overrideDimensions:o},i.a.createElement(Z,{model:t,toolbarHeight:n,overrideDimensions:o}),i.a.createElement(g.a,{color:"secondary",className:r.fab,onClick:function(e){m(e.currentTarget)}},i.a.createElement(O.a,null)),i.a.createElement(h.a,{anchorEl:u,open:Boolean(u),onClose:function(){return m(null)}},i.a.createElement(v.a,{onClick:function(){f();var e=c.addWidget("AddConnectionWidget","addConnectionWidget");c.showWidget(e)}},"Add connection"),i.a.createElement(v.a,{onClick:function(){f();var e=c.addWidget("AddTrackWidget","addTrackWidget",{view:t.view.id});c.showWidget(e)}},"Add track")))})),Y=Object(F.observer)((function(e){var t=e.model,n=e.setHeaderHeight,o=e.setAssemblyIdx,r=e.assemblyIdx,c=_(),s=Object(D.getSession)(t),d=Object(l.useState)(),u=Object(a.a)(d,2),m=u[0],f=u[1],g=Object(l.useState)(),h=Object(a.a)(g,2),v=h[0],p=h[1],j=Object(l.useState)(),O=Object(a.a)(j,2),y=O[0],x=O[1],w=Object(l.useState)(),T=Object(a.a)(w,2),W=T[0],S=T[1],N=Object(l.useState)(!1),B=Object(a.a)(N,2),L=B[0],F=B[1],P=Object(l.useState)(!1),q=Object(a.a)(P,2),G=q[0],K=q[1],Q=t.assemblyNames,V=Q[r];function X(e,t){var n=Object(H.readConfObject)(e,"name"),o=s.prepareToBreakConnection(e);if(o){var r=Object(a.a)(o,2),c=r[0],l=r[1];Object.keys(l).length>0?x({connectionConf:e,safelyBreakConnection:c,dereferenceTypeCount:l,name:n}):c()}t&&S({name:n,connectionConf:e})}var Y=[{label:"Turn on/off connections...",onClick:function(){return K(!0)}},{label:"Delete connections...",onClick:function(){return F(!0)}}],Z=Q.length>1?[{label:"Select assembly...",subMenu:Q.map((function(e,t){return{label:e,onClick:function(){o(t)}}}))}]:[],$=[{label:"Add track...",onClick:function(){s.showWidget(s.addWidget("AddTrackWidget","addTrackWidget",{view:t.view.id}))}}].concat(Z);return i.a.createElement("div",{ref:function(e){return n((null===e||void 0===e?void 0:e.getBoundingClientRect().height)||0)},"data-testid":"hierarchical_track_selector"},i.a.createElement("div",{style:{display:"flex"}},i.a.createElement(b.a,{className:c.menuIcon,onClick:function(e){p(e.currentTarget)}},i.a.createElement(I.a,null)),i.a.createElement(b.a,{className:c.menuIcon,onClick:function(e){f(e.currentTarget)}},i.a.createElement(A.a,null)),i.a.createElement(k.a,{className:c.searchBox,label:"Filter tracks",value:t.filterText,onChange:function(e){return t.setFilterText(e.target.value)},fullWidth:!0,InputProps:{endAdornment:i.a.createElement(E.a,{position:"end"},i.a.createElement(b.a,{color:"secondary",onClick:t.clearFilterText},i.a.createElement(C.a,null)))}})),i.a.createElement(M.a,{anchorEl:m,open:Boolean(m),onMenuItemClick:function(e,t){t(),f(void 0)},onClose:function(){f(void 0)},menuItems:[{label:"Add connection",onClick:function(){s.showWidget(s.addWidget("AddConnectionWidget","addConnectionWidget"))}}].concat(Y)}),i.a.createElement(M.a,{anchorEl:v,open:Boolean(v),onMenuItemClick:function(e,t){t(),p(void 0)},onClose:function(){p(void 0)},menuItems:$}),i.a.createElement(l.Suspense,{fallback:i.a.createElement("div",null)},y?i.a.createElement(z,{modalInfo:y,setModalInfo:x,session:s}):W?i.a.createElement(R,{handleClose:function(){S(void 0)},deleteDialogDetails:W,session:s}):null,L?i.a.createElement(J,{handleClose:function(){return F(!1)},breakConnection:X,session:s}):null,G?i.a.createElement(U,{handleClose:function(){return K(!1)},session:s,breakConnection:X,assemblyName:V}):null))})),Z=Object(F.observer)((function(e){var t=e.model,n=e.toolbarHeight,o=void 0===n?0:n,r=Object(l.useState)(0),c=Object(a.a)(r,2),s=c[0],d=c[1],u=Object(l.useState)(0),m=Object(a.a)(u,2),f=m[0],b=m[1],g=t.assemblyNames[s];return g?i.a.createElement(i.a.Fragment,null,i.a.createElement(Y,{model:t,setHeaderHeight:b,setAssemblyIdx:d,assemblyIdx:s}),i.a.createElement(Q,{tree:t.hierarchy(g),model:t,offset:o+f})):null}));t.default=X}}]);
//# sourceMappingURL=46.c28e1ce2.chunk.js.map