"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[3787],{63787:function(e,t,r){r.r(t),r.d(t,{default:function(){return q}});var n=r(33028),a=r(59740),c=r(34795),u=r(9249),s=r(87371),i=r(45754),o=r(86906),f=r(77162),d=r.n(f),h=r(78982),p=r(61462),l=r(29598),v=r(33528),g=r(26131),b=r(14956),m=r(91750),k=r(84040),y=r(9077),w=r(59917),S=["fields"],Z=["chromStart","chromEnd","chrom"];function _(e){return e.get("thickStart")&&e.get("blockCount")&&0!==e.get("strand")}var q=function(e){(0,i.Z)(r,e);var t=(0,o.Z)(r);function r(){var e;(0,u.Z)(this,r);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).cached=void 0,e}return(0,s.Z)(r,[{key:"configurePre",value:function(){var e=(0,c.Z)(d().mark((function e(t){var r,n,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new h.Q({filehandle:(0,v.openLocation)((0,y.readConfObject)(this.config,"bigBedLocation"),this.pluginManager)}),e.next=3,r.getHeader(t);case 3:return n=e.sent,a=new p.Z({autoSql:n.autoSql}),e.abrupt("return",{bigbed:r,header:n,parser:a});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"configure",value:function(){var e=(0,c.Z)(d().mark((function e(t){var r=this;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.cached||(this.cached=this.configurePre(t).catch((function(e){throw r.cached=void 0,e}))),e.abrupt("return",this.cached);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRefNames",value:function(){var e=(0,c.Z)(d().mark((function e(t){var r,n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.configure(t);case 2:return r=e.sent,n=r.header,e.abrupt("return",Object.keys(n.refsByName));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getHeader",value:function(){var e=(0,c.Z)(d().mark((function e(t){var r,c,u,s,i,o,f,h;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.configure(t);case 2:return r=e.sent,c=r.parser,u=r.header,s=u.version,i=u.fileType,o=c.autoSql,f=o.fields,h=(0,a.Z)(o,S),e.abrupt("return",{version:s,fileType:i,autoSql:(0,n.Z)({},h),fields:Object.fromEntries(f.map((function(e){return[e.name,e.comment]})))});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getFeatures",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=e.refName,s=e.start,i=e.end,o=r.signal;return(0,g.ObservableCreate)(function(){var e=(0,c.Z)(d().mark((function e(c){var f,h,p;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.configure(r);case 3:return f=e.sent,h=f.parser,p=f.bigbed,e.next=8,p.getFeatureStream(u,s,i,{signal:o,basesPerSpan:i-s});case 8:e.sent.pipe((0,m.J)(),(0,k.U)((function(e){var r=h.parseLine("".concat(u,"\t").concat(e.start,"\t").concat(e.end,"\t").concat(e.rest),{uniqueId:e.uniqueId}),c=r.blockCount,s=r.blockSizes,i=r.blockStarts,o=r.chromStarts;if(c){var f=o||i||[],d=s,p=e.start;r.subfeatures=[];for(var l=0;l<c;l+=1){var v=(f[l]||0)+p,g=v+(d[l]||0);r.subfeatures.push({uniqueId:"".concat(e.uniqueId,"-").concat(l),start:v,end:g,type:"block"})}}if(void 0===e.uniqueId)throw new Error("invalid bbi feature");r.chromStart,r.chromEnd,r.chrom;var m=(0,a.Z)(r,Z),k=new b.Z({id:"".concat(t.id,"-").concat(e.uniqueId),data:(0,n.Z)((0,n.Z)({},m),{},{start:e.start,end:e.end,refName:u})});return _(k)?(0,w.d)(k):k}))).subscribe(c),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),c.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),r.signal)}},{key:"freeResources",value:function(){}}]),r}(l.BaseFeatureDataAdapter)},59917:function(e,t,r){r.d(t,{d:function(){return a}});var n=r(14956);function a(e){var t=e.children(),r=e.get("thickStart"),a=e.get("thickEnd");if(!r&&!a)return e;var c=t?t.filter((function(e){return"block"===e.get("type")})).sort((function(e,t){return e.get("start")-t.get("start")})):[],u=[];c.forEach((function(t){var n=t.get("start"),c=t.get("end");if(r>=c){var s=e.get("strand")>0?"five":"three";u.push({type:"".concat(s,"_prime_UTR"),start:n,end:c})}else if(r>n&&r<c&&a>=c){var i=e.get("strand")>0?"five":"three";u.push({type:"".concat(i,"_prime_UTR"),start:n,end:r},{type:"CDS",start:r,end:c})}else if(r<=n&&a>=c)u.push({type:"CDS",start:n,end:c});else if(r>n&&r<c&&a<c){var o=e.get("strand")>0?"five":"three",f=e.get("strand")>0?"three":"five";u.push({type:"".concat(o,"_prime_UTR"),start:n,end:r},{type:"CDS",start:r,end:a},{type:"".concat(f,"_prime_UTR"),start:a,end:c})}else if(r<=n&&a>n&&a<c){var d=e.get("strand")>0?"three":"five";u.push({type:"CDS",start:n,end:a},{type:"".concat(d,"_prime_UTR"),start:a,end:c})}else if(a<=n){var h=e.get("strand")>0?"three":"five";u.push({type:"".concat(h,"_prime_UTR"),start:n,end:c})}}));var s={};return e.tags().forEach((function(t){s[t]=e.get(t)})),s.subfeatures=u,s.type="mRNA",s.uniqueId=e.id(),delete s.chromStarts,delete s.chromStart,delete s.chromEnd,delete s.chrom,delete s.blockStarts,delete s.blockSizes,delete s.blockCount,delete s.thickStart,delete s.thickEnd,new n.Z({data:s,id:e.id()})}}}]);
//# sourceMappingURL=3787.227771b3.chunk.js.map