{"version":3,"file":"static/js/26.7b03bba6.chunk.js","mappings":"0MAoBe,MAAMA,UAA0BC,EAAAA,uBAG7CC,WAAAA,CACEC,EACAC,EACAC,GAEAC,MAAMH,EAAMC,EAAeC,GAC3B,MAAME,GAAQC,EAAAA,EAAAA,gBAAeL,EAAM,YACnCM,KAAKC,SAAWV,EAAkBW,aAAaJ,GAAS,GAC1D,CAEA,mBAAOI,CAAaC,GAClB,MAAMF,EAAW,IAAIG,IACrB,IAAK,MAAMC,KAASF,EAClB,GAAIE,EAAO,CACT,MAAMC,EAAIN,KAAKO,YAAYF,GACrBG,EAAUF,EAAEG,IAAI,WACtB,IAAIC,EAAST,EAASQ,IAAID,GACrBE,IACHA,EAAS,GACTT,EAASU,IAAIH,EAASE,IAGxBA,EAAOE,KAAKN,EACd,CAIF,IAAK,MAAMO,KAAeZ,EAASa,SACjCD,EAAYE,MAAK,CAACC,EAAGC,IAAMD,EAAEP,IAAI,SAAWQ,EAAER,IAAI,WAGpD,OAAOR,CACT,CAEA,kBAAOM,CAAYW,GACjB,OAAO,IAAIC,EAAAA,EAAcD,EAC3B,CAEA,iBAAME,GACJ,MAAO,IAAIpB,KAAKC,SAASoB,OAC3B,CAEA,uBAAMC,GACJ,MAAO,IAAItB,KAAKC,SAASa,UAAUS,KAAIC,IAAgB,CACrDhB,QAASgB,EAAa,GAAGf,IAAI,WAC7BgB,QAASD,EAAa,GAAGf,IAAI,cAEjC,CAEAiB,WAAAA,CAAYC,GACV,MAAM,QAAEnB,EAAO,MAAEoB,EAAK,IAAEC,GAAQF,EAEhC,OAAOG,EAAAA,EAAAA,mBAA0BC,UAC/B,MAAM9B,EAAWD,KAAKC,SAASQ,IAAID,IAAY,GAC/C,IAAK,MAAMF,KAAKL,EACVK,EAAEG,IAAI,OAASmB,GAAStB,EAAEG,IAAI,SAAWoB,GAC3CG,EAASC,KAAK3B,GAGlB0B,EAASE,UAAU,GAEvB,CAEAC,aAAAA,GAAuC,E,qFChE1B,MAAMC,UACXC,EAAAA,YAKR5C,WAAAA,CACE6C,EACA3C,EACAC,GAEAC,MAAMyC,EAAQ3C,EAAeC,GAC7B,MAAMK,GAAWF,EAAAA,EAAAA,gBACfuC,EACA,YAEFtC,KAAKC,SAAWV,EAAAA,QAAkBW,aAAaD,GAAY,GAC7D,CAKA,gBAAMsC,GACJ,MAAMC,EAAU,GAGhB,IAAK,MAAOhC,EAASP,KAAaD,KAAKC,SAAU,CAC/C,IAAIwC,EACJ,IAAK,MAAMC,KAAWzC,EAElBwC,GACAA,EAAcZ,KAAOa,EAAQjC,IAAI,UACjCgC,EAAcb,OAASc,EAAQjC,IAAI,OAEnCgC,EAAcZ,IAAMa,EAAQjC,IAAI,QAE5BgC,GACFD,EAAQ5B,KAAK6B,GAEfA,EAAgB,CACdjC,UACAoB,MAAOc,EAAQjC,IAAI,SACnBoB,IAAKa,EAAQjC,IAAI,SAInBgC,GACFD,EAAQ5B,KAAK6B,EAEjB,CAKA,OAFAD,EAAQzB,MAAK,CAACC,EAAGC,IAAMD,EAAER,QAAQmC,cAAc1B,EAAET,WAE1CgC,CACT,CAEAL,aAAAA,GAAuC,E","sources":["../../../plugins/config/src/FromConfigAdapter/FromConfigAdapter.ts","../../../plugins/config/src/FromConfigRegionsAdapter/FromConfigRegionsAdapter.ts"],"sourcesContent":["import { BaseFeatureDataAdapter } from '@jbrowse/core/data_adapters/BaseAdapter'\nimport SimpleFeature, {\n  Feature,\n  SimpleFeatureSerialized,\n} from '@jbrowse/core/util/simpleFeature'\nimport { ObservableCreate } from '@jbrowse/core/util/rxjs'\nimport { NoAssemblyRegion } from '@jbrowse/core/util/types'\nimport {\n  AnyConfigurationModel,\n  readConfObject,\n} from '@jbrowse/core/configuration'\nimport PluginManager from '@jbrowse/core/PluginManager'\nimport { getSubAdapterType } from '@jbrowse/core/data_adapters/dataAdapterCache'\n\n/**\n * Adapter that just returns the features defined in its `features` configuration\n * key, like:\n *   `\"features\": [ { \"refName\": \"ctgA\", \"start\":1, \"end\":20 }, ... ]`\n */\n\nexport default class FromConfigAdapter extends BaseFeatureDataAdapter {\n  protected features: Map<string, Feature[]>\n\n  constructor(\n    conf: AnyConfigurationModel,\n    getSubAdapter?: getSubAdapterType,\n    pluginManager?: PluginManager,\n  ) {\n    super(conf, getSubAdapter, pluginManager)\n    const feats = readConfObject(conf, 'features') as SimpleFeatureSerialized[]\n    this.features = FromConfigAdapter.makeFeatures(feats || [])\n  }\n\n  static makeFeatures(fdata: SimpleFeatureSerialized[]) {\n    const features = new Map<string, Feature[]>()\n    for (const entry of fdata) {\n      if (entry) {\n        const f = this.makeFeature(entry)\n        const refName = f.get('refName') as string\n        let bucket = features.get(refName)\n        if (!bucket) {\n          bucket = []\n          features.set(refName, bucket)\n        }\n\n        bucket.push(f)\n      }\n    }\n\n    // sort the features on each reference sequence by start coordinate\n    for (const refFeatures of features.values()) {\n      refFeatures.sort((a, b) => a.get('start') - b.get('start'))\n    }\n\n    return features\n  }\n\n  static makeFeature(data: SimpleFeatureSerialized) {\n    return new SimpleFeature(data)\n  }\n\n  async getRefNames() {\n    return [...this.features.keys()]\n  }\n\n  async getRefNameAliases() {\n    return [...this.features.values()].map(featureArray => ({\n      refName: featureArray[0].get('refName'),\n      aliases: featureArray[0].get('aliases'),\n    }))\n  }\n\n  getFeatures(region: NoAssemblyRegion) {\n    const { refName, start, end } = region\n\n    return ObservableCreate<Feature>(async observer => {\n      const features = this.features.get(refName) || []\n      for (const f of features) {\n        if (f.get('end') > start && f.get('start') < end) {\n          observer.next(f)\n        }\n      }\n      observer.complete()\n    })\n  }\n\n  freeResources(/* { region } */): void {}\n}\n","import {\n  BaseAdapter,\n  RegionsAdapter,\n} from '@jbrowse/core/data_adapters/BaseAdapter'\nimport {\n  Feature,\n  SimpleFeatureSerialized,\n} from '@jbrowse/core/util/simpleFeature'\nimport {\n  AnyConfigurationModel,\n  readConfObject,\n} from '@jbrowse/core/configuration'\nimport PluginManager from '@jbrowse/core/PluginManager'\nimport { getSubAdapterType } from '@jbrowse/core/data_adapters/dataAdapterCache'\n\nimport FromConfigAdapter from '../FromConfigAdapter/FromConfigAdapter'\n\n/**\n * Adapter that just returns the features defined in its `features` configuration\n * key, like:\n *   `\"features\": [ { \"refName\": \"ctgA\", \"start\":1, \"end\":20 }, ... ]`\n */\nexport default class FromConfigRegionsAdapter\n  extends BaseAdapter\n  implements RegionsAdapter\n{\n  private features: Map<string, Feature[]>\n\n  constructor(\n    config: AnyConfigurationModel,\n    getSubAdapter?: getSubAdapterType,\n    pluginManager?: PluginManager,\n  ) {\n    super(config, getSubAdapter, pluginManager)\n    const features = readConfObject(\n      config,\n      'features',\n    ) as SimpleFeatureSerialized[]\n    this.features = FromConfigAdapter.makeFeatures(features || [])\n  }\n\n  /**\n   * Get refName, start, and end for all features after collapsing any overlaps\n   */\n  async getRegions() {\n    const regions = []\n\n    // recall: features are stored in this object sorted by start coordinate\n    for (const [refName, features] of this.features) {\n      let currentRegion\n      for (const feature of features) {\n        if (\n          currentRegion &&\n          currentRegion.end >= feature.get('start') &&\n          currentRegion.start <= feature.get('end')\n        ) {\n          currentRegion.end = feature.get('end')\n        } else {\n          if (currentRegion) {\n            regions.push(currentRegion)\n          }\n          currentRegion = {\n            refName,\n            start: feature.get('start'),\n            end: feature.get('end'),\n          }\n        }\n      }\n      if (currentRegion) {\n        regions.push(currentRegion)\n      }\n    }\n\n    // sort the regions by refName\n    regions.sort((a, b) => a.refName.localeCompare(b.refName))\n\n    return regions\n  }\n\n  freeResources(/* { region } */): void {}\n}\n"],"names":["FromConfigAdapter","BaseFeatureDataAdapter","constructor","conf","getSubAdapter","pluginManager","super","feats","readConfObject","this","features","makeFeatures","fdata","Map","entry","f","makeFeature","refName","get","bucket","set","push","refFeatures","values","sort","a","b","data","SimpleFeature","getRefNames","keys","getRefNameAliases","map","featureArray","aliases","getFeatures","region","start","end","ObservableCreate","async","observer","next","complete","freeResources","FromConfigRegionsAdapter","BaseAdapter","config","getRegions","regions","currentRegion","feature","localeCompare"],"sourceRoot":""}