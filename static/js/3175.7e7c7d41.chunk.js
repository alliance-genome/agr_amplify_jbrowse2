"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[3175],{3175:function(e,n,t){t.r(n),t.d(n,{default:function(){return J}});var r=t(32723),a=t(96234),o=t(34795),c=t(96902),i=t(52809),s=t(35388),u=t(13655),l=t(2868),f=t(99782),d=t(80367),p=t(12221),m=t(66519),g=t(99688),v=t(44536),Z=t(91188),h=t(64837),y=t(4782),x=t(46186),b=t(97531),C=t(99836),j=t(14393),k=t(68079),S=["uniqueId","refName","source","type","start","end","strand","parent","parentId","score","subfeatures","phase"],w={id:"ID",name:"Name",alias:"Alias",parent:"Parent",target:"Target",gap:"Gap",derives_from:"Derives_from",note:"Note",description:"Note",dbxref:"Dbxref",ontology_term:"Ontology_term",is_circular:"Is_circular"};function N(e){return Array.isArray(e)?e.map((function(e){return N(e)})).join(","):"object"===typeof e?JSON.stringify(e):"".concat(e)}function R(e,n,t){var r,a=t||e.get("refName"),o=e.get("id"),c=function(e,n,t){return[e.get("refName")||t,e.get("source")||".",e.get("type")||".",e.get("start")+1,e.get("end"),e.get("score")||".",e.get("strand")||".",e.get("phase")||".",(n?"Parent=".concat(n,";"):"")+e.tags().filter((function(e){return!S.includes(e)})).map((function(n){return[n,N(e.get(n))]})).filter((function(e){return!!e[1]})).map((function(e){return"".concat(w[e[0]]||e[0],"=").concat(e[1])})).join(";")].join("\t")}(e,n,a),i=(null===(r=e.get("subfeatures"))||void 0===r?void 0:r.map((function(e){return R(e,o,a)})))||[];return[c].concat((0,k.Z)(i)).join("\n")}var I=t(33028),E=["uniqueId","refName","source","type","start","end","strand","parent","parentId","score","subfeatures","phase"],F="                     ",z={name:"Name"};function _(e){return Array.isArray(e)?e.map((function(e){return _(e)})).join(","):"object"===typeof e?JSON.stringify(e):"".concat(e)}function M(e,n){return"".concat(function(e,n){return e.get("start")-n+1}(e,n),"..").concat(function(e,n){return e.get("end")-n}(e,n))}function O(e,n,t,r){var a="".concat(e.get("type")).slice(0,16),o=M(e,n),c=-1===e.get("strand")?"complement(".concat(o,")"):o;return["     ".concat(a.padEnd(16)).concat(c)].concat((0,k.Z)(function(e,n,t){return[n&&t?"".concat(F,"/").concat(t,'="').concat(n,'"'):"",e.get("id")?"".concat(F,"/name=").concat(e.get("id")):""].concat((0,k.Z)(e.tags().filter((function(e){return!E.includes(e)})).map((function(n){return[n,_(e.get(n))]})).filter((function(e){return!!e[1]&&e[0]!==t})).map((function(e){return"".concat(F,"/").concat(z[e[0]]||e[0],'="').concat(e[1],'"')})))).filter((function(e){return!!e}))}(e,t,r)))}function A(e,n,t,r){var a=O(e,n,t,r),o=e.get("subfeatures")||[],c=o.filter((function(e){return"CDS"===e.get("type")})),i=o.filter((function(e){return"CDS"!==e.get("type")&&"exon"!==e.get("type")})),s=e.get("id"),u=e.get("type"),l=e.get("strand");return[].concat((0,k.Z)(a),(0,k.Z)(function(e,n,t,r,a){var o=e.map((function(e){return M(e,a)})),c="join(".concat(o,")"),i=-1===r?"complement(".concat(c,")"):c;return e.length?["     ".concat("CDS".padEnd(16)).concat(i),"".concat(F,"/").concat(t,'="').concat(n,'"')]:[]}(c,s,u,l,n)),(0,k.Z)(i.map((function(e){return A(e,n,s,u)})).flat())).join("\n")}function D(e){return P.apply(this,arguments)}function P(){return(P=(0,o.Z)((0,r.Z)().mark((function e(n){var t,a,o,c,i,s,u,l,f,d,p,m,g,v,Z,h,y,x;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.features,a=n.assemblyName,o=n.session,c=new Date,i=c.toLocaleString("en-US",{month:"short"}).toUpperCase(),s=c.toLocaleString("en-US",{day:"numeric"}),u=c.toLocaleString("en-US",{year:"numeric"}),l="".concat(s,"-").concat(i,"-").concat(u),f=(0,b.min)(t.map((function(e){return e.get("start")}))),d=(0,b.max)(t.map((function(e){return e.get("end")}))),p=d-f,m=t[0].get("refName"),g=["".concat("LOCUS".padEnd(12)),"".concat(m,":").concat(f+1,"..").concat(d).padEnd(20)," ".concat("".concat(p," bp")).padEnd(15)," ".concat("DNA".padEnd(10)),"".concat("linear".padEnd(10)),"".concat("UNK "+l)].join(""),v="FEATURES             Location/Qualifiers",e.next=14,q({session:o,assemblyName:a,regions:[{assemblyName:a,start:f,end:d,refName:m}]});case 14:return Z=e.sent,h=Z.map((function(e){return e.get("seq")||""})).join(""),y=t.map((function(e){return A(e,f)})),x=["ORIGIN","\t1 ".concat(h),"//"],e.abrupt("return",[g,v].concat((0,k.Z)(y),x).join("\n"));case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e){return B.apply(this,arguments)}function B(){return(B=(0,o.Z)((0,r.Z)().mark((function e(n){var t,a,o,c,i,s,u,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.session,a=n.regions,o=n.signal,c=n.assemblyName,i=t.rpcManager,s=t.assemblyManager,u=s.get(c)){e.next=5;break}throw new Error("assembly ".concat(c," not found"));case 5:return l="getSequence",e.abrupt("return",i.call(l,"CoreGetFeatures",{adapterConfig:(0,C.getConf)(u,["sequence","adapter"]),regions:a.map((function(e){return(0,I.Z)((0,I.Z)({},e),{},{refName:u.getCanonicalRefName(e.refName)})})),sessionId:l,signal:o}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var U=t(29938),G=(0,Z.ZL)()({root:{width:"80em"},textAreaFont:{fontFamily:"Courier New"}});function L(e,n,t){return V.apply(this,arguments)}function V(){return(V=(0,o.Z)((0,r.Z)().mark((function e(n,t,a){var o,c,i,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,b.getSession)(n),c=o.rpcManager,i=(0,C.getConf)(n,["adapter"]),s="getFeatures",e.abrupt("return",c.call(s,"CoreGetFeatures",{adapterConfig:i,regions:t,sessionId:s,signal:a}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var J=(0,y.observer)((function(e){var n=e.model,t=e.handleClose,Z=G().classes,y=(0,c.useState)(),C=(0,a.Z)(y,2),S=C[0],w=C[1],N=(0,c.useState)(),I=(0,a.Z)(N,2),E=I[0],F=I[1],z=(0,c.useState)("gff3"),_=(0,a.Z)(z,2),M=_[0],O=_[1],A=(0,c.useState)(""),P=(0,a.Z)(A,2),q=P[0],B=P[1],V={gff3:{name:"GFF3",extension:"gff3"},genbank:{name:"GenBank",extension:"genbank"}};return(0,c.useEffect)((function(){(0,o.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=(0,b.getContainingView)(n),w(void 0),e.t0=F,e.next=6,L(n,t.dynamicBlocks.contentBlocks);case 6:e.t1=e.sent,(0,e.t0)(e.t1),e.next=14;break;case 10:e.prev=10,e.t2=e.catch(0),console.error(e.t2),w(e.t2);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))()}),[n]),(0,c.useEffect)((function(){(0,o.Z)((0,r.Z)().mark((function e(){var t,a,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,b.getContainingView)(n),a=(0,b.getSession)(n),E){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,"gff3"===M?(r=E,["##gff-version 3"].concat((0,k.Z)(r.map((function(e){return R(e)})))).join("\n")):D({features:E,session:a,assemblyName:t.dynamicBlocks.contentBlocks[0].assemblyName});case 6:o=e.sent,B(o);case 8:case"end":return e.stop()}var r}),e)})))()}),[M,E,n]),(0,U.jsxs)(x.Dialog,{maxWidth:"xl",open:!0,onClose:t,title:"Save track data",children:[(0,U.jsxs)(i.Z,{className:Z.root,children:[S?(0,U.jsx)(x.ErrorMessage,{error:S}):null,E?E.length?null:(0,U.jsx)(s.Z,{children:"No features found"}):(0,U.jsx)(x.LoadingEllipses,{}),(0,U.jsxs)(u.Z,{children:[(0,U.jsx)(l.Z,{children:"File type"}),(0,U.jsx)(f.Z,{value:M,onChange:function(e){return O(e.target.value)},children:Object.entries(V).map((function(e){var n=(0,a.Z)(e,2),t=n[0],r=n[1];return(0,U.jsx)(d.Z,{value:t,control:(0,U.jsx)(p.Z,{}),label:r.name},t)}))})]}),(0,U.jsx)(m.Z,{variant:"outlined",multiline:!0,minRows:5,maxRows:15,fullWidth:!0,value:q,InputProps:{readOnly:!0,classes:{input:Z.textAreaFont}}})]}),(0,U.jsxs)(g.Z,{children:[(0,U.jsx)(v.Z,{onClick:function(){(0,h.saveAs)(new Blob([q||""],{type:"text/plain;charset=utf-8"}),"jbrowse_track_data.".concat(V[M].extension))},disabled:!q||!!S,startIcon:(0,U.jsx)(j.Z,{}),children:"Download"}),(0,U.jsx)(v.Z,{variant:"contained",type:"submit",onClick:function(){return t()},children:"Close"})]})]})}))},12221:function(e,n,t){t.d(n,{Z:function(){return I}});var r=t(56666),a=t(31461),o=t(7896),c=t(96902),i=t(24463),s=t(73674),u=t(16644),l=t(95790),f=t(53068),d=t(30992),p=t(29938),m=(0,d.Z)((0,p.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUnchecked"),g=(0,d.Z)((0,p.jsx)("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"}),"RadioButtonChecked"),v=t(2252),Z=(0,v.ZP)("span")({position:"relative",display:"flex"}),h=(0,v.ZP)(m)({transform:"scale(1)"}),y=(0,v.ZP)(g)((function(e){var n=e.theme,t=e.ownerState;return(0,o.Z)({left:0,position:"absolute",transform:"scale(0)",transition:n.transitions.create("transform",{easing:n.transitions.easing.easeIn,duration:n.transitions.duration.shortest})},t.checked&&{transform:"scale(1)",transition:n.transitions.create("transform",{easing:n.transitions.easing.easeOut,duration:n.transitions.duration.shortest})})}));var x=function(e){var n=e.checked,t=void 0!==n&&n,r=e.classes,a=void 0===r?{}:r,c=e.fontSize,i=(0,o.Z)({},e,{checked:t});return(0,p.jsxs)(Z,{className:a.root,ownerState:i,children:[(0,p.jsx)(h,{fontSize:c,className:a.background,ownerState:i}),(0,p.jsx)(y,{fontSize:c,className:a.dot,ownerState:i})]})},b=t(70378),C=t(69491),j=t(63838),k=t(17318),S=["checked","checkedIcon","color","icon","name","onChange","size","className"],w=(0,v.ZP)(l.Z,{shouldForwardProp:function(e){return(0,v.FO)(e)||"classes"===e},name:"MuiRadio",slot:"Root",overridesResolver:function(e,n){var t=e.ownerState;return[n.root,n["color".concat((0,b.Z)(t.color))]]}})((function(e){var n=e.theme,t=e.ownerState;return(0,o.Z)({color:(n.vars||n).palette.text.secondary},!t.disableRipple&&{"&:hover":{backgroundColor:n.vars?"rgba(".concat("default"===t.color?n.vars.palette.action.activeChannel:n.vars.palette[t.color].mainChannel," / ").concat(n.vars.palette.action.hoverOpacity,")"):(0,u.Fq)("default"===t.color?n.palette.action.active:n.palette[t.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==t.color&&(0,r.Z)({},"&.".concat(k.Z.checked),{color:(n.vars||n).palette[t.color].main}),(0,r.Z)({},"&.".concat(k.Z.disabled),{color:(n.vars||n).palette.action.disabled}))}));var N=(0,p.jsx)(x,{checked:!0}),R=(0,p.jsx)(x,{}),I=c.forwardRef((function(e,n){var t,r,u,l,d=(0,f.Z)({props:e,name:"MuiRadio"}),m=d.checked,g=d.checkedIcon,v=void 0===g?N:g,Z=d.color,h=void 0===Z?"primary":Z,y=d.icon,x=void 0===y?R:y,I=d.name,E=d.onChange,F=d.size,z=void 0===F?"medium":F,_=d.className,M=(0,a.Z)(d,S),O=(0,o.Z)({},d,{color:h,size:z}),A=function(e){var n=e.classes,t=e.color,r={root:["root","color".concat((0,b.Z)(t))]};return(0,o.Z)({},n,(0,s.Z)(r,k.l,n))}(O),D=(0,j.Z)(),P=m,q=(0,C.Z)(E,D&&D.onChange),B=I;return D&&("undefined"===typeof P&&(u=D.value,P="object"===typeof(l=d.value)&&null!==l?u===l:String(u)===String(l)),"undefined"===typeof B&&(B=D.name)),(0,p.jsx)(w,(0,o.Z)({type:"radio",icon:c.cloneElement(x,{fontSize:null!=(t=R.props.fontSize)?t:z}),checkedIcon:c.cloneElement(v,{fontSize:null!=(r=N.props.fontSize)?r:z}),ownerState:O,classes:A,name:B,checked:P,onChange:q,ref:n,className:(0,i.default)(A.root,_)},M))}))},17318:function(e,n,t){t.d(n,{l:function(){return o}});var r=t(74732),a=t(61235);function o(e){return(0,a.Z)("MuiRadio",e)}var c=(0,r.Z)("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary"]);n.Z=c},99782:function(e,n,t){var r=t(96234),a=t(7896),o=t(31461),c=t(96902),i=t(52),s=t(22756),u=t(48962),l=t(39809),f=t(14989),d=t(29938),p=["actions","children","defaultValue","name","onChange","value"],m=c.forwardRef((function(e,n){var t=e.actions,m=e.children,g=e.defaultValue,v=e.name,Z=e.onChange,h=e.value,y=(0,o.Z)(e,p),x=c.useRef(null),b=(0,u.Z)({controlled:h,default:g,name:"RadioGroup"}),C=(0,r.Z)(b,2),j=C[0],k=C[1];c.useImperativeHandle(t,(function(){return{focus:function(){var e=x.current.querySelector("input:not(:disabled):checked");e||(e=x.current.querySelector("input:not(:disabled)")),e&&e.focus()}}}),[]);var S=(0,s.Z)(n,x),w=(0,f.Z)(v),N=c.useMemo((function(){return{name:w,onChange:function(e){k(e.target.value),Z&&Z(e,e.target.value)},value:j}}),[w,Z,k,j]);return(0,d.jsx)(l.Z.Provider,{value:N,children:(0,d.jsx)(i.Z,(0,a.Z)({role:"radiogroup",ref:S},y,{children:m}))})}));n.Z=m},39809:function(e,n,t){var r=t(96902).createContext(void 0);n.Z=r},63838:function(e,n,t){t.d(n,{Z:function(){return o}});var r=t(96902),a=t(39809);function o(){return r.useContext(a.Z)}}}]);
//# sourceMappingURL=3175.7e7c7d41.chunk.js.map