"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[3653],{53653:function(e,t,r){r.r(t),r.d(t,{default:function(){return k}});var n=r(33028),a=r(34795),s=r(9249),u=r(87371),c=r(45754),i=r(86906),o=r(77162),d=r.n(o),l=r(61462),f=r(29598),p=r(33528),h=r(26131),v=r(14956),m=r(44061),b=r(9077),g=r(59917),k=function(e){(0,c.Z)(r,e);var t=(0,i.Z)(r);function r(e,n,a){var u;(0,s.Z)(this,r),(u=t.call(this,e,n,a)).parser=void 0,u.bed=void 0,u.columnNames=void 0,u.scoreColumn=void 0;var c=(0,b.readConfObject)(e,"bedGzLocation"),i=(0,b.readConfObject)(e,"index"),o=(0,b.readConfObject)(e,"autoSql"),d=i.location,f=i.indexType;return u.bed=new m.TabixIndexedFile({filehandle:(0,p.openLocation)(c,u.pluginManager),csiFilehandle:"CSI"===f?(0,p.openLocation)(d,u.pluginManager):void 0,tbiFilehandle:"CSI"!==f?(0,p.openLocation)(d,u.pluginManager):void 0,chunkCacheSize:50*Math.pow(2,20)}),u.columnNames=(0,b.readConfObject)(e,"columnNames"),u.scoreColumn=(0,b.readConfObject)(e,"scoreColumn"),u.parser=new l.Z({autoSql:o}),u}return(0,u.Z)(r,[{key:"getRefNames",value:function(){var e=(0,a.Z)(d().mark((function e(){var t,r=arguments;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:{},e.abrupt("return",this.bed.getReferenceSequenceNames(t));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeader",value:function(){var e=(0,a.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.bed.getHeader());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"defaultParser",value:function(e,t){return Object.fromEntries(t.split("\t").map((function(t,r){return[e[r],t]})))}},{key:"getNames",value:function(){var e=(0,a.Z)(d().mark((function e(){var t,r,n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.columnNames.length){e.next=2;break}return e.abrupt("return",this.columnNames);case 2:return e.next=4,this.bed.getHeader();case 4:return t=e.sent,r=t.split("\n").filter((function(e){return!!e})),n=r[r.length-1],e.abrupt("return",n&&n.includes("\t")?n.slice(1).split("\t").map((function(e){return e.trim()})):null);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getFeatures",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,h.ObservableCreate)(function(){var s=(0,a.Z)(d().mark((function a(s){var u,c,i,o,l,f,p;return d().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.bed.getMetadata();case 2:return u=a.sent,c=u.columnNumbers,i=c.ref-1,o=c.start-1,l=c.end-1,f=o===l?1:0,a.next=10,t.getNames();case 10:return p=a.sent,a.next=13,t.bed.getLines(e.refName,e.start,e.end,{lineCallback:function(e,r){var a=e.split("\t"),u=a[i],c=+a[o],d=+a[l]+f,h="".concat(t.id,"-").concat(r),m=p?t.defaultParser(p,e):t.parser.parseLine(e,{uniqueId:h}),b=m.blockCount,k=m.blockSizes,y=m.blockStarts,C=m.chromStarts;if(b){var S=C||y||[],w=k,_=c;m.subfeatures=[];for(var x=0;x<b;x+=1){var N=(S[x]||0)+_,Z=N+(w[x]||0);m.subfeatures.push({uniqueId:"".concat(h,"-").concat(x),start:N,end:Z,type:"block"})}}t.scoreColumn&&(m.score=+m[t.scoreColumn]),delete m.chrom,delete m.chromStart,delete m.chromEnd;var R=new v.Z((0,n.Z)((0,n.Z)({},m),{},{start:c,end:d,refName:u,uniqueId:h})),j=R.get("thickStart")?(0,g.d)(R):R;s.next(j)},signal:r.signal});case 13:s.complete();case 14:case"end":return a.stop()}}),a)})));return function(e){return s.apply(this,arguments)}}(),r.signal)}},{key:"freeResources",value:function(){}}]),r}(f.BaseFeatureDataAdapter);k.capabilities=["getFeatures","getRefNames"]},59917:function(e,t,r){r.d(t,{d:function(){return a}});var n=r(14956);function a(e){var t=e.children(),r=e.get("thickStart"),a=e.get("thickEnd");if(!r&&!a)return e;var s=t?t.filter((function(e){return"block"===e.get("type")})).sort((function(e,t){return e.get("start")-t.get("start")})):[],u=[];s.forEach((function(t){var n=t.get("start"),s=t.get("end");if(r>=s){var c=e.get("strand")>0?"five":"three";u.push({type:"".concat(c,"_prime_UTR"),start:n,end:s})}else if(r>n&&r<s&&a>=s){var i=e.get("strand")>0?"five":"three";u.push({type:"".concat(i,"_prime_UTR"),start:n,end:r},{type:"CDS",start:r,end:s})}else if(r<=n&&a>=s)u.push({type:"CDS",start:n,end:s});else if(r>n&&r<s&&a<s){var o=e.get("strand")>0?"five":"three",d=e.get("strand")>0?"three":"five";u.push({type:"".concat(o,"_prime_UTR"),start:n,end:r},{type:"CDS",start:r,end:a},{type:"".concat(d,"_prime_UTR"),start:a,end:s})}else if(r<=n&&a>n&&a<s){var l=e.get("strand")>0?"three":"five";u.push({type:"CDS",start:n,end:a},{type:"".concat(l,"_prime_UTR"),start:a,end:s})}else if(a<=n){var f=e.get("strand")>0?"three":"five";u.push({type:"".concat(f,"_prime_UTR"),start:n,end:s})}}));var c={};return e.tags().forEach((function(t){c[t]=e.get(t)})),c.subfeatures=u,c.type="mRNA",c.uniqueId=e.id(),delete c.chromStarts,delete c.chromStart,delete c.chromEnd,delete c.chrom,delete c.blockStarts,delete c.blockSizes,delete c.blockCount,delete c.thickStart,delete c.thickEnd,new n.Z({data:c,id:e.id()})}}}]);
//# sourceMappingURL=3653.0ed7d197.chunk.js.map