"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[5021,9101],{9101:function(e,n,t){t.r(n),t.d(n,{ColorPicker:function(){return F},ColorPopover:function(){return X},PopoverPicker:function(){return G},default:function(){return V}});var r=t(96234),o=t(30969),a=t(8218),l=t.n(a),c=t(86317),i=t(89003),u=t(28712),s=t(35436),f=t(2374),d=t(94069),h=t(81073);function v(){return(v=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}function g(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n.indexOf(t=a[r])>=0||(o[t]=e[t]);return o}function m(e){var n=(0,o.useRef)(e),t=(0,o.useRef)((function(e){n.current&&n.current(e)}));return n.current=e,t.current}var p=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e>t?t:e<n?n:e},x=function(e){return"touches"in e},b=function(e){return e&&e.ownerDocument.defaultView||self},C=function(e,n,t){var r=e.getBoundingClientRect(),o=x(n)?function(e,n){for(var t=0;t<e.length;t++)if(e[t].identifier===n)return e[t];return e[0]}(n.touches,t):n;return{left:p((o.pageX-(r.left+b(e).pageXOffset))/r.width),top:p((o.pageY-(r.top+b(e).pageYOffset))/r.height)}},j=function(e){!x(e)&&e.preventDefault()},_=o.memo((function(e){var n=e.onMove,t=e.onKey,a=g(e,["onMove","onKey"]),l=(0,o.useRef)(null),c=m(n),i=m(t),u=(0,o.useRef)(null),s=(0,o.useRef)(!1),f=(0,o.useMemo)((function(){var e=function(e){j(e),(x(e)?e.touches.length>0:e.buttons>0)&&l.current?c(C(l.current,e,u.current)):t(!1)},n=function(){return t(!1)};function t(t){var r=s.current,o=b(l.current),a=t?o.addEventListener:o.removeEventListener;a(r?"touchmove":"mousemove",e),a(r?"touchend":"mouseup",n)}return[function(e){var n=e.nativeEvent,r=l.current;if(r&&(j(n),!function(e,n){return n&&!x(e)}(n,s.current)&&r)){if(x(n)){s.current=!0;var o=n.changedTouches||[];o.length&&(u.current=o[0].identifier)}r.focus(),c(C(r,n,u.current)),t(!0)}},function(e){var n=e.which||e.keyCode;n<37||n>40||(e.preventDefault(),i({left:39===n?.05:37===n?-.05:0,top:40===n?.05:38===n?-.05:0}))},t]}),[i,c]),d=(0,r.Z)(f,3),h=d[0],p=d[1],_=d[2];return(0,o.useEffect)((function(){return _}),[_]),o.createElement("div",v({},a,{onTouchStart:h,onMouseDown:h,className:"react-colorful__interactive",ref:l,onKeyDown:p,tabIndex:0,role:"slider"}))})),w=function(e){return e.filter(Boolean).join(" ")},Z=function(e){var n=e.className,t=e.color,r=e.left,a=e.top,l=void 0===a?.5:a,c=w(["react-colorful__pointer",n]);return o.createElement("div",{className:c,style:{top:100*l+"%",left:100*r+"%"}},o.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:t}}))},k=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.pow(10,n);return Math.round(t*e)/t},y=(Math.PI,function(e){var n=e.h,t=e.s,r=e.v,o=e.a,a=(200-t)*r/100;return{h:k(n),s:k(a>0&&a<200?t*r/100/(a<=100?a:200-a)*100:0),l:k(a/2),a:k(o,2)}}),M=function(e){var n=y(e),t=n.h,r=n.s,o=n.l;return"hsl(".concat(t,", ").concat(r,"%, ").concat(o,"%)")},E=function(e){var n=y(e),t=n.h,r=n.s,o=n.l,a=n.a;return"hsla(".concat(t,", ").concat(r,"%, ").concat(o,"%, ").concat(a,")")},N=function(e){var n=e.h,t=e.s,r=e.v,o=e.a;n=n/360*6,t/=100,r/=100;var a=Math.floor(n),l=r*(1-t),c=r*(1-(n-a)*t),i=r*(1-(1-n+a)*t),u=a%6;return{r:k(255*[r,c,l,l,i,r][u]),g:k(255*[i,r,r,c,l,l][u]),b:k(255*[l,l,i,r,r,c][u]),a:k(o,2)}},S=function(e){var n=/rgba?\(?\s*(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?,?\s*[/\s]*(-?\d*\.?\d+)?(%)?\s*\)?/i.exec(e);return n?O({r:Number(n[1])/(n[2]?100/255:1),g:Number(n[3])/(n[4]?100/255:1),b:Number(n[5])/(n[6]?100/255:1),a:void 0===n[7]?1:Number(n[7])/(n[8]?100:1)}):{h:0,s:0,v:0,a:1}},O=function(e){var n=e.r,t=e.g,r=e.b,o=e.a,a=Math.max(n,t,r),l=a-Math.min(n,t,r),c=l?a===n?(t-r)/l:a===t?2+(r-n)/l:4+(n-t)/l:0;return{h:k(60*(c<0?c+6:c)),s:k(a?l/a*100:0),v:k(a/255*100),a:o}},H=o.memo((function(e){var n=e.className,t=e.hue,r=e.onChange,a=w(["react-colorful__hue",n]);return o.createElement("div",{className:a},o.createElement(_,{onMove:function(e){r({h:360*e.left})},onKey:function(e){r({h:p(t+360*e.left,0,360)})},"aria-label":"Hue","aria-valuetext":k(t)},o.createElement(Z,{className:"react-colorful__hue-pointer",left:t/360,color:M({h:t,s:100,v:100,a:1})})))})),L=o.memo((function(e){var n=e.hsva,t=e.onChange,r={backgroundColor:M({h:n.h,s:100,v:100,a:1})};return o.createElement("div",{className:"react-colorful__saturation",style:r},o.createElement(_,{onMove:function(e){t({s:100*e.left,v:100-100*e.top})},onKey:function(e){t({s:p(n.s+100*e.left,0,100),v:p(n.v-100*e.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation ".concat(k(n.s),"%, Brightness ").concat(k(n.v),"%")},o.createElement(Z,{className:"react-colorful__saturation-pointer",top:1-n.v/100,left:n.s/100,color:M(n)})))})),P=function(e,n){if(e===n)return!0;for(var t in e)if(e[t]!==n[t])return!1;return!0},T=function(e,n){return e.replace(/\s/g,"")===n.replace(/\s/g,"")};function R(e,n,t){var a=m(t),l=(0,o.useState)((function(){return e.toHsva(n)})),c=(0,r.Z)(l,2),i=c[0],u=c[1],s=(0,o.useRef)({color:n,hsva:i});(0,o.useEffect)((function(){if(!e.equal(n,s.current.color)){var t=e.toHsva(n);s.current={hsva:t,color:n},u(t)}}),[n,e]),(0,o.useEffect)((function(){var n;P(i,s.current.hsva)||e.equal(n=e.fromHsva(i),s.current.color)||(s.current={hsva:i,color:n},a(n))}),[i,e,a]);var f=(0,o.useCallback)((function(e){u((function(n){return Object.assign({},n,e)}))}),[]);return[i,f]}var z,D="undefined"!=typeof window?o.useLayoutEffect:o.useEffect,I=new Map,K=function(e){D((function(){var n=e.current?e.current.ownerDocument:document;if(void 0!==n&&!I.has(n)){var r=n.createElement("style");r.innerHTML='.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>\')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}',I.set(n,r);var o=z||t.nc;o&&r.setAttribute("nonce",o),n.head.appendChild(r)}}),[])},B=function(e){var n=e.className,t=e.hsva,r=e.onChange,a={backgroundImage:"linear-gradient(90deg, ".concat(E(Object.assign({},t,{a:0})),", ").concat(E(Object.assign({},t,{a:1})),")")},l=w(["react-colorful__alpha",n]);return o.createElement("div",{className:l},o.createElement("div",{className:"react-colorful__alpha-gradient",style:a}),o.createElement(_,{onMove:function(e){r({a:e.left})},onKey:function(e){r({a:p(t.a+e.left)})},"aria-label":"Alpha","aria-valuetext":"".concat(k(100*t.a),"%")},o.createElement(Z,{className:"react-colorful__alpha-pointer",left:t.a,color:E(t)})))},W=function(e){var n=e.className,t=e.colorModel,a=e.color,l=void 0===a?t.defaultColor:a,c=e.onChange,i=g(e,["className","colorModel","color","onChange"]),u=(0,o.useRef)(null);K(u);var s=R(t,l,c),f=(0,r.Z)(s,2),d=f[0],h=f[1],m=w(["react-colorful",n]);return o.createElement("div",v({},i,{ref:u,className:m}),o.createElement(L,{hsva:d,onChange:h}),o.createElement(H,{hue:d.h,onChange:h}),o.createElement(B,{hsva:d,onChange:h,className:"react-colorful__last-control"}))},U={defaultColor:"rgba(0, 0, 0, 1)",toHsva:S,fromHsva:function(e){var n=N(e),t=n.r,r=n.g,o=n.b,a=n.a;return"rgba(".concat(t,", ").concat(r,", ").concat(o,", ").concat(a,")")},equal:T},Y=function(e){return o.createElement(W,v({},e,{colorModel:U}))},q=t(37574),A=(0,f.ZL)()({picker:{position:"relative"},swatches:{display:"flex",padding:12,flexWrap:"wrap"},swatch:{width:24,height:24,margin:4,border:"none",padding:0,cursor:"pointer",outline:"none"}}),G=function(e){var n=e.color,t=e.onChange,a=(0,o.useState)(null),l=(0,r.Z)(a,2),c=l[0],i=l[1],u=A().classes;return(0,q.jsxs)("div",{className:u.picker,children:[(0,q.jsx)("div",{className:u.swatch,style:{backgroundColor:n},onClick:function(e){return i(e.currentTarget)}}),(0,q.jsx)(X,{anchorEl:c,onClose:function(){return i(null)},color:n,onChange:t})]})};function X(e){var n=e.anchorEl,t=e.onChange,r=e.onClose,o=e.color;return(0,q.jsx)(c.ZP,{open:!!n,anchorEl:n,onClose:r,children:(0,q.jsx)(F,{color:o,onChange:t})})}function F(e){var n=e.onChange,t=e.color,a=A().classes,c=(0,h.useLocalStorage)("colorPickerPalette","set1"),f=(0,r.Z)(c,2),v=f[0],g=f[1],m=d[v],p=Object.keys(d),x=(0,o.useState)(t),b=(0,r.Z)(x,2),C=b[0],j=b[1],_=l()(t).rgb().toString(),w=function(e){j(e);try{n(l()(e).rgb().toString())}catch(t){}};return(0,q.jsxs)("div",{style:{display:"flex",padding:10},children:[(0,q.jsx)("div",{style:{width:200,margin:5},children:(0,q.jsx)(Y,{color:_,onChange:w})}),(0,q.jsxs)("div",{style:{width:200,margin:5},children:[(0,q.jsx)(i.Z,{value:v,onChange:function(e){var n=e.target.value;g(n)},children:p.map((function(e){return(0,q.jsx)(u.Z,{value:e,children:e},e)}))}),(0,q.jsx)("div",{className:a.swatches,children:m.map((function(e,n){return(0,q.jsx)("button",{className:a.swatch,style:{background:e},onClick:function(){return w(e)}},e+"-"+n)}))}),(0,q.jsx)(s.Z,{helperText:"Manually set color (hex, rgb, or css color name)",value:C,onChange:function(e){return w(e.target.value)}})]})]})}var V=G},35021:function(e,n,t){t.r(n),t.d(n,{default:function(){return T}});var r=t(59740),o=t(68079),a=t(96234),l=t(33028),c=t(30969),i=t(65629),u=t(92256),s=t(48651),f=t(66581),d=t(17984),h=t(69852),v=t(52907),g=t(2374),m=t(81073),p=t(7456),x=t(8034),b=t.n(x),C=t(39554),j=t.n(C),_=t(9101),w=t(6400);function Z(e,n){for(var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=n.map((function(n){return e.findIndex((function(e){return e.name===n}))})).sort((function(e,n){return e-n})),o=0,a=0;a<r.length;a++){var l=r[a],c=Math.max(o,l-t);c>=o&&e.splice(c,0,e.splice(l,1)[0]),o+=1}return e}function k(e,n){for(var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=n.map((function(n){return e.findIndex((function(e){return e.name===n}))})).sort((function(e,n){return n-e})),o=e.length-1,a=0;a<r.length;a++){var l=r[a],c=Math.min(o,l+t);c<=o&&e.splice(c,0,e.splice(l,1)[0]),o-=1}return e}var y=t(88581),M=t(23816),E=t(42351),N=t(96979),S=t(32152),O=t(37574),H=["name","color","baseUri"],L=(0,g.ZL)()((function(e){return{closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]},content:{minWidth:800}}}));function P(e){return(0,O.jsx)(b(),{handle:"#draggable-dialog-title",cancel:'[class*="MuiDialogContent-root"]',children:(0,O.jsx)(i.Z,(0,l.Z)({},e))})}function T(e){var n=e.model,t=e.handleClose,r=L().classes,l=n.sources,i=(0,c.useState)(j()(l||[])),g=(0,a.Z)(i,2),p=g[0],x=g[1],b=(0,m.useLocalStorage)("multiwiggle-showTips",!0),C=(0,a.Z)(b,2),_=C[0],w=C[1];return(0,O.jsxs)(u.Z,{PaperComponent:P,open:!0,onClose:t,maxWidth:"xl","aria-labelledby":"draggable-dialog-title",children:[(0,O.jsxs)(s.Z,{style:{cursor:"move"},id:"draggable-dialog-title",children:["Multi-wiggle color/arrangement editor"," ",(0,O.jsx)(f.Z,{className:r.closeButton,onClick:t,children:(0,O.jsx)(y.Z,{})})]}),(0,O.jsxs)(d.Z,{className:r.content,children:[(0,O.jsx)(h.Z,{variant:"contained",style:{float:"right"},onClick:function(){return w(!_)},children:_?"Hide tips":"Show tips"}),(0,O.jsx)("br",{}),_?(0,O.jsxs)(O.Fragment,{children:["Helpful tips",(0,O.jsxs)("ul",{children:[(0,O.jsx)("li",{children:"You can select rows in the table with the checkboxes"}),(0,O.jsx)("li",{children:"Multi-select is enabled with shift-click and control-click"}),(0,O.jsx)("li",{children:'The "Move selected items up/down" can re-arrange subtracks'}),(0,O.jsx)("li",{children:"Sorting the data grid itself can also re-arrange subtracks"}),(0,O.jsx)("li",{children:"Changes are applied when you hit Submit"}),(0,O.jsx)("li",{children:"You can click and drag the dialog box to move it on the screen"}),(0,O.jsx)("li",{children:"Columns in the table can be hidden using a vertical '...' menu on the right side of each column"})]})]}):null,(0,O.jsx)(R,{rows:p,onChange:x,showTips:_})]}),(0,O.jsxs)(v.Z,{children:[(0,O.jsx)(h.Z,{variant:"contained",type:"submit",color:"inherit",onClick:function(){n.clearLayout(),x(n.sources||[])},children:"Clear custom settings"}),(0,O.jsx)(h.Z,{variant:"contained",color:"secondary",onClick:function(){t(),x((0,o.Z)(n.sources||[]))},children:"Cancel"}),(0,O.jsx)(h.Z,{variant:"contained",color:"primary",type:"submit",onClick:function(){n.setLayout(p),t()},children:"Submit"})]})]})}function R(e){var n=e.rows,t=e.onChange,l=e.showTips,i=(0,c.useState)(null),u=(0,a.Z)(i,2),s=u[0],f=u[1],d=(0,c.useState)([]),v=(0,a.Z)(d,2),g=v[0],x=v[1],b=n[0],C=(b.name,b.color,b.baseUri,(0,r.Z)(b,H)),j=[{field:"color",headerName:"Color",renderCell:function(e){var r=e.value,a=e.id;return(0,O.jsx)(_.default,{color:r||"blue",onChange:function(e){var r=n.find((function(e){return e.name===a}));r&&(r.color=e),t((0,o.Z)(n))}})}},{field:"name",sortingOrder:[null],headerName:"Name",width:(0,m.measureGridWidth)(n.map((function(e){return e.name})))}].concat((0,o.Z)(Object.keys(C).map((function(e){return{field:e,sortingOrder:[null],renderCell:function(e){var n=e.value;return(0,m.isUriLocation)(n)?(0,O.jsx)(w.UriLink,{value:n}):(0,m.getStr)(n)},width:(0,m.measureGridWidth)(n.map((function(n){return n[e]})))}})))),y=(0,c.useState)("blue"),L=(0,a.Z)(y,2),P=L[0],T=L[1],R=(0,c.useState)({idx:0,field:null}),z=(0,a.Z)(R,2),D=z[0],I=z[1];return(0,O.jsxs)("div",{children:[(0,O.jsx)(h.Z,{disabled:!g.length,onClick:function(e){return f(e.currentTarget)},children:"Change color of selected items"}),(0,O.jsxs)(h.Z,{onClick:function(){return t(Z((0,o.Z)(n),g))},disabled:!g.length,children:[(0,O.jsx)(S.Z,{}),l?"Move selected items up":null]}),(0,O.jsxs)(h.Z,{onClick:function(){return t(k((0,o.Z)(n),g))},disabled:!g.length,children:[(0,O.jsx)(N.Z,{}),l?"Move selected items down":null]}),(0,O.jsxs)(h.Z,{onClick:function(){return t(Z((0,o.Z)(n),g,n.length))},disabled:!g.length,children:[(0,O.jsx)(M.Z,{}),l?"Move selected items to top":null]}),(0,O.jsxs)(h.Z,{onClick:function(){return t(k((0,o.Z)(n),g,n.length))},disabled:!g.length,children:[(0,O.jsx)(E.Z,{}),l?"Move selected items to bottom":null]}),(0,O.jsx)(_.ColorPopover,{anchorEl:s,color:P,onChange:function(e){T(e),g.forEach((function(t){var r=n.find((function(e){return e.name===t}));r&&(r.color=e)})),t((0,o.Z)(n))},onClose:function(){return f(null)}}),(0,O.jsx)("div",{style:{height:400,width:"100%"},children:(0,O.jsx)(p._,{getRowId:function(e){return e.name},checkboxSelection:!0,disableSelectionOnClick:!0,onSelectionModelChange:function(e){return x(e)},rows:n,rowHeight:25,headerHeight:33,columns:j,sortModel:[],onSortModelChange:function(e){var r=e[0],a=(D.idx+1)%2,l=(null===r||void 0===r?void 0:r.field)||D.field;I({idx:a,field:l}),t(l?(0,o.Z)(n).sort((function(e,n){var t=(0,m.getStr)(e[l]),r=(0,m.getStr)(n[l]);return 1===a?t.localeCompare(r):r.localeCompare(t)})):n)}})})]})}}}]);
//# sourceMappingURL=5021.bf47c4cd.chunk.js.map