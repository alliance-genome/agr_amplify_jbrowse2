(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[4180],{81986:function(e,t,n){"use strict";n.d(t,{e$:function(){return m},jS:function(){return h}});var r=n(59740),a=n(33028),i=n(40909),o=n(90689),s=n(39554),u=n.n(s),c=n(9077),l=n(81073),d=n(29206),f=["featureData","finalizedFeatureData"],p=["unformattedFeatureData","featureData"],h=(0,c.ConfigurationSchema)("BaseFeatureWidget",{});function g(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return t<=a||(i.subfeatures=null===(r=e.subfeatures)||void 0===r?void 0:r.map((function(e){return g(e,t,n,a+1,i),n(e)}))),i}function m(e){return i.types.model("BaseFeatureWidget",{id:d.ElementId,type:i.types.literal("BaseFeatureWidget"),featureData:i.types.frozen(),formattedFields:i.types.frozen(),unformattedFeatureData:i.types.frozen(),view:i.types.safeReference(e.pluggableMstType("view","stateModel")),track:i.types.safeReference(e.pluggableMstType("track","stateModel")),trackId:i.types.maybe(i.types.string),trackType:i.types.maybe(i.types.string)}).volatile((function(){return{error:void 0}})).actions((function(e){return{setFeatureData:function(t){e.unformattedFeatureData=t},clearFeatureData:function(){e.featureData=void 0},setFormattedData:function(t){e.featureData=t},setExtra:function(t,n){e.trackId=n,e.trackType=t},setError:function(t){e.error=t}}})).actions((function(e){return{afterCreate:function(){(0,i.addDisposer)(e,(0,o.autorun)((function(){try{var t,n;e.setExtra(null===(t=e.track)||void 0===t?void 0:t.type,null===(n=e.track)||void 0===n?void 0:n.configuration.trackId);var r=e.unformattedFeatureData,i=e.track,o=(0,l.getSession)(e);if(r){var s=u()(r),d=function(e,t){return(0,a.Z)((0,a.Z)({},(0,c.getConf)(o,["formatDetails",e],{feature:t})),(0,c.getConf)(i,["formatDetails",e],{feature:t}))};if(i)s.__jbrowsefmt=d("feature",s),g(s,(0,c.getConf)(i,["formatDetails","depth"]),(function(e){e.__jbrowsefmt=d("subfeatures",e)}));e.setFormattedData(s)}}catch(f){console.error(f),e.setError(f)}})))}}})).preProcessSnapshot((function(e){var t=e.featureData,n=e.finalizedFeatureData,i=(0,r.Z)(e,f);return(0,a.Z)({unformattedFeatureData:t,featureData:n},i)})).postProcessSnapshot((function(e){var t=e,n=(t.unformattedFeatureData,t.featureData),i=(0,r.Z)(t,p);return(0,a.Z)({finalizedFeatureData:JSON.parse(JSON.stringify(n,(function(e,t){return void 0===t?null:t})))},i)}))}},49767:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(9249),a=n(87371),i=function(){function e(){(0,r.Z)(this,e),this.name=void 0,this.url=void 0,this.version=void 0,this.configurationSchema=void 0}return(0,a.Z)(e,[{key:"install",value:function(e){}},{key:"configure",value:function(e){}}]),e}()},16694:function(e,t,n){"use strict";n.d(t,{Z:function(){return te}});var r={};n.r(r),n.d(r,{CoreFreeResources:function(){return U},CoreGetFeatureDensityStats:function(){return J},CoreGetFeatureDetails:function(){return E},CoreGetFeatures:function(){return q},CoreGetFileInfo:function(){return z},CoreGetMetadata:function(){return V},CoreGetRefNames:function(){return L},CoreRender:function(){return _}});var a=n(32723),i=n(34795),o=n(41361),s=n(68079),u=n(96234),c=n(9249),l=n(87371),d=n(40909),f=n(86297),p=n(93029),h=n(82044),g=n(81575),m=n(39798),v=n(66737),y=n(58096),b=n(85550),w=n(15875),x=n(31145),k=n(62503),Z=n(9077),C=n(32095),S=n(45754),T=n(13820),P=n(30969),M=n(81986),R=n(49767),A=n(3011),I=n(20783),L=function(e){(0,S.Z)(n,e);var t=(0,T.Z)(n);function n(){var e;(0,c.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).name="CoreGetRefNames",e}return(0,l.Z)(n,[{key:"execute",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,n){var r,i,o,s,u,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.pluginManager,e.next=3,this.deserializeArguments(t,n);case 3:return i=e.sent,o=i.sessionId,s=i.adapterConfig,e.next=7,(0,A.uP)(r,o,s);case 7:if(u=e.sent,c=u.dataAdapter,!(0,I.isFeatureAdapter)(c)){e.next=11;break}return e.abrupt("return",c.getRefNames(i));case 11:return e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(b.Z),N=n(93069),F=n(95058),j=n(81073),D=n(67688);function B(e,t){if(!t)throw new Error('renderer "'.concat(e,'" not found'));if(!t.ReactComponent)throw new Error("renderer ".concat(e," has no ReactComponent, it may not be completely implemented yet"));if(!(t instanceof D.default))throw new TypeError("CoreRender requires a renderer that is a subclass of ServerSideRendererType");return t}var E=function(e){(0,S.Z)(n,e);var t=(0,T.Z)(n);function n(){var e;(0,c.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).name="CoreGetFeatureDetails",e}return(0,l.Z)(n,[{key:"serializeArguments",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,r){var i,o,s,u,c,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.pluginManager.rootModel,o=i.session.assemblyManager,e.next=4,(0,j.renameRegionsIfNeeded)(o,t);case 4:return s=e.sent,e.next=7,(0,N.Z)((0,F.Z)(n.prototype),"serializeArguments",this).call(this,s,r);case 7:if(u=e.sent,"MainThreadRpcDriver"!==r){e.next=10;break}return e.abrupt("return",u);case 10:return c=t.rendererType,l=B(c,this.pluginManager.getRendererType(c)),e.abrupt("return",l.serializeArgsInClient(u));case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"execute",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,n){var r,i,o,s,u,c,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t,"MainThreadRpcDriver"===n){e.next=5;break}return e.next=4,this.deserializeArguments(t,n);case 4:o=e.sent;case 5:return u=(s=o).rendererType,c=s.featureId,l=B(u,this.pluginManager.getRendererType(u)),e.abrupt("return",{feature:null===(r=l.sessions[(0,j.getLayoutId)(t)])||void 0===r||null===(i=r.cachedLayout.layout.getDataByID(c))||void 0===i?void 0:i.toJSON()});case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(b.Z),V=function(e){(0,S.Z)(n,e);var t=(0,T.Z)(n);function n(){var e;(0,c.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).name="CoreGetMetadata",e}return(0,l.Z)(n,[{key:"execute",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,n){var r,i,o,s,u,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.pluginManager,e.next=3,this.deserializeArguments(t,n);case 3:return i=e.sent,o=i.sessionId,s=i.adapterConfig,e.next=7,(0,A.uP)(r,o,s);case 7:return u=e.sent,c=u.dataAdapter,e.abrupt("return",(0,I.isFeatureAdapter)(c)?c.getMetadata(i):null);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(b.Z),z=function(e){(0,S.Z)(n,e);var t=(0,T.Z)(n);function n(){var e;(0,c.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).name="CoreGetInfo",e}return(0,l.Z)(n,[{key:"execute",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,n){var r,i,o,s,u,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.pluginManager,e.next=3,this.deserializeArguments(t,n);case 3:return i=e.sent,o=i.sessionId,s=i.adapterConfig,e.next=7,(0,A.uP)(r,o,s);case 7:return u=e.sent,c=u.dataAdapter,e.abrupt("return",(0,I.isFeatureAdapter)(c)?c.getHeader(i):null);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(b.Z),O=n(33028),W=n(95915),H=n(81450),G=n(14956),q=function(e){(0,S.Z)(n,e);var t=(0,T.Z)(n);function n(){var e;(0,c.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).name="CoreGetFeatures",e}return(0,l.Z)(n,[{key:"deserializeReturn",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,r,i){var o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,N.Z)((0,F.Z)(n.prototype),"deserializeReturn",this).call(this,t,r,i);case 2:return o=e.sent,e.abrupt("return",o.map((function(e){return new G.Z(e)})));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"serializeArguments",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,r){var i,o,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.pluginManager.rootModel,o=i.session.assemblyManager,e.next=4,(0,j.renameRegionsIfNeeded)(o,t);case 4:return s=e.sent,e.abrupt("return",(0,N.Z)((0,F.Z)(n.prototype),"serializeArguments",this).call(this,s,r));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"execute",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,n){var r,i,o,s,u,c,l,d,f,p,h;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.pluginManager,e.next=3,this.deserializeArguments(t,n);case 3:return i=e.sent,o=i.signal,s=i.sessionId,u=i.adapterConfig,c=i.regions,l=i.opts,e.next=7,(0,A.uP)(r,s,u);case 7:if(d=e.sent,f=d.dataAdapter,(0,I.isFeatureAdapter)(f)){e.next=11;break}throw new Error("Adapter does not support retrieving features");case 11:return p=f.getFeaturesInMultipleRegions(c,(0,O.Z)((0,O.Z)({},l),{},{signal:o})),e.next=14,(0,H.z)(p.pipe((0,W.q)()));case 14:return h=e.sent,e.abrupt("return",h.map((function(e){return e.toJSON()})));case 16:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(b.Z),_=function(e){(0,S.Z)(n,e);var t=(0,T.Z)(n);function n(){var e;(0,c.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).name="CoreRender",e}return(0,l.Z)(n,[{key:"serializeArguments",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,r){var i,o,s,u,c,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.pluginManager.rootModel,o=i.session.assemblyManager,e.next=4,(0,j.renameRegionsIfNeeded)(o,t);case 4:return s=e.sent,e.next=7,(0,N.Z)((0,F.Z)(n.prototype),"serializeArguments",this).call(this,s,r);case 7:if(u=e.sent,"MainThreadRpcDriver"!==r){e.next=10;break}return e.abrupt("return",u);case 10:return c=t.rendererType,l=B(c,this.pluginManager.getRendererType(c)),e.abrupt("return",l.serializeArgsInClient(u));case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"execute",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,n){var r,i,o,s,u,c,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t,"MainThreadRpcDriver"===n){e.next=5;break}return e.next=4,this.deserializeArguments(t,n);case 4:r=e.sent;case 5:if(o=(i=r).sessionId,s=i.rendererType,u=i.signal,o){e.next=8;break}throw new Error("must pass a unique session id");case 8:if((0,j.checkAbortSignal)(u),c=B(s,this.pluginManager.getRendererType(s)),"MainThreadRpcDriver"!==n){e.next=16;break}return e.next=13,c.render(r);case 13:e.t0=e.sent,e.next=19;break;case 16:return e.next=18,c.renderInWorker(r);case 18:e.t0=e.sent;case 19:return l=e.t0,(0,j.checkAbortSignal)(u),e.abrupt("return",l);case 22:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deserializeReturn",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,r,i){var o,s,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,N.Z)((0,F.Z)(n.prototype),"deserializeReturn",this).call(this,t,r,i);case 2:if(o=e.sent,"MainThreadRpcDriver"!==i){e.next=5;break}return e.abrupt("return",o);case 5:return s=r.rendererType,u=B(s,this.pluginManager.getRendererType(s)),e.abrupt("return",u.deserializeResultsInClient(o,r));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(b.Z),U=function(e){(0,S.Z)(n,e);var t=(0,T.Z)(n);function n(){var e;(0,c.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).name="CoreFreeResources",e}return(0,l.Z)(n,[{key:"execute",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=0,n+=(0,A.Yr)(t),this.pluginManager.getRendererTypes().forEach((function(e){var t=e.freeResources();t&&(n+=t)})),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"serializeArguments",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,n){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(b.Z),J=function(e){(0,S.Z)(n,e);var t=(0,T.Z)(n);function n(){var e;(0,c.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).name="CoreGetFeatureDensityStats",e}return(0,l.Z)(n,[{key:"serializeArguments",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,r){var i,o,s,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.pluginManager.rootModel,s=o.session.assemblyManager,e.next=4,(0,j.renameRegionsIfNeeded)(s,(0,O.Z)((0,O.Z)({},t),{},{filters:null===(i=t.filters)||void 0===i?void 0:i.toJSON().filters}));case 4:return u=e.sent,e.abrupt("return",(0,N.Z)((0,F.Z)(n.prototype),"serializeArguments",this).call(this,u,r));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"execute",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,n){var r,i,o,s,u,c,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.pluginManager,e.next=3,this.deserializeArguments(t,n);case 3:return i=e.sent,o=i.adapterConfig,s=i.sessionId,u=i.regions,e.next=7,(0,A.uP)(r,s,o);case 7:if(c=e.sent,l=c.dataAdapter,(0,I.isFeatureAdapter)(l)){e.next=11;break}throw new Error("Adapter does not support retrieving features");case 11:return e.abrupt("return",l.getMultiRegionFeatureDensityStats(u,i));case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(b.Z),X=n(99069);var Y=(0,Z.ConfigurationSchema)("CytobandAdapter",{cytobandLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/cytoband.txt.gz"}}},{explicitlyTyped:!0}),Q=function(e){(0,S.Z)(a,e);var t=(0,T.Z)(a);function a(){var e;(0,c.Z)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).name="CorePlugin",e}return(0,l.Z)(a,[{key:"install",value:function(e){Object.values(r).forEach((function(t){e.addRpcMethod((function(){return new t(e)}))})),function(e){e.addAdapterType((function(){return new X.AdapterType({name:"CytobandAdapter",configSchema:Y,getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(3142)]).then(n.bind(n,13142)).then((function(e){return e.default}))}})}))}(e),e.addWidgetType((function(){return new v.Z({name:"BaseFeatureWidget",heading:"Feature details",configSchema:M.jS,stateModel:(0,M.e$)(e),ReactComponent:(0,P.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(1356),n.e(2942),n.e(8422)]).then(n.bind(n,52942))}))})}))}}]),a}(R.Z),K=n(11192),$=function(){function e(){(0,c.Z)(this,e),this.phaseCallbacks=new Map,this.phaseOrder=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this.phaseOrder=n}return(0,l.Z)(e,[{key:"add",value:function(e,t){if(!this.phaseOrder.includes(e))throw new Error("unknown phase ".concat(e));var n=this.phaseCallbacks.get(e);n||(n=[],this.phaseCallbacks.set(e,n)),n.push(t)}},{key:"run",value:function(){var e=this;this.phaseOrder.forEach((function(t){var n;null===(n=e.phaseCallbacks.get(t))||void 0===n||n.forEach((function(e){return e()}))}))}}]),e}(),ee=function(){function e(t,n){(0,c.Z)(this,e),this.typeName=t,this.baseClass=n,this.registeredTypes={}}return(0,l.Z)(e,[{key:"add",value:function(e,t){this.registeredTypes[e]=t}},{key:"has",value:function(e){return e in this.registeredTypes}},{key:"get",value:function(e){if(!this.has(e))throw new Error("".concat(this.typeName," '").concat(e,"' not found, perhaps its plugin is not loaded or its plugin has not added it."));return this.registeredTypes[e]}},{key:"all",value:function(){return Object.values(this.registeredTypes)}}]),e}(),te=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,c.Z)(this,e),this.plugins=[],this.jexl=(0,K.Z)(),this.pluginMetadata={},this.runtimePluginDefinitions=[],this.elementCreationSchedule=new $("renderer","adapter","text search adapter","display","track","connection","view","widget","rpc method","internet account","add track workflow"),this.rendererTypes=new ee("RendererType",f.default),this.adapterTypes=new ee("AdapterType",p.Z),this.textSearchAdapterTypes=new ee("TextSearchAdapterType",x.Z),this.trackTypes=new ee("TrackType",h.Z),this.displayTypes=new ee("DisplayType",g.Z),this.connectionTypes=new ee("ConnectionType",y.Z),this.viewTypes=new ee("ViewType",m.Z),this.widgetTypes=new ee("WidgetType",v.Z),this.rpcMethods=new ee("RpcMethodType",b.Z),this.addTrackWidgets=new ee("AddTrackWorkflow",k.Z),this.internetAccountTypes=new ee("InternetAccountType",w.Z),this.configured=!1,this.rootModel=void 0,this.extensionPoints=new Map,this.jbrequireCache=new Map,this.lib=C.Z,this.load=function(e){return t.jbrequireCache.has(e)||t.jbrequireCache.set(e,e(t)),t.jbrequireCache.get(e)},this.jbrequire=function(e){if("string"===typeof e){var n=t.lib[e];if(!n)throw new TypeError("No jbrequire re-export defined for package '".concat(e,"'. If this package must be shared between plugins, add it to ReExports.js. If it does not need to be shared, just import it normally."));return n}if("function"===typeof e)return t.load(e);if(e.default)return t.jbrequire(e.default);throw new TypeError("lib passed to jbrequire must be either a string or a function")},this.addPlugin({plugin:new Q,metadata:{isCore:!0}}),n.forEach((function(e){t.addPlugin(e)}))}return(0,l.Z)(e,[{key:"pluginConfigurationSchemas",value:function(){var e={};return this.plugins.forEach((function(t){t.configurationSchema&&(e[t.name]=t.configurationSchema)})),e}},{key:"addPlugin",value:function(e){if(this.configured)throw new Error("JBrowse already configured, cannot add plugins");var t="install"in e&&"configure"in e?[e,{}]:[e.plugin,e.metadata],n=(0,u.Z)(t,2),r=n[0],a=n[1],i=void 0===a?{}:a;if(this.plugins.includes(r))throw new Error("plugin already installed");return this.pluginMetadata[r.name]=i,"definition"in e&&this.runtimePluginDefinitions.push(e.definition),r.install(this),this.plugins.push(r),this}},{key:"getPlugin",value:function(e){return this.plugins.find((function(t){return t.name===e}))}},{key:"hasPlugin",value:function(e){return void 0!==this.getPlugin(e)}},{key:"createPluggableElements",value:function(){return this.elementCreationSchedule&&(this.elementCreationSchedule.run(),delete this.elementCreationSchedule),this}},{key:"setRootModel",value:function(e){this.rootModel=e}},{key:"configure",value:function(){var e=this;if(this.configured)throw new Error("already configured");return this.plugins.forEach((function(t){return t.configure(e)})),this.configured=!0,this}},{key:"getElementTypeRecord",value:function(e){switch(e){case"adapter":return this.adapterTypes;case"text search adapter":return this.textSearchAdapterTypes;case"connection":return this.connectionTypes;case"widget":return this.widgetTypes;case"renderer":return this.rendererTypes;case"display":return this.displayTypes;case"track":return this.trackTypes;case"view":return this.viewTypes;case"rpc method":return this.rpcMethods;case"internet account":return this.internetAccountTypes;case"add track workflow":return this.addTrackWidgets;default:throw new Error("invalid element type '".concat(e,"'"))}}},{key:"addElementType",value:function(e,t){var n,r=this;if("function"!==typeof t)throw new Error("must provide a callback function that returns the new type object");var a=this.getElementTypeRecord(e);return null===(n=this.elementCreationSchedule)||void 0===n||n.add(e,(function(){var n=t(r);if(!n.name)throw new Error("cannot add a ".concat(e," with no name"));if(a.has(n.name))throw new Error("".concat(e," ").concat(n.name," already registered, cannot register it again"));a.add(n.name,r.evaluateExtensionPoint("Core-extendPluggableElement",n))})),this}},{key:"getElementType",value:function(e,t){return this.getElementTypeRecord(e).get(t)}},{key:"getElementTypesInGroup",value:function(e){return this.getElementTypeRecord(e).all()}},{key:"getTrackElements",value:function(){return this.getElementTypesInGroup("track")}},{key:"getConnectionElements",value:function(){return this.getElementTypesInGroup("connection")}},{key:"getAddTrackWorkflowElements",value:function(){return this.getElementTypesInGroup("add track workflow")}},{key:"getRpcElements",value:function(){return this.getElementTypesInGroup("rpc method")}},{key:"getDisplayElements",value:function(){return this.getElementTypesInGroup("display")}},{key:"getAdapterElements",value:function(){return this.getElementTypesInGroup("adapter")}},{key:"pluggableMstType",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d.types.maybe(d.types.null),r=this.getElementTypeRecord(e).all().map((function(e){return e[t]})).filter((function(e){return(0,d.isType)(e)&&(0,d.isModelType)(e)}));return 0===r.length&&"undefined"===typeof jest?(console.warn("No pluggable types found matching ('".concat(e,"','").concat(t,"')")),n):d.types.union.apply(d.types,(0,s.Z)(r))}},{key:"pluggableConfigSchemaType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"configSchema",n=this.getElementTypeRecord(e).all().map((function(e){return e[t]})).filter((function(e){return(0,Z.isBareConfigurationSchemaType)(e)}));return 0===n.length&&n.push((0,Z.ConfigurationSchema)("Null",{})),d.types.union.apply(d.types,(0,s.Z)(n))}},{key:"getRendererType",value:function(e){return this.rendererTypes.get(e)}},{key:"getRendererTypes",value:function(){return this.rendererTypes.all()}},{key:"getAdapterType",value:function(e){return this.adapterTypes.get(e)}},{key:"getTextSearchAdapterType",value:function(e){return this.textSearchAdapterTypes.get(e)}},{key:"getTrackType",value:function(e){return this.trackTypes.get(e)}},{key:"getDisplayType",value:function(e){return this.displayTypes.get(e)}},{key:"getViewType",value:function(e){return this.viewTypes.get(e)}},{key:"getAddTrackWorkflow",value:function(e){return this.addTrackWidgets.get(e)}},{key:"getWidgetType",value:function(e){return this.widgetTypes.get(e)}},{key:"getConnectionType",value:function(e){return this.connectionTypes.get(e)}},{key:"getRpcMethodType",value:function(e){return this.rpcMethods.get(e)}},{key:"getInternetAccountType",value:function(e){return this.internetAccountTypes.get(e)}},{key:"addRendererType",value:function(e){return this.addElementType("renderer",e)}},{key:"addAdapterType",value:function(e){return this.addElementType("adapter",e)}},{key:"addTextSearchAdapterType",value:function(e){return this.addElementType("text search adapter",e)}},{key:"addTrackType",value:function(e){var t=this;return this.addElementType("track",(function(){var n=e(t);return t.getElementTypesInGroup("display").forEach((function(e){e.trackType!==n.name||n.displayTypes.includes(e)||n.addDisplayType(e)})),n}))}},{key:"addDisplayType",value:function(e){return this.addElementType("display",e)}},{key:"addViewType",value:function(e){var t=this;return this.addElementType("view",(function(){var n=e(t);return t.getElementTypesInGroup("display").forEach((function(e){e.viewType!==n.name&&e.viewType!==n.extendedName||n.displayTypes.includes(e)||n.addDisplayType(e)})),n}))}},{key:"addWidgetType",value:function(e){return this.addElementType("widget",e)}},{key:"addConnectionType",value:function(e){return this.addElementType("connection",e)}},{key:"addRpcMethod",value:function(e){return this.addElementType("rpc method",e)}},{key:"addInternetAccountType",value:function(e){return this.addElementType("internet account",e)}},{key:"addAddTrackWorkflowType",value:function(e){return this.addElementType("add track workflow",e)}},{key:"addToExtensionPoint",value:function(e,t){var n=this.extensionPoints.get(e);n||(n=[],this.extensionPoints.set(e,n)),n.push(t)}},{key:"evaluateExtensionPoint",value:function(e,t,n){var r=this.extensionPoints.get(e),a=t;if(r){var i,s=(0,o.Z)(r);try{for(s.s();!(i=s.n()).done;){var u=i.value;try{a=u(a,n)}catch(c){console.error(c)}}}catch(l){s.e(l)}finally{s.f()}}return a}},{key:"evaluateAsyncExtensionPoint",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,n,r){var i,s,u,c,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.extensionPoints.get(t),s=n,!i){e.next=27;break}u=(0,o.Z)(i),e.prev=4,u.s();case 6:if((c=u.n()).done){e.next=19;break}return l=c.value,e.prev=8,e.next=11,l(s,r);case 11:s=e.sent,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(8),console.error(e.t0);case 17:e.next=6;break;case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(4),u.e(e.t1);case 24:return e.prev=24,u.f(),e.finish(24);case 27:return e.abrupt("return",s);case 28:case"end":return e.stop()}}),e,this,[[4,21,24,27],[8,14]])})));return function(t,n,r){return e.apply(this,arguments)}}()}]),e}()},32095:function(e,t,n){"use strict";n.d(t,{Z:function(){return de}});var r=n(33028),a=n(96234),i=n(30969),o=n(37574),s=n.t(o,2),u=n(15749),c=n.t(u,2),l=n(90689),d=n(40909),f=n(90550),p=n(53276),h=n(24974),g=n.n(h),m=n(74262),v=n(94702),y=n(61316),b=n(85756),w=n(26734),x=n(37057),k=n(14909),Z=n(20783),C=n(54006),S=n(99069),T=n(39798),P=n(93029),M=n(81575),R=n(82044),A=n(66737),I=n(77479),L=n(67688),N=n(93073),F=n(21339),j=n(29637),D=n(86297),B=n(9077),E=n(49767),V=n(59767),z=n(81073),O=n(74426),W=n(41472),H=n(97891),G=n(33528),q=n(83265),_=n(26131),U=n(29206),J=["mobx","mobx-state-tree","react","react/jsx-runtime","react-dom","mobx-react","@mui/x-data-grid","@mui/material/utils","@material-ui/core/utils","tss-react/mui","@material-ui/core","@mui/material","prop-types","@mui/material/styles","@material-ui/core/styles","@material-ui/core/Accordion","@material-ui/core/AccordionActions","@material-ui/core/AccordionDetails","@material-ui/core/Alert","@material-ui/core/AlertTitle","@material-ui/core/Autocomplete","@material-ui/core/Avatar","@material-ui/core/AvatarGroup","@material-ui/core/Backdrop","@material-ui/core/Badge","@material-ui/core/Box","@material-ui/core/Breadcrumbs","@material-ui/core/Button","@material-ui/core/ButtonGroup","@material-ui/core/Card","@material-ui/core/CardActions","@material-ui/core/CardActionArea","@material-ui/core/CardContent","@material-ui/core/CardHeader","@material-ui/core/CardMedia","@material-ui/core/CircularProgress","@material-ui/core/Collapse","@material-ui/core/ClickAwayListener","@material-ui/core/Chip","@material-ui/core/Checkbox","@material-ui/core/Container","@material-ui/core/Dialog","@material-ui/core/DialogActions","@material-ui/core/DialogTitle","@material-ui/core/DialogContent","@material-ui/core/DialogContentText","@material-ui/core/Divider","@material-ui/core/Drawer","@material-ui/core/Fab","@material-ui/core/Fade","@material-ui/core/FilledInput","@material-ui/core/FormLabel","@material-ui/core/FormControl","@material-ui/core/FormControlLabel","@material-ui/core/FormHelperText","@material-ui/core/FormGroup","@material-ui/core/Grid","@material-ui/core/Grow","@material-ui/core/Icon","@material-ui/core/IconButton","@material-ui/core/Input","@material-ui/core/InputBase","@material-ui/core/InputLabel","@material-ui/core/InputAdornment","@material-ui/core/Link","@material-ui/core/LinearProgress","@material-ui/core/List","@material-ui/core/ListItem","@material-ui/core/ListItemAvatar","@material-ui/core/ListItemSecondaryAction","@material-ui/core/ListItemIcon","@material-ui/core/ListSubheader","@material-ui/core/ListItemText","@material-ui/core/Menu","@material-ui/core/MenuItem","@material-ui/core/MenuList","@material-ui/core/Modal","@material-ui/core/NativeSelect","@material-ui/core/OutlinedInput","@material-ui/core/Pagination","@material-ui/core/PaginationItem","@material-ui/core/Paper","@material-ui/core/Popover","@material-ui/core/Popper","@material-ui/core/Portal","@material-ui/core/Radio","@material-ui/core/RadioGroup","@material-ui/core/Rating","@material-ui/core/ScopedCssBaseline","@material-ui/core/Select","@material-ui/core/Skeleton","@material-ui/core/Slider","@material-ui/core/Snackbar","@material-ui/core/SnackbarContent","@material-ui/core/SpeedDial","@material-ui/core/SpeedDialAction","@material-ui/core/SpeedDialIcon","@material-ui/core/Stack","@material-ui/core/Step","@material-ui/core/StepButton","@material-ui/core/StepConnector","@material-ui/core/StepLabel","@material-ui/core/StepIcon","@material-ui/core/Stepper","@material-ui/core/SvgIcon","@material-ui/core/Switch","@material-ui/core/Tab","@material-ui/core/Table","@material-ui/core/TableBody","@material-ui/core/TableCell","@material-ui/core/TableContainer","@material-ui/core/TableFooter","@material-ui/core/TableHead","@material-ui/core/TablePagination","@material-ui/core/TableRow","@material-ui/core/TableSortLabel","@material-ui/core/Tabs","@material-ui/core/TextField","@material-ui/core/TextareaAutosize","@material-ui/core/ToggleButton","@material-ui/core/ToggleButtonGroup","@material-ui/core/Toolbar","@material-ui/core/Tooltip","@material-ui/core/Typography","@mui/material/Accordion","@mui/material/AccordionActions","@mui/material/AccordionDetails","@mui/material/Alert","@mui/material/AlertTitle","@mui/material/Autocomplete","@mui/material/Avatar","@mui/material/AvatarGroup","@mui/material/Backdrop","@mui/material/Badge","@mui/material/Box","@mui/material/Breadcrumbs","@mui/material/Button","@mui/material/ButtonGroup","@mui/material/Card","@mui/material/CardActions","@mui/material/CardActionArea","@mui/material/CardContent","@mui/material/CardHeader","@mui/material/CardMedia","@mui/material/CircularProgress","@mui/material/Collapse","@mui/material/ClickAwayListener","@mui/material/Chip","@mui/material/Checkbox","@mui/material/Container","@mui/material/Dialog","@mui/material/DialogActions","@mui/material/DialogTitle","@mui/material/DialogContent","@mui/material/DialogContentText","@mui/material/Divider","@mui/material/Drawer","@mui/material/Fab","@mui/material/Fade","@mui/material/FilledInput","@mui/material/FormLabel","@mui/material/FormControl","@mui/material/FormControlLabel","@mui/material/FormHelperText","@mui/material/FormGroup","@mui/material/Grid","@mui/material/Grow","@mui/material/Icon","@mui/material/IconButton","@mui/material/Input","@mui/material/InputBase","@mui/material/InputLabel","@mui/material/InputAdornment","@mui/material/Link","@mui/material/LinearProgress","@mui/material/List","@mui/material/ListItem","@mui/material/ListItemAvatar","@mui/material/ListItemSecondaryAction","@mui/material/ListItemIcon","@mui/material/ListSubheader","@mui/material/ListItemText","@mui/material/Menu","@mui/material/MenuItem","@mui/material/MenuList","@mui/material/Modal","@mui/material/NativeSelect","@mui/material/OutlinedInput","@mui/material/Pagination","@mui/material/PaginationItem","@mui/material/Paper","@mui/material/Popover","@mui/material/Popper","@mui/material/Portal","@mui/material/Radio","@mui/material/RadioGroup","@mui/material/Rating","@mui/material/ScopedCssBaseline","@mui/material/Select","@mui/material/Skeleton","@mui/material/Slider","@mui/material/Snackbar","@mui/material/SnackbarContent","@mui/material/SpeedDial","@mui/material/SpeedDialAction","@mui/material/SpeedDialIcon","@mui/material/Stack","@mui/material/Step","@mui/material/StepButton","@mui/material/StepConnector","@mui/material/StepLabel","@mui/material/StepIcon","@mui/material/Stepper","@mui/material/SvgIcon","@mui/material/Switch","@mui/material/Tab","@mui/material/Table","@mui/material/TableBody","@mui/material/TableCell","@mui/material/TableContainer","@mui/material/TableFooter","@mui/material/TableHead","@mui/material/TablePagination","@mui/material/TableRow","@mui/material/TableSortLabel","@mui/material/Tabs","@mui/material/TextField","@mui/material/TextareaAutosize","@mui/material/ToggleButton","@mui/material/ToggleButtonGroup","@mui/material/Toolbar","@mui/material/Tooltip","@mui/material/Typography","@material-ui/lab/ToggleButton","@material-ui/lab/ToggleButtonGroup","@material-ui/lab/Autocomplete","@material-ui/lab/Alert","@material-ui/lab","@jbrowse/core/Plugin","@jbrowse/core/pluggableElementTypes","@jbrowse/core/pluggableElementTypes/ViewType","@jbrowse/core/pluggableElementTypes/AdapterType","@jbrowse/core/pluggableElementTypes/DisplayType","@jbrowse/core/pluggableElementTypes/TrackType","@jbrowse/core/pluggableElementTypes/WidgetType","@jbrowse/core/pluggableElementTypes/models","@jbrowse/core/pluggableElementTypes/renderers/ServerSideRendererType","@jbrowse/core/pluggableElementTypes/renderers/CircularChordRendererType","@jbrowse/core/pluggableElementTypes/renderers/BoxRendererType","@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType","@jbrowse/core/pluggableElementTypes/renderers/RendererType","@jbrowse/core/configuration","@jbrowse/core/util/types/mst","@jbrowse/core/ui","@jbrowse/core/util","@jbrowse/core/util/color","@jbrowse/core/util/layouts","@jbrowse/core/util/tracks","@jbrowse/core/util/Base1DViewModel","@jbrowse/core/util/io","@jbrowse/core/util/mst-reflection","@jbrowse/core/util/rxjs","@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail","@jbrowse/core/data_adapters/BaseAdapter"],X={Accordion:(0,i.lazy)((function(){return n.e(9599).then(n.bind(n,99599))})),AccordionActions:(0,i.lazy)((function(){return n.e(8228).then(n.bind(n,68228))})),AccordionDetails:(0,i.lazy)((function(){return n.e(8731).then(n.bind(n,78731))})),Alert:(0,i.lazy)((function(){return n.e(5652).then(n.bind(n,25652))})),AlertTitle:(0,i.lazy)((function(){return n.e(2939).then(n.bind(n,92939))})),Autocomplete:(0,i.lazy)((function(){return n.e(8461).then(n.bind(n,18461))})),Avatar:(0,i.lazy)((function(){return n.e(2477).then(n.bind(n,42477))})),AvatarGroup:(0,i.lazy)((function(){return n.e(6537).then(n.bind(n,16537))})),Backdrop:(0,i.lazy)((function(){return n.e(9582).then(n.bind(n,59582))})),Badge:(0,i.lazy)((function(){return n.e(5466).then(n.bind(n,55466))})),Box:(0,i.lazy)((function(){return n.e(2293).then(n.bind(n,92293))})),Breadcrumbs:(0,i.lazy)((function(){return n.e(4065).then(n.bind(n,14065))})),Button:(0,i.lazy)((function(){return n.e(4916).then(n.bind(n,84916))})),ButtonGroup:(0,i.lazy)((function(){return n.e(4483).then(n.bind(n,74483))})),Card:(0,i.lazy)((function(){return n.e(278).then(n.bind(n,80278))})),CardActions:(0,i.lazy)((function(){return n.e(1673).then(n.bind(n,11673))})),CardActionArea:(0,i.lazy)((function(){return n.e(4800).then(n.bind(n,84800))})),CardContent:(0,i.lazy)((function(){return n.e(3964).then(n.bind(n,83964))})),CardHeader:(0,i.lazy)((function(){return n.e(4257).then(n.bind(n,44257))})),CardMedia:(0,i.lazy)((function(){return n.e(7946).then(n.bind(n,67946))})),CircularProgress:(0,i.lazy)((function(){return n.e(99).then(n.bind(n,99))})),Collapse:(0,i.lazy)((function(){return n.e(3089).then(n.bind(n,23089))})),ClickAwayListener:(0,i.lazy)((function(){return n.e(6393).then(n.bind(n,46393))})),Chip:(0,i.lazy)((function(){return n.e(5847).then(n.bind(n,25847))})),Checkbox:(0,i.lazy)((function(){return n.e(5078).then(n.bind(n,55078))})),Container:(0,i.lazy)((function(){return n.e(7324).then(n.bind(n,77324))})),Dialog:(0,i.lazy)((function(){return n.e(7499).then(n.bind(n,47499))})),DialogActions:(0,i.lazy)((function(){return n.e(5317).then(n.bind(n,65317))})),DialogTitle:(0,i.lazy)((function(){return n.e(8920).then(n.bind(n,58920))})),DialogContent:(0,i.lazy)((function(){return n.e(1851).then(n.bind(n,31851))})),DialogContentText:(0,i.lazy)((function(){return n.e(1707).then(n.bind(n,1707))})),Divider:(0,i.lazy)((function(){return n.e(6315).then(n.bind(n,46315))})),Drawer:(0,i.lazy)((function(){return n.e(75).then(n.bind(n,10075))})),Fab:(0,i.lazy)((function(){return n.e(5571).then(n.bind(n,25571))})),Fade:(0,i.lazy)((function(){return n.e(4406).then(n.bind(n,34406))})),FilledInput:(0,i.lazy)((function(){return n.e(603).then(n.bind(n,60603))})),FormLabel:(0,i.lazy)((function(){return n.e(7021).then(n.bind(n,27021))})),FormControl:(0,i.lazy)((function(){return n.e(4045).then(n.bind(n,44045))})),FormControlLabel:(0,i.lazy)((function(){return n.e(392).then(n.bind(n,20392))})),FormHelperText:(0,i.lazy)((function(){return n.e(924).then(n.bind(n,70924))})),FormGroup:(0,i.lazy)((function(){return n.e(1415).then(n.bind(n,1415))})),Grid:(0,i.lazy)((function(){return n.e(6182).then(n.bind(n,76182))})),Grow:(0,i.lazy)((function(){return n.e(5412).then(n.bind(n,55412))})),Icon:(0,i.lazy)((function(){return n.e(3195).then(n.bind(n,83195))})),IconButton:(0,i.lazy)((function(){return n.e(8623).then(n.bind(n,98623))})),Input:(0,i.lazy)((function(){return n.e(8059).then(n.bind(n,68059))})),InputBase:(0,i.lazy)((function(){return n.e(2323).then(n.bind(n,32323))})),InputLabel:(0,i.lazy)((function(){return n.e(4645).then(n.bind(n,84645))})),InputAdornment:(0,i.lazy)((function(){return n.e(8738).then(n.bind(n,38738))})),Link:(0,i.lazy)((function(){return n.e(744).then(n.bind(n,20744))})),LinearProgress:(0,i.lazy)((function(){return n.e(2235).then(n.bind(n,32235))})),List:(0,i.lazy)((function(){return n.e(8428).then(n.bind(n,37026))})),ListItem:(0,i.lazy)((function(){return Promise.all([n.e(1306),n.e(7042)]).then(n.bind(n,97042))})),ListItemAvatar:(0,i.lazy)((function(){return n.e(7265).then(n.bind(n,67265))})),ListItemSecondaryAction:(0,i.lazy)((function(){return n.e(6150).then(n.bind(n,26150))})),ListItemIcon:(0,i.lazy)((function(){return n.e(4718).then(n.bind(n,44718))})),ListSubheader:(0,i.lazy)((function(){return n.e(4258).then(n.bind(n,44258))})),ListItemText:(0,i.lazy)((function(){return n.e(4277).then(n.bind(n,54277))})),Menu:(0,i.lazy)((function(){return n.e(6839).then(n.bind(n,6839))})),MenuItem:(0,i.lazy)((function(){return n.e(7856).then(n.bind(n,47856))})),MenuList:(0,i.lazy)((function(){return n.e(8173).then(n.bind(n,66349))})),Modal:(0,i.lazy)((function(){return n.e(7605).then(n.bind(n,7605))})),NativeSelect:(0,i.lazy)((function(){return n.e(379).then(n.bind(n,90379))})),OutlinedInput:(0,i.lazy)((function(){return n.e(5865).then(n.bind(n,25865))})),Pagination:(0,i.lazy)((function(){return n.e(4466).then(n.bind(n,14466))})),PaginationItem:(0,i.lazy)((function(){return n.e(7026).then(n.bind(n,27026))})),Paper:(0,i.lazy)((function(){return n.e(7305).then(n.bind(n,97305))})),Popover:(0,i.lazy)((function(){return n.e(1868).then(n.bind(n,81868))})),Popper:(0,i.lazy)((function(){return n.e(8885).then(n.bind(n,98885))})),Portal:(0,i.lazy)((function(){return n.e(6512).then(n.bind(n,46512))})),Radio:(0,i.lazy)((function(){return n.e(8420).then(n.bind(n,88420))})),RadioGroup:(0,i.lazy)((function(){return n.e(413).then(n.bind(n,70413))})),Rating:(0,i.lazy)((function(){return n.e(1567).then(n.bind(n,31567))})),ScopedCssBaseline:(0,i.lazy)((function(){return n.e(6671).then(n.bind(n,26671))})),Select:(0,i.lazy)((function(){return n.e(5529).then(n.bind(n,15529))})),Skeleton:(0,i.lazy)((function(){return n.e(5049).then(n.bind(n,5049))})),Slider:(0,i.lazy)((function(){return n.e(173).then(n.bind(n,20173))})),Snackbar:(0,i.lazy)((function(){return Promise.all([n.e(8634),n.e(1121)]).then(n.bind(n,21121))})),SnackbarContent:(0,i.lazy)((function(){return n.e(3883).then(n.bind(n,3883))})),SpeedDial:(0,i.lazy)((function(){return n.e(7273).then(n.bind(n,87273))})),SpeedDialAction:(0,i.lazy)((function(){return n.e(8108).then(n.bind(n,60003))})),SpeedDialIcon:(0,i.lazy)((function(){return n.e(2051).then(n.bind(n,72051))})),Stack:(0,i.lazy)((function(){return n.e(2590).then(n.bind(n,52590))})),Step:(0,i.lazy)((function(){return n.e(1729).then(n.bind(n,71729))})),StepButton:(0,i.lazy)((function(){return n.e(9822).then(n.bind(n,49822))})),StepConnector:(0,i.lazy)((function(){return n.e(2058).then(n.bind(n,62058))})),StepLabel:(0,i.lazy)((function(){return n.e(9946).then(n.bind(n,59946))})),StepIcon:(0,i.lazy)((function(){return n.e(4646).then(n.bind(n,24646))})),Stepper:(0,i.lazy)((function(){return n.e(7323).then(n.bind(n,37323))})),SvgIcon:(0,i.lazy)((function(){return n.e(201).then(n.bind(n,10201))})),Switch:(0,i.lazy)((function(){return n.e(4971).then(n.bind(n,84971))})),Tab:(0,i.lazy)((function(){return n.e(2332).then(n.bind(n,92332))})),Table:(0,i.lazy)((function(){return n.e(1148).then(n.bind(n,1148))})),TableBody:(0,i.lazy)((function(){return n.e(4634).then(n.bind(n,94634))})),TableCell:(0,i.lazy)((function(){return n.e(904).then(n.bind(n,80904))})),TableContainer:(0,i.lazy)((function(){return n.e(8725).then(n.bind(n,18725))})),TableFooter:(0,i.lazy)((function(){return n.e(9774).then(n.bind(n,89774))})),TableHead:(0,i.lazy)((function(){return n.e(3321).then(n.bind(n,65981))})),TablePagination:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(8542)]).then(n.bind(n,22429))})),TableRow:(0,i.lazy)((function(){return n.e(966).then(n.bind(n,80966))})),TableSortLabel:(0,i.lazy)((function(){return n.e(4339).then(n.bind(n,14339))})),Tabs:(0,i.lazy)((function(){return n.e(7811).then(n.bind(n,17811))})),TextField:(0,i.lazy)((function(){return n.e(9558).then(n.bind(n,89558))})),TextareaAutosize:(0,i.lazy)((function(){return n.e(5064).then(n.bind(n,48599))})),ToggleButton:(0,i.lazy)((function(){return n.e(9099).then(n.bind(n,49099))})),ToggleButtonGroup:(0,i.lazy)((function(){return n.e(7390).then(n.bind(n,7390))})),Toolbar:(0,i.lazy)((function(){return n.e(4172).then(n.bind(n,84172))})),Tooltip:(0,i.lazy)((function(){return n.e(8926).then(n.bind(n,58926))})),Typography:(0,i.lazy)((function(){return n.e(9284).then(n.bind(n,49284))}))},Y=Object.fromEntries(Object.entries(X).map((function(e){var t=(0,a.Z)(e,2),n=t[0],s=t[1],u=i.forwardRef((function(e,t){return(0,o.jsx)(i.Suspense,{fallback:(0,o.jsx)("div",{}),children:(0,o.jsx)(s,(0,r.Z)((0,r.Z)({},e),{},{ref:t}))})}));return u.displayName=n,[n,u]}))),Q=Object.fromEntries(Object.entries(Y).map((function(e){var t=(0,a.Z)(e,2);return["@material-ui/core/"+t[0],t[1]]}))),K=Object.fromEntries(Object.entries(Y).map((function(e){var t=(0,a.Z)(e,2);return["@mui/material/"+t[0],t[1]]}))),$=(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(1356),n.e(2942),n.e(3462)]).then(n.bind(n,57054))})),ee=(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(1356),n.e(2942),n.e(2623)]).then(n.bind(n,82535))})),te=(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(1356),n.e(2942),n.e(3898)]).then(n.bind(n,39493))})),ne={DataGrid:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.DataGrid}}))})),GridActionsCellItem:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridActionsCellItem}}))})),GridAddIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridAddIcon}}))})),GridArrowDownwardIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridArrowDownwardIcon}}))})),GridArrowUpwardIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridArrowUpwardIcon}}))})),GridCellCheckboxForwardRef:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridCellCheckboxForwardRef}}))})),GridCellCheckboxRenderer:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridCellCheckboxRenderer}}))})),GridCheckCircleIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridCheckCircleIcon}}))})),GridCheckIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridCheckIcon}}))})),GridCloseIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridCloseIcon}}))})),GridColumnHeaderSeparator:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridColumnHeaderSeparator}}))})),GridColumnHeaderSortIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridColumnHeaderSortIcon}}))})),GridColumnIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridColumnIcon}}))})),GridColumnMenu:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridColumnMenu}}))})),GridColumnMenuContainer:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridColumnMenuContainer}}))})),GridDragIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridDragIcon}}))})),GridExpandMoreIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridExpandMoreIcon}}))})),GridFilterAltIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridFilterAltIcon}}))})),GridFilterForm:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridFilterForm}}))})),GridFilterListIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridFilterListIcon}}))})),GridFilterPanel:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridFilterPanel}}))})),GridFooter:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridFooter}}))})),GridFooterContainer:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridFooterContainer}}))})),GridHeader:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridHeader}}))})),GridHeaderCheckbox:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridHeaderCheckbox}}))})),GridKeyboardArrowRight:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridKeyboardArrowRight}}))})),GridLoadIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridLoadIcon}}))})),GridLoadingOverlay:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridLoadingOverlay}}))})),GridMenuIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridMenuIcon}}))})),GridMoreVertIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridMoreVertIcon}}))})),GridNoRowsOverlay:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridNoRowsOverlay}}))})),GridOverlay:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridOverlay}}))})),GridPagination:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridPagination}}))})),GridPanel:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridPanel}}))})),GridPanelWrapper:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridPanelWrapper}}))})),GridPreferencesPanel:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridPreferencesPanel}}))})),GridRemoveIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridRemoveIcon}}))})),GridRoot:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridRoot}}))})),GridRowCount:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridRowCount}}))})),GridSaveAltIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridSaveAltIcon}}))})),GridSearchIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridSearchIcon}}))})),GridSelectedRowCount:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridSelectedRowCount}}))})),GridSeparatorIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridSeparatorIcon}}))})),GridTableRowsIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridTableRowsIcon}}))})),GridToolbar:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridToolbar}}))})),GridToolbarColumnsButton:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridToolbarColumnsButton}}))})),GridToolbarContainer:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridToolbarContainer}}))})),GridToolbarDensitySelector:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridToolbarDensitySelector}}))})),GridToolbarExport:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridToolbarExport}}))})),GridToolbarExportContainer:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridToolbarExportContainer}}))})),GridToolbarFilterButton:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridToolbarFilterButton}}))})),GridTripleDotsVerticalIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridTripleDotsVerticalIcon}}))})),GridViewHeadlineIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridViewHeadlineIcon}}))})),GridViewStreamIcon:(0,i.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(5165)]).then(n.bind(n,72652)).then((function(e){return{default:e.GridViewStreamIcon}}))}))},re=Object.fromEntries(Object.entries(ne).map((function(e){var t=(0,a.Z)(e,2),n=t[0],s=t[1],u=i.forwardRef((function(e,t){return(0,o.jsx)(i.Suspense,{fallback:(0,o.jsx)("div",{}),children:(0,o.jsx)(s,(0,r.Z)((0,r.Z)({},e),{},{ref:t}))})}));return u.displayName=n,[n,u]}))),ae=i.forwardRef((function(e,t){return(0,o.jsx)(i.Suspense,{fallback:(0,o.jsx)("div",{}),children:(0,o.jsx)($,(0,r.Z)((0,r.Z)({},e),{},{ref:t}))})}));ae.displayName="Attributes";var ie=i.forwardRef((function(e,t){return(0,o.jsx)(i.Suspense,{fallback:(0,o.jsx)("div",{}),children:(0,o.jsx)(ee,(0,r.Z)((0,r.Z)({},e),{},{ref:t}))})}));ie.displayName="FeatureDetails";var oe=i.forwardRef((function(e,t){return(0,o.jsx)(i.Suspense,{fallback:(0,o.jsx)("div",{}),children:(0,o.jsx)(te,(0,r.Z)((0,r.Z)({},e),{},{ref:t}))})}));oe.displayName="BaseCard";var se=(0,r.Z)((0,r.Z)((0,r.Z)({mobx:l,"mobx-state-tree":d,react:i,"react/jsx-runtime":s,"react-dom":c,"mobx-react":f,"@mui/x-data-grid":(0,r.Z)({useGridApiContext:w.l,useGridApiRef:x.A,useGridRootProps:k.B},re),"@mui/material/utils":b,"@material-ui/core/utils":b,"tss-react/mui":{makeStyles:p.ZL},"@material-ui/core":(0,r.Z)((0,r.Z)({},Y),{},{useTheme:v.Z,alpha:m.Fq,makeStyles:function(e){var t=(0,p.ZL)()(e);return function(){return t().classes}}}),"@mui/material":(0,r.Z)((0,r.Z)({},Y),{},{alpha:m.Fq,useTheme:v.Z}),"prop-types":g(),"@mui/material/styles":y,"@material-ui/core/styles":y},Q),K),{},{"@material-ui/lab/ToggleButton":X.ToggleButton,"@material-ui/lab/ToggleButtonGroup":X.ToggleButtonGroup,"@material-ui/lab/Autocomplete":X.Autocomplete,"@material-ui/lab/Alert":X.Alert,"@material-ui/lab":{Alert:X.Alert,Autocomplete:X.Autocomplete,ToggleButton:X.ToggleButton,ToggleButtonGroup:X.ToggleButtonGroup},"@jbrowse/core/Plugin":E.Z,"@jbrowse/core/pluggableElementTypes":S,"@jbrowse/core/pluggableElementTypes/ViewType":T.Z,"@jbrowse/core/pluggableElementTypes/AdapterType":P.Z,"@jbrowse/core/pluggableElementTypes/DisplayType":M.Z,"@jbrowse/core/pluggableElementTypes/TrackType":R.Z,"@jbrowse/core/pluggableElementTypes/WidgetType":A.Z,"@jbrowse/core/pluggableElementTypes/models":I,"@jbrowse/core/pluggableElementTypes/renderers/ServerSideRendererType":L,"@jbrowse/core/pluggableElementTypes/renderers/CircularChordRendererType":N.Z,"@jbrowse/core/pluggableElementTypes/renderers/BoxRendererType":F,"@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType":j,"@jbrowse/core/pluggableElementTypes/renderers/RendererType":D,"@jbrowse/core/configuration":B,"@jbrowse/core/util/types/mst":U,"@jbrowse/core/ui":V,"@jbrowse/core/util":z,"@jbrowse/core/util/color":O,"@jbrowse/core/util/layouts":W,"@jbrowse/core/util/tracks":H,"@jbrowse/core/util/Base1DViewModel":C.Z,"@jbrowse/core/util/io":G,"@jbrowse/core/util/mst-reflection":q,"@jbrowse/core/util/rxjs":_,"@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail":{Attributes:ae,FeatureDetails:ie,BaseCard:oe},"@jbrowse/core/data_adapters/BaseAdapter":Z}),ue=Object.keys(se),ce=ue.filter((function(e){return!J.includes(e)}));if(ce.length>0)throw new Error("The following modules are in the modules libs, but not the re-exports list: ".concat(ce.join(", ")));var le=J.filter((function(e){return!ue.includes(e)}));if(le.length)throw new Error("The following modules are in the re-exports list, but not the modules libs: ".concat(le.join(", ")));var de=se},52185:function(e,t,n){"use strict";n.d(t,{R:function(){return u},Z:function(){return s}});var r=n(45754),a=n(13820),i=n(9249),o=n(87371),s=function(){function e(t){(0,i.Z)(this,e),this.label=void 0,this.renderingComponent=void 0,this.displayString=void 0,this.matchedAttribute=void 0,this.matchedObject=void 0,this.textSearchAdapter=void 0,this.relevance=void 0,this.trackId=void 0,this.score=void 0,this.locString=void 0,this.results=void 0,this.label=t.label,this.locString=t.locString,this.renderingComponent=t.renderingComponent,this.displayString=t.displayString,this.matchedAttribute=t.matchedAttribute,this.matchedObject=t.matchedObject,this.textSearchAdapter=t.textSearchAdapter,this.relevance=t.relevance,this.trackId=t.trackId,this.score=t.score||1,this.results=t.results||[]}return(0,o.Z)(e,[{key:"getLabel",value:function(){return this.label}},{key:"getDisplayString",value:function(){return this.displayString||this.label}},{key:"getRenderingComponent",value:function(){return this.renderingComponent}},{key:"getTrackId",value:function(){return this.trackId}},{key:"getScore",value:function(){return this.score}},{key:"updateScore",value:function(e){return this.score=e,this.score}},{key:"getId",value:function(){return"".concat(this.getLabel(),"-").concat(this.getLocation(),"-").concat(this.getTrackId())}},{key:"hasLocation",value:function(){return!!this.locString}},{key:"getLocation",value:function(){return this.locString}},{key:"getComboResults",value:function(){return this.results}}]),e}(),u=function(e){(0,r.Z)(n,e);var t=(0,a.Z)(n);function n(e){var r,a;return(0,i.Z)(this,n),(a=t.call(this,e)).refName=void 0,a.refName=null!==(r=e.refName)&&void 0!==r?r:"",a}return(0,o.Z)(n,[{key:"getLocation",value:function(){return this.refName}}]),n}(s)},76085:function(e,t,n){"use strict";n.d(t,{B:function(){return w},c:function(){return b}});var r=n(56666),a=n(96234),i=n(33028),o=n(40909),s=n(29206),u=n(32665),c=n(81073);var l={stringArray:o.types.array(o.types.string),stringArrayMap:o.types.map(o.types.array(o.types.string)),numberMap:o.types.map(o.types.number),boolean:o.types.boolean,color:o.types.refinement("Color",o.types.string,(function(){return!0})),integer:o.types.integer,number:o.types.number,string:o.types.string,text:o.types.string,fileLocation:s.FileLocation,frozen:o.types.frozen()},d={stringArray:[],stringArrayMap:{},numberMap:{},boolean:!0,color:"black",integer:1,number:1,string:"",text:"",fileLocation:{uri:"/path/to/resource.txt",locationType:"UriLocation"},frozen:{}},f=function(e){return{views:{get valueJSON(){return e.value}}}},p=function(e){return{views:{get valueJSON(){return JSON.stringify(e.value)}}}},h={fileLocation:p,number:f,integer:f,boolean:f,frozen:p,stringArray:function(e){return{views:{get valueJSON(){return JSON.stringify(e.value)}},actions:{add:function(t){e.value.push(t)},removeAtIndex:function(t){e.value.splice(t,1)},setAtIndex:function(t,n){e.value[t]=n}}}},stringArrayMap:function(e){return{views:{get valueJSON(){return JSON.stringify(e.value)}},actions:{add:function(t,n){e.value.set(t,n)},remove:function(t){e.value.delete(t)},addToKey:function(t,n){var r=e.value.get(t);if(!r)throw new Error("".concat(t," not found"));r.push(n)},removeAtKeyIndex:function(t,n){var r=e.value.get(t);if(!r)throw new Error("".concat(t," not found"));r.splice(n,1)},setAtKeyIndex:function(t,n,r){var a=e.value.get(t);if(!a)throw new Error("".concat(t," not found"));a[n]=r}}}},numberMap:function(e){return{views:{get valueJSON(){return JSON.stringify(e.value)}},actions:{add:function(t,n){e.value.set(t,n)},remove:function(t){e.value.delete(t)}}}}},g=o.types.refinement("JexlString",o.types.string,(function(e){return e.startsWith("jexl:")}));var m=n(47741);function v(e){return Array.isArray(e)&&0===e.length}function y(e,t,n){var f,p={};if(n.explicitlyTyped&&(p.type=o.types.optional(o.types.literal(e),e)),n.explicitIdentifier&&n.implicitIdentifier)throw new Error("Cannot have both explicit and implicit identifiers in ".concat(e));n.explicitIdentifier?"string"===typeof n.explicitIdentifier?(p[n.explicitIdentifier]=o.types.identifier,f=n.explicitIdentifier):(p.id=o.types.identifier,f="id"):n.implicitIdentifier&&("string"===typeof n.implicitIdentifier?(p[n.implicitIdentifier]=s.ElementId,f=n.implicitIdentifier):(p.id=s.ElementId,f="id"));var y={isJBrowseConfigurationSchema:!0,jbrowseSchema:{modelName:e,definition:t,options:n}};Object.entries(t).forEach((function(t){var n=(0,a.Z)(t,2),r=n[0],i=n[1];if((0,o.isType)(i)&&(0,o.isLateType)(i)||(0,m.qN)(i))p[r]=i;else if("string"===typeof i||"number"===typeof i)y[r]=i;else{if("object"!==typeof i)throw new Error('invalid configuration schema definition, "'.concat(r,'" must be either a valid configuration slot definition, a constant, or a nested configuration schema'));if(!i.type)throw new Error("no type set for config slot ".concat(e,".").concat(r));try{p[r]=function(e,t){var n=t.description,r=void 0===n?"":n,a=t.model,i=t.type,s=t.defaultValue,f=t.contextVariable,p=void 0===f?[]:f;if(!i)throw new Error("type name required");if(a||(a=l[i]),!a)throw new Error('no builtin config slot type "'.concat(i,"\", and no 'model' param provided"));if(void 0===s)throw new Error("no 'defaultValue' provided");var m="".concat(e.charAt(0).toUpperCase()).concat(e.slice(1),"ConfigSlot"),v=o.types.model(m,{name:o.types.literal(e),description:o.types.literal(r),type:o.types.literal(i),value:o.types.optional(o.types.union(g,a),s)}).volatile((function(){return{contextVariable:p}})).views((function(e){return{get isCallback(){return String(e.value).startsWith("jexl:")}}})).views((function(e){return{get expr(){if(e.isCallback){var t=(0,c.getEnv)(e).pluginManager;return t||"undefined"!==typeof jest||console.warn("no pluginManager detected on config env (if you dynamically instantiate a config, for example in renderProps for your display model, check that you add the env argument)"),(0,u.P)(String(e.value),null===t||void 0===t?void 0:t.jexl)}return{evalSync:function(){return e.value}}},get valueJSON(){var t;if(!e.isCallback)return null!==(t=e.value)&&void 0!==t&&t.toJSON?t.toJSON():'"'.concat(t,'"')}}})).preProcessSnapshot((function(t){return"object"===typeof t&&t.name===e?t:{name:e,description:r,type:i,value:t}})).postProcessSnapshot((function(e){return"object"===typeof e.value?JSON.stringify(e.value)!==JSON.stringify(s)?e.value:void 0:e.value!==s?e.value:void 0})).actions((function(e){return{set:function(t){e.value=t},reset:function(){e.value=s},convertToCallback:function(){e.isCallback||(e.value="jexl:".concat(e.valueJSON||"''"))},convertToValue:function(){if(e.isCallback){try{var t=e.expr.evalSync();if(void 0!==t)return void(e.value=t)}catch(n){}if(e.value=s,e.isCallback){if(!(i in d))throw new Error("no fallbackDefault defined for type ".concat(i));e.value=d[i]}}}}}));h[i]&&(v=v.extend(h[i]));var y=o.types.optional(v,{name:e,type:i,description:r,value:s});return Object.defineProperty(y,"isJBrowseConfigurationSlot",{value:!0}),y}(r,i)}catch(s){throw new Error("invalid config slot definition for ".concat(e,".").concat(r,": ").concat(s))}}}));var b=o.types.model("".concat(e,"ConfigurationSchema"),p).actions((function(e){return{setSubschema:function(t,n){if(!(0,m.qN)(p[t]))throw new Error("".concat(t," is not a subschema, cannot replace"));var r=(0,o.isStateTreeNode)(n)?n:p[t].create(n);return e[t]=r,r}}}));Object.keys(y).length&&(b=b.volatile((function(){return y}))),n.actions&&(b=b.actions(n.actions)),n.views&&(b=b.views(n.views)),n.extend&&(b=b.extend(n.extend));var w=f?(0,r.Z)({},f,"placeholderId"):{},x=n.explicitlyTyped?(0,i.Z)({type:e},w):w,k=(0,o.getSnapshot)(b.create(x));return b=b.postProcessSnapshot((function(e){for(var t,n={},r=!0,i=0,o=Object.entries(e);i<o.length;i++){var s=(0,a.Z)(o[i],2),u=s[0],c=s[1];r&&("object"===typeof k[u]&&"object"===typeof c?JSON.stringify(k[u])!==JSON.stringify(c)&&(r=!1):k[u]!==c&&(r=!1)),void 0!==c&&void 0===y[u]&&("object"!==typeof(t=c)||Array.isArray(t)||null===t||0!==Object.keys(t).length)&&!v(c)&&(n[u]=c)}return r?{}:n})),n.preProcessSnapshot&&(b=b.preProcessSnapshot(n.preProcessSnapshot)),o.types.optional(b,x)}function b(e,t,n){var r=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"!==typeof e)throw new Error("first arg must be string name of the model that this config schema goes with");var a=t,o=r;return null!==(n=r.baseConfiguration)&&void 0!==n&&n.jbrowseSchemaDefinition&&(a=(0,i.Z)((0,i.Z)({},r.baseConfiguration.jbrowseSchemaDefinition),a),delete(o=(0,i.Z)((0,i.Z)({},r.baseConfiguration.jbrowseSchemaOptions),r)).baseConfiguration),{schemaDefinition:a,options:o}}(e,t,n),a=r.schemaDefinition,o=r.options,s=y(e,a,o);return s.isJBrowseConfigurationSchema=!0,s.jbrowseSchemaDefinition=a,s.jbrowseSchemaOptions=o,s}function w(e){return o.types.union(o.types.reference(e),e)}},47741:function(e,t,n){"use strict";n.d(t,{G:function(){return u},Pb:function(){return c},bc:function(){return s},mu:function(){return f},pS:function(){return o},qN:function(){return l},yt:function(){return d}});var r=n(68079),a=n(40909),i=n(83265);function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)throw new TypeError("must provide conf object to read");if(!t)return JSON.parse(JSON.stringify((0,a.getSnapshot)(e)));if("string"===typeof t){var r=e[t];if(!r&&(0,a.isStateTreeNode)(e)&&(0,a.isMapType)((0,a.getType)(e))&&(r=e.get(t)),!r)return;if(r.expr){var i=r.expr.evalSync(n);return(0,a.isStateTreeNode)(i)?JSON.parse(JSON.stringify((0,a.getSnapshot)(i))):i}return(0,a.isStateTreeNode)(r)?JSON.parse(JSON.stringify((0,a.getSnapshot)(r))):r}if(Array.isArray(t)){var s=t[0];if(t.length>1){var u=t.slice(1),c=e[s];return!c&&(0,a.isStateTreeNode)(e)&&(0,a.isMapType)((0,a.getType)(e))&&(c=e.get(s)),c?o(c,u,n):void 0}return o(e,s,n)}throw new TypeError("slotPath must be a string or array")}function s(e,t,n){if(!e)throw new TypeError("must provide a model object");var r=e.configuration;if(d(r))return o(r,t,n);throw new TypeError("cannot getConf on this model, it has no configuration")}function u(e){if((0,a.isType)(e)&&(e=(0,i.resolveLateType)(e),(0,a.isUnionType)(e))){var t=[];return(0,i.getUnionSubTypes)(e).forEach((function(e){var n=u(e=(0,i.resolveLateType)(e));n.length||(n=[(0,i.getDefaultValue)(e).type]);if(!n[0])throw new Error("invalid config schema type ".concat(e));t.push.apply(t,(0,r.Z)(n))})),t}return[]}function c(e){if((0,a.isType)(e)){if((0,a.isModelType)(e)&&("isJBrowseConfigurationSchema"in e||e.name.includes("ConfigurationSchema")))return!0;if((0,a.isLateType)(e))return!0}return!1}function l(e){return!!(0,a.isType)(e)&&(!!c(e)||((0,a.isUnionType)(e)?(0,i.getUnionSubTypes)(e).every((function(e){return l(e)||"undefined"===e.name})):!(!(0,a.isOptionalType)(e)||!l((0,i.getSubType)(e)))||(!(!(0,a.isArrayType)(e)||!l((0,i.getSubType)(e)))||!(!(0,a.isMapType)(e)||!l((0,i.getSubType)(e))))))}function d(e){return(0,a.isStateTreeNode)(e)&&l((0,a.getType)(e))}function f(e){return"object"===typeof e&&null!==e&&"isJBrowseConfigurationSlot"in e}},20783:function(e,t,n){"use strict";function r(e){return"getRegions"in e&&"getFeatures"in e}function a(e){return"getRegions"in e}function i(e){return"getFeatures"in e}function o(e){return"getRefNameAliases"in e}function s(e){return"searchIndex"in e}n.r(t),n.d(t,{BaseAdapter:function(){return h},BaseFeatureDataAdapter:function(){return P},BaseSequenceAdapter:function(){return M},isFeatureAdapter:function(){return i},isRefNameAliasAdapter:function(){return o},isRegionsAdapter:function(){return a},isSequenceAdapter:function(){return r},isTextSearchAdapter:function(){return s}});var u=n(9249),c=n(87371),l=n(40909),d=n(9077),f=n(37813),p=(0,d.ConfigurationSchema)("empty",{}),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p.create(),n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;if((0,u.Z)(this,e),this.config=t,this.getSubAdapter=n,this.pluginManager=r,this.id=void 0,"undefined"===typeof jest){var a=(0,l.isStateTreeNode)(t)?(0,l.getSnapshot)(t):t;this.id="".concat((0,f.Z)(a))}else this.id="test"}return(0,c.Z)(e,[{key:"getConf",value:function(e){return(0,d.readConfObject)(this.config,e)}}]),e}();h.capabilities=[];var g=n(33028),m=n(68079),v=n(32723),y=n(34795),b=n(45754),w=n(13820),x=n(16095),k=n(81450),Z=n(95915),C=n(26131),S=n(81073),T=n(66518),P=function(e){(0,b.Z)(n,e);var t=(0,w.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"getHeader",value:function(){var e=(0,y.Z)((0,v.Z)().mark((function e(t){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMetadata",value:function(){var e=(0,y.Z)((0,v.Z)().mark((function e(t){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getFeaturesInRegion",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,C.ObservableCreate)(function(){var r=(0,y.Z)((0,v.Z)().mark((function r(a){var i;return(0,v.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.hasDataForRefName(e.refName,n);case 2:i=r.sent,(0,S.checkAbortSignal)(n.signal),i?t.getFeatures(e,n).subscribe(a):a.complete();case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}},{key:"getFeaturesInMultipleRegions",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return x.T.apply(void 0,(0,m.Z)(e.map((function(e){return t.getFeaturesInRegion(e,n)}))))}},{key:"hasDataForRefName",value:function(){var e=(0,y.Z)((0,v.Z)().mark((function e(t){var n,r,a=arguments;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},e.next=3,this.getRefNames(n);case 3:return r=e.sent,e.abrupt("return",r.includes(t));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRegionQuantitativeStats",value:function(){var e=(0,y.Z)((0,v.Z)().mark((function e(t,n){var r;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.getFeatures(t,n),e.abrupt("return",(0,T.fK)(t,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getMultiRegionQuantitativeStats",value:function(){var e=(0,y.Z)((0,v.Z)().mark((function e(){var t,n,r,a,i,o,s,u,c,l=this,d=arguments;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>1?d[1]:void 0,(t=d.length>0&&void 0!==d[0]?d[0]:[]).length){e.next=4;break}return e.abrupt("return",(0,T.fY)());case 4:return e.next=6,Promise.all(t.map((function(e){return l.getRegionQuantitativeStats(e,n)})));case 6:return r=e.sent,a=(0,S.max)(r.map((function(e){return e.scoreMax}))),i=(0,S.min)(r.map((function(e){return e.scoreMin}))),o=(0,S.sum)(r.map((function(e){return e.scoreSum}))),s=(0,S.sum)(r.map((function(e){return e.scoreSumSquares}))),u=(0,S.sum)(r.map((function(e){return e.featureCount}))),c=(0,S.sum)(r.map((function(e){return e.basesCovered}))),e.abrupt("return",(0,T.I9)({scoreMin:i,scoreMax:a,featureCount:u,basesCovered:c,scoreSumSquares:s,scoreSum:o}));case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getRegionFeatureDensityStats",value:function(e,t){var n=this,r=+Date.now(),a=function(){var r=(0,y.Z)((0,v.Z)().mark((function r(a,o){var s,u,c,l;return(0,v.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=e.start,u=e.end,c=.75*s+.25*u,r.next=4,(0,k.z)(n.getFeatures((0,g.Z)((0,g.Z)({},e),{},{start:Math.max(0,Math.round(c-a/2)),end:Math.min(Math.round(c+a/2),u)}),t).pipe((0,Z.q)()));case 4:return l=r.sent,r.abrupt("return",i(a,{featureDensity:l.length/a},l.length,o));case 6:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}(),i=function(){var t=(0,y.Z)((0,v.Z)().mark((function t(n,i,o,s){var u,c;return(0,v.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(u=e.end-e.start,!(o>=70||2*n>u)){t.next=5;break}return t.abrupt("return",i);case 5:if(!(s<=5e3)){t.next=12;break}return c=+Date.now(),s+=c-r,r=c,t.abrupt("return",a(2*n,s));case 12:return console.warn("Stats estimation reached timeout, or didn't get enough features"),t.abrupt("return",{featureDensity:Number.POSITIVE_INFINITY});case 14:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}();return a(1e3,0)}},{key:"getMultiRegionFeatureDensityStats",value:function(){var e=(0,y.Z)((0,v.Z)().mark((function e(t,n){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length){e.next=2;break}throw new Error("No regions supplied");case 2:return e.abrupt("return",this.getRegionFeatureDensityStats(t[0],n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(h),M=function(e){(0,b.Z)(n,e);var t=(0,w.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"getMultiRegionFeatureDensityStats",value:function(){var e=(0,y.Z)((0,v.Z)().mark((function e(){return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{featureDensity:0});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),n}(P)},3011:function(e,t,n){"use strict";n.d(t,{Yr:function(){return f},uP:function(){return l}});var r=n(32723),a=n(41361),i=n(96234),o=n(34795),s=n(37813);function u(e){return"".concat((0,s.Z)(e))}var c={};function l(e,t,n){return d.apply(this,arguments)}function d(){return(d=(0,o.Z)((0,r.Z)().mark((function e(t,n,a){var i,o,s,d,f,p,h,g,m,v;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=u(a),c[i]){e.next=21;break}if(o=null===a||void 0===a?void 0:a.type){e.next=5;break}throw new Error("could not determine adapter type from adapter config snapshot ".concat(JSON.stringify(a)));case 5:if(s=t.getAdapterType(o)){e.next=8;break}throw new Error("unknown data adapter type ".concat(o));case 8:if(d=s.configSchema.create(a,{pluginManager:t}),f=l.bind(null,t,n),p=s.AdapterClass,h=s.getAdapterClass,e.t0=p,e.t0){e.next=16;break}return e.next=15,h();case 15:e.t0=e.sent;case 16:if(g=e.t0){e.next=19;break}throw new Error("Failed to get adapter");case 19:m=new g(d,f,t),c[i]={dataAdapter:m,sessionIds:new Set([n])};case 21:return(v=c[i]).sessionIds.add(n),e.abrupt("return",v);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){var t=0,n=Object.keys(e);if(1===n.length&&"sessionId"===n[0]){var r=e.sessionId;Object.entries(c).forEach((function(e){var n=(0,i.Z)(e,2),a=n[0],o=n[1];o.sessionIds.delete(r),0===o.sessionIds.size&&(t+=1,delete c[a])}))}else Object.values(c).forEach((function(t){if(t.dataAdapter.freeResources){var n,r=e.regions||(e.region?[e.region]:[]),i=(0,a.Z)(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;void 0!==o.refName&&t.dataAdapter.freeResources(o)}}catch(s){i.e(s)}finally{i.f()}}else console.warn(t.dataAdapter,"does not implement freeResources")}));return t}},93029:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(32723),a=n(34795),i=n(87371),o=n(9249),s=n(45754),u=n(13820),c=function(e){(0,s.Z)(n,e);var t=(0,u.Z)(n);function n(e){var i;if((0,o.Z)(this,n),(i=t.call(this,e)).AdapterClass=void 0,i.getAdapterClass=void 0,i.configSchema=void 0,i.adapterCapabilities=void 0,i.adapterMetadata=void 0,"AdapterClass"in e)i.AdapterClass=e.AdapterClass,i.getAdapterClass=(0,a.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.AdapterClass);case 1:case"end":return t.stop()}}),t)})));else{if(!("getAdapterClass"in e))throw new Error("no AdapterClass or getAdapterClass is defined for adapter type ".concat(i.name));i.getAdapterClass=e.getAdapterClass}return i.configSchema=e.configSchema,i.adapterCapabilities=e.adapterCapabilities||[],i.adapterMetadata=e.adapterMetadata,i}return(0,i.Z)(n)}(n(78008).Z)},62503:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(87371),a=n(9249),i=n(45754),o=n(13820),s=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;if((0,a.Z)(this,n),(r=t.call(this,e)).ReactComponent=void 0,r.stateModel=void 0,r.ReactComponent=e.ReactComponent,r.stateModel=e.stateModel,!r.ReactComponent)throw new Error("no ReactComponent defined for view ".concat(r.name));if(!r.stateModel)throw new Error("no stateModel defined for view ".concat(r.name));return r}return(0,r.Z)(n)}(n(78008).Z)},58096:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(87371),a=n(9249),i=n(45754),o=n(13820),s=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;if((0,a.Z)(this,n),(r=t.call(this,e)).stateModel=void 0,r.configSchema=void 0,r.description=void 0,r.url=void 0,r.configEditorComponent=void 0,r.stateModel=e.stateModel,r.configSchema=e.configSchema,r.description=e.description,r.url=e.url,r.configEditorComponent=e.configEditorComponent,!r.stateModel)throw new Error("no stateModel defined for connection ".concat(r.name));if(!r.configSchema)throw new Error("no configSchema defined for connection ".concat(r.name));return r}return(0,r.Z)(n)}(n(78008).Z)},81575:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(87371),a=n(9249),i=n(45754),o=n(13820),s=n(78008),u=n(83265),c=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;if((0,a.Z)(this,n),(r=t.call(this,e)).stateModel=void 0,r.configSchema=void 0,r.ReactComponent=void 0,r.trackType=void 0,r.subDisplay=void 0,r.viewType=void 0,r.stateModel=e.stateModel,r.subDisplay=e.subDisplay,r.configSchema=e.configSchema,r.ReactComponent=e.ReactComponent,r.trackType=e.trackType,r.viewType=e.viewType,!r.stateModel)throw new Error("no stateModel defined for display ".concat(r.name));if(!r.configSchema)throw new Error("no configSchema provided for display ".concat(r.name));if(!r.ReactComponent)throw new Error("no ReactComponent provided for display ".concat(r.name));if(!r.trackType)throw new Error("no trackType provided for display ".concat(r.name));if(!r.viewType)throw new Error("no viewType provided for display ".concat(r.name));if(!(0,u.getDefaultValue)(r.configSchema).type){var i=r.configSchema?r.configSchema.name:"UNKNOWN";throw new Error("".concat(i," is not explicitlyTyped"))}return r}return(0,r.Z)(n)}(s.Z)},15875:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(87371),a=n(9249),i=n(45754),o=n(13820),s=n(78008),u=n(83265),c=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;if((0,a.Z)(this,n),(r=t.call(this,e)).stateModel=void 0,r.configSchema=void 0,r.stateModel=e.stateModel,r.configSchema=e.configSchema,!r.stateModel)throw new Error("no stateModel defined for internet account type ".concat(r.name));if(!r.configSchema)throw new Error("no configSchema provided for internet account type ".concat(r.name));if(!(0,u.getDefaultValue)(r.configSchema).type){var i=r.configSchema?r.configSchema.name:"UNKNOWN";throw new Error("".concat(i," is not explicitlyTyped"))}return r}return(0,r.Z)(n)}(s.Z)},78008:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(9249),a=n(87371),i=function(){function e(t){(0,r.Z)(this,e),this.name=void 0,this.maybeDisplayName=void 0,this.name=t.name||"UNKNOWN",this.maybeDisplayName=t.displayName}return(0,a.Z)(e,[{key:"displayName",get:function(){return this.maybeDisplayName||this.name}}]),e}()},85550:function(e,t,n){"use strict";n.d(t,{Z:function(){return v}});var r=n(32723),a=n(33028),i=n(34795),o=n(9249),s=n(87371),u=n(45754),c=n(13820),l=function(e){return"object"===typeof e&&null!==e},d=function(e){return l(e)&&!(e instanceof RegExp)&&!(e instanceof Error)&&!(e instanceof Date)&&!(globalThis.Blob&&e instanceof globalThis.Blob)};function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new WeakSet;if(!n.has(e)){n.add(e);var r=function(e){return e.forEach((function(e){t(e),l(e)&&f(e,t,n)}))};Array.isArray(e)&&r(e);for(var a=0,i=Object.values(e);a<i.length;a++){var o=i[a];t(o),d(o)&&(Array.isArray(o)?r(o):f(o,t,n))}}}var p=n(78008),h=n(97891),g=n(8438),m=n(94943),v=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,o.Z)(this,n),(r=t.call(this,{})).pluginManager=e,r}return(0,s.Z)(n,[{key:"serializeArguments",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,h.getBlobMap)(),e.next=3,this.augmentLocationObjects(t,n);case 3:return e.abrupt("return",(0,a.Z)((0,a.Z)({},t),{},{blobMap:i}));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"serializeNewAuthArguments",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var a,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.pluginManager.rootModel,(0,g.dc)(a)&&!t.internetAccountPreAuthorization){e.next=3;break}return e.abrupt("return",t);case 3:if(!(i=a.findAppropriateInternetAccount(t))||"MainThreadRpcDriver"===n){e.next=8;break}return e.next=7,i.getPreAuthorizationInformation(t);case 7:t.internetAccountPreAuthorization=e.sent;case 8:return e.abrupt("return",t);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deserializeArguments",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.blobMap&&(0,h.setBlobMap)(t.blobMap),i=t.signal,e.abrupt("return",(0,a.Z)((0,a.Z)({},t),{},{signal:(0,m.k$)(i)?(0,m.ie)(i):void 0}));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"serializeReturn",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n,a){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"deserializeReturn",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n,a){var i,o,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t;case 3:i=e.sent,e.next=12;break;case 6:if(e.prev=6,e.t0=e.catch(0),!(0,g.PK)(e.t0)){e.next=11;break}throw s=null===(o=this.pluginManager.rootModel)||void 0===o?void 0:o.createEphemeralInternetAccount("HTTPBasicInternetAccount-".concat(new URL(e.t0.url).origin),{},e.t0.url),new g.Ms("Retrying with created internet account",s.internetAccountId);case 11:throw e.t0;case 12:return e.abrupt("return",i);case 13:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"augmentLocationObjects",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var a,i,o,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],f(t,(function(e){(0,g.hb)(e)&&a.push(e)})),i=0,o=a;case 3:if(!(i<o.length)){e.next=10;break}return s=o[i],e.next=7,this.serializeNewAuthArguments(s,n);case 7:i++,e.next=3;break;case 10:return e.abrupt("return",t);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(p.Z)},31145:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(87371),a=n(9249),i=n(45754),o=n(13820),s=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;if((0,a.Z)(this,n),(r=t.call(this,e)).AdapterClass=void 0,r.configSchema=void 0,r.description=void 0,r.description=e.description,r.configSchema=e.configSchema,r.AdapterClass=e.AdapterClass,!r.AdapterClass)throw new Error("no AdapterClass defined for adapter type ".concat(r.name));return r}return(0,r.Z)(n)}(n(78008).Z)},82044:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(9249),a=n(87371),i=n(45754),o=n(13820),s=n(78008),u=n(83265),c=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(e){var a;if((0,r.Z)(this,n),(a=t.call(this,e)).stateModel=void 0,a.configSchema=void 0,a.displayTypes=[],a.stateModel=e.stateModel,a.configSchema=e.configSchema,!a.stateModel)throw new Error("no stateModel defined for track ".concat(a.name));if(!a.configSchema)throw new Error("no configSchema provided for track ".concat(a.name));if(!(0,u.getDefaultValue)(a.configSchema).type){var i=a.configSchema?a.configSchema.name:"UNKNOWN";throw new Error("".concat(i," is not explicitlyTyped"))}return a}return(0,a.Z)(n,[{key:"addDisplayType",value:function(e){this.displayTypes.push(e)}}]),n}(s.Z)},39798:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(9249),a=n(87371),i=n(45754),o=n(13820),s=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(e){var a;if((0,r.Z)(this,n),(a=t.call(this,e)).ReactComponent=void 0,a.stateModel=void 0,a.displayTypes=[],a.extendedName=void 0,a.ReactComponent=e.ReactComponent,a.stateModel=e.stateModel,a.extendedName=e.extendedName,!a.ReactComponent)throw new Error("no ReactComponent defined for view ".concat(a.name));if(!a.stateModel)throw new Error("no stateModel defined for view ".concat(a.name));return a}return(0,a.Z)(n,[{key:"addDisplayType",value:function(e){this.displayTypes.push(e)}}]),n}(n(78008).Z)},66737:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(87371),a=n(9249),i=n(45754),o=n(13820),s=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;if((0,a.Z)(this,n),(r=t.call(this,e)).heading=void 0,r.configSchema=void 0,r.HeadingComponent=void 0,r.ReactComponent=void 0,r.stateModel=void 0,r.heading=e.heading,r.HeadingComponent=e.HeadingComponent,r.configSchema=e.configSchema,r.stateModel=e.stateModel,r.ReactComponent=e.ReactComponent,!r.ReactComponent)throw new Error("no ReactComponent defined for widget ".concat(r.name));if(!r.stateModel)throw new Error("no stateModel defined for widget ".concat(r.name));return r}return(0,r.Z)(n)}(n(78008).Z)},99069:function(e,t,n){"use strict";n.r(t),n.d(t,{AdapterType:function(){return d.Z},AddTrackWorkflowType:function(){return b.Z},BaseConnectionModelFactory:function(){return l.BaseConnectionModelFactory},BaseDisplay:function(){return l.BaseDisplay},BaseInternetAccountConfig:function(){return l.BaseInternetAccountConfig},BaseViewModel:function(){return l.BaseViewModel},BoxRendererType:function(){return r.default},CircularChordRendererType:function(){return i.Z},ComparativeServerSideRendererType:function(){return a.Z},ConnectionType:function(){return f.Z},DisplayType:function(){return m.Z},FeatureRendererType:function(){return s.default},InternetAccount:function(){return l.InternetAccount},InternetAccountType:function(){return v.Z},RendererType:function(){return o.default},RpcMethodType:function(){return y.Z},ServerSideRenderedContent:function(){return u.Z},ServerSideRendererType:function(){return c.default},TextSearchAdapterType:function(){return w.Z},TrackType:function(){return p.Z},ViewType:function(){return g.Z},WidgetType:function(){return h.Z},baseConnectionConfig:function(){return l.baseConnectionConfig},createBaseTrackConfig:function(){return l.createBaseTrackConfig},createBaseTrackModel:function(){return l.createBaseTrackModel}});var r=n(21339),a=n(43103),i=n(93073),o=n(86297),s=n(29637),u=n(79321),c=n(67688),l=n(77479),d=n(93029),f=n(58096),p=n(82044),h=n(66737),g=n(39798),m=n(81575),v=n(15875),y=n(85550),b=n(62503),w=n(31145)},20478:function(e,t,n){"use strict";var r=n(40909),a=n(29206);var i=r.types.model("BaseView",{id:a.ElementId,displayName:r.types.maybe(r.types.string),minimized:!1}).volatile((function(){return{width:800}})).views((function(){return{menuItems:function(){return[]}}})).actions((function(e){return{setDisplayName:function(t){e.displayName=t},setWidth:function(t){e.width=t},setMinimized:function(t){e.minimized=t}}}));t.Z=i;i.props({displayedRegions:r.types.array(a.Region)})},77479:function(e,t,n){"use strict";n.r(t),n.d(t,{BaseConnectionModelFactory:function(){return s},BaseDisplay:function(){return p},BaseInternetAccountConfig:function(){return y},BaseViewModel:function(){return u.Z},InternetAccount:function(){return w},baseConnectionConfig:function(){return a},createBaseTrackConfig:function(){return C},createBaseTrackModel:function(){return Z}});var r=n(9077);var a=(0,r.ConfigurationSchema)("BaseConnection",{name:{type:"string",defaultValue:"nameOfConnection",description:"a unique name for this connection"},assemblyNames:{type:"stringArray",defaultValue:[],description:"optional list of names of assemblies in this connection"}},{explicitlyTyped:!0,explicitIdentifier:"connectionId"}),i=n(68079),o=n(40909);var s=function(e){return o.types.model("Connection",{name:o.types.identifier,tracks:o.types.array(e.pluggableConfigSchemaType("track")),configuration:(0,r.ConfigurationReference)(a)}).actions((function(e){return{afterAttach:function(){0===e.tracks.length&&e.connect(e.configuration)},addTrackConf:function(t){var n=e.tracks.push(t);return e.tracks[n-1]},addTrackConfs:function(t){var n,r=(n=e.tracks).push.apply(n,(0,i.Z)(t));return e.tracks.slice(r-1-t.length,r-1)},setTrackConfs:function(t){return e.tracks=(0,o.cast)(t),e.tracks},clear:function(){}}}))},u=n(20478),c=n(33028),l=n(97891),d=n(81073),f=n(29206);var p=o.types.model("BaseDisplay",{id:f.ElementId,type:o.types.string,rpcDriverName:o.types.maybe(o.types.string)}).volatile((function(){return{rendererTypeName:"",error:void 0,message:void 0}})).views((function(e){return{get RenderingComponent(){return(0,d.getEnv)(e).pluginManager.getDisplayType(e.type).ReactComponent},get DisplayBlurb(){return null},get adapterConfig(){return(0,r.getConf)(this.parentTrack,"adapter")},get parentTrack(){for(var t=(0,o.getParent)(e);!t.configuration||!(0,r.getConf)(t,"trackId");){if((0,o.isRoot)(t))throw new Error("No parent track found for ".concat(e.type," ").concat(e.id));t=(0,o.getParent)(t)}return t},renderProps:function(){return(0,c.Z)((0,c.Z)({},(0,l.getParentRenderProps)(e)),{},{notReady:(0,d.getContainingView)(e).minimized,rpcDriverName:e.rpcDriverName,displayModel:e})},get rendererType(){var t=(0,d.getEnv)(e).pluginManager.getRendererType(e.rendererTypeName);if(!t)throw new Error('renderer "'.concat(e.rendererTypeName,'" not found'));if(!t.ReactComponent)throw new Error("renderer ".concat(e.rendererTypeName," has no ReactComponent, it may not be completely implemented yet"));return t},get DisplayMessageComponent(){},trackMenuItems:function(){return[]},get viewMenuActions(){return[]},regionCannotBeRendered:function(){return null}}})).actions((function(e){return{setMessage:function(t){e.message=t},setError:function(t){e.error=t},setRpcDriverName:function(t){e.rpcDriverName=t},reload:function(){}}})),h=n(56666),g=n(32723),m=n(34795),v=n(33528);var y=(0,r.ConfigurationSchema)("InternetAccount",{name:{description:"descriptive name of the internet account",type:"string",defaultValue:""},description:{description:"a description of the internet account",type:"string",defaultValue:""},authHeader:{description:"request header for credentials",type:"string",defaultValue:"Authorization"},tokenType:{description:"a custom name for a token to include in the header",type:"string",defaultValue:""},domains:{description:"array of valid domains the url can contain to use this account",type:"stringArray",defaultValue:[]}},{explicitIdentifier:"internetAccountId",explicitlyTyped:!0}),b="undefined"===typeof sessionStorage;var w=o.types.model("InternetAccount",{id:f.ElementId,type:o.types.string,configuration:(0,r.ConfigurationReference)(y)}).views((function(e){return{get name(){return(0,r.getConf)(e,"name")},get description(){return(0,r.getConf)(e,"description")},get internetAccountId(){return(0,r.getConf)(e,"internetAccountId")},get authHeader(){return(0,r.getConf)(e,"authHeader")},get tokenType(){return(0,r.getConf)(e,"tokenType")},get domains(){return(0,r.getConf)(e,"domains")},get toggleContents(){return null},get SelectorComponent(){},get selectorLabel(){}}})).views((function(e){return{handlesLocation:function(t){return e.domains.some((function(e){return null===t||void 0===t?void 0:t.uri.includes(e)}))},get tokenKey(){return"".concat(e.internetAccountId,"-token")}}})).actions((function(e){return{getTokenFromUser:function(e,t){throw new Error("getTokenFromUser must be implemented by extending model")},storeToken:function(t){sessionStorage.setItem(e.tokenKey,t)},removeToken:function(){sessionStorage.removeItem(e.tokenKey)},retrieveToken:function(){return sessionStorage.getItem(e.tokenKey)},validateToken:function(e,t){return(0,m.Z)((0,g.Z)().mark((function t(){return(0,g.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e);case 1:case"end":return t.stop()}}),t)})))()}}})).actions((function(e){var t=void 0;return{getToken:function(n){return(0,m.Z)((0,g.Z)().mark((function r(){var a,i,o;return(0,g.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t){r.next=2;break}return r.abrupt("return",t);case 2:if(!(o=null===n||void 0===n||null===(a=n.internetAccountPreAuthorization)||void 0===a||null===(i=a.authInfo)||void 0===i?void 0:i.token)){r.next=6;break}return t=Promise.resolve(o),r.abrupt("return",t);case 6:if(!b){r.next=8;break}throw new Error("Did not get internet account pre-authorization info in worker");case 8:if(!(o=e.retrieveToken())){r.next=12;break}return t=Promise.resolve(o),r.abrupt("return",t);case 12:return t=new Promise((function(t,n){return e.getTokenFromUser((function(n){e.storeToken(n),t(n)}),(function(t){e.removeToken(),n(t)}))})),r.abrupt("return",t);case 14:case"end":return r.stop()}}),r)})))()}}})).actions((function(e){return{addAuthHeaderToInit:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return(0,c.Z)((0,c.Z)({},t),{},{headers:new Headers((0,c.Z)((0,c.Z)({},t.headers),{},(0,h.Z)({},e.authHeader,e.tokenType?"".concat(e.tokenType," ").concat(n):n)))})},getPreAuthorizationInformation:function(t){return(0,m.Z)((0,g.Z)().mark((function n(){var a,i;return(0,g.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.getToken(t);case 2:return a=n.sent,n.prev=3,n.next=6,e.validateToken(a,t);case 6:i=n.sent,n.next=13;break;case 9:throw n.prev=9,n.t0=n.catch(3),e.removeToken(),n.t0;case 13:return n.abrupt("return",{internetAccountType:e.type,authInfo:{token:i,configuration:(0,r.getConf)(e)}});case 14:case"end":return n.stop()}}),n,null,[[3,9]])})))()}}})).actions((function(e){return{getFetcher:function(t){return function(){var n=(0,m.Z)((0,g.Z)().mark((function n(r,a){var i,o;return(0,g.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.getToken(t);case 2:return i=n.sent,o=e.addAuthHeaderToInit(a,i),n.abrupt("return",fetch(r,o));case 5:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()}}})).actions((function(e){return{openLocation:function(t){return new v.RemoteFileWithRangeCache(t.uri,{fetch:e.getFetcher(t)})}}})),x=n(90689),k=n(8438);function Z(e,t,n){return o.types.model(t,{id:f.ElementId,type:o.types.literal(t),configuration:(0,r.ConfigurationReference)(n),minimized:!1,displays:o.types.array(e.pluggableMstType("display","stateModel"))}).views((function(t){return{get rpcSessionId(){var e;return null===(e=t.configuration)||void 0===e?void 0:e.trackId},get name(){return(0,r.getConf)(t,"name")},get textSearchAdapter(){return(0,r.getConf)(t,"textSearchAdapter")},get adapterType(){var n=(0,r.getConf)(t,"adapter");if(!n)throw new Error("no adapter configuration provided for ".concat(t.type));var a=e.getAdapterType(n.type);if(!a)throw new Error("unknown adapter type ".concat(n.type));return a},get viewMenuActions(){return t.displays.flatMap((function(e){return e.viewMenuActions}))},get canConfigure(){var e=(0,d.getSession)(t),n=e.sessionTracks,r=e.adminMode;return(0,k.cX)(e)&&(r||(null===n||void 0===n?void 0:n.find((function(e){var n;return e.trackId===(null===(n=t.configuration)||void 0===n?void 0:n.trackId)}))))}}})).actions((function(t){return{setMinimized:function(e){t.minimized=e},showDisplay:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.pluggableConfigSchemaType("display"),i=(0,o.resolveIdentifier)(a,(0,o.getRoot)(t),n),s=e.getDisplayType(i.type);if(!s)throw new Error("unknown display type ".concat(i.type));var u=s.stateModel.create((0,c.Z)((0,c.Z)({},r),{},{type:i.type,configuration:i}));t.displays.push(u)},hideDisplay:function(n){var r=e.pluggableConfigSchemaType("display"),a=(0,o.resolveIdentifier)(r,(0,o.getRoot)(t),n),i=t.displays.filter((function(e){return e.configuration===a}));return(0,x.transaction)((function(){return i.forEach((function(e){return t.displays.remove(e)}))})),i.length},replaceDisplay:function(n,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=t.displays.findIndex((function(e){return e.configuration.displayId===n}));if(-1===i)throw new Error("could not find display id ".concat(n," to replace"));var s=e.pluggableConfigSchemaType("display"),u=(0,o.resolveIdentifier)(s,(0,o.getRoot)(t),r);if(!e.getDisplayType(u.type))throw new Error("unknown display type ".concat(u.type));t.displays.splice(i,1,(0,c.Z)((0,c.Z)({},a),{},{type:u.type,configuration:u}))}}})).views((function(t){return{trackMenuItems:function(){var n=t.displays.flatMap((function(e){return e.trackMenuItems()})),r=t.displays[0].configuration.displayId,a=function(e){var t=(0,d.getEnv)(e).pluginManager,n=(0,d.getContainingView)(e),r=t.getViewType(n.type),a=new Set(r.displayTypes.map((function(e){return e.name})));return e.configuration.displays.filter((function(e){return a.has(e.type)}))}(t);return[].concat((0,i.Z)(n),(0,i.Z)(a.length>1?[{type:"subMenu",label:"Display types",subMenu:a.map((function(n){return{type:"radio",label:e.getDisplayType(n.type).displayName,checked:n.displayId===r,onClick:function(){return t.replaceDisplay(r,n.displayId)}}}))}]:[]))}}}))}function C(e){return(0,r.ConfigurationSchema)("BaseTrack",{name:{description:"descriptive name of the track",type:"string",defaultValue:"Track"},assemblyNames:{description:"name of the assembly (or assemblies) track belongs to",type:"stringArray",defaultValue:["assemblyName"]},description:{description:"a description of the track",type:"string",defaultValue:""},category:{description:"the category and sub-categories of a track",type:"stringArray",defaultValue:[]},metadata:{type:"frozen",description:"anything to add about this track",defaultValue:{}},adapter:e.pluggableConfigSchemaType("adapter"),textSearching:(0,r.ConfigurationSchema)("textSearching",{indexingAttributes:{type:"stringArray",description:"list of which feature attributes to index for text searching",defaultValue:["Name","ID"]},indexingFeatureTypesToExclude:{type:"stringArray",description:"list of feature types to exclude in text search index",defaultValue:["CDS","exon"]},textSearchAdapter:e.pluggableConfigSchemaType("text search adapter")}),displays:o.types.array(e.pluggableConfigSchemaType("display")),formatDetails:(0,r.ConfigurationSchema)("FormatDetails",{feature:{type:"frozen",description:"adds extra fields to the feature details",defaultValue:{},contextVariable:["feature"]},subfeatures:{type:"frozen",description:"adds extra fields to the subfeatures of a feature",defaultValue:{},contextVariable:["feature"]},depth:{type:"number",defaultValue:2,description:"depth of subfeatures to iterate the formatter on formatDetails.subfeatures (e.g. you may not want to format the exon/cds subfeatures, so limited to 2"}}),formatAbout:(0,r.ConfigurationSchema)("FormatAbout",{config:{type:"frozen",description:"formats configuration object in about dialog",defaultValue:{},contextVariable:["config"]},hideUris:{type:"boolean",defaultValue:!1}})},{preProcessSnapshot:function(t){var n=e.evaluateExtensionPoint("Core-preProcessTrackConfig",JSON.parse(JSON.stringify(t))),r=new Set,a=n.displays,i=void 0===a?[]:a;"placeholderId"!==n.trackId&&(i.forEach((function(e){return e&&r.add(e.type)})),e.getTrackType(n.type).displayTypes.forEach((function(e){r.has(e.name)||i.push({displayId:"".concat(n.trackId,"-").concat(e.name),type:e.name})})));return(0,c.Z)((0,c.Z)({},n),{},{displays:i})},explicitIdentifier:"trackId",explicitlyTyped:!0,actions:function(e){return{addDisplayConf:function(t){var n=t.type;if(!n)throw new Error("unknown display type ".concat(n));var r=e.displays.find((function(e){return(null===e||void 0===e?void 0:e.displayId)===t.displayId}));if(r)return r;var a=e.displays.push(t);return e.displays[a-1]}}}})}},21339:function(e,t,n){"use strict";n.r(t),n.d(t,{LayoutSession:function(){return x},default:function(){return k}});var r=n(96234),a=n(32723),i=n(34795),o=n(33028),s=n(93069),u=n(95058),c=n(45754),l=n(13820),d=n(9249),f=n(87371),p=n(59264),h=n.n(p),g=n(26354),m=n(35064),v=n(2972),y=n(29637),b=n(81073),w=n(9077),x=function(){function e(t){(0,d.Z)(this,e),this.config=void 0,this.bpPerPx=void 0,this.filters=void 0,this.cachedLayout=void 0,this.config=t.config,this.bpPerPx=t.bpPerPx,this.filters=t.filters,this.update(t)}return(0,f.Z)(e,[{key:"update",value:function(e){Object.assign(this,e)}},{key:"makeLayout",value:function(){return new m.Z(g.Z,{maxHeight:(0,w.readConfObject)(this.config,"maxHeight"),displayMode:(0,w.readConfObject)(this.config,"displayMode"),pitchX:this.bpPerPx,pitchY:(0,w.readConfObject)(this.config,"noSpacing")?1:3})}},{key:"cachedLayoutIsValid",value:function(e){return e&&e.layout.subLayoutConstructorArgs.pitchX===this.bpPerPx&&h()((0,w.readConfObject)(this.config),e.config)&&h()(this.filters,e.filters)}},{key:"layout",get:function(){return this.cachedLayout&&this.cachedLayoutIsValid(this.cachedLayout)||(this.cachedLayout={layout:this.makeLayout(),config:(0,w.readConfObject)(this.config),filters:this.filters}),this.cachedLayout.layout}}]),e}(),k=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){var e;(0,d.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).sessions={},e}return(0,f.Z)(n,[{key:"getWorkerSession",value:function(e){var t=(0,b.getLayoutId)(e);this.sessions[t]||(this.sessions[t]=this.createSession(e));var n=this.sessions[t];return n.update(e),n}},{key:"getExpandedRegion",value:function(e,t){if(!e)return e;var n=t.bpPerPx,r=t.config,a=void 0===r?0:(0,w.readConfObject)(r,"maxFeatureGlyphExpansion");if(!a)return e;var i=Math.round(a*n);return(0,o.Z)((0,o.Z)({},e),{},{start:Math.floor(Math.max(e.start-i,0)),end:Math.ceil(e.end+i)})}},{key:"createSession",value:function(e){return new x(e)}},{key:"freeResourcesInClient",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,r){var i,o,c,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.regions,o=(0,b.getLayoutId)(r),c=0,l=this.sessions[o],!i&&l&&(delete this.sessions[o],c=1),l&&i&&l.layout.discardRange(i[0].refName,i[0].start,i[0].end),e.t0=c,e.next=9,(0,s.Z)((0,u.Z)(n.prototype),"freeResourcesInClient",this).call(this,t,r);case 9:return e.t1=e.sent,e.abrupt("return",e.t0+e.t1);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deserializeLayoutInClient",value:function(e){return new v.Z(e)}},{key:"deserializeResultsInClient",value:function(e,t){var r=this.deserializeLayoutInClient(e.layout);return(0,s.Z)((0,u.Z)(n.prototype),"deserializeResultsInClient",this).call(this,(0,o.Z)((0,o.Z)({},e),{},{layout:r}),t)}},{key:"createLayoutInWorker",value:function(e){var t=e.regions;return this.getWorkerSession(e).layout.getSublayout(t[0].refName)}},{key:"serializeResultsInWorker",value:function(e,t){var a=(0,s.Z)((0,u.Z)(n.prototype),"serializeResultsInWorker",this).call(this,e,t),i=(0,r.Z)(t.regions,1)[0];return a.layout=e.layout.serializeRegion(this.getExpandedRegion(i,t)),a.layout.rectangles&&(a.features=a.features.filter((function(e){return Boolean(a.layout.rectangles[e.uniqueId])}))),a.maxHeightReached=a.layout.maxHeightReached,a}},{key:"render",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){var r,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.layout||this.createLayoutInWorker(t),e.next=3,(0,s.Z)((0,u.Z)(n.prototype),"render",this).call(this,(0,o.Z)((0,o.Z)({},t),{},{layout:r}));case 3:return i=e.sent,e.abrupt("return",(0,o.Z)((0,o.Z)({},i),{},{layout:r}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(y.default)},93073:function(e,t,n){"use strict";n.d(t,{Z:function(){return k}});var r=n(33028),a=n(9249),i=n(87371),o=n(45754),s=n(13820),u=n(30969),c=n(81073),l=n(29637),d=n(59740),f=n(90550),p=n(75844),h=n(59767),g=n(40909),m=n(15749),v=n(37574),y=["html","theme","RenderingComponent"],b=(0,f.observer)((function(e){var t=e.html,n=e.theme,a=e.RenderingComponent,i=(0,d.Z)(e,y),o=(0,u.useRef)(null),s=(0,u.useRef)(),l=(0,g.getRoot)(e.displayModel).hydrateFn;return(0,u.useEffect)((function(){var e=(0,c.rIC)((function(){var e;if(o.current){var t=(0,h.createJBrowseTheme)(n);s.current=null!==(e=s.current)&&void 0!==e?e:l(o.current,(0,v.jsx)(p.Z,{theme:t,children:(0,v.jsx)(a,(0,r.Z)({},i))}))}}));return function(){clearTimeout(e);var t=s.current;s.current=void 0,setTimeout((function(){null===t||void 0===t||t.unmount()}))}}),[t,a,l,n,e,i]),(0,v.jsx)("g",{ref:o,dangerouslySetInnerHTML:{__html:t}})})),w=(0,f.observer)((function(e){var t=e.html,n=e.RenderingComponent,a=(0,u.useRef)(null);return(0,u.useEffect)((function(){var i=a.current;return i&&t&&(i.innerHTML&&(0,m.unmountComponentAtNode)(i),i.style.outline="none",i.innerHTML=t,(0,c.rIC)((function(){(0,m.hydrate)((0,v.jsx)(n,(0,r.Z)({},e)),i)}))),function(){i&&(0,m.unmountComponentAtNode)(i)}}),[t,n,e]),(0,v.jsx)("g",{ref:a})})),x=(0,f.observer)((function(e){return(0,g.getRoot)(e.displayModel).hydrateFn?(0,v.jsx)(b,(0,r.Z)({},e)):(0,v.jsx)(w,(0,r.Z)({},e))})),k=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).supportsSVG=!0,e}return(0,i.Z)(n,[{key:"deserializeResultsInClient",value:function(e,t){var n=new Map(e.features.map((function(e){return c.SimpleFeature.fromJSON(e)})).map((function(e){return[e.id(),e]})));return t.exportSVG?(0,r.Z)((0,r.Z)({},e),{},{features:n,blockKey:"circularChord",html:this.supportsSVG?e.html:'<text y="12" fill="black">SVG export not supported for this track</text>'}):(0,r.Z)((0,r.Z)({},e),{},{features:n,blockKey:"circularChord",reactElement:(0,v.jsx)(x,(0,r.Z)((0,r.Z)((0,r.Z)({},t),e),{},{features:n,RenderingComponent:this.ReactComponent}))})}}]),n}(l.default)},43103:function(e,t,n){"use strict";n.d(t,{Z:function(){return y}});var r=n(33028),a=n(32723),i=n(34795),o=n(9249),s=n(87371),u=n(93069),c=n(95058),l=n(45754),d=n(13820),f=n(21897),p=n(95915),h=n(67688),g=n(3011),m=n(81073),v=n(81450);var y=function(e){(0,l.Z)(n,e);var t=(0,d.Z)(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"renameRegionsIfNeeded",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"serializeArgsInClient",value:function(e){var t=(0,r.Z)((0,r.Z)({},e),{},{displayModel:{}});return(0,u.Z)((0,c.Z)(n.prototype),"serializeArgsInClient",this).call(this,t)}},{key:"deserializeResultsInClient",value:function(e,t){var a=(0,u.Z)((0,c.Z)(n.prototype),"deserializeResultsInClient",this).call(this,e,t);return(0,r.Z)((0,r.Z)({},a),{},{blockKey:t.blockKey})}},{key:"renderInClient",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,n){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.call(n.sessionId,"ComparativeRender",n);case 2:if(r=e.sent,!("canvasRecordedData"in r)){e.next=8;break}return e.next=6,(0,m.getSerializedSvg)(r);case 6:r.html=e.sent,delete r.reactElement;case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"featurePassesFilters",value:function(e,t){return!e.filters||e.filters.passes(t,e)}},{key:"getFeatures",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){var n,i,o,s,u,c,l,d,h=this;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.pluginManager,i=t.sessionId,o=t.adapterConfig,e.next=4,(0,g.uP)(n,i,o);case 4:if(s=e.sent,u=s.dataAdapter,(c=t.regions)&&0!==c.length){e.next=10;break}return console.warn("no regions supplied to comparative renderer"),e.abrupt("return",[]);case 10:return l=c.map((function(e){var t=(0,r.Z)({},e);return t.start&&(t.start=Math.floor(t.start)),t.end&&(t.end=Math.floor(t.end)),t})),e.next=13,(0,v.z)(u.getFeaturesInMultipleRegions(l,t).pipe((0,f.h)((function(e){return h.featurePassesFilters(t,e)})),(0,p.q)()));case 13:return d=e.sent,e.abrupt("return",(0,m.dedupe)(d,(function(e){return e.id()})));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(h.default)},29637:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var r=n(32723),a=n(34795),i=n(33028),o=n(9249),s=n(87371),u=n(93069),c=n(95058),l=n(45754),d=n(13820),f=n(95915),p=n(39554),h=n.n(p),g=n(81450),m=n(81073),v=n(14956),y=n(3011),b=n(67688),w=n(20783),x=function(e){(0,l.Z)(n,e);var t=(0,d.Z)(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"serializeArgsInClient",value:function(e){var t=e.displayModel,r=e.regions,a=(0,i.Z)((0,i.Z)({},e),{},{displayModel:t&&{id:t.id,selectedFeatureId:t.selectedFeatureId},regions:h()(r)});return(0,u.Z)((0,c.Z)(n.prototype),"serializeArgsInClient",this).call(this,a)}},{key:"deserializeResultsInClient",value:function(e,t){var r=new Map(e.features.map((function(e){return v.Z.fromJSON(e)})).map((function(e){return[e.id(),e]}))),a=(0,u.Z)((0,c.Z)(n.prototype),"deserializeResultsInClient",this).call(this,(0,i.Z)((0,i.Z)({},e),{},{features:r}),t);return(0,i.Z)((0,i.Z)({},a),{},{blockKey:t.blockKey,features:r})}},{key:"serializeResultsInWorker",value:function(e,t){var r=(0,u.Z)((0,c.Z)(n.prototype),"serializeResultsInWorker",this).call(this,e,t),a=e.features;return(0,i.Z)((0,i.Z)({},r),{},{features:(0,m.iterMap)(a.values(),(function(e){return e.toJSON()}),a.size)})}},{key:"getExpandedRegion",value:function(e,t){return e}},{key:"getFeatures",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,o,s,u,c,l,d,p,h,v,b,x=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.pluginManager,a=t.signal,o=t.regions,s=t.sessionId,u=t.adapterConfig,e.next=4,(0,y.uP)(n,s,u);case 4:if(c=e.sent,l=c.dataAdapter,(0,w.isFeatureAdapter)(l)){e.next=8;break}throw new Error("Adapter does not support retrieving features");case 8:if(d=new Map,o&&0!==o.length){e.next=11;break}return e.abrupt("return",d);case 11:return p=o.map((function(e){var t=(0,i.Z)({},e);return t.start&&(t.start=Math.floor(t.start)),t.end&&(t.end=Math.ceil(t.end)),t})),h=p[0],v=1===p.length?l.getFeatures(this.getExpandedRegion(h,t),t):l.getFeaturesInMultipleRegions(p,t),e.next=16,(0,g.z)(v.pipe((0,f.q)()));case 16:return b=e.sent,(0,m.checkAbortSignal)(a),e.abrupt("return",new Map(b.filter((function(e){return x.featurePassesFilters(t,e)})).map((function(e){return[e.id(),e]}))));case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"featurePassesFilters",value:function(e,t){return!e.filters||e.filters.passes(t,e)}},{key:"render",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var a,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.features,e.t0){e.next=5;break}return e.next=4,this.getFeatures(t);case 4:e.t0=e.sent;case 5:return a=e.t0,e.next=8,(0,u.Z)((0,c.Z)(n.prototype),"render",this).call(this,(0,i.Z)((0,i.Z)({},t),{},{features:a}));case 8:return o=e.sent,e.abrupt("return",(0,i.Z)((0,i.Z)({},o),{},{features:a}));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(b.default)},86297:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var r=n(32723),a=n(34795),i=n(9249),o=n(87371),s=n(45754),u=n(13820),c=n(30969),l=n(83265),d=function(e){(0,s.Z)(n,e);var t=(0,u.Z)(n);function n(e){var r;if((0,i.Z)(this,n),(r=t.call(this,e)).ReactComponent=void 0,r.supportsSVG=!1,r.configSchema=void 0,r.pluginManager=void 0,r.ReactComponent=e.ReactComponent,r.configSchema=e.configSchema,r.pluginManager=e.pluginManager,!r.ReactComponent)throw new Error("no ReactComponent defined for renderer ".concat(r.name));if(!(0,l.getDefaultValue)(r.configSchema).type)throw new Error("".concat(r.name," config schema ").concat(r.configSchema.name," is not explicitlyTyped"));if(!r.pluginManager)throw new Error("no plugin manager defined for renderer ".concat(r.name));return r}return(0,o.Z)(n,[{key:"render",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{reactElement:c.createElement(this.ReactComponent,t,null)});case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"freeResources",value:function(){return 0}}]),n}(n(78008).Z)},79321:function(e,t,n){"use strict";var r=n(33028),a=n(59740),i=n(30969),o=n(75844),s=n(59767),u=n(90550),c=n(40909),l=n(15749),d=n(81073),f=n(37574),p=["theme","html","RenderingComponent"],h=["theme","html","RenderingComponent"],g=(0,u.observer)((function(e){var t=e.theme,n=e.html,u=e.RenderingComponent,l=(0,a.Z)(e,p),h=(0,i.useRef)(null),g=(0,i.useRef)(),m=(0,c.getRoot)(l.displayModel).hydrateFn;return(0,i.useEffect)((function(){var e=(0,d.rIC)((function(){var e;if(h.current){var n=(0,s.createJBrowseTheme)(t);g.current=null!==(e=g.current)&&void 0!==e?e:m(h.current,(0,f.jsx)(o.Z,{theme:n,children:(0,f.jsx)(u,(0,r.Z)({},l))}))}}));return function(){clearTimeout(e);var t=g.current;g.current=void 0,setTimeout((function(){null===t||void 0===t||t.unmount()}))}}),[n,t,l,m,u]),(0,f.jsx)("div",{ref:h,dangerouslySetInnerHTML:{__html:n}})})),m=(0,u.observer)((function(e){var t=e.theme,n=e.html,u=e.RenderingComponent,c=(0,a.Z)(e,h),p=(0,i.useRef)(null),g=(0,s.createJBrowseTheme)(t);return(0,i.useEffect)((function(){var e=p.current;return e&&(e&&(0,l.unmountComponentAtNode)(e),e.innerHTML=n,(0,d.rIC)((function(){(0,l.hydrate)((0,f.jsx)(o.Z,{theme:g,children:(0,f.jsx)(u,(0,r.Z)({},c))}),e)}))),function(){e&&(0,l.unmountComponentAtNode)(e)}}),[n,g,c,u]),(0,f.jsx)("div",{ref:p})})),v=(0,u.observer)((function(e){return(0,c.getRoot)(e.displayModel).hydrateFn?(0,f.jsx)(g,(0,r.Z)({},e)):(0,f.jsx)(m,(0,r.Z)({},e))}));t.Z=v},67688:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var r=n(32723),a=n(34795),i=n(33028),o=n(9249),s=n(87371),u=n(45754),c=n(13820),l=(n(30969),n(75844)),d=n(2082),f=n(40909),p=n(81073),h=n(37386),g=n(59767),m=n(86297),v=n(79321),y=n(37574);var b=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"serializeArgsInClient",value:function(e){var t;return(0,i.Z)((0,i.Z)({},e),{},{config:(0,f.isStateTreeNode)(e.config)?(0,f.getSnapshot)(e.config):e.config,filters:null===(t=e.filters)||void 0===t?void 0:t.toJSON().filters})}},{key:"deserializeResultsInClient",value:function(e,t){return t.exportSVG?(0,i.Z)((0,i.Z)({},e),{},{html:this.supportsSVG?e.html:'<text y="12" fill="black">SVG export not supported for this track</text>'}):(0,i.Z)((0,i.Z)({},e),{},{reactElement:(0,y.jsx)(v.Z,(0,i.Z)((0,i.Z)((0,i.Z)({},t),e),{},{RenderingComponent:this.ReactComponent}))})}},{key:"deserializeArgsInWorker",value:function(e){var t=(0,i.Z)({},e);return t.config=this.configSchema.create(e.config||{},{pluginManager:this.pluginManager}),t.filters=new h.Z({filters:e.filters}),t}},{key:"serializeResultsInWorker",value:function(e,t){var n=(0,d.Dq)((0,y.jsx)(l.Z,{theme:(0,g.createJBrowseTheme)(t.theme),children:e.reactElement}));return delete e.reactElement,(0,i.Z)((0,i.Z)({},e),{},{html:n})}},{key:"renderInClient",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.call(n.sessionId,"CoreRender",n);case 2:if(a=e.sent,!("canvasRecordedData"in a)){e.next=8;break}return e.next=6,(0,p.getSerializedSvg)(a);case 6:a.html=e.sent,delete a.reactElement;case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"renderInWorker",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,i,o,s,u=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.signal,a=t.statusCallback,i=void 0===a?function(){}:a,o=this.deserializeArgsInWorker(t),e.next=4,(0,p.updateStatus)("Rendering plot",i,(function(){return u.render(o)}));case 4:return s=e.sent,(0,p.checkAbortSignal)(n),e.abrupt("return",(0,p.updateStatus)("Serializing results",i,(function(){return u.serializeResultsInWorker(s,o)})));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"freeResourcesInClient",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n){var a,i,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.serializeArgsInClient(n),i=this.freeResources(),e.next=4,t.call(n.sessionId,"CoreFreeResources",a);case 4:return o=e.sent,e.abrupt("return",i+o);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(m.default)},37386:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(41361),a=n(9249),i=n(87371),o=n(32665),s=function(){function e(t){var n=t.filters,r=void 0===n?[]:n;(0,a.Z)(this,e),this.filterChain=void 0,this.filterChain=r.map((function(e){if("string"===typeof e)return{expr:(0,o.P)(e),string:e};throw new Error('invalid inputFilter string "'.concat(e,'"'))}))}return(0,i.Z)(e,[{key:"passes",value:function(){var e,t=(0,r.Z)(this.filterChain);try{for(t.s();!(e=t.n()).done;){if(!e.value.expr.evalSync({feature:arguments.length<=0?void 0:arguments[0]}))return!1}}catch(n){t.e(n)}finally{t.f()}return!0}},{key:"toJSON",value:function(){return{filters:this.filterChain.map((function(e){return e.string}))}}}],[{key:"fromJSON",value:function(t){return new e(t)}}]),e}()},67619:function(e,t,n){"use strict";var r=n(33028),a=n(59740),i=(n(30969),n(99537)),o=n(94551),s=n(90550),u=n(19381),c=n(37574),l=["children","menuItems"],d=(0,s.observer)((function(e){var t=e.children,n=e.menuItems,s=(0,a.Z)(e,l),d=(0,u.o_)({popupId:"viewMenu",variant:"popover"});return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(o.Z,(0,r.Z)((0,r.Z)((0,r.Z)({},(0,u.vW)(d)),s),{},{disabled:0===n.length,children:t})),(0,c.jsx)(i.Z,(0,r.Z)((0,r.Z)({},(0,u.ZW)(d)),{},{onMenuItemClick:function(e,t){return t()},menuItems:n,popupState:d}))]})}));t.Z=d},60092:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(96234),a=n(30969),i=n(72097),o=n(84636),s=n(38357),u=n(59071),c=n(96074),l=n(88896),d=n(16383),f=n(37574),p=function(e){var t=e.onFactoryReset,n=e.resetButtonText,o=(0,a.useState)(!1),s=(0,r.Z)(o,2),u=s[0],c=s[1];return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(i.Z,{"data-testid":"fatal-error",color:"primary",variant:"contained",onClick:function(){return c(!0)},children:n}),(0,f.jsx)(l.Z,{onClose:function(){return c(!1)},open:u,onFactoryReset:t})]})};function h(e){var t=e.componentStack,n=e.error,r=void 0===n?"No error message provided":n,a=e.onFactoryReset,l=e.resetButtonText,h=void 0===l?"Factory Reset":l;return(0,f.jsxs)(o.Z,{maxWidth:"xl",open:!0,children:[(0,f.jsx)(s.Z,{children:"Fatal error"}),(0,f.jsxs)(u.Z,{children:[(0,f.jsx)(d.Z,{error:r}),(0,f.jsx)("pre",{children:t})]}),(0,f.jsxs)(c.Z,{children:[(0,f.jsx)(i.Z,{color:"secondary",variant:"contained",onClick:function(){return window.location.reload()},children:"Refresh"}),(0,f.jsx)(p,{onFactoryReset:a,resetButtonText:h})]})]})}},84537:function(e,t,n){"use strict";n(30969);var r=n(38361),a=n(87535),i=n(72097),o=n(33359),s=n(53276),u=n(81073),c=n(97891),l=n(37574);function d(e){return"blobId"in e}var f=(0,s.ZL)()((function(e){return{filename:{marginLeft:e.spacing(1)}}}));t.Z=function(e){var t=e.location,n=e.setLocation,s=f().classes,p=t&&(d(t)&&t.name||function(e){return"localPath"in e}(t)&&t.localPath),h=t&&d(t)&&!(0,c.getBlob)(t.blobId);return(0,l.jsxs)(r.Z,{display:"flex",flexDirection:"row",alignItems:"center",children:[(0,l.jsx)(r.Z,{children:(0,l.jsx)(a.Z,{fullWidth:!0,children:(0,l.jsxs)(i.Z,{variant:"outlined",component:"label",children:["Choose File",(0,l.jsx)("input",{type:"file",hidden:!0,onChange:function(e){var t,r=e.target,a=null===r||void 0===r||null===(t=r.files)||void 0===t?void 0:t[0];a&&(u.isElectron?n({localPath:a.path,locationType:"LocalPathLocation"}):n((0,c.storeBlobLocation)({blob:a})))}})]})})}),(0,l.jsxs)(r.Z,{children:[(0,l.jsx)(o.Z,{component:"span",className:s.filename,color:p?"initial":"textSecondary",children:p||"No file chosen"}),h?(0,l.jsx)(o.Z,{color:"error",children:"(need to reload)"}):null]})]})}},14808:function(e,t,n){"use strict";n(30969);var r=n(87006),a=n(90550),i=n(8438),o=n(37574),s=(0,a.observer)((function(e){var t=e.location,n=e.setLocation,a=e.label;return(0,o.jsx)(r.Z,{fullWidth:!0,variant:"outlined",inputProps:{"data-testid":"urlInput"},defaultValue:t&&(0,i.hb)(t)?t.uri:"",label:a||"Enter URL",onChange:function(e){n({uri:e.target.value.trim(),locationType:"UriLocation"})}})}));t.Z=s},72360:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var r,a=n(33028),i=n(59740),o=n(71171),s=(n(30969),n(33359)),u=n(53276),c=n(16723),l=n(37574),d=["message","variant"],f=(0,u.ZL)()({dots:{"&::after":{display:"inline-block",content:'""',width:"1em",textAlign:"left",animation:"".concat((0,c.F4)(r||(r=(0,o.Z)(["\n      0% {\n        content: '';\n      }\n      25% {\n          content: '.';\n      }\n      50% {\n        content: '..';\n      }\n      75% {\n        content: '...';\n      }\n      "])))," 1.2s infinite ease-in-out")}}});function p(e){var t=e.message,n=e.variant,r=void 0===n?"body2":n,o=(0,i.Z)(e,d),u=f().classes;return(0,l.jsx)(s.Z,(0,a.Z)((0,a.Z)({className:u.dots},o),{},{variant:r,children:"".concat(t||"Loading")}))}},94069:function(e,t,n){"use strict";n.r(t),n.d(t,{category10:function(){return r},dark2:function(){return a},ggplot2Colors3:function(){return d},ggplot2Colors4:function(){return l},ggplot2Colors5:function(){return c},ggplot2Colors6:function(){return u},set1:function(){return i},set2:function(){return o},tableau10:function(){return s}});var r=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],a=["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],i=["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],o=["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],s=["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"],u=["#F8766D","#B79F00","#00BA38","#00BFC4","#619CFF","#F564E3"],c=["#F8766D","#A3A500","#00BF7D","#00B0F6","#E76BF3"],l=["#F8766D","#7CAE00","#00BFC4","#C77CFF"],d=["#F8766D","#00BA38","#619CFF"]},68554:function(e,t,n){"use strict";n.d(t,{Ao:function(){return i},R:function(){return u},j4:function(){return s}});var r=n(33028),a=n(40909);function i(e,t,n){if(t&&n){for(var r=e.width,a=e.interRegionPaddingWidth,i=e.displayedRegions,o=e.bpPerPx,s=e.minimumBlockWidth,u=function(e,t,n){var r=0,a=e.displayedRegions;if(t.index===n.index)r+=n.offset-t.offset;else{var i=a[t.index];if(r+=i.end-i.start-t.offset,n.index-t.index>=2)for(var o=t.index+1;o<n.index;o++){var s=a[o];r+=s.end-s.start}r+=n.offset}return r}(e,t,n),c=0,l=t.index;l<n.index;l++){var d=i[l];(d.end-d.start)/o>s&&c++}var f=u/(r-a*c),p=e.zoomTo(f),h=0;f<p&&(h=(p-f)*e.width/2);for(var g=-h,m=0;m<e.displayedRegions.length;m+=1){var v=e.displayedRegions[m];if(t.index===m){g+=t.offset;break}g+=v.end-v.start}e.scrollTo(Math.round(g/e.bpPerPx))}}function o(e,t){return Math.floor(e.reversed?e.end-t:e.start+t)+1}function s(e,t){var n=0,i=e.bpPerPx,s=e.offsetPx,u=e.displayedRegions,c=e.interRegionPaddingWidth,l=e.staticBlocks.contentBlocks,d=(s+t)*i;if(d<0){var f=u[0],p=(0,a.getSnapshot)(f);return(0,r.Z)((0,r.Z)({},p),{},{oob:!0,coord:o(f,d),offset:d,index:0})}for(var h=c*i,g=0,m=0;m<u.length;m++){var v,y=u[m],b=y.end-y.start,w=d-n;if(b+n>d&&n<=d){var x=(0,a.getSnapshot)(y);return(0,r.Z)((0,r.Z)({},x),{},{oob:!1,offset:w,coord:o(y,w),index:m})}(null===(v=l[g])||void 0===v?void 0:v.regionNumber)===m?(n+=b+h,g++):n+=b}if(d>=n&&u.length>0){var k=u.at(-1),Z=d-n+(k.end-k.start),C=(0,a.getSnapshot)(k);return(0,r.Z)((0,r.Z)({},C),{},{oob:!0,offset:Z,coord:o(k,Z),index:u.length-1})}return{coord:0,index:0,refName:"",oob:!0,assemblyName:"",offset:0,start:0,end:0,reversed:!1}}function u(e){for(var t=e.refName,n=e.coord,r=e.regionNumber,a=e.self,i=0,o=a.interRegionPaddingWidth,s=a.bpPerPx,u=a.displayedRegions,c=a.staticBlocks.contentBlocks,l=o*s,d=0,f=0;f<u.length;f++){var p,h=u[f],g=h.end-h.start;if(t===h.refName&&n>=h.start&&n<=h.end&&(!r||r===f)){i+=h.reversed?h.end-n:n-h.start;break}(null===(p=c[d])||void 0===p?void 0:p.regionNumber)===f?(i+=g+l,d++):i+=g}if(u[f])return{index:f,offsetPx:Math.round(i/s)}}},54006:function(e,t,n){"use strict";var r=n(68079),a=n(40909),i=n(81073),o=n(29206),s=n(60717),u=n(31517),c=n(68554);var l=a.types.model("Base1DView",{id:o.ElementId,displayedRegions:a.types.array(o.Region),bpPerPx:0,offsetPx:0,interRegionPaddingWidth:a.types.optional(a.types.number,0),minimumBlockWidth:a.types.optional(a.types.number,0)}).volatile((function(){return{features:void 0,volatileWidth:0}})).actions((function(e){return{setDisplayedRegions:function(t){e.displayedRegions=(0,a.cast)(t)},setBpPerPx:function(t){e.bpPerPx=t},setVolatileWidth:function(t){e.volatileWidth=t}}})).views((function(e){return{get width(){return e.volatileWidth},get assemblyNames(){return(0,r.Z)(new Set(e.displayedRegions.map((function(e){return e.assemblyName}))))},get displayedRegionsTotalPx(){return this.totalBp/e.bpPerPx},get maxOffset(){return this.displayedRegionsTotalPx-10},get minOffset(){return 30-this.width},get totalBp(){return e.displayedRegions.map((function(e){return e.end-e.start})).reduce((function(e,t){return e+t}),0)}}})).views((function(e){return{get dynamicBlocks(){return(0,s.Z)(e)},get staticBlocks(){return(0,u.Z)(e)},get currBp(){return this.dynamicBlocks.map((function(e){return e.end-e.start})).reduce((function(e,t){return e+t}),0)}}})).views((function(e){return{pxToBp:function(t){return(0,c.j4)(e,t)},bpToPx:function(t){var n,r=t.refName,a=t.coord,i=t.regionNumber;return null===(n=(0,c.R)({refName:r,coord:a,regionNumber:i,self:e}))||void 0===n?void 0:n.offsetPx}}})).actions((function(e){return{setFeatures:function(t){e.features=t},showAllRegions:function(){e.bpPerPx=e.totalBp/e.width,e.offsetPx=0},zoomOut:function(){this.zoomTo(2*e.bpPerPx)},zoomIn:function(){this.zoomTo(e.bpPerPx/2)},zoomTo:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.width/2,r=(0,i.clamp)(t,"minBpPerPx"in e?e.minBpPerPx:0,"maxBpPerPx"in e?e.maxBpPerPx:1/0),a=e.bpPerPx;return Math.abs(a-r)<1e-6?a:(e.bpPerPx=r,e.offsetPx=(0,i.clamp)(Math.round((e.offsetPx+n)*a/r-n),e.minOffset,e.maxOffset),e.bpPerPx)},scrollTo:function(t){var n=(0,i.clamp)(t,e.minOffset,e.maxOffset);return e.offsetPx=n,n},centerAt:function(t,n,r){if(n){var a=e.bpToPx({refName:n,coord:t,regionNumber:r});a&&this.scrollTo(Math.round(a-e.width/2))}},scroll:function(t){var n=e.offsetPx,r=(0,i.clamp)(e.offsetPx+t,e.minOffset,e.maxOffset);return e.offsetPx=r,r-n}}})).actions((function(e){return{moveTo:function(t,n){(0,c.Ao)(e,t,n)}}}));t.Z=l},55429:function(e,t,n){"use strict";n.d(t,{ML:function(){return g},N7:function(){return y},O8:function(){return p},fP:function(){return v},zF:function(){return b}});var r=n(32723),a=n(34795),i=n(87371),o=n(9249),s=n(45754),u=n(13820),c=n(30364),l=n(90233),d=n(21375),f=function(e){(0,s.Z)(n,e);var t=(0,u.Z)(n);function n(){var e;(0,o.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).code=void 0,e}return(0,i.Z)(n)}((0,c.Z)(Error));function p(e){if(e){if(!(e instanceof AbortSignal))throw new TypeError("must pass an AbortSignal");if(e.aborted)throw v()}}function h(e){return new Promise((function(t){return setTimeout(t,e)}))}function g(e){return m.apply(this,arguments)}function m(){return(m=(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(1);case 2:p(t);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(){if("undefined"!==typeof DOMException)return new DOMException("aborted","AbortError");var e=new f("aborted");return e.code="ERR_ABORTED",e}function y(e){return e?(0,d.R)(e,"abort"):l.y.create()}function b(e){return e instanceof Error&&("AbortError"===e.name||"ERR_ABORTED"===e.code||!!/\b(aborted|aborterror)\b/i.test(e.message))}},56891:function(e,t,n){"use strict";n.d(t,{Jw:function(){return u},b0:function(){return l},n2:function(){return f},sh:function(){return d}});var r=n(45754),a=n(13820),i=n(9249),o=n(87371),s=n(81073),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,i.Z)(this,e),this.blocks=t}return(0,o.Z)(e,[{key:"push",value:function(e){if(e instanceof d&&this.blocks.length>0){var t=this.blocks.at(-1);if(t instanceof d)return void t.push(e)}this.blocks.push(e)}},{key:"getBlocks",value:function(){return this.blocks}},{key:"getRegions",value:function(){return this.blocks.map((function(e){return e.toRegion()}))}},{key:"map",value:function(e,t){return this.blocks.map(e,t)}},{key:"forEach",value:function(e,t){return this.blocks.forEach(e,t)}},{key:"length",get:function(){return this.blocks.length}},{key:"totalWidthPx",get:function(){return this.blocks.length>0?(0,s.sum)(this.blocks.map((function(e){return e.widthPx}))):0}},{key:"totalWidthPxWithoutBorders",get:function(){return this.blocks.length>0?(0,s.sum)(this.blocks.filter((function(e){return"boundary"!==e.variant})).map((function(e){return e.widthPx}))):0}},{key:"offsetPx",get:function(){return this.blocks.length>0?this.blocks[0].offsetPx:0}},{key:"contentBlocks",get:function(){return this.blocks.filter((function(e){return e instanceof l}))}},{key:"totalBp",get:function(){return(0,s.sum)(this.contentBlocks.map((function(e){return e.end-e.start})))}}]),e}(),c=function(){function e(t){(0,i.Z)(this,e),this.regionNumber=void 0,this.reversed=void 0,this.refName=void 0,this.start=void 0,this.end=void 0,this.assemblyName=void 0,this.key=void 0,this.offsetPx=void 0,this.widthPx=0,this.variant=void 0,this.isLeftEndOfDisplayedRegion=void 0,Object.assign(this,t),this.assemblyName=t.assemblyName,this.refName=t.refName,this.start=t.start,this.end=t.end,this.key=t.key,this.offsetPx=t.offsetPx}return(0,o.Z)(e,[{key:"toRegion",value:function(){return{refName:this.refName,start:this.start,end:this.end,assemblyName:this.assemblyName,reversed:this.reversed}}}]),e}(),l=function(e){(0,r.Z)(n,e);var t=(0,a.Z)(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n)}(c),d=function(e){(0,r.Z)(n,e);var t=(0,a.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).widthPx=void 0,r.elidedBlockCount=0,r.widthPx=e.widthPx,r}return(0,o.Z)(n,[{key:"push",value:function(e){this.elidedBlockCount+=1,e&&(this.refName="",this.start=0,this.end=0,this.widthPx+=e.widthPx)}}]),n}(c),f=function(e){(0,r.Z)(n,e);var t=(0,a.Z)(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n)}(c)},60717:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(96234),a=n(40909),i=n(37654),o=n(81073),s=n(56891);function u(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],u=e.offsetPx,c=e.displayedRegions,l=e.bpPerPx,d=e.width,f=e.minimumBlockWidth,p=e.interRegionPaddingWidth;if(!d)throw new Error("view has no width, cannot calculate displayed blocks");for(var h=new s.Jw,g=0,m=u,v=m+d,y=0;y<c.length;y++){var b=c[y],w=b.assemblyName,x=b.refName,k=b.start,Z=b.end,C=b.reversed,S=g+(Z-k)/l,T=(Z-k)/l,P=(0,a.isStateTreeNode)(b)?(0,a.getSnapshot)(b):b;if(g<v&&S>m){var M=(0,i.U0)(m,v,g,S),R=(0,r.Z)(M,2),A=R[0],I=R[1],L=void 0,N=void 0,F=void 0,j=void 0,D=void 0;C?(F=(N=Z-(A-g)*l)===Z,j=(L=Math.max(k,Z-(I-g)*l))===k,D=g+(Z-N)/l):(F=(L=(A-g)*l+k)===k,j=(N=Math.min(Z,(I-g)*l+k))===Z,D=g+(L-k)/l);var B={assemblyName:w,refName:x,start:L,end:N,reversed:C,offsetPx:D,parentRegion:P,regionNumber:y,widthPx:(N-L)/l,isLeftEndOfDisplayedRegion:F,isRightEndOfDisplayedRegion:j,key:""};B.key="".concat((0,o.assembleLocStringFast)(B),"-").concat(y).concat(C?"-reversed":""),t&&0===h.length&&F&&h.push(new s.n2({key:"".concat(B.key,"-beforeFirstRegion"),widthPx:-u,offsetPx:B.offsetPx+u,variant:"boundary"})),n&&T<f?h.push(new s.sh(B)):h.push(new s.b0(B)),t&&(T>=f&&B.isRightEndOfDisplayedRegion&&y<c.length-1&&(h.push(new s.n2({key:"".concat(B.key,"-rightpad"),widthPx:p,offsetPx:B.offsetPx+B.widthPx})),g+=p),y===c.length-1&&B.isRightEndOfDisplayedRegion&&(D=B.offsetPx+B.widthPx,h.push(new s.n2({key:"".concat(B.key,"-afterLastRegion"),widthPx:d-D+u,offsetPx:D,variant:"boundary"}))))}g+=(Z-k)/l}return h}},31517:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(40909),a=n(81073),i=n(56891);function o(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:800,u=e.offsetPx,c=e.displayedRegions,l=e.bpPerPx,d=e.minimumBlockWidth,f=e.interRegionPaddingWidth,p=u*l,h=(u+e.width)*l,g=s,m=Math.ceil(g*l),v=0,y=new i.Jw,b=0;b<c.length;b++){var w=c[b],x=w.assemblyName,k=w.refName,Z=w.start,C=w.end,S=w.reversed,T=Math.ceil((C-Z)/m),P=(0,r.isStateTreeNode)(w)?(0,r.getSnapshot)(w):w,M=Math.floor((h-v)/m)+o;M>=T&&(M=T-1);var R=Math.floor((p-v)/m)-o;R<0&&(R=0);for(var A=(C-Z)/l,I=R;I<=M;I+=1){var L=void 0,N=void 0,F=void 0,j=void 0;S?(F=(N=C-I*m)===C,j=(L=Math.max(Z,C-(I+1)*m))===Z):(F=(L=Z+I*m)===Z,j=(N=Math.min(C,Z+(I+1)*m))===C);var D={assemblyName:x,refName:k,start:L,end:N,reversed:S,offsetPx:(v+I*m)/l,parentRegion:P,regionNumber:b,widthPx:(N-L)/l,isLeftEndOfDisplayedRegion:F,isRightEndOfDisplayedRegion:j,key:""};D.key="".concat((0,a.assembleLocStringFast)(D),"-").concat(b).concat(S?"-reversed":""),t&&0===b&&0===I&&y.push(new i.n2({key:"".concat(D.key,"-beforeFirstRegion"),widthPx:s,offsetPx:D.offsetPx-s,variant:"boundary"})),n&&A<d?y.push(new i.sh(D)):y.push(new i.b0(D)),t&&(A>=d&&D.isRightEndOfDisplayedRegion&&b<c.length-1&&(v+=f*l,y.push(new i.n2({key:"".concat(D.key,"-rightpad"),widthPx:f,offsetPx:D.offsetPx+D.widthPx}))),b===c.length-1&&D.isRightEndOfDisplayedRegion&&(v+=f*l,y.push(new i.n2({key:"".concat(D.key,"-afterLastRegion"),widthPx:s,offsetPx:D.offsetPx+D.widthPx,variant:"boundary"}))))}v+=C-Z}return y}},74426:function(e,t,n){"use strict";n.r(t),n.d(t,{contrastingTextColor:function(){return s},emphasize:function(){return c},isNamedColor:function(){return o},makeContrasting:function(){return l},namedColorToHex:function(){return i}});var r=n(74262),a={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",grey:"#808080",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function i(e){return a[e]}function o(e){return!!a[e]}function s(e){return u(e)>.5?"black":"white"}function u(e){var t=i(e);return(0,r.H3)(t||e)}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.15,n=i(e);return(0,r._4)(n||e,t)}function l(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"white",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,a=i(e)||e,o=i(t)||t,s=u(o),c=(0,r.mi)(a,o),l=a,d=.05;c<n;)a=s>.5?(0,r._j)(l,d):(0,r.$n)(l,d),d+=.05,c=(0,r.mi)(a,o);return a}},10346:function(e,t,n){"use strict";n.d(t,{V:function(){return r.Vi}});var r=n(5463),a=n(52378),i=n(73291);(0,r.l7)([a.Z,i.Z])},27292:function(e,t,n){"use strict";n.d(t,{D:function(){return a}});var r=n(41361);function a(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JSON.stringify,a=[],i=new Set,o=(0,r.Z)(e);try{for(o.s();!(t=o.n()).done;){var s=t.value,u=n(s);i.has(u)||(a.push(s),i.add(u))}}catch(c){o.e(c)}finally{o.f()}return a}},37813:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(81073);function a(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0,i=Object.keys(e);n<i.length;n++){var o=i[n];if(t.length>5e3)break;t+="object"===typeof e[o]&&e[o]?a(e[o],t):"".concat(o,"-").concat(e[o],";")}return(0,r.hashCode)(t)}},33528:function(e,t,n){"use strict";n.r(t),n.d(t,{RemoteFileWithRangeCache:function(){return x},getFetcher:function(){return P},openLocation:function(){return T},resolveUriLocation:function(){return S}});var r=n(32723),a=n(34795),i=n(33028),o=n(5482),s=n(88778),u=n.n(s),c=n(41361),l=n(96234),d=n(9249),f=n(87371),p=n(93069),h=n(95058),g=n(45754),m=n(13820),v=n(26165),y=n(44765),b={};var w=new v.t({fetch:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=b[e];if(!a)throw new Error("fetch not registered for ".concat(e));return a(e,t,n,r)},size:500*Math.pow(1024,2),chunkSize:131072,maxFetchSize:100*Math.pow(1024,2),minimumTTL:864e5});var x=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,d.Z)(this,n),t.apply(this,arguments)}return(0,f.Z)(n,[{key:"fetch",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,a){var i,o,s,u,c,d,f,g,m,v,y,x;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b[String(t)]||(b[String(t)]=this.fetchBinaryRange.bind(this)),(i=null===a||void 0===a?void 0:a.headers)&&(i instanceof Headers?o=i.get("range"):Array.isArray(i)?(s=i.find((function(e){return"range"===(0,l.Z)(e,1)[0]}))||[void 0,void 0],u=(0,l.Z)(s,2),o=u[1]):o=i.range),!o){e.next=14;break}if(!(c=/bytes=(\d+)-(\d+)/.exec(o))){e.next=14;break}return d=(0,l.Z)(c,3),f=d[1],g=d[2],m=Number.parseInt(f,10),v=Number.parseInt(g,10),e.next=11,w.getRange(t,m,v-m+1,{signal:null===a||void 0===a?void 0:a.signal});case 11:return y=e.sent,x=y.headers,e.abrupt("return",new Response(y.buffer,{status:206,headers:x}));case 14:return e.abrupt("return",(0,p.Z)((0,h.Z)(n.prototype),"fetch",this).call(this,t,a));case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetchBinaryRange",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,a,o){var s,u,d,f,g,m,v,b,w,x,k,Z,C,S=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=S.length>3&&void 0!==S[3]?S[3]:{},u=new Date,d=(0,i.Z)((0,i.Z)({},s.headers),{},{range:"bytes=".concat(a,"-").concat(o)}),e.next=5,(0,p.Z)((0,h.Z)(n.prototype),"fetch",this).call(this,t,(0,i.Z)((0,i.Z)({},s),{},{headers:d}));case 5:if(f=e.sent,g=new Date,206===f.status){e.next=11;break}throw m="HTTP ".concat(f.status," (").concat(f.statusText,") when fetching ").concat(t," bytes ").concat(a,"-").concat(o)," (should be 206 for range requests)",new Error("".concat(m).concat(200===f.status?" (should be 206 for range requests)":""));case 11:v={},b=(0,c.Z)(f.headers.entries());try{for(b.s();!(w=b.n()).done;)x=(0,l.Z)(w.value,2),k=x[0],Z=x[1],v[k]=Z}catch(r){b.e(r)}finally{b.f()}return e.next=16,f.arrayBuffer();case 16:return C=e.sent,e.abrupt("return",{headers:v,requestDate:u,responseDate:g,buffer:y.Buffer.from(C)});case 18:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(o.kC),k=n(8438),Z=n(97891),C=n(81073);function S(e){return e.baseUri?(0,i.Z)((0,i.Z)({},e),{},{uri:new URL(e.uri,e.baseUri).href}):e}function T(e,t){if(!e)throw new Error("must provide a location to openLocation");if(function(e){return"localPath"in e}(e)){if(!e.localPath)throw new Error("No local path provided");if(u()||C.isElectron)return new o.S9(e.localPath);throw new Error("can't use local files in the browser")}if(function(e){return"blobId"in e}(e)){var n=(0,Z.getBlob)(e.blobId);if(!n)throw new Error('file ("'.concat(e.name,'") was opened locally from a previous session. To restore it, go to track settings and reopen the file'));return new o.SH(n)}if((0,k.hb)(e)){if(!e.uri)throw new Error("No URI provided");var r=S(e);if(t){var a=M(e,t);if(a)return a.openLocation(r)}return new x(r.uri,{fetch:R})}throw new Error("invalid fileLocation")}function P(e,t){if(!(0,k.hb)(e))throw new Error("Not a valid UriLocation: ".concat(JSON.stringify(e)));if(t){var n=M(e,t);if(n)return n.getFetcher(e)}return R}function M(e,t){var n=t.rootModel;if(n&&(0,k.At)(n))return n.findAppropriateInternetAccount(e);if(e.internetAccountPreAuthorization){if(!e.internetAccountPreAuthorization.authInfo.token)throw new Error("Failed to obtain token from internet account. Try reloading the page");return t.getInternetAccountType(e.internetAccountPreAuthorization.internetAccountType).stateModel.create({type:e.internetAccountPreAuthorization.internetAccountType,configuration:e.internetAccountPreAuthorization.authInfo.configuration})}}function R(e,t){return A.apply(this,arguments)}function A(){return(A=(0,a.Z)((0,r.Z)().mark((function e(t,n){var a,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,n);case 2:if(401!==(i=e.sent).status||null===(a=i.headers.get("WWW-Authenticate"))||void 0===a||!a.includes("Basic")){e.next=5;break}throw new k.yb("Accessing HTTPBasic resource without authentication",t.toString());case 5:return e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},11192:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(58145),a=n.n(r);function i(){var e=new(a().Jexl);return e.addFunction("get",(function(e,t){return e.get(t)})),e.addFunction("parent",(function(e){return e.parent()})),e.addFunction("id",(function(e){return e.id()})),e.addFunction("cast",(function(e){return e})),e.addFunction("log",(function(e){return console.log(e),e})),e.addFunction("max",Math.max),e.addFunction("min",Math.min),e.addFunction("sqrt",Math.sqrt),e.addFunction("ceil",Math.ceil),e.addFunction("floor",Math.floor),e.addFunction("round",Math.round),e.addFunction("abs",Math.abs),e.addFunction("log10",Math.log10),e.addFunction("parseInt",Number.parseInt),e.addFunction("parseFloat",Number.parseFloat),e.addFunction("split",(function(e,t){return e.split(t)})),e.addFunction("charAt",(function(e,t){return e.charAt(t)})),e.addFunction("charCodeAt",(function(e,t){return e.charCodeAt(t)})),e.addFunction("codePointAt",(function(e,t){return e.codePointAt(t)})),e.addFunction("startsWith",(function(e,t,n){return e.startsWith(t,n)})),e.addFunction("endsWith",(function(e,t,n){return e.endsWith(t,n)})),e.addFunction("padEnd",(function(e,t,n){return e.padEnd(t,n)})),e.addFunction("padStart",(function(e,t,n){return e.padStart(t,n)})),e.addFunction("repeat",(function(e,t){return e.repeat(t)})),e.addFunction("replace",(function(e,t,n){return e.replace(t,n)})),e.addFunction("replaceAll",(function(e,t,n){return e.replaceAll(t,n)})),e.addFunction("slice",(function(e,t,n){return e.slice(t,n)})),e.addFunction("startsWith",(function(e,t,n){return e.startsWith(t,n)})),e.addFunction("substring",(function(e,t,n){return e.substring(t,n)})),e.addFunction("toLowerCase",(function(e){return e.toLowerCase()})),e.addFunction("toUpperCase",(function(e){return e.toUpperCase()})),e.addFunction("trim",(function(e){return e.trim()})),e.addFunction("trimEnd",(function(e){return e.trimEnd()})),e.addFunction("trimStart",(function(e){return e.trimStart()})),e.addFunction("getTag",(function(e,t){var n=e.get("tags");return n?n[t]:e.get(t)})),e.addBinaryOp("&",15,(function(e,t){return e&t})),e}},32665:function(e,t,n){"use strict";n.d(t,{P:function(){return i}});var r=n(11192),a={};function i(e,t){var n="nosig|".concat(e);if(!a[n]){if(!e.startsWith("jexl:"))throw new Error("string does not appear to be in jexl format");var i=e.split("jexl:")[1],o=t?t.compile("".concat(i)):(0,r.Z)().compile("".concat(i));a[n]=o}return a[n]}},26354:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(96234),a=n(41361),i=n(68079),o=n(9249),s=n(87371),u=1e4;function c(e,t,n,r){return t>=n&&r>=e}var l=function(){function e(){(0,o.Z)(this,e),this.padding=1,this.allFilled=void 0,this.widthLimit=1e6,this.rowState=void 0}return(0,s.Z)(e,[{key:"setAllFilled",value:function(e){this.allFilled=e}},{key:"getItemAt",value:function(e){var t;return this.allFilled?this.allFilled:void 0===(null===(t=this.rowState)||void 0===t?void 0:t.min)||e<this.rowState.min||e>=this.rowState.max?void 0:this.rowState.bits[e-this.rowState.offset]}},{key:"isRangeClear",value:function(e,t){if(this.allFilled)return!1;if(void 0===this.rowState||t<=this.rowState.min||e>=this.rowState.max)return!0;for(var n=this.rowState,r=n.min,a=n.max,i=n.offset,o=n.bits,s=Math.min(a,t)-i,u=!0,c=Math.max(r,e)-i;c<s&&u;c++)u=void 0===o[c];return u}},{key:"initialize",value:function(e,t){var n=t-e;return{offset:e-n,min:e,max:t,bits:Array.from({length:3*n})}}},{key:"addRect",value:function(e,t){var n=e.l,r=e.r+this.padding;this.rowState||(this.rowState=this.initialize(n,r));var a=n-this.rowState.offset,o=r-this.rowState.offset,s=this.rowState.bits.length;if(o>=this.rowState.bits.length){var u=o+1;this.rowState.bits.length+u>this.widthLimit?(console.warn("Layout width limit exceeded, discarding old layout. Please be more careful about discarding unused blocks."),this.rowState=this.initialize(n,r)):u>0&&(this.rowState.bits=[].concat((0,i.Z)(this.rowState.bits),(0,i.Z)(Array.from({length:u}))))}if(n<this.rowState.offset){var c=Math.min(s-a,this.rowState.offset);this.rowState.bits.length+c>this.widthLimit?(console.warn("Layout width limit exceeded, discarding old layout. Please be more careful about discarding unused blocks."),this.rowState=this.initialize(n,r)):(this.rowState.bits=[].concat((0,i.Z)(Array.from({length:c})),(0,i.Z)(this.rowState.bits)),this.rowState.offset-=c)}var l=(o=r-this.rowState.offset)-(a=n-this.rowState.offset);l>2e4&&console.warn("Layout X pitch set too low, feature spans ".concat(l," bits in a single row."),e,t);for(var d=a;d<o;d+=1)this.rowState.bits[d]=t;n<this.rowState.min&&(this.rowState.min=n),r>this.rowState.max&&(this.rowState.max=r)}},{key:"discardRange",value:function(e,t){if(!this.allFilled&&this.rowState&&!(t<=this.rowState.min||e>=this.rowState.max))if(e<=this.rowState.min&&t>=this.rowState.max)this.rowState=void 0;else{if(t>this.rowState.min&&e<=this.rowState.min&&(this.rowState.min=t),e<this.rowState.max&&t>=this.rowState.max&&(this.rowState.max=e),this.rowState.offset<this.rowState.min-u&&this.rowState.bits.length>this.rowState.max+u-this.rowState.offset){var n=this.rowState.min-this.rowState.offset,r=this.rowState.bits.length-1-(this.rowState.max-this.rowState.offset);this.rowState.bits=this.rowState.bits.slice(n,this.rowState.bits.length-r),this.rowState.offset+=n}else if(this.rowState.offset<this.rowState.min-u){var a=this.rowState.min-Math.floor(5e3)-this.rowState.offset;this.rowState.bits.splice(0,a),this.rowState.offset+=a}else if(this.rowState.bits.length>this.rowState.max-this.rowState.offset+u){var i=this.rowState.max-this.rowState.offset+1+Math.floor(5e3);this.rowState.bits.length=i}for(var o=Math.max(this.rowState.min,e)-this.rowState.offset,s=Math.min(t,this.rowState.max)-this.rowState.offset,c=o;c>=0&&c<s;c+=1)this.rowState.bits[c]=void 0}}}]),e}(),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.pitchX,r=void 0===n?10:n,a=t.pitchY,i=void 0===a?10:a,s=t.maxHeight,u=void 0===s?1e4:s,c=t.hardRowLimit,l=void 0===c?1e4:c,d=t.displayMode,f=void 0===d?"normal":d;(0,o.Z)(this,e),this.pitchX=void 0,this.pitchY=void 0,this.hardRowLimit=void 0,this.bitmap=void 0,this.rectangles=void 0,this.maxHeightReached=void 0,this.maxHeight=void 0,this.displayMode=void 0,this.pTotalHeight=void 0,this.pitchX=r,this.pitchY=i,this.hardRowLimit=l,this.maxHeightReached=!1,this.displayMode=f,"compact"===this.displayMode&&(this.pitchY=Math.round(this.pitchY/4)||1,this.pitchX=Math.round(this.pitchX/4)||1),this.bitmap=[],this.rectangles=new Map,this.maxHeight=Math.ceil(u/this.pitchY),this.pTotalHeight=0}return(0,s.Z)(e,[{key:"addRect",value:function(e,t,n,r,a){var i=this.rectangles.get(e);if(i)return null===i.top?null:(this.addRectToBitmap(i),i.top*this.pitchY);var o=Math.floor(t/this.pitchX),s=Math.floor(n/this.pitchX),u=Math.ceil(r/this.pitchY),c={id:e,l:o,r:s,top:null,h:u,originalHeight:r,data:a},l=this.maxHeight-u,d=0;if("collapse"!==this.displayMode){for(;d<=l&&this.collides(c,d);d+=1);if(d>l)return c.top=null,this.rectangles.set(e,c),this.maxHeightReached=!0,null}return c.top=d,this.addRectToBitmap(c),this.rectangles.set(e,c),this.pTotalHeight=Math.max(this.pTotalHeight||0,d+u),d*this.pitchY}},{key:"collides",value:function(e,t){for(var n=this.bitmap,r=t+e.h,a=t;a<r;a+=1){var i=n[a];if(void 0!==i&&!i.isRangeClear(e.l,e.r))return!0}return!1}},{key:"autovivifyRow",value:function(e,t){var n=e[t];if(!n){if(t>this.hardRowLimit)throw new Error("layout hard limit (".concat(this.hardRowLimit*this.pitchY,"px) exceeded, aborting layout"));n=new l,e[t]=n}return n}},{key:"addRectToBitmap",value:function(e){if(null!==e.top){var t=e.id,n=e.top+e.h;if(e.r-e.l>2e4)for(var r=e.top;r<n;r+=1)this.autovivifyRow(this.bitmap,r).setAllFilled(t);else for(var a=e.top;a<n;a+=1)this.autovivifyRow(this.bitmap,a).addRect(e,t)}}},{key:"discardRange",value:function(e,t){var n,r=Math.floor(e/this.pitchX),i=Math.floor(t/this.pitchX),o=this.bitmap,s=(0,a.Z)(o);try{for(s.s();!(n=s.n()).done;){var u=n.value;u&&u.discardRange(r,i)}}catch(c){s.e(c)}finally{s.f()}}},{key:"hasSeen",value:function(e){return this.rectangles.has(e)}},{key:"getByCoord",value:function(e,t){var n=Math.floor(t/this.pitchY),r=this.bitmap[n];if(r){var a=Math.floor(e/this.pitchX);return r.getItemAt(a)}}},{key:"getByID",value:function(e){var t=this.rectangles.get(e);if(t){var n=t.top*this.pitchY;return[t.l*this.pitchX,n,t.r*this.pitchX,n+t.originalHeight]}}},{key:"getDataByID",value:function(e){var t;return null===(t=this.rectangles.get(e))||void 0===t?void 0:t.data}},{key:"cleanup",value:function(){}},{key:"getTotalHeight",value:function(){return this.pTotalHeight*this.pitchY}},{key:"totalHeight",get:function(){return this.getTotalHeight()}},{key:"getRectangles",value:function(){var e=this;return new Map((0,i.Z)(this.rectangles.entries()).map((function(t){var n=(0,r.Z)(t,2),a=n[0],i=n[1],o=i.l,s=i.r,u=i.originalHeight,c=(i.top||0)*e.pitchY,l=c+u;return[a,[o*e.pitchX,c,s*e.pitchX,l]]})))}},{key:"serializeRegion",value:function(e){var t,n={},i=!1,o=(0,a.Z)(this.rectangles.entries());try{for(o.s();!(t=o.n()).done;){var s=(0,r.Z)(t.value,2),u=s[0],l=s[1],d=l.l,f=l.r,p=l.originalHeight,h=l.top;if(null===l.top)i=!0;else{var g=(h||0)*this.pitchY,m=g+p,v=d*this.pitchX,y=f*this.pitchX;c(e.start,e.end,v-this.pitchX,y+this.pitchX)&&(n[u]=[v,g,y,m])}}}catch(b){o.e(b)}finally{o.f()}return{rectangles:n,containsNoTransferables:!0,totalHeight:this.getTotalHeight(),maxHeightReached:i}}},{key:"toJSON",value:function(){return{rectangles:Object.fromEntries(this.getRectangles()),containsNoTransferables:!0,totalHeight:this.getTotalHeight(),maxHeightReached:this.maxHeightReached}}}]),e}()},35064:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(96234),a=n(41361),i=n(9249),o=n(87371),s=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.Z)(this,e),this.SubLayoutClass=t,this.subLayoutConstructorArgs=n,this.subLayouts=new Map}return(0,o.Z)(e,[{key:"getDataByID",value:function(e){var t,n=(0,a.Z)(this.subLayouts.values());try{for(n.s();!(t=n.n()).done;){var r=t.value.getDataByID(e);if(r)return r}}catch(i){n.e(i)}finally{n.f()}}},{key:"getSublayout",value:function(e){var t=this.subLayouts.get(e);return void 0===t?(t=new this.SubLayoutClass(this.subLayoutConstructorArgs),this.subLayouts.set(e,t),t):t}},{key:"addRect",value:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};return this.getSublayout(e).addRect(t,n,r,a,i)}},{key:"discardRange",value:function(e,t,n){var r;return null===(r=this.subLayouts.get(e))||void 0===r?void 0:r.discardRange(t,n)}},{key:"toJSON",value:function(){var e,t={},n=(0,a.Z)(this.subLayouts.entries());try{for(n.s();!(e=n.n()).done;){var i=(0,r.Z)(e.value,2),o=i[0],s=i[1];t[o]=s.toJSON()}}catch(u){n.e(u)}finally{n.f()}return t}}]),e}()},2972:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(96234),a=n(9249),i=n(87371),o=n(68294),s=n.n(o),u=function(){function e(t){var n=t.rectangles,i=t.totalHeight,o=t.maxHeightReached;(0,a.Z)(this,e),this.rectangles=void 0,this.totalHeight=void 0,this.maxHeightReached=void 0,this.rbush=void 0,this.rectangles=new Map(Object.entries(n)),this.totalHeight=i,this.maxHeightReached=o,this.rbush=new(s());for(var u=0,c=Object.entries(n);u<c.length;u++){var l=(0,r.Z)(c[u],2),d=l[0],f=l[1];this.rbush.insert({minX:f[0],minY:f[1],maxX:f[2],maxY:f[3],name:d})}}return(0,i.Z)(e,[{key:"addRect",value:function(e){var t=this.rectangles.get(e);if(!t)throw new Error("id ".concat(e," not found in precomputed feature layout"));return t[1]}},{key:"getRectangles",value:function(){return this.rectangles}},{key:"getTotalHeight",value:function(){return this.totalHeight}},{key:"collides",value:function(e,t){throw new Error("Method not implemented.")}},{key:"getByCoord",value:function(e,t){var n={minX:e,minY:t,maxX:e+1,maxY:t+1};return this.rbush.collides(n)?this.rbush.search(n)[0].name:void 0}},{key:"getByID",value:function(e){return this.rectangles.get(e)}},{key:"addRectToBitmap",value:function(e,t){throw new Error("Method not implemented.")}},{key:"discardRange",value:function(e,t){throw new Error("Method not implemented.")}},{key:"serializeRegion",value:function(e){throw new Error("Method not implemented.")}},{key:"toJSON",value:function(){return{rectangles:Object.fromEntries(this.rectangles),totalHeight:this.totalHeight,maxHeightReached:!1,containsNoTransferables:!0}}}]),e}()},41472:function(e,t,n){"use strict";n.r(t),n.d(t,{GranularRectLayout:function(){return r.Z},MultiLayout:function(){return a.Z},PrecomputedLayout:function(){return i.Z},PrecomputedMultiLayout:function(){return f},SceneGraph:function(){return g}});var r=n(26354),a=n(35064),i=n(2972),o=n(96234),s=n(45754),u=n(13820),c=n(87371),l=n(9249),d=(0,c.Z)((function e(){throw(0,l.Z)(this,e),new Error("invalid layout name")})),f=function(e){(0,s.Z)(n,e);var t=(0,u.Z)(n);function n(e){var r;return(0,l.Z)(this,n),r=t.call(this,d),Object.entries(e).forEach((function(e){var t=(0,o.Z)(e,2),n=t[0],a=t[1];r.subLayouts.set(n,new i.Z(a))})),r}return(0,c.Z)(n)}(a.Z),p=n(41361),h=n(81073),g=function(){function e(t,n,r,a,i,o){if((0,l.Z)(this,e),this.name=t,this.left=n,this.top=r,this.width=a,this.height=i,this.data=o,this.children=void 0,this.absoluteCache=void 0,this.parent=void 0,h.inDevelopment&&("string"!==typeof t||"number"!==typeof n||Number.isNaN(n)||"number"!==typeof r||Number.isNaN(r)||"number"!==typeof a||Number.isNaN(a)||"number"!==typeof i||Number.isNaN(i)))throw new TypeError("invalid SceneGraph arguments");this.children=new Map,this.absoluteCache={dirty:!0}}return(0,c.Z)(e,[{key:"addChild",value:function(t,n,r,a,i,o){var s=t instanceof e?t:new e(t,n,r,a,i,o);if(!(s instanceof e))throw new TypeError("argument to addChild must be an array or a SceneGraph");if(this.children.has(s.name))throw new Error('child named "'.concat(s.name,'" already exists'));s.parent=this;var u=s.absolute,c=u.left,l=u.right,d=u.top,f=u.bottom;return void 0!==c&&void 0!==l&&void 0!==d&&void 0!==f&&(this.expand(c,l,d,f),this.children.set(s.name,s)),s}},{key:"getSubRecord",value:function(e){return this.children.get(e)}},{key:"expand",value:function(e,t,n,r){var a=this.absolute,i=a.left,o=a.right,s=a.top,u=a.bottom;if(void 0!==i&&e<i){var c=i-e;this.width+=c,this.left-=c}if(void 0!==o&&t>o&&(this.width+=t-o),void 0!==s&&n<s){var l=s-n;this.height+=l,this.top-=l}void 0!==u&&r>u&&(this.height+=r-u),this.parent&&this.parent.expand(e,t,n,r),this.absoluteCache.dirty=!0}},{key:"bottom",get:function(){return this.top+this.height}},{key:"right",get:function(){return this.left+this.width}},{key:"walkParents",value:function(e){this.parent&&(e(this.parent),this.parent.walkParents(e))}},{key:"walkChildren",value:function(e){var t,n=(0,p.Z)(this.children.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;e(r),r.walkChildren(e)}}catch(a){n.e(a)}finally{n.f()}}},{key:"absolute",get:function(){if(this.absoluteCache.dirty){var e=0,t=0;this.walkParents((function(n){e+=n.left,t+=n.top})),this.absoluteCache={dirty:!1,left:this.left+e,right:this.right+e,top:this.top+t,bottom:this.bottom+t,width:this.width,height:this.height}}return this.absoluteCache}},{key:"move",value:function(e,t){this.left+=e,this.top+=t,this.absoluteCache.dirty=!0,this.walkChildren((function(e){e.absoluteCache.dirty=!0}));var n=this.absolute,r=n.left,a=n.right,i=n.top,o=n.bottom;void 0!==r&&void 0!==a&&void 0!==i&&void 0!==o&&this.expand(r,a,i,o)}}]),e}()},83265:function(e,t,n){"use strict";n.r(t),n.d(t,{getDefaultValue:function(){return s},getEnumerationValues:function(){return u},getPropertyType:function(){return o},getSubType:function(){return a},getUnionSubTypes:function(){return i},resolveLateType:function(){return c}});var r=n(40909);function a(e){var t;if((0,r.isOptionalType)(e))t=e._subtype||e.type;else{if(!(0,r.isArrayType)(e)&&!(0,r.isMapType)(e)){if("function"===typeof e.getSubType)return e.getSubType();throw new TypeError("unsupported mst type")}t=e._subtype||e._subType||e.subType}if(!t)throw new Error("failed to get subtype");return t}function i(e){if(!(0,r.isUnionType)(e))throw new TypeError("not an MST union type");var t=e._types||e.types||a(e)._types||a(e).types;if(!t)throw new Error("failed to extract subtypes from mst union");return t}function o(e,t){return e.properties[t]}function s(e){if(!(0,r.isOptionalType)(e))throw new TypeError("type must be an optional type");return e._defaultValue||e.defaultValue}function u(e){return i(e).map((function(e){return e.value}))}function c(e){return(0,r.isUnionType)(e)||(0,r.isArrayType)(e)||!(0,r.isLateType)(e)?e:e.getSubType()}},68559:function(e,t,n){"use strict";n.d(t,{x0:function(){return r}});var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;return crypto.getRandomValues(new Uint8Array(e)).reduce((function(e,t){return e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"}),"")}},66025:function(e,t,n){"use strict";n.d(t,{Ck:function(){return i},MC:function(){return a},kv:function(){return d},vL:function(){return r}});var r,a,i,o=n(32723),s=n(34795),u=n(88778),c=n.n(u),l=n(41496);function d(e,t){e.serializedCommands?new l.CanvasSequence(e.serializedCommands).execute(t):t.drawImage(e,0,0)}var f="function"===typeof OffscreenCanvas,p=c();f?(r=function(e,t){return new OffscreenCanvas(e,t)},a=window.createImageBitmap||self.createImageBitmap,i=window.ImageBitmap||self.ImageBitmap):p?(r=function(){return nodeCreateCanvas.apply(void 0,arguments)},a=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n,r,a=arguments;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((a.length<=1?0:a.length-1)>0)){e.next=2;break}throw new Error("only one-argument uses of createImageBitmap are supported by the node offscreencanvas ponyfill");case 2:return n=t.toDataURL(),r=new nodeImage,e.abrupt("return",new Promise((function(e,t){r.onload=function(){return e(r)},r.onerror=t,r.src=n})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):(r=function(e,t){var n=new l.CanvasSequence;return{width:e,height:t,getContext:function(){return n}}},a=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.getContext("2d"),e.abrupt("return",{height:t.height,width:t.width,serializedCommands:n.toJSON(),containsNoTransferables:!0});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i=String)},54306:function(e,t,n){"use strict";n.d(t,{AN:function(){return g},Cj:function(){return d},E9:function(){return p}});var r=n(32723),a=n(33028),i=n(34795),o=n(30969),s=n(41496),u=n(66025),c=n(81073),l=n(37574);function d(e,t,n,r){return f.apply(this,arguments)}function f(){return(f=(0,i.Z)((0,r.Z)().mark((function e(t,n,i,o){var d,f,p,h,g,m,v,y,b,w,x,k,Z;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=i.exportSVG,f=i.highResolutionScaling,p=void 0===f?1:f,!d){e.next=43;break}if(d.rasterizeLayers){e.next=10;break}return h=new s.CanvasSequence,e.next=6,o(h);case 6:return g=e.sent,e.abrupt("return",(0,a.Z)((0,a.Z)({},g),{},{canvasRecordedData:h.toJSON()}));case 10:if(m=d.scale||p,v=(0,u.vL)(Math.ceil(t*m),n*m),y=v.getContext("2d")){e.next=15;break}throw new Error("2d canvas rendering not supported on this platform");case 15:return y.scale(m,m),e.next=18,o(y);case 18:if(b=e.sent,e.t0=a.Z,e.t1=(0,a.Z)({},b),e.t2={},e.t3=l.jsx,e.t4=t,e.t5=n,!("convertToBlob"in v)){e.next=35;break}return e.t7=c.blobToDataURL,e.next=29,v.convertToBlob({type:"image/png"});case 29:return e.t8=e.sent,e.next=32,(0,e.t7)(e.t8);case 32:e.t6=e.sent,e.next=36;break;case 35:e.t6=v.toDataURL("image/png");case 36:return e.t9=e.t6,e.t10={width:e.t4,height:e.t5,xlinkHref:e.t9},e.t11=(0,e.t3)("image",e.t10),e.t12={reactElement:e.t11},e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t12));case 41:e.next=60;break;case 43:if(w=p,x=(0,u.vL)(Math.ceil(t*w),n*w),k=x.getContext("2d")){e.next=48;break}throw new Error("2d canvas rendering not supported on this platform");case 48:return k.scale(w,w),e.next=51,o(k);case 51:return Z=e.sent,e.t13=a.Z,e.t14=(0,a.Z)({},Z),e.t15={},e.next=57,(0,u.MC)(x);case 57:return e.t16=e.sent,e.t17={imageData:e.t16},e.abrupt("return",(0,e.t13)(e.t14,e.t15,e.t17));case 60:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return h.apply(this,arguments)}function h(){return(h=(0,i.Z)((0,r.Z)().mark((function e(t){var a,i,o,u,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.width,i=t.height,o=t.canvasRecordedData,e.next=3,n.e(9062).then(n.t.bind(n,39062,23));case 3:return u=e.sent,c=new u.default(a,i),new s.CanvasSequence(o).execute(c),e.abrupt("return",c.getSvg().innerHTML);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){var t=e.rendering;return(0,l.jsx)(l.Fragment,{children:o.isValidElement(t.reactElement)?t.reactElement:(0,l.jsx)("g",{dangerouslySetInnerHTML:{__html:t.html||""}})})}},37654:function(e,t,n){"use strict";function r(e,t,n,r){return t>n&&e<r&&r-n&&t-e?e>n?t<r?[e,t]:[e,r]:t<r?[n,t]:[n,r]:[]}function a(e,t,n,r){return t>n&&e<r}function i(e,t,n,r){return n<=e&&r>=t}n.d(t,{J7:function(){return i},U0:function(){return r},qY:function(){return a}})},26131:function(e,t,n){"use strict";n.r(t),n.d(t,{ObservableCreate:function(){return o}});var r=n(90233),a=n(53846),i=n(81073);function o(e,t){return r.y.create((function(t){try{var n=e(t);n&&n.catch&&n.catch((function(e){return t.error(e)}))}catch(r){t.error(r)}})).pipe((0,a.R)((0,i.observeAbortSignal)(t)))}},14956:function(e,t,n){"use strict";n.d(t,{T:function(){return o},Z:function(){return u}});var r=n(33028),a=n(9249),i=n(87371);function o(e){return"object"===typeof e&&null!==e&&"function"===typeof e.get&&"function"===typeof e.id}function s(e){return"uniqueId"in e&&"object"!==typeof e.data}var u=function(){function e(t){var n=this;(0,a.Z)(this,e),this.data=void 0,this.subfeatures=void 0,this.parentHandle=void 0,this.uniqueId=void 0,s(t)?this.data=t:(this.data=t.data||{},this.parentHandle=t.parent);var i,o=s(t)?t.uniqueId:t.id;if(void 0===o||null===o)throw new Error("SimpleFeature requires a unique `id` or `data.uniqueId` attribute");if(this.uniqueId=String(o),!(this.data.aliases||this.data.end-this.data.start>=0))throw new Error("invalid feature data, end less than start. end: ".concat(this.data.end," start: ").concat(this.data.start));this.data.subfeatures&&(this.subfeatures=null===(i=this.data.subfeatures)||void 0===i?void 0:i.map((function(t,a){return"function"!==typeof t.get?new e({id:t.uniqueId||"".concat(o,"-").concat(a),data:(0,r.Z)({strand:n.data.strand},t),parent:n}):t})))}return(0,i.Z)(e,[{key:"get",value:function(e){return"subfeatures"===e?this.subfeatures:"parent"===e?this.parent():this.data[e]}},{key:"set",value:function(e,t){this.data[e]=t}},{key:"tags",value:function(){return Object.keys(this.data)}},{key:"id",value:function(){return this.uniqueId}},{key:"parent",value:function(){return this.parentHandle}},{key:"children",value:function(){return this.get("subfeatures")}},{key:"toJSON",value:function(){var e=(0,r.Z)((0,r.Z)({},this.data),{},{uniqueId:this.id()}),t=this.parent();t&&(e.parentId=t.id());var n=this.children();return n&&(e.subfeatures=n.map((function(e){return e.toJSON()}))),e}}],[{key:"fromJSON",value:function(t){return new e((0,r.Z)({},t))}}]),e}()},66518:function(e,t,n){"use strict";n.d(t,{I9:function(){return c},fK:function(){return l},fY:function(){return f}});var r=n(32723),a=n(34795),i=n(33028),o=n(81450),s=n(55564);function u(e,t,n){var r;return 0===n?0:(arguments.length>3&&void 0!==arguments[3]&&arguments[3]?r=t/n-e*e/(n*n):(r=t-e*e/n,n>1&&(r/=n-1)),r<0?0:Math.sqrt(r))}function c(e){return(0,i.Z)((0,i.Z)({},e),{},{scoreMean:(e.scoreSum||0)/(e.featureCount||e.basesCovered||1),scoreStdDev:u(e.scoreSum,e.scoreSumSquares,e.featureCount||e.basesCovered),featureDensity:(e.featureCount||1)/e.basesCovered})}function l(e,t){return d.apply(this,arguments)}function d(){return(d=(0,a.Z)((0,r.Z)().mark((function e(t,n){var a,i,u,l,d,f,p,h,g,m;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.start,i=t.end,u={scoreMin:Number.MAX_VALUE,scoreMax:Number.MIN_VALUE,scoreSum:0,scoreSumSquares:0,featureCount:0},l=!1,e.next=5,(0,o.z)(n.pipe((0,s.u)((function(e,t){var n=t.get("score"),r=t.get("summary"),a=e.scoreMax,i=e.scoreMin;return e.scoreMax=Math.max(a,r?t.get("maxScore"):n),e.scoreMin=Math.min(i,r?t.get("minScore"):n),e.scoreSum+=n,e.scoreSumSquares+=n*n,e.featureCount+=1,l=!0,e}),u)));case 5:return d=e.sent,f=d.scoreMin,p=d.scoreMax,h=d.scoreSum,g=d.scoreSumSquares,m=d.featureCount,e.abrupt("return",l?c({scoreMax:p,scoreMin:f,scoreSum:h,scoreSumSquares:g,featureCount:m,basesCovered:i-a+1}):{scoreMin:0,scoreMax:0,scoreMean:0,scoreStdDev:0,scoreSum:0,scoreSumSquares:0,featureCount:0,featureDensity:0,basesCovered:0});case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){return{scoreMin:0,scoreMax:0,scoreMean:0,scoreStdDev:0,scoreSum:0,scoreSumSquares:0,featureCount:0,featureDensity:0,basesCovered:0}}},97891:function(e,t,n){"use strict";n.r(t),n.d(t,{UNKNOWN:function(){return c},UNSUPPORTED:function(){return l},generateUnknownTrackConf:function(){return Z},generateUnsupportedTrackConf:function(){return k},getBlob:function(){return f},getBlobMap:function(){return p},getFileName:function(){return b},getParentRenderProps:function(){return u},getRpcSessionId:function(){return s},getTrackAssemblyNames:function(){return o},getTrackName:function(){return C},guessAdapter:function(){return w},guessTrackType:function(){return x},makeIndex:function(){return v},makeIndexType:function(){return y},setBlobMap:function(){return h},storeBlobLocation:function(){return m}});var r=n(40909),a=n(81073),i=n(9077);function o(e){var t=(0,i.getConf)(e,"assemblyNames");if(!t){var n=(0,r.getParent)(e.configuration);if("sequence"in n)return[(0,i.readConfObject)(n,"name")]}return t}function s(e){for(var t,n=e;!(0,r.isRoot)(n);n=(0,r.getParent)(n))"rpcSessionId"in n&&(t=n.rpcSessionId);if(!t)throw new Error("getRpcSessionId failed, no parent node in the state tree has an `rpcSessionId` attribute");return t}function u(e){for(var t=(0,r.getParent)(e);!(0,r.isRoot)(t);t=(0,r.getParent)(t))if("renderProps"in t)return t.renderProps();return{}}var c="UNKNOWN",l="UNSUPPORTED",d={};function f(e){return d[e]}function p(){return d}function h(e){d=e}var g=0;function m(e){if(e&&"blob"in e){var t="b".concat(+Date.now(),"-").concat(g++);return d[t]=e.blob,{name:null===e||void 0===e?void 0:e.blob.name,blobId:t,locationType:"BlobLocation"}}return e}function v(e,t){return"uri"in e?{uri:e.uri+t,locationType:"UriLocation"}:"localPath"in e?{localPath:e.localPath+t,locationType:"LocalPathLocation"}:e}function y(e,t,n){return null!==e&&void 0!==e&&e.toUpperCase().endsWith(t)?t:n}function b(e){var t="uri"in e?e.uri:void 0,n="localPath"in e?e.localPath:void 0,r="blobId"in e?e:void 0;return(null===r||void 0===r?void 0:r.name)||(null===t||void 0===t?void 0:t.slice(t.lastIndexOf("/")+1))||(null===n||void 0===n?void 0:n.slice(n.lastIndexOf("/")+1))||""}function w(e,t,n,r){if(r){var i=(0,a.getEnv)(r).pluginManager.evaluateExtensionPoint("Core-guessAdapterForLocation",(function(e,t,n){}))(e,t,n);if(i)return i}return{type:c}}function x(e,t){if(t){var n=(0,a.getSession)(t),r=(0,a.getEnv)(n).pluginManager.evaluateExtensionPoint("Core-guessTrackTypeForLocation",(function(e){}))(e);if(r)return r}return"FeatureTrack"}function k(e,t,n){var r={type:"FeatureTrack",name:"".concat(e," (Unsupported)"),description:'Support not yet implemented for "'.concat(t,'"'),category:n,trackId:""};return r.trackId=(0,a.objectHash)(r),r}function Z(e,t,n){var r={type:"FeatureTrack",name:"".concat(e," (Unknown)"),description:'Could not determine track type for "'.concat(t,'"'),category:n,trackId:""};return r.trackId=(0,a.objectHash)(r),r}function C(e,t){var n=(0,i.readConfObject)(e,"name");if(!n&&"ReferenceSequenceTrack"===(0,i.readConfObject)(e,"type")){var r=t.assemblies.find((function(t){return t.sequence===e}));return r?"Reference sequence (".concat((0,i.readConfObject)(r,"displayName")||(0,i.readConfObject)(r,"name"),")"):"Reference sequence"}return n}},8438:function(e,t,n){"use strict";n.d(t,{At:function(){return S},BQ:function(){return l},J0:function(){return T},Ms:function(){return I},PK:function(){return L},Um:function(){return Z},Z6:function(){return N},_2:function(){return v},_L:function(){return p},cX:function(){return f},d6:function(){return x},dc:function(){return C},fx:function(){return M},gC:function(){return m},gI:function(){return g},gx:function(){return h},hb:function(){return P},k$:function(){return d},ld:function(){return R},uF:function(){return y},yZ:function(){return k},yb:function(){return A},zL:function(){return b},zN:function(){return w}});var r=n(87371),a=n(9249),i=n(80753),o=n(45754),s=n(13820),u=n(30364),c=n(40909);function l(e){return(0,c.isStateTreeNode)(e)&&"removeView"in e&&"addView"in e&&"views"in e}function d(e){return"object"===typeof e&&null!==e&&"rpcManager"in e&&"configuration"in e}function f(e){return d(e)&&"editConfiguration"in e}function p(e){return d(e)&&"addTrackConf"in e&&!e.disableAddTracks}function h(e){return d(e)&&"shareURL"in e&&!!e.shareURL}function g(e){return d(e)&&"widgets"in e}function m(e){return d(e)&&"makeConnection"in e}function v(e){return d(e)&&"addConnectionConf"in e}function y(e){return d(e)&&"sessionPlugins"in e}function b(e){return"object"===typeof e&&null!==e&&"selection"in e&&"setSelection"in e}function w(e){return"object"===typeof e&&null!==e&&"width"in e&&"setWidth"in e}function x(e){return"object"===typeof e&&null!==e&&"configuration"in e&&e.configuration.trackId}function k(e){return"object"===typeof e&&null!==e&&"configuration"in e&&e.configuration.displayId}function Z(e){return"object"===typeof e&&null!==e&&"showTrack"in e&&"hideTrack"in e}function C(e){return"object"===typeof e&&null!==e&&"isAssemblyEditing"in e&&"findAppropriateInternetAccount"in e}function S(e){return"object"===typeof e&&null!==e&&"internetAccounts"in e&&"findAppropriateInternetAccount"in e}function T(e){return"object"===typeof e&&null!==e&&"appendMenu"in e&&"appendToSubMenu"in e}function P(e){return"object"===typeof e&&null!==e&&"uri"in e&&!!e.uri}function M(e){return"object"===typeof e&&null!==e&&"localPath"in e&&!!e.localPath}function R(e){return"object"===typeof e&&null!==e&&"blobId"in e&&!!e.blobId}var A=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e,r){var o;return(0,a.Z)(this,n),(o=t.call(this,e)).message=e,o.url=r,o.name="AuthNeededError",Object.setPrototypeOf((0,i.Z)(o),n.prototype),o}return(0,r.Z)(n)}((0,u.Z)(Error)),I=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e,r){var i;return(0,a.Z)(this,n),(i=t.call(this,e)).message=e,i.internetAccountId=r,i.name="RetryError",i}return(0,r.Z)(n)}((0,u.Z)(Error));function L(e){return e instanceof Error&&("AuthNeededError"===e.name||void 0!==e.url)}function N(e){return"RetryError"===e.name||void 0!==e.internetAccountId}},29206:function(e,t,n){"use strict";n.r(t),n.d(t,{BlobLocation:function(){return v},ElementId:function(){return f},FileLocation:function(){return w},LocalPathLocation:function(){return m},NoAssemblyRegion:function(){return h},PropTypes:function(){return p},Region:function(){return g},UriLocation:function(){return b},UriLocationRaw:function(){return y}});var r=n(33028),a=n(59740),i=n(40909),o=n(24974),s=n.n(o),u=n(90550),c=n(68559),l=["baseUri"],d=["locationType"],f=i.types.optional(i.types.identifier,(function(){return(0,c.x0)()})),p={Region:s().shape({refName:s().string.isRequired,start:s().number.isRequired,end:s().number.isRequired}),ConfigSchema:u.PropTypes.objectOrObservableObject,Feature:s().shape({get:s().func.isRequired,id:s().func.isRequired})},h=i.types.model("NoAssemblyRegion",{refName:i.types.string,start:i.types.number,end:i.types.number,reversed:i.types.optional(i.types.boolean,!1)}).actions((function(e){return{setRefName:function(t){e.refName=t}}})),g=i.types.compose("Region",h,i.types.model({assemblyName:i.types.string})),m=i.types.model("LocalPathLocation",{locationType:i.types.literal("LocalPathLocation"),localPath:i.types.string}),v=i.types.model("BlobLocation",{locationType:i.types.literal("BlobLocation"),name:i.types.string,blobId:i.types.string}),y=i.types.model("UriLocation",{locationType:i.types.literal("UriLocation"),uri:i.types.string,baseUri:i.types.maybe(i.types.string),internetAccountId:i.types.maybe(i.types.string),internetAccountPreAuthorization:i.types.maybe(i.types.model("InternetAccountPreAuthorization",{internetAccountType:i.types.string,authInfo:i.types.frozen()}))}),b=i.types.snapshotProcessor(y,{postProcessor:function(e){var t=e,n=t.baseUri,r=(0,a.Z)(t,l);return n?e:r}}),w=i.types.snapshotProcessor(i.types.union(m,b,v),{preProcessor:function(e){if(e){var t=e,n=t.locationType,i=(0,a.Z)(t,d);if(!n){var o=i.uri,s=i.localPath,u=i.blob,c="";return void 0!==o?c="UriLocation":void 0!==s?c="LocalPathLocation":void 0!==u&&(c="BlobLocation"),(0,r.Z)((0,r.Z)({},i),{},{locationType:c})}return e}}})},70085:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(96234),a=n(30969);function i(){var e=(0,a.useRef)(null),t=(0,a.useState)({width:void 0,height:void 0}),n=(0,r.Z)(t,2),i=n[0],o=n[1];return(0,a.useEffect)((function(){if(e.current){var t="undefined"!==typeof window&&"ResizeObserver"in window?window.ResizeObserver:void 0;if(t){var n=new t((function(e){o({width:e[0].contentRect.width,height:e[0].contentRect.height})}));return n.observe(e.current),function(){n.disconnect()}}}}),[]),[e,i]}},26132:function(e,t,n){"use strict";n.d(t,{g:function(){return s},q:function(){return u}});var r=n(32723),a=n(34795),i=n(90689),o=n(55429);function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.timeout,r=t.signal,a=t.name;return new Promise((function(t,s){var u,c=!1,l=(0,i.when)(e),d=function(){};n&&(u=setTimeout((function(){c||(c=!0,l.cancel(),s(new Error("timed out waiting for ".concat(a||"whenPresent"))))}),n),d=function(){return u&&clearTimeout(u)}),r&&r.addEventListener("abort",(function(){c||(c=!0,l.cancel(),d(),s((0,o.fP)()))})),l.then((function(){c||(c=!0,d(),t(!0))})).catch((function(e){c||(c=!0,d(),s(e))}))}))}function u(e){return c.apply(this,arguments)}function c(){return c=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},e.next=3,s((function(){var e=t();return void 0!==e&&null!==e}),n);case 3:return e.abrupt("return",t());case 4:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}},46079:function(e,t,n){"use strict";n.r(t),n.d(t,{cigarToMismatches:function(){return m},featurizeSA:function(){return I},getClip:function(){return R},getLength:function(){return P},getLengthOnRef:function(){return T},getLengthSansClipping:function(){return M},getMethBins:function(){return x},getMismatches:function(){return y},getModificationPositions:function(){return k},getModificationProbabilities:function(){return w},getModificationTypes:function(){return Z},getNextRefPos:function(){return b},getOrientedCigar:function(){return C},getOrientedMismatches:function(){return S},getTag:function(){return A},mdToMismatches:function(){return v},parseCigar:function(){return g}});var r=n(96234),a=n(46840),i=n(32723),o=n(41361),s=n(81073),u=n(54685),c=(0,i.Z)().mark(b),l=new RegExp(/(\d+|\^[a-z]+|[a-z])/gi),d=new RegExp(/([A-Z])([-+])([^,.?]+)([.?])?/),f=new RegExp(/([MIDNSHPX=])/),p=new RegExp(/(\d+)[SH]$/),h=new RegExp(/^(\d+)([SH])/);function g(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split(f).slice(0,-1)}function m(e,t,n,r){for(var a=0,i=0,o=[],s=n&&t,u=0;u<e.length;u+=2){var c=+e[u],l=e[u+1];if("M"===l||"="===l||"E"===l){if(s)for(var d=0;d<c;d++)t[i+d].toUpperCase()!==n[a+d].toUpperCase()&&o.push({start:a+d,type:"mismatch",base:t[i+d],altbase:n[a+d],length:1});i+=c}if("I"===l)o.push({start:a,type:"insertion",base:"".concat(c),length:0}),i+=c;else if("D"===l)o.push({start:a,type:"deletion",base:"*",length:c});else if("N"===l)o.push({start:a,type:"skip",base:"N",length:c});else if("X"===l){for(var f=(null===t||void 0===t?void 0:t.slice(i,i+c))||[],p=(null===r||void 0===r?void 0:r.slice(i,i+c))||[],h=0;h<c;h++)o.push({start:a+h,type:"mismatch",base:f[h],qual:p[h],length:1});i+=c}else"H"===l?o.push({start:a,type:"hardclip",base:"H".concat(c),cliplen:c,length:1}):"S"===l&&(o.push({start:a,type:"softclip",base:"S".concat(c),cliplen:c,length:1}),i+=c);"I"!==l&&"S"!==l&&"H"!==l&&(a+=c)}return o}function v(e,t,n,r,a){var i={start:0,base:"",length:0,type:"mismatch"},s=0,u=0,c=0,d=0,f=[],p=n.filter((function(e){return"skip"===e.type}));function h(e){for(var n=u,r=c,a=s;a<t.length&&r<=e;s=a+=2){var i=+t[a],o=t[a+1];"S"===o||"I"===o?n+=i:"D"===o||"P"===o||"N"===o?r+=i:"H"!==o&&(n+=i,r+=i)}return u=n,c=r,n-(r-e)}var g,m=e.match(l)||[],v=(0,o.Z)(m);try{for(v.s();!(g=v.n()).done;){var y=g.value,b=+y;if(Number.isNaN(b))if(y.startsWith("^"))i.start+=y.length-1;else for(var w=0;w<y.length;w+=1){for(i.length=1;d<p.length;){var x=p[d];if(!(i.start>=x.start))break;i.start+=x.length,d++}var k=h(i.start);i.base=r[k]||"X",i.qual=null===a||void 0===a?void 0:a[k],i.altbase=y,f.push(i),i={start:i.start+i.length,length:0,base:"",type:"mismatch"}}else i.start+=b}}catch(Z){v.e(Z)}finally{v.f()}return f}function y(e,t,n,r,a){var i=[],o=g(e);return e&&(i=i.concat(m(o,n,r,a))),t&&n&&(i=i.concat(v(t,o,i,n,a))),i}function b(e,t){var n,r,a,o,s,u,l,d;return(0,i.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:n=0,r=0,a=0,o=0;case 4:if(!(o<e.length&&a<t.length)){i.next=31;break}if(s=+e[o],"S"!==(u=e[o+1])&&"I"!==u){i.next=12;break}for(l=0;l<s&&a<t.length;l++)t[a]===n+l&&a++;n+=s,i.next=28;break;case 12:if("D"!==u&&"N"!==u){i.next=16;break}r+=s,i.next=28;break;case 16:if("M"!==u&&"X"!==u&&"="!==u){i.next=28;break}d=0;case 18:if(!(d<s&&a<t.length)){i.next=26;break}if(t[a]!==n+d){i.next=23;break}return i.next=22,r+d;case 22:a++;case 23:d++,i.next=18;break;case 26:n+=s,r+=s;case 28:o+=2,i.next=4;break;case 31:case"end":return i.stop()}}),c)}function w(e){var t,n=(0,u.TN)(e,"ML","Ml")||[];return n?("string"===typeof n?n.split(",").map((function(e){return+e})):n).map((function(e){return e/255})):null===(t=(0,u.TN)(e,"MP","Mp"))||void 0===t?void 0:t.split("").map((function(e){return e.charCodeAt(0)-33})).map((function(e){return Math.min(1,e/50)}))}function x(e){var t=e.get("start"),n=e.get("end"),r=e.get("strand"),a=n-t,i=(0,u.TN)(e,"MM","Mm")||"",s=new Array(a),c=new Array(a),l=e.get("seq");if(l){var d,f=g(e.get("CIGAR")),p=w(e),h=k(i,l,r),m=0,v=(0,o.Z)(h);try{for(v.s();!(d=v.n()).done;){var y=d.value,x=y.type,Z=y.positions;if("m"===x){var C,S=(0,o.Z)(b(f,Z));try{for(S.s();!(C=S.n()).done;){var T=C.value,P=(null===p||void 0===p?void 0:p[m])||0;m++,T>=0&&T<a&&(s[T]=1,c[T]=P)}}catch(M){S.e(M)}finally{S.f()}}}}catch(M){v.e(M)}finally{v.f()}}return{methBins:s,methProbs:c}}function k(e,t,n){var i,u=-1===n?(0,s.revcom)(t):t,c=e.split(";").filter((function(e){return!!e})),l=[],f=(0,o.Z)(c);try{for(f.s();!(i=f.n()).done;){var p=i.value.split(","),h=(0,a.Z)(p),g=h[0],m=h.slice(1),v=g.match(d);if(!v)throw new Error("bad format for MM tag");var y=(0,r.Z)(v,4),b=y[1],w=y[2],x=y[3].split(/(\d+|.)/).filter((function(e){return!!e}));"-"===w&&(console.warn("unsupported negative strand modifications"),l.push({type:"unsupported",positions:[]}));var k,Z=(0,o.Z)(x);try{for(Z.s();!(k=Z.n()).done;){var C,S=k.value,T=0,P=[],M=(0,o.Z)(m);try{for(M.s();!(C=M.n()).done;){var R=+C.value;do{"N"!==b&&b!==u[T]||R--,T++}while(R>=0&&T<u.length);var A=T-1;P.push(-1===n?u.length-1-A:A)}}catch(I){M.e(I)}finally{M.f()}-1===n&&P.sort((function(e,t){return e-t})),l.push({type:S,positions:P})}}catch(I){Z.e(I)}finally{Z.f()}}}catch(I){f.e(I)}finally{f.f()}return l}function Z(e){return e.split(";").filter((function(e){return!!e})).flatMap((function(t){var n=t.split(","),a=(0,r.Z)(n,1)[0].match(d);if(!a)throw new Error("bad format for MM tag: ".concat(e));return a[3].split(/(\d+|.)/).filter((function(e){return!!e}))}))}function C(e,t){if(e){for(var n=[],r=0;r<t.length;r+=2){var a=t[r],i=t[r+1];"D"===i?i="I":"I"===i&&(i="D"),n.push(a,i)}return n}return t}function S(e,t){var n=g(t);return m(e?C(e,n):n)}function T(e){for(var t=g(e),n=0,r=0;r<t.length;r+=2){var a=+t[r],i=t[r+1];"H"!==i&&"S"!==i&&"I"!==i&&(n+=a)}return n}function P(e){for(var t=g(e),n=0,r=0;r<t.length;r+=2){var a=+t[r],i=t[r+1];"D"!==i&&"N"!==i&&(n+=a)}return n}function M(e){for(var t=g(e),n=0,r=0;r<t.length;r+=2){var a=+t[r],i=t[r+1];"H"!==i&&"S"!==i&&"D"!==i&&"N"!==i&&(n+=a)}return n}function R(e,t){return-1===t?+(e.match(p)||[])[1]||0:+(e.match(h)||[])[1]||0}function A(e,t){var n=e.get("tags");return n?n[t]:e.get(t)}function I(e,t,n,a,i){return(null===e||void 0===e?void 0:e.split(";").filter((function(e){return!!e})).map((function(e,o){var s=e.split(","),u=(0,r.Z)(s,4),c=u[0],l=u[1],d=u[2],f=u[3],p=T(f),h=P(f),g=M(f),m="-"===d?-1:1,v=R(f,(i?n:1)*m),y=+l-1;return{refName:c,start:y,end:y+p,seqLength:h,clipPos:v,CIGAR:f,strand:(i?n:1)*m,uniqueId:"".concat(t,"_SA").concat(o),mate:{start:v,end:v+g,refName:a}}})))||[]}},9065:function(e,t,n){"use strict";n.d(t,{tr:function(){return _},P1:function(){return Ft},ZP:function(){return Vt},Ct:function(){return bt}});var r=n(9249),a=n(87371),i=n(45754),o=n(13820),s=n(49767),u=n(93029),c=n(9077);var l=(0,c.ConfigurationSchema)("CramAdapter",{fetchSizeLimit:{type:"number",description:"size in bytes over which to display a warning to the user that too much data will be fetched",defaultValue:3e6},cramLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.cram",locationType:"UriLocation"}},craiLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.cram.crai",locationType:"UriLocation"}},sequenceAdapter:{type:"frozen",description:"sequence data adapter",defaultValue:null}},{explicitlyTyped:!0}),d=function(e){e.addAdapterType((function(){return new u.Z({name:"CramAdapter",displayName:"CRAM adapter",configSchema:l,getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2821),n.e(5097),n.e(6254),n.e(8625),n.e(8534)]).then(n.bind(n,87829)).then((function(e){return e.default}))}})}))},f=n(40909);var p=(0,c.ConfigurationSchema)("BamAdapter",{bamLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bam",locationType:"UriLocation"}},index:(0,c.ConfigurationSchema)("BamIndex",{indexType:{model:f.types.enumeration("IndexType",["BAI","CSI"]),type:"stringEnum",defaultValue:"BAI"},location:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bam.bai",locationType:"UriLocation"}}}),fetchSizeLimit:{type:"number",description:"size to fetch in bytes over which to display a warning to the user that too much data will be fetched",defaultValue:5e6},sequenceAdapter:{type:"frozen",description:"sequence data adapter, used to calculate SNPs when BAM reads lacking MD tags",defaultValue:null}},{explicitlyTyped:!0}),h=function(e){e.addAdapterType((function(){return new u.Z({name:"BamAdapter",displayName:"BAM adapter",configSchema:p,getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(2821),n.e(7431),n.e(6824)]).then(n.bind(n,16824)).then((function(e){return e.default}))}})}))};var g=(0,c.ConfigurationSchema)("HtsgetBamAdapter",{htsgetBase:{type:"string",description:"the base URL to fetch from",defaultValue:""},htsgetTrackId:{type:"string",description:"the trackId, which is appended to the base URL",defaultValue:""},sequenceAdapter:{type:"frozen",description:"sequence data adapter, used to calculate SNPs when BAM reads lacking MD tags",defaultValue:null}},{explicitlyTyped:!0}),m=function(e){e.addAdapterType((function(){return new u.Z({name:"HtsgetBamAdapter",displayName:"Htsget BAM adapter",adapterMetadata:{hiddenFromGUI:!0},configSchema:g,getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(2821),n.e(7431),n.e(4794)]).then(n.bind(n,64794)).then((function(e){return e.default}))}})}))};var v=(0,c.ConfigurationSchema)("SNPCoverageAdapter",{subadapter:{type:"frozen",defaultValue:null}},{explicitlyTyped:!0});function y(e){e.addAdapterType((function(){return new u.Z({name:"SNPCoverageAdapter",displayName:"SNPCoverage adapter",adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:function(){return n.e(7576).then(n.bind(n,7576)).then((function(e){return e.default}))},configSchema:v})}))}var b=(0,c.ConfigurationSchema)("SNPCoverageRenderer",{clipColor:{type:"color",description:"the color of the clipping marker",defaultValue:"red"},indicatorThreshold:{type:"number",description:"the proportion of reads containing a insertion/clip indicator",defaultValue:.4},drawArcs:{type:"boolean",description:"Draw sashimi-style arcs for intron features",defaultValue:!0},drawInterbaseCounts:{type:"boolean",description:'draw count "upsidedown histogram" of the interbase events that don\'t contribute to the coverage count so are not drawn in the normal histogram',defaultValue:!0},drawIndicators:{type:"boolean",description:"draw a triangular indicator where an event has been detected",defaultValue:!0},color:{type:"color",description:"Background color for the SNPCoverage renderer",defaultValue:"#d3d3d3"}},{explicitlyTyped:!0}),w=n(32723),x=n(41361),k=n(68079),Z=n(33028),C=n(96234),S=n(34795),T=n(59767),P=n(81073),M=n(39727),R=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,a.Z)(n,[{key:"draw",value:function(){var e=(0,S.Z)((0,w.Z)().mark((function e(t,n){var r,a,i,o,s,u,l,d,f,p,h,g,m,v,y,b,S,R,A,I,L,N,F,j,D,B,E,V,z,O,W,H,G,q,_,U,J,X,Y,Q,K,$,ee,te,ne,re,ae,ie,oe,se,ue,ce,le,de,fe,pe,he,ge,me,ve,ye,be,we,xe,ke,Ze,Ce,Se,Te,Pe,Me,Re,Ae,Ie,Le,Ne,Fe,je,De,Be,Ee,Ve,ze,Oe,We,He,Ge,qe,_e,Ue,Je;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.features,a=n.regions,i=n.bpPerPx,o=n.displayCrossHatches,s=n.modificationTagMap,u=void 0===s?{}:s,l=n.scaleOpts,d=n.height,f=n.theme,p=n.config,h=n.ticks,g=(0,T.createJBrowseTheme)(f),m=(0,C.Z)(a,1),v=m[0],y=(v.end-v.start)/i,b=M.Rv,S=d-2*b,l.domain){e.next=9;break}return e.abrupt("return");case 9:R=(0,Z.Z)((0,Z.Z)({},l),{},{range:[0,S]}),A=(0,M.yZ)(R),I=(0,M.yZ)((0,Z.Z)((0,Z.Z)({},R),{},{range:[0,S/2],scaleType:"linear"})),L=(0,M.P$)(l.scaleType),N=(0,M.P$)("linear"),F=(0,c.readConfObject)(p,"indicatorThreshold"),j=(0,c.readConfObject)(p,"drawInterbaseCounts"),D=(0,c.readConfObject)(p,"drawArcs"),B=(0,c.readConfObject)(p,"drawIndicators"),E=function(e){return S-(A(e)||0)+b},V=function(e){return E(L)-E(e)},z=function(e){return S-(I(e)||0)+b},O=function(e){return z(N)-z(e)},W=g.palette.bases,H={A:W.A.main,C:W.C.main,G:W.G.main,T:W.T.main,insertion:"purple",softclip:"blue",hardclip:"red",total:(0,c.readConfObject)(p,"color"),meth:"red",unmeth:"blue"},G=(0,k.Z)(r.values()),q=G.filter((function(e){return"skip"!==e.get("type")})),_=G.filter((function(e){return"skip"===e.get("type")})),t.fillStyle=H.total,U=(0,x.Z)(q);try{for(U.s();!(J=U.n()).done;)X=J.value,Y=(0,P.featureSpanPx)(X,v,i),Q=(0,C.Z)(Y,2),K=Q[0],$=Q[1],ee=$-K+.6,te=X.get("score"),t.fillRect(K,E(te),ee,V(te))}catch(w){U.e(w)}finally{U.f()}ne=0,re=v.reversed?1/i:0,ae=(0,x.Z)(q);try{for(ae.s();!(ie=ae.n()).done;){oe=ie.value,se=(0,P.featureSpanPx)(oe,v,i),ue=(0,C.Z)(se,2),ce=ue[0],le=ue[1],de=oe.get("score"),fe=oe.get("snpinfo"),pe=Math.max(le-ce,1),he=fe.total,ge=Object.keys(fe.cov).sort(),me=0,ve=(0,x.Z)(ge);try{for(ve.s();!(ye=ve.n()).done;)be=ye.value,we=fe.cov[be].total,t.fillStyle=H[be]||u[be.replace("mod_","")]||"black",xe=V(de),ke=E(de)+xe,t.fillRect(Math.round(ce),ke-(we+me)/de*xe,pe,we/de*xe),me+=we}catch(w){ve.e(w)}finally{ve.f()}if(Ze=Object.keys(fe.noncov),4.5,j){Ce=0,Se=(0,x.Z)(Ze);try{for(Se.s();!(Te=Se.n()).done;)Pe=Te.value,Me=fe.noncov[Pe].total,.6,t.fillStyle=H[Pe],t.fillRect(ce-.6+re,4.5+O(Ce),1.2,O(Me)),Ce+=Me}catch(w){Se.e(w)}finally{Se.f()}}if(B){Re=0,Ae=0,Ie="",Le=(0,x.Z)(Ze);try{for(Le.s();!(Ne=Le.n()).done;)Fe=Ne.value,je=fe.noncov[Fe].total,Re+=je,je>Ae&&(Ae=je,Ie=Fe)}catch(w){Le.e(w)}finally{Le.f()}De=Math.max(he,ne),Re>De*F&&De>7&&(t.fillStyle=H[Ie],t.beginPath(),Be=ce+re,t.moveTo(Be-3.5,0),t.lineTo(Be+3.5,0),t.lineTo(Be,4.5),t.fill())}ne=he}}catch(w){ae.e(w)}finally{ae.f()}if(D){Ee=(0,x.Z)(_);try{for(Ee.s();!(Ve=Ee.n()).done;)ze=Ve.value,Oe=(0,P.bpSpanPx)(ze.get("start"),ze.get("end"),v,i),We=(0,C.Z)(Oe,2),He=We[0],Ge=We[1],t.beginPath(),qe=ze.get("strand"),_e=ze.get("xs"),Ue="rgba(255,200,200,0.7)",Je="rgba(200,200,255,0.7)","rgba(200,200,200,0.7)",t.strokeStyle="+"===_e?Ue:"-"===_e?Je:1===qe?Ue:-1===qe?Je:"rgba(200,200,200,0.7)",t.lineWidth=Math.log(ze.get("score")+1),t.moveTo(He,S-2*b),t.bezierCurveTo(He,0,Ge,0,Ge,S-2*b),t.stroke()}catch(w){Ee.e(w)}finally{Ee.f()}}o&&(t.lineWidth=1,t.strokeStyle="rgba(140,140,140,0.8)",h.values.forEach((function(e){t.beginPath(),t.moveTo(0,Math.round(E(e))),t.lineTo(y,Math.round(E(e))),t.stroke()})));case 36:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(M.Aq);function A(e){e.addRendererType((function(){return new R({name:"SNPCoverageRenderer",ReactComponent:M.Eh,configSchema:b,pluginManager:e})}))}var I=n(93069),L=n(95058),N=n(21339),F=n(3011),j=n(59264),D=n.n(j),B=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(e){var a;return(0,r.Z)(this,n),(a=t.call(this,e)).sortedBy=void 0,a.filterBy=void 0,a.showSoftClip=!1,a.cachedLayout=void 0,a.config=e.config,a}return(0,a.Z)(n,[{key:"cachedLayoutIsValid",value:function(e){return(0,I.Z)((0,L.Z)(n.prototype),"cachedLayoutIsValid",this).call(this,e)&&this.showSoftClip===e.showSoftClip&&D()(this.sortedBy,e.sortedBy)&&D()(this.filterBy,e.filterBy)}},{key:"layout",get:function(){return this.cachedLayout&&this.cachedLayoutIsValid(this.cachedLayout)||(this.cachedLayout={layout:this.makeLayout(),config:(0,c.readConfObject)(this.config),filters:this.filters,filterBy:this.filterBy,sortedBy:this.sortedBy,showSoftClip:this.showSoftClip}),this.cachedLayout.layout}}]),n}(N.LayoutSession),E=n(54685);function V(e){var t=e.layout,n=e.features,r=e.sortedBy,a=e.config,i=e.bpPerPx,o=e.showSoftClip,s=e.regions,u=(0,C.Z)(s,1)[0];if(!t)throw new Error("layout required");if(!t.addRect)throw new Error("invalid layout object");var l=null!==r&&void 0!==r&&r.type&&u.start===r.pos?function(e,t){var n=Array.from(e.values()),r=[],a=[],i=t.pos,o=t.type;n.forEach((function(e){var t=e,n=t.get("start"),o=t.get("end");(0,P.doesIntersect2)(i-1,i,n,o)?r.push(e):a.push(e)}));var s=!!n.length&&n[0].get("tags");switch(o){case"Start location":r.sort((function(e,t){return e.get("start")-t.get("start")}));break;case"tag":var u=t.tag,c=function(e,t){return s?e.get("tags")[t]:e.get(t)};r[0]&&"string"===typeof c(r[0],u)?r.sort((function(e,t){return c(t,u).localeCompare(c(e,u))})):r.sort((function(e,t){return(c(t,u)||0)-(c(e,u)||0)}));break;case"Base pair":var l=[];r.forEach((function(e){e.get("mismatches").forEach((function(t){var n=e.get("start")+t.start+1,r="insertion"===t.type||"softclip"===t.type?0:t.length;i>=n&&i<n+r&&l.push([e.id(),t])}))}));var d=new Map(l);r.sort((function(e,t){var n=d.get(e.id()),r=d.get(t.id()),a=null===r||void 0===r?void 0:r.base.toUpperCase(),i=null===n||void 0===n?void 0:n.base.toUpperCase();return a===i&&"*"===a?n.length-r.length:(a?a.charCodeAt(0):0)-(i?i.charCodeAt(0):0)}));break;case"Read strand":r.sort((function(e,t){return e.get("strand")<=t.get("strand")?1:-1}))}return new Map([].concat(r,a).map((function(e){return[e.id(),e]})))}(n,r):n,d=(0,c.readConfObject)(a,"height"),f=(0,c.readConfObject)(a,"displayMode");return(0,P.iterMap)(l.values(),(function(e){return function(e){var t=e.feature,n=e.layout,r=e.bpPerPx,a=e.region,i=e.showSoftClip,o=e.heightPx,s=e.displayMode,u=0,c=0;if(i){var l=t.get("mismatches");if(t.get("seq")){var d,f=(0,x.Z)(l);try{for(f.s();!(d=f.n()).done;){var p=d.value,h=p.type,g=p.start,m=p.cliplen,v=void 0===m?0:m;"softclip"===h&&(0===g?u=v:c=v)}}catch(S){f.e(S)}finally{f.f()}}}var y=(0,P.bpSpanPx)(t.get("start")-u,t.get("end")+c,a,r),b=(0,C.Z)(y,2),w=b[0],k=b[1];if("compact"===s&&(o/=3),t.get("refName")!==a.refName)throw new Error("feature ".concat(t.id()," is not on the current region's reference sequence ").concat(a.refName));var Z=n.addRect(t.id(),t.get("start")-u,t.get("end")+c,o,t);return null===Z?null:{feature:t,leftPx:w,rightPx:k,topPx:"collapse"===s?0:Z,heightPx:o}}({feature:e,layout:t,bpPerPx:i,region:u,showSoftClip:o,heightPx:d,displayMode:f})}),l.size)}function z(e,t,n,r,a,i,o){t+r<0||t>i||(o&&(e.fillStyle=o),e.fillRect(t,n,r,a))}function O(e){var t=e.palette.bases;return{A:t.A.main,C:t.C.main,G:t.G.main,T:t.T.main,deletion:"#808080"}}function W(){return{charWidth:(0,P.measureText)("A"),charHeight:(0,P.measureText)("M")-2}}var H=n(58203);function G(e,t){return H.If[function(e,t){var n=(0,c.readConfObject)(t,"orientationType");return{LR:"color_pair_lr",RR:"color_pair_rr",RL:"color_pair_rl",LL:"color_pair_ll"}[E.uD[n][e.get("pair_orientation")]]}(e,t)||"color_nostrand"]}function q(e){var t=e.colorType,n=e.tag,r=e.feature,a=e.config,i=e.defaultColor,o=e.colorTagMap;switch(t){case"insertSize":return function(e){return e.get("is_paired")&&e.get("refName")!==e.get("next_ref")?"#555":"hsl(".concat(Math.abs(e.get("template_length"))/10,",50%,50%)")}(r);case"strand":return function(e){return-1===e.get("strand")?"#8F8FD8":"#EC8B8B"}(r);case"mappingQuality":return function(e){return"hsl(".concat(e.get("score"),",50%,50%)")}(r);case"pairOrientation":return G(r,a);case"stranded":return function(e){return H.If[function(e){var t=e.get("flags"),n=e.get("strand");if(1&t){var r=64&t?-1:1;return 2&t?n*r===1?"color_rev_strand":"color_fwd_strand":8&t?n*r===1?"color_rev_missing_mate":"color_fwd_missing_mate":e.get("refName")===e.get("next_ref")?n*r===1?"color_rev_strand_not_proper":"color_fwd_strand_not_proper":1===n?"color_fwd_diff_chr":"color_rev_diff_chr"}return"color_unknown"}(e)]}(r);case"xs":case"tag":var s=r.get("tags"),u=s?s[n]:r.get(n);return"XS"===n||"TS"===n?H.If[{"-":"color_rev_strand","+":"color_fwd_strand"}[u]||"color_nostrand"]:"ts"===n?H.If[{"-":-1===r.get("strand")?"color_fwd_strand":"color_rev_strand","+":-1===r.get("strand")?"color_rev_strand":"color_fwd_strand"}[u]||"color_nostrand"]:o[u]||H.If.color_nostrand;case"insertSizeAndPairOrientation":break;case"modifications":case"methylation":return 16&r.get("flags")?"#c8dcc8":"#c8c8c8";default:return i?"lightgrey":(0,c.readConfObject)(a,"color",{feature:r})}}var _=n(46079);var U=n(10346);function J(e){var t=e.ctx,n=e.feat,r=e.renderArgs,a=e.colorForBase,i=e.contrastForBase,o=e.charWidth,s=e.charHeight,u=e.defaultColor,c=e.canvasWidth,l=r.config,d=r.bpPerPx,f=r.regions,p=r.colorBy,h=r.colorTagMap,g=void 0===h?{}:h,m=p||{},v=m.tag,y=void 0===v?"":v,b=m.type,w=void 0===b?"":b,k=n.feature,Z=f[0];switch(t.fillStyle=q({feature:k,config:l,tag:y,defaultColor:u,colorType:w,colorTagMap:g}),function(e){var t=e.ctx,n=e.feat,r=e.renderArgs,a=r.regions,i=r.bpPerPx,o=n.heightPx,s=n.topPx,u=n.feature,c=(0,C.Z)(a,1)[0],l=u.get("start"),d=u.get("end"),f=(0,P.bpSpanPx)(l,d,c,i),p=(0,C.Z)(f,2),h=p[0],g=p[1],m=c.reversed?-1:1,v=u.get("strand")*m;i<10&&o>5?-1===v?(t.beginPath(),t.moveTo(h-5,s+o/2),t.lineTo(h,s+o),t.lineTo(g,s+o),t.lineTo(g,s),t.lineTo(h,s),t.closePath(),t.fill()):(t.beginPath(),t.moveTo(h,s),t.lineTo(h,s+o),t.lineTo(g,s+o),t.lineTo(g+5,s+o/2),t.lineTo(g,s),t.closePath(),t.fill()):t.fillRect(h,s,g-h,o)}({ctx:t,feat:n,renderArgs:r}),w){case"perBaseQuality":!function(e){for(var t=e.ctx,n=e.feat,r=e.region,a=e.bpPerPx,i=e.canvasWidth,o=n.feature,s=n.topPx,u=n.heightPx,c=(o.get("qual")||"").split(" ").map((function(e){return+e})),l=(0,_.parseCigar)(o.get("CIGAR")),d=1/a,f=o.get("start"),p=0,h=0,g=0;g<l.length;g+=2){var m=+l[g],v=l[g+1];if("S"===v||"I"===v)p+=m;else if("D"===v||"N"===v)h+=m;else if("M"===v||"X"===v||"="===v){for(var y=0;y<m;y++){var b=c[p+y],w=f+h+y;z(t,(0,P.bpSpanPx)(w,w+1,r,a)[0],s,d+.5,u,i,"hsl(".concat(255===b?150:1.5*b,",55%,50%)"))}p+=m,h+=m}}}({ctx:t,feat:n,region:Z,bpPerPx:d,canvasWidth:c});break;case"perBaseLettering":!function(e){var t=e.ctx,n=e.feat,r=e.region,a=e.bpPerPx,i=e.colorForBase,o=e.contrastForBase,s=e.charWidth,u=e.charHeight,c=e.canvasWidth,l=u-2,d=n.feature,f=n.topPx,p=n.heightPx,h=d.get("seq"),g=(0,_.parseCigar)(d.get("CIGAR")),m=1/a,v=d.get("start"),y=0,b=0;if(h)for(var w=0;w<g.length;w+=2){var x=+g[w],k=g[w+1];if("S"===k||"I"===k)y+=x;else if("D"===k||"N"===k)b+=x;else if("M"===k||"X"===k||"="===k){for(var Z=0;Z<x;Z++){var S=h[y+Z],T=v+b+Z,M=(0,P.bpSpanPx)(T,T+1,r,a),R=(0,C.Z)(M,1)[0];z(t,R,f,m+.5,p,c,i[S]),m>=s&&p>=l&&(t.fillStyle=o[S],t.fillText(S,R+(m-s)/2+1,f+p))}y+=x,b+=x}}}({ctx:t,feat:n,region:Z,bpPerPx:d,colorForBase:a,contrastForBase:i,charWidth:o,charHeight:s,canvasWidth:c});break;case"modifications":!function(e){var t=e.ctx,n=e.feat,r=e.region,a=e.bpPerPx,i=e.renderArgs,o=e.canvasWidth,s=n.feature,u=n.topPx,c=n.heightPx,l=i.modificationTagMap,d=void 0===l?{}:l,f=s.get("seq");if(f){var p,h=(0,E.TN)(s,"MM","Mm")||"",g=s.get("CIGAR"),m=s.get("start"),v=s.get("strand"),y=(0,_.parseCigar)(g),b=(0,_.getModificationProbabilities)(s),w=(0,_.getModificationPositions)(h,f,v),k=0,Z=(0,x.Z)(w);try{for(Z.s();!(p=Z.n()).done;){var S,T=p.value,M=T.type,R=T.positions,A=d[M]||"black",I=(0,U.V)(A),L=(0,x.Z)((0,_.getNextRefPos)(y,R));try{for(L.s();!(S=L.n()).done;){var N=m+S.value,F=(0,P.bpSpanPx)(N,N+1,r,a),j=(0,C.Z)(F,2),D=j[0],B=j[1],V=(null===b||void 0===b?void 0:b[k])||0;z(t,D,u,B-D+.5,c,o,1!==V?I.alpha(V+.1).toHslString():A),k++}}catch(O){L.e(O)}finally{L.f()}}}catch(O){Z.e(O)}finally{Z.f()}}}({ctx:t,feat:n,region:Z,bpPerPx:d,renderArgs:r,canvasWidth:c});break;case"methylation":!function(e){var t=e.ctx,n=e.feat,r=e.region,a=e.bpPerPx,i=e.renderArgs,o=e.canvasWidth,s=i.regionSequence,u=n.feature,c=n.topPx,l=n.heightPx;if(!s)throw new Error("region sequence required for methylation");if(u.get("seq"))for(var d=u.get("start"),f=u.get("end"),p=(0,_.getMethBins)(u),h=p.methBins,g=p.methProbs,m=0;m<f-d;m++){var v,y,b=m+d,w=null===(v=s[b-r.start+1])||void 0===v?void 0:v.toLowerCase(),x=null===(y=s[b-r.start+2])||void 0===y?void 0:y.toLowerCase();if("c"===w&&"g"===x)if(a>2){var k=(0,P.bpSpanPx)(b,b+2,r,a),Z=(0,C.Z)(k,2),S=Z[0];z(t,S,c,Z[1]-S+.5,l,o,N(m)||N(m+1)||"blue")}else{var T=(0,P.bpSpanPx)(b,b+1,r,a),M=(0,C.Z)(T,2),R=M[0];z(t,R,c,M[1]-R+.5,l,o,N(m)||"blue");var A=(0,P.bpSpanPx)(b+1,b+2,r,a),I=(0,C.Z)(A,2),L=I[0];z(t,L,c,I[1]-L+.5,l,o,N(m+1)||"blue")}}function N(e){if(h[e]){var t=g[e]||0;return(t>.5?(0,U.V)("red").alpha(2*(t-.5)):(0,U.V)("blue").alpha(1-2*t)).toHslString()}}}({ctx:t,feat:n,region:Z,bpPerPx:d,renderArgs:r,canvasWidth:c})}}function X(e){var t=e.ctx,n=e.feat,r=e.renderArgs,a=e.minSubfeatureWidth,i=e.largeInsertionIndicatorScale,o=e.mismatchAlpha,s=e.charWidth,u=e.charHeight,c=e.colorForBase,l=e.contrastForBase,d=e.canvasWidth,f=e.drawSNPsMuted,p=e.drawIndels,h=void 0===p||p,g=r.bpPerPx,m=r.regions,v=n.heightPx,y=n.topPx,b=n.feature,w=(0,C.Z)(m,1)[0],k=b.get("start"),Z=Math.min(1/g,2),S=b.get("mismatches"),T=u-2,M=w.reversed?1/g+1:-1;if(S){var R,A=(0,x.Z)(S);try{for(A.s();!(R=A.n()).done;){var I=R.value,L=k+I.start,N=I.length,F=I.base,j=(0,P.bpSpanPx)(L,L+N,w,g),D=(0,C.Z)(j,2),B=D[0],E=D[1],V=Math.max(a,Math.abs(B-E));if("mismatch"===I.type){if(!f){var O=c[I.base]||"#888",W=o?void 0===I.qual?O:(0,U.V)(O).alpha(Math.min(1,I.qual/50)).toHslString():O;z(t,Math.round(B),y,V,v,d,W)}if(V>=s&&v>=T){var H=f?"black":l[I.base]||"black";t.fillStyle=o?void 0===I.qual?H:(0,U.V)(H).alpha(Math.min(1,I.qual/50)).toHslString():H,t.fillText(F,B+(V-s)/2+1,y+v)}}else if("deletion"===I.type&&h){z(t,B,y,Math.abs(B-E),v,d,c.deletion);var G="".concat(I.length),q=(0,P.measureText)(G,10);V>=q&&v>=T&&(t.fillStyle=l.deletion,t.fillText(G,(B+E)/2-q/2,y+v))}else if("insertion"===I.type&&h){t.fillStyle="purple";var _=B+M,J=+I.base||I.length,X=Math.max(0,Math.min(1.2,1/g));if(J<10&&(z(t,_,y,X,v,d,"purple"),1/g>=s&&v>=T)){var Y=_-X;z(t,Y,y,3*X,1,d),z(t,Y,y+v-1,3*X,1,d),t.fillText("(".concat(I.base,")"),_+3,y+v)}}else if("hardclip"===I.type||"softclip"===I.type){var Q=B+M,K="hardclip"===I.type?"red":"blue",$=Math.max(a,Z);if(z(t,Q,y,$,v,d,K),1/g>=s&&v>=T){var ee=Q-$;z(t,ee,y,3*$,1,d),z(t,ee,y+v-1,3*$,1,d),t.fillText("(".concat(I.base,")"),Q+3,y+v)}}else if("skip"===I.type&&B+V>0){var te=V-(g>10?1.5:0);t.clearRect(B,y,te,v),z(t,Math.max(0,B),y+v/2-1,te+(B<0?B:0),2,d,"#333")}}}catch(fe){A.e(fe)}finally{A.f()}if(h){var ne,re=(0,x.Z)(S);try{for(re.s();!(ne=re.n()).done;){var ae=ne.value,ie=k+ae.start,oe=ae.length,se=(0,P.bpSpanPx)(ie,ie+oe,w,g),ue=(0,C.Z)(se,1)[0],ce=+ae.base||ae.length,le="".concat(ce);if("insertion"===ae.type&&ce>=10)if(g>i)z(t,ue-1,y,2,v,d,"purple");else if(v>u){var de=(0,P.measureText)(le);z(t,ue-de/2-5,y,de+10,v,d,"purple"),t.fillStyle="white",t.fillText(le,ue-de/2,y+v)}else{z(t,ue-2,y,4,v,d,"purple")}}}catch(fe){re.e(fe)}finally{re.f()}}}}function Y(e){var t=e.ctx,n=e.feat,r=e.renderArgs,a=e.config,i=e.theme,o=e.colorForBase,s=e.canvasWidth,u=n.feature,l=n.topPx,d=n.heightPx,f=r.regions,p=r.bpPerPx,h=(0,C.Z)(f,1)[0],g=(0,c.readConfObject)(a,"minSubfeatureWidth"),m=u.get("mismatches"),v=u.get("seq"),y=W(),b=y.charWidth,w=y.charHeight;if(v&&m){var k,Z=w-2,S=(0,x.Z)(m);try{for(S.s();!(k=S.n()).done;){var T=k.value;if("softclip"===T.type)for(var M=T.cliplen||0,R=u.get("start"),A=0===T.start?R-M:R+T.start,I=0;I<M;I+=1){var L=v.charAt(I+T.start);if(!L)return;var N=A+I,F=(0,P.bpSpanPx)(N,N+1,h,p),j=(0,C.Z)(F,2),D=j[0],B=j[1],E=Math.max(g,B-D),V=o[L]||"#000000";t.fillStyle=V,z(t,D,l,E,d,s),E>=b&&d>=Z&&(t.fillStyle=i.palette.getContrastText(V),t.fillText(L,D+(E-b)/2+1,l+d))}}}catch(O){S.e(O)}finally{S.f()}}}function Q(e){var t=e.ctx,n=e.layoutRecords,r=e.canvasWidth,a=e.renderArgs,i=a.config,o=a.showSoftClip,s=a.colorBy,u=a.theme,l=(0,c.readConfObject)(i,"mismatchAlpha"),d=(0,c.readConfObject)(i,"minSubfeatureWidth"),f=(0,c.readConfObject)(i,"largeInsertionIndicatorScale"),p="#f0f"===(0,c.readConfObject)(i,"color"),h=(0,T.createJBrowseTheme)(u),g=O(h),m=function(e){return Object.fromEntries(Object.entries(O(e)).map((function(t){var n=(0,C.Z)(t,2),r=n[0],a=n[1];return[r,e.palette.getContrastText(a)]})))}(h);t.font="bold 10px Courier New,monospace";var v,y,b=W(),w=b.charWidth,k=b.charHeight,Z=(v=null===s||void 0===s?void 0:s.type,["methylation","modifications"].includes(v||"")),S=(0,x.Z)(n);try{for(S.s();!(y=S.n()).done;){var P=y.value;J({ctx:t,feat:P,renderArgs:a,defaultColor:p,colorForBase:g,contrastForBase:m,charWidth:w,charHeight:k,canvasWidth:r}),X({ctx:t,feat:P,renderArgs:a,mismatchAlpha:l,drawSNPsMuted:Z,drawIndels:true,largeInsertionIndicatorScale:f,minSubfeatureWidth:d,charWidth:w,charHeight:k,colorForBase:g,contrastForBase:m,canvasWidth:r}),o&&Y({ctx:t,feat:P,renderArgs:a,colorForBase:g,config:i,theme:h,canvasWidth:r})}}catch(M){S.e(M)}finally{S.f()}}var K=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).supportsSVG=!0,e}return(0,a.Z)(n,[{key:"fetchSequence",value:function(){var e=(0,S.Z)((0,w.Z)().mark((function e(t){var n,r,a,i,o,s,u,c,l;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sessionId,r=t.regions,a=t.adapterConfig,i=a.sequenceAdapter){e.next=4;break}return e.abrupt("return",void 0);case 4:return o=this.pluginManager,e.next=7,(0,F.uP)(o,n,i);case 7:return s=e.sent,u=s.dataAdapter,c=(0,C.Z)(r,1),l=c[0],e.abrupt("return",(0,E.O)(l,u));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getExpandedRegion",value:function(e,t){var n=t.config,r=t.showSoftClip,a=e.start,i=e.end,o=(0,c.readConfObject)(n,"maxClippingSize"),s=r?Math.round(o):0;return(0,Z.Z)((0,Z.Z)({},e),{},{start:Math.floor(Math.max(a-s,0)),end:Math.ceil(i+s)})}},{key:"render",value:function(){var e=(0,S.Z)((0,w.Z)().mark((function e(t){var r,a,i,o,s,u,c,l,d,f,p,h,g;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getFeatures(t);case 2:if(a=e.sent,i=this.createLayoutInWorker(t),o=t.regions,s=t.bpPerPx,u=(0,C.Z)(o,1),c=u[0],l=V((0,Z.Z)((0,Z.Z)({},t),{},{features:a,layout:i})),!a.size||!(0,E.ES)(null===(r=t.colorBy)||void 0===r?void 0:r.type)){e.next=13;break}return e.next=10,this.fetchSequence(t);case 10:e.t0=e.sent,e.next=14;break;case 13:e.t0=void 0;case 14:return d=e.t0,f=(c.end-c.start)/s,p=Math.max(i.getTotalHeight(),1),e.next=19,(0,P.renderToAbstractCanvas)(f,p,t,(function(e){return Q({ctx:e,layoutRecords:l.filter(P.notEmpty),canvasWidth:f,renderArgs:(0,Z.Z)((0,Z.Z)({},t),{},{layout:i,features:a,regionSequence:d})})}));case 19:return h=e.sent,e.next=22,(0,I.Z)((0,L.Z)(n.prototype),"render",this).call(this,(0,Z.Z)((0,Z.Z)((0,Z.Z)({},t),h),{},{features:a,layout:i,height:p,width:f}));case 22:return g=e.sent,e.abrupt("return",(0,Z.Z)((0,Z.Z)((0,Z.Z)({},g),h),{},{features:new Map,layout:i,height:p,width:f,maxHeightReached:i.maxHeightReached}));case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createSession",value:function(e){return new B(e)}}]),n}(N.default);var $=(0,c.ConfigurationSchema)("PileupRenderer",{color:{type:"color",description:"the color of each feature in a pileup alignment",defaultValue:"#f0f",contextVariable:["feature"]},orientationType:{type:"stringEnum",model:f.types.enumeration("orientationType",["fr","rf","ff"]),defaultValue:"fr",description:'read sequencer orientation. fr is normal "reads pointing at each other ---\x3e <--- while some other sequencers can use other options'},displayMode:{type:"stringEnum",model:f.types.enumeration("displayMode",["normal","compact","collapse"]),description:"Alternative display modes",defaultValue:"normal"},minSubfeatureWidth:{type:"number",description:"the minimum width in px for a pileup mismatch feature. use for increasing/decreasing mismatch marker widths when zoomed out, e.g. 0 or 1",defaultValue:1},maxHeight:{type:"integer",description:"the maximum height to be used in a pileup rendering",defaultValue:1200},maxClippingSize:{type:"integer",description:"the max clip size to be used in a pileup rendering",defaultValue:1e4},height:{type:"number",description:"the height of each feature in a pileup alignment",defaultValue:7,contextVariable:["feature"]},noSpacing:{type:"boolean",description:"remove spacing between features",defaultValue:!1},largeInsertionIndicatorScale:{type:"number",description:"scale at which to draw the large insertion indicators (bp/pixel)",defaultValue:10},mismatchAlpha:{type:"boolean",defaultValue:!1,description:"Fade low quality mismatches"}},{explicitlyTyped:!0}),ee=n(30969),te=n(90550),ne=n(37574),re=(0,te.observer)((function(e){var t,n=e.onMouseMove,r=e.blockKey,a=e.displayModel,i=e.width,o=e.height,s=e.regions,u=e.bpPerPx,c=e.sortedBy,l=e.colorBy,d=e.filterBy,f=a.selectedFeatureId,p=a.featureIdUnderMouse,h=a.contextMenuFeature,g=(0,C.Z)(s,1)[0],m=(0,ee.useRef)(null),v=(0,ee.useState)(!1),y=(0,C.Z)(v,2),b=y[0],w=y[1],x=(0,ee.useState)(!1),k=(0,C.Z)(x,2),S=k[0],M=k[1];function R(e){if(m.current){b&&M(!0);var t=m.current.getBoundingClientRect(),o=e.clientX-t.left,s=e.clientY-t.top,c=g.reversed?i-o:o,l=g.start+u*c;null===n||void 0===n||n(e,a.getFeatureOverlapping(r,l,s))}}function A(t,n){var r=e["onFeature".concat(t)],a=e["on".concat(t)];r&&p?r(n,p):a&&a(n,p)}(0,ee.useEffect)((function(){var e,t,n=m.current;if(n){var i=n.getContext("2d");if(i){i.clearRect(0,0,n.width,n.height);var o=f?null===(e=a.getFeatureByID)||void 0===e?void 0:e.call(a,r,f):void 0;if(o){var s=(0,C.Z)(o,4),c=s[0],l=s[1],d=s[2],v=s[3],y=(0,P.bpSpanPx)(c,d,g,u),b=(0,C.Z)(y,2),w=b[0],x=b[1],k=Math.round(l),Z=Math.round(v-l);i.shadowColor="#222266",i.shadowBlur=10,i.lineJoin="bevel",i.lineWidth=2,i.strokeStyle="#00b8ff",i.strokeRect(w-2,k-2,x-w+4,Z+4),i.clearRect(w,k,x-w,Z)}var S=p||(null===h||void 0===h?void 0:h.id()),T=S?null===(t=a.getFeatureByID)||void 0===t?void 0:t.call(a,r,S):void 0;if(T){var M=(0,C.Z)(T,4),R=M[0],A=M[1],I=M[2],L=M[3],N=(0,P.bpSpanPx)(R,I,g,u),F=(0,C.Z)(N,2),j=F[0],D=F[1],B=Math.round(A),E=Math.round(L-A);i.fillStyle="#0003",i.fillRect(j,B,D-j,E)}}}}),[u,g,r,f,a,p,h]);var I=Math.ceil(i);return(0,ne.jsxs)("div",{"data-testid":"pileup-".concat([null===c||void 0===c?void 0:c.type,null===l||void 0===l?void 0:l.type,null===l||void 0===l?void 0:l.tag,null===d||void 0===d||null===(t=d.tagFilter)||void 0===t?void 0:t.tag].filter((function(e){return!!e})).join("-")),style:{position:"relative",width:I,height:o},children:[(0,ne.jsx)(T.PrerenderedCanvas,(0,Z.Z)((0,Z.Z)({},e),{},{style:{position:"absolute",left:0,top:0}})),(0,ne.jsx)("canvas",{"data-testid":"pileup_overlay_canvas",width:I,height:o+100,style:{position:"absolute",left:0,top:0},className:"highlightOverlayCanvas",ref:m,onMouseDown:function(e){return function(e){w(!0),M(!1),A("MouseDown",e)}(e)},onMouseEnter:function(e){return function(e){A("MouseEnter",e)}(e)},onMouseOut:function(e){return function(e){A("MouseOut",e),A("MouseLeave",e)}(e)},onMouseOver:function(e){return function(e){A("MouseOver",e)}(e)},onMouseUp:function(e){return function(e){w(!1),A("MouseUp",e)}(e)},onMouseLeave:function(e){return function(e){A("MouseOut",e),A("MouseLeave",e)}(e)},onMouseMove:function(e){return R(e)},onClick:function(e){return function(e){S||A("Click",e)}(e)},onContextMenu:function(e){return function(e){A("ContextMenu",e)}(e)},onFocus:function(){},onBlur:function(){}})]})}));function ae(e){e.addRendererType((function(){return new K({name:"PileupRenderer",displayName:"Pileup renderer",ReactComponent:re,configSchema:$,pluginManager:e})}))}var ie=n(81575),oe=n(57211);var se=n(59740),ue=n(90689),ce=n(77479),le=["height"];function de(e){return e.getDisplayElements().filter((function(e){var t;return"LinearAlignmentsDisplay"===(null===(t=e.subDisplay)||void 0===t?void 0:t.type)})).filter((function(e){var t;return null===(t=e.subDisplay)||void 0===t?void 0:t.lowerPanel}))}function fe(e,t){return D()(e?(0,f.getSnapshot)(e):void 0,t?(0,f.getSnapshot)(t):void 0)}function pe(e){var t=e.PileupDisplay,n=e.SNPCoverageDisplay;return t||(0,f.isAlive)(t)||n||(0,f.isAlive)(n)}var he=function(e,t){return f.types.compose("LinearAlignmentsDisplay",ce.BaseDisplay,function(e,t){var n=de(e).map((function(e){return e.stateModel}));return f.types.model({PileupDisplay:f.types.maybe(f.types.union.apply(f.types,(0,k.Z)(n))),SNPCoverageDisplay:f.types.maybe(e.getDisplayType("LinearSNPCoverageDisplay").stateModel),snpCovHeight:45,type:f.types.literal("LinearAlignmentsDisplay"),configuration:(0,c.ConfigurationReference)(t),heightPreConfig:f.types.maybe(f.types.number),userFeatureScreenDensity:f.types.maybe(f.types.number),lowerPanelType:"LinearPileupDisplay"})}(e,t)).volatile((function(){return{scrollTop:0}})).actions((function(e){return{setScrollTop:function(t){e.scrollTop=t},setSNPCoverageHeight:function(t){e.snpCovHeight=t}}})).views((function(e){return{get height(){var t;return null!==(t=e.heightPreConfig)&&void 0!==t?t:(0,c.getConf)(e,"height")},get featureIdUnderMouse(){return e.PileupDisplay.featureIdUnderMouse||e.SNPCoverageDisplay.featureIdUnderMouse}}})).views((function(e){return{get pileupConf(){var t=(0,c.getConf)(e,"pileupDisplay");return(0,Z.Z)((0,Z.Z)({},t),{},{type:e.lowerPanelType,displayId:"".concat(e.configuration.displayId,"_").concat(e.lowerPanelType,"_xyz")})},getFeatureByID:function(t,n){return e.PileupDisplay.getFeatureByID(t,n)},searchFeatureByID:function(t){var n,r;return null===(n=(r=e.PileupDisplay).searchFeatureByID)||void 0===n?void 0:n.call(r,t)},get features(){return e.PileupDisplay.features},get DisplayBlurb(){var t;return null===(t=e.PileupDisplay)||void 0===t?void 0:t.DisplayBlurb},get sortedBy(){return e.PileupDisplay.sortedBy},get coverageConf(){var t=(0,c.getConf)(e,"snpCoverageDisplay");return(0,Z.Z)((0,Z.Z)({},t),{},{displayId:"".concat(e.configuration.displayId,"_snpcoverage_xyz")})}}})).actions((function(e){return{setSNPCoverageDisplay:function(t){e.SNPCoverageDisplay={type:"LinearSNPCoverageDisplay",configuration:t,height:e.snpCovHeight}},setFeatureDensityStatsLimit:function(t){e.PileupDisplay.setFeatureDensityStatsLimit(t),e.SNPCoverageDisplay.setFeatureDensityStatsLimit(t)},setPileupDisplay:function(t){e.PileupDisplay={type:t.type||"LinearPileupDisplay",configuration:t}},setHeight:function(t){return e.heightPreConfig=Math.max(t,20),e.heightPreConfig},setLowerPanelType:function(t){e.lowerPanelType=t},resizeHeight:function(t){var n=e.height;return this.setHeight(e.height+t)-n}}})).actions((function(e){return{afterAttach:function(){(0,f.addDisposer)(e,(0,ue.autorun)((function(){var t=e.SNPCoverageDisplay,n=e.PileupDisplay,r=e.coverageConf,a=e.pileupConf;t?D()(r,(0,f.getSnapshot)(t.configuration))||(t.setHeight(e.snpCovHeight),t.setConfig(e.coverageConf)):e.setSNPCoverageDisplay(r),n&&e.lowerPanelType===n.type?D()(a,(0,f.getSnapshot)(n.configuration))||n.setConfig(e.pileupConf):e.setPileupDisplay(a),function(e){var t=e.PileupDisplay,n=e.SNPCoverageDisplay;pe(e)&&t.colorBy&&(fe(t.colorBy,n.colorBy)||n.setColorBy((0,f.getSnapshot)(t.colorBy)))}(e),function(e){var t=e.PileupDisplay,n=e.SNPCoverageDisplay;pe(e)&&t.filterBy&&(fe(t.filterBy,n.filterBy)||n.setFilterBy((0,f.getSnapshot)(t.filterBy)))}(e)}))),(0,f.addDisposer)(e,(0,ue.autorun)((function(){e.setSNPCoverageHeight(e.SNPCoverageDisplay.height)}))),(0,f.addDisposer)(e,(0,ue.autorun)((function(){e.PileupDisplay.setHeight(e.height-e.SNPCoverageDisplay.height)})))},renderSvg:function(t){return(0,S.Z)((0,w.Z)().mark((function n(){var r;return(0,w.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.height-e.SNPCoverageDisplay.height,n.next=3,(0,ue.when)((function(){return!e.PileupDisplay.renderProps().notReady&&!e.SNPCoverageDisplay.renderProps().notReady}));case 3:return n.t0=ne.jsxs,n.t1=ne.Fragment,n.t2=ne.jsx,n.next=8,e.SNPCoverageDisplay.renderSvg(t);case 8:return n.t3=n.sent,n.t4={children:n.t3},n.t5=(0,n.t2)("g",n.t4),n.t6=ne.jsx,n.t7="translate(0 ".concat(e.SNPCoverageDisplay.height,")"),n.next=15,e.PileupDisplay.renderSvg((0,Z.Z)((0,Z.Z)({},t),{},{overrideHeight:r}));case 15:return n.t8=n.sent,n.t9={transform:n.t7,children:n.t8},n.t10=(0,n.t6)("g",n.t9),n.t11=[n.t5,n.t10],n.t12={children:n.t11},n.abrupt("return",(0,n.t0)(n.t1,n.t12));case 21:case"end":return n.stop()}}),n)})))()}}})).views((function(t){var n=t.trackMenuItems;return{trackMenuItems:function(){if(!t.PileupDisplay)return[];var r=de(e).map((function(e){return{type:"radio",label:e.displayName,checked:e.name===t.PileupDisplay.type,onClick:function(){return t.setLowerPanelType(e.name)}}}));return[].concat((0,k.Z)(n()),[{type:"subMenu",label:"Pileup settings",subMenu:t.PileupDisplay.trackMenuItems()},{type:"subMenu",label:"SNPCoverage settings",subMenu:t.SNPCoverageDisplay.trackMenuItems()},{type:"subMenu",label:"Replace lower panel with...",subMenu:r}])}}})).preProcessSnapshot((function(e){if(!e)return e;var t=e.height,n=(0,se.Z)(e,le);return(0,Z.Z)({heightPreConfig:t},n)}))},ge=n(53276),me=(0,ge.ZL)()({resizeHandle:{height:5,position:"absolute",zIndex:2}}),ve=(0,te.observer)((function(e){var t,n=e.model,r=n.PileupDisplay,a=n.SNPCoverageDisplay,i=me().classes;if(!a)return null;var o=null!==(t=a.height)&&void 0!==t?t:100;return(0,ne.jsxs)("div",{"data-testid":"display-".concat((0,c.getConf)(n,"displayId")),style:{position:"relative"},children:[(0,ne.jsx)("div",{"data-testid":"Blockset-snpcoverage",children:(0,ne.jsx)(a.RenderingComponent,{model:a})}),(0,ne.jsx)(T.ResizeHandle,{onDrag:function(e){return a.setHeight(a.height+e),e},className:i.resizeHandle,style:{top:o-4}}),(0,ne.jsx)("div",{"data-testid":"Blockset-pileup",style:{position:"absolute",top:o},children:(0,ne.jsx)(r.RenderingComponent,{model:r})})]})})),ye=ve;function be(e){e.addDisplayType((function(){var t,n=(t=e,(0,c.ConfigurationSchema)("LinearAlignmentsDisplay",{pileupDisplay:t.getDisplayType("LinearPileupDisplay").configSchema,snpCoverageDisplay:t.getDisplayType("LinearSNPCoverageDisplay").configSchema,height:{type:"number",defaultValue:250}},{baseConfiguration:oe.fU,explicitlyTyped:!0}));return new ie.Z({name:"LinearAlignmentsDisplay",displayName:"Alignments display (combination)",configSchema:n,stateModel:he(e,n),trackType:"AlignmentsTrack",viewType:"LinearGenomeView",ReactComponent:ye})}))}var we=n(37386),xe=["refbase","all","total","ref","-1","1","0"],ke=function(e){return e.toLocaleString("en-US")},Ze=function(e,t){return"".concat(function(){return+(+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)).toFixed(1)}(e/(t||1)*100),"%")},Ce=ee.forwardRef((function(e,t){var n=e.feature,r=n.get("start"),a=n.get("end"),i=n.get("refName"),o=n.get("snpinfo"),s=o.refbase,u=o.all,c=(o.total,o.ref),l=o[-1],d=o[1],f=(o[0],(0,se.Z)(o,xe)),p=[i,r===a?ke(r):"".concat(ke(r),"..").concat(ke(a))].filter((function(e){return!!e})).join(":");return(0,ne.jsx)("div",{ref:t,children:(0,ne.jsxs)("table",{children:[(0,ne.jsx)("caption",{children:p}),(0,ne.jsx)("thead",{children:(0,ne.jsxs)("tr",{children:[(0,ne.jsx)("th",{children:"Base"}),(0,ne.jsx)("th",{children:"Count"}),(0,ne.jsx)("th",{children:"% of Total"}),(0,ne.jsx)("th",{children:"Strands"}),(0,ne.jsx)("th",{children:"Source"})]})}),(0,ne.jsxs)("tbody",{children:[(0,ne.jsxs)("tr",{children:[(0,ne.jsx)("td",{children:"Total"}),(0,ne.jsx)("td",{children:u})]}),(0,ne.jsxs)("tr",{children:[(0,ne.jsxs)("td",{children:["REF ",s?"(".concat(s.toUpperCase(),")"):""]}),(0,ne.jsx)("td",{children:c}),(0,ne.jsx)("td",{children:Ze(c,u)}),(0,ne.jsxs)("td",{children:[l?"".concat(l,"(-)"):"",d?"".concat(d,"(+)"):""]}),(0,ne.jsx)("td",{})]}),Object.entries(f).map((function(e){var t=(0,C.Z)(e,2),n=t[0],r=t[1];return Object.entries(r).map((function(e){var t=(0,C.Z)(e,2),r=t[0],a=t[1];return(0,ne.jsxs)("tr",{children:[(0,ne.jsx)("td",{children:r.toUpperCase()}),(0,ne.jsx)("td",{children:a.total}),(0,ne.jsx)("td",{children:"total"===r||"skip"===r?"---":Ze(a.total,u)}),(0,ne.jsxs)("td",{children:[a[-1]?"".concat(a[-1],"(-)"):"",a[1]?"".concat(a[1],"(+)"):""]}),(0,ne.jsx)("td",{children:n})]},r)}))}))]})]})})})),Se=(0,te.observer)((function(e){var t=e.model.featureUnderMouse;return t&&"skip"===t.get("type")?null:(0,ne.jsx)(M.u,(0,Z.Z)({TooltipContents:Ce},e))})),Te=n(97891);function Pe(e,t,n,r){return Me.apply(this,arguments)}function Me(){return(Me=(0,S.Z)((0,w.Z)().mark((function e(t,n,r,a){var i,o,s,u,c;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,P.getSession)(t),o=i.rpcManager,s=t.adapterConfig,u=(0,Te.getRpcSessionId)(t),e.next=5,o.call((0,Te.getRpcSessionId)(t),"PileupGetGlobalValueForTag",(0,Z.Z)({adapterConfig:s,tag:n.tag,sessionId:u,regions:r.contentBlocks},a));case 5:return c=e.sent,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Re(e,t,n,r,a){return Ae.apply(this,arguments)}function Ae(){return(Ae=(0,S.Z)((0,w.Z)().mark((function e(t,n,r,a,i){var o,s,u,c;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,P.getSession)(t),s=o.rpcManager,u=(0,Te.getRpcSessionId)(t),e.next=4,s.call(u,"PileupGetVisibleModifications",(0,Z.Z)({adapterConfig:n,tag:r.tag,sessionId:u,regions:a.contentBlocks},i));case 4:return c=e.sent,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ie=f.types.model({flagInclude:f.types.optional(f.types.number,0),flagExclude:f.types.optional(f.types.number,1540),readName:f.types.maybe(f.types.string),tagFilter:f.types.maybe(f.types.model({tag:f.types.string,value:f.types.string}))}),Le=new Map([["snpcoverage","SNPCoverageRenderer"]]);var Ne=function(e,t){return f.types.compose("LinearSNPCoverageDisplay",(0,M.LT)(e,t),f.types.model({type:f.types.literal("LinearSNPCoverageDisplay"),drawInterbaseCounts:f.types.maybe(f.types.boolean),drawIndicators:f.types.maybe(f.types.boolean),drawArcs:f.types.maybe(f.types.boolean),filterBy:f.types.optional(Ie,{}),colorBy:f.types.maybe(f.types.model({type:f.types.string,tag:f.types.maybe(f.types.string)})),jexlFilters:f.types.optional(f.types.array(f.types.string),[])})).volatile((function(){return{modificationTagMap:ue.observable.map({}),modificationsReady:!1}})).actions((function(e){return{setConfig:function(t){e.configuration=t},setFilterBy:function(t){e.filterBy=(0,f.cast)(t)},setColorBy:function(t){e.colorBy=(0,f.cast)(t)},setJexlFilters:function(t){e.jexlFilters=(0,f.cast)(t)},updateModificationColorMap:function(t){t.forEach((function(t){e.modificationTagMap.has(t)||e.modificationTagMap.set(t,E.b4[t]||(0,E.p)())}))}}})).views((function(e){var t=e.renderProps;return{get rendererConfig(){var t,n,r,a=(0,c.getConf)(e,["renderers",e.rendererTypeName])||{};return e.rendererType.configSchema.create((0,Z.Z)((0,Z.Z)({},a),{},{drawInterbaseCounts:null!==(t=e.drawInterbaseCounts)&&void 0!==t?t:a.drawInterbaseCounts,drawIndicators:null!==(n=e.drawIndicators)&&void 0!==n?n:a.drawIndicators,drawArcs:null!==(r=e.drawArcs)&&void 0!==r?r:a.drawArcs}),(0,f.getEnv)(e))},get drawArcsSetting(){var t;return null!==(t=e.drawArcs)&&void 0!==t?t:(0,c.readConfObject)(this.rendererConfig,"drawArcs")},get drawInterbaseCountsSetting(){var t;return null!==(t=e.drawInterbaseCounts)&&void 0!==t?t:(0,c.readConfObject)(this.rendererConfig,"drawInterbaseCounts")},get drawIndicatorsSetting(){var t;return null!==(t=e.drawIndicators)&&void 0!==t?t:(0,c.readConfObject)(this.rendererConfig,"drawIndicators")},get autorunReady(){return(0,P.getContainingView)(e).initialized&&e.featureDensityStatsReady&&!e.regionTooLarge&&!e.error},get renderReady(){return!t().notReady&&e.modificationsReady},get ready(){return this.renderReady},renderProps:function(){var n=t(),r=e.colorBy,a=e.filterBy,i=e.modificationTagMap;return(0,Z.Z)((0,Z.Z)({},n),{},{notReady:!this.ready,filters:e.filters,modificationTagMap:Object.fromEntries(i.toJSON()),colorBy:r?(0,f.getSnapshot)(r):void 0,filterBy:a?(0,f.getSnapshot)(a):void 0})}}})).actions((function(e){return{setModificationsReady:function(t){e.modificationsReady=t},toggleDrawIndicators:function(){e.drawIndicators=!e.drawIndicatorsSetting},toggleDrawInterbaseCounts:function(){e.drawInterbaseCounts=!e.drawInterbaseCountsSetting},toggleDrawArcs:function(){e.drawArcs=!e.drawArcsSetting}}})).actions((function(e){return{afterAttach:function(){(0,E.$X)(e,(0,S.Z)((0,w.Z)().mark((function t(){var n,r,a,i,o;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.setModificationsReady(!1),e.autorunReady){t.next=3;break}return t.abrupt("return");case 3:if(n=(0,P.getContainingView)(e),r=n.staticBlocks,"modifications"!==(null===(a=e.colorBy)||void 0===a?void 0:a.type)){t.next=14;break}return i=(0,c.getConf)(e.parentTrack,"adapter"),t.next=10,Re(e,i,a,r);case 10:o=t.sent,(0,f.isAlive)(e)&&(e.updateModificationColorMap(o),e.setModificationsReady(!0)),t.next=15;break;case 14:e.setModificationsReady(!0);case 15:case"end":return t.stop()}}),t)}))),{delay:1e3})}}})).views((function(e){var t=e.trackMenuItems;return{get TooltipComponent(){return Se},get adapterConfig(){return{type:"SNPCoverageAdapter",subadapter:(0,c.getConf)(e.parentTrack,"adapter")}},get rendererTypeName(){return Le.get("snpcoverage")},get needsScalebar(){return!0},contextMenuItems:function(){return[]},trackMenuItems:function(){return[].concat((0,k.Z)(t()),[{label:"Draw insertion/clipping indicators",type:"checkbox",checked:e.drawIndicatorsSetting,onClick:function(){return e.toggleDrawIndicators()}},{label:"Draw insertion/clipping counts",type:"checkbox",checked:e.drawInterbaseCountsSetting,onClick:function(){return e.toggleDrawInterbaseCounts()}},{label:"Draw arcs",type:"checkbox",checked:e.drawArcsSetting,onClick:function(){return e.toggleDrawArcs()}}])},get filters(){return new we.Z({filters:e.jexlFilters})}}}))};function Fe(e){e.addDisplayType((function(){var t=function(e){return(0,c.ConfigurationSchema)("LinearSNPCoverageDisplay",{autoscale:{type:"stringEnum",defaultValue:"local",model:f.types.enumeration("Autoscale type",["local"]),description:"performs local autoscaling (no other options for SNP Coverage available)"},minScore:{type:"number",defaultValue:Number.MIN_VALUE,description:"minimum value for the y-scale"},maxScore:{type:"number",description:"maximum value for the y-scale",defaultValue:Number.MAX_VALUE},scaleType:{type:"stringEnum",model:f.types.enumeration("Scale type",["linear","log"]),description:"The type of scale to use",defaultValue:"linear"},inverted:{type:"boolean",description:"draw upside down",defaultValue:!1},multiTicks:{type:"boolean",description:"Display multiple values for the ticks",defaultValue:!1},renderers:(0,c.ConfigurationSchema)("RenderersConfiguration",{SNPCoverageRenderer:e.getRendererType("SNPCoverageRenderer").configSchema})},{baseConfiguration:oe.fU,explicitlyTyped:!0})}(e);return new ie.Z({name:"LinearSNPCoverageDisplay",displayName:"SNPCoverage display",configSchema:t,stateModel:Ne(e,t),trackType:"AlignmentsTrack",viewType:"LinearGenomeView",ReactComponent:M.Xl})}))}var je=(0,ge.ZL)()((function(e){var t=e.palette.action.disabledBackground;return{loading:{backgroundColor:e.palette.background.default,backgroundImage:"repeating-linear-gradient(45deg, transparent, transparent 5px, ".concat(t," 5px, ").concat(t," 10px)"),position:"absolute",bottom:0,height:50,width:300,right:0,pointerEvents:"none",textAlign:"center"}}})),De=(0,te.observer)((function(e){var t=e.model,n=e.children,r=t.error,a=t.regionTooLarge;return r?(0,ne.jsx)(oe.rK,{message:"".concat(r),severity:"error",buttonText:"Reload",action:t.reload}):a?t.regionCannotBeRendered():(0,ne.jsx)(Be,{model:t,children:n})})),Be=(0,te.observer)((function(e){var t=e.model,n=e.children,r=t.drawn,a=t.loading,i=(0,P.getContainingView)(t),o=(t.lastDrawnOffsetPx||0)-i.offsetPx;return(0,ne.jsxs)("div",{"data-testid":"drawn-".concat(r),children:[(0,ne.jsx)("div",{style:{position:"absolute",left:o},children:n}),0!==o||a?(0,ne.jsx)(Ee,{model:t}):null]})})),Ee=(0,te.observer)((function(e){var t=e.model,n=je().classes,r=t.message;return(0,ne.jsx)("div",{className:n.loading,children:(0,ne.jsx)(T.LoadingEllipses,{message:r})})})),Ve=De,ze=(0,te.observer)((function(e){var t=e.model,n=(0,P.getContainingView)(t),r=Math.round(n.dynamicBlocks.totalWidthPx),a=t.height,i=(0,ee.useCallback)((function(e){t.setRef(e)}),[t,r,a]);return(0,ne.jsx)("canvas",{"data-testid":"arc-canvas",ref:i,style:{width:r,height:a,position:"absolute"},width:2*r,height:2*a})})),Oe=(0,te.observer)((function(e){var t=e.model;return(0,ne.jsx)(Ve,{model:t,children:(0,ne.jsx)(ze,{model:t})})})),We=Oe;var He=function(e){return(0,c.ConfigurationSchema)("LinearReadArcsDisplay",{maxFeatureScreenDensity:{type:"number",description:"maximum features per pixel that is displayed in the view",defaultValue:5},lineWidth:{type:"number",description:"set arc line width",defaultValue:1},jitter:{type:"number",description:"jitters the x position so e.g. if many reads map to exact same x position, jittering makes it easy to see that there are many of them",defaultValue:0},colorScheme:{type:"stringEnum",model:f.types.enumeration("colorScheme",["strand","normal","insertSize","insertSizeAndOrientation","mappingQuality","tag"]),description:"color scheme to use",defaultValue:"normal"}},{baseConfiguration:(0,oe.RH)(e),explicitlyTyped:!0})},Ge=n(99069),qe=n(94502),_e=n(44971),Ue=(0,ee.lazy)((function(){return n.e(7478).then(n.bind(n,7478))}));var Je=function(e){return f.types.compose("LinearReadArcsDisplay",Ge.BaseDisplay,(0,oe.eW)(),(0,oe.Ek)(),f.types.model({type:f.types.literal("LinearReadArcsDisplay"),configuration:(0,c.ConfigurationReference)(e),filterBy:f.types.optional(Ie,{}),lineWidth:f.types.maybe(f.types.number),jitter:f.types.maybe(f.types.number),colorBy:f.types.maybe(f.types.model({type:f.types.string,tag:f.types.maybe(f.types.string),extra:f.types.frozen()})),drawInter:!0,drawLongRange:!0})).volatile((function(){return{loading:!1,chainData:void 0,lastDrawnOffsetPx:void 0,lastDrawnBpPerPx:0,ref:null}})).actions((function(e){return{setLastDrawnOffsetPx:function(t){e.lastDrawnOffsetPx=t},setLastDrawnBpPerPx:function(t){e.lastDrawnBpPerPx=t},setLoading:function(t){e.loading=t},reload:function(){e.error=void 0},setRef:function(t){e.ref=t},setColorScheme:function(t){e.colorBy=(0,f.cast)(t)},setChainData:function(t){e.chainData=t},setDrawInter:function(t){e.drawInter=t},setDrawLongRange:function(t){e.drawLongRange=t},setFilterBy:function(t){e.filterBy=(0,f.cast)(t)},setLineWidth:function(t){e.lineWidth=t},setJitter:function(t){e.jitter=t}}})).views((function(e){return{get drawn(){return void 0!==e.lastDrawnOffsetPx},get lineWidthSetting(){var t;return null!==(t=e.lineWidth)&&void 0!==t?t:(0,c.getConf)(e,"lineWidth")},get jitterVal(){var t;return null!==(t=e.jitter)&&void 0!==t?t:(0,c.getConf)(e,"jitter")}}})).views((function(e){var t=e.trackMenuItems,n=e.renderProps;return{renderProps:function(){return(0,Z.Z)((0,Z.Z)({},n()),{},{notReady:!e.chainData})},trackMenuItems:function(){return[].concat((0,k.Z)(t()),[{label:"Filter by",icon:_e.Z,onClick:function(){(0,P.getSession)(e).queueDialog((function(t){return[Ue,{model:e,handleClose:t}]}))}},{label:"Line width",subMenu:[{label:"Thin",onClick:function(){return e.setLineWidth(1)}},{label:"Bold",onClick:function(){return e.setLineWidth(2)}},{label:"Extra bold",onClick:function(){return e.setLineWidth(5)}}]},{label:"Jitter x-positions",subMenu:[{type:"checkbox",checked:0===e.jitterVal,label:"None",onClick:function(){return e.setJitter(0)}},{type:"checkbox",checked:2===e.jitterVal,label:"Small",onClick:function(){return e.setJitter(2)}},{type:"checkbox",checked:10===e.jitterVal,label:"Large",onClick:function(){return e.setJitter(10)}}]},{label:"Draw inter-region vertical lines",type:"checkbox",checked:e.drawInter,onClick:function(){return e.setDrawInter(!e.drawInter)}},{label:"Draw long range connections",type:"checkbox",checked:e.drawLongRange,onClick:function(){return e.setDrawLongRange(!e.drawLongRange)}},{label:"Color scheme",icon:qe.Z,subMenu:[{label:"Insert size \xb1 3\u03c3 and orientation",onClick:function(){return e.setColorScheme({type:"insertSizeAndOrientation"})}},{label:"Insert size \xb1 3\u03c3",onClick:function(){return e.setColorScheme({type:"insertSize"})}},{label:"Orientation",onClick:function(){return e.setColorScheme({type:"orientation"})}},{label:"Insert size gradient",onClick:function(){return e.setColorScheme({type:"gradient"})}}]}])}}})).views((function(e){return{renderSvg:function(t){return(0,S.Z)((0,w.Z)().mark((function r(){var a,i,o,s;return(0,w.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.e(2710).then(n.bind(n,12710));case 2:return a=r.sent,i=a.renderSvg,r.next=6,n.e(2508).then(n.bind(n,92508));case 6:return o=r.sent,s=o.drawFeats,r.abrupt("return",i(e,t,s));case 9:case"end":return r.stop()}}),r)})))()}}})).actions((function(e){return{afterAttach:function(){(0,S.Z)((0,w.Z)().mark((function t(){var r,a,i,o;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.e(2936).then(n.bind(n,22936));case 3:return r=t.sent,a=r.doAfterAttach,t.next=7,n.e(2508).then(n.bind(n,92508));case 7:i=t.sent,o=i.drawFeats,a(e,o),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),console.error(t.t0),e.setError(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,12]])})))()}}}))};function Xe(e){e.addDisplayType((function(){var t=He(e);return new ie.Z({name:"LinearReadArcsDisplay",displayName:"Arc display",configSchema:t,stateModel:Je(t),trackType:"AlignmentsTrack",viewType:"LinearGenomeView",subDisplay:{type:"LinearAlignmentsDisplay",lowerPanel:!0},ReactComponent:We})}))}var Ye=(0,te.observer)((function(e){var t=e.model,n=(0,P.getContainingView)(t),r=Math.round(n.dynamicBlocks.totalWidthPx),a=t.height,i=(0,ee.useCallback)((function(e){return t.setRef(e)}),[t,r,a]);return(0,ne.jsx)("canvas",{"data-testid":"cloud-canvas",ref:i,style:{width:r,height:a,position:"absolute"},width:2*r,height:2*a})})),Qe=(0,te.observer)((function(e){var t=e.model;return(0,ne.jsx)(Ve,{model:t,children:(0,ne.jsx)(Ye,{model:t})})})),Ke=Qe;var $e=function(e){return(0,c.ConfigurationSchema)("LinearReadCloudDisplay",{maxFeatureScreenDensity:{type:"number",description:"maximum features per pixel that is displayed in the view",defaultValue:5},featureHeight:{type:"number",defaultValue:7},colorScheme:{type:"stringEnum",model:f.types.enumeration("colorScheme",["strand","normal","insertSize","insertSizeAndOrientation","mappingQuality","tag"]),description:"color scheme to use",defaultValue:"normal"}},{baseConfiguration:(0,oe.RH)(e),explicitlyTyped:!0})},et=(0,ee.lazy)((function(){return n.e(7478).then(n.bind(n,7478))}));var tt=function(e){return f.types.compose("LinearReadCloudDisplay",Ge.BaseDisplay,(0,oe.eW)(),(0,oe.Ek)(),f.types.model({type:f.types.literal("LinearReadCloudDisplay"),configuration:(0,c.ConfigurationReference)(e),filterBy:f.types.optional(Ie,{}),colorBy:f.types.maybe(f.types.model({type:f.types.string,tag:f.types.maybe(f.types.string),extra:f.types.frozen()})),drawSingletons:!0})).volatile((function(){return{loading:!1,chainData:void 0,lastDrawnOffsetPx:void 0,lastDrawnBpPerPx:0,ref:null}})).actions((function(e){return{setDrawSingletons:function(t){e.drawSingletons=t},setLastDrawnOffsetPx:function(t){e.lastDrawnOffsetPx=t},setLastDrawnBpPerPx:function(t){e.lastDrawnBpPerPx=t},setLoading:function(t){e.loading=t},reload:function(){e.error=void 0},setRef:function(t){e.ref=t},setColorScheme:function(t){e.colorBy=(0,f.cast)(t)},setChainData:function(t){e.chainData=t},setFilterBy:function(t){e.filterBy=(0,f.cast)(t)}}})).views((function(e){return{get drawn(){return void 0!==e.lastDrawnOffsetPx}}})).views((function(e){var t=e.trackMenuItems,r=e.renderProps;return{renderProps:function(){return(0,Z.Z)((0,Z.Z)({},r()),{},{notReady:!e.chainData})},trackMenuItems:function(){return[].concat((0,k.Z)(t()),[{label:"Draw singletons",type:"checkbox",checked:e.drawSingletons,onClick:function(){return e.setDrawSingletons(!e.drawSingletons)}},{label:"Filter by",icon:_e.Z,onClick:function(){(0,P.getSession)(e).queueDialog((function(t){return[et,{model:e,handleClose:t}]}))}},{label:"Color scheme",icon:qe.Z,subMenu:[{label:"Insert size \xb1 3\u03c3 and orientation",onClick:function(){return e.setColorScheme({type:"insertSizeAndOrientation"})}},{label:"Insert size \xb1 3\u03c3",onClick:function(){return e.setColorScheme({type:"insertSize"})}},{label:"Orientation",onClick:function(){return e.setColorScheme({type:"orientation"})}},{label:"Insert size gradient",onClick:function(){return e.setColorScheme({type:"gradient"})}}]}])},renderSvg:function(t){return(0,S.Z)((0,w.Z)().mark((function r(){var a,i,o,s;return(0,w.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.e(2710).then(n.bind(n,12710));case 2:return a=r.sent,i=a.renderSvg,r.next=6,n.e(8550).then(n.bind(n,18550));case 6:return o=r.sent,s=o.drawFeats,r.abrupt("return",i(e,t,s));case 9:case"end":return r.stop()}}),r)})))()}}})).actions((function(e){return{afterAttach:function(){(0,S.Z)((0,w.Z)().mark((function t(){var r,a,i,o;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.e(2936).then(n.bind(n,22936));case 3:return r=t.sent,a=r.doAfterAttach,t.next=7,n.e(8550).then(n.bind(n,18550));case 7:i=t.sent,o=i.drawFeats,a(e,o),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),console.error(t.t0),e.setError(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,12]])})))()}}}))};function nt(e){e.addDisplayType((function(){var t=$e(e);return new ie.Z({name:"LinearReadCloudDisplay",displayName:"Read cloud display",configSchema:t,stateModel:tt(t),trackType:"AlignmentsTrack",viewType:"LinearGenomeView",subDisplay:{type:"LinearAlignmentsDisplay",lowerPanel:!0},ReactComponent:Ke})}))}var rt=n(82044);function at(e){e.addTrackType((function(){var t,n=(t=e,(0,c.ConfigurationSchema)("AlignmentsTrack",{},{baseConfiguration:(0,Ge.createBaseTrackConfig)(t)})),r=new rt.Z({name:"AlignmentsTrack",displayName:"Alignments track",configSchema:n,stateModel:(0,ce.createBaseTrackModel)(e,"AlignmentsTrack",n)}),a=e.getDisplayType("LinearAlignmentsDisplay");return r.addDisplayType(a),r}))}var it=n(66737),ot=n(81986),st=(0,c.ConfigurationSchema)("AlignmentsFeatureWidget",{});function ut(e){var t=(0,ot.e$)(e);return f.types.compose(t,f.types.model("AlignmentsFeatureWidget",{type:f.types.literal("AlignmentsFeatureWidget")}))}function ct(e){e.addWidgetType((function(){return new it.Z({name:"AlignmentsFeatureWidget",heading:"Feature details",configSchema:st,stateModel:ut(e),ReactComponent:(0,ee.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(1356),n.e(2942),n.e(7567)]).then(n.bind(n,93734))}))})}))}var lt=n(95915),dt=n(81450);function ft(e){var t=e.map((function(e){return Math.abs(e.tlen)})),n=t.reduce((function(e,t){return e+t}),0),r=t.map((function(e){return e*e})).reduce((function(e,t){return e+t}),0),a=t.length,i=n/a,o=Math.sqrt((a*r-n*n)/(a*a));return{upper:i+4*o,lower:i-3*o,avg:i,sd:o}}var pt=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,a.Z)(n,[{key:"serializeArguments",value:function(){var e=(0,S.Z)((0,w.Z)().mark((function e(t,r){var a,i,o,s;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.pluginManager.rootModel,o=null===i||void 0===i||null===(a=i.session)||void 0===a?void 0:a.assemblyManager){e.next=4;break}throw new Error("no assembly manager available");case 4:return e.next=6,(0,P.renameRegionsIfNeeded)(o,t);case 6:return s=e.sent,e.abrupt("return",(0,I.Z)((0,L.Z)(n.prototype),"serializeArguments",this).call(this,s,r));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(n(85550).Z),ht=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="PileupGetReducedFeatures",e}return(0,a.Z)(n,[{key:"execute",value:function(){var e=(0,S.Z)((0,w.Z)().mark((function e(t,n){var r,a,i,o,s,u,c,l,d,f;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.deserializeArguments(t,n);case 2:return r=e.sent,a=r.adapterConfig,i=r.sessionId,o=r.regions,e.next=6,(0,F.uP)(this.pluginManager,i,a);case 6:return s=e.sent.dataAdapter,e.next=9,(0,dt.z)(s.getFeaturesInMultipleRegions(o,r).pipe((0,lt.q)()));case 9:return u=e.sent,c=(0,P.dedupe)(u.map((function(e){return{id:e.id(),refName:e.get("refName"),name:e.get("name"),start:e.get("start"),strand:e.get("strand"),end:e.get("end"),flags:e.get("flags"),tlen:e.get("template_length"),pair_orientation:e.get("pair_orientation"),next_ref:e.get("next_ref"),next_pos:e.get("next_pos"),clipPos:e.get("clipPos"),SA:(0,E.h1)(e,"SA")}})),(function(e){return e.id})),l=c.filter((function(e){return 2&e.flags&&!(256&e.flags)&&!(2048&e.flags)})),d=l.length?ft(l):void 0,f=(0,P.groupBy)(c,(function(e){return e.name})),e.abrupt("return",{chains:Object.values(f),stats:d,hasPaired:!!d,containsNoTransferables:!0});case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(pt),gt=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="PileupGetVisibleModifications",e}return(0,a.Z)(n,[{key:"execute",value:function(){var e=(0,S.Z)((0,w.Z)().mark((function e(t,n){var r,a,i,o,s,u,c;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.deserializeArguments(t,n);case 2:return r=e.sent,a=r.adapterConfig,i=r.sessionId,o=r.regions,e.next=8,(0,F.uP)(this.pluginManager,i,a);case 8:return s=e.sent.dataAdapter,e.next=11,(0,dt.z)(s.getFeaturesInMultipleRegions(o).pipe((0,lt.q)()));case 11:return u=e.sent,c=new Set,u.forEach((function(e){(0,_.getModificationTypes)((0,E.TN)(e,"MM","Mm")||"").forEach((function(e){return c.add(e)}))})),e.abrupt("return",(0,k.Z)(c));case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(pt),mt=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="PileupGetGlobalValueForTag",e}return(0,a.Z)(n,[{key:"execute",value:function(){var e=(0,S.Z)((0,w.Z)().mark((function e(t,n){var r,a,i,o,s,u,c,l;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.deserializeArguments(t,n);case 2:return r=e.sent,a=r.adapterConfig,i=r.sessionId,o=r.regions,s=r.tag,e.next=9,(0,F.uP)(this.pluginManager,i,a);case 9:return u=e.sent.dataAdapter,c=u.getFeaturesInMultipleRegions(o),e.next=13,(0,dt.z)(c.pipe((0,lt.q)()));case 13:return l=e.sent,e.abrupt("return",(0,k.Z)(new Set(l.map((function(e){return(0,E.h1)(e,s)})).filter((function(e){return void 0!==e})).map((function(e){return"".concat(e)})))));case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(pt),vt=function(e){e.addRpcMethod((function(){return new mt(e)})),e.addRpcMethod((function(){return new gt(e)})),e.addRpcMethod((function(){return new ht(e)}))},yt=function(e){e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="CramAdapter",i=(0,Te.getFileName)(t),o={type:a,cramLocation:t,craiLocation:n||(0,Te.makeIndex)(t,".crai")};return/\.cram$/i.test(i)&&!r||r===a?o:e(t,n,r)}})),e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="BamAdapter",i=(0,Te.getFileName)(t),o=n&&(0,Te.getFileName)(n),s={type:a,bamLocation:t,index:{location:n||(0,Te.makeIndex)(t,".bai"),indexType:(0,Te.makeIndexType)(o,"CSI","BAI")}};return/\.bam$/i.test(i)&&!r||r===a?s:e(t,n,r)}})),e.addToExtensionPoint("Core-guessTrackTypeForLocation",(function(e){return function(t){return"BamAdapter"===t||"CramAdapter"===t?"AlignmentsTrack":e(t)}}))};var bt=function(e){return(0,c.ConfigurationSchema)("LinearPileupDisplay",{defaultRendering:{type:"stringEnum",model:f.types.enumeration("Rendering",["pileup"]),defaultValue:"pileup"},renderers:(0,c.ConfigurationSchema)("RenderersConfiguration",{PileupRenderer:e.getRendererType("PileupRenderer").configSchema}),maxFeatureScreenDensity:{type:"number",description:"maximum features per pixel that is displayed in the view",defaultValue:5},colorScheme:{type:"stringEnum",model:f.types.enumeration("colorScheme",["strand","normal","insertSize","insertSizeAndOrientation","mappingQuality","tag"]),description:"color scheme to use",defaultValue:"normal"}},{baseConfiguration:(0,oe.RH)(e),explicitlyTyped:!0})},wt=n(41174),xt=n(79769),kt=n(34760),Zt=n.n(kt),Ct=n(22417),St=n(56521),Tt=n(33359),Pt=(0,te.observer)((function(e){var t,n=e.model.sortedBy;return n?(0,ne.jsx)("div",{"data-testid":"blurb-".concat(n),children:(0,ne.jsx)(Tt.Z,{color:"secondary",variant:"caption",children:n?"Sorted by ".concat(null!==(t=n.tag)&&void 0!==t?t:n.type," at ").concat(n.refName,":").concat(n.pos):null})}):null})),Mt=["uniqueId"],Rt=(0,ee.lazy)((function(){return n.e(7478).then(n.bind(n,7478))})),At=(0,ee.lazy)((function(){return n.e(6319).then(n.bind(n,96319))})),It=(0,ee.lazy)((function(){return n.e(7281).then(n.bind(n,97281))})),Lt=(0,ee.lazy)((function(){return n.e(3576).then(n.bind(n,93576))})),Nt=new Map([["pileup","PileupRenderer"],["svg","SvgFeatureRenderer"]]);function Ft(e){return f.types.compose(oe.fV,f.types.model({configuration:(0,c.ConfigurationReference)(e),featureHeight:f.types.maybe(f.types.number),noSpacing:f.types.maybe(f.types.boolean),fadeLikelihood:f.types.maybe(f.types.boolean),trackMaxHeight:f.types.maybe(f.types.number),colorBy:H.zi,filterBy:f.types.optional(Ie,{}),jexlFilters:f.types.optional(f.types.array(f.types.string),[])})).volatile((function(){return{colorTagMap:ue.observable.map({}),featureUnderMouseVolatile:void 0,tagsReady:!1}})).views((function(e){return{get autorunReady(){return(0,P.getContainingView)(e).initialized&&e.featureDensityStatsReady&&!e.regionTooLarge}}})).actions((function(e){return{setTagsReady:function(t){e.tagsReady=t},setMaxHeight:function(t){e.trackMaxHeight=t},setFeatureHeight:function(t){e.featureHeight=t},setNoSpacing:function(t){e.noSpacing=t},setColorScheme:function(t){e.colorTagMap=ue.observable.map({}),e.colorBy=(0,f.cast)(t),t.tag&&(e.tagsReady=!1)},updateColorTagMap:function(t){var n=["#BBCCEE","pink","#CCDDAA","#EEEEBB","#FFCCCC","lightblue","lightgreen","tan","#CCEEFF","lightsalmon"];t.forEach((function(t){if(!e.colorTagMap.has(t)){var r=(0,k.Z)(e.colorTagMap.keys()).length;e.colorTagMap.set(t,n[r])}}))},setFeatureUnderMouse:function(t){e.featureUnderMouseVolatile=t},selectFeature:function(t){var n=(0,P.getSession)(e);if((0,P.isSessionModelWithWidgets)(n)){var r=n.addWidget("AlignmentsFeatureWidget","alignmentFeature",{featureData:t.toJSON(),view:(0,P.getContainingView)(e)});n.showWidget(r)}n.setSelection(t)},copyFeatureToClipboard:function(t){var n=t.toJSON(),r=(n.uniqueId,(0,se.Z)(n,Mt)),a=(0,P.getSession)(e);Zt()(JSON.stringify(r,null,4)),a.notify("Copied to clipboard","success")},setConfig:function(t){e.configuration=t},setFilterBy:function(t){e.filterBy=(0,f.cast)(t)},setJexlFilters:function(t){e.jexlFilters=(0,f.cast)(t)}}})).views((function(e){return{get rendererConfig(){var t=e.featureHeight,n=e.noSpacing,r=e.trackMaxHeight,a=e.rendererTypeName,i=(0,c.getConf)(e,["renderers",a])||{};return e.rendererType.configSchema.create((0,Z.Z)((0,Z.Z)((0,Z.Z)((0,Z.Z)({},i),void 0!==t?{height:t}:{}),void 0!==n?{noSpacing:n}:{}),void 0!==r?{maxHeight:r}:{}),(0,P.getEnv)(e))}}})).views((function(e){return{get maxHeight(){return(0,c.readConfObject)(e.rendererConfig,"maxHeight")},get featureHeightSetting(){return(0,c.readConfObject)(e.rendererConfig,"height")},get featureUnderMouse(){return e.featureUnderMouseVolatile},renderReady:function(){return e.tagsReady},get filters(){return new we.Z({filters:e.jexlFilters})}}})).views((function(e){var t=e.trackMenuItems,n=e.renderProps;return{get rendererTypeName(){var t=(0,c.getConf)(e,"defaultRendering"),n=Nt.get(t);if(!n)throw new Error("unknown alignments view name ".concat(t));return n},contextMenuItems:function(){var t=e.contextMenuFeature;return t?[{label:"Open feature details",icon:St.Z,onClick:function(){e.clearFeatureSelection(),t&&e.selectFeature(t)}},{label:"Copy info to clipboard",icon:Ct.pt,onClick:function(){t&&e.copyFeatureToClipboard(t)}}]:[]},get DisplayBlurb(){return Pt},renderPropsPre:function(){var t=e.colorTagMap,r=e.colorBy,a=e.filterBy,i=e.rpcDriverName,o=n();return(0,Z.Z)((0,Z.Z)({},o),{},{notReady:o.notReady||!e.renderReady(),rpcDriverName:i,displayModel:e,colorBy:r?(0,f.getSnapshot)(r):void 0,filterBy:JSON.parse(JSON.stringify(a)),filters:e.filters,colorTagMap:Object.fromEntries(t.toJSON()),config:e.rendererConfig,onFeatureClick:function(t,n){return(0,S.Z)((0,w.Z)().mark((function t(){var r,a,i,o,s,u;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=(0,P.getSession)(e),a=r.rpcManager,t.prev=2,i=n||e.featureIdUnderMouse){t.next=8;break}e.clearFeatureSelection(),t.next=14;break;case 8:return o=(0,Te.getRpcSessionId)(e),t.next=11,a.call(o,"CoreGetFeatureDetails",{featureId:i,sessionId:o,layoutId:(0,P.getContainingView)(e).id,rendererType:"PileupRenderer"});case 11:s=t.sent,(u=s.feature)&&e.selectFeature(new P.SimpleFeature(u));case 14:t.next=20;break;case 16:t.prev=16,t.t0=t.catch(2),console.error(t.t0),r.notify("".concat(t.t0));case 20:case"end":return t.stop()}}),t,null,[[2,16]])})))()},onClick:function(){e.clearFeatureSelection()},onFeatureContextMenu:function(t,n){return(0,S.Z)((0,w.Z)().mark((function t(){var r,a,i,o,s,u;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=(0,P.getSession)(e),a=r.rpcManager,t.prev=2,i=n||e.featureIdUnderMouse){t.next=8;break}e.clearFeatureSelection(),t.next=14;break;case 8:return o=(0,Te.getRpcSessionId)(e),t.next=11,a.call(o,"CoreGetFeatureDetails",{featureId:i,sessionId:o,layoutId:(0,P.getContainingView)(e).id,rendererType:"PileupRenderer"});case 11:s=t.sent,(u=s.feature)&&e.setContextMenuFeature(new P.SimpleFeature(u));case 14:t.next=20;break;case 16:t.prev=16,t.t0=t.catch(2),console.error(t.t0),r.notify("".concat(t.t0));case 20:case"end":return t.stop()}}),t,null,[[2,16]])})))()}})},colorSchemeSubMenuItems:function(){return[{label:"Normal",onClick:function(){return e.setColorScheme({type:"normal"})}},{label:"Mapping quality",onClick:function(){return e.setColorScheme({type:"mappingQuality"})}},{label:"Strand",onClick:function(){return e.setColorScheme({type:"strand"})}},{label:"Per-base quality",onClick:function(){return e.setColorScheme({type:"perBaseQuality"})}},{label:"Per-base lettering",onClick:function(){return e.setColorScheme({type:"perBaseLettering"})}},{label:"First-of-pair strand",onClick:function(){return e.setColorScheme({type:"stranded"})}},{label:"Color by tag...",onClick:function(){(0,P.getSession)(e).queueDialog((function(t){return[At,{model:e,handleClose:t}]}))}}]},trackMenuItems:function(){return[].concat((0,k.Z)(t()),[{label:"Filter by",icon:_e.Z,onClick:function(){(0,P.getSession)(e).queueDialog((function(t){return[Rt,{model:e,handleClose:t}]}))}},{label:"Set feature height",subMenu:[{label:"Normal",onClick:function(){e.setFeatureHeight(7),e.setNoSpacing(!1)}},{label:"Compact",onClick:function(){e.setFeatureHeight(2),e.setNoSpacing(!0)}},{label:"Manually set height",onClick:function(){(0,P.getSession)(e).queueDialog((function(t){return[It,{model:e,handleClose:t}]}))}}]},{label:"Set max height...",onClick:function(){(0,P.getSession)(e).queueDialog((function(t){return[Lt,{model:e,handleClose:t}]}))}}])}}})).views((function(e){return{renderProps:function(){return e.renderPropsPre()}}})).actions((function(e){return{afterAttach:function(){(0,E.$X)(e,(0,S.Z)((0,w.Z)().mark((function t(){var n,r,a,i,o;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=(0,P.getContainingView)(e),e.autorunReady){t.next=3;break}return t.abrupt("return");case 3:if(r=e.colorBy,a=e.tagsReady,i=n.staticBlocks,null===r||void 0===r||!r.tag||a){t.next=10;break}return t.next=8,Pe(e,r,i);case 8:o=t.sent,e.updateColorTagMap(o);case 10:e.setTagsReady(!0);case 11:case"end":return t.stop()}}),t)}))),{delay:1e3}),(0,f.addDisposer)(e,(0,ue.autorun)((0,S.Z)((0,w.Z)().mark((function t(){var n,r,a,i,o,s,u;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=(0,P.getSession)(e),t.prev=1,a=e.featureIdUnderMouse,(null===(r=e.featureUnderMouse)||void 0===r?void 0:r.id())===a){t.next=15;break}if(a){t.next=8;break}e.setFeatureUnderMouse(void 0),t.next=15;break;case 8:return i=(0,Te.getRpcSessionId)(e),o=(0,P.getContainingView)(e),t.next=12,n.rpcManager.call(i,"CoreGetFeatureDetails",{featureId:a,sessionId:i,layoutId:o.id,rendererType:"PileupRenderer"});case 12:s=t.sent,u=s.feature,e.featureIdUnderMouse===u.uniqueId&&e.setFeatureUnderMouse(new P.SimpleFeature(u));case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(1),console.error(t.t0),n.notify("".concat(t.t0),"error");case 21:case"end":return t.stop()}}),t,null,[[1,17]])})))))}}}))}var jt=(0,ee.lazy)((function(){return n.e(1510).then(n.bind(n,81510))})),Dt=(0,ee.lazy)((function(){return n.e(6750).then(n.bind(n,56750))}));var Bt=function(e){return f.types.compose("LinearPileupDisplay",Ft(e),f.types.model({type:f.types.literal("LinearPileupDisplay"),configuration:(0,c.ConfigurationReference)(e),showSoftClipping:!1,mismatchAlpha:f.types.maybe(f.types.boolean),sortedBy:f.types.maybe(f.types.model({type:f.types.string,pos:f.types.number,tag:f.types.maybe(f.types.string),refName:f.types.string,assemblyName:f.types.string}))})).volatile((function(){return{sortReady:!1,currSortBpPerPx:0,modificationTagMap:ue.observable.map({}),modificationsReady:!1}})).actions((function(e){return{setCurrSortBpPerPx:function(t){e.currSortBpPerPx=t},updateModificationColorMap:function(t){t.forEach((function(t){e.modificationTagMap.has(t)||e.modificationTagMap.set(t,E.b4[t]||(0,E.p)())}))},setModificationsReady:function(t){e.modificationsReady=t},setSortReady:function(t){e.sortReady=t},clearSelected:function(){e.sortedBy=void 0},toggleSoftClipping:function(){e.showSoftClipping=!e.showSoftClipping},toggleMismatchAlpha:function(){e.mismatchAlpha=!e.mismatchAlpha},setSortedBy:function(t,n){var r=(0,P.getContainingView)(e).centerLineInfo;if(r){var a=r.refName,i=r.assemblyName,o=r.offset,s=Math.round(o)+1;s<0||!a||(e.sortReady=!1,e.sortedBy={type:t,pos:s,refName:a,assemblyName:i,tag:n})}}}})).actions((function(e){var t=e.reload;return{reload:function(){e.clearSelected(),t()}}})).views((function(e){return{get rendererConfig(){var t=e.featureHeight,n=e.noSpacing,r=e.trackMaxHeight,a=e.mismatchAlpha,i=e.rendererTypeName,o=(0,c.getConf)(e,["renderers",i])||{};return e.rendererType.configSchema.create((0,Z.Z)((0,Z.Z)((0,Z.Z)((0,Z.Z)((0,Z.Z)({},o),void 0!==t?{height:t}:{}),void 0!==n?{noSpacing:n}:{}),void 0!==a?{mismatchAlpha:a}:{}),void 0!==r?{maxHeight:r}:{}),(0,P.getEnv)(e))}}})).views((function(e){var t=e.renderReady;return{get mismatchAlphaSetting(){return(0,c.readConfObject)(e.rendererConfig,"mismatchAlpha")},renderReady:function(){var n=(0,P.getContainingView)(e);return e.modificationsReady&&e.currSortBpPerPx===n.bpPerPx&&t()}}})).views((function(e){var t=e.trackMenuItems,n=e.renderPropsPre,r=e.renderProps,a=e.colorSchemeSubMenuItems;return{renderPropsPre:function(){var t=e.sortedBy,r=e.showSoftClipping,a=e.modificationTagMap,i=n();return(0,Z.Z)((0,Z.Z)({},i),{},{showSoftClip:r,sortedBy:t,modificationTagMap:Object.fromEntries(a.toJSON())})},renderProps:function(){var t=e.sortReady,n=r();return(0,Z.Z)((0,Z.Z)({},n),{},{notReady:n.notReady||!t})},trackMenuItems:function(){return[].concat((0,k.Z)(t()),[{label:"Show soft clipping",icon:wt.Z,type:"checkbox",checked:e.showSoftClipping,onClick:function(){e.toggleSoftClipping(),e.showSoftClipping&&e.clearSelected()}},{label:"Sort by",icon:xt.Z,disabled:e.showSoftClipping,subMenu:[].concat((0,k.Z)(["Start location","Read strand","Base pair"].map((function(t){return{label:t,onClick:function(){return e.setSortedBy(t)}}}))),[{label:"Sort by tag...",onClick:function(){(0,P.getSession)(e).queueDialog((function(t){return[jt,{model:e,handleClose:t}]}))}},{label:"Clear sort",onClick:function(){return e.clearSelected()}}])},{label:"Color scheme",subMenu:[{label:"Pair orientation",onClick:function(){return e.setColorScheme({type:"pairOrientation"})}},{label:"Modifications or methylation",onClick:function(){(0,P.getSession)(e).queueDialog((function(t){return[Dt,{model:e,handleClose:t}]}))}},{label:"Insert size",onClick:function(){return e.setColorScheme({type:"insertSize"})}}].concat((0,k.Z)(a()))},{label:"Fade mismatches by quality",type:"checkbox",checked:e.mismatchAlphaSetting,onClick:function(){return e.toggleMismatchAlpha()}}])}}})).actions((function(e){return{afterAttach:function(){(0,E.$X)(e,(0,S.Z)((0,w.Z)().mark((function t(){var n,r;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=(0,P.getContainingView)(e),e.autorunReady){t.next=3;break}return t.abrupt("return");case 3:r=n.bpPerPx,e.setCurrSortBpPerPx(r);case 5:case"end":return t.stop()}}),t)}))),{delay:1e3}),(0,E.$X)(e,(0,S.Z)((0,w.Z)().mark((function t(){var n,r,a,i,o,s,u,c,l,d,f;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=(0,P.getSession)(e),r=n.rpcManager,a=(0,P.getContainingView)(e),e.autorunReady){t.next=4;break}return t.abrupt("return");case 4:if(i=e.sortedBy,o=e.adapterConfig,s=e.rendererType,u=e.sortReady,c=a.bpPerPx,!i||u&&e.currSortBpPerPx!==a.bpPerPx){t.next=10;break}return l=i.pos,d=i.refName,f=i.assemblyName,t.next=10,e.rendererType.renderInClient(r,(0,Z.Z)({assemblyName:f,regions:[{start:l,end:l+1,refName:d,assemblyName:f}],adapterConfig:o,rendererType:s.name,sessionId:(0,Te.getRpcSessionId)(e),layoutId:a.id,timeout:1e6},e.renderPropsPre()));case 10:e.setCurrSortBpPerPx(c),e.setSortReady(!0);case 12:case"end":return t.stop()}}),t)}))),{delay:1e3}),(0,E.$X)(e,(0,S.Z)((0,w.Z)().mark((function t(){var n,r,a,i,o,s;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.autorunReady){t.next=2;break}return t.abrupt("return");case 2:if(n=e.parentTrack,r=e.colorBy,a=(0,P.getContainingView)(e),i=a.staticBlocks,"modifications"!==(null===r||void 0===r?void 0:r.type)){t.next=10;break}return o=(0,c.getConf)(n,["adapter"]),t.next=8,Re(e,o,r,i);case 8:s=t.sent,e.updateModificationColorMap(s);case 10:e.setModificationsReady(!0);case 11:case"end":return t.stop()}}),t)}))))}}}))};function Et(e){e.addDisplayType((function(){var t=bt(e);return new ie.Z({name:"LinearPileupDisplay",displayName:"Pileup display",configSchema:t,stateModel:Bt(t),subDisplay:{type:"LinearAlignmentsDisplay",lowerPanel:!0},trackType:"AlignmentsTrack",viewType:"LinearGenomeView",ReactComponent:oe.qb})}))}var Vt=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="AlignmentsPlugin",e}return(0,a.Z)(n,[{key:"install",value:function(e){[h,d,Et,Fe,at,y,m,ae,vt,A,Xe,nt,be,ct,yt].map((function(t){return t(e)}))}}]),n}(s.Z)},58203:function(e,t,n){"use strict";n.d(t,{If:function(){return i},Wh:function(){return s},k5:function(){return u},uE:function(){return c},ue:function(){return o},zi:function(){return l}});var r=n(40909),a=n(54685),i={color_fwd_strand_not_proper:"#ECC8C8",color_rev_strand_not_proper:"#BEBED8",color_fwd_strand:"#EC8B8B",color_rev_strand:"#8F8FD8",color_fwd_missing_mate:"#D11919",color_rev_missing_mate:"#1919D1",color_fwd_diff_chr:"#000",color_rev_diff_chr:"#969696",color_pair_lr:"#c8c8c8",color_pair_rr:"navy",color_pair_rl:"teal",color_pair_ll:"green",color_nostrand:"#c8c8c8",color_interchrom:"purple",color_longinsert:"red",color_shortinsert:"pink",color_unknown:"grey"},o={color_fwd_strand_not_proper:"#CA6767",color_rev_strand_not_proper:"#7272AA",color_fwd_strand:"#DC2A2A",color_rev_strand:"#4141BA",color_fwd_missing_mate:"#921111",color_rev_missing_mate:"#111192",color_fwd_diff_chr:"#000000",color_rev_diff_chr:"#696969",color_pair_lr:"#8C8C8C",color_pair_rr:"#00005A",color_pair_rl:"#005A5A",color_pair_ll:"#005A00",color_nostrand:"#8C8C8C",color_interchrom:"#5A005A",color_longinsert:"#B30000",color_shortinsert:"#FF3A5C",color_unknown:"grey"};function s(e,t,n){var r=e.refName===t.refName,a=Math.abs(e.tlen||0);return r&&a>((null===n||void 0===n?void 0:n.upper)||0)?[i.color_longinsert,o.color_longinsert]:r&&a<((null===n||void 0===n?void 0:n.lower)||0)?[i.color_shortinsert,o.color_shortinsert]:r?void 0:[i.color_interchrom,o.color_interchrom]}function u(e,t,n){return s(e,t,n)||c(e)}function c(e){var t=a.uD.fr,n=a.oL[t[e.pair_orientation||""]];return[i[n]||i.color_unknown,o[n]||o.color_unknown]}var l=r.types.maybe(r.types.model({type:r.types.string,tag:r.types.maybe(r.types.string),extra:r.types.frozen()}))},54685:function(e,t,n){"use strict";n.d(t,{$X:function(){return y},ES:function(){return m},O:function(){return h},TN:function(){return d},b4:function(){return v},h1:function(){return l},oL:function(){return p},p:function(){return b},uD:function(){return f}});var r=n(33028),a=n(32723),i=n(34795),o=n(95915),s=n(81450),u=n(40909),c=n(90689);function l(e,t){var n=e.get("tags");return void 0!==n?n[t]:e.get(t)}function d(e,t,n){var r;return null!==(r=l(e,t))&&void 0!==r?r:l(e,n)}var f={fr:{F1R2:"LR",F2R1:"LR",F1F2:"LL",F2F1:"LL",R1R2:"RR",R2R1:"RR",R1F2:"RL",R2F1:"RL"},rf:{R1F2:"LR",R2F1:"LR",R1R2:"LL",R2R1:"LL",F1F2:"RR",F2F1:"RR",F1R2:"RL",F2R1:"RL"},ff:{F2F1:"LR",R1R2:"LR",F2R1:"LL",R1F2:"LL",R2F1:"RR",F1R2:"RR",R2R1:"RL",F1F2:"RL"}},p={LR:"color_pair_lr",LL:"color_pair_ll",RR:"color_pair_rr",RL:"color_pair_rl"};function h(e,t){return g.apply(this,arguments)}function g(){return(g=(0,i.Z)((0,a.Z)().mark((function e(t,n){var i,u,c,l,d,f;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=t.start,c=t.end,l=t.originalRefName,d=t.refName,e.next=3,(0,s.z)(n.getFeatures((0,r.Z)((0,r.Z)({},t),{},{refName:l||d,end:c+1,start:Math.max(0,u-1)})).pipe((0,o.q)()));case 3:return f=e.sent,e.abrupt("return",null===(i=f[0])||void 0===i?void 0:i.get("seq"));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return"methylation"===e}var v={m:"rgb(255,0,0)",h:"rgb(11, 132, 165)",o:"rgb(111, 78, 129)",f:"rgb(246, 200, 95)",c:"rgb(157, 216, 102)",g:"rgb(255, 160, 86)",e:"rgb(141, 221, 208)",b:"rgb(202, 71, 47)"};function y(e,t,n){(0,u.addDisposer)(e,(0,c.autorun)((0,i.Z)((0,a.Z)().mark((function n(){return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t();case 3:n.next=8;break;case 5:n.prev=5,n.t0=n.catch(0),(0,u.isAlive)(e)&&e.setError(n.t0);case 8:case"end":return n.stop()}}),n,null,[[0,5]])}))),n))}function b(){return"hsl(".concat(200*Math.random(),", 50%, 50%)")}},44750:function(e,t,n){"use strict";n.d(t,{Go:function(){return d},cO:function(){return l},mu:function(){return c},wf:function(){return f}});var r=n(96234),a=n(30969),i=n(81073),o=[0,1,2,3],s=o[1],u=o[3];function c(e,t,n){var r;return((null===(r=e.bpToPx({refName:t,coord:n}))||void 0===r?void 0:r.offsetPx)||0)-e.offsetPx}function l(e,t,n,r,a,o){var c=r[t].displays[0],l=c.height,d=0,f=c.SNPCoverageDisplay;f&&(d=f.height);var p,h=o?0:c.scrollTop;return(0,i.clamp)(a[s]-h+((p=a)[u]-p[s])/2+d,0,l)+function(e,t,n,r){var a;return r?r(t,n):(null===(a=e[n].trackRefs[t])||void 0===a?void 0:a.getBoundingClientRect().top)||0}(n,e,t,o)+c.scrollTop}var d=function(e){var t=(0,a.useState)(),n=(0,r.Z)(t,2)[1];(0,a.useEffect)((function(){n(e)}),[e])};function f(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=new Set((arguments.length>2&&void 0!==arguments[2]?arguments[2]:[]).map((function(t){return e(t)}))),r=t.filter((function(t){return n.has(e(t))})),a=arguments.length,i=new Array(a>3?a-3:0),o=3;o<a;o++)i[o-3]=arguments[o];return 0===i.length?r:f.apply(void 0,[e,r].concat(i))}},38787:function(e,t,n){"use strict";n.d(t,{lJ:function(){return z},pL:function(){return Q},_U:function(){return Y},ZP:function(){return K}});var r=n(9249),a=n(87371),i=n(45754),o=n(13820),s=n(81073),u=n(49767),c=n(30969),l=n(39798),d=n(32723),f=n(34795),p=n(33028),h=n(41361),g=n(40909),m=n(29206),v=n(90689),y=n(21918),b=n(9077),w=n(77479),x=n(22417),k=n(77879),Z=n(69416),C=n(96234);function S(e,t,n,r,a){var i=Math.abs(e-n);if(!(i>r)){i===r&&a.push([t,e]);var o=Math.sqrt(r*r-i*i);a.push([t-o,e],[t+o,e])}}function T(e,t,n,r,a){var i=Math.abs(e-t);if(!(i>r)){i===r&&a.push([e,n]);var o=Math.sqrt(r*r-i*i);a.push([e,n-o],[e,n+o])}}function P(e,t){var n=Math.sqrt(e*e+t*t);if(0===n)return[0,0];var r=function(e,t){var n=(Math.atan(t/e)+2*Math.PI)%(2*Math.PI);return e<0&&(t<=0?n+=Math.PI:n-=Math.PI),n}(e,t);return[n,r]}var M=2*Math.PI;var R=function(){function e(t,n,a,i){(0,r.Z)(this,e),this.region=n,this.offsetRadians=a,this.radianWidth=i,this.key=void 0,this.startRadians=void 0,this.endRadians=void 0,this.bpPerRadian=void 0,this.flipped=void 0;var o=t.bpPerRadian;this.key="regions"in n?JSON.stringify(n.regions):(0,s.assembleLocString)(n),this.bpPerRadian=o,this.flipped=!1,this.startRadians=a,this.endRadians=n.widthBp/this.bpPerRadian+a,Object.freeze(this)}return(0,a.Z)(e,[{key:"bpToXY",value:function(e,t){var n=(this.region.elided?this.region.widthBp/2:this.flipped?this.region.end-e:e-this.region.start)/this.bpPerRadian+this.offsetRadians;return(0,s.polarToCartesian)(t,n)}},{key:"toJSON",value:function(){return Object.fromEntries(Object.entries(this))}}]),e}();function A(e,t){var n,r,a,i,o=(0,C.Z)(e.visibleSection.theta,2),s=o[0],u=o[1];return n=t.offsetRadians+e.offsetRadians,r=t.radianWidth,a=s,i=u-s,!(r<=0||i<=0)&&(r+1e-4>=M||i+1e-4>=M||(n=(n%M+M)%M+M)<(a=(a%M+M)%M+M)+i&&n+r>a||n<(a-=M)+i&&n+r>a||n<(a+=M+M)+i&&n+r>a)}var I=(0,c.lazy)((function(){return n.e(4472).then(n.bind(n,64472))}));var L=function(e){return g.types.compose(w.BaseViewModel,g.types.model("CircularView",{type:g.types.literal("CircularView"),offsetRadians:-Math.PI/2,bpPerPx:200,tracks:g.types.array(e.pluggableMstType("track","stateModel")),hideVerticalResizeHandle:!1,hideTrackSelectorButton:!1,lockedFitToWindow:!0,disableImportForm:!1,height:g.types.optional(g.types.refinement("trackHeight",g.types.number,(function(e){return e>=40})),400),displayedRegions:g.types.array(m.Region),scrollX:0,scrollY:0,minimumRadiusPx:25,spacingPx:10,paddingPx:80,lockedPaddingPx:100,minVisibleWidth:6,minimumBlockWidth:20,trackSelectorType:"hierarchical"})).volatile((function(){return{volatileWidth:void 0,error:void 0}})).views((function(e){return{get width(){if(void 0===e.volatileWidth)throw new Error("wait for view to be initialized first before accessing width");return e.volatileWidth},get visibleSection(){return function(e,t,n){var r=(0,C.Z)(e,4),a=r[0],i=r[1],o=r[2],s=r[3],u=(0,C.Z)(t,2),c=u[0],l=u[1];if(i-=c,o-=l,s-=l,(a-=c)<0&&i>0&&o<0&&s>0){for(var d=-1/0,f=0,p=[[a,o],[i,o],[a,s],[i,s]];f<p.length;f++){var h=(0,C.Z)(p[f],2),g=h[0],m=h[1],v=Math.sqrt(g*g+m*m);v>d&&(d=v)}return{rho:[0,Math.min(n,d)],theta:[0,2*Math.PI]}}var y=[[a,o],[i,o],[a,s],[i,s]];T(a,0,0,n,y),T(i,0,0,n,y),S(o,0,0,n,y),S(s,0,0,n,y),-a<n&&y.push([a,0]),i<n&&y.push([i,0]),-o<n&&y.push([0,o]),s<n&&y.push([0,s]);for(var b=a>=0?-1:1,w=1/0,x=-1/0,k=1/0,Z=-1/0,M=0,R=y;M<R.length;M++){var A=(0,C.Z)(R[M],2),I=A[0],L=A[1];if(I>=a&&I<=i&&L>=o&&L<=s){var N=P(I*b,L*b),F=(0,C.Z)(N,2),j=F[0],D=F[1];j<=n+.001&&(D<k&&j>1e-4&&(k=D),D>Z&&j>1e-4&&(Z=D),j<w&&(w=j),j>x&&(x=j))}}return-1===b&&(k+=Math.PI,Z+=Math.PI),k>2*Math.PI&&Z>2*Math.PI&&(k-=2*Math.PI,Z-=2*Math.PI),{rho:[w,Math.min(n,x)],theta:[k,Z]}}([e.scrollX,e.scrollX+e.width,e.scrollY,e.scrollY+e.height],this.centerXY,this.radiusPx)},get circumferencePx(){var t,n=0,r=(0,h.Z)(this.elidedRegions);try{for(r.s();!(t=r.n()).done;){n+=t.value.widthBp}}catch(a){r.e(a)}finally{r.f()}return n/e.bpPerPx+e.spacingPx*this.elidedRegions.length},get radiusPx(){return this.circumferencePx/(2*Math.PI)},get bpPerRadian(){return e.bpPerPx*this.radiusPx},get pxPerRadian(){return this.radiusPx},get centerXY(){return[this.radiusPx+e.paddingPx,this.radiusPx+e.paddingPx]},get totalBp(){var t,n=0,r=(0,h.Z)(e.displayedRegions);try{for(r.s();!(t=r.n()).done;){var a=t.value;n+=a.end-a.start}}catch(i){r.e(i)}finally{r.f()}return n},get maximumRadiusPx(){return e.lockedFitToWindow?Math.min(e.width,e.height)/2-e.lockedPaddingPx:1e6},get maxBpPerPx(){var t=2*Math.PI*e.minimumRadiusPx;return this.totalBp/t},get minBpPerPx(){var e=2*Math.PI*this.maximumRadiusPx;return(0,s.clamp)(this.totalBp/e,1e-10,this.maxBpPerPx)},get atMaxBpPerPx(){return e.bpPerPx>=this.maxBpPerPx},get atMinBpPerPx(){return e.bpPerPx<=this.minBpPerPx},get tooSmallToLock(){return this.minBpPerPx<=1e-10},get figureDimensions(){return[2*this.radiusPx+2*e.paddingPx,2*this.radiusPx+2*e.paddingPx]},get figureWidth(){return this.figureDimensions[0]},get figureHeight(){return this.figureDimensions[1]},get elidedRegions(){var t=[];e.displayedRegions.forEach((function(n){var r=n.end-n.start;if(r/e.bpPerPx<e.minVisibleWidth){var a=t.at(-1);null!==a&&void 0!==a&&a.elided?(a.regions.push((0,p.Z)({},n)),a.widthBp+=r):t.push({elided:!0,widthBp:r,regions:[(0,p.Z)({},n)]})}else t.push((0,p.Z)((0,p.Z)({},n),{},{widthBp:r,elided:!1}))}));for(var n=0;n<t.length;n+=1){var r=t[n];r.elided&&1===r.regions.length&&(t[n]=(0,p.Z)((0,p.Z)((0,p.Z)({},r),r.regions[0]),{},{elided:!1}))}return t},get assemblyNames(){var t=[];return e.displayedRegions.forEach((function(e){t.includes(e.assemblyName)||t.push(e.assemblyName)})),t},get initialized(){var t=(0,s.getSession)(e).assemblyManager;return void 0!==e.volatileWidth&&this.assemblyNames.every((function(e){var n;return null===(n=t.get(e))||void 0===n?void 0:n.initialized}))}}})).views((function(e){return{get staticSlices(){return function(e){var t,n=[],r=0,a=e.bpPerRadian,i=e.spacingPx,o=e.pxPerRadian,s=(0,h.Z)(e.elidedRegions);try{for(s.s();!(t=s.n()).done;){var u=t.value,c=u.widthBp/a+i/o;n.push(new R(e,u,r,c)),r+=c}}catch(l){s.e(l)}finally{s.f()}return n}(e)}}})).views((function(e){return{get visibleStaticSlices(){return e.staticSlices.filter((function(t){return A(e,t)}))}}})).actions((function(t){return{setWidth:function(e){return t.volatileWidth=Math.max(e,100),t.volatileWidth},setHeight:function(e){return t.height=Math.max(e,40),t.height},resizeHeight:function(e){var n=t.height,r=this.setHeight(t.height+e);return this.setModelViewWhenAdjust(!t.tooSmallToLock),r-n},resizeWidth:function(e){var n=t.width,r=this.setWidth(t.width+e);return this.setModelViewWhenAdjust(!t.tooSmallToLock),r-n},rotateClockwiseButton:function(){this.rotateClockwise(Math.PI/6)},rotateCounterClockwiseButton:function(){this.rotateCounterClockwise(Math.PI/6)},rotateClockwise:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.17;t.offsetRadians+=e},rotateCounterClockwise:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.17;t.offsetRadians-=e},zoomInButton:function(){this.setBpPerPx(t.bpPerPx/1.4)},zoomOutButton:function(){this.setBpPerPx(1.4*t.bpPerPx)},setBpPerPx:function(e){t.bpPerPx=(0,s.clamp)(e,t.minBpPerPx,t.maxBpPerPx)},setModelViewWhenAdjust:function(e){t.lockedFitToWindow&&e&&this.setBpPerPx(t.minBpPerPx)},closeView:function(){(0,g.getParent)(t,2).removeView(t)},setDisplayedRegions:function(e){var n=0===t.displayedRegions.length;t.displayedRegions=(0,g.cast)(e),n?this.setBpPerPx(t.minBpPerPx):this.setBpPerPx(t.bpPerPx)},activateTrackSelector:function(){if("hierarchical"===t.trackSelectorType){var e=(0,s.getSession)(t);if((0,s.isSessionModelWithWidgets)(e)){var n=e.addWidget("HierarchicalTrackSelectorWidget","hierarchicalTrackSelector",{view:t});return e.showWidget(n),n}}throw new Error("invalid track selector type ".concat(t.trackSelectorType))},toggleTrack:function(e){this.hideTrack(e)||this.showTrack(e)},setError:function(e){t.error=e},showTrack:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.pluggableConfigSchemaType("track"),i=(0,g.resolveIdentifier)(a,(0,g.getRoot)(t),n),o=e.getTrackType(i.type);if(!o)throw new Error("unknown track type ".concat(i.type));var s=e.getViewType(t.type),u=new Set(s.displayTypes.map((function(e){return e.name}))),c=i.displays.find((function(e){return u.has(e.type)})),l=o.stateModel.create((0,p.Z)((0,p.Z)({},r),{},{type:i.type,configuration:i,displays:[{type:c.type,configuration:c}]}));t.tracks.push(l)},addTrackConf:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.type,i=(0,b.readConfObject)(n,"name"),o=e.getTrackType(a);if(!o)throw new Error("unknown track type ".concat(a));var s=e.getViewType(t.type),u=new Set(s.displayTypes.map((function(e){return e.name}))),c=n.displays.find((function(e){return u.has(e.type)}));t.tracks.push(o.stateModel.create((0,p.Z)((0,p.Z)({},r),{},{name:i,type:a,configuration:n,displays:[{type:c.type,configuration:c}]})))},hideTrack:function(n){var r=e.pluggableConfigSchemaType("track"),a=(0,g.resolveIdentifier)(r,(0,g.getRoot)(t),n),i=t.tracks.filter((function(e){return e.configuration===a}));return(0,v.transaction)((function(){return i.forEach((function(e){return t.tracks.remove(e)}))})),i.length},toggleFitToWindowLock:function(){return t.lockedFitToWindow=!t.lockedFitToWindow,this.setModelViewWhenAdjust(t.atMinBpPerPx),t.lockedFitToWindow},exportSvg:function(){var e=arguments;return(0,f.Z)((0,d.Z)().mark((function r(){var a,i,o,s,u;return(0,d.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:{},r.next=3,n.e(5104).then(n.bind(n,5104));case 3:return i=r.sent,o=i.renderToSvg,r.next=7,o(t,a);case 7:s=r.sent,u=new Blob([s],{type:"image/svg+xml"}),(0,y.saveAs)(u,a.filename||"image.svg");case 10:case"end":return r.stop()}}),r)})))()}}})).views((function(e){return{menuItems:function(){return[{label:"Return to import form",onClick:function(){return e.setDisplayedRegions([])},icon:k.Z},{label:"Export SVG",icon:Z.Z,onClick:function(){(0,s.getSession)(e).queueDialog((function(t){return[I,{model:e,handleClose:t}]}))}},{label:"Open track selector",onClick:e.activateTrackSelector,icon:x.GD}]}}}))},N=n(58158),F=n(90550),j=n(53276),D=n(37574),B=(0,j.ZL)()((function(e){var t=e.palette,n=t.primary,r=t.secondary,a=t.tertiary,i=t.quaternary;return{path:{strokeDasharray:187,strokeDashoffset:50,animation:"$dash ".concat(1.4,"s ease-in-out infinite, $colors ").concat(5.6,"s ease-in-out infinite")},"@keyframes colors":{"0%":{stroke:n.light},"25%":{stroke:r.light},"50%":{stroke:a.light},"75%":{stroke:i.light},"100%":{stroke:n.light}},"@keyframes dash":{"0%":{strokeDashoffset:2},"50%":{strokeDashoffset:.5,transform:"rotate(135deg)"},"100%":{strokeDashoffset:2,transform:"rotate(720deg)"}}}})),E=(0,F.observer)((function(e){var t=e.model.renderProps.radius,n=B().classes,r=(0,c.useState)(!1),a=(0,C.Z)(r,2),i=a[0],o=a[1];return(0,c.useEffect)((function(){var e=setTimeout((function(){return o(!0)}),400);return function(){return clearTimeout(e)}})),i?(0,D.jsxs)("g",{children:[(0,D.jsx)("defs",{children:(0,D.jsx)("pattern",{id:"diagonalHatch",width:"10",height:"10",patternTransform:"rotate(45 0 0)",patternUnits:"userSpaceOnUse",children:(0,D.jsx)("line",{x1:"0",y1:"0",x2:"0",y2:"10",style:{stroke:"rgba(255,255,255,0.5)",strokeWidth:10}})})}),(0,D.jsx)("circle",{cx:"0",cy:"0",r:t,fill:"#f1f1f1"}),(0,D.jsx)("circle",{cx:"0",cy:"0",r:t,fill:"url(#diagonalHatch)"}),(0,D.jsx)("text",{x:"0",y:"0",transform:"rotate(90 0 0)",dominantBaseline:"middle",textAnchor:"middle",children:"Loading\u2026"}),(0,D.jsx)("circle",{className:n.path,fill:"none",strokeWidth:"4",strokeLinecap:"round",cx:"0",cy:"0",r:"60"})]}):null})),V=(0,F.observer)((function(e){var t=e.model,n=t.renderProps.radius,r=t.error;return(0,D.jsxs)("g",{children:[(0,D.jsx)("defs",{children:(0,D.jsx)("pattern",{id:"diagonalHatch",width:"10",height:"10",patternTransform:"rotate(45 0 0)",patternUnits:"userSpaceOnUse",children:(0,D.jsx)("line",{x1:"0",y1:"0",x2:"0",y2:"10",style:{stroke:"rgba(255,0,0,0.5)",strokeWidth:10}})})}),(0,D.jsx)("circle",{cx:"0",cy:"0",r:n,fill:"#ffb4b4"}),(0,D.jsx)("circle",{cx:"0",cy:"0",r:n,fill:"url(#diagonalHatch)"}),(0,D.jsx)("text",{x:"0",y:"0",transform:"rotate(90 0 0)",dominantBaseline:"middle",textAnchor:"middle",children:String(r)})]})})),z=(0,F.observer)((function(e){var t=e.display;return t.error?(0,D.jsx)(V,{model:t}):t.filled?t.reactElement:(0,D.jsx)(E,{model:t})})),O=n(39554),W=n.n(O),H=n(93073),G=n(97891),q=n(59740),_=["html"];function U(e){var t,n=(0,s.getContainingView)(e),r=e.rendererType;return{rendererType:r,rpcManager:(0,s.getSession)(n).rpcManager,renderProps:e.renderProps(),renderArgs:{assemblyName:null===(t=n.displayedRegions[0])||void 0===t?void 0:t.assemblyName,adapterConfig:W()(e.adapterConfig),rendererType:r.name,regions:W()(n.displayedRegions),blockDefinitions:e.blockDefinitions,sessionId:(0,G.getRpcSessionId)(e),timeout:1e6}}}function J(e,t,n){return X.apply(this,arguments)}function X(){return(X=(0,f.Z)((0,d.Z)().mark((function e(t,n,r){var a,i,o,s,u,c,l,f,h,g;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("cannot render with no props");case 2:if(i=t.rendererType,o=t.rpcManager,s=t.cannotBeRenderedReason,u=t.renderArgs,c=t.renderProps,l=t.exportSVG,!s){e.next=5;break}return e.abrupt("return",{message:s});case 5:if(c.radius&&null!==(a=u.regions)&&void 0!==a&&a.length){e.next=7;break}return e.abrupt("return",{message:"Skipping render"});case 7:if(r.isCompatibleWithRenderer(i)){e.next=9;break}throw new Error("renderer ".concat(i.name," is not compatible with this display type"));case 9:return e.next=11,i.renderInClient(o,(0,p.Z)((0,p.Z)((0,p.Z)({},u),c),{},{exportSVG:l}));case 11:return f=e.sent,h=f.html,g=(0,q.Z)(f,_),e.abrupt("return",{html:h,data:g,reactElement:g.reactElement,renderingComponent:i.ReactComponent});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Y=(0,b.ConfigurationSchema)("BaseChordDisplay",{onChordClick:{type:"boolean",description:"callback that should be run when a chord in the track is clicked",defaultValue:!1,contextVariable:["feature","track","pluginManager"]}},{explicitIdentifier:"displayId"});var Q=g.types.compose("BaseChordDisplay",w.BaseDisplay,g.types.model({bezierRadiusRatio:.1,assemblyName:g.types.maybe(g.types.string),configuration:(0,b.ConfigurationReference)(Y)})).volatile((function(){return{filled:!1,reactElement:void 0,data:void 0,html:void 0,message:"",renderingComponent:void 0,refNameMap:void 0}})).actions((function(e){var t=(0,s.getEnv)(e).pluginManager,n=e;return{onChordClick:function(r){(0,b.getConf)(e,"onChordClick",{feature:r,track:n,pluginManager:t})}}})).views((function(e){return{get blockDefinitions(){var t=(0,s.getContainingView)(e).staticSlices;if(!e.refNameMap)return t;var n=W()(t);return n.forEach((function(t){(t.region.elided?t.region.regions:[t.region]).forEach((function(t){var n,r=null===(n=e.refNameMap)||void 0===n?void 0:n[t.refName];r&&t.refName!==r&&(t.refName=r)}))})),n},renderProps:function(){var t=(0,s.getContainingView)(e);return(0,p.Z)((0,p.Z)({},(0,G.getParentRenderProps)(e)),{},{rpcDriverName:e.rpcDriverName,displayModel:e,bezierRadius:t.radiusPx*e.bezierRadiusRatio,radius:t.radiusPx,blockDefinitions:this.blockDefinitions,onChordClick:e.onChordClick})},get rendererType(){var t=e,n=(0,s.getEnv)(e).pluginManager.getRendererType(e.rendererTypeName);if(!n)throw new Error('renderer "'.concat(t.rendererTypeName,'" not found'));if(!n.ReactComponent)throw new Error("renderer ".concat(t.rendererTypeName," has no ReactComponent, it may not be completely implemented yet"));return n},isCompatibleWithRenderer:function(e){return!!(e instanceof H.Z)},get selectedFeatureId(){if((0,g.isAlive)(e)){var t=(0,s.getSession)(e);if(t){var n=t.selection;return(0,s.isFeature)(n)?n.id():void 0}}}}})).actions((function(e){return{renderStarted:function(){e.filled=!1,e.message="",e.reactElement=void 0,e.data=void 0,e.html=void 0,e.error=void 0,e.renderingComponent=void 0},renderSuccess:function(t){var n=t.message,r=t.data,a=t.reactElement,i=t.html,o=t.renderingComponent;n?(e.filled=!1,e.message=n,e.reactElement=void 0,e.data=void 0,e.html=void 0,e.error=void 0,e.renderingComponent=void 0):(e.filled=!0,e.message="",e.reactElement=a,e.data=r,e.html=i,e.error=void 0,e.renderingComponent=o)},renderError:function(t){console.error(t),e.filled=!1,e.message="",e.reactElement=void 0,e.html=void 0,e.data=void 0,e.error=t,e.renderingComponent=void 0},setRefNameMap:function(t){e.refNameMap=t}}})).actions((function(e){return{afterAttach:function(){(0,s.makeAbortableReaction)(e,U,J,{name:"".concat(e.type," ").concat(e.id," rendering"),fireImmediately:!0},e.renderStarted,e.renderSuccess,e.renderError),(0,s.makeAbortableReaction)(e,(function(){return{assemblyNames:(0,G.getTrackAssemblyNames)(e.parentTrack),adapter:(0,b.getConf)((0,g.getParent)(e,2),"adapter"),assemblyManager:(0,s.getSession)(e).assemblyManager}}),function(){var t=(0,f.Z)((0,d.Z)().mark((function t(n,r){var a,i,o;return(0,d.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.assemblyNames,i=n.adapter,o=n.assemblyManager,t.abrupt("return",o.getRefNameMapForAdapter(i,a[0],{signal:r,sessionId:(0,G.getRpcSessionId)(e)}));case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),{name:"".concat(e.type," ").concat(e.id," getting refNames"),fireImmediately:!0},(function(){}),(function(t){return e.setRefNameMap(t)}),(function(t){console.error(t),e.setError(t)}))}}})).views((function(e){return{renderSvg:function(t){return(0,f.Z)((0,d.Z)().mark((function n(){var r,a;return(0,d.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=U(e),n.next=3,J((0,p.Z)((0,p.Z)({},r),{},{exportSVG:t,theme:t.theme||r.renderProps.theme}),void 0,e);case 3:return a=n.sent,n.abrupt("return",(0,D.jsx)(s.ReactRendering,{rendering:a}));case 5:case"end":return n.stop()}}),n)})))()}}})),K=function(e){(0,i.Z)(u,e);var t=(0,o.Z)(u);function u(){var e;(0,r.Z)(this,u);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).name="CircularViewPlugin",e}return(0,a.Z)(u,[{key:"install",value:function(e){!function(e){e.addViewType((function(){return new l.Z({ReactComponent:(0,c.lazy)((function(){return n.e(3652).then(n.bind(n,83652))})),stateModel:L(e),name:"CircularView",displayName:"Circular view"})}))}(e),function(e){e.addToExtensionPoint("LaunchView-CircularView",function(){var e=(0,f.Z)((0,d.Z)().mark((function e(t){var n,r,a,i,o,s,u;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.session,r=t.assembly,a=t.tracks,i=void 0===a?[]:a,o=n.assemblyManager,s=n.addView("CircularView",{}),e.next=5,(0,v.when)((function(){return s.initialized}));case 5:if(r){e.next=7;break}throw new Error("No assembly provided when launching circular genome view");case 7:return e.next=9,o.waitForAssembly(r);case 9:if(u=e.sent){e.next=12;break}throw new Error('Assembly "'.concat(r,'" not found when launching circular genome view'));case 12:s.setDisplayedRegions(u.regions||[]),i.forEach((function(e){return s.showTrack(e)}));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}(e)}},{key:"configure",value:function(e){(0,s.isAbstractMenuManager)(e.rootModel)&&e.rootModel.appendToSubMenu(["Add"],{label:"Circular view",icon:N.Z,onClick:function(e){e.addView("CircularView",{})}})}}]),u}(u.Z)},56111:function(e,t,n){"use strict";var r=n(96234),a=n(30969),i=n(16631),o=n(87006),s=n(53276),u=n(90550),c=n(37574),l='Consolas, "Andale Mono WT", "Andale Mono", "Lucida Console", "Lucida Sans Typewriter", "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Liberation Mono", "Nimbus Mono L", Monaco, "Courier New", Courier, monospace',d=(0,s.ZL)()((function(e){return{error:{color:"red",fontSize:"0.8em"},callbackEditor:{fontFamily:l,fontSize:"12px",background:e.palette.background.default,width:800,marginTop:"16px",border:"1px solid rgba(0,0,0,0.42)"},callbackContainer:{width:"100%",overflowX:"auto"},textAreaFont:{fontFamily:l}}})),f=(0,u.observer)((function(e){var t=e.slot,n=d().classes,s=(0,a.useState)(JSON.stringify(t.value,null,2)),u=(0,r.Z)(s,2),l=u[0],f=u[1],p=(0,a.useState)(),h=(0,r.Z)(p,2),g=h[0],m=h[1];return(0,a.useEffect)((function(){try{m(void 0),t.set(JSON.parse(l))}catch(e){console.error({e:e}),m(e)}}),[l,t]),(0,c.jsxs)(c.Fragment,{children:[g?(0,c.jsx)("p",{className:n.error,children:"".concat(g)}):null,(0,c.jsxs)("div",{className:n.callbackContainer,children:[(0,c.jsx)(i.Z,{shrink:!0,htmlFor:"json-editor",children:t.name}),(0,c.jsx)(o.Z,{id:"json-editor",className:n.callbackEditor,value:l,helperText:t.description,multiline:!0,onChange:function(e){return f(e.target.value)},style:{background:g?"#fdd":void 0},InputProps:{classes:{input:n.textAreaFont}}})]})]})}));t.Z=f},79629:function(e,t,n){"use strict";n.d(t,{wP:function(){return C},ZP:function(){return S}});var r=n(9249),a=n(87371),i=n(45754),o=n(13820),s=n(30969),u=n(49767),c=n(99069),l=n(9077);var d=(0,l.ConfigurationSchema)("FromConfigAdapter",{features:{type:"frozen",defaultValue:[]}},{explicitlyTyped:!0,implicitIdentifier:"adapterId"});var f=(0,l.ConfigurationSchema)("FromConfigRegionsAdapter",{features:{type:"frozen",defaultValue:[]}},{explicitlyTyped:!0,implicitIdentifier:"adapterId"});var p=(0,l.ConfigurationSchema)("FromConfigSequenceAdapter",{features:{type:"frozen",defaultValue:[]}},{explicitlyTyped:!0,implicitIdentifier:"adapterId"});var h=(0,l.ConfigurationSchema)("RefNameAliasAdapter",{location:{type:"fileLocation",defaultValue:{uri:"/path/to/my/aliases.txt",locationType:"UriLocation"}},refNameColumn:{type:"number",defaultValue:0}},{explicitlyTyped:!0}),g=n(40909),m=n(29206),v=function(e){return g.types.model("ConfigurationEditorWidget",{id:m.ElementId,type:g.types.literal("ConfigurationEditorWidget"),target:g.types.safeReference(e.pluggableConfigSchemaType("track"))}).actions((function(e){return{setTarget:function(t){e.target=t}}}))},y=n(90550),b=n(37574),w=(0,y.observer)((function(e){var t=e.model;if(null!==t&&void 0!==t&&t.target){if(t.target.type)return(0,b.jsx)(b.Fragment,{children:"".concat(t.target.type," settings")});if((0,g.isStateTreeNode)(t.target)){var n=(0,g.getType)(t.target);if(null!==n&&void 0!==n&&n.name)return(0,b.jsx)(b.Fragment,{children:"".concat(n.name.replace("ConfigurationSchema","")," settings")})}}return(0,b.jsx)(b.Fragment,{children:"Settings"})})),x=w,k=(0,l.ConfigurationSchema)("ConfigurationEditorWidget",{}),Z=(0,s.lazy)((function(){return Promise.all([n.e(1306),n.e(2799),n.e(6541)]).then(n.bind(n,76541))}));n(56111);var C=(0,s.lazy)((function(){return Promise.all([n.e(1306),n.e(2799),n.e(6541)]).then(n.bind(n,76541))})),S=function(e){(0,i.Z)(s,e);var t=(0,o.Z)(s);function s(){var e;(0,r.Z)(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).name="ConfigurationPlugin",e}return(0,a.Z)(s,[{key:"install",value:function(e){!function(e){e.addAdapterType((function(){return new c.AdapterType({name:"FromConfigAdapter",configSchema:d,getAdapterClass:function(){return n.e(1954).then(n.bind(n,91954)).then((function(e){return e.default}))},adapterMetadata:{hiddenFromGUI:!0}})}))}(e),function(e){e.addAdapterType((function(){return new c.AdapterType({name:"FromConfigRegionsAdapter",configSchema:f,getAdapterClass:function(){return n.e(9723).then(n.bind(n,29723)).then((function(e){return e.default}))},adapterMetadata:{hiddenFromGUI:!0}})}))}(e),function(e){e.addAdapterType((function(){return new c.AdapterType({name:"FromConfigSequenceAdapter",configSchema:p,getAdapterClass:function(){return n.e(2798).then(n.bind(n,92798)).then((function(e){return e.default}))},adapterMetadata:{hiddenFromGUI:!0}})}))}(e),function(e){e.addAdapterType((function(){return new c.AdapterType({name:"RefNameAliasAdapter",configSchema:h,getAdapterClass:function(){return n.e(6755).then(n.bind(n,6755)).then((function(e){return e.default}))},adapterMetadata:{hiddenFromGUI:!0}})}))}(e),function(e){e.addWidgetType((function(){return new c.WidgetType({name:"ConfigurationEditorWidget",HeadingComponent:x,configSchema:k,stateModel:v(e),ReactComponent:Z})}))}(e)}}]),s}(u.Z)},52404:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(9077),a=n(99069),i=n(30969),o=n(40909),s=n(29206),u=o.types.model("AddConnectionModel",{id:s.ElementId,type:o.types.literal("AddConnectionWidget")}),c=(0,r.ConfigurationSchema)("AddConnectionWidget",{}),l=function(e){e.addWidgetType((function(){return new a.WidgetType({name:"AddConnectionWidget",heading:"Add a connection",configSchema:c,stateModel:u,ReactComponent:(0,i.lazy)((function(){return Promise.all([n.e(4979),n.e(1732)]).then(n.bind(n,51732))}))})}))}},74567:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(9077),a=n(99069),i=n(30969),o=n(40909),s=n(29206),u=n(97891);function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{return new URL(e),!0}catch(t){return e.startsWith("/")}}function l(e){return o.types.model("AddTrackModel",{id:s.ElementId,type:o.types.literal("AddTrackWidget"),view:o.types.safeReference(e.pluggableMstType("view","stateModel"))}).volatile((function(){return{trackSource:"fromFile",trackData:void 0,indexTrackData:void 0,altAssemblyName:"",altTrackName:"",altTrackType:"",adapterHint:"",textIndexTrack:!0,textIndexingConf:void 0}})).actions((function(e){return{setAdapterHint:function(t){e.adapterHint=t},setTrackSource:function(t){e.trackSource=t},setTextIndexingConf:function(t){e.textIndexingConf=t},setTextIndexTrack:function(t){e.textIndexTrack=t},setTrackData:function(t){e.trackData=t},setIndexTrackData:function(t){e.indexTrackData=t},setAssembly:function(t){e.altAssemblyName=t},setTrackName:function(t){e.altTrackName=t},setTrackType:function(t){e.altTrackType=t},clearData:function(){e.trackSource="",e.altTrackName="",e.altTrackType="",e.altAssemblyName="",e.adapterHint="",e.indexTrackData=void 0,e.trackData=void 0,e.textIndexingConf=void 0,e.textIndexTrack=!0}}})).views((function(e){return{get trackAdapter(){var t=e.trackData,n=e.indexTrackData,r=e.adapterHint;return t?(0,u.guessAdapter)(t,n,r,e):void 0},get trackName(){return e.altTrackName||(e.trackData?(0,u.getFileName)(e.trackData):"")},get isFtp(){var t,n,r=e.trackData,a=e.indexTrackData;return!!(null!==a&&void 0!==a&&null!==(t=a.uri)&&void 0!==t&&t.startsWith("ftp://")||null!==r&&void 0!==r&&null!==(n=r.uri)&&void 0!==n&&n.startsWith("ftp://"))},get isRelativeTrackUrl(){var t,n=null===(t=e.trackData)||void 0===t?void 0:t.uri;return!!n&&!c(n)},get isRelativeIndexUrl(){var t,n=null===(t=e.indexTrackData)||void 0===t?void 0:t.uri;return!!n&&!c(n)},get isRelativeUrl(){return this.isRelativeIndexUrl||this.isRelativeTrackUrl},get trackHttp(){var t,n;return null===(t=e.trackData)||void 0===t||null===(n=t.uri)||void 0===n?void 0:n.startsWith("http://")},get indexHttp(){var t,n;return null===(t=e.indexTrackData)||void 0===t||null===(n=t.uri)||void 0===n?void 0:n.startsWith("http://")},get wrongProtocol(){return"https:"===window.location.protocol&&(this.trackHttp||this.indexHttp)},get unsupported(){var e;return(null===(e=this.trackAdapter)||void 0===e?void 0:e.type)===u.UNSUPPORTED},get assembly(){var t;return e.altAssemblyName||(null===(t=e.view.assemblyNames)||void 0===t?void 0:t[0])},get trackType(){return e.altTrackType||(this.trackAdapter?(0,u.guessTrackType)(this.trackAdapter.type,e):"")}}})).views((function(e){return{get warningMessage(){return e.isFtp?"Warning: JBrowse cannot access files using the ftp protocol":e.isRelativeUrl?"Warning: one or more of your files do not provide the protocol e.g.\n          https://, please provide an absolute URL unless you are sure a\n          relative URL is intended.":e.wrongProtocol?"Warning: You entered a http:// resources but we cannot access HTTP\n          resources from JBrowse when it is running on https. Please use an\n          https URL for your track, or access the JBrowse app from the http\n          protocol":""}}}))}var d=(0,r.ConfigurationSchema)("AddTrackWidget",{}),f=function(e){e.addWidgetType((function(){return new a.WidgetType({name:"AddTrackWidget",heading:"Add a track",configSchema:d,stateModel:l(e),ReactComponent:(0,i.lazy)((function(){return Promise.all([n.e(1306),n.e(4979),n.e(2212)]).then(n.bind(n,22212))}))})}))}},92672:function(e,t,n){"use strict";n.d(t,{ZP:function(){return v}});var r=n(41361),a=n(68079),i=n(40909),o=n(9077),s=n(81073),u=n(29206),c=n(94957);function l(e,t){var n=(0,s.getSession)(t).assemblyManager,r=(0,s.getEnv)(t).pluginManager,a=t.view;if(!a)return[];var i=t.assemblyNames.map((function(e){return n.get(e)})).filter(s.notEmpty);return e.filter((function(e){var t=(0,o.readConfObject)(e,"assemblyNames"),r=null===t||void 0===t?void 0:t.map((function(e){return n.get(e)})).filter(s.notEmpty);return a.trackSelectorAnyOverlap?(0,c.zL)(r,i):(0,c.xO)(r,i)})).filter((function(e){var t=r.getViewType(a.type).displayTypes.map((function(e){return e.name})),n=e.displays.map((function(e){return e.type}));return(0,c.zL)(t,n)}))}var d=n(97891);function f(e,t,n,i){var u={children:[]},l=e.filterText,f=e.activeSortTrackNames,p=e.activeSortCategories,h=e.view;if(!h)return[];var g,m=(0,s.getSession)(e),v=h.tracks,y=t.filter((function(e){return(0,c.wB)(l,e,m)})),b=(0,r.Z)(function(e,t,n){var r=e.map((function(e){var t,n,r;return[e,(0,o.readConfObject)(e,"name"),(null===(t=(0,o.readConfObject)(e,"category"))||void 0===t?void 0:t[0])||"",(null===(n=(0,o.readConfObject)(e,"category"))||void 0===n?void 0:n[1])||"",(null===(r=(0,o.readConfObject)(e,"category"))||void 0===r?void 0:r[2])||""]}));return t&&r.sort((function(e,t){return e[1].localeCompare(t[1])})),n&&r.sort((function(e,t){return e[2]!==t[2]?e[2].localeCompare(t[2]):e[3]!==t[3]?e[3].localeCompare(t[3]):e[4]!==t[4]?e[4].localeCompare(t[4]):0})),r.map((function(e){return e[0]}))}(y,f,p));try{var w=function(){var e=g.value,t=(0,a.Z)((0,o.readConfObject)(e,"category")||[]);e.trackId.endsWith("sessionTrack")&&t.unshift(" Session tracks");for(var r=u,s=function(){var e=t[c],a=r.children.find((function(t){return t.name===e})),o=[i,t.slice(0,c+1).join(",")].filter((function(e){return!!e})).join("-");if(a)r=a;else{var s={children:[],name:e,id:o,isOpenByDefault:!n.get(o)};r.children.push(s),r=s}},c=0;c<t.length;c++)s();var l=r.children.findIndex((function(e){return e.children.length})),f=-1===l?r.children.length:l;r.children.splice(f,0,{id:e.trackId,name:(0,d.getTrackName)(e,m),conf:e,checked:v.some((function(t){return t.configuration===e})),children:[]})};for(b.s();!(g=b.n()).done;)w()}catch(x){b.e(x)}finally{b.f()}return u.children}function p(e){return i.types.model("HierarchicalTrackSelectorWidget",{id:u.ElementId,type:i.types.literal("HierarchicalTrackSelectorWidget"),initialized:i.types.maybe(i.types.boolean),collapsed:i.types.map(i.types.boolean),sortTrackNames:i.types.maybe(i.types.boolean),sortCategories:i.types.maybe(i.types.boolean),view:i.types.safeReference(e.pluggableMstType("view","stateModel"))}).volatile((function(){return{selection:[],filterText:""}})).actions((function(e){return{setSortTrackNames:function(t){e.sortTrackNames=t},setSortCategories:function(t){e.sortCategories=t},setSelection:function(t){e.selection=t},addToSelection:function(t){e.selection=(0,s.dedupe)([].concat((0,a.Z)(e.selection),(0,a.Z)(t)),(function(e){return e.trackId}))},removeFromSelection:function(t){e.selection=e.selection.filter((function(e){return!t.includes(e)}))},clearSelection:function(){e.selection=[]},setView:function(t){e.view=t},toggleCategory:function(t){e.collapsed.set(t,!e.collapsed.get(t))},setCategoryCollapsed:function(t,n){e.collapsed.set(t,n)},expandAllCategories:function(){e.collapsed.clear()},clearFilterText:function(){e.filterText=""},setFilterText:function(t){e.filterText=t}}})).views((function(t){return{getRefSeqTrackConf:function(n){var a=(0,s.getSession)(t).assemblyManager.get(n),i=null===a||void 0===a?void 0:a.configuration.sequence,o=e.getViewType(t.view.type);if(i){var u,c=(0,r.Z)(i.displays);try{var l,d=function(){var e=u.value;if(o.displayTypes.some((function(t){return t.name===e.type})))return{v:i}};for(c.s();!(u=c.n()).done;)if(l=d())return l.v}catch(f){c.e(f)}finally{c.f()}}}}})).views((function(e){return{get assemblyNames(){var t;return(null===(t=e.view)||void 0===t?void 0:t.assemblyNames)||[]}}})).views((function(e){return{get activeSortTrackNames(){var t;return null!==(t=e.sortTrackNames)&&void 0!==t?t:(0,o.getConf)((0,s.getSession)(e),["hierarchical","sort","trackNames"])},get activeSortCategories(){var t;return null!==(t=e.sortCategories)&&void 0!==t?t:(0,o.getConf)((0,s.getSession)(e),["hierarchical","sort","categories"])},connectionTrackConfigurations:function(t){return l(t.tracks,e)},get trackConfigurations(){return[].concat((0,a.Z)(e.assemblyNames.map((function(t){return e.getRefSeqTrackConf(t)}))),(0,a.Z)(l((0,s.getSession)(e).tracks,e))).filter(s.notEmpty)}}})).views((function(e){return{connectionHierarchy:function(t){return f(e,e.connectionTrackConfigurations(t),e.collapsed,t.name)}}})).views((function(e){return{get allTracks(){var t=(0,s.getSession)(e).connectionInstances,n=void 0===t?[]:t;return[{group:"Tracks",tracks:e.trackConfigurations}].concat((0,a.Z)(n.flatMap((function(e){return{group:(0,o.getConf)(e,"name"),tracks:e.tracks}}))))}}})).views((function(e){return{get hierarchy(){return{name:"Root",id:"Root",children:e.allTracks.map((function(t){return{name:t.group,id:t.group,children:f(e,t.tracks,e.collapsed)}})).filter((function(e,t){return 0===t||!!e.children.length}))}}}})).actions((function(e){return{collapseSubCategories:function(){var t=[];(0,c.h6)(e.hierarchy.children,t);for(var n=0,r=t;n<r.length;n++){var a=r[n];e.setCategoryCollapsed(a,!0)}},collapseTopLevelCategories:function(){var t,n=[],a=(0,r.Z)(e.hierarchy.children);try{for(a.s();!(t=a.n()).done;){var i=t.value;i.children.length&&(0,c.Ak)(i.children,n)}}catch(l){a.e(l)}finally{a.f()}for(var o=0,s=n;o<s.length;o++){var u=s[o];e.setCategoryCollapsed(u,!0)}}}})).actions((function(e){return{afterCreate:function(){if(!e.initialized){var t=(0,s.getSession)(e);(0,o.getConf)(t,["hierarchical","defaultCollapsed","topLevelCategories"])&&e.collapseTopLevelCategories(),(0,o.getConf)(t,["hierarchical","defaultCollapsed","subCategories"])&&e.collapseSubCategories();var n,a=(0,r.Z)((0,o.getConf)(t,["hierarchical","defaultCollapsed","categoryNames"]));try{for(a.s();!(n=a.n()).done;){var i=n.value;e.collapsed.set(i,!0)}}catch(u){a.e(u)}finally{a.f()}e.initialized=!0}}}})).views((function(e){return{get hasAnySubcategories(){return e.allTracks.some((function(e){return e.tracks.some((function(e){var t;return(null===(t=(0,o.readConfObject)(e,"category"))||void 0===t?void 0:t.length)>1}))}))}}}))}var h=(0,o.ConfigurationSchema)("HierarchicalTrackSelectorWidget",{}),g=n(99069),m=n(30969),v=function(e){e.addWidgetType((function(){return new g.WidgetType({name:"HierarchicalTrackSelectorWidget",heading:"Available tracks",configSchema:h,stateModel:p(e),ReactComponent:(0,m.lazy)((function(){return Promise.all([n.e(3182),n.e(3422)]).then(n.bind(n,23422))}))})}))}},94957:function(e,t,n){"use strict";n.d(t,{Ak:function(){return l},h6:function(){return c},wB:function(){return u},xO:function(){return s},zL:function(){return o}});var r=n(41361),a=n(9077),i=n(97891);function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e[0]===t[0])return!0;var n=new Set(e);return t.some((function(e){return n.has(e)}))}function s(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=new Set(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]);return e.every((function(e){return t.has(e)}))}function u(e,t,n){var r=(0,a.readConfObject)(t,"category")||[],o=e.toLowerCase();return(0,i.getTrackName)(t,n).toLowerCase().includes(o)||!!r.filter((function(e){return e.toLowerCase().includes(o)})).length}function c(e,t){var n,a=!1,i=(0,r.Z)(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.children.length)c(o.children,t)&&t.push(o.id);else a=!0}}catch(s){i.e(s)}finally{i.f()}return a}function l(e,t){var n,a=(0,r.Z)(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;i.children.length&&t.push(i.id)}}catch(o){a.e(o)}finally{a.f()}}},37958:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(9077),a=n(99069),i=n(30969),o=n(40909),s=n(29206);function u(e){return o.types.model("PluginStoreModel",{id:s.ElementId,type:o.types.literal("PluginStoreWidget"),filterText:"",view:o.types.safeReference(e.pluggableMstType("view","stateModel"))}).actions((function(e){return{clearFilterText:function(){e.filterText=""},setFilterText:function(t){e.filterText=t}}}))}var c=(0,r.ConfigurationSchema)("PluginStoreWidget",{}),l=function(e){e.addWidgetType((function(){return new a.WidgetType({name:"PluginStoreWidget",heading:"Plugin store",configSchema:c,stateModel:u(e),ReactComponent:(0,i.lazy)((function(){return Promise.all([n.e(1306),n.e(3097)]).then(n.bind(n,33097))}))})}))}},86271:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(99069),a=n(32723),i=n(96234),o=n(41361),s=n(34795),u=n(77479),c=n(9077),l=n(81073),d=n(40909);var f=(0,c.ConfigurationSchema)("UCSCTrackHubConnection",{hubTxtLocation:{type:"fileLocation",defaultValue:{uri:"http://mysite.com/path/to/hub.txt",locationType:"UriLocation"},description:"location of the hub file (usually called hub.txt)"},assemblyNames:{type:"stringArray",defaultValue:[],description:"optional list of genomes to import from this track hub, if empty all genomes will be imported"}},{baseConfiguration:u.baseConnectionConfig});function p(e){return d.types.compose("UCSCTrackHubConnection",(0,u.BaseConnectionModelFactory)(e),d.types.model({configuration:(0,c.ConfigurationReference)(f),type:d.types.literal("UCSCTrackHubConnection")})).actions((function(e){return{connect:function(){return(0,s.Z)((0,a.Z)().mark((function t(){var r,s,u,d,f,p,h,g,m,v,y,b,w,x,k,Z,C,S,T,P,M,R,A,I,L,N,F,j,D,B,E,V;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=(0,l.getSession)(e),s=[],t.prev=2,u=(0,c.getConf)(e,"hubTxtLocation"),t.next=6,n.e(5554).then(n.bind(n,35554));case 6:return d=t.sent,f=d.generateTracks,p=d.fetchGenomesFile,h=d.fetchTrackDbFile,g=d.fetchHubFile,t.next=13,g(u);case 13:if(m=t.sent,v=m.get("genomesFile")){t.next=17;break}throw new Error("genomesFile not found on hub");case 17:return y=new URL(u.uri,u.baseUri),b=y?{uri:new URL(v,y).href,locationType:"UriLocation"}:{localPath:v,locationType:"LocalPathLocation"},t.next=21,p(b);case 21:w=t.sent,x={},k=(0,o.Z)(w),t.prev=24,k.s();case 26:if((Z=k.n()).done){t.next=49;break}if(S=(0,i.Z)(Z.value,2),T=S[0],P=S[1],!((M=(0,c.getConf)(e,"assemblyNames")).length>0)||M.includes(T)){t.next=31;break}return t.abrupt("continue",47);case 31:if(R=null===(C=r.assemblyManager.get(T))||void 0===C?void 0:C.configuration){t.next=35;break}return s.push(T),t.abrupt("continue",47);case 35:if(A=P.get("trackDb")){t.next=38;break}throw new Error("genomesFile not found on hub");case 38:return I=new URL(v,y),L=y?{uri:new URL(A,I).href,locationType:"UriLocation"}:{localPath:A,locationType:"LocalPathLocation"},t.next=42,h(L);case 42:N=t.sent,F=(0,c.readConfObject)(R,["sequence","adapter"]),j=f(N,L,T,F),e.addTrackConfs(j),x[T]=j.length;case 47:t.next=26;break;case 49:t.next=54;break;case 51:t.prev=51,t.t0=t.catch(24),k.e(t.t0);case 54:return t.prev=54,k.f(),t.finish(54);case 57:D=Object.entries(x),B=D.length?"Loaded data from these assemblies: ".concat(D.map((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return"".concat(n," (").concat(r," tracks)")})).join(", ")):"",E=s.length?"Skipped data from these assemblies: ".concat(s.join(", ")):"",r.notify([B,E].filter((function(e){return!!e})).join(". "),"success"),t.next=68;break;case 63:t.prev=63,t.t1=t.catch(2),console.error(t.t1),r.notify('There was a problem connecting to the UCSC Track Hub "'.concat(e.configuration.name,'". Please make sure you have entered a valid hub.txt file. The error that was thrown is: "').concat(t.t1,'"'),"error"),null===(V=r.breakConnection)||void 0===V||V.call(r,e.configuration);case 68:case"end":return t.stop()}}),t,null,[[2,63],[24,51,54,57]])})))()}}}))}var h=function(e){e.addConnectionType((function(){return new r.ConnectionType({name:"UCSCTrackHubConnection",configSchema:f,stateModel:p(e),displayName:"UCSC Track Hub",description:"A track or assembly hub in the Track Hub format",url:"//genome.ucsc.edu/goldenPath/help/hgTrackHubHelp.html#Intro"})}))}},59594:function(e,t,n){"use strict";n.d(t,{Cz:function(){return s},F$:function(){return o},c4:function(){return i}});var r=n(41361),a=n(68079);function i(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.pxToBp(e),a=r.assemblyName,i=r.refName,o=r.start,s=r.offset,u=r.oob,c=Math.floor(o+s);return u?"out of bounds":"".concat(n?"{"+a+"}":"").concat(i,":").concat(c.toLocaleString("en-US"))}function o(e,t,n){var i,o=new Set,s=(0,a.Z)(e).sort((function(e,t){var n=e.end-e.start;return t.end-t.start-n})),u=Array.from({length:Math.round(t)}),c=(0,r.Z)(s);try{for(c.s();!(i=c.n()).done;){var l=i.value,d=l.key,f=l.offsetPx,p=Math.round(t-f+n),h=[Math.max(p-12,0),p];0===p||u.slice.apply(u,h).some(Boolean)?o.add(d):u.fill.apply(u,[!0].concat(h))}}catch(g){c.e(g)}finally{c.f()}return o}function s(e,t){var n,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=[],s=function(e,t,n){for(var r=t*(e=Math.abs(e)),a=Number.parseInt(Number(r).toExponential().split(/e/i)[1],10),i=Math.pow(10,a);i<r&&!((i*=2)>=r);)i*=2.5;var o=(i=Math.max(i,5))/e,s=0;return!(i%10)&&o/10>=n?s=i/10:!(i%5)&&o/5>=n?s=i/5:!(i%2)&&o/2>=n&&(s=i/2),{majorPitch:i,minorPitch:s}}(t,60,15),u=s.minorPitch||s.majorPitch,c=(0,r.Z)(e);try{for(c.s();!(n=c.n()).done;)for(var l=n.value,d=l.start,f=l.end,p=l.refName,h=0,g=d,m=f,v=Math.floor(g/u)*u;v<Math.ceil(m/u)*u+1;v+=u)i&&v%s.majorPitch?(o.push({type:"minor",base:v-1,index:h,refName:p}),h+=1):a&&Math.abs(v-d)>s.minorPitch&&(o.push({type:"major",base:v-1,index:h,refName:p}),h+=1)}catch(y){c.e(y)}finally{c.f()}return o}},81872:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var r=n(30969),a=n(59313),i=n(80928),o=n(33359),s=n(61369),u=n(58119),c=n(53276),l=n(90550),d=n(23038),f=n(37574),p=(0,l.observer)((function(e){var t=e.job;return(0,f.jsx)(s.Z,{variant:"outlined",children:(0,f.jsxs)(u.Z,{children:[(0,f.jsxs)(o.Z,{variant:"body1",children:[(0,f.jsx)("strong",{children:"Name: "}),t.name]}),t.statusMessage?(0,f.jsxs)(o.Z,{variant:"body1",children:[(0,f.jsx)("strong",{children:"Message: "}),t.statusMessage]}):null]})})})),h=n(96234),g=n(38361),m=n(38627),v=n(76481),y=n(72097),b=(0,l.observer)((function(e){var t=e.job,n=(0,r.useState)(!1),a=(0,h.Z)(n,2),i=a[0],c=a[1];return(0,f.jsxs)(s.Z,{variant:"outlined",children:[(0,f.jsxs)(u.Z,{children:[(0,f.jsxs)(o.Z,{variant:"body1",children:[(0,f.jsx)("strong",{children:"Name: "}),t.name]}),(0,f.jsxs)(o.Z,{variant:"body1",children:[(0,f.jsx)("strong",{children:"Message: "}),t.statusMessage||"No message provided"]}),(0,f.jsx)(g.Z,{sx:{display:"flex",alignItems:"center",marginTop:10,marginBottom:10,marginLeft:10},children:0===t.progressPct||100===t.progressPct?(0,f.jsx)(g.Z,{sx:{width:"100%"},children:(0,f.jsx)(m.Z,{variant:"indeterminate"})}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(g.Z,{sx:{width:"100%"},children:(0,f.jsx)(m.Z,{variant:"determinate",value:t.progressPct})}),(0,f.jsx)(g.Z,{sx:{m:1},children:(0,f.jsx)(o.Z,{children:"".concat(Math.round(t.progressPct||0),"%")})})]})})]}),t.cancelCallback?(0,f.jsx)(v.Z,{children:(0,f.jsx)(y.Z,{variant:"contained",color:"inherit",disabled:i||0===t.progressPct,onClick:function(){t.setStatusMessage("Aborted via cancel button"),t.cancelCallback&&t.cancelCallback(),c(!0)},children:"Cancel"})}):null]})})),w=(0,c.ZL)()((function(e){return{root:{margin:e.spacing(1)},expandIcon:{color:e.palette.tertiary.contrastText}}})),x=(0,l.observer)((function(e){var t=e.model,n=w().classes,r=t.jobs,c=t.finished,l=t.queued,h=t.aborted;return(0,f.jsxs)("div",{className:n.root,children:[(0,f.jsxs)(a.Z,{defaultExpanded:!0,children:[(0,f.jsx)(i.Z,{expandIcon:(0,f.jsx)(d.Z,{className:n.expandIcon}),children:(0,f.jsx)(o.Z,{variant:"h5",children:"Running jobs"})}),r.length?r.map((function(e,t){return(0,f.jsx)(b,{job:e},"".concat(JSON.stringify(e),"-").concat(t))})):(0,f.jsx)(s.Z,{variant:"outlined",children:(0,f.jsx)(u.Z,{children:(0,f.jsx)(o.Z,{variant:"body1",children:"No running jobs"})})})]}),(0,f.jsxs)(a.Z,{defaultExpanded:!0,children:[(0,f.jsx)(i.Z,{expandIcon:(0,f.jsx)(d.Z,{className:n.expandIcon}),children:(0,f.jsx)(o.Z,{variant:"h5",children:"Queued jobs"})}),l.length?l.map((function(e,t){return(0,f.jsx)(p,{job:e},"".concat(JSON.stringify(e),"-").concat(t))})):(0,f.jsx)(s.Z,{variant:"outlined",children:(0,f.jsx)(u.Z,{children:(0,f.jsx)(o.Z,{variant:"body1",children:"No queued jobs"})})})]}),(0,f.jsxs)(a.Z,{defaultExpanded:!0,children:[(0,f.jsx)(i.Z,{expandIcon:(0,f.jsx)(d.Z,{className:n.expandIcon}),children:(0,f.jsx)(o.Z,{variant:"h5",children:"Completed jobs"})}),c.length?c.map((function(e,t){return(0,f.jsx)(p,{job:e},"".concat(JSON.stringify(e),"-").concat(t))})):(0,f.jsx)(s.Z,{variant:"outlined",children:(0,f.jsx)(u.Z,{children:(0,f.jsx)(o.Z,{variant:"body1",children:"No completed jobs"})})})]}),(0,f.jsxs)(a.Z,{defaultExpanded:!0,children:[(0,f.jsx)(i.Z,{expandIcon:(0,f.jsx)(d.Z,{className:n.expandIcon}),children:(0,f.jsx)(o.Z,{variant:"h5",children:"Aborted jobs"})}),h.length?h.map((function(e,t){return(0,f.jsx)(p,{job:e},"".concat(JSON.stringify(e),"-").concat(t))})):(0,f.jsx)(s.Z,{variant:"outlined",children:(0,f.jsx)(u.Z,{children:(0,f.jsx)(o.Z,{variant:"body1",children:"No aborted jobs"})})})]})]})}))},53515:function(e,t,n){"use strict";n.d(t,{b0:function(){return u},n2:function(){return l},sh:function(){return c}});var r=n(33028),a=(n(30969),n(53276)),i=n(90550),o=n(37574),s=(0,a.ZL)()((function(e){return{contentBlock:{position:"relative",minHeight:"100%",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden"},elidedBlock:{minHeight:"100%",boxSizing:"border-box",backgroundColor:"#999",backgroundImage:"repeating-linear-gradient(90deg, transparent, transparent 1px, rgba(255,255,255,.5) 1px, rgba(255,255,255,.5) 3px)"},interRegionPaddingBlock:{minHeight:"100%",backgroundColor:e.palette.text.disabled},boundaryPaddingBlock:{minHeight:"100%",backgroundColor:e.palette.action.disabledBackground}}})),u=(0,i.observer)((function(e){var t=e.block,n=e.children,r=s().classes,a=t.widthPx;return(0,o.jsx)("div",{style:{width:a},className:r.contentBlock,children:n})}));function c(e){var t=e.width,n=s().classes;return(0,o.jsx)("div",{className:n.elidedBlock,style:{width:t}})}function l(e){var t=e.boundary,n=e.width,a=e.style,i=void 0===a?{}:a,u=s().classes;return(0,o.jsx)("div",{style:(0,r.Z)((0,r.Z)({},i),{},{width:n}),className:t?u.boundaryPaddingBlock:u.interRegionPaddingBlock})}},80115:function(e,t,n){"use strict";n(30969);var r=n(90550),a=n(49841),i=n(73922),o=n(37574);function s(e,t,n,r,a){return"M"+e+","+t+"h"+(n-a)+"a"+a+","+a+" 0 0 1 "+a+","+a+"v"+(r-2*a)+"a"+a+","+a+" 0 0 1 "+-a+","+a+"h"+(a-n)+"z"}function u(e,t,n,r,a){return"M"+(e+a)+","+t+"h"+(n-a)+"v"+r+"h"+(a-n)+"a"+a+","+a+" 0 0 1 "+-a+","+-a+"v"+(2*a-r)+"a"+a+","+a+" 0 0 1 "+a+","+-a+"z"}function c(e,t,n,r){return[[e,r/2],[e+n,0],[e+n,r]].toString()}var l={gneg:"rgb(227,227,227)",gpos25:"rgb(142,142,142)",gpos50:"rgb(85,85,85)",gpos100:"rgb(0,0,0)",gpos75:"rgb(57,57,57)",gvar:"rgb(0,0,0)",stalk:"rgb(127,127,127)",acen:"#800"},d=(0,r.observer)((function(e){var t=e.overview,n=e.block,r=e.assembly,d=n.offsetPx,f=n.reversed,p=(0,i.wo)(r,n.refName),h=f?p.length-1:0,g=f?0:p.length-1,m=a.VH,v=!1;return(0,o.jsx)("g",{transform:"translate(-".concat(d,")"),children:p.map((function(e,n){var r,a,i,d=JSON.stringify(e),f=e.refName,p=e.type,y=e.start,b=e.end,w=t.bpToPx({refName:f,coord:y})||0,x=t.bpToPx({refName:f,coord:b})||0,k=Math.min(w,x),Z=Math.abs(x-w),C=l[p];return"acen"!==p||v?"acen"===p&&v?(0,o.jsx)("polygon",{points:c(w,0,Z,m),fill:C},d):h===n?(0,o.jsx)("path",{d:u(k,0,Z,m,8),fill:C},d):g===n?(0,o.jsx)("path",{d:s(k,0,Z,m,8),fill:C},d):(0,o.jsx)("rect",{x:k,y:0,width:Z,height:m,fill:C},d):(v=!0,(0,o.jsx)("polygon",{points:(r=w,a=Z,i=m,[[r,0],[r+a,i/2],[r,i]].toString()),fill:C},d))}))})}));t.Z=d},62515:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ge}});var r=n(30969),a=n(46672),i=n(33359),o=n(72097),s=n(53276),u=n(59767),c=n(90550),l=n(22417),d=n(40909),f=n(73915),p=n(81073),h=n(68079),g=n(74262),m=n(94551),v=n(9077),y=n(97891),b=n(67619),w=n(37973),x=n(76503),k=n(88581),Z=n(20331),C=n(3715),S=n(37574),T=(0,s.ZL)()((function(e){return{root:{background:(0,g.Fq)(e.palette.background.paper,.8),"&:hover":{background:e.palette.background.paper},transition:e.transitions.create(["background"],{duration:e.transitions.duration.shortest})},trackName:{margin:"0 auto",width:"90%",fontSize:"0.8rem",pointerEvents:"none"},dragHandle:{cursor:"grab"},dragHandleIcon:{display:"inline-block",verticalAlign:"middle",pointerEvents:"none"},iconButton:{padding:e.spacing(1)}}})),P=(0,c.observer)(r.forwardRef((function(e,t){var n,r=e.track,o=e.className,s=T(),c=s.classes,l=s.cx,d=(0,p.getContainingView)(r),f=(0,p.getSession)(r),g=r.configuration,P=r.minimized,M=(0,v.getConf)(r,"trackId"),R=(0,y.getTrackName)(g,f),A=[{label:P?"Restore track":"Minimize track",icon:P?C.Z:Z.Z,onClick:function(){return r.setMinimized(!P)}}].concat((0,h.Z)((null===(n=f.getTrackActionMenuItems)||void 0===n?void 0:n.call(f,g))||[]),(0,h.Z)(r.trackMenuItems())).sort((function(e,t){return((null===t||void 0===t?void 0:t.priority)||0)-((null===e||void 0===e?void 0:e.priority)||0)}));return(0,S.jsxs)(a.Z,{ref:t,className:l(o,c.root),children:[(0,S.jsx)("span",{draggable:!0,className:c.dragHandle,onDragStart:function(e){var t=e.currentTarget;if(t.parentNode){var n=t.parentNode;e.dataTransfer.setDragImage(n,20,20),d.setDraggingTrackId(r.id)}},onDragEnd:function(){return d.setDraggingTrackId(void 0)},"data-testid":"dragHandle-".concat(d.id,"-").concat(M),children:(0,S.jsx)(x.Z,{className:c.dragHandleIcon,fontSize:"small"})}),(0,S.jsx)(m.Z,{onClick:function(){return d.hideTrack(M)},className:c.iconButton,title:"close this track",children:(0,S.jsx)(k.Z,{fontSize:"small"})}),(0,S.jsx)(i.Z,{variant:"body1",component:"span",className:c.trackName,children:(0,S.jsx)(u.SanitizedHTML,{html:[R,P?"(minimized)":""].filter((function(e){return!!e})).join(" ")})}),(0,S.jsx)(b.Z,{menuItems:A,"data-testid":"track_menu_icon",children:(0,S.jsx)(w.Z,{fontSize:"small"})})]})}))),M=(0,s.ZL)()({trackLabel:{zIndex:3},trackLabelOffset:{position:"relative",display:"inline-block"},trackLabelOverlap:{position:"absolute"}}),R=(0,c.observer)((function(e){var t=e.track,n=e.view,r=M(),a=r.classes,i=r.cx,o=t.displays[0],s=a.trackLabel,u=a.trackLabelOverlap,c=a.trackLabelOffset,l="overlapping"!==n.trackLabels||o.prefersOffset?c:u;return"hidden"!==n.trackLabels?(0,S.jsx)(P,{track:t,className:i(s,l)}):null})),A=(0,s.ZL)()({renderingComponentContainer:{position:"absolute",left:-1,height:"100%",width:"100%"},trackRenderingContainer:{overflowY:"auto",overflowX:"hidden",whiteSpace:"nowrap",position:"relative",background:"none",zIndex:2}}),I=(0,c.observer)((function(e){var t=e.model,n=e.track,a=e.onDragEnter,i=A().classes,o=n.displays[0],s=o.height,c=o.RenderingComponent,l=o.DisplayBlurb,d=(0,v.getConf)(n,"trackId"),f=(0,r.useRef)(null),p=n.minimized;return(0,r.useEffect)((function(){return f.current&&(t.trackRefs[d]=f.current),function(){delete t.trackRefs[d]}}),[t.trackRefs,d]),(0,S.jsx)("div",{className:i.trackRenderingContainer,style:{height:p?20:s},onScroll:function(e){return o.setScrollTop(e.currentTarget.scrollTop)},onDragEnter:a,"data-testid":"trackRenderingContainer-".concat(t.id,"-").concat(d),children:p?null:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{ref:f,className:i.renderingComponentContainer,style:{transform:"scaleX(".concat(t.scaleFactor,")")},children:(0,S.jsx)(r.Suspense,{fallback:(0,S.jsx)(u.LoadingEllipses,{}),children:(0,S.jsx)(c,{model:o,onHorizontalScroll:t.horizontalScroll})})}),l?(0,S.jsx)("div",{style:{position:"absolute",left:0,top:o.height-20},children:(0,S.jsx)(l,{model:o})}):null]})})})),L=(0,s.ZL)()({root:{marginTop:2},resizeHandle:{height:3,boxSizing:"border-box",position:"relative",zIndex:2},overlay:{pointerEvents:"none",position:"absolute",top:0,left:0,width:"100%",zIndex:3}}),N=(0,c.observer)((function(e){var t=e.model,n=e.track,i=L().classes,o=n.displays[0],s=t.draggingTrackId,c=(0,r.useRef)(null),l=void 0!==s&&s!==o.id,h=(0,p.useDebouncedCallback)((function(){(0,d.isAlive)(o)&&l&&t.moveTrack(s,n.id)}),100);return(0,S.jsxs)(a.Z,{ref:c,className:i.root,variant:"outlined",onClick:function(e){if(2===e.detail&&!n.displays[0].featureIdUnderMouse){var r,a=(null===(r=c.current)||void 0===r?void 0:r.getBoundingClientRect().left)||0;t.zoomTo(t.bpPerPx/2,e.clientX-a,!0)}},children:[(0,S.jsx)(R,{track:n,view:t}),(0,S.jsx)(f.SV,{FallbackComponent:function(e){return(0,S.jsx)(u.ErrorMessage,{error:e.error})},children:(0,S.jsx)(I,{model:t,track:n,onDragEnter:h})}),(0,S.jsx)("div",{className:i.overlay,style:{height:o.height,background:l?"rgba(0, 0, 0, 0.4)":void 0},onDragEnter:h}),(0,S.jsx)(u.ResizeHandle,{onDrag:o.resizeHeight,className:i.resizeHandle})]})})),F=n(49841),j=n(96234),D=n(87321),B=n.n(D),E=n(73922);function V(e,t,n){var a=(0,r.useState)(),i=(0,j.Z)(a,2),o=i[0],s=i[1],u=(0,r.useState)(),c=(0,j.Z)(u,2),l=c[0],d=c[1],f=(0,r.useState)(),p=(0,j.Z)(f,2),h=p[0],g=p[1],m=(0,r.useState)(),v=(0,j.Z)(m,2),y=v[0],b=v[1],w=void 0!==o&&void 0===h;function x(t){if(!n||t.shiftKey){t.preventDefault(),t.stopPropagation();var r=(0,E.c6)(t,e.current);s(r),d(r)}}function k(t){n?t.shiftKey?b((0,E.c6)(t,e.current)):b(void 0):b((0,E.c6)(t,e.current))}function Z(){b(void 0),t.setOffsets(void 0,void 0)}function C(){g(void 0),s(void 0),d(void 0)}function S(e,t){t(),C()}(0,r.useEffect)((function(){function n(t){if(e.current&&w){var n=(0,E.c6)(t,e.current);d(n)}}function r(n){if(void 0!==o&&e.current){var r=n.clientX,a=n.clientY,i=(0,E.c6)(n,e.current);g({offsetX:i,clientX:r,clientY:a});var s=function(e){if(void 0!==o){var n=Math.min(o,e),r=Math.max(o,e);return{leftOffset:t.pxToBp(n),rightOffset:t.pxToBp(r)}}}(i);s&&t.setOffsets(s.leftOffset,s.rightOffset),b(void 0)}}return w?(window.addEventListener("mousemove",n),window.addEventListener("mouseup",r),function(){window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",r)}):function(){}}),[o,w,h,t,e]),(0,r.useEffect)((function(){!w&&void 0!==l&&void 0!==o&&Math.abs(l-o)<=3&&C()}),[w,l,o]);var T=Boolean(h);if(void 0===o)return{open:T,guideX:y,mouseDown:x,mouseMove:k,mouseOut:Z,handleMenuItemClick:S};var P=h?h.offsetX:l||0,M=P<o?P:o,R=Math.abs(P-o);return{open:T,rubberbandOn:!0,mouseDown:x,mouseMove:k,mouseOut:Z,handleClose:C,handleMenuItemClick:S,leftBpOffset:t.pxToBp(M),rightBpOffset:t.pxToBp(M+R),anchorPosition:h,numOfBpSelected:Math.ceil(R*t.bpPerPx),width:R,left:M}}var z=n(6779),O=(0,s.ZL)()({guide:{pointerEvents:"none",height:"100%",width:1,position:"absolute",zIndex:10}}),W=(0,c.observer)((function(e){var t=e.model,n=e.coordX,r=O().classes;return(0,S.jsx)(z.Z,{open:!0,placement:"top",title:(0,p.stringify)(t.pxToBp(n)),arrow:!0,children:(0,S.jsx)("div",{className:r.guide,style:{left:n,background:"red"}})})})),H=n(98598),G=(0,s.ZL)()({rubberbandControl:{cursor:"crosshair",width:"100%",minHeight:8}}),q=(0,c.observer)((function(e){var t=e.model,n=e.ControlComponent,a=void 0===n?(0,S.jsx)("div",{}):n,i=(0,r.useRef)(null),o=G().classes,s=V(i,t),c=s.guideX,l=s.rubberbandOn,d=s.leftBpOffset,f=s.rightBpOffset,p=s.numOfBpSelected,h=s.width,g=s.left,m=s.anchorPosition,v=s.handleMenuItemClick,y=s.open,b=s.handleClose,w=s.mouseMove,x=s.mouseDown,k=s.mouseOut;return(0,S.jsxs)(S.Fragment,{children:[void 0!==c?(0,S.jsx)(W,{model:t,coordX:c}):l?(0,S.jsx)(H.Z,{leftBpOffset:d,rightBpOffset:f,numOfBpSelected:p,width:h,left:g}):null,m?(0,S.jsx)(u.Menu,{anchorReference:"anchorPosition",anchorPosition:{left:m.clientX,top:m.clientY},onMenuItemClick:v,open:y,onClose:b,menuItems:t.rubberBandMenuItems()}):null,(0,S.jsx)("div",{"data-testid":"rubberband_controls",className:o.rubberbandControl,ref:i,onMouseDown:x,onMouseMove:w,onMouseOut:k,children:a})]})})),_=n(33028),U=n(59740),J=n(56891),X=n(53515),Y=n(73326),Q=["model","style","className"],K=(0,s.ZL)()((function(e){return{scalebarContainer:{overflow:"hidden",position:"relative"},scalebarZoomContainer:{position:"relative",zIndex:1},scalebar:{position:"absolute",display:"flex",pointerEvents:"none"},majorTickLabel:{fontSize:11,zIndex:1,background:e.palette.background.paper,lineHeight:"normal",pointerEvents:"none"},tick:{position:"absolute",width:0,display:"flex",justifyContent:"center",pointerEvents:"none"},refLabel:{fontSize:11,position:"absolute",left:2,top:-1,fontWeight:"bold",lineHeight:"normal",zIndex:1,pointerEvents:"none",background:e.palette.background.paper}}})),$=(0,c.observer)((function(e){var t=e.model,n=K().classes,r=0;return t.staticBlocks.forEach((function(e,n){e.offsetPx-t.offsetPx<0&&(r=n)})),(0,S.jsx)(S.Fragment,{children:t.staticBlocks.map((function(e,a){return e instanceof J.b0&&(e.isLeftEndOfDisplayedRegion||a===r)?(0,S.jsx)(i.Z,{style:{left:a===r?Math.max(0,-t.offsetPx):e.offsetPx-t.offsetPx-1,paddingLeft:a===r?0:1},className:n.refLabel,"data-testid":"refLabel-".concat(e.refName),children:e.refName},"refLabel-".concat(e.key,"-").concat(a)):null}))})})),ee=function(e){var t=e.block,n=e.bpPerPx,r=K().classes,a=t.reversed,o=t.start,s=t.end,u=(0,Y.Cz)(o,s,n,!0,!1);return(0,S.jsx)(X.b0,{block:t,children:u.map((function(e){var t=e.type,u=e.base;if("major"===t){var c=(a?s-u:u-o)/n,l=u+1;return(0,S.jsx)("div",{className:r.tick,style:{left:c},children:l?(0,S.jsx)(i.Z,{className:r.majorTickLabel,children:(0,p.getTickDisplayStr)(l,n)}):null},u)}return null}))})},te=(0,c.observer)((function(e){var t=e.model,n=t.staticBlocks,r=t.bpPerPx;return(0,S.jsx)(S.Fragment,{children:n.map((function(e,t){var n=e.key,a=e.widthPx,i="".concat(n,"-").concat(t);return e instanceof J.b0?(0,S.jsx)(ee,{block:e,bpPerPx:r},i):e instanceof J.sh?(0,S.jsx)(X.sh,{width:a},i):e instanceof J.n2?(0,S.jsx)(X.n2,{width:a,style:{background:"none"},boundary:"boundary"===e.variant},i):null}))})})),ne=(0,c.observer)(r.forwardRef((function(e,t){var n=e.model,r=e.style,i=e.className,o=(0,U.Z)(e,Q),s=K(),u=s.classes,c=s.cx,l=n.staticBlocks.offsetPx-n.offsetPx;return(0,S.jsxs)(a.Z,(0,_.Z)((0,_.Z)({"data-resizer":"true",className:c(u.scalebarContainer,i),variant:"outlined",ref:t,style:r},o),{},{children:[(0,S.jsx)("div",{className:u.scalebarZoomContainer,style:{transform:1!==n.scaleFactor?"scaleX(".concat(n.scaleFactor,")"):void 0},children:(0,S.jsx)("div",{className:u.scalebar,style:(0,_.Z)({left:l-1,width:n.staticBlocks.totalWidthPx},r),children:(0,S.jsx)(te,{model:n})})}),(0,S.jsx)($,{model:n})]}))}))),re=(0,s.ZL)()((function(e){return{verticalGuidesZoomContainer:{position:"absolute",height:"100%",width:"100%",zIndex:1,pointerEvents:"none"},verticalGuidesContainer:{position:"absolute",height:"100%",zIndex:1,pointerEvents:"none",display:"flex"},tick:{position:"absolute",height:"100%",width:1},majorTick:{background:e.palette.action.disabled},minorTick:{background:e.palette.divider}}}));function ae(e){var t=e.block,n=e.bpPerPx,r=re(),a=r.classes,i=r.cx,o=(0,Y.Cz)(t.start,t.end,n);return(0,S.jsx)(X.b0,{block:t,children:o.map((function(e){var r=e.type,o=e.base,s=(t.reversed?t.end-o:o-t.start)/n;return(0,S.jsx)("div",{className:i(a.tick,"major"===r||"labeledMajor"===r?a.majorTick:a.minorTick),style:{left:s}},o)}))})}var ie=(0,c.observer)((function(e){var t=e.model,n=t.staticBlocks,r=t.bpPerPx;return(0,S.jsx)(S.Fragment,{children:n.map((function(e,t){var n="".concat(e.key,"-").concat(t);return e instanceof J.b0?(0,S.jsx)(ae,{block:e,bpPerPx:r},n):e instanceof J.sh?(0,S.jsx)(X.sh,{width:e.widthPx},n):e instanceof J.n2?(0,S.jsx)(X.n2,{width:e.widthPx,boundary:"boundary"===e.variant},n):null}))})})),oe=(0,c.observer)((function(e){var t=e.model,n=re().classes,r=t.staticBlocks.offsetPx-t.offsetPx;return(0,S.jsx)("div",{className:n.verticalGuidesZoomContainer,style:{transform:1!==t.scaleFactor?"scaleX(".concat(t.scaleFactor,")"):void 0},children:(0,S.jsx)("div",{className:n.verticalGuidesContainer,style:{left:r,width:t.staticBlocks.totalWidthPx},children:(0,S.jsx)(ie,{model:t})})})})),se=(0,s.ZL)()((function(e){return{centerLineContainer:{background:"transparent",height:"100%",zIndex:5,position:"absolute",border:"1px ".concat(e.palette.action.active," dashed"),borderTop:"none",borderBottom:"none",pointerEvents:"none"},centerLineText:{position:"absolute",pointerEvents:"none",whiteSpace:"nowrap",fontWeight:"bold"}}})),ue=(0,c.observer)((function(e){var t=e.model,n=t.bpPerPx,a=t.centerLineInfo,i=t.trackHeights,o=t.tracks,s=t.width,u=(0,r.useRef)(null),c=se().classes,l=s/2;return o.length?(0,S.jsx)("div",{"data-testid":"centerline_container",className:c.centerLineContainer,role:"presentation",ref:u,style:{left:"".concat(l,"px"),width:Math.max(1/n,1)},children:a&&(0,S.jsxs)("div",{"data-testid":"centerline_text",className:c.centerLineText,role:"presentation",style:{left:Math.max(1/n,1)+5,top:i},children:[a.refName,":"," ",Math.max(Math.round(a.offset)+1,0)]})}):null})),ce=ue,le=(0,s.ZL)()({tracksContainer:{position:"relative",overflow:"hidden"}}),de=(0,c.observer)((function(e){var t=e.children,n=e.model,a=le().classes,i=(0,p.getEnv)(n).pluginManager,o=function(e){var t=(0,r.useState)(!1),n=(0,j.Z)(t,2),a=n[0],i=n[1],o=(0,r.useRef)(!1),s=(0,r.useRef)(0);return(0,r.useEffect)((function(){var t=function(){};function n(t){t.preventDefault();var n=t.clientX-s.current;n&&(o.current||(o.current=!0,window.requestAnimationFrame((function(){e.horizontalScroll(-n),o.current=!1,s.current=t.clientX}))))}function r(){s.current=0,a&&i(!1)}return a&&(window.addEventListener("mousemove",n,!0),window.addEventListener("mouseup",r,!0),t=function(){window.removeEventListener("mousemove",n,!0),window.removeEventListener("mouseup",r,!0)}),t}),[e,a,s]),{mouseDown:function(e){if(!e.shiftKey){var t=e.target;t.draggable||t.dataset.resizer||0===e.button&&(s.current=e.clientX,i(!0))}},mouseUp:function(e){e.preventDefault(),i(!1)}}}(n),s=o.mouseDown,c=o.mouseUp,l=(0,r.useRef)(null),d=V(l,n,!0),f=d.guideX,h=d.rubberbandOn,g=d.leftBpOffset,m=d.rightBpOffset,v=d.numOfBpSelected,y=d.width,b=d.left,w=d.anchorPosition,x=d.handleMenuItemClick,k=d.open,Z=d.handleClose,C=d.mouseMove,T=d.mouseDown;!function(e,t){var n=(0,r.useRef)(0),a=(0,r.useRef)(),i=(0,r.useRef)(!1);(0,r.useEffect)((function(){var r=e.current;function o(e){var o=B()(e);!0===e.ctrlKey?(e.preventDefault(),n.current+=o.pixelY/500,t.setScaleFactor(n.current<0?1-n.current:1/(1+n.current)),a.current&&clearTimeout(a.current),a.current=setTimeout((function(){t.setScaleFactor(1),t.zoomTo(n.current>0?t.bpPerPx*(1+n.current):t.bpPerPx/(1-n.current),e.clientX-((null===r||void 0===r?void 0:r.getBoundingClientRect().left)||0)),n.current=0}),300)):(Math.abs(o.pixelX)>Math.abs(2*o.pixelY)&&e.preventDefault(),n.current+=o.pixelX,i.current||(i.current=!0,window.requestAnimationFrame((function(){t.horizontalScroll(n.current),n.current=0,i.current=!1}))))}return r?(r.addEventListener("wheel",o),function(){r.removeEventListener("wheel",o)}):function(){}}),[t,e])}(l,n);var P=i.evaluateExtensionPoint("LinearGenomeView-TracksContainerComponent",void 0,{model:n});return(0,S.jsxs)("div",{ref:l,"data-testid":"trackContainer",className:a.tracksContainer,onMouseDown:function(e){s(e),T(e)},onMouseMove:C,onMouseUp:c,children:[n.showGridlines?(0,S.jsx)(oe,{model:n}):null,n.showCenterLine?(0,S.jsx)(ce,{model:n}):null,void 0!==f?(0,S.jsx)(W,{model:n,coordX:f}):h?(0,S.jsx)(H.Z,{leftBpOffset:g,rightBpOffset:m,numOfBpSelected:v,width:y,left:b}):null,w?(0,S.jsx)(u.Menu,{anchorReference:"anchorPosition",anchorPosition:{left:w.clientX,top:w.clientY},onMenuItemClick:x,open:k,onClose:Z,menuItems:n.rubberBandMenuItems()}):null,(0,S.jsx)(q,{model:n,ControlComponent:(0,S.jsx)(ne,{model:n,style:{height:F.n8,boxSizing:"border-box"}})}),P,t]})})),fe=(0,r.lazy)((function(){return n.e(4629).then(n.bind(n,74629))})),pe=(0,s.ZL)()((function(e){return{note:{textAlign:"center",paddingTop:e.spacing(1),paddingBottom:e.spacing(1)}}})),he=(0,c.observer)((function(e){var t=e.model,n=t.tracks,s=t.error,c=t.initialized,d=t.hasDisplayedRegions,f=pe().classes,h=(0,r.useRef)(null),g=(0,p.getSession)(t);if((0,r.useEffect)((function(){function e(e){var n,r;e.target instanceof Element&&null!==h&&void 0!==h&&null!==(n=h.current)&&void 0!==n&&n.contains(e.target)&&(null===(r=g.setFocusedViewId)||void 0===r||r.call(g,t.id))}return document.addEventListener("mousedown",e),document.addEventListener("keydown",e),function(){document.removeEventListener("mousedown",e),document.removeEventListener("keydown",e)}}),[g,t]),!c&&!s)return(0,S.jsx)(u.LoadingEllipses,{variant:"h6"});if(!d||s)return(0,S.jsx)(fe,{model:t});var m=t.MiniControlsComponent(),v=t.HeaderComponent();return(0,S.jsxs)("div",{style:{position:"relative"},ref:h,children:[(0,S.jsx)(v,{model:t}),(0,S.jsx)(m,{model:t}),(0,S.jsx)(de,{model:t,children:n.length?n.map((function(e){return(0,S.jsx)(N,{model:t,track:e},e.id)})):(0,S.jsx)(a.Z,{variant:"outlined",className:f.note,children:t.hideNoTracksActive?(0,S.jsx)("div",{style:{height:"48px"}}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(i.Z,{children:"No tracks active."}),(0,S.jsx)(o.Z,{variant:"contained",color:"primary",onClick:t.activateTrackSelector,style:{zIndex:1e3},startIcon:(0,S.jsx)(l.GD,{}),children:"Open track selector"})]})})})]})})),ge=he},29013:function(e,t,n){"use strict";n.d(t,{mg:function(){return S},ZP:function(){return M}});var r=n(33028),a=n(30969),i=n(94702),o=n(74262),s=n(33359),u=n(53276),c=n(90550),l=n(54006),d=n(81073),f=n(56891),p=n(49841),h=n(73326),g=n(96234),m=n(6779),v=n(98598),y=n(73922),b=n(37574),w=(0,u.ZL)()({rubberbandControl:{cursor:"crosshair",width:"100%",minHeight:8},guide:{pointerEvents:"none",height:"100%",width:1,position:"absolute",zIndex:10}}),x=(0,c.observer)((function(e){var t,n=e.model,r=e.open,a=e.guideX,i=e.overview,o=w().classes,s=n.cytobandOffset,u=(0,d.getSession)(n).assemblyManager,c=i.pxToBp(a-s),l=u.get(c.assemblyName),f=null===l||void 0===l||null===(t=l.cytobands)||void 0===t?void 0:t.find((function(e){return c.coord>e.get("start")&&c.coord<e.get("end")&&c.refName===l.getCanonicalRefName(e.get("refName"))}));return(0,b.jsx)(m.Z,{open:r,placement:"top",title:[(0,d.stringify)(c),null===f||void 0===f?void 0:f.get("name")].join(" "),arrow:!0,children:(0,b.jsx)("div",{className:o.guide,style:{left:a}})})})),k=(0,c.observer)((function(e){var t=e.model,n=e.overview,r=e.ControlComponent,i=void 0===r?(0,b.jsx)("div",{}):r,o=t.cytobandOffset,s=(0,a.useState)(),u=(0,g.Z)(s,2),c=u[0],l=u[1],f=(0,a.useState)(),p=(0,g.Z)(f,2),h=p[0],m=p[1],k=(0,a.useState)(),Z=(0,g.Z)(k,2),C=Z[0],S=Z[1],T=(0,a.useRef)(null),P=w().classes,M=void 0!==c;function R(e){e.preventDefault(),e.stopPropagation(),l((0,y.c6)(e,T.current))}function A(e){S((0,y.c6)(e,T.current))}function I(){S(void 0)}if((0,a.useEffect)((function(){function e(e){var t=T.current;t&&M&&m((0,y.c6)(e,t))}function r(){if(void 0!==c&&void 0!==h&&Math.abs(h-c)>3){var e=Math.min(c,h),r=Math.max(c,h);t.moveTo(n.pxToBp(e-o),n.pxToBp(r-o))}if(void 0!==c&&void 0===h){var a=n.pxToBp(c-o);a.refName?t.centerAt(Math.round(a.coord),a.refName,a.index):((0,d.getSession)(t).notify("unknown position clicked"),console.error("unknown position clicked",a))}l(void 0),m(void 0),void 0!==c&&S(void 0)}function a(e){"Escape"===e.key&&(l(void 0),m(void 0))}return M?(window.addEventListener("mousemove",e,!0),window.addEventListener("mouseup",r,!0),window.addEventListener("keydown",a,!0),function(){window.removeEventListener("mousemove",e,!0),window.removeEventListener("mouseup",r,!0),window.removeEventListener("keydown",a,!0)}):function(){}}),[M,h,c,t,n,o]),void 0===c)return(0,b.jsxs)("div",{style:{position:"relative"},children:[void 0!==C?(0,b.jsx)(x,{model:t,open:!M,overview:n,guideX:C}):null,(0,b.jsx)("div",{className:P.rubberbandControl,ref:T,onMouseDown:R,onMouseOut:I,onMouseMove:A,children:i})]});var L,N,F=c||0,j=0;if(void 0!==c&&void 0!==h&&(F=h<c?h:c,j=h-c),c&&(L=n.pxToBp(c-o),N=n.pxToBp(c+j-o),void 0!==h&&h<c)){var D=[N,L];L=D[0],N=D[1]}return(0,b.jsxs)("div",{style:{position:"relative"},children:[L&&N?(0,b.jsx)(v.Z,{leftBpOffset:L,rightBpOffset:N,width:Math.abs(j),left:F}):null,(0,b.jsx)("div",{"data-testid":"rubberband_controls",className:P.rubberbandControl,ref:T,onMouseDown:R,onMouseOut:I,onMouseMove:A,children:i})]})})),Z=n(80115),C=(0,u.ZL)()((function(e){return{scalebar:{height:p.VH},scalebarBorder:{border:"1px solid"},scalebarContig:{backgroundColor:e.palette.background.default,position:"absolute",top:0,height:p.VH,overflow:"hidden"},scalebarContigForward:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 15 9'%3E%3Cpath d='M-.1 0L6 4.5L-.1 9' fill='none' stroke='".concat(e.palette.divider,"'/%3E%3C/svg%3E\")"),backgroundRepeat:"repeat"},scalebarContigReverse:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 15 9'%3E%3Cpath d='M6 0L0 4.5L6 9' fill='none' stroke='".concat(e.palette.divider,"'/%3E%3C/svg%3E\")"),backgroundRepeat:"repeat"},scalebarRefName:{position:"absolute",fontWeight:"bold",pointerEvents:"none",zIndex:100},scalebarLabel:{height:p.VH,position:"absolute",display:"flex",justifyContent:"center",pointerEvents:"none"},scalebarVisibleRegion:{position:"absolute",height:p.VH,pointerEvents:"none",zIndex:100,border:"1px solid"},overview:{height:p.Od,position:"relative"},overviewSvg:{pointerEvents:"none",width:"100%",position:"absolute"}}})),S=(0,c.observer)((function(e){var t=e.model,n=e.overview,a=e.useOffset,s=void 0===a||a,u=(0,i.Z)(),c=Number(s),l=t.interRegionPaddingWidth,d=t.offsetPx,f=t.dynamicBlocks,h=t.cytobandOffset,g=f.contentBlocks,m=f.totalWidthPxWithoutBorders,v=u.palette,y=v.tertiary,w=v.primary,x=y?y.light:w.light;if(!g.length)return null;var k=g.at(0),Z=g.at(-1),C=(n.bpToPx((0,r.Z)((0,r.Z)({},k),{},{coord:k.reversed?k.end:k.start}))||0)+h*c,S=(n.bpToPx((0,r.Z)((0,r.Z)({},Z),{},{coord:Z.reversed?Z.start:Z.end}))||0)+h*c,T=Math.max(0,-d),P=T+m+g.length*l/2,M=[[T,p.Od],[P,p.Od],[S,0],[C,0]];return(0,b.jsx)("polygon",{points:M.toString(),fill:(0,o.Fq)(x,.3),stroke:(0,o.Fq)(x,.8)})})),T=(0,c.observer)((function(e){for(var t=e.scale,n=e.model,r=e.block,a=e.overview,o=C(),u=o.classes,c=o.cx,l=(0,i.Z)(),f=n.cytobandOffset,p=n.showCytobands,g=r.start,m=r.end,v=r.reversed,w=r.refName,x=r.assemblyName,k=(0,h._S)(t,120,15).majorPitch,S=(0,d.getSession)(n).assemblyManager.get(x),T=null===S||void 0===S?void 0:S.getRefNameColor(w),P=[],M=0;M<Math.floor((m-g)/k);M++){var R=(M+1)*k;P.push(v?m-R:g+R)}var A=p&&(0,y.wo)(S,r.refName).length;return(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Z,{style:{left:r.offsetPx+3,color:A?l.palette.text.primary:T},className:u.scalebarRefName,children:w}),(0,b.jsxs)("div",{className:c(u.scalebarContig,A?void 0:v?u.scalebarContigReverse:u.scalebarContigForward,A?void 0:u.scalebarBorder),style:{left:r.offsetPx+f,width:r.widthPx,borderColor:T},children:[A?null:P.map((function(e,n){return(0,b.jsx)(s.Z,{className:u.scalebarLabel,variant:"body2",style:{left:(n+1)*k/t,pointerEvents:"none",color:T},children:(0,d.getTickDisplayStr)(e,a.bpPerPx)},"".concat(JSON.stringify(r),"-").concat(e,"-").concat(n))})),A?(0,b.jsx)("svg",{style:{width:"100%"},children:(0,b.jsx)(Z.Z,{overview:a,assembly:S,block:r})}):null]})]})})),P=(0,c.observer)((function(e){var t=e.model,n=e.scale,a=e.overview,s=C().classes,u=(0,i.Z)(),c=t.dynamicBlocks,l=t.showCytobands,d=t.cytobandOffset,p=c.contentBlocks,h=a.dynamicBlocks,g=u.palette,m=g.tertiary,v=g.primary,y=m?m.light:v.light;if(!p.length)return null;var w=p.at(0),x=p.at(-1),k=a.bpToPx((0,r.Z)((0,r.Z)({},w),{},{coord:w.reversed?w.end:w.start}))||0,Z=a.bpToPx((0,r.Z)((0,r.Z)({},x),{},{coord:x.reversed?x.start:x.end}))||0,S=l?"#f00":y,P=l?.1:.3;return(0,b.jsxs)("div",{className:s.scalebar,children:[(0,b.jsx)("div",{className:s.scalebarVisibleRegion,style:{width:Z-k,left:k+d,background:(0,o.Fq)(S,P),borderColor:S}}),h.map((function(e,r){return e instanceof f.b0?(0,b.jsx)(T,{scale:n,block:e,model:t,overview:a},"".concat(JSON.stringify(e),"-").concat(r)):(0,b.jsx)("div",{className:s.scalebarContig,style:{width:e.widthPx,left:e.offsetPx,backgroundColor:"#999",backgroundImage:"repeating-linear-gradient(90deg, transparent, transparent 1px, rgba(255,255,255,.5) 1px, rgba(255,255,255,.5) 3px)"}},"".concat(JSON.stringify(e),"-").concat(r))}))]})})),M=(0,c.observer)((function(e){var t=e.model,n=e.children,r=C().classes,i=t.totalBp,o=t.width,s=t.cytobandOffset,u=t.displayedRegions,c=o-s,d=(0,a.useMemo)((function(){var e=l.Z.create({displayedRegions:JSON.parse(JSON.stringify(u)),interRegionPaddingWidth:0,minimumBlockWidth:t.minimumBlockWidth});return e.setVolatileWidth(c),e.showAllRegions(),e}),[JSON.stringify(u),t.minimumBlockWidth,c,u]),f=i/(c-2*(u.length-1));return(0,b.jsxs)("div",{children:[(0,b.jsx)(k,{model:t,overview:d,ControlComponent:(0,b.jsx)(P,{model:t,overview:d,scale:f})}),(0,b.jsxs)("div",{className:r.overview,children:[(0,b.jsx)("svg",{height:p.Od,className:r.overviewSvg,children:(0,b.jsx)(S,{model:t,overview:d})}),n]})]})}))},57129:function(e,t,n){"use strict";n.d(t,{Z:function(){return T}});var r=n(33028),a=n(32723),i=n(34795),o=n(96234),s=n(30969),u=n(90550),c=n(81073),l=n(52185),d=n(93954),f=n(41361),p=n(68079);function h(e,t){var n,r,a=(n=e,r=t.toLocaleLowerCase(),n.filter((function(e){var t=e.result;return t.getLabel().toLowerCase().includes(r)||t.matchedObject})));return[].concat((0,p.Z)(a.slice(0,100)),(0,p.Z)(a.length>100?[{group:"limitOption",result:new l.Z({label:"keep typing for more results"})}]:[]))}function g(e){return Object.entries(function(e){var t,n={},r=(0,f.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value,i=a.getDisplayString();n[i]||(n[i]=[]),n[i].push(a)}}catch(o){r.e(o)}finally{r.f()}return n}(e)).map((function(e){var t=(0,o.Z)(e,2),n=t[0],r=t[1];return 1===r.length?{result:r[0]}:{result:new l.Z({displayString:n,results:r,label:n})}}))}var m=n(87006),v=n(94551),y=n(4953),b=n(90713),w=n(21165),x=n(37574),k=(0,s.lazy)((function(){return n.e(8673).then(n.bind(n,98673))}));function Z(){var e=(0,s.useState)(!1),t=(0,o.Z)(e,2),n=t[0],r=t[1];return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(v.Z,{onClick:function(){return r(!0)},size:"small",children:(0,x.jsx)(w.Z,{fontSize:"small"})}),n?(0,x.jsx)(s.Suspense,{fallback:(0,x.jsx)("div",{}),children:(0,x.jsx)(k,{handleClose:function(){return r(!1)}})}):null]})}function C(e){var t=e.showHelp,n=e.endAdornment;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(y.Z,{position:"end",style:{marginRight:7},children:[(0,x.jsx)(b.Z,{fontSize:"small"}),t?(0,x.jsx)(Z,{}):null]}),n]})}function S(e){var t=e.TextFieldProps,n=e.inputBoxVal,a=e.params,i=e.showHelp,o=e.setInputValue,s=e.setCurrentSearch,u=t.helperText,c=t.InputProps,l=void 0===c?{}:c;return(0,x.jsx)(m.Z,(0,r.Z)((0,r.Z)((0,r.Z)({onBlur:function(){return o(n)}},a),t),{},{size:"small",helperText:u,InputProps:(0,r.Z)((0,r.Z)((0,r.Z)({},a.InputProps),l),{},{endAdornment:(0,x.jsx)(C,{showHelp:i,endAdornment:a.InputProps.endAdornment})}),placeholder:"Search for location",onChange:function(e){return s(e.target.value)}}))}var T=(0,u.observer)((function(e){var t,n=e.model,u=e.onSelect,f=e.assemblyName,p=e.style,m=e.fetchResults,v=e.onChange,y=e.value,b=e.showHelp,w=void 0===b||b,k=e.minWidth,Z=void 0===k?200:k,C=e.maxWidth,T=void 0===C?550:C,P=e.TextFieldProps,M=void 0===P?{}:P,R=(0,c.getSession)(n),A=R.assemblyManager,I=(0,s.useState)(!1),L=(0,o.Z)(I,2),N=L[0],F=L[1],j=(0,s.useState)(!0),D=(0,o.Z)(j,2),B=D[0],E=D[1],V=(0,s.useState)(""),z=(0,o.Z)(V,2),O=z[0],W=z[1],H=(0,s.useState)(""),G=(0,o.Z)(H,2),q=G[0],_=G[1],U=(0,s.useState)(),J=(0,o.Z)(U,2),X=J[0],Y=J[1],Q=(0,c.useDebounce)(O,300),K=f?A.get(f):void 0,$=n.coarseVisibleLocStrings,ee=n.hasDisplayedRegions;(0,s.useEffect)((function(){var e=!0;return(0,i.Z)((0,a.Z)().mark((function t(){var n;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,""!==Q&&f){t.next=3;break}return t.abrupt("return");case 3:return E(!1),t.next=6,m(Q);case 6:n=t.sent,e&&(E(!0),Y(g(n))),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),console.error(t.t0),e&&R.notify("".concat(t.t0),"error");case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))(),function(){e=!1}}),[f,m,Q,R,n]);var te=$||y||"",ne=Math.min(Math.max((0,c.measureText)(te,14)+100,Z),T);return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(d.Z,{"data-testid":"autocomplete",disableListWrap:!0,disableClearable:!0,disabled:!f,freeSolo:!0,includeInputInList:!0,selectOnFocus:!0,style:(0,r.Z)((0,r.Z)({},p),{},{width:ne}),value:te,loading:!B,inputValue:q,onInputChange:function(e,t){_(t),null===v||void 0===v||v(t)},loadingText:"loading results",open:N,onOpen:function(){return F(!0)},onClose:function(){F(!1),E(!0),ee&&(W(""),Y(void 0))},onChange:function(e,t){t&&f&&("string"===typeof t?null===u||void 0===u||u(new l.Z({label:t})):null===u||void 0===u||u(t.result),_(te))},options:null!==X&&void 0!==X&&X.length?X:(null===K||void 0===K||null===(t=K.regions)||void 0===t?void 0:t.map((function(e){return{result:new l.R({refName:e.refName,label:e.refName,matchedAttribute:"refName"})}})))||[],getOptionDisabled:function(e){return"limitOption"===e.group},filterOptions:function(e,t){return h(e,t.inputValue)},renderInput:function(e){return(0,x.jsx)(S,{showHelp:w,params:e,inputBoxVal:te,TextFieldProps:M,setCurrentSearch:W,setInputValue:_})},getOptionLabel:function(e){return"string"===typeof e?e:e.result.getDisplayString()}})})}))},98598:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(30969),a=n(53276),i=n(74262),o=n(83176),s=n(33359),u=n(81073),c=n(37574),l=(0,a.ZL)()((function(e){var t=e.palette,n=t.primary,r=t.tertiary;return{rubberband:{height:"100%",background:r?(0,i.Fq)(r.light,.7):(0,i.Fq)(n.light,.7),position:"absolute",zIndex:10,textAlign:"center",overflow:"hidden"},rubberbandControl:{cursor:"crosshair",width:"100%",minHeight:8},rubberbandText:{color:r?r.contrastText:n.contrastText},popover:{mouseEvents:"none",cursor:"crosshair"},paper:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)}}}));function d(e){var t=e.leftBpOffset,n=e.rightBpOffset,a=e.numOfBpSelected,i=e.left,d=e.width,f=(0,r.useRef)(null),p=l().classes;return(0,c.jsxs)(c.Fragment,{children:[f.current?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(o.ZP,{className:p.popover,classes:{paper:p.paper},open:!0,anchorEl:f.current,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"right"},keepMounted:!0,disableRestoreFocus:!0,children:(0,c.jsx)(s.Z,{children:(0,u.stringify)(t)})}),(0,c.jsx)(o.ZP,{className:p.popover,classes:{paper:p.paper},open:!0,anchorEl:f.current,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,disableRestoreFocus:!0,children:(0,c.jsx)(s.Z,{children:(0,u.stringify)(n)})})]}):null,(0,c.jsx)("div",{ref:f,className:p.rubberband,style:{left:i,width:d},children:a?(0,c.jsxs)(s.Z,{variant:"h6",className:p.rubberbandText,children:[(0,u.toLocale)(a)," bp"]}):null})]})}},73922:function(e,t,n){"use strict";n.d(t,{c6:function(){return d},kx:function(){return u},pG:function(){return l},wo:function(){return f}});var r=n(32723),a=n(68079),i=n(34795),o=n(81073),s=n(52185);function u(e){return c.apply(this,arguments)}function c(){return(c=(0,i.Z)((0,r.Z)().mark((function e(t){var n,i,u,c,l,d,f,p,h;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.queryString,u=t.searchType,c=t.searchScope,l=t.rankSearchResults,d=t.textSearchManager,f=t.assembly,d||console.warn("No text search manager"),e.next=4,null===d||void 0===d?void 0:d.search({queryString:i,searchType:u},c,l);case 4:return p=e.sent,h=null===f||void 0===f||null===(n=f.allRefNames)||void 0===n?void 0:n.filter((function(e){return e.toLowerCase().startsWith(i.toLowerCase())})).slice(0,10).map((function(e){return new s.Z({label:e})})),e.abrupt("return",(0,o.dedupe)([].concat((0,a.Z)(h||[]),(0,a.Z)(p||[])),(function(e){return e.getId()})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e,t){var n=e.lastIndexOf(t);return-1===n?[e,""]:[e.slice(0,n),e.slice(n+1)]}function d(e,t){return e.clientX-((null===t||void 0===t?void 0:t.getBoundingClientRect().left)||0)}function f(e,t){var n;return(null===e||void 0===e||null===(n=e.cytobands)||void 0===n?void 0:n.map((function(t){return{refName:e.getCanonicalRefName(t.get("refName"))||t.get("refName"),start:t.get("start"),end:t.get("end"),type:t.get("type")}})).filter((function(e){return e.refName===t})))||[]}},49841:function(e,t,n){"use strict";n.d(t,{Od:function(){return be},VH:function(){return we},I1:function(){return fe.default},n8:function(){return xe},N_:function(){return ke},Rj:function(){return ae},EE:function(){return Ze},FX:function(){return K},ZP:function(){return Se}});var r=n(30969),a=n(99069),i=n(96234),o=n(32723),s=n(34795),u=n(41361),c=n(68079),l=n(33028),d=n(9077),f=n(77479),p=n(29206),h=n(81073),g=n(60717),m=n(31517),v=n(97891),y=n(90689),b=n(40909),w=n(54006),x=n(68554),k=n(21918),Z=n(39554),C=n.n(Z),S=n(22417),T=n(72965),P=n(41174),M=n(66680),R=n(77879),A=n(69416),I=n(16888),L=n(56521),N=n(90550),F=n(46672),j=n(94551),D=n(74424),B=n(96979),E=n(67619),V=n(53276),z=n(37574),O=(0,V.ZL)()((function(e){return{background:{position:"absolute",right:0,zIndex:1001,background:e.palette.background.paper},focusedBackground:{background:e.palette.secondary.light,svg:{fill:e.palette.secondary.contrastText}}}})),W=(0,N.observer)((function(e){var t=e.model,n=O(),r=n.classes,a=n.cx,i=t.id,o=t.bpPerPx,s=t.maxBpPerPx,u=t.minBpPerPx,c=t.scaleFactor,l=t.hideHeader,d=(0,h.getSession)(t).focusedViewId;return l?(0,z.jsxs)(F.Z,{className:a(r.background,d===i?r.focusedBackground:void 0),children:[(0,z.jsx)(E.Z,{menuItems:t.menuItems(),children:(0,z.jsx)(B.Z,{fontSize:"small"})}),(0,z.jsx)(j.Z,{"data-testid":"zoom_out",onClick:function(){return t.zoom(2*o)},disabled:o>=s-1e-4||1!==c,children:(0,z.jsx)(D.Z,{fontSize:"small"})}),(0,z.jsx)(j.Z,{"data-testid":"zoom_in",onClick:function(){return t.zoom(o/2)},disabled:o<=u+1e-4||1!==c,children:(0,z.jsx)(I.Z,{fontSize:"small"})})]}):null})),H=n(74262),G=n(72097),q=n(33359),_=n(21098),U=n(88412),J=n(26804),X=n(29013),Y=n(30762),Q=(0,V.ZL)()((function(e){return{container:{display:"flex",flexDirection:"row",alignItems:"center"},slider:{width:70,color:e.palette.text.secondary}}})),K=(0,N.observer)((function(e){var t=e.model,n=Q().classes,a=t.maxBpPerPx,o=t.minBpPerPx,s=t.bpPerPx,u=t.scaleFactor,c=(0,r.useState)(100*-Math.log2(s)),l=(0,i.Z)(c,2),d=l[0],f=l[1];return(0,r.useEffect)((function(){f(100*-Math.log2(s))}),[f,s]),(0,z.jsxs)("div",{className:n.container,children:[(0,z.jsx)(j.Z,{"data-testid":"zoom_out",onClick:function(){return t.zoom(2*s)},disabled:s>=a-1e-4||1!==u,size:"large",children:(0,z.jsx)(D.Z,{})}),(0,z.jsx)(Y.ZP,{size:"small",className:n.slider,value:d,min:100*-Math.log2(a),max:100*-Math.log2(o),onChange:function(e,t){return f(t)},onChangeCommitted:function(){return t.zoomTo(Math.pow(2,-d/100))},disabled:1!==u}),(0,z.jsx)(j.Z,{"data-testid":"zoom_in",onClick:function(){return t.zoom(t.bpPerPx/2)},disabled:s<=o+1e-4||1!==u,size:"large",children:(0,z.jsx)(I.Z,{})})]})})),$=n(94702),ee=n(57129),te=n(73922),ne=(0,V.ZL)()((function(){return{headerRefName:{minWidth:100}}})),re=(0,N.observer)((function(e){var t=e.model,n=e.showHelp,r=ne().classes,a=(0,$.Z)(),u=(0,h.getSession)(t),c=u.textSearchManager,l=u.assemblyManager,d=t.assemblyNames,f=t.rankSearchResults,p=d[0],g=l.get(p),m=t.searchScope(p);function v(e){return y.apply(this,arguments)}function y(){return(y=(0,s.Z)((0,o.Z)().mark((function e(n){var r,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.getLocation(),a=n.getTrackId(),!r){e.next=6;break}return e.next=5,t.navToLocString(r,p);case 5:a&&t.showTrack(a);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return(b=(0,s.Z)((0,o.Z)().mark((function e(n){var r,a,s,l,d,h,y,b;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n.hasLocation()){e.next=6;break}return e.next=4,v(n);case 4:e.next=32;break;case 6:if(null===(r=n.results)||void 0===r||!r.length){e.next=10;break}t.setSearchResults(n.results,n.getLabel()),e.next=32;break;case 10:if(a=n.getLabel(),s=(0,te.pG)(a,":"),l=(0,i.Z)(s,2),d=l[0],h=l[1],!((y=(null===g||void 0===g?void 0:g.allRefNamesWithLowerCase)||[]).includes(a)||y.includes(d)&&!Number.isNaN(Number.parseInt(h,10)))){e.next=18;break}return e.next=16,t.navToLocString(a,p);case 16:e.next=32;break;case 18:return e.next=20,(0,te.kx)({queryString:a,searchType:"exact",searchScope:m,rankSearchResults:f,textSearchManager:c,assembly:g});case 20:if(!((b=e.sent).length>1)){e.next=25;break}t.setSearchResults(b,a.toLowerCase()),e.next=32;break;case 25:if(1!==b.length){e.next=30;break}return e.next=28,v(b[0]);case 28:e.next=32;break;case 30:return e.next=32,t.navToLocString(a,p);case 32:e.next=38;break;case 34:e.prev=34,e.t0=e.catch(0),console.error(e.t0),u.notify("".concat(e.t0),"warning");case 38:case"end":return e.stop()}}),e,null,[[0,34]])})))).apply(this,arguments)}return(0,z.jsx)(ee.Z,{showHelp:n,onSelect:function(e){return b.apply(this,arguments)},assemblyName:p,fetchResults:function(e){return(0,te.kx)({queryString:e,searchScope:m,rankSearchResults:f,textSearchManager:c,assembly:g})},model:t,minWidth:175,TextFieldProps:{variant:"outlined",className:r.headerRefName,style:{margin:ke},InputProps:{style:{padding:0,height:Ze,background:(0,H.Fq)(a.palette.background.paper,.8)}}}})})),ae=re,ie=(0,V.ZL)()((function(e){return{headerBar:{display:"flex"},headerForm:{flexWrap:"nowrap",marginRight:7},spacer:{flexGrow:1},panButton:{background:(0,H.Fq)(e.palette.background.paper,.8),color:e.palette.text.primary,margin:ke},bp:{display:"flex",alignItems:"center",marginLeft:5},toggleButton:{height:44,border:"none",marginLeft:e.spacing(4)},buttonSpacer:{marginRight:e.spacing(2)}}})),oe=(0,N.observer)((function(e){var t=e.model,n=ie().classes;return(0,z.jsx)(j.Z,{onClick:t.activateTrackSelector,className:n.toggleButton,title:"Open track selector",value:"track_select",children:(0,z.jsx)(S.GD,{className:n.buttonSpacer})})}));function se(e){var t=e.model,n=ie().classes;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(G.Z,{variant:"outlined",className:n.panButton,onClick:function(){return t.slide(-.9)},children:(0,z.jsx)(J.Z,{})}),(0,z.jsx)(G.Z,{variant:"outlined",className:n.panButton,onClick:function(){return t.slide(.9)},children:(0,z.jsx)(U.Z,{})})]})}var ue=(0,N.observer)((function(e){var t=e.model,n=ie().classes,r=t.coarseTotalBp;return(0,z.jsx)(q.Z,{variant:"body2",color:"textSecondary",className:n.bp,children:(0,h.getBpDisplayStr)(r)})})),ce=function(e){var t=e.model,n=ie().classes;return(0,z.jsxs)("div",{className:n.headerBar,children:[(0,z.jsx)(oe,{model:t}),(0,z.jsx)("div",{className:n.spacer}),(0,z.jsxs)(_.Z,{row:!0,className:n.headerForm,children:[(0,z.jsx)(se,{model:t}),(0,z.jsx)(ae,{model:t})]}),(0,z.jsx)(ue,{model:t}),(0,z.jsx)(K,{model:t}),(0,z.jsx)("div",{className:n.spacer})]})},le=(0,N.observer)((function(e){var t=e.model;return t.hideHeader?null:t.hideHeaderOverview?(0,z.jsx)(ce,{model:t}):(0,z.jsx)(X.ZP,{model:t,children:(0,z.jsx)(ce,{model:t})})})),de=n(73326),fe=n(62515),pe=(n(22875),(0,r.lazy)((function(){return Promise.resolve().then(n.bind(n,91583))}))),he=(0,r.lazy)((function(){return n.e(66).then(n.bind(n,10066))})),ge=(0,r.lazy)((function(){return n.e(6252).then(n.bind(n,6252))})),me=(0,r.lazy)((function(){return n.e(5446).then(n.bind(n,25446))})),ve=(0,r.lazy)((function(){return n.e(184).then(n.bind(n,10184))}));function ye(e){if(!e.length)return"";var t=e.every((function(t){return t.assemblyName===e[0].assemblyName}));return e.map((function(e){return(0,h.assembleLocString)((0,l.Z)((0,l.Z)({},e),{},{start:Math.round(e.start),end:Math.round(e.end),assemblyName:t?void 0:e.assemblyName}))})).join(" ")}var be=48,we=20,xe=17,ke=7,Ze=32;function Ce(e){return b.types.compose(f.BaseViewModel,b.types.model("LinearGenomeView",{id:p.ElementId,type:b.types.literal("LinearGenomeView"),offsetPx:0,bpPerPx:1,displayedRegions:b.types.array(p.Region),tracks:b.types.array(e.pluggableMstType("track","stateModel")),hideHeader:!1,hideHeaderOverview:!1,hideNoTracksActive:!1,trackSelectorType:b.types.optional(b.types.enumeration(["hierarchical"]),"hierarchical"),trackLabels:b.types.optional(b.types.string,(function(){return(0,h.localStorageGetItem)("lgv-trackLabels")||"overlapping"})),showCenterLine:b.types.optional(b.types.boolean,(function(){return Boolean(JSON.parse((0,h.localStorageGetItem)("lgv-showCenterLine")||"false"))})),showCytobandsSetting:b.types.optional(b.types.boolean,(function(){return Boolean(JSON.parse((0,h.localStorageGetItem)("lgv-showCytobands")||"true"))})),showGridlines:!0})).volatile((function(){return{volatileWidth:void 0,minimumBlockWidth:3,draggingTrackId:void 0,volatileError:void 0,afterDisplayedRegionsSetCallbacks:[],scaleFactor:1,trackRefs:{},coarseDynamicBlocks:[],coarseTotalBp:0,leftOffset:void 0,rightOffset:void 0}})).views((function(e){return{get width(){if(void 0===e.volatileWidth)throw new Error("width undefined, make sure to check for model.initialized");return e.volatileWidth},get interRegionPaddingWidth(){return 2},get assemblyNames(){return(0,c.Z)(new Set(e.displayedRegions.map((function(e){return e.assemblyName}))))}}})).views((function(e){return{MiniControlsComponent:function(){return W},HeaderComponent:function(){return le},get assemblyErrors(){var t=(0,h.getSession)(e).assemblyManager;return e.assemblyNames.map((function(e){var n;return null===(n=t.get(e))||void 0===n?void 0:n.error})).filter((function(e){return!!e})).join(", ")},get assembliesInitialized(){var t=(0,h.getSession)(e).assemblyManager;return e.assemblyNames.every((function(e){var n;return null===(n=t.get(e))||void 0===n?void 0:n.initialized}))},get initialized(){return void 0!==e.volatileWidth&&this.assembliesInitialized},get hasDisplayedRegions(){return e.displayedRegions.length>0},get scaleBarHeight(){return xe+3},get headerHeight(){return e.hideHeader?0:e.hideHeaderOverview?be:be+we},get trackHeights(){return(0,h.sum)(e.tracks.map((function(e){return e.displays[0].height})))},get trackHeightsWithResizeHandles(){return this.trackHeights+3*e.tracks.length},get height(){return this.trackHeightsWithResizeHandles+this.headerHeight+this.scaleBarHeight},get totalBp(){return e.displayedRegions.reduce((function(e,t){return e+t.end-t.start}),0)},get maxBpPerPx(){return this.totalBp/(.9*e.width)},get minBpPerPx(){return.02},get error(){return e.volatileError||this.assemblyErrors},get maxOffset(){return this.displayedRegionsTotalPx-10},get minOffset(){return 30-e.width},get displayedRegionsTotalPx(){return this.totalBp/e.bpPerPx},renderProps:function(){return(0,l.Z)((0,l.Z)({},(0,v.getParentRenderProps)(e)),{},{bpPerPx:e.bpPerPx,highResolutionScaling:(0,d.getConf)((0,h.getSession)(e),"highResolutionScaling")})},searchScope:function(t){return{assemblyName:t,includeAggregateIndexes:!0,tracks:e.tracks}},getTrack:function(t){return e.tracks.find((function(e){return e.configuration.trackId===t}))},rankSearchResults:function(t){var n,r=new Set(e.tracks.map((function(e){return e.configuration.trackId}))),a=(0,u.Z)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;r.has(i.trackId)&&i.updateScore(i.getScore()+1)}}catch(o){a.e(o)}finally{a.f()}return t},rewriteOnClicks:function(t,n){var r=this;n.forEach((function(n){if("subMenu"in n&&r.rewriteOnClicks(t,n.subMenu),"onClick"in n){var a=n.onClick;n.onClick=function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.tracks.forEach((function(e){e.type===t&&a.apply(e,[e].concat(r))}))}}}))},get trackTypeActions(){var t=this,n=new Map;return e.tracks.forEach((function(e){if(!n.get(e.type)){var r=C()(e.viewMenuActions);t.rewriteOnClicks(e.type,r),n.set(e.type,r)}})),n}}})).actions((function(t){return{setShowCytobands:function(e){t.showCytobandsSetting=e},setWidth:function(e){t.volatileWidth=e},setError:function(e){t.volatileError=e},toggleHeader:function(){t.hideHeader=!t.hideHeader},toggleHeaderOverview:function(){t.hideHeaderOverview=!t.hideHeaderOverview},toggleNoTracksActive:function(){t.hideNoTracksActive=!t.hideNoTracksActive},toggleShowGridlines:function(){t.showGridlines=!t.showGridlines},scrollTo:function(e){var n=(0,h.clamp)(e,t.minOffset,t.maxOffset);return t.offsetPx=n,n},zoomTo:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.width/2,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=(0,h.clamp)(e,t.minBpPerPx,t.maxBpPerPx);if(a===t.bpPerPx)return a;var i=t.bpPerPx;return Math.abs(i-a)<1e-6?(console.warn("zoomTo bpPerPx rounding error"),i):(t.bpPerPx=a,this.scrollTo(Math.round((t.offsetPx+n)*i/a-(r?t.width/2:n))),a)},setOffsets:function(e,n){t.leftOffset=e,t.rightOffset=n},setSearchResults:function(e,n,r){(0,h.getSession)(t).queueDialog((function(a){return[ve,{model:t,searchResults:e,searchQuery:n,handleClose:a,assemblyName:r}]}))},setNewView:function(e,t){this.zoomTo(e),this.scrollTo(t)},horizontallyFlip:function(){t.displayedRegions=(0,b.cast)((0,c.Z)(t.displayedRegions).reverse().map((function(e){return(0,l.Z)((0,l.Z)({},e),{},{reversed:!e.reversed})}))),this.scrollTo(t.totalBp/t.bpPerPx-t.offsetPx-t.width)},showTrack:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=e.pluggableConfigSchemaType("track"),o=(0,b.resolveIdentifier)(i,(0,b.getRoot)(t),n);if(!o)throw new Error('Could not resolve identifier "'.concat(n,'"'));var s=e.getTrackType(null===o||void 0===o?void 0:o.type);if(!s)throw new Error("Unknown track type ".concat(o.type));var u=e.getViewType(t.type),c=new Set(u.displayTypes.map((function(e){return e.name}))),d=o.displays.find((function(e){return c.has(e.type)}));if(!d)throw new Error("Could not find a compatible display for view type ".concat(t.type));var f=t.tracks.filter((function(e){return e.configuration===o}));if(0===f.length){var p=s.stateModel.create((0,l.Z)((0,l.Z)({},r),{},{type:o.type,configuration:o,displays:[(0,l.Z)({type:d.type,configuration:d},a)]}));return t.tracks.push(p),p}return f[0]},hideTrack:function(n){var r=e.pluggableConfigSchemaType("track"),a=(0,b.resolveIdentifier)(r,(0,b.getRoot)(t),n),i=t.tracks.filter((function(e){return e.configuration===a}));return(0,y.transaction)((function(){return i.forEach((function(e){return t.tracks.remove(e)}))})),i.length}}})).actions((function(e){return{moveTrack:function(t,n){var r=e.tracks.findIndex((function(e){return e.id===t}));if(-1===r)throw new Error("Track ID ".concat(t," not found"));var a=e.tracks.findIndex((function(e){return e.id===n}));if(-1===a)throw new Error("Track ID ".concat(n," not found"));var i=(0,b.getSnapshot)(e.tracks[r]);e.tracks.splice(r,1),e.tracks.splice(a,0,i)},closeView:function(){var t=(0,h.getContainingView)(e);t?(0,h.isViewContainer)(t)&&t.removeView(e):(0,h.getSession)(e).removeView(e)},toggleTrack:function(t){e.hideTrack(t)||e.showTrack(t)},setTrackLabels:function(t){e.trackLabels=t},toggleCenterLine:function(){e.showCenterLine=!e.showCenterLine},setDisplayedRegions:function(t){e.displayedRegions=(0,b.cast)(t),e.zoomTo(e.bpPerPx)},activateTrackSelector:function(){if("hierarchical"===e.trackSelectorType){var t=(0,h.getSession)(e);if((0,h.isSessionModelWithWidgets)(t)){var n=t.addWidget("HierarchicalTrackSelectorWidget","hierarchicalTrackSelector",{view:e});return t.showWidget(n),n}}throw new Error("invalid track selector type ".concat(e.trackSelectorType))},getSelectedRegions:function(t,n){var r=(0,b.getSnapshot)(e),a=w.Z.create((0,l.Z)((0,l.Z)({},r),{},{interRegionPaddingWidth:e.interRegionPaddingWidth}));return a.setVolatileWidth(e.width),a.moveTo(t,n),a.dynamicBlocks.contentBlocks.map((function(e){return(0,l.Z)((0,l.Z)({},e),{},{start:Math.floor(e.start),end:Math.ceil(e.end)})}))},afterDisplayedRegionsSet:function(t){e.afterDisplayedRegionsSetCallbacks.push(t)},horizontalScroll:function(t){var n=e.offsetPx;return e.scrollTo(e.offsetPx+t)-n},center:function(){var t=e.totalBp/2/e.bpPerPx;e.scrollTo(Math.round(t-e.width/2))},showAllRegions:function(){e.zoomTo(e.maxBpPerPx),this.center()},showAllRegionsInAssembly:function(t){var n=(0,h.getSession)(e),r=n.assemblyManager;if(!t){var a=new Set(e.displayedRegions.map((function(e){return e.assemblyName})));if(a.size>1)return void n.notify("Can't perform operation with multiple assemblies currently");t=(0,c.Z)(a)[0]}var i=r.get(t);if(i){var o=i.regions;o&&(this.setDisplayedRegions(o),e.zoomTo(e.maxBpPerPx),this.center())}},setDraggingTrackId:function(t){e.draggingTrackId=t},setScaleFactor:function(t){e.scaleFactor=t},clearView:function(){this.setDisplayedRegions([]),e.tracks.clear(),e.scrollTo(0),e.zoomTo(10)},exportSvg:function(){var t=arguments;return(0,s.Z)((0,o.Z)().mark((function r(){var a,i,s,u,c;return(0,o.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=t.length>0&&void 0!==t[0]?t[0]:{},r.next=3,Promise.resolve().then(n.bind(n,22875));case 3:return i=r.sent,s=i.renderToSvg,r.next=7,s(e,a);case 7:u=r.sent,c=new Blob([u],{type:"image/svg+xml"}),(0,k.saveAs)(c,a.filename||"image.svg");case 10:case"end":return r.stop()}}),r)})))()}}})).actions((function(e){var t=function(){};return{slide:function(n){var r=(0,h.springAnimate)(e.offsetPx,e.offsetPx+e.width*n,e.scrollTo),a=(0,i.Z)(r,2),o=a[0],s=a[1];t(),t=s,o()}}})).actions((function(e){var t=function(){};return{zoom:function(n){if(e.zoomTo(e.bpPerPx),!(n<e.bpPerPx&&e.bpPerPx===e.minBpPerPx||n>e.bpPerPx&&e.bpPerPx===e.maxBpPerPx)){var r=e.bpPerPx/n,a=(0,h.springAnimate)(1,r,e.setScaleFactor,(function(){e.zoomTo(n),e.setScaleFactor(1)})),o=(0,i.Z)(a,2),s=o[0],u=o[1];t(),t=u,s()}}}})).views((function(e){return{get canShowCytobands(){return 1===e.displayedRegions.length&&this.anyCytobandsExist},get showCytobands(){return this.canShowCytobands&&e.showCytobandsSetting},get anyCytobandsExist(){var t=(0,h.getSession)(e).assemblyManager;return e.assemblyNames.some((function(e){var n,r;return null===(n=t.get(e))||void 0===n||null===(r=n.cytobands)||void 0===r?void 0:r.length}))},get cytobandOffset(){return this.showCytobands?(0,h.measureText)(e.displayedRegions[0].refName,12)+15:0}}})).views((function(e){return{menuItems:function(){var t,n=e.canShowCytobands,r=e.showCytobands,a=(0,h.getSession)(e),o=[{label:"Return to import form",onClick:function(){(0,h.getSession)(e).queueDialog((function(t){return[pe,{model:e,handleClose:t}]}))},icon:R.Z}].concat((0,c.Z)((0,h.isSessionWithAddTracks)(a)?[{label:"Sequence search",onClick:function(){(0,h.getSession)(e).queueDialog((function(t){return[he,{model:e,handleClose:t}]}))}}]:[]),[{label:"Export SVG",icon:A.Z,onClick:function(){(0,h.getSession)(e).queueDialog((function(t){return[ge,{model:e,handleClose:t}]}))}},{label:"Open track selector",onClick:e.activateTrackSelector,icon:S.GD},{label:"Horizontally flip",icon:T.Z,onClick:e.horizontallyFlip},{label:"Show...",icon:P.Z,subMenu:[{label:"Show all regions in assembly",onClick:e.showAllRegionsInAssembly},{label:"Show center line",type:"checkbox",checked:e.showCenterLine,onClick:e.toggleCenterLine},{label:"Show header",type:"checkbox",checked:!e.hideHeader,onClick:e.toggleHeader},{label:"Show header overview",type:"checkbox",checked:!e.hideHeaderOverview,onClick:e.toggleHeaderOverview,disabled:e.hideHeader},{label:"Show no tracks active button",type:"checkbox",checked:!e.hideNoTracksActive,onClick:e.toggleNoTracksActive},{label:"Show guidelines",type:"checkbox",checked:e.showGridlines,onClick:e.toggleShowGridlines}].concat((0,c.Z)(n?[{label:"Show ideogram",type:"checkbox",checked:e.showCytobands,onClick:function(){return e.setShowCytobands(!r)}}]:[]))},{label:"Track labels",icon:M.Z,subMenu:[{label:"Overlapping",icon:P.Z,type:"radio",checked:"overlapping"===e.trackLabels,onClick:function(){return e.setTrackLabels("overlapping")}},{label:"Offset",icon:P.Z,type:"radio",checked:"offset"===e.trackLabels,onClick:function(){return e.setTrackLabels("offset")}},{label:"Hidden",icon:P.Z,type:"radio",checked:"hidden"===e.trackLabels,onClick:function(){return e.setTrackLabels("hidden")}}]}]),s=(0,u.Z)(e.trackTypeActions.entries());try{for(s.s();!(t=s.n()).done;){var l=(0,i.Z)(t.value,2),d=l[0],f=l[1];f.length&&(o.push({type:"divider"},{type:"subHeader",label:d}),f.forEach((function(e){return o.push(e)})))}}catch(p){s.e(p)}finally{s.f()}return o}}})).views((function(e){var t,n="";return{get staticBlocks(){var r=(0,m.Z)(e),a=JSON.stringify(r);return n!==a&&(t=r,n=a),t},get dynamicBlocks(){return(0,g.Z)(e)},get roundedDynamicBlocks(){return this.dynamicBlocks.contentBlocks.map((function(e){return(0,l.Z)((0,l.Z)({},e),{},{start:Math.floor(e.start),end:Math.ceil(e.end)})}))},get visibleLocStrings(){return ye(this.dynamicBlocks.contentBlocks)},get coarseVisibleLocStrings(){return ye(e.coarseDynamicBlocks)}}})).actions((function(e){return{setCoarseDynamicBlocks:function(t){e.coarseDynamicBlocks=t.contentBlocks,e.coarseTotalBp=t.totalBp},afterAttach:function(){var t=this;(0,b.addDisposer)(e,(0,y.autorun)((function(){e.initialized&&t.setCoarseDynamicBlocks(e.dynamicBlocks)}),{delay:150})),(0,b.addDisposer)(e,(0,y.autorun)((function(){var t=function(e){return JSON.stringify(e)},n=e.trackLabels,r=e.showCytobandsSetting,a=e.showCenterLine;"undefined"!==typeof localStorage&&(localStorage.setItem("lgv-trackLabels",n),localStorage.setItem("lgv-showCytobands",t(r)),localStorage.setItem("lgv-showCenterLine",t(a)))})))}}})).actions((function(e){return{moveTo:function(t,n){(0,x.Ao)(e,t,n)},navToLocString:function(t,n){var r=this;return(0,s.Z)((0,o.Z)().mark((function a(){var i,s,u,c,l;return(0,o.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(i=e.assemblyNames,s=(0,h.getSession)(e),u=s.assemblyManager,c=u.isValidRefName,!(l=n||i[0])){a.next=7;break}return a.next=7,u.waitForAssembly(l);case 7:return a.abrupt("return",r.navToLocations((0,de.nT)(t,l,c),l));case 8:case"end":return a.stop()}}),a)})))()},navToLocations:function(t,n){var r=this;return(0,s.Z)((0,o.Z)().mark((function a(){var i,s,u,c,d,f,p,g;return(0,o.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i=(0,h.getSession)(e),s=i.assemblyManager,a.next=3,(0,y.when)((function(){return void 0!==e.volatileWidth}));case 3:return a.next=5,(0,de.Gc)(t,s,n);case 5:1===(u=a.sent).length?(c=u[0],d=c.reversed,f=c.parentRegion,p=c.start,g=c.end,e.setDisplayedRegions([(0,l.Z)({reversed:d},f)]),r.navTo((0,l.Z)((0,l.Z)({},c),{},{start:(0,h.clamp)(null!==p&&void 0!==p?p:0,0,f.end),end:(0,h.clamp)(null!==g&&void 0!==g?g:f.end,0,f.end)}))):(e.setDisplayedRegions(u.map((function(e){return void 0===e.start?e.parentRegion:e}))),e.showAllRegions());case 7:case"end":return a.stop()}}),a)})))()},navTo:function(e){this.navToMultiple([e])},navToMultiple:function(t){if(t.some((function(e){return void 0!==e.start&&void 0!==e.end&&e.start>e.end})))throw new Error("found start greater than end");var n=t.at(0),r=t.at(-1);if(n&&r){var a=e.assemblyNames[0],i=(0,h.getSession)(e).assemblyManager,o=i.get(n.assemblyName||a),s=i.get(r.assemblyName||a),u=(null===o||void 0===o?void 0:o.getCanonicalRefName(n.refName))||n.refName,c=(null===s||void 0===s?void 0:s.getCanonicalRefName(r.refName))||r.refName,l=e.displayedRegions.find((function(e){return e.refName===u})),d=(0,h.findLast)(e.displayedRegions,(function(e){return e.refName===c}));if(!l)throw new Error('could not find a region with refName "'.concat(u,'"'));if(!d)throw new Error('could not find a region with refName "'.concat(c,'"'));var f=void 0===n.start?l.start:n.start,p=void 0===n.end?l.end:n.end,g=void 0===r.start?d.start:r.start,m=void 0===r.end?d.end:r.end,v=e.displayedRegions.findIndex((function(e){return u===e.refName&&f>=e.start&&f<=e.end&&p<=e.end&&p>=e.start})),y=e.displayedRegions.findIndex((function(e){return c===e.refName&&g>=e.start&&g<=e.end&&m<=e.end&&m>=e.start}));if(-1===v||-1===y)throw new Error('could not find a region that contained "'.concat(t.map((function(e){return(0,h.assembleLocString)(e)})),'"'));var b=e.displayedRegions[v],w=e.displayedRegions[y];this.moveTo({index:v,offset:b.reversed?b.end-p:f-b.start},{index:y,offset:w.reversed?w.end-g:m-w.start})}}}})).views((function(e){return{rubberBandMenuItems:function(){return[{label:"Zoom to region",icon:I.Z,onClick:function(){return e.moveTo(e.leftOffset,e.rightOffset)}},{label:"Get sequence",icon:L.Z,onClick:function(){return(0,h.getSession)(e).queueDialog((function(t){return[me,{model:e,handleClose:t}]}))}}]},bpToPx:function(t){var n=t.refName,r=t.coord,a=t.regionNumber;return(0,x.R)({refName:n,coord:r,regionNumber:a,self:e})},centerAt:function(t,n,r){var a=this.bpToPx({refName:n,coord:t,regionNumber:r});void 0!==a&&e.scrollTo(Math.round(a.offsetPx-e.width/2))},pxToBp:function(t){return(0,x.j4)(e,t)},get centerLineInfo(){return e.displayedRegions.length>0?this.pxToBp(e.width/2):void 0}}})).actions((function(e){return{afterCreate:function(){function t(t){(0,h.getSession)(e).focusedViewId===e.id&&(t.ctrlKey||t.metaKey)&&("ArrowLeft"===t.code&&(t.preventDefault(),e.slide(-.9)),"ArrowRight"===t.code&&(t.preventDefault(),e.slide(.9)),"ArrowUp"===t.code&&1===e.scaleFactor&&(t.preventDefault(),e.zoom(e.bpPerPx/2)),"ArrowDown"===t.code&&1===e.scaleFactor&&(t.preventDefault(),e.zoom(2*e.bpPerPx)))}document.addEventListener("keydown",t),(0,b.addDisposer)(e,(function(){document.removeEventListener("keydown",t)}))}}}))}var Se=function(e){e.addViewType((function(){return new a.ViewType({name:"LinearGenomeView",displayName:"Linear genome view",stateModel:Ce(e),ReactComponent:(0,r.lazy)((function(){return Promise.resolve().then(n.bind(n,62515))}))})}))}},22875:function(e,t,n){"use strict";n.r(t),n.d(t,{SVGRuler:function(){return C},SVGTracks:function(){return v},renderToSvg:function(){return M},totalHeight:function(){return P}});var r=n(32723),a=n(33028),i=n(34795),o=(n(30969),n(2082)),s=n(90689),u=n(81073),c=n(75844),l=n(59767),d=n(94702),f=n(37574);function p(e){var t=e.width,n=e.height,r=e.shift,a=(0,d.Z)();return(0,f.jsx)("rect",{width:t+2*r,height:n,fill:(0,u.stripAlpha)(a.palette.background.default)})}var h=n(97891);function g(e){var t=e.model,n=e.height,r=t.dynamicBlocks,a=t.offsetPx,i=t.interRegionPaddingWidth;return(0,f.jsx)(f.Fragment,{children:r.contentBlocks.slice(1).map((function(e){return(0,f.jsx)("rect",{x:e.offsetPx-a-i,width:i,y:0,height:n,fill:"grey"},e.key)}))})}function m(e){var t=e.trackLabels,n=e.trackName,r=e.fontSize,a=e.trackLabelOffset,i=e.x,o=(0,d.Z)().palette.text.primary,s="overlay"===t?5:0,u="offset"===t?5:0;return"none"!==t?(0,f.jsx)("g",{children:"left"===t?(0,f.jsx)("text",{x:a-40,y:20,fill:o,fontSize:r,dominantBaseline:"hanging",textAnchor:"end",children:n}):(0,f.jsx)("text",{x:i+s,y:u,fill:o,fontSize:r,dominantBaseline:"hanging",children:n})}):null}function v(e){var t=e.displayResults,n=e.model,r=e.offset,a=e.textHeight,i=e.fontSize,o=e.trackLabels,s=void 0===o?"offset":o,c=e.trackLabelOffset,l=void 0===c?0:c,d=(0,u.getSession)(n),p="offset"===s?a:0;return(0,f.jsx)(f.Fragment,{children:t.map((function(e){var t=e.track,a=e.result,o=r,u=t.configuration,c=(0,h.getTrackName)(u,d),v=t.displays[0],y=Math.max(-n.offsetPx,0);return r+=v.height+p,(0,f.jsxs)("g",{transform:"translate(0 ".concat(o,")"),children:[(0,f.jsxs)("g",{transform:"translate(".concat(l," ").concat(p,")"),children:[(0,f.jsx)(g,{model:n,height:v.height}),a]}),(0,f.jsx)(m,{trackName:c,fontSize:i,trackLabels:s,trackLabelOffset:l,x:y})]},u.trackId)}))})}var y=n(54006),b=n(49841),w=n(80115),x=n(29013),k=n(73326);function Z(e){var t=e.start,n=e.end,r=e.bpPerPx,a=e.reversed,i=void 0!==a&&a,o=e.major,s=void 0===o||o,c=e.minor,l=void 0===c||c,p=e.hideText,h=void 0!==p&&p,g=(0,k.Cz)(t,n,r,s,l),m=(0,d.Z)(),v=(0,u.stripAlpha)(m.palette.text.secondary);return(0,f.jsxs)(f.Fragment,{children:[g.map((function(e){var a=(i?n-e.base:e.base-t)/r;return(0,f.jsx)("line",{x1:a,x2:a,y1:0,y2:"major"===e.type?6:4,strokeWidth:1,stroke:v},"tick-"+e.base)})),h?null:g.filter((function(e){return"major"===e.type})).map((function(e){var a=(i?n-e.base:e.base-t)/r;return(0,f.jsx)("text",{x:a-3,y:18,fontSize:11,fill:v,children:(0,u.getTickDisplayStr)(e.base+1,r)},"label-".concat(e.base))}))]})}function C(e){var t=e.model,n=e.fontSize,r=t.dynamicBlocks.contentBlocks,a=t.offsetPx,i=t.bpPerPx,o=r.length<5,s=(0,d.Z)(),c=(0,u.stripAlpha)(s.palette.text.primary);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(g,{model:t,height:30}),r.map((function(e){var t=e.start,r=e.end,s=e.key,u=e.reversed,l=e.offsetPx,d=e.refName,p=e.widthPx,h=l-a,g="clip-".concat(s);return(0,f.jsxs)("g",{children:[(0,f.jsx)("defs",{children:(0,f.jsx)("clipPath",{id:g,children:(0,f.jsx)("rect",{x:0,y:0,width:p,height:100})})}),(0,f.jsx)("g",{transform:"translate(".concat(h," 0)"),children:(0,f.jsxs)("g",{clipPath:"url(#".concat(g,")"),children:[(0,f.jsx)("text",{x:4,y:n,fontSize:n,fill:c,children:d}),(0,f.jsx)("g",{transform:"translate(0 20)",children:(0,f.jsx)(Z,{hideText:!o,start:t,end:r,bpPerPx:i,reversed:u})})]})})]},s)}))]})}function S(e){var t=e.model,n=e.fontSize,r=t.offsetPx,a=t.dynamicBlocks,i=a.totalWidthPxWithoutBorders,o=a.totalBp,s=(0,d.Z)(),c=(0,u.getBpDisplayStr)(o),l=Math.max(-r,0),p=l+i,h=(0,u.stripAlpha)(s.palette.text.secondary),g=l+(p-l)/2,m=n;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("line",{x1:l,x2:p,y1:10,y2:10,stroke:h}),(0,f.jsx)("line",{x1:l,x2:l,y1:5,y2:15,stroke:h}),(0,f.jsx)("line",{x1:p,x2:p,y1:5,y2:15,stroke:h}),(0,f.jsx)("text",{x:g,y:m,textAnchor:"middle",dominantBaseline:"hanging",fontSize:n,fill:h,children:c})]})}function T(e){var t=e.model,n=e.fontSize,r=e.cytobandHeight,i=e.rulerHeight,o=t.width,s=t.assemblyNames,c=t.showCytobands,l=t.displayedRegions,p=(0,u.getSession)(t).assemblyManager,h=s.length>1?"":s[0],g=p.get(h),m=(0,d.Z)(),v=(0,u.stripAlpha)(m.palette.text.primary),k=y.Z.create({displayedRegions:JSON.parse(JSON.stringify(l)),interRegionPaddingWidth:0,minimumBlockWidth:t.minimumBlockWidth}),Z=t.dynamicBlocks.contentBlocks;if(!Z.length)return null;k.setVolatileWidth(o),k.showAllRegions();var T=k.dynamicBlocks.contentBlocks[0],P=Z.at(0),M=Z.at(-1),R=k.bpToPx((0,a.Z)((0,a.Z)({},P),{},{coord:P.reversed?P.end:P.start}))||0,A=k.bpToPx((0,a.Z)((0,a.Z)({},M),{},{coord:M.reversed?M.start:M.end}))||0,I=+c*r;return(0,f.jsxs)("g",{id:"header",children:[(0,f.jsx)("text",{x:0,y:0,dominantBaseline:"hanging",fontSize:n,fill:v,children:h}),c?(0,f.jsxs)("g",{transform:"translate(0 ".concat(i,")"),children:[(0,f.jsx)(w.Z,{overview:k,assembly:g,block:T}),(0,f.jsx)("rect",{stroke:"red",fill:"rgb(255,0,0,0.1)",width:Math.max(A-R,.5),height:b.VH-1,x:R,y:.5}),(0,f.jsx)("g",{transform:"translate(0,".concat(b.VH,")"),children:(0,f.jsx)(x.mg,{overview:k,model:t,useOffset:!1})})]}):null,(0,f.jsx)("g",{transform:"translate(0 ".concat(n+I,")"),children:(0,f.jsx)(S,{model:t,fontSize:n})}),(0,f.jsx)("g",{transform:"translate(0 ".concat(i+I,")"),children:(0,f.jsx)(C,{model:t,fontSize:n})})]})}function P(e,t,n){return(0,u.sum)(e.map((function(e){return e.displays[0].height+(["none","left"].includes(n)?0:t)})))}function M(e,t){return R.apply(this,arguments)}function R(){return R=(0,i.Z)((0,r.Z)().mark((function e(t,n){var d,g,m,y,b,w,x,k,Z,C,S,M,R,A,I,L,N,F,j,D,B,E,V,z,O,W,H,G,q;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.when)((function(){return t.initialized}));case 2:return g=n.textHeight,m=void 0===g?18:g,y=n.headerHeight,b=void 0===y?40:y,w=n.rulerHeight,x=void 0===w?50:w,k=n.fontSize,Z=void 0===k?13:k,C=n.cytobandHeight,S=void 0===C?100:C,M=n.trackLabels,R=void 0===M?"offset":M,A=n.themeName,I=void 0===A?"default":A,L=n.Wrapper,N=void 0===L?function(e){var t=e.children;return(0,f.jsx)(f.Fragment,{children:t})}:L,F=(0,u.getSession)(t),j=null===(d=F.allThemes)||void 0===d?void 0:d.call(F)[I],D=t.width,B=t.tracks,E=t.showCytobands,V=50,z=b+x+ +E*S+10,O=P(B,m,R)+z+100,e.next=12,Promise.all(B.map(function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.displays[0],e.next=3,(0,s.when)((function(){return!i.renderProps().notReady}));case 3:return e.t0=t,e.next=6,i.renderSvg((0,a.Z)((0,a.Z)({},n),{},{theme:j}));case 6:return e.t1=e.sent,e.abrupt("return",{track:e.t0,result:e.t1});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 12:return W=e.sent,H=(0,u.max)(B.map((function(e){return(0,u.measureText)((0,h.getTrackName)(e.configuration,F),Z)})),0)+40,q=D+(G="left"===R?H:0),e.abrupt("return",(0,o.uS)((0,f.jsx)(c.Z,{theme:(0,l.createJBrowseTheme)(j),children:(0,f.jsx)(N,{children:(0,f.jsxs)("svg",{width:q,height:O,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:[0,0,q+2*V,O].toString(),children:[(0,f.jsx)(p,{width:q,height:O,shift:V}),(0,f.jsxs)("g",{transform:"translate(".concat(V," 0)"),children:[(0,f.jsx)("g",{transform:"translate(".concat(G,")"),children:(0,f.jsx)(T,{model:t,fontSize:Z,rulerHeight:x,cytobandHeight:S})}),(0,f.jsx)(v,{textHeight:m,fontSize:Z,model:t,displayResults:W,offset:z,trackLabels:R,trackLabelOffset:G})]})]})})})));case 17:case"end":return e.stop()}}),e)}))),R.apply(this,arguments)}},73326:function(e,t,n){"use strict";n.d(t,{Cz:function(){return c},Gc:function(){return l},_S:function(){return u},nT:function(){return f}});var r=n(32723),a=n(33028),i=n(96234),o=n(34795),s=n(81073);function u(e,t,n){for(var r=t*(e=Math.abs(e)),a=Number.parseInt(Number(r).toExponential().split(/e/i)[1],10),i=Math.pow(10,a);i<r&&!((i*=2)>=r);)i*=2.5;var o=(i=Math.max(i,5))/e,s=0;return!(i%10)&&o/10>=n?s=i/10:!(i%5)&&o/5>=n?s=i/5:!(i%2)&&o/2>=n&&(s=i/2),{majorPitch:i,minorPitch:s}}function c(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=u(n,60,15),o=e,s=t;if(null===o||null===s)return[];if(n<0){var c=[s,o];o=c[0],s=c[1]}o-=Math.abs(20*n)-1,s+=Math.abs(20*n)+1;for(var l=i.minorPitch||i.majorPitch,d=0,f=[],p=Math.floor(o/l)*l;p<Math.ceil(s/l)*l+1;p+=l)a&&p%(2*i.majorPitch)?(f.push({type:"minor",base:p-1,index:d}),d+=1):!r||p%(2*i.majorPitch)||(f.push({type:"major",base:p-1,index:d}),d+=1);return f}function l(){return d.apply(this,arguments)}function d(){return d=(0,o.Z)((0,r.Z)().mark((function e(){var t,n,i,s=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:[],n=s.length>1?s[1]:void 0,i=s.length>2?s[2]:void 0,e.abrupt("return",Promise.all(t.map(function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var o,s,u,c,l,d;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.assemblyName||i){e.next=3;break}throw new Error("no assembly provided");case 3:return e.next=5,n.waitForAssembly(o);case 5:if(s=e.sent,u=t.refName,s){e.next=9;break}throw new Error("assembly ".concat(o," not found"));case 9:if(c=s.regions){e.next=12;break}throw new Error("regions not loaded yet for ".concat(o));case 12:if(l=s.getCanonicalRefName(t.refName)){e.next=15;break}throw new Error("Could not find refName ".concat(u," in ").concat(s.name));case 15:if(d=c.find((function(e){return e.refName===l}))){e.next=18;break}throw new Error("Could not find refName ".concat(u," in ").concat(o));case 18:return e.abrupt("return",(0,a.Z)((0,a.Z)({},t),{},{assemblyName:o,parentRegion:d}));case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 4:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function f(e,t,n){var r=e.split(/(\s+)/).map((function(e){return e.trim()})).filter((function(e){return!!e}));try{return r.map((function(e){return(0,s.parseLocString)(e,(function(e){return n(e,t)}))}))}catch(l){var a=(0,i.Z)(r,3),o=a[0],u=a[1],c=a[2];if("".concat(l).match(/Unknown reference sequence/)&&Number.isInteger(+u)&&Number.isInteger(+c))return[(0,s.parseLocString)(o+":"+u+".."+c,(function(e){return n(e,t)}))];throw l}}},57211:function(e,t,n){"use strict";n.d(t,{fV:function(){return xe},qb:function(){return Q},rK:function(){return J},Ek:function(){return ye},Uc:function(){return Le.SVGRuler},Ge:function(){return Le.SVGTracks},Rj:function(){return Se.Rj},eW:function(){return ge},fU:function(){return d},ZP:function(){return Ne},RH:function(){return Te},l0:function(){return Re},hY:function(){return Le.totalHeight}});var r=n(9249),a=n(87371),i=n(45754),o=n(13820),s=n(49767),u=n(81073),c=n(1787),l=n(9077);var d=(0,l.ConfigurationSchema)("BaseLinearDisplay",{maxFeatureScreenDensity:{type:"number",description:"maximum features per pixel that is displayed in the view, used if byte size estimates not available",defaultValue:.3},fetchSizeLimit:{type:"number",defaultValue:1e6,description:"maximum data to attempt to download for a given track, used if adapter doesn't specify one"},height:{type:"number",defaultValue:100,description:"default height for the track"},mouseover:{type:"string",description:"text to display when the cursor hovers over a feature",defaultValue:"jexl:get(feature,'name')",contextVariable:["feature"]}},{explicitIdentifier:"displayId"}),f=n(59740),p=n(33028),h=n(32723),g=n(68079),m=n(34795),v=n(41361),y=n(77479),b=function(e){function t(e){(0,r.Z)(this,t),this.submaps=e}return(0,a.Z)(t,[{key:"has",value:function(e){var t,n=(0,v.Z)(this.submaps.values());try{for(n.s();!(t=n.n()).done;){if(t.value.has(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"get",value:function(e){var t,n=(0,v.Z)(this.submaps.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.has(e))return r.get(e)}}catch(a){n.e(a)}finally{n.f()}}},{key:"values",value:(0,h.Z)().mark((function e(){var t,n,r;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,v.Z)(this.keys()),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=9;break}return r=n.value,e.next=7,this.get(r);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"keys",value:(0,h.Z)().mark((function(){var e,t,n,r,a,i,o,s,u,c;return(0,h.Z)().wrap((function(l){for(;;)switch(l.prev=l.next){case 0:e=new Set,t=(0,v.Z)(this.submaps.values());try{for(t.s();!(n=t.n()).done;){r=n.value,a=(0,v.Z)(r.keys());try{for(a.s();!(i=a.n()).done;)o=i.value,e.add(o)}catch(d){a.e(d)}finally{a.f()}}}catch(d){t.e(d)}finally{t.f()}s=(0,v.Z)(e),l.prev=4,s.s();case 6:if((u=s.n()).done){l.next=12;break}return c=u.value,l.next=10,c;case 10:l.next=6;break;case 12:l.next=17;break;case 14:l.prev=14,l.t0=l.catch(4),s.e(l.t0);case 17:return l.prev=17,s.f(),l.finish(17);case 20:case"end":return l.stop()}}),e,this,[[4,14,17,20]])}))},{key:"find",value:function(e){var t,n=(0,v.Z)(this.submaps.values());try{for(n.s();!(t=n.n()).done;){var r,a=t.value,i=(0,v.Z)(a.values());try{for(i.s();!(r=i.n()).done;){var o=r.value;if(e(o))return o}}catch(s){i.e(s)}finally{i.f()}}}catch(s){n.e(s)}finally{n.f()}}},{key:e,value:(0,h.Z)().mark((function e(){var t,n,r;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,v.Z)(this.keys()),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=9;break}return r=n.value,e.next=7,[r,this.get(r)];case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"entries",value:(0,h.Z)().mark((function e(){var t,n,r;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,v.Z)(this.keys()),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=9;break}return r=n.value,e.next=7,[r,this.get(r)];case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))}]),t}(Symbol.iterator),w=n(97891),x=n(90689),k=n(40909),Z=n(56521),C=n(96234),S=n(30969),T=n(90550),P=n(94702),M=n(53276),R=n(59767),A=n(56891),I=n(53515),L=n(37574),N=(0,M.ZL)()({linearBlocks:{whiteSpace:"nowrap",textAlign:"left",position:"absolute",minHeight:"100%",display:"flex"},heightOverflowed:{position:"absolute",color:"rgb(77,77,77)",borderBottom:"2px solid rgb(77,77,77)",textShadow:"white 0px 0px 1px",whiteSpace:"nowrap",width:"100%",fontWeight:"bold",textAlign:"center",zIndex:2e3,boxSizing:"border-box"}}),F=(0,T.observer)((function(e){var t=e.model,n=N().classes,r=t.blockDefinitions,a=t.blockState;return(0,L.jsx)(L.Fragment,{children:r.map((function(e){if(e instanceof A.b0){var r=a.get(e.key);return(0,L.jsxs)(I.b0,{block:e,children:[r&&r.ReactComponent?(0,L.jsx)(r.ReactComponent,{model:r}):null,r&&r.maxHeightReached?(0,L.jsx)("div",{className:n.heightOverflowed,style:{top:r.layout.getTotalHeight()-16,pointerEvents:"none",height:16},children:"Max height reached"}):null]},"".concat(t.id,"-").concat(e.key))}if(e instanceof A.sh)return(0,L.jsx)(I.sh,{width:e.widthPx},"".concat(t.id,"-").concat(e.key));if(e instanceof A.n2)return(0,L.jsx)(I.n2,{width:e.widthPx,style:{background:"none"},boundary:"boundary"===e.variant},e.key);throw new Error("invalid block type ".concat(typeof e))}))})})),j=(0,T.observer)((function(e){var t=e.model,n=N().classes,r=t.blockDefinitions,a=(0,u.getContainingView)(t);return(0,L.jsx)("div",{className:n.linearBlocks,style:{left:r.offsetPx-a.offsetPx},children:(0,L.jsx)(F,{model:t})})})),D=j,B=n(74262),E=n(46622),V=n(72779);var z=(0,M.ZL)()((function(e){return{tooltip:{pointerEvents:"none",backgroundColor:(0,B.Fq)(e.palette.grey[700],.9),borderRadius:e.shape.borderRadius,color:e.palette.common.white,fontFamily:e.typography.fontFamily,padding:"4px 8px",fontSize:e.typography.pxToRem(12),lineHeight:"".concat((t=1.4,Math.round(1e5*t)/1e5),"em"),maxWidth:300,wordWrap:"break-word"}};var t})),O=S.forwardRef((function(e,t){var n=e.message;return(0,L.jsx)("div",{ref:t,children:S.isValidElement(n)?n:n?(0,L.jsx)(R.SanitizedHTML,{html:String(n)}):null})})),W=(0,T.observer)((function(e){var t=e.model,n=e.clientMouseCoord,r=z().classes,a=t.featureUnderMouse,i=(0,S.useState)(0),o=(0,C.Z)(i,2),s=o[0],u=o[1],c=(0,S.useState)(null),d=(0,C.Z)(c,2),f=d[0],h=d[1],g=(0,S.useMemo)((function(){return{getBoundingClientRect:function(){var e=n[0]+s/2+20,t=n[1];return{top:t,left:e,bottom:t,right:e,width:0,height:0,x:e,y:t,toJSON:function(){}}}}}),[n,s]),m=(0,V.D)(g,f),v=m.styles,y=m.attributes,b=a?(0,l.getConf)(t,"mouseover",{feature:a}):void 0;return a&&b?(0,L.jsx)(E.h,{children:(0,L.jsx)("div",(0,p.Z)((0,p.Z)({ref:h,className:r.tooltip,style:(0,p.Z)((0,p.Z)({},v.popper),{},{zIndex:1e5})},y.popper),{},{children:(0,L.jsx)(O,{ref:function(e){return u((null===e||void 0===e?void 0:e.getBoundingClientRect().width)||0)},message:b})}))}):null})),H=W,G=n(72097),q=n(76149),_=n(6779),U=(0,M.ZL)()({ellipses:{textOverflow:"ellipsis",overflow:"hidden"}});function J(e){var t=e.message,n=e.severity,r=e.buttonText,a=e.icon,i=e.action,o=U().classes,s=i?(0,L.jsx)(G.Z,{"data-testid":"reload_button",onClick:i,startIcon:a,children:r}):null;return(0,L.jsx)(q.Z,{severity:n,action:s,classes:{message:o.ellipses},children:(0,L.jsx)(_.Z,{title:t,children:(0,L.jsx)("div",{children:t})})})}var X=(0,M.ZL)()({display:{position:"relative",whiteSpace:"nowrap",textAlign:"left",width:"100%",minHeight:"100%"}}),Y=(0,T.observer)((function(e){var t=X().classes,n=(0,P.Z)(),r=(0,S.useRef)(null),a=(0,S.useState)(),i=(0,C.Z)(a,2),o=i[0],s=i[1],u=(0,S.useState)([0,0]),c=(0,C.Z)(u,2),d=c[0],f=c[1],h=(0,S.useState)([0,0]),g=(0,C.Z)(h,2),m=g[0],v=g[1],y=(0,S.useState)(),b=(0,C.Z)(y,2),w=b[0],x=b[1],k=e.model,Z=e.children,T=k.TooltipComponent,M=k.DisplayMessageComponent,A=k.contextMenuItems,I=k.height,N=k.setContextMenuFeature;return(0,L.jsxs)("div",{ref:r,"data-testid":"display-".concat((0,l.getConf)(k,"displayId")),className:t.display,onContextMenu:function(e){e.preventDefault(),w?x(void 0):r.current&&x([e.clientX,e.clientY])},onMouseMove:function(e){if(r.current){var t=r.current.getBoundingClientRect(),n=t.left,a=t.top;f([e.clientX-n,e.clientY-a]),v([e.clientX,e.clientY]),s(t)}},children:[M?(0,L.jsx)(M,{model:k}):(0,L.jsx)(D,(0,p.Z)({},e)),Z,(0,L.jsx)(T,{model:k,height:I,offsetMouseCoord:d,clientMouseCoord:m,clientRect:o,mouseCoord:d}),(0,L.jsx)(R.Menu,{open:Boolean(w)&&Boolean(A().length),onMenuItemClick:function(e,t){t(),x(void 0)},onClose:function(){x(void 0),N(void 0)},TransitionProps:{onExit:function(){x(void 0),N(void 0)}},anchorReference:"anchorPosition",anchorPosition:w?{top:w[1],left:w[0]}:void 0,style:{zIndex:n.zIndex.tooltip},menuItems:A()})]})})),Q=Y,K=n(29206),$=n(8438),ee=n(10452),te=(0,M.ZL)()((function(e){var t=e.palette.action.disabledBackground;return{loading:{paddingLeft:"0.6em",backgroundColor:e.palette.background.default,backgroundImage:"repeating-linear-gradient(45deg, transparent, transparent 5px, ".concat(t," 5px, ").concat(t," 10px)"),textAlign:"center"}}})),ne=(0,T.observer)((function(e){var t=e.model,n=te().classes,r=t.status,a=(0,k.getParent)(t,2).message||r;return(0,L.jsx)("div",{className:n.loading,children:(0,L.jsx)(R.LoadingEllipses,{message:a})})})),re=(0,T.observer)((function(e){var t=e.model;return t.error?(0,L.jsx)(J,{message:"".concat(t.error),severity:"error",buttonText:"reload",icon:(0,L.jsx)(ee.Z,{}),action:t.reload}):t.message?S.isValidElement(t.message)?t.message:(0,L.jsx)(J,{message:"".concat(t.message),severity:"info"}):t.filled?t.reactElement:(0,L.jsx)(ne,{model:t})})),ae=re,ie=k.types.model("BlockState",{key:k.types.string,region:K.Region,reloadFlag:0,isLeftEndOfDisplayedRegion:!1,isRightEndOfDisplayedRegion:!1}).volatile((function(){return{renderInProgress:void 0,filled:!1,reactElement:void 0,features:void 0,layout:void 0,status:"",error:void 0,message:void 0,maxHeightReached:!1,ReactComponent:ae,renderProps:void 0}})).actions((function(e){var t;return{doReload:function(){e.reloadFlag=e.reloadFlag+1},afterAttach:function(){var t=this,n=(0,u.getContainingDisplay)(e);setTimeout((function(){(0,k.isAlive)(e)&&(0,u.makeAbortableReaction)(e,oe,se,{name:"".concat(n.id,"/").concat((0,u.assembleLocString)(e.region)," rendering"),delay:n.renderDelay,fireImmediately:!0},t.setLoading,t.setRendered,t.setError)}),n.renderDelay)},setStatus:function(t){e.status=t},setLoading:function(n){void 0===t||t.signal.aborted||t.abort(),e.filled=!1,e.message=void 0,e.reactElement=void 0,e.features=void 0,e.layout=void 0,e.error=void 0,e.maxHeightReached=!1,e.renderProps=void 0,t=n},setMessage:function(n){t&&!t.signal.aborted&&t.abort(),e.filled=!1,e.message=n,e.reactElement=void 0,e.features=void 0,e.layout=void 0,e.error=void 0,e.maxHeightReached=!1,e.renderProps=void 0,t=void 0},setRendered:function(n){if(n){var r=n.reactElement,a=n.features,i=n.layout,o=n.maxHeightReached,s=n.renderProps;e.filled=!0,e.message=void 0,e.reactElement=r,e.features=a,e.layout=i,e.error=void 0,e.maxHeightReached=o,e.renderProps=s,t=void 0}},setError:function(n){console.error(n),t&&!t.signal.aborted&&t.abort(),e.filled=!1,e.message=void 0,e.reactElement=void 0,e.features=void 0,e.layout=void 0,e.maxHeightReached=!1,e.error=n,e.renderProps=void 0,t=void 0,(0,$.Z6)(n)&&this.reload()},reload:function(){e.renderInProgress=void 0,e.filled=!1,e.reactElement=void 0,e.features=void 0,e.layout=void 0,e.error=void 0,e.message=void 0,e.maxHeightReached=!1,e.ReactComponent=ae,e.renderProps=void 0,(0,k.getParent)(e,2).reload()},beforeDestroy:function(){(0,m.Z)((0,h.Z)().mark((function n(){var r,a,i,o,s,c;return(0,h.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,t&&!t.signal.aborted&&t.abort(),r=(0,u.getContainingDisplay)(e),a=(0,u.getSession)(e),i=a.rpcManager,o=r.rendererType,s=oe((0,k.cast)(e)),!(c=s.renderArgs)){n.next=9;break}return n.next=9,o.freeResourcesInClient(i,JSON.parse(JSON.stringify(c)));case 9:n.next=14;break;case 11:n.prev=11,n.t0=n.catch(0),console.error("Error while destroying block",n.t0);case 14:case"end":return n.stop()}}),n,null,[[0,11]])})))()}}}));function oe(e,t){try{var n=t||(0,u.getContainingDisplay)(e),r=(0,u.getSession)(n),a=r.assemblyManager,i=r.rpcManager,o=n.adapterConfig,s=n.rendererType,c=n.error,d=n.parentTrack,f=(0,w.getTrackAssemblyNames)(d),p=e.region.assemblyName;if(!f.includes(p)&&!f.some((function(e){var t;return null===(t=a.get(e))||void 0===t?void 0:t.hasName(p)})))throw new Error("region assembly (".concat(p,") does not match track assemblies (").concat(f,")"));var h=n.renderProps(),g=h.config;(0,l.readConfObject)(g);var m=(0,w.getRpcSessionId)(n),v=(0,u.getContainingView)(n).id;return{rendererType:s,rpcManager:i,renderProps:h,cannotBeRenderedReason:n.regionCannotBeRendered(e.region),displayError:c,renderArgs:{statusCallback:function(t){(0,k.isAlive)(e)&&e.setStatus(t)},assemblyName:e.region.assemblyName,regions:[(0,k.getSnapshot)(e.region)],adapterConfig:o,rendererType:s.name,sessionId:m,layoutId:v,blockKey:e.key,reloadFlag:e.reloadFlag,timeout:1e6}}}catch(y){return{displayError:y}}}function se(e,t,n){return ue.apply(this,arguments)}function ue(){return(ue=(0,m.Z)((0,h.Z)().mark((function e(t,n,r){var a,i,o,s,c,l,d,f,g,m,v;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(a=t.rendererType,i=t.renderProps,o=t.rpcManager,s=t.renderArgs,c=t.cannotBeRenderedReason,l=t.displayError,(0,k.isAlive)(r)){e.next=5;break}return e.abrupt("return",void 0);case 5:if(!l){e.next=8;break}return r.setError(l),e.abrupt("return",void 0);case 8:if(!c){e.next=11;break}return r.setMessage(c),e.abrupt("return",void 0);case 11:if(!i.notReady){e.next=13;break}return e.abrupt("return",void 0);case 13:return e.next=15,a.renderInClient(o,(0,p.Z)((0,p.Z)((0,p.Z)({},s),i),{},{viewParams:(0,u.getViewParams)(r),signal:n}));case 15:return d=e.sent,f=d.reactElement,g=d.features,m=d.layout,v=d.maxHeightReached,e.abrupt("return",{reactElement:f,features:g,layout:m,maxHeightReached:v,renderProps:i});case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(e,t){var n="undefined"===typeof jest;return"clip-".concat(n?e:"jest","-").concat(t)}function le(e){return de.apply(this,arguments)}function de(){return(de=(0,m.Z)((0,h.Z)().mark((function e(t){var n,r,a,i,o,s;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(0,u.getContainingView)(t),r=n.staticBlocks.contentBlocks,a=(0,u.getSession)(t),i=a.rpcManager,o=t.adapterConfig){e.next=6;break}return e.abrupt("return",{});case 6:return s=(0,w.getRpcSessionId)(t),e.abrupt("return",i.call(s,"CoreGetFeatureDensityStats",{sessionId:s,regions:r,adapterConfig:o,statusCallback:function(e){(0,k.isAlive)(t)&&t.setMessage(e)}}));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fe(e,t){return pe.apply(this,arguments)}function pe(){return pe=(0,m.Z)((0,h.Z)().mark((function e(t,n){var r,a,i,o,s,c,l,d;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.height,a=t.id,i=n.overrideHeight,o=(0,u.getContainingView)(t),s=o.offsetPx,c=o.roundedDynamicBlocks,l=o.width,e.next=6,Promise.all(c.map(function(){var e=(0,m.Z)((0,h.Z)().mark((function e(r){var a,i,o,s,c,d,f;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=ie.create({key:r.key,region:r}),!(i=t.regionCannotBeRenderedText(r)||t.regionCannotBeRendered(r))){e.next=4;break}return e.abrupt("return",[r,{reactElement:(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("rect",{x:0,y:0,width:l,height:20,fill:"#aaa"}),(0,L.jsx)("text",{x:0,y:15,children:i})]})}]);case 4:return o=oe(a,t),s=o.rpcManager,c=o.renderArgs,d=o.renderProps,f=o.rendererType,e.t0=r,e.next=8,f.renderInClient(s,(0,p.Z)((0,p.Z)((0,p.Z)({},c),d),{},{viewParams:(0,u.getViewParams)(t,!0),exportSVG:n,theme:n.theme||d.theme}));case 8:return e.t1=e.sent,e.abrupt("return",[e.t0,e.t1]);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:return d=e.sent,e.abrupt("return",(0,L.jsx)(L.Fragment,{children:d.map((function(e,t){var n=(0,C.Z)(e,2),o=n[0],c=n[1],l=o.offsetPx,d=o.widthPx,f=l-s,p=ce(a,t);return(0,L.jsxs)(S.Fragment,{children:[(0,L.jsx)("defs",{children:(0,L.jsx)("clipPath",{id:p,children:(0,L.jsx)("rect",{x:0,y:0,width:d,height:i||r})})}),(0,L.jsx)("g",{transform:"translate(".concat(f," 0)"),children:(0,L.jsx)("g",{clipPath:"url(#".concat(p,")"),children:(0,L.jsx)(u.ReactRendering,{rendering:c})})})]},"frag-".concat(t))}))}));case 8:case"end":return e.stop()}}),e)}))),pe.apply(this,arguments)}var he=20;function ge(){return k.types.model({heightPreConfig:k.types.maybe(k.types.refinement("displayHeight",k.types.number,(function(e){return e>=he})))}).volatile((function(){return{scrollTop:0}})).views((function(e){return{get height(){var t;return null!==(t=e.heightPreConfig)&&void 0!==t?t:(0,l.getConf)(e,"height")}}})).actions((function(e){return{setScrollTop:function(t){e.scrollTop=t},setHeight:function(t){return e.heightPreConfig=Math.max(t,he),e.height},resizeHeight:function(t){var n=e.height;return this.setHeight(e.height+t)-n}}}))}var me=function(e){var t=e.model,n=t.regionTooLargeReason;return(0,L.jsx)(J,{severity:"warning",action:function(){t.setFeatureDensityStatsLimit(t.featureDensityStats),t.reload()},buttonText:"Force load",message:[n,"Zoom in to see features or force load (may be slow)"].filter((function(e){return!!e})).join(". ")})};function ve(){return(ve=(0,m.Z)((0,h.Z)().mark((function e(t){var n,r,a;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(r=(0,u.getContainingView)(t)).initialized&&r.staticBlocks.contentBlocks.length&&r.bpPerPx!==t.currStatsBpPerPx&&!t.error){e.next=4;break}return e.abrupt("return");case 4:if(void 0===(null===(n=t.featureDensityStats)||void 0===n?void 0:n.featureDensity)){e.next=7;break}return t.setCurrStatsBpPerPx(r.bpPerPx),e.abrupt("return");case 7:return t.clearFeatureDensityStats(),t.setCurrStatsBpPerPx(r.bpPerPx),e.next=11,t.getFeatureDensityStats();case 11:a=e.sent,(0,k.isAlive)(t)&&t.setFeatureDensityStats(a),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),!(0,u.isAbortException)(e.t0)&&(0,k.isAlive)(t)&&(console.error(e.t0),t.setError(e.t0));case 18:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}function ye(){return k.types.model({userBpPerPxLimit:k.types.maybe(k.types.number),userByteSizeLimit:k.types.maybe(k.types.number)}).volatile((function(){return{featureDensityStatsP:void 0,featureDensityStats:void 0,currStatsBpPerPx:0}})).views((function(e){return{get currentBytesRequested(){var t;return(null===(t=e.featureDensityStats)||void 0===t?void 0:t.bytes)||0},get currentFeatureScreenDensity(){var t,n=(0,u.getContainingView)(e);return((null===(t=e.featureDensityStats)||void 0===t?void 0:t.featureDensity)||0)*n.bpPerPx},get maxFeatureScreenDensity(){return(0,l.getConf)(e,"maxFeatureScreenDensity")},get featureDensityStatsReady(){var t=(0,u.getContainingView)(e);return e.currStatsBpPerPx===t.bpPerPx&&(!!e.featureDensityStats||!!e.userBpPerPxLimit)},get maxAllowableBytes(){var t;return e.userByteSizeLimit||(null===(t=e.featureDensityStats)||void 0===t?void 0:t.fetchSizeLimit)||(0,l.getConf)(e,"fetchSizeLimit")}}})).actions((function(e){return{afterAttach:function(){(0,k.addDisposer)(e,(0,x.autorun)((function(){return function(e){return ve.apply(this,arguments)}(e)})))}}})).actions((function(e){return{setCurrStatsBpPerPx:function(t){e.currStatsBpPerPx=t},setFeatureDensityStatsLimit:function(t){var n=(0,u.getContainingView)(e);null!==t&&void 0!==t&&t.bytes?e.userByteSizeLimit=t.bytes:e.userBpPerPxLimit=n.bpPerPx},getFeatureDensityStats:function(){var t=this;return(0,m.Z)((0,h.Z)().mark((function n(){return(0,h.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.featureDensityStatsP||(e.featureDensityStatsP=le(e).catch((function(n){throw(0,k.isAlive)(e)&&t.setFeatureDensityStatsP(void 0),n}))),n.abrupt("return",e.featureDensityStatsP);case 2:case"end":return n.stop()}}),n)})))()},setFeatureDensityStatsP:function(t){e.featureDensityStatsP=t},setFeatureDensityStats:function(t){e.featureDensityStats=t},clearFeatureDensityStats:function(){e.featureDensityStatsP=void 0,e.featureDensityStats=void 0}}})).views((function(e){return{get regionTooLarge(){var t=(0,u.getContainingView)(e);return!(!e.featureDensityStatsReady||t.dynamicBlocks.totalBp<2e4)&&(e.currentBytesRequested>e.maxAllowableBytes||(e.userBpPerPxLimit?t.bpPerPx>e.userBpPerPxLimit:e.currentFeatureScreenDensity>e.maxFeatureScreenDensity))},get regionTooLargeReason(){var t,n=e.currentBytesRequested,r=e.maxAllowableBytes;return n&&n>r?"Requested too much data (".concat((t=n,Math.floor(t/1e6)>0?"".concat(Number.parseFloat((t/1e6).toPrecision(3))," Mb"):Math.floor(t/1e3)>0?"".concat(Number.parseFloat((t/1e3).toPrecision(3))," Kb"):"".concat(Math.floor(t)," bytes")),")"):""}}})).views((function(e){return{regionCannotBeRenderedText:function(t){return e.regionTooLarge?"Force load to see features":""},regionCannotBeRendered:function(t){return e.regionTooLarge?(0,L.jsx)(me,{model:e}):null}}}))}var be=["height"],we=["blockState"];var xe=k.types.compose("BaseLinearDisplay",y.BaseDisplay,ge(),ye(),k.types.model({blockState:k.types.map(ie),configuration:(0,l.ConfigurationReference)(d)})).volatile((function(){return{featureIdUnderMouse:void 0,contextMenuFeature:void 0}})).views((function(e){return{get blockType(){return"staticBlocks"},get blockDefinitions(){var t=(0,u.getContainingView)(e);if(!t.initialized)throw new Error("view not initialized yet");return t[this.blockType]}}})).views((function(e){return{get renderDelay(){return 50},get TooltipComponent(){return H},get selectedFeatureId(){if((0,k.isAlive)(e)){var t=(0,u.getSession)(e).selection;if((0,u.isFeature)(t))return t.id()}},get DisplayMessageComponent(){}}})).views((function(e){return{get features(){var t,n=[],r=(0,v.Z)(e.blockState.values());try{for(r.s();!(t=r.n()).done;){var a=t.value;null!==a&&void 0!==a&&a.features&&n.push(a.features)}}catch(i){r.e(i)}finally{r.f()}return new b(n)},get featureUnderMouse(){var t=e.featureIdUnderMouse;return t?this.features.get(t):void 0},getFeatureOverlapping:function(t,n,r){var a,i;return null===(a=e.blockState.get(t))||void 0===a||null===(i=a.layout)||void 0===i?void 0:i.getByCoord(n,r)},getFeatureByID:function(t,n){var r,a;return null===(r=e.blockState.get(t))||void 0===r||null===(a=r.layout)||void 0===a?void 0:a.getByID(n)},searchFeatureByID:function(t){var n;return e.blockState.forEach((function(e){var r,a=null===e||void 0===e||null===(r=e.layout)||void 0===r?void 0:r.getByID(t);a&&(n=a)})),n}}})).actions((function(e){return{addBlock:function(t,n){e.blockState.set(t,ie.create({key:t,region:n.toRegion()}))},deleteBlock:function(t){e.blockState.delete(t)},selectFeature:function(t){var n=(0,u.getSession)(e);if((0,u.isSessionModelWithWidgets)(n)){var r=n.addWidget("BaseFeatureWidget","baseFeature",{view:(0,u.getContainingView)(e),track:(0,u.getContainingTrack)(e),featureData:t.toJSON()});n.showWidget(r)}(0,u.isSelectionContainer)(n)&&n.setSelection(t)},clearFeatureSelection:function(){(0,u.getSession)(e).clearSelection()},setFeatureIdUnderMouse:function(t){e.featureIdUnderMouse=t},setContextMenuFeature:function(t){e.contextMenuFeature=t}}})).actions((function(e){var t=e.reload;return{reload:function(){return(0,m.Z)((0,h.Z)().mark((function n(){return(0,h.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.setError(),e.setCurrStatsBpPerPx(0),e.clearFeatureDensityStats(),(0,g.Z)(e.blockState.values()).map((function(e){return e.doReload()})),t();case 5:case"end":return n.stop()}}),n)})))()}}})).views((function(e){return{trackMenuItems:function(){return[]},contextMenuItems:function(){return(0,g.Z)(e.contextMenuFeature?[{label:"Open feature details",icon:Z.Z,onClick:function(){e.contextMenuFeature&&e.selectFeature(e.contextMenuFeature)}}]:[])},renderProps:function(){return(0,p.Z)((0,p.Z)({},(0,w.getParentRenderProps)(e)),{},{notReady:!e.featureDensityStatsReady,rpcDriverName:e.rpcDriverName,displayModel:e,onFeatureClick:function(t,n){var r=n||e.featureIdUnderMouse;if(r){var a=e.features.get(r);a&&e.selectFeature(a)}else e.clearFeatureSelection()},onClick:function(){e.clearFeatureSelection()},onFeatureContextMenu:function(t,n){var r=n||e.featureIdUnderMouse;r?e.setContextMenuFeature(e.features.get(r)):e.clearFeatureSelection()},onMouseMove:function(t,n){e.setFeatureIdUnderMouse(n)},onMouseLeave:function(t){e.setFeatureIdUnderMouse(void 0)},onContextMenu:function(){e.setContextMenuFeature(void 0),e.clearFeatureSelection()}})}}})).actions((function(e){return{renderSvg:function(t){return(0,m.Z)((0,h.Z)().mark((function n(){return(0,h.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",fe(e,t));case 1:case"end":return n.stop()}}),n)})))()},afterAttach:function(){(0,k.addDisposer)(e,(0,x.autorun)((function(){var t={};(0,u.getContainingView)(e).initialized&&(e.blockDefinitions.contentBlocks.forEach((function(n){t[n.key]=!0,e.blockState.has(n.key)||e.addBlock(n.key,n)})),e.blockState.forEach((function(n,r){t[r]||e.deleteBlock(r)})))})))}}})).preProcessSnapshot((function(e){if(!e)return e;var t=e.height,n=(0,f.Z)(e,be);return(0,p.Z)({heightPreConfig:t},n)})).postProcessSnapshot((function(e){var t=e;return t.blockState,(0,f.Z)(t,we)})),ke=n(99069);function Ze(e){return(0,l.ConfigurationSchema)("LinearBareDisplay",{renderer:e.pluggableConfigSchemaType("renderer")},{baseConfiguration:d,explicitlyTyped:!0})}function Ce(e){return k.types.compose("LinearBareDisplay",xe,k.types.model({type:k.types.literal("LinearBareDisplay"),configuration:(0,l.ConfigurationReference)(e)})).views((function(e){var t=e.renderProps;return{renderProps:function(){return(0,p.Z)((0,p.Z)((0,p.Z)({},t()),(0,w.getParentRenderProps)(e)),{},{rpcDriverName:e.rpcDriverName,config:e.configuration.renderer})},get rendererTypeName(){return e.configuration.renderer.type}}}))}var Se=n(49841);var Te=function(e){return(0,l.ConfigurationSchema)("LinearBasicDisplay",{renderer:e.pluggableConfigSchemaType("renderer")},{baseConfiguration:d,explicitlyTyped:!0})},Pe=n(41174),Me=(0,S.lazy)((function(){return n.e(6161).then(n.bind(n,36161))}));var Re=function(e){return k.types.compose("LinearBasicDisplay",xe,k.types.model({type:k.types.literal("LinearBasicDisplay"),trackShowLabels:k.types.maybe(k.types.boolean),trackShowDescriptions:k.types.maybe(k.types.boolean),trackDisplayMode:k.types.maybe(k.types.string),trackMaxHeight:k.types.maybe(k.types.number),configuration:(0,l.ConfigurationReference)(e)})).views((function(e){return{get rendererTypeName(){return(0,l.getConf)(e,["renderer","type"])},get showLabels(){var t;return null!==(t=e.trackShowLabels)&&void 0!==t?t:(0,l.getConf)(e,["renderer","showLabels"])},get showDescriptions(){var t;return null!==(t=e.trackShowDescriptions)&&void 0!==t?t:(0,l.getConf)(e,["renderer","showDescriptions"])},get maxHeight(){var t;return null!==(t=e.trackMaxHeight)&&void 0!==t?t:(0,l.getConf)(e,["renderer","maxHeight"])},get displayMode(){var t;return null!==(t=e.trackDisplayMode)&&void 0!==t?t:(0,l.getConf)(e,["renderer","displayMode"])}}})).views((function(e){return{get rendererConfig(){var t=(0,l.getConf)(e,["renderer"])||{};return e.rendererType.configSchema.create((0,p.Z)((0,p.Z)({},t),{},{showLabels:e.showLabels,showDescriptions:e.showDescriptions,displayMode:e.displayMode,maxHeight:e.maxHeight}),(0,k.getEnv)(e))}}})).actions((function(e){return{toggleShowLabels:function(){e.trackShowLabels=!e.showLabels},toggleShowDescriptions:function(){e.trackShowDescriptions=!e.showDescriptions},setDisplayMode:function(t){e.trackDisplayMode=t},setMaxHeight:function(t){e.trackMaxHeight=t}}})).views((function(e){var t=e.trackMenuItems,n=e.renderProps;return{renderProps:function(){var t=e.rendererConfig,r=n();return(0,p.Z)((0,p.Z)({},r),{},{config:t})},trackMenuItems:function(){return[].concat((0,g.Z)(t()),[{label:"Show labels",icon:Pe.Z,type:"checkbox",checked:e.showLabels,onClick:function(){return e.toggleShowLabels()}},{label:"Show descriptions",icon:Pe.Z,type:"checkbox",checked:e.showDescriptions,onClick:function(){return e.toggleShowDescriptions()}},{label:"Display mode",icon:Pe.Z,subMenu:["compact","reducedRepresentation","normal","collapse"].map((function(t){return{label:t,onClick:function(){return e.setDisplayMode(t)}}}))},{label:"Set max height",onClick:function(){(0,u.getSession)(e).queueDialog((function(t){return[Me,{model:e,handleClose:t}]}))}}])}}}))};var Ae=function(e){return(0,l.ConfigurationSchema)("FeatureTrack",{},{baseConfiguration:(0,ke.createBaseTrackConfig)(e),explicitIdentifier:"trackId"})};var Ie=function(e){return(0,l.ConfigurationSchema)("BasicTrack",{},{baseConfiguration:(0,ke.createBaseTrackConfig)(e),explicitIdentifier:"trackId"})},Le=n(22875),Ne=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="LinearGenomeViewPlugin",e.exports={BaseLinearDisplayComponent:Q,BaseLinearDisplay:xe,baseLinearDisplayConfigSchema:d,SearchBox:Se.Rj,ZoomControls:Se.FX,LinearGenomeView:Se.I1},e}return(0,a.Z)(n,[{key:"install",value:function(e){var t;(t=e).addTrackType((function(){var e=Ae(t);return new ke.TrackType({name:"FeatureTrack",displayName:"Feature track",configSchema:e,stateModel:(0,ke.createBaseTrackModel)(t,"FeatureTrack",e)})})),function(e){e.addTrackType((function(){var t=Ie(e);return new ke.TrackType({name:"BasicTrack",configSchema:t,stateModel:(0,ke.createBaseTrackModel)(e,"BasicTrack",t)})}))}(e),function(e){e.addDisplayType((function(){var t=Te(e);return new ke.DisplayType({name:"LinearBasicDisplay",displayName:"Basic feature display",configSchema:t,stateModel:Re(t),trackType:"FeatureTrack",viewType:"LinearGenomeView",ReactComponent:Q})}))}(e),(0,Se.ZP)(e),function(e){e.addDisplayType((function(){var t=Ze(e);return new ke.DisplayType({name:"LinearBareDisplay",configSchema:t,displayName:"Bare feature display",stateModel:Ce(t),trackType:"BasicTrack",viewType:"LinearGenomeView",ReactComponent:Q})}))}(e),function(e){e.addToExtensionPoint("LaunchView-LinearGenomeView",function(){var e=(0,m.Z)((0,h.Z)().mark((function e(t){var n,r,a,i,o,s,c,l;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.session,r=t.assembly,a=t.loc,i=t.tracks,o=void 0===i?[]:i,e.prev=1,s=n.assemblyManager,c=n.addView("LinearGenomeView",{}),e.next=6,(0,u.when)((function(){return!!c.volatileWidth}));case 6:if(r){e.next=8;break}throw new Error("No assembly provided when launching linear genome view");case 8:return e.next=10,s.waitForAssembly(r);case 10:if(e.sent){e.next=13;break}throw new Error('Assembly "'.concat(r,'" not found when launching linear genome view'));case 13:return e.next=15,c.navToLocString(a,r);case 15:if(l=[],o.forEach((function(e){try{c.showTrack(e)}catch(t){if(!"".concat(t).match("Could not resolve identifier"))throw t;l.push(e)}})),!l.length){e.next=19;break}throw new Error("Could not resolve identifiers: ".concat(l.join(",")));case 19:e.next=25;break;case 21:throw e.prev=21,e.t0=e.catch(1),n.notify("".concat(e.t0),"error"),e.t0;case 25:case"end":return e.stop()}}),e,null,[[1,21]])})));return function(t){return e.apply(this,arguments)}}())}(e)}},{key:"configure",value:function(e){(0,u.isAbstractMenuManager)(e.rootModel)&&e.rootModel.appendToSubMenu(["Add"],{label:"Linear genome view",icon:c.Z,onClick:function(e){e.addView("LinearGenomeView",{})}})}}]),n}(s.Z)},78867:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var r=n(33028),a=n(96234),i=n(68079),o=n(9249),s=n(87371),u=n(6556),c={DEL:"deletion",INS:"insertion",DUP:"duplication",INV:"inversion",INVDUP:"inverted duplication",CNV:"copy_number_variation",TRA:"translocation","DUP:TANDEM":"tandem_duplication",NON_REF:"sequence_variant","*":"sequence_variant"};function l(e,t,n){if(!t||0===t.length)return["remark","no alternative alleles"];var r=new Set,o=new Set;if(t.forEach((function(t){var i=d(e,t,n),s=(0,a.Z)(i,2),c=s[0],l=s[1];if(!c){var p=function(e,t){var n=(0,u.I)(t);if(n)return["breakend",t];if(1===e.length&&1===t.length)return["SNV",f("SNV",e,t)];if("<INS>"===t)return["insertion",t];if("<DEL>"===t)return["deletion",t];if("<INV>"===t)return["inversion",t];if("<TRA>"===t)return["translocation",t];if(t.includes("<"))return["sv",t];if(e.length===t.length)return e.split("").reverse().join("")===t?["inversion",f("inversion",e,t)]:["substitution",f("substitution",e,t)];if(e.length<=t.length){var r=t.length-e.length,a=r.toLocaleString("en-US");return["insertion",r>5?a+"bp INS":f("insertion",e,t)]}if(e.length>t.length){var i=e.length-t.length,o=i.toLocaleString("en-US");return["deletion",i>5?o+"bp DEL":f("deletion",e,t)]}return["indel",f("indel",e,t)]}(e,t),h=(0,a.Z)(p,2);c=h[0],l=h[1]}c&&l&&(r.add(c),o.add(l))})),o.size>1){var s=(0,i.Z)(o),c=new Set(s.map((function(e){var t=e.split("->");return t[1]?t[0]:e})));o=new Set((0,i.Z)(c).map((function(e){return e.trim()})).map((function(e){var t=s.map((function(e){return e.split("->").map((function(e){return e.trim()}))})).map((function(t){return t[1]&&t[0]===e?t[1]:""})).filter((function(e){return!!e}));return t.length?"".concat(e," -> ").concat(t.join(",")):e})))}return r.size?[(0,i.Z)(r).join(","),(0,i.Z)(o).join(",")]:[]}function d(e,t,n){if("string"===typeof t&&!t.startsWith("<"))return[];var r=c[t];if(!r&&n.getMetadata("ALT",t)&&(r="sequence_variant"),r)return[r,t];var a=t.split(":");return a.length>1?d(e,"<".concat(a.slice(0,-1).join(":"),">"),n):[]}function f(e,t,n){return"".concat(e," ").concat(t," -> ").concat(n)}var p=function(){function e(t){(0,o.Z)(this,e),this.variant=void 0,this.parser=void 0,this.data=void 0,this._id=void 0,this.variant=t.variant,this.parser=t.parser,this.data=this.dataFromVariant(this.variant),this._id=t.id}return(0,s.Z)(e,[{key:"get",value:function(e){var t;return"samples"===e?this.variant.SAMPLES:null!==(t=this.data[e])&&void 0!==t?t:this.variant[e]}},{key:"set",value:function(){}},{key:"parent",value:function(){}},{key:"children",value:function(){}},{key:"tags",value:function(){return[].concat((0,i.Z)(Object.keys(this.data)),(0,i.Z)(Object.keys(this.variant)),["samples"])}},{key:"id",value:function(){return this._id}},{key:"dataFromVariant",value:function(e){var t=e.REF,n=e.ALT,r=e.POS,i=e.CHROM,o=e.INFO,s=e.ID,u=r-1,c=l(t,n,this.parser),d=(0,a.Z)(c,2),f=d[0],p=d[1],h=null===n||void 0===n?void 0:n.some((function(e){return"<TRA>"===e}));return{refName:i,start:u,end:(null===n||void 0===n?void 0:n.some((function(e){return e.includes("<")})))&&o.END&&!h?+o.END[0]:u+t.length,description:p,type:f,name:null===s||void 0===s?void 0:s.join(","),aliases:s&&s.length>1?e.ID.slice(1):void 0}}},{key:"toJSON",value:function(){return(0,r.Z)((0,r.Z)((0,r.Z)({uniqueId:this._id},this.variant),this.data),{},{samples:this.variant.SAMPLES})}}]),e}()},91211:function(e,t,n){"use strict";n.d(t,{B:function(){return q.Z},Z:function(){return _}});var r=n(9249),a=n(87371),i=n(45754),o=n(13820),s=n(93029),u=n(9077);var c=(0,u.ConfigurationSchema)("VcfAdapter",{vcfLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.vcf",locationType:"UriLocation"}}},{explicitlyTyped:!0}),l=n(40909);var d=(0,u.ConfigurationSchema)("VcfTabixAdapter",{vcfGzLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.vcf.gz",locationType:"UriLocation"}},index:(0,u.ConfigurationSchema)("VcfIndex",{indexType:{model:l.types.enumeration("IndexType",["TBI","CSI"]),type:"stringEnum",defaultValue:"TBI"},location:{type:"fileLocation",defaultValue:{uri:"/path/to/my.vcf.gz.tbi",locationType:"UriLocation"}}})},{explicitlyTyped:!0}),f=n(97891),p=n(82044),h=n(77479),g=n(99069);var m=function(e){return(0,u.ConfigurationSchema)("VariantTrack",{},{baseConfiguration:(0,g.createBaseTrackConfig)(e)})},v=n(49767),y=n(38787),b=n(81575);var w=function(e){return(0,u.ConfigurationSchema)("ChordVariantDisplay",{renderer:l.types.optional(e.pluggableConfigSchemaType("renderer"),{type:"StructuralVariantChordRenderer"})},{baseConfiguration:y._U,explicitlyTyped:!0})},x=n(33028),k=n(81073),Z=function(e){return l.types.compose("ChordVariantDisplay",y.pL,l.types.model({type:l.types.literal("ChordVariantDisplay"),configuration:(0,u.ConfigurationReference)(e)})).views((function(e){return{get rendererTypeName(){return e.configuration.renderer.type},renderProps:function(){var t=(0,k.getContainingView)(e);return(0,x.Z)((0,x.Z)({},(0,f.getParentRenderProps)(e)),{},{rpcDriverName:e.rpcDriverName,displayModel:e,bezierRadius:t.radiusPx*e.bezierRadiusRatio,radius:t.radiusPx,blockDefinitions:e.blockDefinitions,config:e.configuration.renderer,onChordClick:function(t){return e.onChordClick(t)}})}}}))},C=n(57211),S=n(32723),T=n(34795);function P(e){return l.types.compose("LinearVariantDisplay",(0,C.l0)(e),l.types.model({type:l.types.literal("LinearVariantDisplay"),configuration:(0,u.ConfigurationReference)(e)})).actions((function(e){return{selectFeature:function(t){return(0,T.Z)((0,S.Z)().mark((function n(){var r,a,i,o,s,c,l;return(0,S.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=(0,k.getSession)(e),!(0,k.isSessionModelWithWidgets)(r)){n.next=11;break}return a=r.rpcManager,i=(0,f.getRpcSessionId)(e),o=(0,k.getContainingTrack)(e),s=(0,k.getContainingView)(e),c=(0,u.getConf)(o,"adapter"),n.next=9,a.call(i,"CoreGetMetadata",{adapterConfig:c});case 9:l=n.sent,r.showWidget(r.addWidget("VariantFeatureWidget","variantFeature",{featureData:t.toJSON(),view:s,track:o,descriptions:l}));case 11:r.setSelection(t);case 12:case"end":return n.stop()}}),n)})))()}}}))}var M=function(e){e.addDisplayType((function(){var t=function(e){return(0,u.ConfigurationSchema)("LinearVariantDisplay",{},{baseConfiguration:(0,C.RH)(e),explicitlyTyped:!0})}(e);return new b.Z({name:"LinearVariantDisplay",displayName:"Variant display",configSchema:t,stateModel:P(t),trackType:"VariantTrack",viewType:"LinearGenomeView",ReactComponent:C.qb})}))},R=n(93073);var A=(0,u.ConfigurationSchema)("StructuralVariantChordRenderer",{strokeColor:{type:"color",description:"the line color of each arc",defaultValue:"rgba(255,133,0,0.32)",contextVariable:["feature"]},strokeColorSelected:{type:"color",description:"the line color of an arc that has been selected",defaultValue:"black",contextVariable:["feature"]},strokeColorHover:{type:"color",description:"the line color of an arc that is being hovered over with the mouse",defaultValue:"#555",contextVariable:["feature"]}},{explicitlyTyped:!0}),I=n(41361),L=n(30969),N=n(90550),F=n(68079),j=n(96234),D=n(6556),B=n(37574);function E(e,t){var n=e.region.elided?0:e.region.start,r=e.region.elided?0:e.region.end;return(e.flipped?r-t:t-n)/e.bpPerRadian+e.startRadians}var V=(0,N.observer)((function(e){var t,n,r,a,i=e.feature,o=e.blocksForRefs,s=e.radius,c=e.config,l=e.bezierRadius,d=e.selected,f=e.onClick,p=o[i.get("refName")];if(!p)return null;if(i.get("INFO")){var h=i.get("INFO").SVTYPE||[];n=(0,j.Z)(h,1)[0]}else i.get("mate")&&(n="mate");var g=null===(t=i.get("ALT"))||void 0===t?void 0:t[0],m=g&&(0,D.I)(g);if(m){var v=m.MatePosition.split(":");r=+v[1],a=o[v[0]]}else if("<TRA>"===g){var y,b,w,x,Z=null===(y=i.get("INFO"))||void 0===y||null===(b=y.CHR2)||void 0===b?void 0:b[0],C=null===(w=i.get("INFO"))||void 0===w||null===(x=w.END)||void 0===x?void 0:x[0];r=parseInt(C,10),a=o[Z]}else if("mate"===n){var S=i.get("mate"),T=S.refName;r=S.start,a=o[T]}if(a){var P=i.get("start"),M=E(p,P),R=E(a,r),A=(0,k.polarToCartesian)(s,M),I=(0,k.polarToCartesian)(s,R),L=(0,k.polarToCartesian)(l,(R+M)/2),N=d?(0,u.readConfObject)(c,"strokeColorSelected",{feature:i}):(0,u.readConfObject)(c,"strokeColor",{feature:i}),V=(0,u.readConfObject)(c,"strokeColorHover",{feature:i});return(0,B.jsx)("path",{"data-testid":"chord-".concat(i.id()),d:["M"].concat((0,F.Z)(A),["Q"],(0,F.Z)(L),(0,F.Z)(I)).join(" "),style:{stroke:N},onClick:function(e){a&&p&&f(i,p.region,a.region,e)},onMouseOver:function(e){d||(e.currentTarget.style.stroke=V,e.currentTarget.style.strokeWidth="3px")},onMouseOut:function(e){d||(e.currentTarget.style.stroke=N,e.currentTarget.style.strokeWidth="1px")}})}return null})),z=(0,N.observer)((function(e){var t,n=e.features,r=e.config,a=e.displayModel,i=e.blockDefinitions,o=e.radius,s=e.bezierRadius,u=e.displayModel.selectedFeatureId,c=e.onChordClick,l=(0,L.useMemo)((function(){var e={};return i.forEach((function(t){(t.region.elided?t.region.regions:[t.region]).forEach((function(n){return e[n.refName]=t}))})),e}),[i]),d=[],f=(0,I.Z)(n.values());try{for(f.s();!(t=f.n()).done;){var p=t.value,h=p.id(),g=String(u)===String(h);d.push((0,B.jsx)(V,{feature:p,config:r,radius:o,bezierRadius:s,blocksForRefs:l,selected:g,onClick:c},h))}}catch(v){f.e(v)}finally{f.f()}var m="chords-".concat("undefined"!==typeof jest?"test":a.id);return(0,B.jsxs)("g",{id:m,"data-testid":"structuralVariantChordRenderer",children:[(0,B.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n          #".concat(m," > path {\n            cursor: crosshair;\n            fill: none;\n          }\n")}}),d]})})),O=n(66737),W=n(81986),H=(0,u.ConfigurationSchema)("VariantFeatureWidget",{});function G(e){var t=(0,W.e$)(e);return l.types.compose(t,l.types.model("VariantFeatureWidget",{type:l.types.literal("VariantFeatureWidget"),descriptions:l.types.frozen()}))}var q=n(78867),_=function(e){(0,i.Z)(u,e);var t=(0,o.Z)(u);function u(){var e;(0,r.Z)(this,u);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).name="VariantsPlugin",e}return(0,a.Z)(u,[{key:"install",value:function(e){var t;!function(e){e.addAdapterType((function(){return new s.Z({name:"VcfAdapter",displayName:"VCF adapter",configSchema:c,getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(6362),n.e(8930)]).then(n.bind(n,38930)).then((function(e){return e.default}))}})}))}(e),function(e){e.addAdapterType((function(){return new s.Z({name:"VcfTabixAdapter",displayName:"VCF tabix adapter",configSchema:d,getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(2821),n.e(8022),n.e(8873)]).then(n.bind(n,98873)).then((function(e){return e.default}))}})}))}(e),function(e){e.addWidgetType((function(){return new O.Z({name:"VariantFeatureWidget",heading:"Feature details",configSchema:H,stateModel:G(e),ReactComponent:(0,L.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(1356),n.e(2942),n.e(9322)]).then(n.bind(n,24639))}))})}))}(e),(t=e).addTrackType((function(){var e=m(t);return new p.Z({name:"VariantTrack",displayName:"Variant track",configSchema:e,stateModel:(0,h.createBaseTrackModel)(t,"VariantTrack",e)})})),function(e){e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="VcfTabixAdapter",i=(0,f.getFileName)(t),o=n&&(0,f.getFileName)(n),s={type:a,vcfGzLocation:t,index:{location:n||(0,f.makeIndex)(t,".tbi"),indexType:(0,f.makeIndexType)(o,"CSI","TBI")}};return/\.vcf\.b?gz$/i.test(i)&&!r||r===a?s:e(t,n,r)}})),e.addToExtensionPoint("Core-guessTrackTypeForLocation",(function(e){return function(t){return"VcfTabixAdapter"===t||"VcfAdapter"===t?"VariantTrack":e(t)}})),e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="VcfAdapter",i=(0,f.getFileName)(t);return/\.vcf$/i.test(i)||r===a?{type:a,vcfLocation:t}:e(t,n,r)}}))}(e),M(e),function(e){e.addRendererType((function(){return new R.Z({name:"StructuralVariantChordRenderer",displayName:"SV chord renderer",ReactComponent:z,configSchema:A,pluginManager:e})}))}(e),function(e){e.addDisplayType((function(){var t=w(e),n=Z(t);return new b.Z({name:"ChordVariantDisplay",displayName:"Chord variant display",configSchema:t,stateModel:n,trackType:"VariantTrack",viewType:"CircularView",ReactComponent:y.lJ})}))}(e)}}]),u}(v.Z)},15697:function(e,t,n){"use strict";n.r(t);var r=n(33028),a=(n(30969),n(90550)),i=n(81073),o=n(9077),s=n(57211),u=n(70765),c=n(37574),l=(0,a.observer)((function(e){var t=e.model,n=t.stats,a=t.height,l=t.needsScalebar,d=(0,i.getContainingView)(t).trackLabels,f=(0,i.getContainingTrack)(t),p="overlapping"===d?(0,i.measureText)((0,o.getConf)(f,"name"),12.8)+100:50;return(0,c.jsxs)("div",{children:[(0,c.jsx)(s.qb,(0,r.Z)({},e)),n&&l?(0,c.jsx)("svg",{style:{position:"absolute",top:0,left:p,pointerEvents:"none",height:a,width:50},children:(0,c.jsx)(u.Z,{model:t})}):null]})}));t.default=l},39727:function(e,t,n){"use strict";n.d(t,{Xl:function(){return Ae.default},u:function(){return Ce},Aq:function(){return w},Eh:function(){return ie},Rv:function(){return E},ZP:function(){return gt},P$:function(){return z},yZ:function(){return V},LT:function(){return Re}});var r={};n.r(r),n.d(r,{YSCALEBAR_LABEL_OFFSET:function(){return E},getNiceDomain:function(){return O},getOrigin:function(){return z},getQuantitativeStats:function(){return W},getScale:function(){return V},quantitativeStatsAutorun:function(){return G},round:function(){return _},toP:function(){return q}});var a=n(9249),i=n(87371),o=n(45754),s=n(13820),u=n(49767),c=n(97891),l=n(32723),d=n(33028),f=n(59740),p=n(96234),h=n(34795),g=n(93069),m=n(95058),v=n(29637),y=n(81073),b=["reducedFeatures"],w=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).supportsSVG=!0,e}return(0,i.Z)(n,[{key:"render",value:function(){var e=(0,h.Z)((0,l.Z)().mark((function e(t){var r,a,i,o,s,u,c,h,v,w,x,k=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getFeatures(t);case 2:return r=e.sent,a=t.height,i=t.regions,o=t.bpPerPx,s=(0,p.Z)(i,1),u=s[0],c=(u.end-u.start)/o,e.next=8,(0,y.renderToAbstractCanvas)(c,a,t,(function(e){return k.draw(e,(0,d.Z)((0,d.Z)({},t),{},{features:r}))}));case 8:return h=e.sent,v=h.reducedFeatures,w=(0,f.Z)(h,b),e.next=13,(0,g.Z)((0,m.Z)(n.prototype),"render",this).call(this,(0,d.Z)((0,d.Z)((0,d.Z)({},t),w),{},{features:r,height:a,width:c}));case 13:return x=e.sent,e.abrupt("return",(0,d.Z)((0,d.Z)((0,d.Z)({},x),w),{},{features:v?new Map(v.map((function(e){return[e.id(),e]}))):x.features,height:a,width:c,containsNoTransferables:!0}));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(v.default),x=n(93029),k=n(9077);var Z=(0,k.ConfigurationSchema)("BigWigAdapter",{bigWigLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bw",locationType:"UriLocation"}},source:{type:"string",defaultValue:"",description:"Used for multiwiggle"}},{explicitlyTyped:!0}),C=n(77479),S=n(82044);var T=function(e){return(0,k.ConfigurationSchema)("QuantitativeTrack",{},{baseConfiguration:(0,C.createBaseTrackConfig)(e)})};var P=function(e){return(0,k.ConfigurationSchema)("MultiQuantitativeTrack",{},{baseConfiguration:(0,C.createBaseTrackConfig)(e)})};var M=(0,k.ConfigurationSchema)("MultiWiggleAdapter",{subadapters:{type:"frozen",defaultValue:[],description:"array of subadapter JSON objects"},bigWigs:{type:"frozen",description:"array of bigwig filenames, alternative to the subadapters slot",defaultValue:[]}},{explicitlyTyped:!0}),R=n(40909);var A=(0,k.ConfigurationSchema)("WiggleRenderer",{color:{type:"color",description:"the color of track, overrides posColor and negColor",defaultValue:"#f0f"},posColor:{type:"color",description:"the color to use when the score is positive",defaultValue:"blue"},negColor:{type:"color",description:"the color to use when the score is negative",defaultValue:"red"},clipColor:{type:"color",description:"the color of the clipping marker",defaultValue:"red"},bicolorPivot:{type:"stringEnum",model:R.types.enumeration("Scale type",["numeric","mean","z_score","none"]),description:"type of bicolor pivot",defaultValue:"numeric"},bicolorPivotValue:{type:"number",defaultValue:0,description:"value to use for bicolor pivot"}},{explicitlyTyped:!0});var I=(0,k.ConfigurationSchema)("DensityRenderer",{},{baseConfiguration:A,explicitlyTyped:!0}),L=n(41361),N=n(10346),F=n(83005),j=n(62872),D=n(69359),B=n(90689),E=5;function V(e){var t,n=e.domain,r=void 0===n?[]:n,a=e.range,i=void 0===a?[]:a,o=e.scaleType,s=e.pivotValue,u=e.inverted,c=(0,p.Z)(r,2),l=c[0],d=c[1];if(void 0===l||void 0===d)throw new Error("invalid domain");if("linear"===o)t=(0,F.Z)();else if("log"===o)(t=(0,j.Z)()).base(2);else{if("quantize"!==o)throw new Error("undefined scaleType");t=(0,D.Z)()}t.domain(void 0!==s?[l,s,d]:[l,d]),t.nice();var f=(0,p.Z)(i,2),h=f[0],g=f[1];if(void 0===h||void 0===g)throw new Error("invalid range");return t.range(u?i.slice().reverse():i),t}function z(e){return"log"===e?1:0}function O(e){var t=e.scaleType,n=e.domain,r=e.bounds,a=(0,p.Z)(r,2),i=a[0],o=a[1],s=(0,p.Z)(n,2),u=s[0],c=s[1];if("linear"===t&&(c<0&&(c=0),u>0&&(u=0)),"log"===t&&(0===u||u>1)&&(u=1),void 0===u||void 0===c)throw new Error("invalid domain supplied to stats function");void 0!==i&&i!==Number.MIN_VALUE&&(u=i),void 0!==o&&o!==Number.MAX_VALUE&&(c=o);var l=function(e){if("linear"===e)return(0,F.Z)();if("log"===e){var t=(0,j.Z)();return t.base(2),t}if("quantize"===e)return(0,D.Z)();throw new Error("undefined scaleType ".concat(e))}(t);return l.domain([u,c]),l.nice(),l.domain()}function W(e,t){return H.apply(this,arguments)}function H(){return(H=(0,h.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o,s,u,f,p,h,g,m,v,b,w,x,Z,C,S;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(0,y.getSession)(t),a=r.rpcManager,i=(0,k.getConf)(t,"numStdDev")||3,o=t.adapterConfig,s=t.autoscaleType,u=(0,c.getRpcSessionId)(t),f=(0,d.Z)({sessionId:u,adapterConfig:o,statusCallback:function(e){(0,R.isAlive)(t)&&t.setMessage(e)}},n),"global"!==s&&"globalsd"!==s){e.next=11;break}return e.next=8,a.call(u,"WiggleGetGlobalQuantitativeStats",f);case 8:return p=e.sent,h=p.scoreMin,g=p.scoreMean,m=p.scoreStdDev,e.abrupt("return","globalsd"===s?(0,d.Z)((0,d.Z)({},p),{},{scoreMin:h>=0?0:g-i*m,scoreMax:g+i*m}):p);case 11:if("local"!==s&&"localsd"!==s){e.next=18;break}return v=(0,y.getContainingView)(t),b=v.dynamicBlocks,w=v.bpPerPx,e.next=15,a.call(u,"WiggleGetMultiRegionQuantitativeStats",(0,d.Z)((0,d.Z)({},f),{},{regions:b.contentBlocks.map((function(e){var t=e.start,n=e.end;return(0,d.Z)((0,d.Z)({},JSON.parse(JSON.stringify(e))),{},{start:Math.floor(t),end:Math.ceil(n)})})),bpPerPx:w}));case 15:return x=e.sent,Z=x.scoreMin,C=x.scoreMean,S=x.scoreStdDev,e.abrupt("return","localsd"===s?(0,d.Z)((0,d.Z)({},x),{},{scoreMin:Z>=0?0:C-i*S,scoreMax:C+i*S}):x);case 18:if("zscale"!==s){e.next=20;break}return e.abrupt("return",a.call(u,"WiggleGetGlobalQuantitativeStats",f));case 20:throw new Error("invalid autoscaleType '".concat(s,"'"));case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(e){(0,R.addDisposer)(e,(0,B.autorun)((0,h.Z)((0,l.Z)().mark((function t(){var n,r,a,i;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=new AbortController,r=(0,y.getContainingView)(e),e.setLoading(n),r.initialized&&e.featureDensityStatsReady&&!e.regionTooLarge&&!e.error){t.next=6;break}return t.abrupt("return");case 6:return a=JSON.stringify(r.dynamicBlocks),t.next=9,W(e,(0,d.Z)({signal:n.signal},e.renderProps()));case 9:i=t.sent,(0,R.isAlive)(e)&&e.updateQuantitativeStats(i,a),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),!(0,y.isAbortException)(t.t0)&&(0,R.isAlive)(e)&&(console.error(t.t0),e.setError(t.t0));case 16:case"end":return t.stop()}}),t,null,[[0,13]])}))),{delay:1e3}))}function q(){return+(+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)).toPrecision(6)}function _(e){return Math.round(1e5*e)/1e5}function U(e,t){var n=e.toHsl(),r=n.l*(1+t);return(0,N.V)((0,d.Z)((0,d.Z)({},n),{},{l:(0,y.clamp)(r,0,100)}))}function J(e,t){var n=e.toHsl(),r=n.l*(1-t);return(0,N.V)((0,d.Z)((0,d.Z)({},n),{},{l:(0,y.clamp)(r,0,100)}))}function X(e,t,n,r,a,i){n<0&&(e+=n,n=-n),r<0&&(t+=r,r=-r),i&&(a.fillStyle=i),a.fillRect(e,t,n,r)}var Y=.3;function Q(e,t){var n=t.features,r=t.bpPerPx,a=t.regions,i=t.scaleOpts,o=t.height,s=t.config,u=t.ticks,c=t.displayCrossHatches,l=t.offset,f=void 0===l?0:l,h=t.colorCallback,g=(0,p.Z)(a,1)[0],m=(g.end-g.start)/r,v=o-2*f,b=(0,k.readConfObject)(s,"filled"),w=(0,k.readConfObject)(s,"clipColor"),x=(0,k.readConfObject)(s,"summaryScoreMode"),Z=(0,k.readConfObject)(s,"bicolorPivotValue"),C=(0,k.readConfObject)(s,"minSize"),S=V((0,d.Z)((0,d.Z)({},i),{},{range:[0,v]})),T=z(i.scaleType),P=S.domain(),M=(0,p.Z)(P,2),R=M[0],A=M[1],I=function(e){return(0,y.clamp)(v-(S(e)||0),0,v)+f},F=function(e){return b?function(e){return I(T)-I(e)}(e):Math.max(C,1)},j=!1,D=-1/0,B=[],E=R<Z&&A>Z;if("whiskers"===x){var O,W,H,G=(0,L.Z)(n.values());try{for(G.s();!(H=G.n()).done;){var q=H.value,_=(0,y.featureSpanPx)(q,g,r),Q=(0,p.Z)(_,2),K=Q[0],$=Q[1];if(q.get("summary")){var ee=Math.max($-K+Y,C),te=q.get("maxScore"),ne=h(q,te),re=E?ne:ne===O?W:W=U((0,N.V)(ne),.4).toHex();X(K,I(te),ee,F(te),e,re),O=ne}}}catch(Xe){G.e(Xe)}finally{G.f()}W=void 0,O=void 0;var ae,ie=(0,L.Z)(n.values());try{for(ie.s();!(ae=ie.n()).done;){var oe=ae.value,se=(0,y.featureSpanPx)(oe,g,r),ue=(0,p.Z)(se,2),ce=ue[0],le=ue[1],de=oe.get("score"),fe=oe.get("maxScore"),pe=oe.get("minScore"),he=oe.get("summary"),ge=h(oe,de),me=E&&he?ge===O?W:W=(0,N.V)(h(oe,fe)).mix((0,N.V)(h(oe,pe))).toString():ge,ve=Math.max(le-ce+Y,C);Math.floor(ce)!==Math.floor(D)&&(B.push(oe),D=ce),j=j||de<R||de>A,X(ce,I(de),ve,F(de),e,me),O=ge}}catch(Xe){ie.e(Xe)}finally{ie.f()}W=void 0,O=void 0;var ye,be=(0,L.Z)(n.values());try{for(be.s();!(ye=be.n()).done;){var we=ye.value,xe=(0,y.featureSpanPx)(we,g,r),ke=(0,p.Z)(xe,2),Ze=ke[0],Ce=ke[1];if(we.get("summary")){var Se=we.get("minScore"),Te=h(we,Se),Pe=Math.max(Ce-Ze+Y,C),Me=E?Te:Te===O?W:W=J((0,N.V)(Te),.4).toHex();X(Ze,I(Se),Pe,F(Se),e,Me),O=Te}}}catch(Xe){be.e(Xe)}finally{be.f()}}else{var Re,Ae=(0,L.Z)(n.values());try{for(Ae.s();!(Re=Ae.n()).done;){var Ie=Re.value,Le=(0,y.featureSpanPx)(Ie,g,r),Ne=(0,p.Z)(Le,2),Fe=Ne[0],je=Ne[1];Math.floor(Fe)!==Math.floor(D)&&(B.push(Ie),D=Fe);var De=Ie.get("score"),Be=h(Ie,De);j=j||De<R||De>A;var Ee=Math.max(je-Fe+Y,C);if("max"===x){var Ve=Ie.get("summary")?Ie.get("maxScore"):De;X(Fe,I(Ve),Ee,F(Ve),e,Be)}else if("min"===x){var ze=Ie.get("summary")?Ie.get("minScore"):De;X(Fe,I(ze),Ee,F(ze),e,Be)}else X(Fe,I(De),Ee,F(De),e,Be)}}catch(Xe){Ae.e(Xe)}finally{Ae.f()}}if(e.save(),j){e.fillStyle=w;var Oe,We=(0,L.Z)(n.values());try{for(We.s();!(Oe=We.n()).done;){var He=Oe.value,Ge=(0,y.featureSpanPx)(He,g,r),qe=(0,p.Z)(Ge,2),_e=qe[0],Ue=qe[1]-_e+Y,Je=He.get("score");Je>A?X(_e,f,Ue,2,e):Je<R&&"log"!==i.scaleType&&X(_e,o,Ue,2,e)}}catch(Xe){We.e(Xe)}finally{We.f()}}return e.restore(),c&&(e.lineWidth=1,e.strokeStyle="rgba(200,200,200,0.5)",u.values.forEach((function(t){e.beginPath(),e.moveTo(0,Math.round(I(t))),e.lineTo(m,Math.round(I(t))),e.stroke()}))),{reducedFeatures:B}}function K(e,t){var n,r,a=t.features,i=t.regions,o=t.bpPerPx,s=t.scaleOpts,u=t.height,c=t.ticks.values,l=t.displayCrossHatches,f=t.colorCallback,h=t.config,g=t.offset,m=void 0===g?0:g,v=(0,p.Z)(i,1)[0],b=(v.end-v.start)/o,w=u-2*m,x=(0,k.readConfObject)(h,"clipColor"),Z=V((0,d.Z)((0,d.Z)({},s),{},{range:[0,w]})),C=Z.domain(),S=(0,p.Z)(C,2),T=S[0],P=S[1],M=function(e){return(0,y.clamp)(w-(Z(e)||0),0,w)+m},R=-1/0,A=[],I=(0,L.Z)(a.values());try{for(I.s();!(r=I.n()).done;){var N=r.value,F=(0,y.featureSpanPx)(N,v,o),j=(0,p.Z)(F,2),D=j[0],B=j[1];Math.floor(D)!==Math.floor(R)&&(A.push(N),R=D);var E=N.get("score"),z=E<T,O=E>P,W=B-D+Y,H=f(N,E);e.beginPath(),e.strokeStyle=H;var G=void 0!==n?n:E;v.reversed?(e.moveTo(B,M(G)),e.lineTo(B,M(E)),e.lineTo(D,M(E))):(e.moveTo(D,M(G)),e.lineTo(D,M(E)),e.lineTo(B,M(E))),e.stroke(),n=E,O?(e.fillStyle=x,e.fillRect(D,m,W,2)):z&&"log"!==s.scaleType&&(e.fillStyle=x,e.fillRect(D,w-2,W,w))}}catch(q){I.e(q)}finally{I.f()}return l&&(e.lineWidth=1,e.strokeStyle="rgba(200,200,200,0.5)",c.forEach((function(t){e.beginPath(),e.moveTo(0,Math.round(M(t))),e.lineTo(b,Math.round(M(t))),e.stroke()}))),{reducedFeatures:A}}function $(e,t){var n,r=t.features,a=t.regions,i=t.bpPerPx,o=t.scaleOpts,s=t.height,u=t.config,c=(0,p.Z)(a,1)[0],l=(0,k.readConfObject)(u,"bicolorPivot"),f=(0,k.readConfObject)(u,"bicolorPivotValue"),h=(0,k.readConfObject)(u,"negColor"),g=(0,k.readConfObject)(u,"posColor"),m=(0,k.readConfObject)(u,"color"),v=(0,k.readConfObject)(u,"clipColor"),b="none"!==l&&"log"!==o.scaleType,w=V((0,d.Z)((0,d.Z)({},o),{},{pivotValue:b?f:void 0,range:b?[h,"white",g]:["white",g]})),x="#f0f"===m?function(e,t){return w(t)}:function(e,t){return(0,k.readConfObject)(u,"color",{feature:e,score:t})},Z=V((0,d.Z)((0,d.Z)({},o),{},{range:[0,s]})).domain(),C=(0,p.Z)(Z,2),S=C[0],T=C[1],P=-1/0,M=!1,R=[],A=(0,L.Z)(r.values());try{for(A.s();!(n=A.n()).done;){var I=n.value,N=(0,y.featureSpanPx)(I,c,i),F=(0,p.Z)(N,2),j=F[0],D=F[1];Math.floor(j)!==Math.floor(P)&&(R.push(I),P=j);var B=I.get("score");M=M||B>T||B<S;var E=D-j+Y;e.fillStyle=x(I,B),e.fillRect(j,0,E,s)}}catch(J){A.e(J)}finally{A.f()}if(e.save(),M){e.fillStyle=v;var z,O=(0,L.Z)(r.values());try{for(O.s();!(z=O.n()).done;){var W=z.value,H=(0,y.featureSpanPx)(W,c,i),G=(0,p.Z)(H,2),q=G[0],_=G[1]-q+Y,U=W.get("score");(U>T||U<S&&"log"!==o.scaleType)&&X(q,0,_,2,e)}}catch(J){O.e(J)}finally{O.f()}}return e.restore(),{reducedFeatures:R}}var ee=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"draw",value:function(){var e=(0,h.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$(t,n));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(w),te=n(90550),ne=n(30969),re=n(59767),ae=n(37574),ie=(0,te.observer)((function(e){var t=e.regions,n=e.features,r=e.bpPerPx,a=e.width,i=e.height,o=e.onMouseLeave,s=void 0===o?function(){}:o,u=e.onMouseMove,c=void 0===u?function(){}:u,l=e.onFeatureClick,f=void 0===l?function(){}:l,h=(0,p.Z)(t,1)[0],g=(0,ne.useRef)(null);function m(e){var t=0;g.current&&(t=g.current.getBoundingClientRect().left);var i,o,s=e-t,u=h.reversed?a-s:s,c=h.start+r*u,l=(0,L.Z)(n.values());try{for(l.s();!(o=l.n()).done;){var d=o.value;if(c<=d.get("end")+r&&c>=d.get("start")){i=d;break}}}catch(f){l.e(f)}finally{l.f()}return i}return(0,ae.jsx)("div",{ref:g,"data-testid":"wiggle-rendering-test",onMouseMove:function(e){var t;return c(e,null===(t=m(e.clientX))||void 0===t?void 0:t.id())},onClick:function(e){var t;return f(e,null===(t=m(e.clientX))||void 0===t?void 0:t.id())},onMouseLeave:function(e){return s(e)},style:{overflow:"visible",position:"relative",height:i},children:(0,ae.jsx)(re.PrerenderedCanvas,(0,d.Z)({},e))})})),oe=n(68079),se=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"draw",value:function(){var e=(0,h.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.features,a=n.config,i=(0,k.readConfObject)(a,"bicolorPivotValue"),o=(0,k.readConfObject)(a,"negColor"),s=(0,k.readConfObject)(a,"posColor"),e.abrupt("return",Q(t,(0,d.Z)((0,d.Z)({},n),{},{colorCallback:"#f0f"===(0,k.readConfObject)(a,"color")?function(e,t){return t<i?o:s}:function(e,t){return(0,k.readConfObject)(a,"color",{feature:e})},offset:E,features:(0,oe.Z)(r.values())})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(w);var ue=(0,k.ConfigurationSchema)("XYPlotRenderer",{filled:{type:"boolean",defaultValue:!0},displayCrossHatches:{type:"boolean",description:"choose to draw cross hatches (sideways lines)",defaultValue:!1},summaryScoreMode:{type:"stringEnum",model:R.types.enumeration("Score type",["max","min","avg","whiskers"]),description:"choose whether to use max/min/average or whiskers which combines all three into the same rendering",defaultValue:"whiskers"},minSize:{type:"number",defaultValue:0}},{baseConfiguration:A,explicitlyTyped:!0});var ce=(0,k.ConfigurationSchema)("LinePlotRenderer",{displayCrossHatches:{type:"boolean",description:"choose to draw cross hatches (sideways lines)",defaultValue:!1}},{baseConfiguration:A,explicitlyTyped:!0}),le=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"draw",value:function(){var e=(0,h.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",K(t,(0,d.Z)((0,d.Z)({},n),{},{offset:E,colorCallback:function(){return"grey"}})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(w),de=n(81575),fe=n(57211);function pe(){return(0,k.ConfigurationSchema)("MultiLinearWiggleDisplay",{autoscale:{type:"stringEnum",defaultValue:"local",model:R.types.enumeration("Autoscale type",["global","local","globalsd","localsd","zscore"]),description:"global/local using their min/max values or w/ standard deviations (globalsd/localsd)"},minimalTicks:{type:"boolean",defaultValue:!1,description:"use the minimal amount of ticks"},minScore:{type:"number",defaultValue:Number.MIN_VALUE,description:"minimum value for the y-scale"},maxScore:{type:"number",description:"maximum value for the y-scale",defaultValue:Number.MAX_VALUE},numStdDev:{type:"number",description:"number of standard deviations to use for autoscale types globalsd or localsd",defaultValue:3},scaleType:{type:"stringEnum",model:R.types.enumeration("Scale type",["linear","log"]),description:"The type of scale to use",defaultValue:"linear"},inverted:{type:"boolean",description:"draw upside down",defaultValue:!1}},{baseConfiguration:fe.fU,explicitlyTyped:!0})}var he=n(58663),ge=n(74262),me=n(46622),ve=n(53276),ye=n(72779),be=(0,ve.ZL)()((function(e){return{tooltip:{position:"absolute",pointerEvents:"none",backgroundColor:(0,ge.Fq)(e.palette.grey[700],.9),borderRadius:e.shape.borderRadius,color:e.palette.common.white,fontFamily:e.typography.fontFamily,padding:"4px 8px",fontSize:e.typography.pxToRem(12),lineHeight:"".concat(_(1.4),"em"),maxWidth:300,wordWrap:"break-word"},hoverVertical:{background:"#333",border:"none",width:1,height:"100%",top:E,cursor:"default",position:"absolute",pointerEvents:"none"}}})),we=(0,te.observer)((function(e){var t=e.model,n=e.height,r=e.clientMouseCoord,a=e.offsetMouseCoord,i=e.clientRect,o=e.TooltipContents,s=e.useClientY,u=t.featureUnderMouse,c=(0,ne.useState)(0),l=(0,p.Z)(c,2),f=l[0],h=l[1],g=(0,ne.useState)(null),m=(0,p.Z)(g,2),v=m[0],y=m[1],b=be().classes,w=(0,ne.useMemo)((function(){return{getBoundingClientRect:function(){var e=r[0]+f/2+20,t=s?r[1]:(null===i||void 0===i?void 0:i.top)||0;return{top:t,left:e,bottom:t,right:e,width:0,height:0,x:e,y:t,toJSON:function(){}}}}}),[null===i||void 0===i?void 0:i.top,r,f,s]),x=(0,ye.D)(w,v),k=x.styles,Z=x.attributes;return u?(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(me.h,{children:(0,ae.jsx)("div",(0,d.Z)((0,d.Z)({ref:y,className:b.tooltip,style:(0,d.Z)((0,d.Z)({},k.popper),{},{zIndex:1e5})},Z.popper),{},{children:(0,ae.jsx)(o,{ref:function(e){return h((null===e||void 0===e?void 0:e.getBoundingClientRect().width)||0)},model:t,feature:u})}))}),(0,ae.jsx)("div",{className:b.hoverVertical,style:{left:a[0],height:n-2*E}})]}):null})),xe=we,ke=function(e){return e.toLocaleString("en-US")},Ze=ne.forwardRef((function(e,t){var n=e.feature,r=n.get("start"),a=n.get("end"),i=[n.get("refName"),r===a?ke(r):"".concat(ke(r),"..").concat(ke(a))].filter((function(e){return!!e})).join(":");return void 0!==n.get("summary")?(0,ae.jsxs)("div",{ref:t,children:[i,(0,ae.jsx)("br",{}),"Max: ",q(n.get("maxScore")),(0,ae.jsx)("br",{}),"Avg: ",q(n.get("score")),(0,ae.jsx)("br",{}),"Min: ",q(n.get("minScore"))]}):(0,ae.jsxs)("div",{ref:t,children:[i,(0,ae.jsx)("br",{}),"".concat(q(n.get("score")))]})})),Ce=(0,te.observer)((function(e){return(0,ae.jsx)(xe,(0,d.Z)({TooltipContents:Ze},e))})),Se=(0,ne.lazy)((function(){return n.e(9623).then(n.bind(n,29623))}));function Te(e){return R.types.compose(fe.fV,R.types.model({selectedRendering:R.types.optional(R.types.string,""),resolution:R.types.optional(R.types.number,1),fill:R.types.maybe(R.types.boolean),minSize:R.types.maybe(R.types.number),color:R.types.maybe(R.types.string),posColor:R.types.maybe(R.types.string),negColor:R.types.maybe(R.types.string),summaryScoreMode:R.types.maybe(R.types.string),rendererTypeNameState:R.types.maybe(R.types.string),scale:R.types.maybe(R.types.string),autoscale:R.types.maybe(R.types.string),displayCrossHatches:R.types.maybe(R.types.boolean),constraints:R.types.optional(R.types.model({max:R.types.maybe(R.types.number),min:R.types.maybe(R.types.number)}),{}),configuration:(0,k.ConfigurationReference)(e)})).volatile((function(){return{message:void 0,stats:void 0,statsFetchInProgress:void 0}})).actions((function(e){return{updateQuantitativeStats:function(t){var n=t.scoreMin,r=t.scoreMax,a=1e-6;e.stats?(Math.abs(e.stats.scoreMax-r)>a||Math.abs(e.stats.scoreMin-n)>a)&&(e.stats={scoreMin:n,scoreMax:r}):e.stats={scoreMin:n,scoreMax:r}},setColor:function(t){e.color=t},setPosColor:function(t){e.posColor=t},setNegColor:function(t){e.negColor=t},setLoading:function(t){var n=e.statsFetchInProgress;void 0===n||n.signal.aborted||n.abort(),e.statsFetchInProgress=t},selectFeature:function(t){var n=(0,y.getSession)(e);(0,y.isSelectionContainer)(n)&&n.setSelection(t)},setResolution:function(t){e.resolution=t},setFill:function(t){0===t?(e.fill=!0,e.minSize=0):1===t?(e.fill=!1,e.minSize=1):2===t&&(e.fill=!1,e.minSize=2)},toggleLogScale:function(){e.scale="log"===e.scale?"linear":"log"},setScaleType:function(t){e.scale=t},setSummaryScoreMode:function(t){e.summaryScoreMode=t},setAutoscale:function(t){e.autoscale=t},setMaxScore:function(t){e.constraints.max=t},setRendererType:function(t){e.rendererTypeNameState=t},setMinScore:function(t){e.constraints.min=t},toggleCrossHatches:function(){e.displayCrossHatches=!e.displayCrossHatches},setCrossHatches:function(t){e.displayCrossHatches=t}}})).views((function(e){return{get adapterTypeName(){return e.adapterConfig.type},get rendererTypeNameSimple(){var t;return null!==(t=e.rendererTypeNameState)&&void 0!==t?t:(0,k.getConf)(e,"defaultRendering")},get filters(){},get scaleType(){var t;return null!==(t=e.scale)&&void 0!==t?t:(0,k.getConf)(e,"scaleType")},get maxScore(){var t;return null!==(t=e.constraints.max)&&void 0!==t?t:(0,k.getConf)(e,"maxScore")},get minScore(){var t;return null!==(t=e.constraints.min)&&void 0!==t?t:(0,k.getConf)(e,"minScore")}}})).views((function(e){return{get adapterCapabilities(){var t=e.adapterTypeName;return(0,y.getEnv)(e).pluginManager.getAdapterType(t).adapterCapabilities},get rendererConfig(){var t=e.color,n=e.displayCrossHatches,r=e.fill,a=e.minSize,i=e.negColor,o=e.posColor,s=e.summaryScoreMode,u=e.scaleType,c=e.rendererTypeName,l=(0,k.getConf)(e,["renderers",c])||{};return e.rendererType.configSchema.create((0,d.Z)((0,d.Z)((0,d.Z)((0,d.Z)((0,d.Z)((0,d.Z)((0,d.Z)((0,d.Z)((0,d.Z)({},l),u?{scaleType:u}:{}),void 0!==r?{filled:r}:{}),void 0!==n?{displayCrossHatches:n}:{}),void 0!==s?{summaryScoreMode:s}:{}),void 0!==t?{color:t}:{}),void 0!==i?{negColor:i}:{}),void 0!==o?{posColor:o}:{}),void 0!==a?{minSize:a}:{}),(0,y.getEnv)(e))},get autoscaleType(){var t;return null!==(t=e.autoscale)&&void 0!==t?t:(0,k.getConf)(e,"autoscale")}}})).views((function(e){var t=[0,0];return{get domain(){var n=e.stats,r=e.scaleType,a=e.minScore,i=e.maxScore;if(n){var o=O({domain:[n.scoreMin,n.scoreMax],bounds:[a,i],scaleType:r});return"log"===r&&o[1]===Number.MIN_VALUE?[0,Number.MIN_VALUE]:(JSON.stringify(t)!==JSON.stringify(o)&&(t=o),t)}}}})).views((function(e){return{get filled(){var t=e.fill,n=e.rendererConfig;return null!==t&&void 0!==t?t:(0,k.readConfObject)(n,"filled")},get summaryScoreModeSetting(){var t=e.summaryScoreMode,n=e.rendererConfig;return null!==t&&void 0!==t?t:(0,k.readConfObject)(n,"summaryScoreMode")},get scaleOpts(){return{domain:e.domain,stats:e.stats,autoscaleType:e.autoscaleType,scaleType:e.scaleType,inverted:(0,k.getConf)(e,"inverted")}},get canHaveFill(){return"XYPlotRenderer"===e.rendererTypeName},get displayCrossHatchesSetting(){var t=e.displayCrossHatches,n=e.rendererConfig;return null!==t&&void 0!==t?t:(0,k.readConfObject)(n,"displayCrossHatches")},get hasResolution(){return e.adapterCapabilities.includes("hasResolution")},get hasGlobalStats(){return e.adapterCapabilities.includes("hasGlobalStats")}}})).views((function(e){return{scoreTrackMenuItems:function(){return[].concat((0,oe.Z)(e.hasResolution?[{label:"Resolution",subMenu:[{label:"Finer resolution",onClick:function(){return e.setResolution(5*e.resolution)}},{label:"Coarser resolution",onClick:function(){return e.setResolution(e.resolution/5)}}]},{label:"Summary score mode",subMenu:["min","max","avg","whiskers"].map((function(t){return{label:t,type:"radio",checked:e.summaryScoreModeSetting===t,onClick:function(){return e.setSummaryScoreMode(t)}}}))}]:[]),[{label:"log"===e.scaleType?"Set linear scale":"Set log scale",onClick:function(){return e.toggleLogScale()}},{label:"Autoscale type",subMenu:[["local","Local"]].concat((0,oe.Z)(e.hasGlobalStats?[["global","Global"],["globalsd","Global \xb1 3\u03c3"]]:[]),[["localsd","Local \xb1 3\u03c3"]]).map((function(t){var n=(0,p.Z)(t,2),r=n[0];return{label:n[1],type:"radio",checked:e.autoscaleType===r,onClick:function(){return e.setAutoscale(r)}}}))},{label:"Set min/max score",onClick:function(){(0,y.getSession)(e).queueDialog((function(t){return[Se,{model:e,handleClose:t}]}))}}])}}})).actions((function(e){var t=e.reload;return{reload:function(){return(0,h.Z)((0,l.Z)().mark((function n(){return(0,l.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.setError(),t();case 2:case"end":return n.stop()}}),n)})))()}}}))}var Pe=(0,ne.lazy)((function(){return n.e(6082).then(n.bind(n,56082))})),Me=new Map([["xyplot","XYPlotRenderer"],["density","DensityRenderer"],["line","LinePlotRenderer"]]);var Re=function(e,t){return R.types.compose("LinearWiggleDisplay",Te(t),R.types.model({type:R.types.literal("LinearWiggleDisplay")})).views((function(e){return{get TooltipComponent(){return Ce},get rendererTypeName(){var t=e.rendererTypeNameSimple,n=Me.get(t);if(!n)throw new Error("unknown renderer ".concat(t));return n}}})).views((function(e){return{get ticks(){var t=e.scaleType,n=e.domain,r=e.height,a=(0,k.getConf)(e,"minimalTicks"),i=(0,k.getConf)(e,"inverted");if(n){var o=V({scaleType:t,domain:n,range:[r-E,E],inverted:i}),s=(0,he.axisPropsFromTickScale)(o,4);return r<100||a?(0,d.Z)((0,d.Z)({},s),{},{values:n}):s}}}})).views((function(e){var t=e.renderProps;return{renderProps:function(){var n=t(),r=e.filters,a=e.ticks,i=e.height,o=e.resolution,s=e.scaleOpts;return(0,d.Z)((0,d.Z)({},n),{},{notReady:n.notReady||!e.stats,rpcDriverName:e.rpcDriverName,displayModel:e,config:e.rendererConfig,displayCrossHatches:e.displayCrossHatchesSetting,scaleOpts:s,resolution:o,height:i,ticks:a,filters:r})},get needsScalebar(){var t=e.rendererTypeName;return"XYPlotRenderer"===t||"LinePlotRenderer"===t},get fillSetting(){return e.filled?0:e.filled||1!==e.minSize?2:1}}})).views((function(e){var t=e.trackMenuItems,n=(0,k.getConf)(e,"defaultRendering");return{trackMenuItems:function(){return[].concat((0,oe.Z)(t()),[{label:"Score",subMenu:e.scoreTrackMenuItems()}],(0,oe.Z)(e.canHaveFill?[{label:"Fill mode",subMenu:["filled","no fill","no fill w/ emphasis"].map((function(t,n){return{label:t,type:"radio",checked:e.fillSetting===n,onClick:function(){return e.setFill(n)}}}))}]:[]),(0,oe.Z)(e.needsScalebar?[{type:"checkbox",label:"Draw cross hatches",checked:e.displayCrossHatchesSetting,onClick:function(){return e.toggleCrossHatches()}}]:[]),(0,oe.Z)(n?[{label:"Renderer type",subMenu:["xyplot","density","line"].map((function(t){return{label:t,type:"radio",checked:e.rendererTypeNameSimple===t,onClick:function(){return e.setRendererType(t)}}}))}]:[]),[{label:"Set color",onClick:function(){(0,y.getSession)(e).queueDialog((function(t){return[Pe,{model:e,handleClose:t}]}))}}])}}})).actions((function(e){var t=e.renderSvg;return{afterAttach:function(){G(e)},renderSvg:function(r){return(0,h.Z)((0,l.Z)().mark((function a(){var i,o;return(0,l.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.e(6107).then(n.bind(n,46107));case 2:return i=a.sent,o=i.renderSvg,a.abrupt("return",o(e,r,t));case 5:case"end":return a.stop()}}),a)})))()}}}))},Ae=n(15697),Ie=function(e){e.addDisplayType((function(){var t=function(e){var t=e.getRendererType("XYPlotRenderer").configSchema,n=e.getRendererType("DensityRenderer").configSchema,r=e.getRendererType("LinePlotRenderer").configSchema;return(0,k.ConfigurationSchema)("LinearWiggleDisplay",{defaultRendering:{type:"stringEnum",model:R.types.enumeration("Rendering",["density","xyplot","line"]),defaultValue:"xyplot"},renderers:(0,k.ConfigurationSchema)("RenderersConfiguration",{DensityRenderer:n,XYPlotRenderer:t,LinePlotRenderer:r})},{baseConfiguration:pe(),explicitlyTyped:!0})}(e),r=Re(e,t);return new de.Z({name:"LinearWiggleDisplay",displayName:"Wiggle display",configSchema:t,stateModel:r,trackType:"QuantitativeTrack",viewType:"LinearGenomeView",ReactComponent:(0,ne.lazy)((function(){return Promise.resolve().then(n.bind(n,15697))}))})}))};var Le=n(59264),Ne=n.n(Le),Fe=n(94069),je=function(e){return e.toLocaleString("en-US")},De=ne.forwardRef((function(e,t){var n=e.model,r=e.feature,a=r.get("start"),i=r.get("end"),o=r.get("refName"),s=a===i?je(a):"".concat(je(a),"..").concat(je(i)),u=r.get("sources"),c=r.get("source"),l=r.get("summary"),d=Object.fromEntries(n.sources.map((function(e){return[e.name,e]})));return(0,ae.jsxs)("div",{ref:t,children:[[o,s].filter((function(e){return!!e})).join(":"),(0,ae.jsx)("br",{}),u?(0,ae.jsxs)("table",{children:[(0,ae.jsx)("thead",{children:(0,ae.jsxs)("tr",{children:[(0,ae.jsx)("th",{children:"color"}),(0,ae.jsx)("th",{children:"source"}),(0,ae.jsx)("th",{children:"score"})]})}),(0,ae.jsx)("tbody",{children:Object.entries(u).map((function(e){var t,n=(0,p.Z)(e,2),r=n[0],a=n[1];return(0,ae.jsxs)("tr",{children:[(0,ae.jsx)("td",{style:{background:null===(t=d[r])||void 0===t?void 0:t.color},children:" "}),(0,ae.jsx)("td",{children:r}),(0,ae.jsx)("td",{children:q(a.score)})]},r)}))})]}):(0,ae.jsxs)("span",{children:[c," ",l?"min:".concat(q(r.get("minScore"))," avg:").concat(q(r.get("score"))," max:").concat(q(r.get("maxScore"))):q(r.get("score"))]})]})})),Be=(0,te.observer)((function(e){return(0,ae.jsx)(xe,(0,d.Z)({useClientY:!0,TooltipContents:De},e))})),Ee=(0,ne.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(1029),n.e(8066)]).then(n.bind(n,58066))})),Ve=new Map([["xyplot","MultiXYPlotRenderer"],["multirowxy","MultiRowXYPlotRenderer"],["multirowdensity","MultiDensityRenderer"],["multiline","MultiLineRenderer"],["multirowline","MultiRowLineRenderer"]]);var ze=function(e,t){return R.types.compose("MultiLinearWiggleDisplay",Te(t),R.types.model({type:R.types.literal("MultiLinearWiggleDisplay"),layout:R.types.optional(R.types.frozen(),[])})).volatile((function(){return{featureUnderMouseVolatile:void 0,sourcesVolatile:void 0}})).actions((function(e){return{setLayout:function(t){e.layout=t},clearLayout:function(){e.layout=[]},setSources:function(t){Ne()(t,e.sourcesVolatile)||(e.sourcesVolatile=t)},setFeatureUnderMouse:function(t){e.featureUnderMouseVolatile=t}}})).views((function(e){return{get featureUnderMouse(){return e.featureUnderMouseVolatile},get TooltipComponent(){return Be},get rendererTypeName(){var t=e.rendererTypeNameSimple,n=Ve.get(t);if(!n)throw new Error("unknown renderer ".concat(t));return n}}})).views((function(e){return{get needsScalebar(){return"MultiXYPlotRenderer"===e.rendererTypeName||"MultiRowXYPlotRenderer"===e.rendererTypeName||"MultiLineRenderer"===e.rendererTypeName||"MultiRowLineRenderer"===e.rendererTypeName},get needsFullHeightScalebar(){return"MultiXYPlotRenderer"===e.rendererTypeName||"MultiLineRenderer"===e.rendererTypeName},get isMultiRow(){return"MultiRowXYPlotRenderer"===e.rendererTypeName||"MultiRowLineRenderer"===e.rendererTypeName||"MultiDensityRenderer"===e.rendererTypeName},get needsCustomLegend(){return"MultiDensityRenderer"===e.rendererTypeName},get canHaveFill(){return"MultiXYPlotRenderer"===e.rendererTypeName||"MultiRowXYPlotRenderer"===e.rendererTypeName},get renderColorBoxes(){return!("MultiRowLineRenderer"===e.rendererTypeName||"MultiRowXYPlotRenderer"===e.rendererTypeName)},get prefersOffset(){return this.isMultiRow},get sources(){var t,n=this,r=Object.fromEntries((null===(t=e.sourcesVolatile)||void 0===t?void 0:t.map((function(e){return[e.name,e]})))||[]),a=e.layout.length?e.layout:e.sourcesVolatile;return null===a||void 0===a?void 0:a.map((function(e){return(0,d.Z)((0,d.Z)({},r[e.name]),e)})).map((function(e,t){return(0,d.Z)((0,d.Z)({},e),{},{color:e.color||(n.isMultiRow?"blue":Fe.set1[t]||"#000000".replaceAll("0",(function(){return(~~(16*Math.random())).toString(16)})))})}))}}})).views((function(e){return{get rowHeight(){var t=e.sources,n=e.height;return e.isMultiRow?n/((null===t||void 0===t?void 0:t.length)||1):n},get rowHeightTooSmallForScalebar(){return this.rowHeight<70},get useMinimalTicks(){return(0,k.getConf)(e,"minimalTicks")||this.rowHeightTooSmallForScalebar}}})).views((function(e){return{get ticks(){var t=e.scaleType,n=e.domain,r=e.isMultiRow,a=e.rowHeight,i=e.useMinimalTicks;if(n){var o=r?0:E,s=(0,he.axisPropsFromTickScale)(V({scaleType:t,domain:n,range:[a-o,o],inverted:(0,k.getConf)(e,"inverted")}),4);return i?(0,d.Z)((0,d.Z)({},s),{},{values:n}):s}},get colors(){return["red","blue","green","orange","purple","cyan","pink","darkblue","darkred","pink"]}}})).views((function(e){var t=e.renderProps;return{renderProps:function(){var n=t(),r=e.displayCrossHatches,a=e.filters,i=e.height,o=e.resolution,s=e.rpcDriverName,u=e.scaleOpts,c=e.stats,l=e.sources,f=e.ticks,p=e.rendererConfig;return(0,d.Z)((0,d.Z)({},n),{},{notReady:n.notReady||!l||!c,displayModel:e,config:p,displayCrossHatches:r,filters:a,height:i,resolution:o,rpcDriverName:s,scaleOpts:u,sources:l,ticks:f,onMouseMove:function(t,n){return e.setFeatureUnderMouse(n)},onMouseLeave:function(){return e.setFeatureUnderMouse(void 0)}})},get hasResolution(){return e.adapterCapabilities.includes("hasResolution")},get hasGlobalStats(){return e.adapterCapabilities.includes("hasGlobalStats")},get fillSetting(){return e.filled?0:e.filled||1!==e.minSize?2:1}}})).views((function(e){var t=e.trackMenuItems,n=(0,k.getConf)(e,"defaultRendering");return{trackMenuItems:function(){return[].concat((0,oe.Z)(t()),[{label:"Score",subMenu:e.scoreTrackMenuItems()}],(0,oe.Z)(e.canHaveFill?[{label:"Fill mode",subMenu:["filled","no fill","no fill w/ emphasis"].map((function(t,n){return{label:t,type:"radio",checked:e.fillSetting===n,onClick:function(){return e.setFill(n)}}}))}]:[]),(0,oe.Z)(e.needsScalebar?[{type:"checkbox",label:"Draw cross hatches",checked:e.displayCrossHatchesSetting,onClick:function(){return e.toggleCrossHatches()}}]:[]),(0,oe.Z)(n?[{label:"Renderer type",subMenu:["xyplot","multirowxy","multirowdensity","multiline","multirowline"].map((function(t){return{label:t,type:"radio",checked:e.rendererTypeNameSimple===t,onClick:function(){return e.setRendererType(t)}}}))}]:[]),[{label:"Edit colors/arrangement...",onClick:function(){(0,y.getSession)(e).queueDialog((function(t){return[Ee,{model:e,handleClose:t}]}))}}])}}})).actions((function(e){var t=e.renderSvg;return{afterAttach:function(){G(e),(0,R.addDisposer)(e,(0,B.autorun)((0,h.Z)((0,l.Z)().mark((function t(){var n,r,a,i,o;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,y.getSession)(e),r=n.rpcManager,a=e.adapterConfig,i=(0,c.getRpcSessionId)(e),t.next=5,r.call(i,"MultiWiggleGetSources",{sessionId:i,adapterConfig:a});case 5:o=t.sent,(0,R.isAlive)(e)&&e.setSources(o);case 7:case"end":return t.stop()}}),t)})))))},renderSvg:function(r){return(0,h.Z)((0,l.Z)().mark((function a(){var i,o;return(0,l.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.e(1842).then(n.bind(n,11842));case 2:return i=a.sent,o=i.renderSvg,a.abrupt("return",o(e,r,t));case 5:case"end":return a.stop()}}),a)})))()}}}))},Oe=function(e){e.addDisplayType((function(){var t=function(e){var t=e.getRendererType("MultiXYPlotRenderer").configSchema,n=e.getRendererType("MultiDensityRenderer").configSchema,r=e.getRendererType("MultiRowXYPlotRenderer").configSchema,a=e.getRendererType("MultiLineRenderer").configSchema,i=e.getRendererType("MultiRowLineRenderer").configSchema;return(0,k.ConfigurationSchema)("MultiLinearWiggleDisplay",{defaultRendering:{type:"stringEnum",model:R.types.enumeration("Rendering",["multirowxy","xyplot","multirowdensity","multiline","multirowline"]),defaultValue:"multirowxy"},renderers:(0,k.ConfigurationSchema)("RenderersConfiguration",{MultiXYPlotRenderer:t,MultiDensityRenderer:n,MultiRowXYPlotRenderer:r,MultiLineRenderer:a,MultiRowLineRenderer:i}),height:{type:"number",defaultValue:200}},{baseConfiguration:pe(),explicitlyTyped:!0})}(e);return new de.Z({name:"MultiLinearWiggleDisplay",displayName:"Multi-wiggle display",configSchema:t,stateModel:ze(e,t),trackType:"MultiQuantitativeTrack",viewType:"LinearGenomeView",ReactComponent:(0,ne.lazy)((function(){return n.e(5413).then(n.bind(n,5413))}))})}))},We=["refName","start","end","source"],He=(0,te.observer)((function(e){var t=e.regions,n=e.features,r=e.bpPerPx,a=e.width,i=e.height,o=e.sources,s=e.onMouseLeave,u=void 0===s?function(){}:s,c=e.onMouseMove,l=void 0===c?function(){}:c,h=e.onFeatureClick,g=void 0===h?function(){}:h,m=e.displayModel,v=(0,p.Z)(t,1)[0],b=(0,ne.useRef)(null);function w(e,t){if(b.current){var s=b.current.getBoundingClientRect(),u=e-s.left,c=t-s.top,l=o[Math.floor(c/i*o.length)];if(l){var p,h=v.reversed?a-u:u,g=v.start+r*h;if(m.isMultiRow){var w,x=(0,L.Z)(n.values());try{for(x.s();!(w=x.n()).done;){var k=w.value;if(k.get("source")===l.name&&(g<=k.get("end")+r&&g>=k.get("start"))){p=k;break}}}catch(M){x.e(M)}finally{x.f()}}else{var Z,C=[],S=(0,L.Z)(n.values());try{for(S.s();!(Z=S.n()).done;){var T=Z.value;g<=T.get("end")+r&&g>=T.get("start")&&C.push(T)}}catch(M){S.e(M)}finally{S.f()}if(C.length){var P=Math.floor(g);p=new y.SimpleFeature((0,d.Z)((0,d.Z)({uniqueId:"mouseoverfeat",sources:Object.fromEntries(C.map((function(e){return e.toJSON()})).map((function(e){e.refName,e.start,e.end;return[e.source,(0,f.Z)(e,We)]})))},v),{},{start:P,end:P+1}))}}return p}}}return(0,ae.jsx)("div",{ref:b,onMouseMove:function(e){var t=w(e.clientX,e.clientY);l(e,t)},onClick:function(e){var t=w(e.clientX,e.clientY);g(e,t)},onMouseLeave:function(e){return u(e)},style:{overflow:"visible",position:"relative",height:i},children:(0,ae.jsx)(re.PrerenderedCanvas,(0,d.Z)({},e))})})),Ge=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"draw",value:function(){var e=(0,h.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o,s,u,c;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.sources,a=n.features,i=(0,y.groupBy)((0,oe.Z)(a.values()),(function(e){return e.get("source")})),o=[],s=(0,L.Z)(r),e.prev=4,c=(0,l.Z)().mark((function e(){var r,a,s,c;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.value,a=i[r.name]){e.next=4;break}return e.abrupt("return",1);case 4:s=Q(t,(0,d.Z)((0,d.Z)({},n),{},{features:a,offset:E,colorCallback:function(){return r.color||"blue"}})),c=s.reducedFeatures,o=[].concat((0,oe.Z)(o),(0,oe.Z)(c));case 6:case"end":return e.stop()}}),e)})),s.s();case 7:if((u=s.n()).done){e.next=13;break}return e.delegateYield(c(),"t0",9);case 9:if(!e.t0){e.next=11;break}return e.abrupt("continue",11);case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t1=e.catch(4),s.e(e.t1);case 18:return e.prev=18,s.f(),e.finish(18);case 21:return e.abrupt("return",{reducedFeatures:o});case 22:case"end":return e.stop()}}),e,null,[[4,15,18,21]])})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(w);var qe=(0,k.ConfigurationSchema)("MultiXYPlotRenderer",{filled:{type:"boolean",defaultValue:!0},displayCrossHatches:{type:"boolean",description:"choose to draw cross hatches (sideways lines)",defaultValue:!1},summaryScoreMode:{type:"stringEnum",model:R.types.enumeration("Score type",["max","min","avg","whiskers"]),description:"choose whether to use max/min/average or whiskers which combines all three into the same rendering",defaultValue:"avg"},minSize:{type:"number",defaultValue:0}},{baseConfiguration:A,explicitlyTyped:!0}),_e=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"draw",value:function(){var e=(0,h.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o,s,u,c,f,h,g;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.bpPerPx,a=n.sources,i=n.regions,o=n.features,s=(0,p.Z)(i,1),u=s[0],c=(0,y.groupBy)((0,oe.Z)(o.values()),(function(e){return e.get("source")})),f=n.height/a.length,h=(u.end-u.start)/r,g=[],t.save(),a.forEach((function(e){var r=c[e.name];if(r){var a=Q(t,(0,d.Z)((0,d.Z)({},n),{},{features:r,height:f,colorCallback:function(){return e.color||"blue"}})).reducedFeatures;t.strokeStyle="rgba(200,200,200,0.8)",t.beginPath(),t.moveTo(0,f),t.lineTo(h,f),t.stroke(),t.translate(0,f),g=[].concat((0,oe.Z)(g),(0,oe.Z)(a))}})),t.restore(),e.abrupt("return",{reducedFeatures:g});case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(w);var Ue=(0,k.ConfigurationSchema)("MultiRowXYPlotRenderer",{filled:{type:"boolean",defaultValue:!0},displayCrossHatches:{type:"boolean",description:"choose to draw cross hatches (sideways lines)",defaultValue:!1},summaryScoreMode:{type:"stringEnum",model:R.types.enumeration("Score type",["max","min","avg","whiskers"]),description:"choose whether to use max/min/average or whiskers which combines all three into the same rendering",defaultValue:"whiskers"},minSize:{type:"number",defaultValue:0}},{baseConfiguration:A,explicitlyTyped:!0});var Je=(0,k.ConfigurationSchema)("MultiDensityRenderer",{},{baseConfiguration:A,explicitlyTyped:!0}),Xe=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"draw",value:function(){var e=(0,h.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o,s,u,c,f,h,g;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.bpPerPx,a=n.sources,i=n.regions,o=n.features,s=(0,p.Z)(i,1),u=s[0],c=(0,y.groupBy)((0,oe.Z)(o.values()),(function(e){return e.get("source")})),f=n.height/a.length,h=(u.end-u.start)/r,g=[],t.save(),a.forEach((function(e){var r=c[e.name];if(r){var a=$(t,(0,d.Z)((0,d.Z)({},n),{},{features:r,height:f})).reducedFeatures;t.strokeStyle="rgba(200,200,200,0.8)",t.beginPath(),t.moveTo(0,f),t.lineTo(h,f),t.stroke(),t.translate(0,f),g=[].concat((0,oe.Z)(g),(0,oe.Z)(a))}})),t.restore(),e.abrupt("return",{reducedFeatures:g});case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(w),Ye=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"draw",value:function(){var e=(0,h.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.sources,a=n.features,i=(0,y.groupBy)((0,oe.Z)(a.values()),(function(e){return e.get("source")})),o=[],r.forEach((function(e){var r=i[e.name];if(r){var a=K(t,(0,d.Z)((0,d.Z)({},n),{},{features:r,colorCallback:function(){return e.color||"blue"}})).reducedFeatures;o=[].concat((0,oe.Z)(o),(0,oe.Z)(a))}})),e.abrupt("return",{reducedFeatures:o});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(w);var Qe=(0,k.ConfigurationSchema)("MultiLineRenderer",{displayCrossHatches:{type:"boolean",description:"choose to draw cross hatches (sideways lines)",defaultValue:!1},summaryScoreMode:{type:"stringEnum",model:R.types.enumeration("Score type",["max","min","avg","whiskers"]),description:"choose whether to use max/min/average or whiskers which combines all three into the same rendering",defaultValue:"avg"}},{baseConfiguration:A,explicitlyTyped:!0}),Ke=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"draw",value:function(){var e=(0,h.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o,s,u,c,f,h,g;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.bpPerPx,a=n.sources,i=n.regions,o=n.features,s=(0,p.Z)(i,1),u=s[0],c=(0,y.groupBy)((0,oe.Z)(o.values()),(function(e){return e.get("source")})),f=n.height/a.length,h=(u.end-u.start)/r,g=[],t.save(),a.forEach((function(e){var r=K(t,(0,d.Z)((0,d.Z)({},n),{},{features:c[e.name],height:f,colorCallback:function(){return e.color||"blue"}})).reducedFeatures;t.strokeStyle="rgba(200,200,200,0.8)",t.beginPath(),t.moveTo(0,f),t.lineTo(h,f),t.stroke(),t.translate(0,f),g=[].concat((0,oe.Z)(g),(0,oe.Z)(r))})),t.restore(),e.abrupt("return",{reducedFeatures:g});case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(w);var $e=(0,k.ConfigurationSchema)("MultiRowLineRenderer",{displayCrossHatches:{type:"boolean",description:"choose to draw cross hatches (sideways lines)",defaultValue:!1},summaryScoreMode:{type:"stringEnum",model:R.types.enumeration("Score type",["max","min","avg","whiskers"]),description:"choose whether to use max/min/average or whiskers which combines all three into the same rendering",defaultValue:"avg"}},{baseConfiguration:A,explicitlyTyped:!0}),et=(0,ne.lazy)((function(){return n.e(7502).then(n.bind(n,77502))}));function tt(e){e.addToExtensionPoint("TrackSelector-multiTrackMenuItems",(function(e,t){var n=t.session;return[].concat((0,oe.Z)(e),(0,oe.Z)((0,y.isSessionWithAddTracks)(n)?[{label:"Create multi-wiggle track",onClick:function(e){var t=e.selection,n=t.map((function(e){return(0,k.readConfObject)(e,"name")}));(0,y.getSession)(e).queueDialog((function(r){return[et,{tracks:t,onClose:function(a,i){a&&i&&function(r){var a=t.map((function(e){return(0,k.readConfObject)(e,"adapter")})).map((function(e,t){return(0,d.Z)((0,d.Z)({},e),{},{source:n[t]})})),i=(0,oe.Z)(new Set(t.flatMap((function(e){return(0,k.readConfObject)(e,"assemblyNames")})))),o=+Date.now(),s="multitrack-".concat(o,"-sessionTrack"),u=(0,y.getSession)(e);(0,y.isSessionWithAddTracks)(u)&&(u.addTrackConf({type:"MultiQuantitativeTrack",trackId:s,name:r.name,assemblyNames:i,adapter:{type:"MultiWiggleAdapter",subadapters:a}}),e.view.showTrack(s))}(i),r()}}]}))}}]:[]))}))}var nt=n(99069),rt=n(46672),at=n(87006),it=n(72097),ot=(0,ve.ZL)()((function(e){return{textbox:{width:"100%"},paper:{margin:e.spacing(),padding:e.spacing()},submit:{marginTop:25,marginBottom:100,display:"block"}}}));function st(e){var t=e.model,n=ot().classes,r=(0,ne.useState)(""),a=(0,p.Z)(r,2),i=a[0],o=a[1],s=(0,ne.useState)("MultiWiggle".concat(+Date.now())),u=(0,p.Z)(s,2),l=u[0],f=u[1];return(0,ae.jsxs)(rt.Z,{className:n.paper,children:[(0,ae.jsxs)("ul",{children:[(0,ae.jsx)("li",{children:"Enter list of URLs for bigwig files in the textbox"}),(0,ae.jsx)("li",{children:"Or, use the button below the text box to select files from your computer"})]}),(0,ae.jsx)(at.Z,{multiline:!0,rows:10,value:i,onChange:function(e){return o(e.target.value)},placeholder:"Paste list of URLs here, or use file selector below",variant:"outlined",className:n.textbox}),(0,ae.jsxs)(it.Z,{variant:"outlined",component:"label",children:["Choose Files from your computer",(0,ae.jsx)("input",{type:"file",hidden:!0,multiple:!0,onChange:function(e){var t=e.target,n=(0,oe.Z)((null===t||void 0===t?void 0:t.files)||[]).map((function(e){return{type:"BigWigAdapter",bigWigLocation:y.isElectron?{localPath:e.path,locationType:"LocalPathLocation"}:(0,c.storeBlobLocation)({blob:e}),source:e.name}}));o(JSON.stringify(n,null,2))}})]}),(0,ae.jsx)(at.Z,{value:l,onChange:function(e){return f(e.target.value)},helperText:"Track name"}),(0,ae.jsx)(it.Z,{variant:"contained",className:n.submit,onClick:function(){var e,n=(0,y.getSession)(t),r=["".concat(l.toLowerCase().replaceAll(" ","_"),"-").concat(Date.now()),"".concat(n.adminMode?"":"-sessionTrack")].join("");try{e=JSON.parse(i)}catch(s){e=i.split(/\n|\r\n|\r/)}var a,o="string"===typeof e[0]?{bigWigs:e}:{subadapters:e};(0,y.isSessionWithAddTracks)(n)&&(n.addTrackConf({trackId:r,type:"MultiQuantitativeTrack",name:l,assemblyNames:[t.assembly],adapter:(0,d.Z)({type:"MultiWiggleAdapter"},o)}),null===(a=t.view)||void 0===a||a.showTrack(r));t.clearData(),(0,y.isSessionModelWithWidgets)(n)&&n.hideWidget(t)},children:"Submit"}),(0,ae.jsx)("p",{children:"Additional notes: "}),(0,ae.jsxs)("ul",{children:[(0,ae.jsxs)("li",{children:["The list of bigwig files in the text box can be a list of URLs, or a list of elements like"," ",(0,ae.jsx)("code",{children:'[{"type":"BigWigAdapter","bigWigLocation":{"uri":"http://host/file.bw"}, "color":"green","source":"name for subtrack"}]'})," ","to apply e.g. the color attribute to the view"]}),(0,ae.jsx)("li",{children:'Adding local files will update the textbox with JSON contents that are ready to submit with the "Submit" button'})]})]})}var ut=n(85550),ct=n(37386),lt=n(3011),dt=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="MultiWiggleGetSources",e}return(0,i.Z)(n,[{key:"deserializeArguments",value:function(){var e=(0,h.Z)((0,l.Z)().mark((function e(t,r){var a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,g.Z)((0,m.Z)(n.prototype),"deserializeArguments",this).call(this,t,r);case 2:return a=e.sent,e.abrupt("return",(0,d.Z)((0,d.Z)({},a),{},{filters:t.filters?new ct.Z({filters:t.filters}):void 0}));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"serializeArguments",value:function(){var e=(0,h.Z)((0,l.Z)().mark((function e(t,r){var a,i,o,s,u,c;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.pluginManager,u=null===(a=s.rootModel)||void 0===a||null===(i=a.session)||void 0===i?void 0:i.assemblyManager){e.next=4;break}return e.abrupt("return",t);case 4:return e.next=6,(0,y.renameRegionsIfNeeded)(u,(0,d.Z)((0,d.Z)({},t),{},{filters:null===(o=t.filters)||void 0===o?void 0:o.toJSON().filters}));case 6:return c=e.sent,e.abrupt("return",(0,g.Z)((0,m.Z)(n.prototype),"serializeArguments",this).call(this,c,r));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"execute",value:function(){var e=(0,h.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o,s,u,c;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.pluginManager,e.next=3,this.deserializeArguments(t,n);case 3:return a=e.sent,i=a.regions,o=a.adapterConfig,s=a.sessionId,e.next=7,(0,lt.uP)(r,s,o);case 7:return u=e.sent,c=u.dataAdapter,e.abrupt("return",c.getSources(i,a));case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(ut.Z),ft=n(20783),pt=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="WiggleGetMultiRegionQuantitativeStats",e}return(0,i.Z)(n,[{key:"deserializeArguments",value:function(){var e=(0,h.Z)((0,l.Z)().mark((function e(t,r){var a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,g.Z)((0,m.Z)(n.prototype),"deserializeArguments",this).call(this,t,r);case 2:return a=e.sent,e.abrupt("return",(0,d.Z)((0,d.Z)({},a),{},{filters:t.filters?new ct.Z({filters:t.filters}):void 0}));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"serializeArguments",value:function(){var e=(0,h.Z)((0,l.Z)().mark((function e(t,r){var a,i,o,s,u,c;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.pluginManager,u=null===(a=s.rootModel)||void 0===a||null===(i=a.session)||void 0===i?void 0:i.assemblyManager){e.next=4;break}return e.abrupt("return",t);case 4:return e.next=6,(0,y.renameRegionsIfNeeded)(u,(0,d.Z)((0,d.Z)({},t),{},{filters:null===(o=t.filters)||void 0===o?void 0:o.toJSON().filters}));case 6:return c=e.sent,e.abrupt("return",(0,g.Z)((0,m.Z)(n.prototype),"serializeArguments",this).call(this,c,r));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"execute",value:function(){var e=(0,h.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o,s,u,c;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.pluginManager,e.next=3,this.deserializeArguments(t,n);case 3:return a=e.sent,i=a.regions,o=a.adapterConfig,s=a.sessionId,e.next=7,(0,lt.uP)(r,s,o);case 7:if(u=e.sent,!((c=u.dataAdapter)instanceof ft.BaseFeatureDataAdapter)){e.next=11;break}return e.abrupt("return",c.getMultiRegionQuantitativeStats(i,a));case 11:throw new Error("Data adapter not found");case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(ut.Z),ht=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="WiggleGetGlobalQuantitativeStats",e}return(0,i.Z)(n,[{key:"deserializeArguments",value:function(){var e=(0,h.Z)((0,l.Z)().mark((function e(t,r){var a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,g.Z)((0,m.Z)(n.prototype),"deserializeArguments",this).call(this,t,r);case 2:return a=e.sent,e.abrupt("return",(0,d.Z)((0,d.Z)({},a),{},{filters:t.filters?new ct.Z({filters:t.filters}):void 0}));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"execute",value:function(){var e=(0,h.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o,s,u;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.pluginManager,e.next=3,this.deserializeArguments(t,n);case 3:return a=e.sent,i=a.adapterConfig,o=a.sessionId,e.next=7,(0,lt.uP)(r,o,i);case 7:return s=e.sent,u=s.dataAdapter,e.abrupt("return",u.getGlobalStats(a));case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(ut.Z),gt=function(e){(0,o.Z)(u,e);var t=(0,s.Z)(u);function u(){var e;(0,a.Z)(this,u);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="WigglePlugin",e.exports={LinearWiggleDisplayReactComponent:Ae.default,XYPlotRendererReactComponent:ie,XYPlotRenderer:se,WiggleBaseRenderer:w,linearWiggleDisplayModelFactory:Re,xyPlotRendererConfigSchema:ue,utils:r},e}return(0,i.Z)(u,[{key:"install",value:function(e){e.addAdapterType((function(){return new x.Z({name:"MultiWiggleAdapter",displayName:"Multi-wiggle adapter",configSchema:M,adapterCapabilities:["hasResolution","hasLocalStats","hasGlobalStats"],adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:function(){return n.e(7167).then(n.bind(n,17167)).then((function(e){return e.default}))}})})),function(e){e.addAdapterType((function(){return new x.Z({name:"BigWigAdapter",displayName:"BigWig adapter",configSchema:Z,adapterCapabilities:["hasResolution","hasLocalStats","hasGlobalStats"],getAdapterClass:function(){return Promise.all([n.e(6237),n.e(2094)]).then(n.bind(n,22094)).then((function(e){return e.default}))}})}))}(e),function(e){e.addTrackType((function(){var t=T(e);return new S.Z({name:"QuantitativeTrack",displayName:"Quantitative track",configSchema:t,stateModel:(0,C.createBaseTrackModel)(e,"QuantitativeTrack",t)})}))}(e),function(e){e.addTrackType((function(){var t=P(e);return new S.Z({name:"MultiQuantitativeTrack",displayName:"Multi-quantitative track",configSchema:t,stateModel:(0,C.createBaseTrackModel)(e,"MultiQuantitativeTrack",t)})}))}(e),Ie(e),Oe(e),function(e){e.addRendererType((function(){return new le({name:"LinePlotRenderer",ReactComponent:ie,configSchema:ce,pluginManager:e})}))}(e),function(e){e.addRendererType((function(){return new se({name:"XYPlotRenderer",ReactComponent:ie,configSchema:ue,pluginManager:e})}))}(e),function(e){e.addRendererType((function(){return new ee({name:"DensityRenderer",ReactComponent:ie,configSchema:I,pluginManager:e})}))}(e),function(e){e.addRendererType((function(){return new Ge({name:"MultiXYPlotRenderer",ReactComponent:He,configSchema:qe,pluginManager:e})}))}(e),function(e){e.addRendererType((function(){return new _e({name:"MultiRowXYPlotRenderer",ReactComponent:He,configSchema:Ue,pluginManager:e})}))}(e),function(e){e.addRendererType((function(){return new Xe({name:"MultiDensityRenderer",ReactComponent:He,configSchema:Je,pluginManager:e})}))}(e),function(e){e.addRendererType((function(){return new Ye({name:"MultiLineRenderer",ReactComponent:He,configSchema:Qe,pluginManager:e})}))}(e),function(e){e.addRendererType((function(){return new Ke({name:"MultiRowLineRenderer",ReactComponent:He,configSchema:$e,pluginManager:e})}))}(e),function(e){e.addAddTrackWorkflowType((function(){return new nt.AddTrackWorkflowType({name:"Multi-wiggle track",ReactComponent:st,stateModel:R.types.model({})})}))}(e),tt(e),e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="BigWigAdapter",i=(0,c.getFileName)(t),o={type:a,bigWigLocation:t};return/\.(bw|bigwig)$/i.test(i)&&!r||r===a?o:e(t,n,r)}})),e.addToExtensionPoint("Core-guessTrackTypeForLocation",(function(e){return function(t){return"BigWigAdapter"===t?"QuantitativeTrack":e(t)}})),e.addRpcMethod((function(){return new ht(e)})),e.addRpcMethod((function(){return new pt(e)})),e.addRpcMethod((function(){return new dt(e)}))}}]),u}(u.Z)},70765:function(e,t,n){"use strict";var r=n(33028),a=(n(30969),n(94702)),i=n(90550),o=n(58663),s=n(37574),u=(0,i.observer)((function(e){var t=e.model,n=e.orientation,i=t.ticks,u=(0,a.Z)();return i?(0,s.jsx)(o.Axis,(0,r.Z)((0,r.Z)({},i),{},{shadow:2,format:function(e){return e},style:{orient:"left"===n?o.LEFT:o.RIGHT},bg:u.palette.background.default,fg:u.palette.text.primary})):null}));t.Z=u},38355:function(e,t,n){"use strict";n.d(t,{Z:function(){return Mo}});var r=n(9065),a=n(9249),i=n(87371),o=n(45754),s=n(13820),u=n(49767),c=n(15875),l=n(9077),d=n(77479);var f=(0,l.ConfigurationSchema)("OAuthInternetAccount",{tokenType:{description:"a custom name for a token to include in the header",type:"string",defaultValue:"Bearer"},authEndpoint:{description:"the authorization code endpoint of the internet account",type:"string",defaultValue:""},tokenEndpoint:{description:"the token endpoint of the internet account",type:"string",defaultValue:""},needsPKCE:{description:"boolean to indicate if the endpoint needs a PKCE code",type:"boolean",defaultValue:!1},clientId:{description:"id for the OAuth application",type:"string",defaultValue:""},scopes:{description:"optional scopes for the authorization call",type:"string",defaultValue:""},state:{description:"optional state for the authorization call",type:"string",defaultValue:""},responseType:{description:"the type of response from the authorization endpoint. can be 'token' or 'code'",type:"string",defaultValue:"code"}},{baseConfiguration:d.BaseInternetAccountConfig,explicitlyTyped:!0}),p=n(32723),h=n(33028),g=n(34795),m=n(81073),v=n(40909);function y(e){return e.replaceAll("+","-").replaceAll("/","_").replaceAll("=","")}function b(e){return w.apply(this,arguments)}function w(){return w=(0,g.Z)((0,p.Z)().mark((function e(t){var r,a;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(4489).then(n.t.bind(n,84489,23)).then((function(e){return e.default}));case 2:return r=e.sent,e.next=5,n.e(7923).then(n.t.bind(n,67923,23));case 5:return a=e.sent,e.abrupt("return",y(a.stringify(r(t))));case 7:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}function x(e,t){try{var n,r=JSON.parse(e);return"invalid_grant"===r.error&&t(),null!==(n=null===r||void 0===r?void 0:r.error_description)&&void 0!==n?n:e}catch(a){}return e}function k(e,t){return e.refresh_token&&t(e.refresh_token),e.access_token}function Z(e){return C.apply(this,arguments)}function C(){return C=(0,g.Z)((0,p.Z)().mark((function e(t){var n,r,a;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.response,r=t.reason,a=t.statusText,e.t0="HTTP ".concat(n.status),e.t1=r,null===a||void 0===a){e.next=7;break}e.t2=a,e.next=10;break;case 7:return e.next=9,S(n);case 9:e.t2=e.sent;case 10:return e.t3=e.t2,e.abrupt("return",[e.t0,e.t1,e.t3].filter((function(e){return!!e})).join(" - "));case 12:case"end":return e.stop()}}),e)}))),C.apply(this,arguments)}function S(e){return T.apply(this,arguments)}function T(){return(T=(0,g.Z)((0,p.Z)().mark((function e(t){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",t.text());case 4:return e.prev=4,e.t0=e.catch(0),e.abrupt("return",t.statusText);case 7:case"end":return e.stop()}}),e,null,[[0,4]])})))).apply(this,arguments)}var P=n(49882).lW,M=function(e){return d.InternetAccount.named("OAuthInternetAccount").props({type:v.types.literal("OAuthInternetAccount"),configuration:(0,l.ConfigurationReference)(e)}).views((function(){var e=void 0;return{get codeVerifierPKCE(){if(e)return e;var t=new Uint8Array(32);return globalThis.crypto.getRandomValues(t),e=y(P.from(t).toString("base64"))}}})).views((function(e){return{get authEndpoint(){return(0,l.getConf)(e,"authEndpoint")},get tokenEndpoint(){return(0,l.getConf)(e,"tokenEndpoint")},get needsPKCE(){return(0,l.getConf)(e,"needsPKCE")},get clientId(){return(0,l.getConf)(e,"clientId")},get scopes(){return(0,l.getConf)(e,"scopes")},state:function(){return(0,l.getConf)(e,"state")},get responseType(){return(0,l.getConf)(e,"responseType")},get refreshTokenKey(){return"".concat(e.internetAccountId,"-refreshToken")}}})).actions((function(e){return{storeRefreshToken:function(t){localStorage.setItem(e.refreshTokenKey,t)},removeRefreshToken:function(){localStorage.removeItem(e.refreshTokenKey)},retrieveRefreshToken:function(){return localStorage.getItem(e.refreshTokenKey)},exchangeAuthorizationForAccessToken:function(t,n){var r=this;return(0,g.Z)((0,p.Z)().mark((function a(){var i,o,s;return(0,p.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i=new URLSearchParams(Object.entries((0,h.Z)({code:t,grant_type:"authorization_code",client_id:e.clientId,redirect_uri:n},e.needsPKCE?{code_verifier:e.codeVerifierPKCE}:{}))),a.next=3,fetch(e.tokenEndpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i.toString()});case 3:if((o=a.sent).ok){a.next=10;break}return a.t0=Error,a.next=8,Z({response:o,reason:"Failed to obtain token"});case 8:throw a.t1=a.sent,new a.t0(a.t1);case 10:return a.next=12,o.json();case 12:return s=a.sent,a.abrupt("return",k(s,(function(e){return r.storeRefreshToken(e)})));case 14:case"end":return a.stop()}}),a)})))()},exchangeRefreshForAccessToken:function(t){var n=this;return(0,g.Z)((0,p.Z)().mark((function r(){var a,i,o;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fetch(e.tokenEndpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(Object.entries({grant_type:"refresh_token",refresh_token:t,client_id:e.clientId})).toString()});case 2:if((a=r.sent).ok){r.next=13;break}return e.removeToken(),r.next=7,a.text();case 7:return i=r.sent,r.t0=Error,r.next=11,Z({response:a,statusText:x(i,(function(){return n.removeRefreshToken()}))});case 11:throw r.t1=r.sent,new r.t0(r.t1);case 13:return r.next=15,a.json();case 15:return o=r.sent,r.abrupt("return",k(o,(function(e){return n.storeRefreshToken(e)})));case 17:case"end":return r.stop()}}),r)})))()}}})).actions((function(e){var t,n=void 0;return{addMessageChannel:function(e,n){var r=this;t=function(t){r.finishOAuthWindow(t,e,n)},window.addEventListener("message",t)},deleteMessageChannel:function(){window.removeEventListener("message",t)},finishOAuthWindow:function(t,n,r){var a=this;return(0,g.Z)((0,p.Z)().mark((function i(){var o,s,u,c,l,d,f,h;return(0,p.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(t.data.name==="JBrowseAuthWindow-".concat(e.internetAccountId)){i.next=2;break}return i.abrupt("return",a.deleteMessageChannel());case 2:if(o=t.data.redirectUri,s=o.replace("#","?"),u=new URL(s),c=u.search,!(l=new URLSearchParams(c)).has("access_token")){i.next=13;break}if(d=l.get("access_token")){i.next=11;break}return i.abrupt("return",r(new Error("Error with token endpoint")));case 11:return e.storeToken(d),i.abrupt("return",n(d));case 13:if(!l.has("code")){i.next=28;break}if(f=l.get("code")){i.next=17;break}return i.abrupt("return",r(new Error("Error with authorization endpoint")));case 17:return i.prev=17,i.next=20,e.exchangeAuthorizationForAccessToken(f,u.origin+u.pathname);case 20:return h=i.sent,e.storeToken(h),i.abrupt("return",n(h));case 25:return i.prev=25,i.t0=i.catch(17),i.abrupt("return",i.t0 instanceof Error?r(i.t0):r(new Error(String(i.t0))));case 28:if(!o.includes("access_denied")){i.next=30;break}return i.abrupt("return",r(new Error("OAuth flow was cancelled")));case 30:if(!o.includes("error")){i.next=32;break}return i.abrupt("return",r(new Error("OAuth flow error: "+c)));case 32:a.deleteMessageChannel();case 33:case"end":return i.stop()}}),i,null,[[17,25]])})))()},useEndpointForAuthorization:function(t,n){var r=this;return(0,g.Z)((0,p.Z)().mark((function a(){var i,o,s,u,c,l,d,f,h;return(0,p.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(i=m.isElectron?"http://localhost/auth":window.location.origin+window.location.pathname,o={client_id:e.clientId,redirect_uri:i,response_type:e.responseType||"code",token_access_type:"offline"},e.state()&&(o.state=e.state()),e.scopes&&(o.scope=e.scopes),!e.needsPKCE){a.next=9;break}return a.next=7,b(e.codeVerifierPKCE);case 7:o.code_challenge=a.sent,o.code_challenge_method="S256";case 9:if(s=new URLSearchParams(Object.entries(o)),(u=new URL(e.authEndpoint)).search=s.toString(),c="JBrowseAuthWindow-".concat(e.internetAccountId),!m.isElectron){a.next=22;break}return l=window.require("electron"),d=l.ipcRenderer,a.next=17,d.invoke("openAuthWindow",{internetAccountId:e.internetAccountId,data:o,url:u.toString()});case 17:f=a.sent,h=new MessageEvent("message",{data:{name:c,redirectUri:f}}),r.finishOAuthWindow(h,t,n),a.next=23;break;case 22:window.open(u,c,"width=500,height=600,left=0,top=0");case 23:case"end":return a.stop()}}),a)})))()},getTokenFromUser:function(t,n){var r=this;return(0,g.Z)((0,p.Z)().mark((function a(){var i,o,s;return(0,p.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(i=e.retrieveRefreshToken(),o=!0,!i){a.next=15;break}return a.prev=3,a.next=6,e.exchangeRefreshForAccessToken(i);case 6:s=a.sent,t(s),o=!1,a.next=15;break;case 11:a.prev=11,a.t0=a.catch(3),console.error(a.t0),e.removeRefreshToken();case 15:o&&(r.addMessageChannel(t,n),r.useEndpointForAuthorization(t,n));case 16:case"end":return a.stop()}}),a,null,[[3,11]])})))()},validateToken:function(t,r){return(0,g.Z)((0,p.Z)().mark((function a(){var i,o,s,u;return(0,p.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i=e.addAuthHeaderToInit({method:"HEAD"},t),a.next=3,fetch(r.uri,i);case 3:if((o=a.sent).ok){a.next=25;break}if(e.removeToken(),!(s=e.retrieveRefreshToken())){a.next=20;break}return a.prev=8,n||(n=e.exchangeRefreshForAccessToken(s)),a.next=12,n;case 12:return u=a.sent,n=void 0,a.abrupt("return",u);case 17:a.prev=17,a.t0=a.catch(8),console.error("Token could not be refreshed",a.t0);case 20:return a.t1=Error,a.next=23,Z({response:o,reason:"Error validating token"});case 23:throw a.t2=a.sent,new a.t1(a.t2);case 25:return a.abrupt("return",t);case 26:case"end":return a.stop()}}),a,null,[[8,17]])})))()}}})).actions((function(e){var t=e.getFetcher;return{getFetcher:function(n){var r=t(n);return function(){var t=(0,g.Z)((0,p.Z)().mark((function t(a,i){return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=8;break}return t.t0=e,t.next=4,e.getToken(n);case 4:return t.t1=t.sent,t.t2=n,t.next=8,t.t0.validateToken.call(t.t0,t.t1,t.t2);case 8:return t.abrupt("return",r(a,i));case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}}}))};var R=(0,l.ConfigurationSchema)("ExternalTokenInternetAccount",{validateWithHEAD:{description:"validate the token with a HEAD request before using it",type:"boolean",defaultValue:!0}},{baseConfiguration:d.BaseInternetAccountConfig,explicitlyTyped:!0}),A=n(96234),I=n(30969),L=n(59071),N=n(87006),F=n(96074),j=n(72097),D=n(59767),B=n(37574),E=function(e){var t=e.internetAccountId,n=e.handleClose,r=(0,I.useState)(""),a=(0,A.Z)(r,2),i=a[0],o=a[1];return(0,B.jsxs)(D.Dialog,{open:!0,maxWidth:"xl","data-testid":"externalToken-form",title:"Enter token for ".concat(t),children:[(0,B.jsx)(L.Z,{style:{display:"flex",flexDirection:"column"},children:(0,B.jsx)(N.Z,{required:!0,label:"Enter Token",variant:"outlined",inputProps:{"data-testid":"entry-externalToken"},onChange:function(e){return o(e.target.value)},margin:"dense"})}),(0,B.jsxs)(F.Z,{children:[(0,B.jsx)(j.Z,{variant:"contained",color:"primary",type:"submit",disabled:!i,onClick:function(){i&&n(i)},children:"Add"}),(0,B.jsx)(j.Z,{variant:"contained",color:"secondary",onClick:function(){return n()},children:"Cancel"})]})]})},V=function(e){return d.InternetAccount.named("ExternalTokenInternetAccount").props({type:v.types.literal("ExternalTokenInternetAccount"),configuration:(0,l.ConfigurationReference)(e)}).views((function(e){return{get validateWithHEAD(){return(0,l.getConf)(e,"validateWithHEAD")}}})).actions((function(e){return{getTokenFromUser:function(t,n){(0,v.getRoot)(e).session.queueDialog((function(r){return[E,{internetAccountId:e.internetAccountId,handleClose:function(e){e?t(e):n(new Error("user cancelled entry")),r()}}]}))},validateToken:function(t,n){return(0,g.Z)((0,p.Z)().mark((function r(){var a,i,o;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.validateWithHEAD){r.next=2;break}return r.abrupt("return",t);case 2:return a=e.addAuthHeaderToInit({method:"HEAD"},t),r.next=5,fetch(n.uri,a);case 5:if((i=r.sent).ok){r.next=17;break}return r.prev=7,r.next=10,i.text();case 10:o=r.sent,r.next=16;break;case 13:r.prev=13,r.t0=r.catch(7),o="";case 16:throw new Error("Token could not be validated \u2014 ".concat(i.status," (").concat(i.statusText,")").concat(o?" (".concat(o,")"):""));case 17:return r.abrupt("return",t);case 18:case"end":return r.stop()}}),r,null,[[7,13]])})))()}}}))};var z=(0,l.ConfigurationSchema)("HTTPBasicInternetAccount",{tokenType:{description:"a custom name for a token to include in the header",type:"string",defaultValue:"Basic"},validateWithHEAD:{description:"validate the token with a HEAD request before using it",type:"boolean",defaultValue:!0}},{baseConfiguration:d.BaseInternetAccountConfig,explicitlyTyped:!0}),O=function(e){var t=e.internetAccountId,n=e.handleClose,r=(0,I.useState)(""),a=(0,A.Z)(r,2),i=a[0],o=a[1],s=(0,I.useState)(""),u=(0,A.Z)(s,2),c=u[0],l=u[1];return(0,B.jsx)(D.Dialog,{open:!0,maxWidth:"xl","data-testid":"login-httpbasic",title:"Log In for ".concat(t),children:(0,B.jsxs)("form",{onSubmit:function(e){i&&c?n(btoa("".concat(i,":").concat(c))):n(),e.preventDefault()},children:[(0,B.jsxs)(L.Z,{style:{display:"flex",flexDirection:"column"},children:[(0,B.jsx)(N.Z,{required:!0,label:"Username",variant:"outlined",inputProps:{"data-testid":"login-httpbasic-username"},onChange:function(e){return o(e.target.value)},margin:"dense"}),(0,B.jsx)(N.Z,{required:!0,label:"Password",type:"password",autoComplete:"current-password",variant:"outlined",inputProps:{"data-testid":"login-httpbasic-password"},onChange:function(e){return l(e.target.value)},margin:"dense"})]}),(0,B.jsxs)(F.Z,{children:[(0,B.jsx)(j.Z,{variant:"contained",color:"primary",type:"submit",children:"Submit"}),(0,B.jsx)(j.Z,{variant:"contained",color:"secondary",type:"submit",onClick:function(){return n()},children:"Cancel"})]})]})})},W=function(e){return d.InternetAccount.named("HTTPBasicInternetAccount").props({type:v.types.literal("HTTPBasicInternetAccount"),configuration:(0,l.ConfigurationReference)(e)}).views((function(e){return{get validateWithHEAD(){return(0,l.getConf)(e,"validateWithHEAD")}}})).actions((function(e){return{getTokenFromUser:function(t,n){(0,v.getRoot)(e).session.queueDialog((function(r){return[O,{internetAccountId:e.internetAccountId,handleClose:function(e){e?t(e):n(new Error("User cancelled entry")),r()}}]}))},validateToken:function(t,n){return(0,g.Z)((0,p.Z)().mark((function r(){var a,i;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.validateWithHEAD){r.next=2;break}return r.abrupt("return",t);case 2:return a=e.addAuthHeaderToInit({method:"HEAD"},t),r.next=5,fetch(n.uri,a);case 5:if((i=r.sent).ok){r.next=12;break}return r.t0=Error,r.next=10,Z({response:i,reason:"Error validating token"});case 10:throw r.t1=r.sent,new r.t0(r.t1);case 12:return r.abrupt("return",t);case 13:case"end":return r.stop()}}),r)})))()}}}))};var H=(0,l.ConfigurationSchema)("DropboxOAuthInternetAccount",{authEndpoint:{description:"the authorization code endpoint of the internet account",type:"string",defaultValue:"https://www.dropbox.com/oauth2/authorize"},tokenEndpoint:{description:"the token endpoint of the internet account",type:"string",defaultValue:"https://api.dropbox.com/oauth2/token"},needsPKCE:{description:"boolean to indicate if the endpoint needs a PKCE code",type:"boolean",defaultValue:!0},domains:{description:"array of valid domains the url can contain to use this account",type:"stringArray",defaultValue:["addtodropbox.com","db.tt","dropbox.com","dropboxapi.com","dropboxbusiness.com","dropbox.tech","getdropbox.com"]}},{baseConfiguration:f,explicitlyTyped:!0}),G={shared_link_not_found:"The shared link wasn't found.",shared_link_access_denied:"The caller is not allowed to access this shared link.",unsupported_link_type:"This type of link is not supported; use files/export instead.",shared_link_is_directory:"Directories cannot be retrieved by this endpoint."};function q(e,t){return _.apply(this,arguments)}function _(){return(_=(0,g.Z)((0,p.Z)().mark((function e(t,n){var r,a,i;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="",e.prev=1,e.t0=JSON,e.next=5,t.text();case 5:e.t1=e.sent,a=e.t0.parse.call(e.t0,e.t1),i=a.error[".tag"],r=G[i]||i,e.next=13;break;case 11:e.prev=11,e.t2=e.catch(1);case 13:return e.abrupt("return",Z({response:t,reason:n,statusText:r}));case 14:case"end":return e.stop()}}),e,null,[[1,11]])})))).apply(this,arguments)}var U=n(95088);function J(e){return(0,B.jsx)(U.Z,(0,h.Z)((0,h.Z)({},e),{},{children:(0,B.jsx)("path",{d:"M3 6.2L8 9.39L13 6.2L8 3L3 6.2M13 6.2L18 9.39L23 6.2L18 3L13 6.2M3 12.55L8 15.74L13 12.55L8 9.35L3 12.55M18 9.35L13 12.55L18 15.74L23 12.55L18 9.35M8.03 16.8L13.04 20L18.04 16.8L13.04 13.61L8.03 16.8Z"})}))}var X=function(e){return M(f).named("DropboxOAuthInternetAccount").props({type:v.types.literal("DropboxOAuthInternetAccount"),configuration:(0,l.ConfigurationReference)(e)}).views((function(){return{get toggleContents(){return(0,B.jsx)(J,{})},get selectorLabel(){return"Enter Dropbox share link"}}})).actions((function(e){return{getFetcher:function(t){return function(){var n=(0,g.Z)((0,p.Z)().mark((function n(r,a){var i,o,s;return(0,p.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.getToken(t);case 2:return i=n.sent,(o=e.addAuthHeaderToInit((0,h.Z)((0,h.Z)({},a),{},{method:"POST"}),i)).headers.append("Dropbox-API-Arg",JSON.stringify({url:r})),n.next=7,fetch("https://content.dropboxapi.com/2/sharing/get_shared_link_file",o);case 7:if((s=n.sent).ok){n.next=14;break}return n.t0=Error,n.next=12,q(s);case 12:throw n.t1=n.sent,new n.t0(n.t1);case 14:return n.abrupt("return",s);case 15:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()},validateToken:function(t,n){var r=this;return(0,g.Z)((0,p.Z)().mark((function a(){var i,o,s;return(0,p.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch("https://api.dropboxapi.com/2/sharing/get_shared_link_metadata",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({url:n.uri})});case 2:if((i=a.sent).ok){a.next=16;break}if(!(o=e.retrieveRefreshToken())){a.next=11;break}return e.removeRefreshToken(),a.next=9,e.exchangeRefreshForAccessToken(o);case 9:return s=a.sent,a.abrupt("return",r.validateToken(s,n));case 11:return a.t0=Error,a.next=14,q(i,"Token could not be validated");case 14:throw a.t1=a.sent,new a.t0(a.t1);case 16:return a.abrupt("return",t);case 17:case"end":return a.stop()}}),a)})))()}}}))};var Y=(0,l.ConfigurationSchema)("GoogleDriveOAuthInternetAccount",{authEndpoint:{description:"the authorization code endpoint of the internet account",type:"string",defaultValue:"https://accounts.google.com/o/oauth2/v2/auth"},scopes:{description:"optional scopes for the authorization call",type:"string",defaultValue:"https://www.googleapis.com/auth/drive.readonly"},domains:{description:"array of valid domains the url can contain to use this account",type:"stringArray",defaultValue:['drive.google.com"']},responseType:{description:"the type of response from the authorization endpoint",type:"string",defaultValue:"token"}},{baseConfiguration:f,explicitlyTyped:!0});function Q(e,t){return K.apply(this,arguments)}function K(){return(K=(0,g.Z)((0,p.Z)().mark((function e(t,n){var r,a;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="",e.prev=1,e.t0=JSON,e.next=5,t.text();case 5:e.t1=e.sent,a=e.t0.parse.call(e.t0,e.t1),r=a.error.message,e.next=12;break;case 10:e.prev=10,e.t2=e.catch(1);case 12:return e.abrupt("return",Z({response:t,reason:n,statusText:r}));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}var $=n(93069),ee=n(95058),te=n(33528),ne=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e,r){var i;return(0,a.Z)(this,n),(i=t.call(this,e,r)).statsPromise=void 0,i.statsPromise=i.fetch(e,{metadataOnly:!0}).then((function(e){return e.json()})),i}return(0,i.Z)(n,[{key:"fetch",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t,r){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,$.Z)((0,ee.Z)(n.prototype),"fetch",this).call(this,t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"stat",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.statsPromise);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(te.RemoteFileWithRangeCache);function re(e){return(0,B.jsx)(U.Z,(0,h.Z)((0,h.Z)({},e),{},{children:(0,B.jsx)("path",{d:"M7.71,3.5L1.15,15L4.58,21L11.13,9.5M9.73,15L6.3,21H19.42L22.85,15M22.28,14L15.42,2H8.58L8.57,2L15.43,14H22.28Z"})}))}function ae(e){var t=e.match(/[-\w]{25,}/);return"https://www.googleapis.com/drive/v3/files/".concat(t)}function ie(e){return M(f).named("GoogleDriveOAuthInternetAccount").props({type:v.types.literal("GoogleDriveOAuthInternetAccount"),configuration:(0,l.ConfigurationReference)(e)}).views((function(){return{get toggleContents(){return(0,B.jsx)(re,{})},get selectorLabel(){return"Enter Google Drive share link"}}})).actions((function(e){return{getFetcher:function(t){return function(){var n=(0,g.Z)((0,p.Z)().mark((function n(r,a){var i,o,s,u;return(0,p.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=new URL(ae(String(r))),o=new URLSearchParams,null!==a&&void 0!==a&&a.metadataOnly?o.append("fields","size"):o.append("alt","media"),i.search=o.toString(),n.next=6,e.getToken(t);case 6:return s=n.sent,n.next=9,fetch(i,e.addAuthHeaderToInit((0,h.Z)((0,h.Z)({},a),{},{method:"GET",credentials:"same-origin"}),s));case 9:if((u=n.sent).ok){n.next=16;break}return n.t0=Error,n.next=14,Q(u);case 14:throw n.t1=n.sent,new n.t0(n.t1);case 16:return n.abrupt("return",u);case 17:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()},openLocation:function(e){return new ne(e.uri,{fetch:this.getFetcher(e)})},validateToken:function(e,t){return(0,g.Z)((0,p.Z)().mark((function n(){var r;return(0,p.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(ae(t.uri),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/x-www-form-urlencoded"}});case 2:if((r=n.sent).ok){n.next=9;break}return n.t0=Error,n.next=7,Q(r,"Token could not be validated");case 7:throw n.t1=n.sent,new n.t0(n.t1);case 9:return n.abrupt("return",e);case 10:case"end":return n.stop()}}),n)})))()}}}))}var oe=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="AuthenticationPlugin",e.exports={OAuthConfigSchema:f,OAuthInternetAccountModelFactory:M,ExternalTokenConfigSchema:R,ExternalTokenInternetAccountModelFactory:V,HTTPBasicConfigSchema:z,HTTPBasicInternetAccountModelFactory:W,DropboxOAuthConfigSchema:H,DropboxOAuthInternetAccountModelFactory:X,GoogleDriveOAuthConfigSchema:Y,GoogleDriveOAuthInternetAccountModelFactory:ie},e}return(0,i.Z)(n,[{key:"install",value:function(e){e.addInternetAccountType((function(){return new c.Z({name:"OAuthInternetAccount",configSchema:f,stateModel:M(f)})})),e.addInternetAccountType((function(){return new c.Z({name:"ExternalTokenInternetAccount",configSchema:R,stateModel:V(R)})})),e.addInternetAccountType((function(){return new c.Z({name:"HTTPBasicInternetAccount",configSchema:z,stateModel:W(z)})})),e.addInternetAccountType((function(){return new c.Z({name:"DropboxOAuthInternetAccount",configSchema:H,stateModel:X(H)})})),e.addInternetAccountType((function(){return new c.Z({name:"GoogleDriveOAuthInternetAccount",configSchema:Y,stateModel:ie(Y)})}))}}]),n}(u.Z),se=n(93029);var ue=(0,l.ConfigurationSchema)("BigBedAdapter",{bigBedLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bb",locationType:"UriLocation"}}},{explicitlyTyped:!0});var ce=(0,l.ConfigurationSchema)("BedpeAdapter",{bedpeLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bedpe.gz",locationType:"UriLocation"}},columnNames:{type:"stringArray",description:"List of column names",defaultValue:[]}},{explicitlyTyped:!0});var le=(0,l.ConfigurationSchema)("BedTabixAdapter",{bedGzLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bed.gz",locationType:"UriLocation"}},index:(0,l.ConfigurationSchema)("TabixIndex",{indexType:{model:v.types.enumeration("IndexType",["TBI","CSI"]),type:"stringEnum",defaultValue:"TBI"},location:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bed.gz.tbi",locationType:"UriLocation"}}}),columnNames:{type:"stringArray",description:"List of column names",defaultValue:[]},scoreColumn:{type:"string",description:'The column to use as a "score" attribute',defaultValue:""},autoSql:{type:"string",description:"The autoSql definition for the data fields in the file",defaultValue:""}},{explicitlyTyped:!0});var de=(0,l.ConfigurationSchema)("BedAdapter",{bedLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bed.gz",locationType:"UriLocation"}},columnNames:{type:"stringArray",description:"List of column names",defaultValue:[]},scoreColumn:{type:"string",description:'The column to use as a "score" attribute',defaultValue:""},autoSql:{type:"string",description:"The autoSql definition for the data fields in the file",defaultValue:""},colRef:{type:"number",description:'The column to use as a "refName" attribute',defaultValue:0},colStart:{type:"number",description:'The column to use as a "start" attribute',defaultValue:1},colEnd:{type:"number",description:'The column to use as a "end" attribute',defaultValue:2}},{explicitlyTyped:!0}),fe=n(97891),pe=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="BedPlugin",e}return(0,i.Z)(r,[{key:"install",value:function(e){!function(e){e.addAdapterType((function(){return new se.Z({name:"BigBedAdapter",displayName:"BigBed adapter",configSchema:ue,getAdapterClass:function(){return Promise.all([n.e(1462),n.e(6237),n.e(3787)]).then(n.bind(n,63787)).then((function(e){return e.default}))}})}))}(e),function(e){e.addAdapterType((function(){return new se.Z({name:"BedAdapter",displayName:"BED adapter",configSchema:de,getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(6362),n.e(1462),n.e(96)]).then(n.bind(n,58108)).then((function(e){return e.default}))}})}))}(e),function(e){e.addAdapterType((function(){return new se.Z({name:"BedpeAdapter",displayName:"BEDPE adapter",configSchema:ce,getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(6362),n.e(1150)]).then(n.bind(n,21150)).then((function(e){return e.default}))}})}))}(e),function(e){e.addAdapterType((function(){return new se.Z({name:"BedTabixAdapter",displayName:"BED tabix adapter",configSchema:le,getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(2821),n.e(8022),n.e(1462),n.e(3653)]).then(n.bind(n,53653)).then((function(e){return e.default}))}})}))}(e),e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="BigBedAdapter",i=(0,fe.getFileName)(t),o={type:a,bigBedLocation:t};return/\.(bb|bigbed)$/i.test(i)&&!r||r===a?o:e(t,n,r)}})),e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="BedpeAdapter",i=(0,fe.getFileName)(t);return/\.bedpe\.gz$/i.test(i)||r===a?{type:a,bedpeLocation:t}:e(t,n,r)}})),e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="BedTabixAdapter",i=(0,fe.getFileName)(t),o=n&&(0,fe.getFileName)(n);return/\.bed\.b?gz$/i.test(i)||r===a?{type:a,bedGzLocation:t,index:{location:n||(0,fe.makeIndex)(t,".tbi"),indexType:(0,fe.makeIndexType)(o,"CSI","TBI")}}:e(t,n,r)}})),e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="BedAdapter",i=(0,fe.getFileName)(t);return/\.bed$/i.test(i)||r===a?{type:a,bedLocation:t}:e(t,n,r)}})),e.addToExtensionPoint("Core-guessTrackTypeForLocation",(function(e){return function(t){return"BedpeAdapter"===t?"VariantTrack":e(t)}}))}}]),r}(u.Z),he=n(29206),ge=n(99069),me=(0,l.ConfigurationSchema)("BreakpointAlignmentsWidget",{}),ve=v.types.model("BreakpointAlignmentsWidget",{id:he.ElementId,type:v.types.literal("BreakpointAlignmentsWidget"),featureData:v.types.frozen()}).actions((function(e){return{setFeatureData:function(t){e.featureData=t},clearFeatureData:function(){e.featureData=void 0}}})),ye=n(39798),be=n(6556),we=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"snapshotFromBreakendFeature",value:function(e,t){var n,r,a=null===(n=e.get("ALT"))||void 0===n?void 0:n[0],i=a?(0,be.I)(a):void 0,o=e.get("start"),s=t.displayedRegions[0].assemblyName,u=(0,m.getSession)(t).assemblyManager.get(s);if(!u)throw new Error("assembly ".concat(s," not found"));if(!u.regions)throw new Error("assembly ".concat(s," regions not loaded"));var c,l=u.getCanonicalRefName,d=l(e.get("refName")),f=u.regions.find((function(e){return e.refName===d})),p=0,g=0;if("<TRA>"===a){var v=e.get("INFO");r=v.END[0]-1,c=l(v.CHR2[0])}else if(null!==i&&void 0!==i&&i.MatePosition){var y=i.MatePosition.split(":");r=+y[1]-1,c=l(y[0]),"left"===i.Join&&(p=-1),"left"===i.MateDirection&&(g=-1)}else if(e.get("mate")){var b=e.get("mate");c=l(b.refName),r=b.start}if(!c)throw new Error("unable to resolve mate refName ".concat(c," in reference genome"));var w=u.regions.find((function(e){return e.refName===c}));if(!f||!w)throw new Error("unable to find the refName for the top or bottom of the breakpoint view");var x=[(0,h.Z)({},f),(0,h.Z)({},f)],k=[(0,h.Z)({},w),(0,h.Z)({},w)];return x[0].end=o+p,x[1].start=o+p,k[0].end=r+g,k[1].start=r+g,{type:"BreakpointSplitView",views:[{type:"LinearGenomeView",displayedRegions:x,hideHeader:!0,bpPerPx:10,offsetPx:(f.start+e.get("start"))/10},{type:"LinearGenomeView",displayedRegions:k,hideHeader:!0,bpPerPx:10,offsetPx:(w.start+r)/10}],displayName:"".concat(e.get("name")||e.get("id")||"breakend"," split detail")}}}]),n}(ye.Z),xe=n(68079),ke=n(90689),Ze=n(21918),Ce=n(69416),Se=n(1437),Te=n(44750),Pe=(0,I.lazy)((function(){return n.e(3547).then(n.bind(n,83547))}));function Me(e,t){var n,r;return null===(n=(r=e.displays[0]).searchFeatureByID)||void 0===n?void 0:n.call(r,t.id())}function Re(e,t){return Ae.apply(this,arguments)}function Ae(){return Ae=(0,g.Z)((0,p.Z)().mark((function e(t,n){var r,a,i,o,s,u;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.views,a=(0,m.getSession)(t),i=a.rpcManager,o=a.assemblyManager,s=t.views[0].assemblyNames[0],e.next=5,o.waitForAssembly(s);case 5:if(e.sent){e.next=8;break}return e.abrupt("return",void 0);case 8:return u=n.configuration.trackId,e.abrupt("return",Promise.all(r.map(function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.call(u,"CoreGetFeatures",{adapterConfig:(0,l.getConf)(n,["adapter"]),sessionId:u,regions:t.staticBlocks.contentBlocks});case 2:return e.abrupt("return",e.sent.flat());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 10:case"end":return e.stop()}}),e)}))),Ae.apply(this,arguments)}function Ie(e){var t=v.types.model("BreakpointSplitView",{type:v.types.literal("BreakpointSplitView"),height:v.types.optional(v.types.refinement("viewHeight",v.types.number,(function(e){return e>=40})),400),trackSelectorType:"hierarchical",showIntraviewLinks:!0,linkViews:!1,interactToggled:!1,views:v.types.array(e.getViewType("LinearGenomeView").stateModel)}).volatile((function(){return{width:800,matchedTrackFeatures:{}}})).views((function(e){return{exportSvg:function(){var t=arguments;return(0,g.Z)((0,p.Z)().mark((function r(){var a,i,o,s,u;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=t.length>0&&void 0!==t[0]?t[0]:{},r.next=3,n.e(4381).then(n.bind(n,44381));case 3:return i=r.sent,o=i.renderToSvg,r.next=7,o(e,a);case 7:s=r.sent,u=new Blob([s],{type:"image/svg+xml"}),(0,Ze.saveAs)(u,a.filename||"image.svg");case 10:case"end":return r.stop()}}),r)})))()}}})).views((function(e){return{get matchedTracks(){return Te.wf.apply(void 0,[function(e){return e.configuration.trackId}].concat((0,xe.Z)(e.views.map((function(e){return e.tracks})))))},getMatchedTracks:function(t){return e.views.map((function(e){return e.getTrack(t)})).filter((function(e){return!!e}))},hasTranslocations:function(e){return(0,xe.Z)(this.getTrackFeatures(e).values()).find((function(e){return"translocation"===e.get("type")}))},getTrackFeatures:function(t){var n;return new Map(null===(n=e.matchedTrackFeatures[t])||void 0===n?void 0:n.flat().map((function(e){return[e.id(),e]})))},getMatchedFeaturesInLayout:function(e,t){var n=this.getMatchedTracks(e);return t.map((function(e){return e.map((function(e){var t=n.findIndex((function(t){return Me(t,e)}));return-1!==t?{feature:e,layout:Me(n[t],e),level:t}:void 0})).filter(m.notEmpty)}))}}})).actions((function(e){return{afterAttach:function(){var t=this;(0,v.addDisposer)(e,(0,v.onAction)(e,(function(n){var r=n.name,a=n.path,i=n.args;if(e.linkViews){["horizontalScroll","zoomTo","setScaleFactor","showTrack","toggleTrack","hideTrack","setTrackLabels","toggleCenterLine"].includes(r)&&a&&t.onSubviewAction(r,a,i)}})))},onSubviewAction:function(t,n,r){e.views.forEach((function(e){(0,v.getPath)(e).endsWith(n)||e[t](null===r||void 0===r?void 0:r[0])}))},setWidth:function(t){e.width=t,e.views.forEach((function(e){return e.setWidth(t)}))},removeView:function(t){e.views.remove(t)},closeView:function(){(0,v.getParent)(e,2).removeView(e)},toggleInteract:function(){e.interactToggled=!e.interactToggled},toggleIntraviewLinks:function(){e.showIntraviewLinks=!e.showIntraviewLinks},toggleLinkViews:function(){e.linkViews=!e.linkViews},setMatchedTrackFeatures:function(t){e.matchedTrackFeatures=t}}})).actions((function(e){return{afterAttach:function(){(0,v.addDisposer)(e,(0,ke.autorun)((0,g.Z)((0,p.Z)().mark((function t(){return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.views.every((function(e){return e.initialized}))){t.next=3;break}return t.abrupt("return");case 3:return t.t0=e,t.t1=Object,t.next=7,Promise.all(e.matchedTracks.map(function(){var t=(0,g.Z)((0,p.Z)().mark((function t(n){return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=n.configuration.trackId,t.next=3,Re(e,n);case 3:return t.t1=t.sent,t.abrupt("return",[t.t0,t.t1]);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 7:t.t2=t.sent,t.t3=t.t1.fromEntries.call(t.t1,t.t2),t.t0.setMatchedTrackFeatures.call(t.t0,t.t3),t.next=16;break;case 12:t.prev=12,t.t4=t.catch(0),console.error(t.t4),(0,m.getSession)(e).notify("".concat(t.t4),"error");case 16:case"end":return t.stop()}}),t,null,[[0,12]])})))))},menuItems:function(){return[].concat((0,xe.Z)(e.views.map((function(e,t){var n;return[t,null===(n=e.menuItems)||void 0===n?void 0:n.call(e)]})).filter((function(e){return!!e[1]})).map((function(e){return{label:"View ".concat(e[0]+1," Menu"),subMenu:e[1]}}))),[{label:"Show intra-view links",type:"checkbox",checked:e.showIntraviewLinks,onClick:function(){return e.toggleIntraviewLinks()}},{label:"Allow clicking alignment squiggles?",type:"checkbox",checked:e.interactToggled,onClick:function(){return e.toggleInteract()}},{label:"Link views",type:"checkbox",icon:Se.Z,checked:e.linkViews,onClick:function(){e.toggleLinkViews()}},{label:"Export SVG",icon:Ce.Z,onClick:function(){(0,m.getSession)(e).queueDialog((function(t){return[Pe,{model:e,handleClose:t}]}))}}])}}}));return v.types.compose(d.BaseViewModel,t)}var Le=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="BreakpointSplitViewPlugin",e}return(0,i.Z)(r,[{key:"install",value:function(e){!function(e){e.addViewType((function(){return new we({name:"BreakpointSplitView",displayName:"Breakpoint split view",stateModel:Ie(e),ReactComponent:(0,I.lazy)((function(){return n.e(9624).then(n.bind(n,29624))}))})}))}(e),function(e){e.addWidgetType((function(){return new ge.WidgetType({name:"BreakpointAlignmentsWidget",heading:"Breakpoint feature details",configSchema:me,stateModel:ve,ReactComponent:(0,I.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(1356),n.e(2942),n.e(7321)]).then(n.bind(n,46618))}))})}))}(e)}},{key:"configure",value:function(){}}]),r}(u.Z),Ne=n(38787),Fe=n(79629);var je=(0,l.ConfigurationSchema)("PAFAdapter",{assemblyNames:{type:"stringArray",defaultValue:[],description:"Array of assembly names to use for this file. The target assembly name is the first value in the array, query assembly name is the second"},targetAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames: the target assembly name"},queryAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames: the query assembly name"},pafLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/file.paf",locationType:"UriLocation"}}},{explicitlyTyped:!0});var De=(0,l.ConfigurationSchema)("MCScanAnchorsAdapter",{mcscanAnchorsLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/mcscan.anchors",locationType:"UriLocation"}},bed1Location:{type:"fileLocation",defaultValue:{uri:"/path/to/file.bed",locationType:"UriLocation"}},bed2Location:{type:"fileLocation",defaultValue:{uri:"/path/to/file.bed",locationType:"UriLocation"}},assemblyNames:{type:"stringArray",defaultValue:[]}},{explicitlyTyped:!0});var Be=(0,l.ConfigurationSchema)("MCScanSimpleAnchorsAdapter",{mcscanSimpleAnchorsLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/mcscan.anchors.simple",locationType:"UriLocation"}},bed1Location:{type:"fileLocation",defaultValue:{uri:"/path/to/file.bed",locationType:"UriLocation"}},bed2Location:{type:"fileLocation",defaultValue:{uri:"/path/to/file.bed",locationType:"UriLocation"}},assemblyNames:{type:"stringArray",defaultValue:[]}},{explicitlyTyped:!0});var Ee=(0,l.ConfigurationSchema)("MashMapAdapter",{assemblyNames:{type:"stringArray",defaultValue:[],description:"Target is the first value in the array, query is the second"},targetAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames array: the target assembly"},queryAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames array: the query assembly"},outLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/mashmap.out",locationType:"UriLocation"}}},{explicitlyTyped:!0});var Ve=(0,l.ConfigurationSchema)("DeltaAdapter",{assemblyNames:{type:"stringArray",defaultValue:[],description:"Array of assembly names to use for this file. The target assembly name is the first value in the array, query assembly name is the second"},targetAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames: the target assembly name"},queryAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames: the query assembly name"},deltaLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/file.delta",locationType:"UriLocation"}}},{explicitlyTyped:!0});var ze=(0,l.ConfigurationSchema)("ChainAdapter",{assemblyNames:{type:"stringArray",defaultValue:[],description:"Target is the first value in the array, query is the second"},targetAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames array: the target assembly"},queryAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames array: the query assembly"},chainLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/file.chain",locationType:"UriLocation"}}},{explicitlyTyped:!0}),Oe=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="ComparativeAdaptersPlugin",e}return(0,i.Z)(r,[{key:"install",value:function(e){!function(e){e.addAdapterType((function(){return new se.Z({name:"PAFAdapter",displayName:"PAF adapter",configSchema:je,adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(6275)]).then(n.bind(n,86275)).then((function(e){return e.default}))}})}))}(e),function(e){e.addAdapterType((function(){return new se.Z({name:"DeltaAdapter",displayName:"MUMmer delta adapter",configSchema:Ve,adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(3327)]).then(n.bind(n,43327)).then((function(e){return e.default}))}})}))}(e),function(e){e.addAdapterType((function(){return new se.Z({name:"ChainAdapter",displayName:"Liftover chain adapter",configSchema:ze,adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(5674)]).then(n.bind(n,85674)).then((function(e){return e.default}))}})}))}(e),function(e){e.addAdapterType((function(){return new se.Z({name:"MCScanAnchorsAdapter",displayName:"MCScan anchors adapter",configSchema:De,adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(874)]).then(n.bind(n,30874)).then((function(e){return e.default}))}})}))}(e),function(e){e.addAdapterType((function(){return new se.Z({name:"MCScanSimpleAnchorsAdapter",displayName:"MCScan anchors.simple adapter",configSchema:Be,adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(8374)]).then(n.bind(n,58374)).then((function(e){return e.default}))}})}))}(e),function(e){e.addAdapterType((function(){return new se.Z({name:"MashMapAdapter",displayName:"MashMap adapter",configSchema:Ee,adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(376)]).then(n.bind(n,80376)).then((function(e){return e.default}))}})}))}(e),e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="PAFAdapter",i=(0,fe.getFileName)(t);return/\.paf/i.test(i)||r===a?{type:a,pafLocation:t}:e(t,n,r)}})),e.addToExtensionPoint("Core-guessTrackTypeForLocation",(function(e){return function(t){return"PAFAdapter"===t?"SyntenyTrack":e(t)}}))}}]),r}(u.Z),We=n(17237),He=n(54397),Ge=n(59740),qe=n(20478),_e=n(22417),Ue=n(77879),Je=n(54006),Xe=n(60717);var Ye=Je.Z.extend((function(e){var t=ke.observable.box(1);return{views:{get dynamicBlocks(){return(0,Xe.Z)(e,!1,!1)},get scaleFactor(){return t.get()},get maxBpPerPx(){return e.totalBp/(e.width-50)},get minBpPerPx(){return.02},get maxOffset(){return e.displayedRegionsTotalPx-.2*e.width},get minOffset(){return.8*-e.width}},actions:{setScaleFactor:function(e){t.set(e)},center:function(){var t=e.totalBp/2/e.bpPerPx;e.scrollTo(t-e.width/2)}}}})),Qe=Ye.extend((function(e){return{views:{get width(){return(0,v.getParent)(e).viewWidth}}}})),Ke=Ye.extend((function(e){return{views:{get width(){return(0,v.getParent)(e).viewHeight}}}})),$e=n(59594),et=["id"],tt=["id"],nt=(0,I.lazy)((function(){return n.e(5686).then(n.bind(n,25686))})),rt=(0,I.lazy)((function(){return Promise.resolve().then(n.bind(n,91583))})),at=function(e){return(0,m.measureText)(e.slice(0,30))},it=function(e,t){return(0,m.max)([].concat((0,xe.Z)(e.filter((function(e){return!t.has(e.key)})).map((function(e){return at(e.refName)}))),(0,xe.Z)(e.filter((function(e){return!t.has(e.key)})).map((function(e){return at(e.end.toLocaleString("en-us"))})))))};var ot=n(81575),st=n(53276),ut=n(33359),ct=n(90550),lt=(0,st.ZL)()((function(e){var t=e.palette.action.disabledBackground;return{loading:{paddingLeft:"0.6em",backgroundColor:e.palette.background.default,backgroundImage:"repeating-linear-gradient(45deg, transparent, transparent 5px, ".concat(t," 5px, ").concat(t," 10px)"),textAlign:"center"},blockMessage:{backgroundColor:t,padding:"10px"},blockError:{backgroundColor:t,padding:"10px",color:"red"}}}));function dt(){var e=(0,I.useState)(!1),t=(0,A.Z)(e,2),n=t[0],r=t[1],a=lt().classes;return(0,I.useEffect)((function(){var e=setTimeout((function(){return r(!0)}),300);return function(){return clearTimeout(e)}}),[]),n?(0,B.jsx)("div",{className:a.loading,children:(0,B.jsx)(D.LoadingEllipses,{})}):null}function ft(e){var t=e.messageText,n=lt().classes;return(0,B.jsx)("div",{className:n.blockMessage,children:(0,B.jsx)(ut.Z,{children:"".concat(t)})})}function pt(e){var t=e.error,n=lt().classes;return(0,B.jsx)("div",{className:n.blockError,children:(0,B.jsx)(ut.Z,{children:"".concat(t)})})}var ht=(0,ct.observer)((function(e){var t=e.model,n=e.style;return t.error?(0,B.jsx)(pt,{error:t.error,"data-testid":"reload_button"}):t.message?(0,B.jsx)(ft,{messageText:t.message}):t.filled?t.shouldDisplay?(0,B.jsx)("div",{style:n,children:t.reactElement}):null:(0,B.jsx)(dt,{})})),gt=ht,mt=n(39554),vt=n.n(mt),yt=["reactElement"];function bt(e){var t=(0,m.getSession)(e).rpcManager,n=e.rendererType,r=e.adapterConfig,a=(0,m.getContainingView)(e);if((0,l.readConfObject)(e.configuration),(0,v.getSnapshot)(a),a.initialized){var i=a.viewWidth,o=a.viewHeight,s=a.borderSize,u=a.borderX,c=a.borderY;return{rendererType:n,rpcManager:t,renderProps:(0,h.Z)((0,h.Z)({},e.renderProps()),{},{view:vt()((0,v.getSnapshot)(a)),width:i,height:o,borderSize:s,borderX:u,borderY:c,adapterConfig:r,rendererType:n.name,sessionId:(0,fe.getRpcSessionId)(e),timeout:1e6})}}}function wt(){return(wt=(0,g.Z)((0,p.Z)().mark((function e(t){var n,r,a,i,o,s;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n=t.rendererType,r=t.rpcManager,a=t.renderProps,e.next=5,n.renderInClient(r,a);case 5:return i=e.sent,o=i.reactElement,s=(0,Ge.Z)(i,yt),e.abrupt("return",{reactElement:o,data:s,renderingComponent:n.ReactComponent});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xt(e){return v.types.compose("DotplotDisplay",d.BaseDisplay,v.types.model({type:v.types.literal("DotplotDisplay"),configuration:(0,l.ConfigurationReference)(e)}).volatile((function(){return{warnings:[],renderInProgress:void 0,filled:!1,data:void 0,reactElement:void 0,message:void 0,renderingComponent:void 0,ReactComponent2:gt}}))).views((function(e){return{get shouldDisplay(){var t=(0,m.getContainingView)(e),n=t.vview,r=t.hview;return n.bpPerPx===e.data.bpPerPxY&&r.bpPerPx===e.data.bpPerPxX},get rendererTypeName(){return(0,l.getConf)(e,["renderer","type"])},renderProps:function(){return(0,h.Z)((0,h.Z)({},(0,fe.getParentRenderProps)(e)),{},{rpcDriverName:e.rpcDriverName,displayModel:e,config:e.configuration.renderer})}}})).views((function(e){return{renderSvg:function(t){return(0,g.Z)((0,p.Z)().mark((function n(){var r,a,i,o,s,u,c,l,d,f;return(0,p.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=bt(e)){n.next=3;break}return n.abrupt("return",null);case 3:return a=r.rendererType,i=r.rpcManager,o=r.renderProps,n.next=6,a.renderInClient(i,(0,h.Z)((0,h.Z)({},o),{},{exportSVG:t,theme:t.theme||o.theme}));case 6:return s=n.sent,u=(0,m.getContainingView)(e),c=u.hview,l=u.vview,d=-c.offsetPx+s.offsetX,f=-l.offsetPx+s.offsetY,n.abrupt("return",(0,B.jsx)("g",{transform:"translate(".concat(d," ").concat(-f,")"),children:(0,B.jsx)(m.ReactRendering,{rendering:s})}));case 11:case"end":return n.stop()}}),n)})))()}}})).actions((function(e){var t;return{afterAttach:function(){(0,m.makeAbortableReaction)(e,(function(){return bt(e)}),(function(e){return function(e){return wt.apply(this,arguments)}(e)}),{name:"".concat(e.type," ").concat(e.id," rendering"),delay:500,fireImmediately:!0},this.setLoading,this.setRendered,this.setError)},setLoading:function(n){e.filled=!1,e.message=void 0,e.reactElement=void 0,e.data=void 0,e.error=void 0,e.renderingComponent=void 0,t=n},setMessage:function(n){t&&!t.signal.aborted&&t.abort(),e.filled=!1,e.message=n,e.reactElement=void 0,e.data=void 0,e.error=void 0,e.renderingComponent=void 0,t=void 0},setRendered:function(n){if(void 0!==n){var r=n.data,a=n.reactElement,i=n.renderingComponent;e.warnings=r.warnings,e.filled=!0,e.message=void 0,e.reactElement=a,e.data=r,e.error=void 0,e.renderingComponent=i,t=void 0}},setError:function(n){console.error(n),t&&!t.signal.aborted&&t.abort(),e.filled=!1,e.message=void 0,e.reactElement=void 0,e.data=void 0,e.error=n,e.renderingComponent=void 0,t=void 0}}}))}var kt=(0,ct.observer)((function(e){var t=e.model,n=e.children,r=t.data||{},a=r.offsetX,i=void 0===a?0:a,o=r.offsetY,s=void 0===o?0:o,u=(0,m.getContainingView)(t),c=u.vview.offsetPx-s,l=-(u.hview.offsetPx-i);return(0,B.jsxs)("div",{style:{position:"relative"},children:[(0,B.jsx)(t.ReactComponent2,(0,h.Z)((0,h.Z)({},e),{},{style:{position:"absolute",top:c,left:l}})),n]})})),Zt=kt,Ct=function(e){e.addDisplayType((function(){var t=function(e){return(0,l.ConfigurationSchema)("DotplotDisplay",{renderer:v.types.optional(e.pluggableConfigSchemaType("renderer"),{type:"DotplotRenderer"})},{explicitIdentifier:"displayId",explicitlyTyped:!0})}(e);return new ot.Z({name:"DotplotDisplay",displayName:"Dotplot display",configSchema:t,stateModel:xt(t),trackType:"SyntenyTrack",viewType:"DotplotView",ReactComponent:Zt})}))};var St=(0,ct.observer)((function(e){return(0,B.jsx)(D.PrerenderedCanvas,(0,h.Z)({},e))})),Tt=n(41361),Pt=n(68554),Mt=n(43103),Rt=r.tr.parseCigar,At="fell outside of range due to CIGAR string",It="(less than min coordinate of feature)",Lt="(greater than max coordinate of feature)";function Nt(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;e.beginPath(),e.arc(t,n,r/2,0,2*Math.PI),e.fill()}var Ft=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).supportsSVG=!0,e}return(0,i.Z)(n,[{key:"renameRegionsIfNeeded",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t){var n,r,a,i,o,s,u,c,l;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=function(){return(l=(0,g.Z)((0,p.Z)().mark((function e(t){var n;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}throw new Error("No assembly manager provided");case 2:return e.next=4,(0,m.renameRegionsIfNeeded)(i,{sessionId:s,adapterConfig:u,regions:t});case 4:return n=e.sent,e.abrupt("return",n.regions);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)},c=function(e){return l.apply(this,arguments)},a=this.pluginManager,i=null===(n=a.rootModel)||void 0===n||null===(r=n.session)||void 0===r?void 0:r.assemblyManager,o=t.view,s=t.sessionId,u=t.adapterConfig,e.next=7,c(o.hview.displayedRegions);case 7:return o.hview.displayedRegions=e.sent,e.next=10,c(o.vview.displayedRegions);case 10:return o.vview.displayedRegions=e.sent,e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"drawDotplot",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t,n){var r,a,i,o,s,u,c,d,f,g,m,y,b,w,x,k,Z,C,S,T,P,M,R,I,L,N,F,j,B,E,V,z,O,W,H,G,q,_,U,J,X,Y,Q,K,$,ee,te,ne,re,ae,ie,oe,se,ue,ce,le,de;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:L=function(e,t,n,r){if(e<t-1){var a=r.get("mate"),i=a.refName,o=a.start,s=a.end;return P.push({message:"feature at (Y ".concat(i,":").concat(o,"-").concat(s,") ").concat(At," ").concat(It),effect:"clipped the feature"}),t}if(e>n+1){var u=r.get("mate"),c=u.refName,l=u.start,d=u.end;return P.push({message:"feature at (Y ".concat(c,":").concat(l,"-").concat(d,") ").concat(At," ").concat(Lt),effect:"clipped the feature"}),n}return e},I=function(e,t,n,r){var a=r.get("strand")||1;if(-1===a){var i=[t,n];n=i[0],t=i[1]}if(e<t-1){var o=r.get("start"),s=r.get("end"),u=r.get("refName");if(-1===a){var c=[o,s];s=c[0],o=c[1]}return P.push({message:"feature at (X ".concat(u,":").concat(o,"-").concat(s,") ").concat(At," ").concat(It),effect:"clipped the feature"}),t}if(e>n+1){var l=r.get("strand")||1,d=1===l?r.get("start"):r.get("end"),f=1===l?r.get("end"):r.get("start"),p=r.get("refName");return P.push({message:"feature at (X ".concat(p,":").concat(d,"-").concat(f,") ").concat(At," ").concat(Lt),effect:"clipped the feature"}),n}return e},i=n.config,o=n.views,s=n.height,u=n.drawCigar,c=n.theme,d=(0,l.readConfObject)(i,"color"),f=(0,l.readConfObject)(i,"posColor"),g=(0,l.readConfObject)(i,"negColor"),m=(0,l.readConfObject)(i,"colorBy"),y=(0,l.readConfObject)(i,"lineWidth"),b=(0,l.readConfObject)(i,"thresholds"),w=(0,l.readConfObject)(i,"thresholdsPalette"),x=i.color.isCallback,k=(0,A.Z)(o,2),Z=k[0],C=k[1],S=null===(r=Z.dynamicBlocks.contentBlocks[0])||void 0===r?void 0:r.offsetPx,T=null===(a=C.dynamicBlocks.contentBlocks[0])||void 0===a?void 0:a.offsetPx,P=[],t.lineWidth=y,M=Z.bpPerPx,R=C.bpPerPx,N=(0,h.Z)((0,h.Z)({},(0,v.getSnapshot)(Z)),{},{staticBlocks:Z.staticBlocks,width:Z.width}),F=(0,h.Z)((0,h.Z)({},(0,v.getSnapshot)(C)),{},{staticBlocks:C.staticBlocks,width:C.width}),j=(0,D.createJBrowseTheme)(c),B=(0,Tt.Z)(Z.features||[]),e.prev=22,B.s();case 24:if((E=B.n()).done){e.next=55;break}if(V=E.value,z=V.get("strand")||1,O=1===z?V.get("start"):V.get("end"),W=1===z?V.get("end"):V.get("start"),H=V.get("refName"),G=V.get("mate"),q=G.refName,_=void 0,"identity"!==m){e.next=45;break}U=V.get("identity"),J=0;case 36:if(!(J<b.length)){e.next=43;break}if(!(U>+b[J])){e.next=40;break}return _=w[J],e.abrupt("break",43);case 40:J++,e.next=36;break;case 43:e.next=46;break;case 45:"meanQueryIdentity"===m?_="hsl(".concat(200*V.get("meanScore"),",100%,40%)"):"mappingQuality"===m?_="hsl(".concat(V.get("mappingQual"),",100%,40%)"):"strand"===m?_=-1===z?g:f:"default"===m&&(_=x?(0,l.readConfObject)(i,"color",{feature:V}):"#f0f"===d?j.palette.text.primary:d);case 46:if(t.fillStyle=_,t.strokeStyle=_,X=(0,Pt.R)({self:N,refName:H,coord:O}),Y=(0,Pt.R)({self:N,refName:H,coord:W}),Q=(0,Pt.R)({self:F,refName:q,coord:G.start}),K=(0,Pt.R)({self:F,refName:q,coord:G.end}),void 0!==X&&void 0!==Y&&void 0!==Q&&void 0!==K)if($=X.offsetPx-S,ee=Y.offsetPx-S,te=Q.offsetPx-T,ne=K.offsetPx-T,Math.abs($-ee)<=4&&Math.abs(te-ne)<=4)Nt(t,$,s-te,y);else if(re=$,ae=te,ie=V.get("CIGAR"),u&&ie){for(oe=Rt(ie),t.beginPath(),t.moveTo(re,s-ae),se=re,ue=re,ce=0;ce<oe.length;ce+=2)le=+oe[ce],"M"===(de=oe[ce+1])||"="===de||"X"===de?(re+=le/M*z,ae+=le/R):"D"===de||"N"===de?re+=le/M*z:"I"===de&&(ae+=le/R),re=I(re,$,ee,V),ae=L(ae,te,ne,V),(Math.abs(re-se)>.5||Math.abs(ae-ue)>.5)&&(t.lineTo(re,s-ae),se=re,ue=ae);t.stroke()}else t.beginPath(),t.moveTo($,s-te),t.lineTo(ee,s-ne),t.stroke();else P.length<=5&&(void 0===X||void 0===Y?P.push({message:"feature at (X ".concat(H,":").concat(O,"-").concat(W,") not plotted, fell outside of range"),effect:"feature not rendered"}):P.push({message:"feature at (Y ".concat(q,":").concat(G.start,"-").concat(G.end,") not plotted, fell outside of range"),effect:"feature not rendered"}));case 53:e.next=24;break;case 55:e.next=60;break;case 57:e.prev=57,e.t0=e.catch(22),B.e(e.t0);case 60:return e.prev=60,B.f(),e.finish(60);case 63:return e.abrupt("return",{warnings:P});case 64:case"end":return e.stop()}}),e,null,[[22,57,60,63]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t){var r,a,i,o,s,u,c,l,d,f,g,v,y,b=this;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.width,o=t.height,s=t.view,u=s.hview,c=s.vview,l=[i,o],d=[u,c].map((function(e,t){var n=Ye.create(e);return n.setVolatileWidth(l[t]),n})),f=d[0],e.next=6,this.getFeatures((0,h.Z)((0,h.Z)({},t),{},{regions:f.dynamicBlocks.contentBlocks}));case 6:return g=e.sent,f.setFeatures(g),e.next=10,(0,m.renderToAbstractCanvas)(i,o,t,(function(e){return b.drawDotplot(e,(0,h.Z)((0,h.Z)({},t),{},{views:d}))}));case 10:return v=e.sent,e.next=13,(0,$.Z)((0,ee.Z)(n.prototype),"render",this).call(this,(0,h.Z)((0,h.Z)((0,h.Z)({},t),v),{},{height:o,width:i}));case 13:return y=e.sent,e.abrupt("return",(0,h.Z)((0,h.Z)((0,h.Z)({},y),v),{},{height:o,width:i,offsetX:(null===(r=d[0].dynamicBlocks.blocks[0])||void 0===r?void 0:r.offsetPx)||0,offsetY:(null===(a=d[1].dynamicBlocks.blocks[0])||void 0===a?void 0:a.offsetPx)||0,bpPerPxX:d[0].bpPerPx,bpPerPxY:d[1].bpPerPx}));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Mt.Z);var jt=(0,l.ConfigurationSchema)("DotplotRenderer",{color:{type:"color",description:"the color of each feature in a synteny, used with colorBy:default",defaultValue:"#f0f",contextVariable:["feature"]},posColor:{type:"color",description:"the color for forward alignments, used with colorBy:strand",defaultValue:"blue"},negColor:{type:"color",description:"the color for reverse alignments, used with colorBy:strand",defaultValue:"red"},lineWidth:{type:"number",description:"width of the lines to be drawn",defaultValue:2.5},colorBy:{type:"stringEnum",model:v.types.enumeration("colorBy",["identity","meanQueryIdentity","mappingQuality","strand","default"]),description:'Color by options:<br/>\n<ul>\n  <li>"identity" - the identity of the particular hit, similar to D-GENIES, use the other config slots \'thresholds\' and \'thresholdsPalette\' to define colors for this setting</li>\n  <li>"meanQueryIdentity" - calculates the weighted mean identity (weighted by alignment length) of all the hits that the query maps to (e.g. if the query is split aligned to many target, uses their weighted mean. can help show patterns of more related and distant synteny after WGD)</li>\n  <li>"mappingQuality" - uses mapping quality from PAF, some adapters don\'t have this setting</li>\n  <li>"strand" - colors negative alignments with negColor and positive alignments with posColor</li>\n  <li>"default" - uses the \'color\' config slot</li>\n</ul>',defaultValue:"default"},thresholdsPalette:{type:"stringArray",defaultValue:["#094b09","#2ebd40","#d5670b","#ffd84b"],description:"threshold colors, used with colorBy:identity"},thresholds:{type:"stringArray",defaultValue:["0.75","0.5","0.25","0"],description:"threshold breakpoints, used with colorBy:identity"}},{explicitlyTyped:!0});function Dt(e,t,n){try{e.showTrack(t)}catch(r){if(!"".concat(r).match("Could not resolve identifier"))throw r;n.push(t)}}var Bt=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="ComparativeRender",e}return(0,i.Z)(n,[{key:"renameRegionsIfNeeded",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t,n){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.renameRegionsIfNeeded(t));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getRenderer",value:function(e){return this.pluginManager.getRendererType(e)}},{key:"serializeArguments",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t,r){var a,i,o,s;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.rendererType,i=this.getRenderer(a),e.next=4,(0,$.Z)((0,ee.Z)(n.prototype),"serializeArguments",this).call(this,t,r);case 4:return o=e.sent,e.next=7,this.renameRegionsIfNeeded(o,i);case 7:return s=e.sent,e.abrupt("return","MainThreadRpcDriver"===r?s:i.serializeArgsInClient(s));case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"execute",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t,n){var r,a,i,o,s,u;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t,"MainThreadRpcDriver"===n){e.next=5;break}return e.next=4,this.deserializeArguments(t,n);case 4:r=e.sent;case 5:if(i=(a=r).sessionId,o=a.rendererType,s=a.signal,i){e.next=8;break}throw new Error("must pass a unique session id");case 8:return(0,m.checkAbortSignal)(s),u=this.getRenderer(o),e.abrupt("return","MainThreadRpcDriver"===n?u.render(r):u.renderInWorker(r));case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deserializeReturn",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t,r,a){var i,o;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,$.Z)((0,ee.Z)(n.prototype),"deserializeReturn",this).call(this,t,r,a);case 2:if(i=e.sent,"MainThreadRpcDriver"!==a){e.next=5;break}return e.abrupt("return",i);case 5:return o=this.getRenderer(r.rendererType),e.abrupt("return",o.deserializeResultsInClient(i,r));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(n(85550).Z),Et=n(3715),Vt=r.tr.featurizeSA,zt=r.tr.getClip,Ot=r.tr.getTag,Wt=r.tr.getLength,Ht=r.tr.getLengthSansClipping;function Gt(e){e.addToExtensionPoint("Core-extendPluggableElement",(function(e){if("LinearPileupDisplay"===e.name){var t=e.stateModel.extend((function(e){var t=e.contextMenuItems;return{views:{contextMenuItems:function(){var n=e.contextMenuFeature;return[].concat((0,xe.Z)(t()),(0,xe.Z)(n?[{label:"Dotplot of read vs ref",icon:Et.Z,onClick:function(){return function(e,t){var n=(0,m.getSession)(t);try{var r=e.get("CIGAR"),a=zt(r,1),i=e.get("flags"),o=e.get("strand"),s=e.get("name"),u="".concat(s,"_assembly_").concat(Date.now()),c=t.parentTrack,d=(0,l.getConf)(c,"assemblyNames"),f=(0,A.Z)(d,1)[0],p=[f,u],h="track-".concat(Date.now()),g="".concat(s,"_vs_").concat(f),v=Ot(e,"SA")||"",y=Vt(v,e.id(),o,s,!0),b=e.toJSON();b.strand=1,b.mate={refName:s,start:a,end:a+Ht(r)};var w=Wt(2048&i?y[0].CIGAR:r),x=[b].concat((0,xe.Z)(y));x.sort((function(e,t){return e.clipPos-t.clipPos}));var k=x.reduce((function(e,t){return e+t.end-t.start}),0);n.addView("DotplotView",{type:"DotplotView",hview:{offsetPx:0,bpPerPx:k/800,displayedRegions:(0,m.gatherOverlaps)(x.map((function(e,t){return{start:e.start,end:e.end,refName:e.refName,index:t,assemblyName:f}})))},vview:{offsetPx:0,bpPerPx:w/400,minimumBlockWidth:0,interRegionPaddingWidth:0,displayedRegions:[{assemblyName:u,start:0,end:w,refName:s}]},viewTrackConfigs:[{type:"SyntenyTrack",assemblyNames:p,adapter:{type:"FromConfigAdapter",features:x},trackId:h,name:g}],assemblyNames:p,tracks:[{configuration:h,type:"SyntenyTrack",displays:[{type:"DotplotDisplay",configuration:"".concat(h,"-DotplotDisplay")}]}],displayName:"".concat(s," vs ").concat(f)})}catch(Z){console.error(Z),n.notify("".concat(Z),"error")}}(n,e)}}]:[]))}}}}));e.stateModel=t}return e}))}var qt=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="DotplotPlugin",e}return(0,i.Z)(r,[{key:"install",value:function(e){!function(e){e.addViewType((function(){return new ye.Z({name:"DotplotView",displayName:"Dotplot view",stateModel:(t=e,v.types.compose(qe.Z,v.types.model("DotplotView",{id:he.ElementId,type:v.types.literal("DotplotView"),height:600,borderSize:20,tickSize:5,vtextRotation:0,htextRotation:-90,fontSize:15,trackSelectorType:"hierarchical",assemblyNames:v.types.array(v.types.string),drawCigar:!0,hview:v.types.optional(Qe,{}),vview:v.types.optional(Ke,{}),tracks:v.types.array(t.pluggableMstType("track","stateModel")),viewTrackConfigs:v.types.array(t.pluggableConfigSchemaType("track"))})).volatile((function(){return{volatileWidth:void 0,volatileError:void 0,cursorMode:(0,m.localStorageGetItem)("dotplot-cursorMode")||"crosshair",showPanButtons:Boolean(JSON.parse((0,m.localStorageGetItem)("dotplot-showPanbuttons")||"true")),wheelMode:(0,m.localStorageGetItem)("dotplot-wheelMode")||"zoom",borderX:100,borderY:100}})).views((function(e){return{get width(){if(!e.volatileWidth)throw new Error("width not initialized");return e.volatileWidth}}})).views((function(e){return{get assemblyErrors(){var t=(0,m.getSession)(e).assemblyManager;return e.assemblyNames.map((function(e){var n;return null===(n=t.get(e))||void 0===n?void 0:n.error})).filter((function(e){return!!e})).join(", ")},get assembliesInitialized(){var t=(0,m.getSession)(e).assemblyManager;return e.assemblyNames.every((function(e){var n,r;return null===(n=null===(r=t.get(e))||void 0===r?void 0:r.initialized)||void 0===n||n}))}}})).views((function(e){return{get initialized(){return void 0!==e.volatileWidth&&e.hview.displayedRegions.length>0&&e.vview.displayedRegions.length>0&&e.assembliesInitialized},get hticks(){var t=e.hview,n=t.dynamicBlocks,r=t.staticBlocks,a=t.bpPerPx;return n.contentBlocks.length>5?[]:(0,$e.Cz)(r.contentBlocks,a)},get vticks(){var t=e.vview,n=t.dynamicBlocks,r=t.staticBlocks,a=t.bpPerPx;return n.contentBlocks.length>5?[]:(0,$e.Cz)(r.contentBlocks,a)},get loading(){return e.assemblyNames.length>0&&!this.initialized},get viewWidth(){return e.width-e.borderX},get viewHeight(){return e.height-e.borderY},get views(){return[e.hview,e.vview]},renderProps:function(){var t=(0,m.getSession)(e);return(0,h.Z)((0,h.Z)({},(0,fe.getParentRenderProps)(e)),{},{drawCigar:e.drawCigar,highResolutionScaling:(0,l.getConf)(t,"highResolutionScaling")})}}})).actions((function(e){return{setShowPanButtons:function(t){e.showPanButtons=t},setWheelMode:function(t){e.wheelMode=t},setCursorMode:function(t){e.cursorMode=t},setDrawCigar:function(t){e.drawCigar=t},clearView:function(){e.hview.setDisplayedRegions([]),e.vview.setDisplayedRegions([]),e.assemblyNames=(0,v.cast)([]),e.tracks.clear()},setBorderX:function(t){e.borderX=t},setBorderY:function(t){e.borderY=t},setWidth:function(t){return e.volatileWidth=t,e.volatileWidth},setHeight:function(t){return e.height=t,e.height},setError:function(t){e.volatileError=t},closeView:function(){(0,v.getParent)(e,2).removeView(e)},zoomOutButton:function(){e.hview.zoomOut(),e.vview.zoomOut()},zoomInButton:function(){e.hview.zoomIn(),e.vview.zoomIn()},activateTrackSelector:function(){if("hierarchical"===e.trackSelectorType){var t=(0,m.getSession)(e);if((0,m.isSessionModelWithWidgets)(t)){var n=t.addWidget("HierarchicalTrackSelectorWidget","hierarchicalTrackSelector",{view:e});return t.showWidget(n),n}}throw new Error("invalid track selector type ".concat(e.trackSelectorType))},showTrack:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.pluggableConfigSchemaType("track"),i=(0,v.resolveIdentifier)(a,(0,v.getRoot)(e),n),o=t.getTrackType(i.type);if(!o)throw new Error("unknown track type ".concat(i.type));var s=t.getViewType(e.type),u=i.displays.find((function(e){return s.displayTypes.find((function(t){return t.name===e.type}))}));if(!u)throw new Error("could not find a compatible display for view type ".concat(e.type));var c=o.stateModel.create((0,h.Z)((0,h.Z)({},r),{},{type:i.type,configuration:i,displays:[{type:u.type,configuration:u}]}));e.tracks.push(c)},hideTrack:function(n){var r=t.pluggableConfigSchemaType("track"),a=(0,v.resolveIdentifier)(r,(0,v.getRoot)(e),n),i=e.tracks.filter((function(e){return e.configuration===a}));return(0,ke.transaction)((function(){return i.forEach((function(t){return e.tracks.remove(t)}))})),i.length},toggleTrack:function(e){this.hideTrack(e)||this.showTrack(e)},setAssemblyNames:function(t,n){e.assemblyNames=(0,v.cast)([t,n])},setViews:function(t){e.hview=(0,v.cast)(t[0]),e.vview=(0,v.cast)(t[1])},getCoords:function(t,n){var r=(0,m.minmax)(n[0],t[0]),a=(0,A.Z)(r,2),i=a[0],o=a[1],s=(0,m.minmax)(n[1],t[1]),u=(0,A.Z)(s,2),c=u[0],l=u[1];return Math.abs(o-i)>3&&Math.abs(l-c)>3?[e.hview.pxToBp(i),e.hview.pxToBp(o),e.vview.pxToBp(e.viewHeight-c),e.vview.pxToBp(e.viewHeight-l)]:void 0},zoomIn:function(t,n){var r=this.getCoords(t,n);if(r){var a=(0,A.Z)(r,4),i=a[0],o=a[1],s=a[2],u=a[3];e.hview.moveTo(i,o),e.vview.moveTo(u,s)}},showAllRegions:function(){e.hview.zoomTo(e.hview.maxBpPerPx),e.vview.zoomTo(e.vview.maxBpPerPx),e.vview.center(),e.hview.center()},onDotplotView:function(t,n){var r=this.getCoords(t,n);if(r){var a=(0,A.Z)(r,4),i=a[0],o=a[1],s=a[2],u=a[3],c=(0,m.getSession)(e),l=Ye.create((0,h.Z)((0,h.Z)({},(0,v.getSnapshot)(e.hview)),{},{minimumBlockWidth:0,interRegionPaddingWidth:0})),d=Ye.create((0,h.Z)((0,h.Z)({},(0,v.getSnapshot)(e.vview)),{},{minimumBlockWidth:0,interRegionPaddingWidth:0}));l.setVolatileWidth(e.hview.width),d.setVolatileWidth(e.vview.width),l.moveTo(i,o),d.moveTo(u,s),l.zoomTo(l.bpPerPx/(e.width/e.hview.width),0),d.zoomTo(d.bpPerPx/(e.width/e.vview.width),0);var f=e.tracks.map((function(e){return e.configuration.displays.find((function(e){return"LinearSyntenyDisplay"===e.type}))})).filter((function(e){return!!e})).map((function(e){var t=(0,v.getParent)(e,2);return{type:t.type,configuration:t,displays:[{type:e.type,configuration:e}]}})),p=(0,v.getSnapshot)(l),g=(p.id,(0,Ge.Z)(p,et)),y=(0,v.getSnapshot)(d),b=(y.id,(0,Ge.Z)(y,tt)),w={type:"LinearSyntenyView",views:[(0,h.Z)({type:"LinearGenomeView",tracks:[],hideHeader:!0},g),(0,h.Z)({type:"LinearGenomeView",tracks:[],hideHeader:!0},b)],tracks:f};c.addView("LinearSyntenyView",w)}}}})).actions((function(e){return{exportSvg:function(){var t=arguments;return(0,g.Z)((0,p.Z)().mark((function r(){var a,i,o,s,u;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=t.length>0&&void 0!==t[0]?t[0]:{},r.next=3,n.e(1698).then(n.bind(n,81698));case 3:return i=r.sent,o=i.renderToSvg,r.next=7,o(e,a);case 7:s=r.sent,u=new Blob([s],{type:"image/svg+xml"}),(0,Ze.saveAs)(u,a.filename||"image.svg");case 10:case"end":return r.stop()}}),r)})))()},beforeDestroy:function(){var t=(0,m.getSession)(e);for(var n in e.assemblyNames){var r;null===(r=t.removeTemporaryAssembly)||void 0===r||r.call(t,n)}},afterAttach:function(){(0,v.addDisposer)(e,(0,ke.autorun)((function(){var t,n=e.showPanButtons,r=e.wheelMode,a=e.cursorMode;"undefined"!==typeof localStorage&&(localStorage.setItem("dotplot-showPanbuttons",(t=n,JSON.stringify(t))),localStorage.setItem("dotplot-cursorMode",a),localStorage.setItem("dotplot-wheelMode",r))}))),(0,v.addDisposer)(e,(0,ke.autorun)((function(){var t=(0,m.getSession)(e);if(void 0!==e.volatileWidth&&e.assembliesInitialized&&!(e.hview.displayedRegions.length>0&&e.vview.displayedRegions.length>0)){var n=[e.hview,e.vview];(0,ke.transaction)((function(){e.assemblyNames.forEach((function(e,r){var a=t.assemblyManager.get(e);n[r].setDisplayedRegions((null===a||void 0===a?void 0:a.regions)||[])})),e.showAllRegions()}))}}),{delay:1e3})),(0,v.addDisposer)(e,(0,ke.autorun)((function(){if(void 0!==e.volatileWidth){var t=e.vview,n=e.hview,r=e.viewHeight,a=e.viewWidth,i=t.dynamicBlocks.contentBlocks,o=n.dynamicBlocks.contentBlocks,s=n.offsetPx,u=t.offsetPx,c=(0,$e.F$)(i,r,u),l=(0,$e.F$)(o,a,s),d=it(o,l),f=it(i,c);e.setBorderY(Math.max(d+40,50)),e.setBorderX(Math.max(f+40,50))}})))},squareView:function(){var t=e.hview,n=e.vview,r=(t.bpPerPx+n.bpPerPx)/2,a=t.pxToBp(t.width/2),i=n.pxToBp(n.width/2);t.setBpPerPx(r),t.centerAt(a.coord,a.refName,a.index),n.setBpPerPx(r),n.centerAt(i.coord,i.refName,i.index)},squareViewProportional:function(){var t=e.hview,n=e.vview,r=t.width/n.width,a=(t.bpPerPx+n.bpPerPx)/2,i=t.pxToBp(t.width/2),o=n.pxToBp(n.width/2);t.setBpPerPx(a/r),t.centerAt(i.coord,i.refName,i.index),n.setBpPerPx(a),n.centerAt(o.coord,o.refName,o.index)}}})).views((function(e){return{menuItems:function(){var t=(0,m.getSession)(e);return[{label:"Return to import form",onClick:function(){(0,m.getSession)(e).queueDialog((function(t){return[rt,{model:e,handleClose:t}]}))},icon:Ue.Z},{label:"Square view - same bp per pixel",onClick:function(){return e.squareView()}},{label:"Rectangular view - same total bp",onClick:function(){return e.squareView()}},{label:"Show all regions",onClick:function(){return e.showAllRegions()}},{label:"Export SVG",icon:Ce.Z,onClick:function(){(0,m.getSession)(e).queueDialog((function(t){return[nt,{model:e,handleClose:t}]}))}}].concat((0,xe.Z)((0,m.isSessionModelWithWidgets)(t)?[{label:"Open track selector",onClick:e.activateTrackSelector,icon:_e.GD}]:[]))},get error(){return e.volatileError||e.assemblyErrors}}}))),ReactComponent:(0,I.lazy)((function(){return Promise.all([n.e(5981),n.e(9136)]).then(n.bind(n,99136))}))});var t}))}(e),Ct(e),function(e){e.addRendererType((function(){return new Ft({name:"DotplotRenderer",configSchema:jt,ReactComponent:St,pluginManager:e})}))}(e),function(e){e.addToExtensionPoint("LaunchView-DotplotView",function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t){var n,r,a,i,o,s,u;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.session,r=t.views,a=t.tracks,i=void 0===a?[]:a,e.prev=1,o=n.addView("DotplotView",{}),s=r.map((function(e){return e.assembly})),(0,ke.transaction)((function(){o.setViews([{bpPerPx:.1,offsetPx:0},{bpPerPx:.1,offsetPx:0}]),o.setAssemblyNames(s[0],s[1])})),u=[],i.forEach((function(e){return Dt(o,e,u)})),!u.length){e.next=9;break}throw new Error("Could not resolve identifiers: ".concat(u.join(",")));case 9:e.next=15;break;case 11:throw e.prev=11,e.t0=e.catch(1),n.notify("".concat(e.t0),"error"),e.t0;case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}())}(e),Gt(e),e.addRpcMethod((function(){return new Bt(e)}))}},{key:"configure",value:function(e){(0,m.isAbstractMenuManager)(e.rootModel)&&e.rootModel.appendToSubMenu(["Add"],{label:"Dotplot view",icon:He.Z,onClick:function(e){e.addView("DotplotView",{})}})}}]),r}(u.Z);var _t=(0,l.ConfigurationSchema)("GtfAdapter",{gtfLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.gtf",locationType:"UriLocation"}}},{explicitlyTyped:!0}),Ut=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="GTFPlugin",e}return(0,i.Z)(r,[{key:"install",value:function(e){e.addAdapterType((function(){return new se.Z({name:"GtfAdapter",displayName:"GTF adapter",configSchema:_t,getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(6362),n.e(1032),n.e(860)]).then(n.bind(n,24981)).then((function(e){return e.default}))}})})),e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="GtfAdapter",i=(0,fe.getFileName)(t),o={type:a,gtfLocation:t};return/\.gtf(\.gz)?$/i.test(i)&&!r||r===a?o:e(t,n,r)}}))}}]),r}(u.Z);var Jt=(0,l.ConfigurationSchema)("Gff3TabixAdapter",{gffGzLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.gff.gz",locationType:"UriLocation"}},index:(0,l.ConfigurationSchema)("Gff3TabixIndex",{indexType:{model:v.types.enumeration("IndexType",["TBI","CSI"]),type:"stringEnum",defaultValue:"TBI"},location:{type:"fileLocation",defaultValue:{uri:"/path/to/my.gff.gz.tbi",locationType:"UriLocation"}}}),dontRedispatch:{type:"stringArray",defaultValue:["chromosome","region"]}},{explicitlyTyped:!0});var Xt=(0,l.ConfigurationSchema)("Gff3Adapter",{gffLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.gff",locationType:"UriLocation"}}},{explicitlyTyped:!0}),Yt=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="GFF3Plugin",e}return(0,i.Z)(r,[{key:"install",value:function(e){!function(e){e.addAdapterType((function(){return new ge.AdapterType({name:"Gff3TabixAdapter",displayName:"GFF3 tabix adapter",configSchema:Jt,getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(2821),n.e(1032),n.e(8022),n.e(4526),n.e(3711)]).then(n.bind(n,58268)).then((function(e){return e.default}))}})}))}(e),function(e){e.addAdapterType((function(){return new ge.AdapterType({name:"Gff3Adapter",displayName:"GFF3 adapter",configSchema:Xt,getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(6362),n.e(1032),n.e(4526),n.e(34)]).then(n.bind(n,59894)).then((function(e){return e.default}))}})}))}(e),function(e){e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="Gff3TabixAdapter",i=(0,fe.getFileName)(t),o=n&&(0,fe.getFileName)(n);return/\.gff3?\.b?gz$/i.test(i)||r===a?{type:a,bamLocation:t,gffGzLocation:t,index:{location:n||(0,fe.makeIndex)(t,".tbi"),indexType:(0,fe.makeIndexType)(o,"CSI","TBI")}}:e(t,n,r)}})),e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="Gff3Adapter",i=(0,fe.getFileName)(t),o={type:a,gffLocation:t};return/\.gff3?$/i.test(i)&&!r||r===a?o:e(t,n,r)}}))}(e)}}]),r}(u.Z),Qt=n(66737),Kt=(n(81872),v.types.model("Job",{name:v.types.string,statusMessage:v.types.maybe(v.types.string),progressPct:v.types.number}).volatile((function(){return{cancelCallback:function(){}}})).actions((function(e){return{setCancelCallback:function(t){e.cancelCallback=t},setStatusMessage:function(t){e.statusMessage=t},setProgressPct:function(t){e.progressPct=t}}})));var $t=(0,l.ConfigurationSchema)("JobsListWidget",{}),en=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="JobsManagementPlugin",e}return(0,i.Z)(r,[{key:"install",value:function(e){e.addWidgetType((function(){return new Qt.Z({name:"JobsListWidget",heading:"Jobs list",configSchema:$t,stateModel:v.types.model("JobsListModel",{id:he.ElementId,type:v.types.literal("JobsListWidget"),jobs:v.types.array(Kt),finished:v.types.array(Kt),queued:v.types.array(Kt),aborted:v.types.array(Kt)}).actions((function(e){return{addJob:function(t){var n=t.cancelCallback,r=e.jobs.push(t),a=e.jobs[r-1];return a.setCancelCallback(n),a},removeJob:function(t){var n=e.jobs.findIndex((function(e){return e.name===t})),r=e.jobs[n];return e.jobs.splice(n,1),r},addFinishedJob:function(t){return e.finished.push(t),e.finished},addQueuedJob:function(t){return e.queued.push(t),e.finished},addAbortedJob:function(t){return e.aborted.push(t),e.aborted},removeQueuedJob:function(t){var n=e.queued.findIndex((function(e){return e.name===t})),r=e.queued[n];return e.queued.splice(n,1),r},updateJobStatusMessage:function(t,n){var r=e.jobs.find((function(e){return e.name===t}));if(!r)throw new Error("No job found with name ".concat(t));r.setStatusMessage(n)},updateJobProgressPct:function(t,n){var r=e.jobs.find((function(e){return e.name===t}));if(!r)throw new Error("No job found with name ".concat(t));r.setProgressPct(n)}}})),ReactComponent:(0,I.lazy)((function(){return Promise.resolve().then(n.bind(n,81872))}))})}))}},{key:"configure",value:function(e){(0,m.isAbstractMenuManager)(e.rootModel)&&e.rootModel.appendToMenu("Tools",{label:"Jobs list",icon:_e.ks,onClick:function(e){if((0,m.isSessionModelWithWidgets)(e)){var t=e.widgets.get("JobsList");t||(t=e.addWidget("JobsListWidget","JobsList")),e.showWidget(t)}}})}}]),r}(u.Z);var tn=(0,l.ConfigurationSchema)("NCListAdapter",{rootUrlTemplate:{type:"fileLocation",defaultValue:{uri:"/path/to/my/{refseq}/trackData.json",locationType:"UriLocation"}},refNames:{type:"stringArray",defaultValue:[],description:"List of refNames used by the NCList used for aliasing"}},{explicitlyTyped:!0}),nn=n(31145),rn=n(20783),an=n(52185),on=n(10326),sn=n.n(on),un=n(49882).lW,cn=function(){function e(t){(0,a.Z)(this,e),this.url=void 0,this.url=t.url.endsWith("/")?t.url:"".concat(t.url,"/")}return(0,i.Z)(e,[{key:"readMeta",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(){var t,n,r,a;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadFile("meta.json");case 2:return t=e.sent,n=t.compress,r=t.track_names,a=Math.ceil(t.hash_bits/4),e.abrupt("return",{hashHexCharacters:a,compress:n,tracks:r});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHashHexCharacters",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(){var t;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.readMeta();case 2:return t=e.sent,e.abrupt("return",t.hashHexCharacters);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCompress",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(){var t;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.readMeta();case 2:return t=e.sent,e.abrupt("return",t.compress);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getTrackNames",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(){var t;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.readMeta();case 2:return t=e.sent,e.abrupt("return",t.tracks);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t){var n;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getBucket(t);case 2:return n=e.sent,e.abrupt("return",n[t]);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getBucket",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t){var n,r;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.hash(t),e.next=3,this.hexToDirPath(n);case 3:return r=e.sent,e.abrupt("return",this.loadFile(r));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadFile",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t){var n;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this.url).concat(t));case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("HTTP ".concat(n.status," ").concat(n.statusText));case 5:return e.abrupt("return",n.json());case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"hexToDirPath",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t){var n,r,a,i;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHashHexCharacters();case 2:if(!(n=e.sent)){e.next=12;break}return e.next=6,this.getCompress();case 6:for(r=e.sent;t.length<8;)t="0".concat(t);for(t=t.slice(8-n),a=[],i=0;i<t.length;i+=3)a.push(t.slice(i,i+3));return e.abrupt("return","".concat(a.join("/"),".json").concat(r?"z":""));case 12:return e.abrupt("return","");case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"hash",value:function(e){return sn()(un.from(e)).toString("hex").toLowerCase().replace("-","n")}}]),e}(),ln=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e,r,i){var o;(0,a.Z)(this,n),(o=t.call(this,e,r,i)).httpMap=void 0,o.tracksNames=void 0;var s=(0,l.readConfObject)(e,"namesIndexLocation"),u=s.baseUri,c=s.uri;return o.httpMap=new cn({url:u?new URL(c,u).href:c}),o}return(0,i.Z)(n,[{key:"loadIndexFile",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.httpMap.getBucket(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"searchIndex",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t){var n,r,a,i,o;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.searchType,r=t.queryString,e.t0=this.tracksNames,e.t0){e.next=6;break}return e.next=5,this.httpMap.getTrackNames();case 5:e.t0=e.sent;case 6:return a=e.t0,i=r.toLowerCase(),e.next=10,this.loadIndexFile(i);case 10:return o=e.sent,e.abrupt("return",o[i]?this.formatResults(o[i],a,n):[]);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"formatResults",value:function(e,t,n){return[].concat((0,xe.Z)("exact"===n?[]:e.prefix.map((function(e){return new an.Z({label:"object"===typeof e?e.name:e,matchedAttribute:"name",matchedObject:{result:e}})}))),(0,xe.Z)(e.exact.map((function(e){var n=e[0],r=e[1],a=e[3],i=e[4],o=e[5],s="".concat(a||n,":").concat(i,"-").concat(o);return new an.Z({locString:s,label:n,matchedAttribute:"name",matchedObject:e,trackId:t[r]})})))).filter((function(e){return"too many matches"!==e.getLabel()}))}},{key:"freeResources",value:function(){}}]),n}(rn.BaseAdapter);var dn=(0,l.ConfigurationSchema)("JBrowse1TextSearchAdapter",{namesIndexLocation:{type:"fileLocation",defaultValue:{uri:"/volvox/names",locationType:"UriLocation"},description:"the location of the JBrowse1 names index data directory"},tracks:{type:"stringArray",defaultValue:[],description:"List of tracks covered by text search adapter"},assemblyNames:{type:"stringArray",defaultValue:[],description:"List of assemblies covered by text search adapter"}},{explicitlyTyped:!0,explicitIdentifier:"textSearchAdapterId"}),fn=n(58096);var pn=(0,l.ConfigurationSchema)("JBrowse1Connection",{dataDirLocation:{type:"fileLocation",defaultValue:{uri:"http://mysite.com/jbrowse/data/",locationType:"UriLocation"},description:"the location of the JBrowse 1 data directory, often something like http://mysite.com/jbrowse/data/"},assemblyNames:{description:"name of the assembly the connection belongs to, should be a single entry",type:"stringArray",defaultValue:[]}},{baseConfiguration:d.baseConnectionConfig});function hn(e){return v.types.compose("JBrowse1Connection",(0,d.BaseConnectionModelFactory)(e),v.types.model({configuration:(0,l.ConfigurationReference)(pn),type:v.types.literal("JBrowse1Connection")})).actions((function(e){return{connect:function(){return(0,g.Z)((0,p.Z)().mark((function t(){var r,a,i,o,s,u,c,d,f,g,v,y,b;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=(0,m.getSession)(e),t.prev=1,i=(0,l.getConf)(e,"dataDirLocation"),t.next=5,n.e(4926).then(n.bind(n,34926));case 5:return o=t.sent,s=o.fetchJb1,t.next=9,n.e(5720).then(n.bind(n,5720));case 9:return u=t.sent,c=u.convertTrackConfig,t.next=13,s(i);case 13:if(d=t.sent,f=(0,l.getConf)(e,"assemblyNames")[0]){t.next=17;break}throw new Error("assembly name required for JBrowse 1 connection");case 17:if(g=r.assemblies.find((function(e){return(0,l.readConfObject)(e,"name")===f}))){t.next=20;break}throw new Error('Assembly "'.concat(f,'" not found'));case 20:v=(0,l.readConfObject)(g,["sequence","adapter"]),y=null===(a=d.tracks)||void 0===a?void 0:a.map((function(e){return(0,h.Z)((0,h.Z)({},c(e,d.dataRoot||"",v)),{},{assemblyNames:[f]})})),e.setTrackConfs(y),t.next=30;break;case 25:t.prev=25,t.t0=t.catch(1),console.error(t.t0),r.notify('There was a problem connecting to the JBrowse 1 data directory "'.concat(e.name,'". Please make sure you have entered a valid location. The error that was thrown is: "').concat(t.t0,'"'),"error"),null===(b=r.breakConnection)||void 0===b||b.call(r,e.configuration);case 30:case"end":return t.stop()}}),t,null,[[1,25]])})))()}}}))}var gn=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="LegacyJBrowsePlugin",e}return(0,i.Z)(r,[{key:"install",value:function(e){!function(e){e.addAdapterType((function(){return new ge.AdapterType({name:"NCListAdapter",displayName:"NCList adapter",configSchema:tn,getAdapterClass:function(){return Promise.all([n.e(5097),n.e(933),n.e(1622)]).then(n.bind(n,45046)).then((function(e){return e.default}))}})}))}(e),function(e){e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="NCListAdapter",i=(0,fe.getFileName)(t);return/trackData.jsonz?$/i.test(i)||r===a?{type:a,rootUrlTemplate:t}:e(t,n,r)}}))}(e),function(e){e.addTextSearchAdapterType((function(){return new nn.Z({name:"JBrowse1TextSearchAdapter",configSchema:dn,AdapterClass:ln,description:"A JBrowse 1 text search adapter"})}))}(e),function(e){e.addConnectionType((function(){return new fn.Z({name:"JBrowse1Connection",configSchema:pn,stateModel:hn(e),displayName:"JBrowse 1 Data",description:"A JBrowse 1 data directory",url:"//jbrowse.org/"})}))}(e)}}]),r}(u.Z),mn=n(57211),vn=n(48430);var yn=function(e){return(0,l.ConfigurationSchema)("LinearComparativeDisplay",{},{explicitlyTyped:!0,explicitIdentifier:"displayId"})};function bn(e){var t=(0,m.getSession)(e).rpcManager,n=e;(0,l.readConfObject)(e.configuration);var r=e.adapterConfig,a=(0,m.getContainingView)(e),i=(0,fe.getRpcSessionId)(e);return(0,v.getSnapshot)(a),a.initialized?{rpcManager:t,renderProps:(0,h.Z)((0,h.Z)({},n.renderProps()),{},{view:a,adapterConfig:r,sessionId:i,timeout:1e6,self:e})}:void 0}function wn(e){return xn.apply(this,arguments)}function xn(){return xn=(0,g.Z)((0,p.Z)().mark((function e(t){var n,r,a,i,o;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n=t.rpcManager,r=t.renderProps,a=r.adapterConfig,i=r.view.views[0],e.next=7,n.call("getFeats","CoreGetFeatures",{regions:i.staticBlocks.contentBlocks,sessionId:"getFeats",adapterConfig:a});case 7:return o=e.sent,e.abrupt("return",{features:(0,m.dedupe)(o,(function(e){return e.id()}))});case 9:case"end":return e.stop()}}),e)}))),xn.apply(this,arguments)}var kn=function(e){return v.types.compose("LinearComparativeDisplay",d.BaseDisplay,v.types.model({type:v.types.literal("LinearComparativeDisplay"),configuration:(0,l.ConfigurationReference)(e),height:100})).volatile((function(){return{renderInProgress:void 0,features:void 0,message:void 0}})).views((function(e){return{renderProps:function(){return{rpcDriverName:e.rpcDriverName,displayModel:e,highResolutionScaling:2}}}})).actions((function(e){var t;return{setLoading:function(n){e.message=void 0,e.error=void 0,t=n},setMessage:function(n){t&&!t.signal.aborted&&t.abort(),e.message=n,e.error=void 0,t=void 0},setRendered:function(n){if(n){var r,a=n.features,i=e.features||[],o=new Set(i.map((function(e){return e.id()}))||[]),s=new Set((null===a||void 0===a?void 0:a.map((function(e){return e.id()})))||[]),u=!1,c=!1,l=(0,Tt.Z)(a);try{for(l.s();!(r=l.n()).done;){var d=r.value;if(!o.has(d.id())){u=!0;break}}}catch(g){l.e(g)}finally{l.f()}var f,p=(0,Tt.Z)(i);try{for(p.s();!(f=p.n()).done;){var h=f.value;if(!s.has(h.id())){c=!0;break}}}catch(g){p.e(g)}finally{p.f()}e.message=void 0,e.error=void 0,t=void 0,(u||c||!e.features)&&(e.features=a)}},setError:function(n){console.error(n),t&&!t.signal.aborted&&t.abort(),e.message=void 0,e.error=n,t=void 0}}})).actions((function(e){return{afterAttach:function(){(0,m.makeAbortableReaction)(e,bn,wn,{name:"".concat(e.type," ").concat(e.id," rendering"),delay:1e3,fireImmediately:!0},e.setLoading,e.setRendered,e.setError)}}}))},Zn=(0,I.lazy)((function(){return Promise.resolve().then(n.bind(n,91583))}));var Cn=function(e){return v.types.compose("LinearComparativeView",qe.Z,v.types.model({id:he.ElementId,type:v.types.literal("LinearComparativeView"),trackSelectorType:"hierarchical",showIntraviewLinks:!0,linkViews:!1,interactToggled:!1,middleComparativeHeight:100,tracks:v.types.array(e.pluggableMstType("track","stateModel")),views:v.types.array(e.getViewType("LinearGenomeView").stateModel),viewTrackConfigs:v.types.array(e.pluggableConfigSchemaType("track"))})).volatile((function(){return{width:void 0}})).views((function(e){return{get highResolutionScaling(){return 2},get initialized(){return void 0!==e.width&&e.views.length>0&&e.views.every((function(e){return e.initialized}))},get refNames(){return e.views.map((function(e){return(0,xe.Z)(new Set(e.staticBlocks.map((function(e){return e.refName}))))}))},get assemblyNames(){return(0,xe.Z)(new Set(e.views.flatMap((function(e){return e.assemblyNames}))))}}})).actions((function(t){return{afterAttach:function(){var e=this;(0,v.addDisposer)(t,(0,v.onAction)(t,(function(n){if(t.linkViews){var r=n.name,a=n.path,i=n.args;["horizontalScroll","zoomTo","setScaleFactor"].includes(r)&&a&&e.onSubviewAction(r,a,i)}})))},beforeDestroy:function(){var e,n=(0,m.getSession)(t),r=(0,Tt.Z)(t.assemblyNames);try{for(r.s();!(e=r.n()).done;){var a,i=e.value;null===(a=n.removeTemporaryAssembly)||void 0===a||a.call(n,i)}}catch(o){r.e(o)}finally{r.f()}},onSubviewAction:function(e,n,r){t.views.forEach((function(t){(0,v.getPath)(t).endsWith(n)||t[e](null===r||void 0===r?void 0:r[0])}))},setWidth:function(e){t.width=e},setViews:function(e){t.views=(0,v.cast)(e)},removeView:function(e){t.views.remove(e)},closeView:function(){(0,v.getParent)(t,2).removeView(t)},setMiddleComparativeHeight:function(e){return t.middleComparativeHeight=e,t.middleComparativeHeight},toggleLinkViews:function(){t.linkViews=!t.linkViews},activateTrackSelector:function(){if("hierarchical"!==t.trackSelectorType)throw new Error("invalid track selector type ".concat(t.trackSelectorType));var e=(0,m.getSession)(t);if((0,m.isSessionModelWithWidgets)(e)){var n=e.addWidget("HierarchicalTrackSelectorWidget","hierarchicalTrackSelector",{view:t});return e.showWidget(n),n}},toggleTrack:function(e){this.hideTrack(e)||this.showTrack(e)},showTrack:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.pluggableConfigSchemaType("track"),i=(0,v.resolveIdentifier)(a,(0,v.getRoot)(t),n);if(!i)throw new Error("track not found ".concat(n));var o=e.getTrackType(i.type);if(!o)throw new Error("unknown track type ".concat(i.type));var s=e.getViewType(t.type),u=new Set(s.displayTypes.map((function(e){return e.name}))),c=i.displays.find((function(e){return u.has(e.type)}));if(!c)throw new Error("could not find a compatible display for view type ".concat(t.type));t.tracks.push(o.stateModel.create((0,h.Z)((0,h.Z)({},r),{},{type:i.type,configuration:i,displays:[{type:c.type,configuration:c}]})))},hideTrack:function(n){var r=e.pluggableConfigSchemaType("track"),a=(0,v.resolveIdentifier)(r,(0,v.getRoot)(t),n),i=t.tracks.filter((function(e){return e.configuration===a}));return(0,ke.transaction)((function(){return i.forEach((function(e){return t.tracks.remove(e)}))})),i.length},squareView:function(){var e=(0,m.avg)(t.views.map((function(e){return e.bpPerPx})));t.views.forEach((function(t){var n=t.pxToBp(t.width/2);t.setNewView(e,t.offsetPx),n.refName&&t.centerAt(n.coord,n.refName,n.index)}))},clearView:function(){t.views=(0,v.cast)([]),t.tracks=(0,v.cast)([])}}})).views((function(){return{headerMenuItems:function(){return[]}}})).views((function(e){return{menuItems:function(){return[].concat((0,xe.Z)(e.views.map((function(e,t){var n;return[t,null===(n=e.menuItems)||void 0===n?void 0:n.call(e)]})).filter((function(e){return!!e[1]})).map((function(e){return{label:"View ".concat(e[0]+1," Menu"),subMenu:e[1]}}))),[{label:"Return to import form",onClick:function(){(0,m.getSession)(e).queueDialog((function(t){return[Zn,{model:e,handleClose:t}]}))},icon:Ue.Z},{label:"Open track selector",onClick:e.activateTrackSelector,icon:_e.GD}])},rubberBandMenuItems:function(){return[{label:"Zoom to region(s)",onClick:function(){e.views.forEach((function(e){var t=e.leftOffset,n=e.rightOffset;t&&n&&e.moveTo(t,n)}))}}]}}})).actions((function(e){return{afterAttach:function(){(0,v.addDisposer)(e,(0,ke.autorun)((function(){e.width&&e.views.forEach((function(t){return t.setWidth(e.width)}))})))}}}))};var Sn=function(e){return(0,l.ConfigurationSchema)("LinearSyntenyDisplay",{trackIds:{type:"stringArray",defaultValue:[]},middle:{type:"boolean",defaultValue:!0}},{baseConfiguration:yn(e),explicitlyTyped:!0})};var Tn=function(e){return v.types.compose("LinearSyntenyDisplay",kn(e),v.types.model({type:v.types.literal("LinearSyntenyDisplay"),configuration:(0,l.ConfigurationReference)(e)})).volatile((function(){return{mainCanvas:null,clickMapCanvas:null,cigarClickMapCanvas:null,mouseoverCanvas:null,featPositions:[],mouseoverId:void 0,clickId:void 0,cigarMouseoverId:-1}})).actions((function(e){return{setFeatPositions:function(t){e.featPositions=t},setMainCanvasRef:function(t){e.mainCanvas=t},setClickMapCanvasRef:function(t){e.clickMapCanvas=t},setCigarClickMapCanvasRef:function(t){e.cigarClickMapCanvas=t},setMouseoverCanvasRef:function(t){e.mouseoverCanvas=t},setMouseoverId:function(t){e.mouseoverId=t},setCigarMouseoverId:function(t){e.cigarMouseoverId=t},setClickId:function(t){e.clickId=t}}})).views((function(e){return{get adapterConfig(){return(0,h.Z)({name:e.parentTrack.configuration.adapter.type,assemblyNames:(0,l.getConf)(e,"assemblyNames")},(0,l.getConf)(e.parentTrack,"adapter"))},get trackIds(){return(0,l.getConf)(e,"trackIds")},get numFeats(){return e.featPositions.length},get ready(){return this.numFeats>0},get featMap(){return Object.fromEntries(e.featPositions.map((function(e){return[e.f.id(),e]})))}}})).actions((function(e){return{afterAttach:function(){(0,g.Z)((0,p.Z)().mark((function t(){var r;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.e(4122).then(n.bind(n,44122));case 3:r=t.sent,(0,r.doAfterAttach)(e),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0),e.setError(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))()}}}))};var Pn=function(e){return(0,l.ConfigurationSchema)("LGVSyntenyDisplay",{},{baseConfiguration:(0,r.Ct)(e),explicitlyTyped:!0})},Mn=r.tr.parseCigar;function Rn(e,t){for(var n=0,r=0,a=0;a<e.length;a++){var i=+e[a],o=e[a+1],s=Math.min(i,t-n);if(n>=t)break;"I"===o?r+=i:"D"===o?n+=s:"M"===o&&(r+=s,n+=s)}return[n,r]}function An(){return An=(0,g.Z)((0,p.Z)().mark((function e(t,n){var r,a,i,o,s,u,c,l,d,f,h,g,v,y,b,w,x,k,Z,C,S,T,P,M,R,I,L,N,F,j,D,B,E,V,z,O,W,H;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,m.getSession)(n),a=(0,m.getContainingTrack)(n),i=(0,m.getContainingView)(n),o=i.dynamicBlocks.contentBlocks[0],s=t.get("CIGAR"),u=t.get("strand"),c=o.start,l=o.end,d=t.get("start"),f=t.get("end"),h=t.get("mate"),g=h.start,v=h.end,y=h.assemblyName,b=h.refName,w=o.assemblyName,x=o.refName,s?(T=Mn(s),P=Rn(T,c-d),M=(0,A.Z)(P,2),R=M[0],I=M[1],L=Rn(T,l-d),N=(0,A.Z)(L,2),F=N[0],j=N[1],C=d+R,S=d+F,k=(-1===u?v:g)+I*(D=-1===u?-1:1),Z=(-1===u?v:g)+j*D):(C=d,S=f,k=g,Z=v),B=a.configuration.trackId,E=r.addView("LinearSyntenyView",{type:"LinearSyntenyView",views:[{id:"".concat(Math.random()),type:"LinearGenomeView",hideHeader:!0},{id:"".concat(Math.random()),type:"LinearGenomeView",hideHeader:!0}],tracks:[{configuration:B,type:"SyntenyTrack",displays:[{type:"LinearSyntenyDisplay",configuration:"".concat(B,"-LinearSyntenyDisplay")}]}]}),V=function(e){return Math.floor(e)},z="".concat(x,":").concat(V(C),"-").concat(V(S)),O=Math.min(k,Z),W=Math.max(k,Z),H="".concat(b,":").concat(V(O),"-").concat(V(W)).concat(-1===u?"[rev]":""),e.next=27,(0,ke.when)((function(){return void 0!==E.width}));case 27:return e.next=29,Promise.all([E.views[0].navToLocString(z,w),E.views[1].navToLocString(H,y)]);case 29:case"end":return e.stop()}}),e)}))),An.apply(this,arguments)}var In=function(e){return v.types.compose("LGVSyntenyDisplay",(0,r.P1)(e),v.types.model({type:v.types.literal("LGVSyntenyDisplay"),configuration:(0,l.ConfigurationReference)(e)})).views((function(e){var t=e.contextMenuItems;return{contextMenuItems:function(){var n=e.contextMenuFeature;return[].concat((0,xe.Z)(t()),(0,xe.Z)(n?[{label:"Open synteny view for this position",onClick:function(){return function(e,t){return An.apply(this,arguments)}(n,e)}}]:[]))}}})).views((function(e){var t=e.trackMenuItems,n=e.colorSchemeSubMenuItems;return{trackMenuItems:function(){return[].concat((0,xe.Z)(t()),[{label:"Color scheme",subMenu:(0,xe.Z)(n())}])}}})).actions((function(e){return{afterCreate:function(){e.colorBy?e.setColorScheme((0,h.Z)({},e.colorBy)):e.setColorScheme({type:"strand"})}}}))},Ln=n(76867),Nn=n(41174);function Fn(e){return(0,B.jsx)(U.Z,(0,h.Z)((0,h.Z)({},e),{},{children:(0,B.jsx)("path",{fill:"currentColor",d:"M16.5,21C13.5,21 12.31,16.76 11.05,12.28C10.14,9.04 9,5 7.5,5C4.11,5 4,11.93 4,12H2C2,11.63 2.06,3 7.5,3C10.5,3 11.71,7.25 12.97,11.74C13.83,14.8 15,19 16.5,19C19.94,19 20.03,12.07 20.03,12H22.03C22.03,12.37 21.97,21 16.5,21Z"})}))}var jn=(0,I.lazy)((function(){return n.e(1605).then(n.bind(n,71605))}));function Dn(e){return v.types.compose(Cn(e),v.types.model("LinearSyntenyView",{type:v.types.literal("LinearSyntenyView"),drawCIGAR:!0,drawCurves:!1})).actions((function(e){return{toggleCurves:function(){e.drawCurves=!e.drawCurves},toggleCIGAR:function(){e.drawCIGAR=!e.drawCIGAR},showAllRegions:function(){(0,ke.transaction)((function(){e.views.forEach((function(e){return e.showAllRegionsInAssembly()}))}))}}})).actions((function(e){return{exportSvg:function(t){return(0,g.Z)((0,p.Z)().mark((function r(){var a,i,o,s;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.e(9697).then(n.bind(n,79697));case 2:return a=r.sent,i=a.renderToSvg,r.next=6,i(e,t);case 6:o=r.sent,s=new Blob([o],{type:"image/svg+xml"}),(0,Ze.saveAs)(s,t.filename||"image.svg");case 9:case"end":return r.stop()}}),r)})))()}}})).views((function(e){var t=e.headerMenuItems,n=e.menuItems;return{headerMenuItems:function(){return[].concat((0,xe.Z)(t()),[{label:"Square view",onClick:e.squareView,description:"Makes both views use the same zoom level, adjusting to the average of each",icon:Ln.Z},{label:"Show all regions",onClick:e.showAllRegions,description:"Show entire genome assemblies",icon:Nn.Z},{label:"Draw CIGAR",onClick:e.toggleCIGAR,checked:e.drawCIGAR,type:"checkbox",description:"Draws per-base CIGAR level alignments"},{label:"Link views",type:"checkbox",checked:e.linkViews,onClick:e.toggleLinkViews,icon:Se.Z},{label:"Use curved lines",type:"checkbox",checked:e.drawCurves,onClick:e.toggleCurves,icon:Fn},{label:"Export SVG",icon:Ce.Z,onClick:function(){(0,m.getSession)(e).queueDialog((function(t){return[jn,{model:e,handleClose:t}]}))}}])},menuItems:function(){return[].concat((0,xe.Z)(n()),[{label:"Export SVG",icon:Ce.Z,onClick:function(){(0,m.getSession)(e).queueDialog((function(t){return[jn,{model:e,handleClose:t}]}))}}])}}}))}function Bn(e,t,n){try{e.showTrack(t)}catch(r){if(!"".concat(r).match("Could not resolve identifier"))throw r;n.push(t)}}var En=n(82044);var Vn=function(e){return(0,l.ConfigurationSchema)("SyntenyTrack",{},{baseConfiguration:(0,d.createBaseTrackConfig)(e)})};var zn=(0,l.ConfigurationSchema)("SyntenyFeatureWidget",{}),On=v.types.model("SyntenyFeatureWidget",{id:he.ElementId,type:v.types.literal("SyntenyFeatureWidget"),featureData:v.types.frozen()}).actions((function(e){return{setFeatureData:function(t){e.featureData=t},clearFeatureData:function(){e.featureData=void 0}}})),Wn=n(94308),Hn=r.tr.featurizeSA,Gn=r.tr.getClip,qn=r.tr.getLength,_n=r.tr.getLengthSansClipping,Un=r.tr.getTag,Jn=(0,st.ZL)()({root:{width:300}});function Xn(e){var t=e.track,n=e.feature,r=e.handleClose,a=Jn().classes,i=(0,I.useState)("0"),o=(0,A.Z)(i,2),s=o[0],u=o[1],c=(0,I.useState)(),d=(0,A.Z)(c,2),f=d[0],v=d[1],y=(0,I.useState)(),b=(0,A.Z)(y,2),w=b[0],x=b[1],k=+s;return(0,I.useEffect)((function(){(0,g.Z)((0,p.Z)().mark((function e(){var r,a,i,o,s,u,c,d,f,h,g,y;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v(void 0),e.prev=1,!(2048&n.get("flags"))){e.next=20;break}return r=Un(n,"SA")||"",a=r.split(";")[0],i=a.split(","),o=(0,A.Z)(i,2),s=o[0],u=o[1],c=(0,m.getSession)(t),d=c.rpcManager,f=(0,l.getConf)(t,"adapter"),h=(0,fe.getRpcSessionId)(t),e.next=11,d.call(h,"CoreGetFeatures",{adapterConfig:f,sessionId:h,regions:[{refName:s,start:+u-1,end:+u}]});case 11:if(g=e.sent,y=g.find((function(e){return e.get("name")===n.get("name")&&!(2048&e.get("flags"))&&!(256&e.get("flags"))})),!y){e.next=17;break}x(y),e.next=18;break;case 17:throw new Error("primary feature not found");case 18:e.next=21;break;case 20:x(n);case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(1),console.error(e.t0),v(e.t0);case 27:case"end":return e.stop()}}),e,null,[[1,23]])})))()}),[n,t]),(0,B.jsxs)(D.Dialog,{open:!0,onClose:r,title:"Set window size",children:[(0,B.jsx)(L.Z,{children:f?(0,B.jsx)(ut.Z,{color:"error",children:"".concat(f)}):w?(0,B.jsxs)("div",{className:a.root,children:[256&w.get("flags")?(0,B.jsx)(ut.Z,{style:{color:"orange"},children:"Note: You selected a secondary alignment (which generally does not have SA tags or SEQ fields) so do a full reconstruction of the alignment"}):null,(0,B.jsx)(ut.Z,{children:"Show an extra window size around each part of the split alignment. Using a larger value can allow you to see more genomic context."}),(0,B.jsx)(N.Z,{value:k,onChange:function(e){return u(e.target.value)},label:"Set window size"})]}):(0,B.jsxs)("div",{children:[(0,B.jsx)(ut.Z,{children:"To accurately perform comparison we are fetching the primary alignment. Loading primary feature..."}),(0,B.jsx)(Wn.Z,{})]})}),(0,B.jsxs)(F.Z,{children:[(0,B.jsx)(j.Z,{variant:"contained",color:"secondary",onClick:r,children:"Cancel"}),(0,B.jsx)(j.Z,{disabled:!w,variant:"contained",color:"primary",onClick:function(){try{var e;if(!w)return;var n=w,a=(0,m.getSession)(t),i=(0,m.getContainingView)(t),o=n.get("CIGAR"),s=n.get("flags"),u=n.get("strand"),c=Un(n,"SA")||"",d=n.get("name"),f=Gn(o,1),p="".concat(d,"_assembly_").concat(Date.now()),g=(0,l.getConf)(t,"assemblyNames"),y=(0,A.Z)(g,1)[0],b=[y,p],x="track-".concat(Date.now()),Z="".concat(d,"_vs_").concat(y),C=a.assemblyManager.get(y);if(!C)throw new Error("assembly not found");var S=Hn(c,n.id(),u,d,!0),T=n.toJSON();T.clipPos=f,T.strand=1,T.mate={refName:d,start:f,end:f+_n(o)};var P=qn(2048&s?S[0].CIGAR:o),M=[T].concat((0,xe.Z)(S));M.forEach((function(e,t){e.refName=(null===C||void 0===C?void 0:C.getCanonicalRefName(e.refName))||e.refName,e.syntenyId=t,e.mate.syntenyId=t,e.mate.uniqueId="".concat(e.uniqueId,"_mate")})),M.sort((function(e,t){return e.clipPos-t.clipPos}));var R=n.get("seq"),I=[].concat((0,xe.Z)(M),(0,xe.Z)(M.map((function(e){return e.mate})))),L=2*k,N=M.reduce((function(e,t){return e+t.end-t.start+L}),0),F="".concat(d,"_").concat(Date.now()),j=(0,l.getConf)(C,"sequence"),D=(0,m.gatherOverlaps)(M.map((function(e){return(0,h.Z)((0,h.Z)({},e),{},{start:Math.max(0,e.start-k),end:e.end+k,assemblyName:y})})));null===(e=a.addTemporaryAssembly)||void 0===e||e.call(a,{name:"".concat(p),sequence:{type:"ReferenceSequenceTrack",name:"Read sequence",trackId:F,assemblyNames:[p],adapter:{type:"FromConfigSequenceAdapter",noAssemblyManager:!0,features:[{start:0,end:P,seq:R||"",refName:d,uniqueId:"".concat(Math.random())}]}}}),a.addView("LinearSyntenyView",{type:"LinearSyntenyView",views:[{type:"LinearGenomeView",hideHeader:!0,offsetPx:0,bpPerPx:N/i.width,displayedRegions:D,tracks:[{id:"".concat(Math.random()),type:"ReferenceSequenceTrack",assemblyNames:[y],configuration:j.trackId,displays:[{id:"".concat(Math.random()),type:"LinearReferenceSequenceDisplay",showReverse:!0,showTranslation:!1,height:35,configuration:"".concat(F,"-LinearReferenceSequenceDisplay")}]}]},{type:"LinearGenomeView",hideHeader:!0,offsetPx:0,bpPerPx:P/i.width,displayedRegions:[{assemblyName:p,start:0,end:P,refName:d}],tracks:[{id:"".concat(Math.random()),type:"ReferenceSequenceTrack",configuration:F,displays:[{id:"".concat(Math.random()),type:"LinearReferenceSequenceDisplay",showReverse:!0,showTranslation:!1,height:35,configuration:"".concat(F,"-LinearReferenceSequenceDisplay")}]}]}],viewTrackConfigs:[{type:"SyntenyTrack",assemblyNames:b,adapter:{type:"FromConfigAdapter",features:I},trackId:x,name:Z}],tracks:[{configuration:x,type:"SyntenyTrack",displays:[{type:"LinearSyntenyDisplay",configuration:"".concat(x,"-LinearSyntenyDisplay")}]}],displayName:"".concat(d," vs ").concat(y)}),r()}catch(B){console.error(B),v(B)}},children:"Submit"})]})]})}var Yn=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="LinearComparativeViewPlugin",e}return(0,i.Z)(r,[{key:"install",value:function(e){!function(e){e.addViewType((function(){return new ye.Z({name:"LinearComparativeView",displayName:"Linear comparative view",stateModel:Cn(e),ReactComponent:(0,I.lazy)((function(){return n.e(3442).then(n.bind(n,23442))}))})}))}(e),function(e){e.addViewType((function(){return new ye.Z({name:"LinearSyntenyView",displayName:"Linear synteny view",stateModel:Dn(e),ReactComponent:(0,I.lazy)((function(){return n.e(3778).then(n.bind(n,23778))}))})}))}(e),function(e){e.addDisplayType((function(){var t=yn(e);return new ot.Z({name:"LinearComparativeDisplay",configSchema:t,stateModel:kn(t),trackType:"SyntenyTrack",viewType:"LinearComparativeView",ReactComponent:function(){return null}})}))}(e),function(e){e.addDisplayType((function(){var t=Sn(e);return new ot.Z({name:"LinearSyntenyDisplay",configSchema:t,stateModel:Tn(t),trackType:"SyntenyTrack",viewType:"LinearSyntenyView",ReactComponent:(0,I.lazy)((function(){return n.e(9130).then(n.bind(n,93321))}))})}))}(e),function(e){e.addDisplayType((function(){var t=Pn(e),n=In(t);return new ot.Z({name:"LGVSyntenyDisplay",configSchema:t,stateModel:n,trackType:"SyntenyTrack",viewType:"LinearGenomeView",ReactComponent:mn.qb})}))}(e),function(e){e.addToExtensionPoint("LaunchView-LinearSyntenyView",function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t){var n,r,a,i,o,s,u;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.session,r=t.views,a=t.tracks,i=void 0===a?[]:a,e.prev=1,o=n.assemblyManager,s=n.addView("LinearSyntenyView",{}),e.next=6,(0,ke.when)((function(){return!!s.width}));case 6:return e.t0=s,e.next=9,Promise.all(r.map(function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t){var n;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.waitForAssembly(t.assembly);case 2:if(n=e.sent){e.next=5;break}throw new Error("Assembly ".concat(t.assembly," failed to load"));case 5:return e.abrupt("return",{type:"LinearGenomeView",bpPerPx:1,offsetPx:0,hideHeader:!0,displayedRegions:n.regions});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 9:return e.t1=e.sent,e.t0.setViews.call(e.t0,e.t1),e.next=13,Promise.all(s.views.map((function(e){return(0,ke.when)((function(){return e.initialized}))})));case 13:return u=[],e.next=16,Promise.all(r.map(function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t,n){var r,a,i,o;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.views[n],a=t.loc,i=t.tracks,o=void 0===i?[]:i,e.next=4,r.navToLocString(a);case 4:o.forEach((function(e){return Bn(r,e,u)}));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 16:if(i.forEach((function(e){return Bn(s,e,u)})),!u.length){e.next=19;break}throw new Error("Could not resolve identifiers: ".concat(u.join(",")));case 19:e.next=25;break;case 21:throw e.prev=21,e.t2=e.catch(1),n.notify("".concat(e.t2),"error"),e.t2;case 25:case"end":return e.stop()}}),e,null,[[1,21]])})));return function(t){return e.apply(this,arguments)}}())}(e),function(e){e.addTrackType((function(){var t=Vn(e);return new En.Z({name:"SyntenyTrack",configSchema:t,stateModel:(0,d.createBaseTrackModel)(e,"SyntenyTrack",t)})}))}(e),function(e){e.addWidgetType((function(){return new Qt.Z({name:"SyntenyFeatureWidget",heading:"Synteny feature details",configSchema:zn,stateModel:On,ReactComponent:(0,I.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(8399),n.e(1356),n.e(2942),n.e(3721)]).then(n.bind(n,3132))}))})}))}(e),e.addToExtensionPoint("Core-extendPluggableElement",(function(e){return"LinearPileupDisplay"!==e.name||(e.stateModel=e.stateModel.extend((function(e){var t=e.contextMenuItems;return{views:{contextMenuItems:function(){var n=e.contextMenuFeature,r=(0,m.getContainingTrack)(e);return[].concat((0,xe.Z)(t()),(0,xe.Z)(n?[{label:"Linear read vs ref",icon:Et.Z,onClick:function(){(0,m.getSession)(e).queueDialog((function(e){return[Xn,{track:r,feature:n,handleClose:e}]}))}}]:[]))}}}}))),e}))}},{key:"configure",value:function(e){(0,m.isAbstractMenuManager)(e.rootModel)&&e.rootModel.appendToSubMenu(["Add"],{label:"Linear synteny view",icon:vn.Z,onClick:function(e){e.addView("LinearSyntenyView",{})}})}}]),r}(u.Z);function Qn(e){return v.types.compose("LinearLollipopDisplay",mn.fV,v.types.model({type:v.types.literal("LinearLollipopDisplay"),configuration:(0,l.ConfigurationReference)(e)})).views((function(e){var t=e.renderProps;return{get blockType(){return"dynamicBlocks"},get renderDelay(){return 500},renderProps:function(){return(0,h.Z)((0,h.Z)({},t()),{},{rpcDriverName:e.rpcDriverName,config:e.configuration.renderer})},get rendererTypeName(){return e.configuration.renderer.type}}}))}var Kn=n(74426);function $n(e){var t=e.feature,n=e.config,r=e.layoutRecord,a=r.y,i=r.data,o=i.anchorX,s=i.radiusPx,u=i.score,c=(0,l.readConfObject)(n,"innerColor",{feature:t}),d=String(u),f=1.1*(2*s/d.length);return f<12?null:(0,B.jsx)("text",{style:{fontSize:f,fill:(0,Kn.contrastingTextColor)(c)},x:o,y:a+s-f/2.4,textAnchor:"middle",dominantBaseline:"hanging",children:d})}var er=(0,ct.observer)((function(e){var t=e.feature,n=e.config,r=e.layoutRecord,a=e.selectedFeatureId,i=r.anchorLocation,o=r.y,s=r.data.radiusPx,u=function(t){var n=e.onFeatureMouseDown,r=e.feature;return null===n||void 0===n?void 0:n(t,r.id())},c=function(t){var n=e.onFeatureMouseEnter,r=e.feature;return null===n||void 0===n?void 0:n(t,r.id())},d=function(t){var n=e.onFeatureMouseOut,r=e.feature;return null===n||void 0===n?void 0:n(t,r.id())},f=function(t){var n=e.onFeatureMouseOver,r=e.feature;return null===n||void 0===n?void 0:n(t,r.id())},p=function(t){var n=e.onFeatureMouseUp,r=e.feature;return null===n||void 0===n?void 0:n(t,r.id())},h=function(t){var n=e.onFeatureMouseLeave,r=e.feature;return null===n||void 0===n?void 0:n(t,r.id())},g=function(t){var n=e.onFeatureMouseMove,r=e.feature;return null===n||void 0===n?void 0:n(t,r.id())},m=function(t){var n=e.onFeatureClick,r=e.feature;return t.stopPropagation(),null===n||void 0===n?void 0:n(t,r.id())},v={fill:(0,l.readConfObject)(n,"strokeColor",{feature:t})};String(a)===String(t.id())&&(v.fill="red");var y={fill:(0,l.readConfObject)(n,"innerColor",{feature:t})},b=(0,l.readConfObject)(n,"strokeWidth",{feature:t});return(0,B.jsxs)("g",{"data-testid":t.id(),children:[(0,B.jsx)("title",{children:(0,l.readConfObject)(n,"caption",{feature:t})}),(0,B.jsx)("circle",{cx:i,cy:o+s,r:s,style:v,onMouseDown:u,onMouseEnter:c,onMouseOut:d,onMouseOver:f,onMouseUp:p,onMouseLeave:h,onMouseMove:g,onClick:m,onFocus:f,onBlur:d}),s-b<=2?null:(0,B.jsx)("circle",{cx:i,cy:o+s,r:s-b,style:y,onMouseDown:u,onMouseEnter:c,onMouseOut:d,onMouseOver:f,onMouseUp:p,onMouseLeave:h,onMouseMove:g,onClick:m,onFocus:f,onBlur:d}),(0,B.jsx)($n,{feature:t,config:n,layoutRecord:r})]})})),tr=(0,ct.observer)((function(e){var t=e.feature,n=e.config,r=e.layoutRecord,a=r.anchorLocation,i=r.y,o=r.data.radiusPx;return(0,B.jsx)("line",{x1:a,y1:0,x2:a,y2:i+2*o,stroke:(0,l.readConfObject)(n,"stickColor",{feature:t}),strokeWidth:(0,l.readConfObject)(n,"stickWidth",{feature:t})})}));function nr(e){var t=e.feature,n=e.bpPerPx,r=e.config,a=e.region,i=e.layout,o=Math.abs(t.get("end")+t.get("start"))/2,s=(0,m.bpToPx)(o,a,n),u=(0,l.readConfObject)(r,"radius",{feature:t});u||console.error(new Error("lollipop radius ".concat(u," configured for feature ").concat(t.id()))),i.add(t.id(),s,2*u,2*u,{featureId:t.id(),anchorX:s,radiusPx:u,score:(0,l.readConfObject)(e.config,"score",{feature:t})})}var rr=(0,ct.observer)((function(e){var t,n=function(t){var n=e.onMouseEnter;return null===n||void 0===n?void 0:n(t)},r=function(t){var n=e.onMouseLeave;return null===n||void 0===n?void 0:n(t)},a=e.regions,i=e.bpPerPx,o=e.layout,s=e.config,u=e.features,c=void 0===u?new Map:u,l=e.displayModel,d=(void 0===l?{}:l).selectedFeatureId,f=(0,A.Z)(a,1)[0],p=(0,Tt.Z)(c.values());try{for(p.s();!(t=p.n()).done;){nr({feature:t.value,bpPerPx:i,region:f,config:s,layout:o})}}catch(y){p.e(y)}finally{p.f()}var g=(f.end-f.start)/i,m=(0,xe.Z)(o.getLayout(s).values()),v=o.getTotalHeight();return(0,B.jsx)("svg",{width:g,height:v,style:{position:"relative"},onMouseDown:function(t){var n=e.onMouseDown;return null===n||void 0===n?void 0:n(t)},onMouseUp:function(t){var n=e.onMouseUp;return null===n||void 0===n?void 0:n(t)},onMouseEnter:n,onMouseLeave:r,onMouseOver:function(t){var n=e.onMouseOver;return null===n||void 0===n?void 0:n(t)},onMouseOut:function(t){var n=e.onMouseOut;return null===n||void 0===n?void 0:n(t)},onFocus:n,onBlur:r,onClick:function(t){var n=e.onClick;return null===n||void 0===n?void 0:n(t)},children:m.map((function(t){var n=c.get(t.data.featureId);return(0,B.jsxs)(I.Fragment,{children:[(0,I.createElement)(tr,(0,h.Z)((0,h.Z)({},e),{},{config:s,layoutRecord:t,feature:n,key:"stick-".concat(n.id())})),(0,I.createElement)(er,(0,h.Z)((0,h.Z)({},e),{},{layoutRecord:t,feature:n,key:"body-".concat(n.id()),selectedFeatureId:d}))]},n.id())}))})})),ar=(0,l.ConfigurationSchema)("LollipopRenderer",{strokeColor:{type:"color",description:"the outer color of each lollipop",defaultValue:"green",contextVariable:["feature"]},innerColor:{type:"color",description:"the inner color of each lollipop",defaultValue:"#7fc75f",contextVariable:["feature"]},strokeWidth:{type:"number",description:"width of the stroked border",defaultValue:4,contextVariable:["feature"]},radius:{type:"number",description:"radius in pixels of each lollipop body",defaultValue:"jexl:sqrt(max(3, (get(feature,'score')*10)/3.14))",contextVariable:["feature"]},caption:{type:"string",description:"the tooltip caption displayed when the mouse hovers over a lollipop",defaultValue:"jexl:get(feature,'name')",contextVariable:["feature"]},minStickLength:{type:"number",description:'minimum lollipop "stick" length, in pixels',defaultValue:5},stickColor:{type:"color",description:"color of the lollipop stick",defaultValue:"black",contextVariable:["feature"]},stickWidth:{type:"number",description:"width in pixels of the lollipop stick",defaultValue:2,contextVariable:["feature"]},score:{type:"number",description:'the "score" of each lollipop, displayed as a number in the center of the circle',defaultValue:"jexl:get(feature,'score')",contextVariable:["feature"]}},{explicitlyTyped:!0}),ir=n(21339),or=n(35064),sr=n(37654),ur=function(){function e(t){var n=t.width;if((0,a.Z)(this,e),this.width=void 0,this.totalHeight=0,this.items=[],this.layout=new Map,this.layoutDirty=!1,!n)throw new Error("width required to make a new FloatingLayout");this.width=n}return(0,i.Z)(e,[{key:"add",value:function(e,t,n,r,a){this.items.push({uniqueId:e,anchorLocation:t,width:n,height:r,data:a}),this.layoutDirty=!0}},{key:"getLayout",value:function(e){if(!this.layoutDirty)return this.layout;if(!e)throw new Error("configuration object required");for(var t=(0,l.readConfObject)(e,"minStickLength"),n=this.items.sort((function(e,t){return e.data.score-t.data.score})),r=0,a=new Array(n.length),i=0;i<n.length;i+=1){for(var o=n[i],s=o.anchorLocation,u=o.width,c=o.height,d=s-u/2,f=d+u,p=t,g=p+c,m=0;m<i;m+=1){var v=(0,A.Z)(a[m],2)[1],y=v.x,b=v.y,w=y+v.width,x=b+v.height;(0,sr.qY)(y,w,d,f)&&(0,sr.qY)(b,x,p,g)&&(g=(p=x)+c,m=-1)}a[i]=[o.uniqueId,(0,h.Z)((0,h.Z)({},o),{},{x:d,y:p})],g>r&&(r=g)}return this.totalHeight=r,this.layout=new Map(a),this.layoutDirty=!1,this.layout}},{key:"getTotalHeight",value:function(){if(this.layoutDirty)throw new Error("getTotalHeight does not work when the layout is dirty.");return this.totalHeight}},{key:"serializeRegion",value:function(){return this.toJSON()}},{key:"toJSON",value:function(){if(this.layoutDirty)throw new Error("toJSON does not work when the layout is dirty.");return{pairs:(0,xe.Z)(this.getLayout()),totalHeight:this.getTotalHeight()}}}],[{key:"fromJSON",value:function(){throw new Error("not supported")}}]),e}(),cr=function(){function e(t){var n=t.pairs,r=t.totalHeight;(0,a.Z)(this,e),this.layout=void 0,this.totalHeight=void 0,this.layout=new Map(n),this.totalHeight=r}return(0,i.Z)(e,[{key:"add",value:function(e){if(!this.layout.has(e))throw new Error("layout error, precomputed layout is missing ".concat(e))}},{key:"getLayout",value:function(){return this.layout}},{key:"getTotalHeight",value:function(){return this.totalHeight}}],[{key:"fromJSON",value:function(t){return new e(t)}}]),e}(),lr=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"makeLayout",value:function(){var e=this.regions[0],t=(e.end-e.start)/this.bpPerPx;return new or.Z(ur,{width:t})}},{key:"layoutIsValid",value:function(){return!1}}]),n}(ir.LayoutSession),dr=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"createSession",value:function(e){return new lr(e)}},{key:"deserializeLayoutInClient",value:function(e){return new cr(e)}}]),n}(ir.default),fr=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="LollipopPlugin",e}return(0,i.Z)(n,[{key:"install",value:function(e){e.addRendererType((function(){return new dr({name:"LollipopRenderer",ReactComponent:rr,configSchema:ar,pluginManager:e})})),e.addDisplayType((function(){var t=function(e){return(0,l.ConfigurationSchema)("LinearLollipopDisplay",{renderer:e.pluggableConfigSchemaType("renderer")},{baseConfiguration:mn.fU,explicitlyTyped:!0})}(e);return new ot.Z({name:"LinearLollipopDisplay",configSchema:t,stateModel:Qn(t),trackType:"LollipopTrack",viewType:"LinearGenomeView",ReactComponent:mn.qb})}))}}]),n}(u.Z);function pr(e){return v.types.compose("LinearArcDisplay",mn.fV,v.types.model({type:v.types.literal("LinearArcDisplay"),configuration:(0,l.ConfigurationReference)(e)})).views((function(e){var t=e.renderProps;return{get blockType(){return"staticBlocks"},get renderDelay(){return 500},renderProps:function(){return(0,h.Z)((0,h.Z)({},t()),{},{rpcDriverName:e.rpcDriverName,config:e.configuration.renderer})},get rendererTypeName(){return e.configuration.renderer.type}}}))}var hr=function(e){e.addDisplayType((function(){var t=function(e){return(0,l.ConfigurationSchema)("LinearArcDisplay",{renderer:v.types.optional(e.pluggableConfigSchemaType("renderer"),{type:"ArcRenderer"})},{baseConfiguration:mn.fU,explicitlyTyped:!0})}(e);return new ge.DisplayType({name:"LinearArcDisplay",displayName:"Arc display",configSchema:t,stateModel:pr(t),trackType:"FeatureTrack",viewType:"LinearGenomeView",ReactComponent:mn.qb})}))},gr=n(6364),mr=(0,ct.observer)((function(e){var t,n=function(t,n){var r=e.onFeatureClick;if(r)return r(t,n)},r=e.features,a=e.config,i=e.regions,o=e.blockKey,s=e.bpPerPx,u=e.displayModel.selectedFeatureId,c=(0,A.Z)(i,1)[0],d=[],f=(0,Tt.Z)(r.values());try{var p=function(){var e=t.value,r=(0,m.bpSpanPx)(e.get("start"),e.get("end"),c,s),i=(0,A.Z)(r,2),f=i[0],p=i[1],h=e.id(),g=o+"-"+h,v=(0,l.readConfObject)(a,"color",{feature:e}),y="black";u&&String(u)===String(e.id())&&(v=y="red");var b=(0,l.readConfObject)(a,"label",{feature:e}),w=(0,l.readConfObject)(a,"caption",{feature:e}),x=(0,l.readConfObject)(a,"thickness",{feature:e})||1,k=(0,l.readConfObject)(a,"height",{feature:e})||100,Z=I.createRef(),C=20+(0,m.measureText)(null===w||void 0===w?void 0:w.toString()),S=.5,T=0+S*k*.75+.375*k+0;d.push((0,B.jsxs)("g",{onClick:function(e){return n(e,h)},children:[(0,B.jsx)("path",{id:g,d:"M ".concat(f," 0 C ").concat(f," ").concat(k,", ").concat(p," ").concat(k,", ").concat(p," 0"),stroke:v,strokeWidth:x,fill:"transparent",onClick:function(e){return n(e,h)},ref:Z,pointerEvents:"stroke"}),(0,B.jsxs)(gr.u,{triggerRef:Z,children:[(0,B.jsx)("rect",{x:12,y:0,width:C,height:20,rx:5,ry:5,fill:"black",fillOpacity:"50%"}),(0,B.jsx)("text",{x:22,y:14,fontSize:10,fill:"white",textLength:C-20,children:w})]}),(0,B.jsx)("text",{x:f+(p-f)/2,y:T+3,style:{stroke:"white",strokeWidth:"0.6em"},children:b}),(0,B.jsx)("text",{x:f+(p-f)/2,y:T+3,style:{stroke:y},children:b})]},g))};for(f.s();!(t=f.n()).done;)p()}catch(g){f.e(g)}finally{f.f()}var h=(c.end-c.start)/s;return(0,B.jsx)("svg",{className:"ArcRendering",width:h,height:500,style:{outline:"none",position:"relative"},children:d})}));var vr=(0,l.ConfigurationSchema)("ArcRenderer",{color:{type:"color",description:"the color of the arcs",defaultValue:"darkblue",contextVariable:["feature"]},thickness:{type:"number",description:"the thickness of the arcs",defaultValue:"jexl:logThickness(feature,'score')",contextVariable:["feature"]},label:{type:"string",description:"the label to appear at the apex of the arcs",defaultValue:"jexl:get(feature,'score')",contextVariable:["feature"]},height:{type:"number",description:"the height of the arcs",defaultValue:"jexl:log10(get(feature,'end')-get(feature,'start'))*50",contextVariable:["feature"]},caption:{type:"string",description:"the caption to appear when hovering over any point on the arcs",defaultValue:"jexl:get(feature,'name')",contextVariable:["feature"]}},{explicitlyTyped:!0}),yr=n(29637),br=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n)}(yr.default),wr=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="ArcRenderer",e}return(0,i.Z)(n,[{key:"install",value:function(e){!function(e){e.addRendererType((function(){return new br({name:"ArcRenderer",ReactComponent:mr,configSchema:vr,pluginManager:e})}))}(e),hr(e),e.jexl.addFunction("logThickness",(function(e,t){return Math.log(e.get(t)+1)}))}}]),n}(u.Z),xr=n(21165),kr=n(7479),Zr=(0,l.ConfigurationSchema)("AboutWidget",{}),Cr=v.types.model("AboutWidget",{id:he.ElementId,type:v.types.literal("AboutWidget")}),Sr=(0,l.ConfigurationSchema)("HelpWidget",{}),Tr=v.types.model("HelpWidget",{id:he.ElementId,type:v.types.literal("HelpWidget")}),Pr=(0,l.ConfigurationSchema)("ImportSessionWidget",{}),Mr=v.types.model("ImportSessionWidget",{id:he.ElementId,type:v.types.literal("ImportSessionWidget")}),Rr=(0,l.ConfigurationSchema)("SessionManager",{}),Ar=v.types.model("SessionManager",{id:he.ElementId,type:v.types.literal("SessionManager")}),Ir=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="MenusPlugin",e}return(0,i.Z)(r,[{key:"install",value:function(e){e.addWidgetType((function(){return new Qt.Z({name:"AboutWidget",heading:"About",configSchema:Zr,stateModel:Cr,ReactComponent:(0,I.lazy)((function(){return n.e(4637).then(n.bind(n,94637))}))})})),e.addWidgetType((function(){return new Qt.Z({name:"HelpWidget",heading:"Help",configSchema:Sr,stateModel:Tr,ReactComponent:(0,I.lazy)((function(){return n.e(8935).then(n.bind(n,58935))}))})})),e.addWidgetType((function(){return new Qt.Z({name:"ImportSessionWidget",heading:"Import session",configSchema:Pr,stateModel:Mr,ReactComponent:(0,I.lazy)((function(){return Promise.all([n.e(8309),n.e(8531)]).then(n.bind(n,38531))}))})})),e.addWidgetType((function(){return new Qt.Z({name:"SessionManager",heading:"Sessions",configSchema:Rr,stateModel:Ar,ReactComponent:(0,I.lazy)((function(){return Promise.all([n.e(1306),n.e(4782)]).then(n.bind(n,44782))}))})}))}},{key:"configure",value:function(e){(0,m.isAbstractMenuManager)(e.rootModel)&&(e.rootModel.appendToMenu("Help",{label:"About",icon:kr.Z,onClick:function(e){var t=e.addWidget("AboutWidget","aboutWidget");e.showWidget(t)}}),e.rootModel.appendToMenu("Help",{label:"Help",icon:xr.Z,onClick:function(e){var t=e.addWidget("HelpWidget","helpWidget");e.showWidget(t)}}))}}]),r}(u.Z),Lr=n(26131),Nr=n(14956),Fr=n(64953),jr=n.n(Fr),Dr=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e,r,i){var o;return(0,a.Z)(this,n),(o=t.call(this,e,r,i)).endpoint=void 0,o.queryTemplate=void 0,o.refNamesQueryTemplate=void 0,o.additionalQueryParams=void 0,o.configRefNames=void 0,o.refNames=void 0,o.endpoint=(0,l.readConfObject)(e,"endpoint").uri,o.queryTemplate=(0,l.readConfObject)(e,"queryTemplate"),o.additionalQueryParams=(0,l.readConfObject)(e,"additionalQueryParams"),o.refNamesQueryTemplate=(0,l.readConfObject)(e,"refNamesQueryTemplate"),o.configRefNames=(0,l.readConfObject)(e,"refNames"),o}return(0,i.Z)(n,[{key:"getRefNames",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(){var t,n,r,a,i=arguments;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:{},!this.refNames){e.next=3;break}return e.abrupt("return",this.refNames);case 3:if(n=[],!this.refNamesQueryTemplate){e.next=12;break}return r=encodeURIComponent(this.refNamesQueryTemplate),e.next=8,this.querySparql(r,t);case 8:a=e.sent,n=this.resultsToRefNames(a),e.next=13;break;case 12:this.configRefNames&&(n=this.configRefNames);case 13:return this.refNames=n,e.abrupt("return",n);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getFeatures",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,Lr.ObservableCreate)(function(){var r=(0,g.Z)((0,p.Z)().mark((function r(a){var i,o,s;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=encodeURIComponent(jr()(t.queryTemplate,e)),o=e.refName,r.next=4,t.querySparql(i,n);case 4:s=r.sent,t.resultsToFeatures(s,o).forEach((function(e){a.next(e)})),a.complete();case 7:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),n.signal)}},{key:"querySparql",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t,n){var r,a,i;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="",this.additionalQueryParams.length&&(r="&".concat(this.additionalQueryParams.join("&"))),a=null===n||void 0===n?void 0:n.signal,e.next=5,fetch("".concat(this.endpoint,"?query=").concat(t).concat(r),{headers:{accept:"application/json,application/sparql-results+json"},signal:a});case 5:return i=e.sent,e.abrupt("return",i.json());case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"resultsToRefNames",value:function(e){var t,n=(null===e||void 0===e||null===(t=e.results)||void 0===t?void 0:t.bindings)||[];if(!n.length)return[];if(!e.head.vars.includes("refName"))throw new Error('"refName" not found in refNamesQueryTemplate response');return n.map((function(e){return e.refName.value}))}},{key:"resultsToFeatures",value:function(e,t){var n,r=(null===e||void 0===e||null===(n=e.results)||void 0===n?void 0:n.bindings)||[];if(!r.length)return[];var a=e.head.vars;["start","end","uniqueId"].forEach((function(e){a.includes(e)||console.error("Required field ".concat(e," missing from feature data"))}));var i={};r.forEach((function(e){var n=[{}];a.forEach((function(t){if(t in e){for(var r=e[t].value,a=0;t.startsWith("sub_");)t=t.slice(4),a+=1;for(;a>n.length-1;)n.push({});n[a][t]=r}})),n.forEach((function(e,r){var a=e.uniqueId;r<n.length-1&&(n[r+1].parentUniqueId=a),i[a]={data:(0,h.Z)((0,h.Z)({},e),{},{uniqueId:a,refName:t,start:parseInt(e.start,10),end:parseInt(e.end,10),strand:parseInt(e.strand,10)||0})}}))}));for(var o=0,s=Object.entries(i);o<s.length;o++){var u=(0,A.Z)(s[o],2),c=u[0],l=u[1],d=l.data.parentUniqueId;if(delete l.data.parentUniqueId,d){var f=i[d];if(f)f.data.subfeatures||(f.data.subfeatures=[]),f.data.subfeatures.push((0,h.Z)((0,h.Z)({},l.data),{},{uniqueId:c})),delete i[c];else{var p,g=Object.values(i).map((function(e){return e.data.subfeatures})).filter((function(e){return!!e})).flat(),m=!1,v=(0,Tt.Z)(g);try{for(v.s();!(p=v.n()).done;){var y=p.value;if(y&&y.uniqueId===d){y.subfeatures||(y.subfeatures=[]),y.subfeatures.push((0,h.Z)((0,h.Z)({},l.data),{},{uniqueId:c})),delete i[c],m=!0;break}null!==y&&void 0!==y&&y.subfeatures&&g.push.apply(g,(0,xe.Z)(y.subfeatures))}}catch(b){v.e(b)}finally{v.f()}m||console.error("Could not find parentID ".concat(d))}}}return Object.keys(i).map((function(e){return new Nr.Z((0,h.Z)((0,h.Z)({},i[e].data),{},{uniqueId:e,subfeatures:i[e].data.subfeatures}))}))}},{key:"hasDataForRefName",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t){var n,r,a=arguments;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},e.next=3,this.getRefNames(n);case 3:if(!(r=e.sent).length||r.includes(t)){e.next=6;break}return e.abrupt("return",!1);case 6:return e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"freeResources",value:function(){}}]),n}(rn.BaseFeatureDataAdapter),Br=(0,l.ConfigurationSchema)("SPARQLAdapter",{endpoint:{type:"fileLocation",defaultValue:{uri:"https://somesite.com/sparql",locationType:"UriLocation"},description:"URL of the SPARQL endpoint"},queryTemplate:{type:"text",defaultValue:"",description:"SPARQL query where {start} {end} and {refName} will get replaced for each call"},refNamesQueryTemplate:{type:"text",defaultValue:"",description:"SPARQL query that returns the possible refNames in a ?refName column"},refNames:{type:"stringArray",defaultValue:[],description:'Possible refNames used by the SPARQL endpoint (ignored if "refNamesQueryTemplate" is provided)'},additionalQueryParams:{type:"stringArray",defaultValue:[],description:'Additional parameters to add to the query, e.g. "format=JSON"'}},{explicitlyTyped:!0}),Er=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="RdfPlugin",e}return(0,i.Z)(n,[{key:"install",value:function(e){e.addAdapterType((function(){return new se.Z({name:"SPARQLAdapter",displayName:"SPARQL adapter",configSchema:Br,AdapterClass:Dr})})),e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="SPARQLAdapter",i=(0,fe.getFileName)(t);return/\/sparql$/i.test(i)||r===a?{type:a,endpoint:t}:e(t,n,r)}}))}}]),n}(u.Z);var Vr=(0,l.ConfigurationSchema)("TwoBitAdapter",{twoBitLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.2bit",locationType:"UriLocation"}},chromSizesLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/default.chrom.sizes",locationType:"UriLocation"},description:"An optional chrom.sizes file can be supplied to speed up loading since parsing the twobit file can take time"}},{explicitlyTyped:!0});function zr(e){for(var t=e.codonTable,n=e.seq,r=e.frame,a=e.bpPerPx,i=e.region,o=e.height,s=e.y,u=e.reverse,c=void 0!==u&&u,l=e.theme,d=a,f=3-i.start%3,p=(r+f+3)%3,h=n.slice(p),g=[],v=0;v<h.length;v+=3){var y=h.slice(v,v+3),b=c?(0,m.revcom)(y):y,w=t[b]||"";g.push({letter:w,codon:b.toUpperCase()})}var x=1/d*3,k=0===i.start?0:x,Z=1/a>=12,C=(i.end-i.start)/a,S=["#d8d8d8","#adadad","#8f8f8f"].reverse();return(0,B.jsx)(B.Fragment,{children:g.map((function(e,t){var n=i.reversed?C-(x*(t+1)+p/d-k):x*t+p/d-k,a=e.letter,u=e.codon;return(0,B.jsxs)(I.Fragment,{children:[(0,B.jsx)("rect",{x:n,y:s,width:Z?x:x+.7,height:o,stroke:Z?"#555":"none",fill:m.defaultStarts.includes(u)?null===l||void 0===l?void 0:l.palette.startCodon:m.defaultStops.includes(u)?null===l||void 0===l?void 0:l.palette.stopCodon:S[Math.abs(r)]}),Z?(0,B.jsx)("text",{x:n+x/2,y:s+o/2,dominantBaseline:"middle",textAnchor:"middle",children:a}):null]},"".concat(t,"-").concat(a))}))})}function Or(e){var t=e.bpPerPx,n=e.region,r=e.feature,a=e.theme,i=e.height,o=e.seq,s=e.y,u=1/t>=12,c=(0,m.bpSpanPx)(r.get("start"),r.get("end"),n,t),l=(0,A.Z)(c,2),d=l[0],f=l[1],p=n.reversed,h=r.get("end")-r.get("start"),g=Math.max((f-d)/h,.8);return(0,B.jsx)(B.Fragment,{children:o.split("").map((function(e,t){var n=a.palette.bases[e.toUpperCase()],r=p?f-(t+1)*g:d+t*g;return(0,B.jsxs)(I.Fragment,{children:[(0,B.jsx)("rect",{x:r,y:s,width:g,height:i,fill:n?n.main:"#aaa",stroke:u?"#555":"none"}),u?(0,B.jsx)("text",{x:r+g/2,y:s+i/2,dominantBaseline:"middle",textAnchor:"middle",fill:n?a.palette.getContrastText(n.main):"black",children:e}):null]},t)}))})}function Wr(e){var t=e.regions,n=e.theme,r=e.features,a=void 0===r?new Map:r,i=e.showReverse,o=void 0===i||i,s=e.showForward,u=void 0===s||s,c=e.showTranslation,l=void 0===c||c,d=e.bpPerPx,f=(0,A.Z)(t,1)[0],p=(0,D.createJBrowseTheme)(n),h=(0,m.generateCodonTable)(m.defaultCodonTable),g=(0,xe.Z)(a.values())[0];if(!g)return null;var v=g.get("seq");if(!v)return null;var y=-20;return(0,B.jsxs)(B.Fragment,{children:[l&&(f.reversed?o:u)?[2,1,0].map((function(e){return(0,B.jsx)(zr,{seq:v,y:y+=20,codonTable:h,frame:e,bpPerPx:d,region:f,theme:p,height:20,reverse:f.reversed},"translation-".concat(e))})):null,u?(0,B.jsx)(Or,{height:20,y:y+=20,feature:g,region:f,seq:f.reversed?(0,m.complement)(v):v,bpPerPx:d,theme:p}):null,o?(0,B.jsx)(Or,{height:20,y:y+=20,feature:g,region:f,seq:f.reversed?v:(0,m.complement)(v),bpPerPx:d,theme:p}):null,l&&(f.reversed?u:o)?[0,-1,-2].map((function(e){return(0,B.jsx)(zr,{seq:v,y:y+=20,codonTable:h,frame:e,bpPerPx:d,region:f,theme:p,height:20,reverse:!f.reversed},"rev-translation-".concat(e))})):null]})}function Hr(e){var t=e.exportSVG,n=e.width,r=e.totalHeight,a=e.children;return t?(0,B.jsx)(B.Fragment,{children:a}):(0,B.jsx)("svg",{"data-testid":"sequence_track",width:n,height:r,style:{width:n,height:r},children:a})}var Gr=(0,ct.observer)((function(e){var t=e.regions,n=e.bpPerPx,r=(0,A.Z)(t,1)[0],a=(r.end-r.start)/n;return(0,B.jsx)(Hr,(0,h.Z)((0,h.Z)({},e),{},{totalHeight:200,width:a,children:(0,B.jsx)(Wr,(0,h.Z)({},e))}))}));var qr=(0,l.ConfigurationSchema)("DivSequenceRenderer",{height:{type:"number",description:"height in pixels of each line of sequence",defaultValue:16}},{explicitlyTyped:!0}),_r=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).supportsSVG=!0,e}return(0,i.Z)(n,[{key:"getExpandedRegion",value:function(e){return(0,h.Z)((0,h.Z)({},e),{},{start:Math.max(e.start-3,0),end:e.end+3})}}]),n}(yr.default);var Ur=(0,l.ConfigurationSchema)("BgzipFastaAdapter",{fastaLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/seq.fa.gz",locationType:"UriLocation"}},faiLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/seq.fa.gz.fai",locationType:"UriLocation"}},metadataLocation:{description:"Optional metadata file",type:"fileLocation",defaultValue:{uri:"/path/to/fa.metadata.yaml",locationType:"UriLocation"}},gziLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/seq.fa.gz.gzi",locationType:"UriLocation"}}},{explicitlyTyped:!0});var Jr=(0,l.ConfigurationSchema)("ChromSizesAdapter",{chromSizesLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/species.chrom.sizes",locationType:"UriLocation"}}},{explicitlyTyped:!0});var Xr=(0,l.ConfigurationSchema)("IndexedFastaAdapter",{fastaLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/seq.fa",locationType:"UriLocation"}},faiLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/seq.fa.fai",locationType:"UriLocation"}},metadataLocation:{description:"Optional metadata file",type:"fileLocation",defaultValue:{uri:"/path/to/fa.metadata.yaml",locationType:"UriLocation"}}},{explicitlyTyped:!0});var Yr=(0,l.ConfigurationSchema)("SequenceSearchAdapter",{search:{type:"string",defaultValue:"",description:"Search string or regex to search for"},sequenceAdapter:{type:"frozen",defaultValue:null},searchForward:{type:"boolean",defaultValue:!0},searchReverse:{type:"boolean",defaultValue:!0},caseInsensitive:{type:"boolean",defaultValue:!0}},{explicitlyTyped:!0});var Qr=function(e){e.addTrackType((function(){var t=function(e){return(0,l.ConfigurationSchema)("ReferenceSequenceTrack",{adapter:e.pluggableConfigSchemaType("adapter"),displays:v.types.array(e.pluggableConfigSchemaType("display")),name:{type:"string",description:'optional track name, otherwise uses the "Reference sequence (assemblyName)"',defaultValue:""},metadata:{type:"frozen",description:"anything to add about this track",defaultValue:{}},formatAbout:(0,l.ConfigurationSchema)("FormatAbout",{config:{type:"frozen",description:"formats configuration in about dialog",defaultValue:{},contextVariable:["config"]},hideUris:{type:"boolean",defaultValue:!1}})},{preProcessSnapshot:function(t){var n=JSON.parse(JSON.stringify(t)),r=new Set,a=n.displays,i=void 0===a?[]:a;return"placeholderId"!==n.trackId&&(i.forEach((function(e){return e&&r.add(e.type)})),e.getTrackType(n.type).displayTypes.forEach((function(e){r.has(e.name)||i.push({displayId:"".concat(n.trackId,"-").concat(e.name),type:e.name})}))),(0,h.Z)((0,h.Z)({},n),{},{displays:i})},explicitIdentifier:"trackId",explicitlyTyped:!0,actions:function(e){return{addDisplayConf:function(t){var n=t.type;if(!n)throw new Error("unknown display type ".concat(n));var r=e.displays.find((function(e){return e&&e.displayId===t.displayId}));if(r)return r;var a=e.displays.push(t);return e.displays[a-1]}}}})}(e);return new En.Z({name:"ReferenceSequenceTrack",displayName:"Reference sequence track",configSchema:t,stateModel:(0,d.createBaseTrackModel)(e,"ReferenceSequenceTrack",t)})}))};var Kr=(0,l.ConfigurationSchema)("LinearReferenceSequenceDisplay",{renderer:qr},{explicitIdentifier:"displayId",explicitlyTyped:!0});var $r=function(e){e.addDisplayType((function(){var e=function(e){return v.types.compose("LinearReferenceSequenceDisplay",mn.fV,v.types.model({type:v.types.literal("LinearReferenceSequenceDisplay"),configuration:(0,l.ConfigurationReference)(e),showForward:!0,showReverse:!0,showTranslation:!0})).views((function(e){var t=e.renderProps;return{renderProps:function(){var n=e.showForward,r=e.rpcDriverName,a=e.showReverse,i=e.showTranslation;return(0,h.Z)((0,h.Z)({},t()),{},{config:e.configuration.renderer,rpcDriverName:r,showForward:n,showReverse:a,showTranslation:i})}}})).views((function(e){return{regionCannotBeRendered:function(){var t=(0,m.getContainingView)(e);return(null===t||void 0===t?void 0:t.bpPerPx)>=1?"Zoom in to see sequence":void 0},get rendererTypeName(){return e.configuration.renderer.type}}})).actions((function(e){return{toggleShowForward:function(){e.showForward=!e.showForward},toggleShowReverse:function(){e.showReverse=!e.showReverse},toggleShowTranslation:function(){e.showTranslation=!e.showTranslation},afterAttach:function(){(0,v.addDisposer)(e,(0,ke.autorun)((function(){var t=(0,m.getContainingView)(e);if((null===t||void 0===t?void 0:t.bpPerPx)>=1)e.setHeight(50);else{var n=e.showTranslation,r=e.showReverse,a=e.showForward,i=(r&&n?60:0)+(a&&n?60:0),o=r?20:0,s=a?20:0;e.setHeight(i+o+s)}})))}}})).views((function(e){return{trackMenuItems:function(){return[{label:"Show forward",type:"checkbox",checked:e.showForward,onClick:function(){return e.toggleShowForward()}},{label:"Show reverse",type:"checkbox",checked:e.showReverse,onClick:function(){return e.toggleShowReverse()}},{label:"Show translation",type:"checkbox",checked:e.showTranslation,onClick:function(){return e.toggleShowTranslation()}}]}}}))}(Kr);return new ge.DisplayType({name:"LinearReferenceSequenceDisplay",configSchema:Kr,stateModel:e,displayName:"Reference sequence display",trackType:"ReferenceSequenceTrack",viewType:"LinearGenomeView",ReactComponent:mn.qb})}))},ea=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="SequencePlugin",e}return(0,i.Z)(r,[{key:"install",value:function(e){!function(e){e.addRendererType((function(){return new _r({name:"DivSequenceRenderer",ReactComponent:Gr,configSchema:qr,pluginManager:e})}))}(e),function(e){e.addAdapterType((function(){return new se.Z({name:"TwoBitAdapter",displayName:"TwoBit adapter",configSchema:Vr,adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:function(){return Promise.all([n.e(2821),n.e(6254),n.e(7028)]).then(n.bind(n,97028)).then((function(e){return e.default}))}})}))}(e),function(e){e.addAdapterType((function(){return new se.Z({name:"BgzipFastaAdapter",displayName:"Bgzip-indexed FASTA adapter",configSchema:Ur,adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(8237),n.e(2796)]).then(n.bind(n,2796)).then((function(e){return e.default}))}})}))}(e),function(e){e.addAdapterType((function(){return new se.Z({name:"ChromSizesAdapter",displayName:"Chrom sizes adapter",configSchema:Jr,adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:function(){return n.e(7040).then(n.bind(n,17040)).then((function(e){return e.default}))}})}))}(e),function(e){e.addAdapterType((function(){return new se.Z({name:"IndexedFastaAdapter",displayName:"Indexed FASTA adapter",configSchema:Xr,adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:function(){return Promise.all([n.e(6700),n.e(2098),n.e(8237),n.e(9202)]).then(n.bind(n,29202)).then((function(e){return e.default}))}})}))}(e),function(e){e.addAdapterType((function(){return new se.Z({name:"SequenceSearchAdapter",displayName:"Sequence search adapter",adapterMetadata:{hiddenFromGUI:!0},configSchema:Yr,getAdapterClass:function(){return n.e(3639).then(n.bind(n,73639)).then((function(e){return e.default}))}})}))}(e),Qr(e),$r(e),function(e){e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="TwoBitAdapter",i=(0,fe.getFileName)(t),o={type:a,twoBitLocation:t};return/\.2bit$/i.test(i)&&!r||r===a?o:e(t,n,r)}})),e.addToExtensionPoint("Core-guessTrackTypeForLocation",(function(e){return function(t){return"TwoBitAdapter"===t?"ReferenceSequenceTrack":e(t)}})),e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="IndexedFastaAdapter",i=(0,fe.getFileName)(t),o={type:a,fastaLocation:t,faiLocation:n||(0,fe.makeIndex)(t,".fai")};return/\.(fa|fasta|fas|fna|mfa)$/i.test(i)&&!r||r===a?o:e(t,n,r)}})),e.addToExtensionPoint("Core-guessTrackTypeForLocation",(function(e){return function(t){return"IndexedFastaAdapter"===t?"ReferenceSequenceTrack":e(t)}})),e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="BgzipFastaAdapter",i=(0,fe.getFileName)(t),o={type:a,faiLocation:(0,fe.makeIndex)(t,".fai"),gziLocation:(0,fe.makeIndex)(t,".gzi")};return/\.(fa|fasta|fas|fna|mfa)\.b?gz$/i.test(i)&&!r||r===a?o:e(t,n,r)}})),e.addToExtensionPoint("Core-guessTrackTypeForLocation",(function(e){return function(t){return"BgzipFastaAdapter"===t?"ReferenceSequenceTrack":e(t)}}))}(e)}}]),r}(u.Z),ta=n(41472),na=n(94702),ra=(0,ct.observer)((function(e){var t=e.text,n=e.x,r=e.y,a=e.region,i=e.reversed,o=e.bpPerPx,s=e.exportSVG,u=e.feature,c=e.viewParams,l=e.color,d=void 0===l?"black":l,f=e.fontHeight,p=void 0===f?11:f,h=e.featureWidth,g=void 0===h?0:h,y=e.allowedWidthExpansion,b=void 0===y?0:y,w=e.displayModel,x=void 0===w?{}:w,k=g+b,Z=(0,m.measureText)(t,p),C=(0,v.isStateTreeNode)(x)&&(0,v.isAlive)(x)&&!s?(0,m.getViewParams)(x):c,S=i?C.end:C.start,T=(0,I.useState)(s),P=(0,A.Z)(T,2),M=P[0],R=P[1],L=(0,na.Z)();if((0,I.useEffect)((function(){R(!0)}),[]),(0,v.isStateTreeNode)(a)&&!(0,v.isAlive)(a))return null;var N=a.start,F=a.end,j=u.get("start"),D=u.get("end"),E=Z*o;return S<F&&S>N&&j<S&&S+E<D?n=C.offsetPx:j<S&&S+E<D&&S+E>N&&S+E<F&&(n=C.offsetPx1),M?(0,B.jsx)("text",{x:n,y:r+p,fill:"#f0f"===d?(0,m.stripAlpha)(L.palette.text.primary):d,fontSize:p,children:Z>k?"".concat(t.slice(0,k/(.6*p)),"..."):t}):null})),aa=ra,ia=(0,ct.observer)((function(e){var t,n,r,a,i=e.feature,o=e.rootLayout,s=e.config,u=e.name,c=e.description,d=e.shouldShowName,f=e.shouldShowDescription,p=o.getSubRecord(String(i.id()));if(!p)return null;var g=(p.data||{}).GlyphComponent;return(0,B.jsxs)("g",{children:[(0,B.jsx)(g,(0,h.Z)({featureLayout:p},e)),d?(0,B.jsx)(aa,(0,h.Z)({text:u,x:(null===(t=o.getSubRecord("nameLabel"))||void 0===t?void 0:t.absolute.left)||0,y:(null===(n=o.getSubRecord("nameLabel"))||void 0===n?void 0:n.absolute.top)||0,color:(0,l.readConfObject)(s,["labels","nameColor"],{feature:i}),featureWidth:p.width},e)):null,f?(0,B.jsx)(aa,(0,h.Z)({text:c,x:(null===(r=o.getSubRecord("descriptionLabel"))||void 0===r?void 0:r.absolute.left)||0,y:(null===(a=o.getSubRecord("descriptionLabel"))||void 0===a?void 0:a.absolute.top)||0,color:(0,l.readConfObject)(s,["labels","descriptionColor"],{feature:i}),featureWidth:p.width},e)):null]})})),oa=["rect","region","bpPerPx"],sa=["displayModel","blockKey","region","bpPerPx","movedDuringLastMouseDown"];function ua(e){var t=e.rect,n=e.region,r=e.bpPerPx,a=(0,Ge.Z)(e,oa);if(!t)return null;var i=(0,A.Z)(t,4),o=i[0],s=i[1],u=i[2],c=i[3],l=(0,m.bpSpanPx)(o,u,n,r),d=(0,A.Z)(l,2),f=d[0],p=d[1],g=Math.round(s),v=(n.end-n.start)/r,y=Math.round(c-s),b=p-f;if(f+b<0)return null;var w=Math.max(f,0),x=w-f,k=Math.max(1,Math.min(b-x,v));return(0,B.jsx)("rect",(0,h.Z)({x:w-2,y:g-2,width:k+4,height:y+4},a))}var ca=(0,ct.observer)((function(e){var t,n,r=e.displayModel,a=void 0===r?{}:r,i=e.blockKey,o=e.region,s=e.bpPerPx,u=e.movedDuringLastMouseDown,c=(0,Ge.Z)(e,sa),l=a.selectedFeatureId,d=a.featureIdUnderMouse,f=a.contextMenuFeature,p=d||(null===f||void 0===f?void 0:f.id()),h=(0,I.useState)(!1),g=(0,A.Z)(h,2),m=g[0],v=g[1];function y(e){var t=c.onFeatureMouseOut;if(t&&p)return t(e,p)}function b(e){var t=c.onFeatureMouseOver;if(t&&p)return t(e,p)}return(0,I.useEffect)((function(){v(!0)}),[]),m?(0,B.jsxs)(B.Fragment,{children:[p?(0,B.jsx)(ua,{rect:null===(t=a.getFeatureByID)||void 0===t?void 0:t.call(a,i,p),region:o,bpPerPx:s,fill:"#000",fillOpacity:"0.2",onMouseDown:function(e){var t=c.onFeatureMouseDown;if(t&&p)return t(e,p)},onMouseEnter:function(e){var t=c.onFeatureMouseEnter;if(t&&p)return t(e,p)},onMouseOut:y,onMouseOver:b,onMouseUp:function(e){var t=c.onFeatureMouseUp;if(t&&p)return t(e,p)},onMouseLeave:function(e){var t=c.onFeatureMouseLeave;if(t&&p)return t(e,p)},onMouseMove:function(e){var t=c.onFeatureMouseMove;if(t&&p)return t(e,p)},onClick:function(e){if(!u){var t=c.onFeatureClick;if(t&&p)return e.stopPropagation(),t(e,p)}},onContextMenu:function(e){var t=c.onFeatureContextMenu;if(t&&p)return t(e,p)},onFocus:b,onBlur:y,"data-testid":p}):null,l?(0,B.jsx)(ua,{rect:null===(n=a.getFeatureByID)||void 0===n?void 0:n.call(a,i,l),region:o,bpPerPx:s,stroke:"#00b8ff",fill:"none"}):null]}):null})),la=(0,ct.observer)((function(e){var t=e.feature,n=e.featureLayout,r=e.config,a=e.region,i=t.get("strand"),o=a.reversed?-1:1,s=7*i*o,u=n.absolute,c=u.left,d=void 0===c?0:c,f=u.top,p=void 0===f?0:f,h=u.width,g=void 0===h?0:h,v=u.height,y=void 0===v?0:v,b=(0,l.readConfObject)(r,"color2",{feature:t}),w=(0,na.Z)(),x="#f0f"===b?(0,m.stripAlpha)(w.palette.text.secondary):b,k=i*o===-1?d:i*o===1?d+g:null,Z=p+y/2;return k?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("line",{x1:k,x2:k+s,y1:Z,y2:Z,stroke:x}),(0,B.jsx)("polygon",{points:[[k+s/2,Z-2.5],[k+s/2,Z+2.5],[k+s,Z]].toString(),stroke:x,fill:x})]}):null})),da=(0,ct.observer)((function(e){var t=e.feature,n=e.region,r=e.config,a=e.featureLayout,i=e.bpPerPx,o=e.topLevel,s=n.start,u=(n.end-s)/i,c=(t.get("end")-t.get("start"))/i,d=a.absolute.left,f=void 0===d?0:d,p=a.absolute,g=p.top,m=void 0===g?0:g,v=p.height,y=void 0===v?0:v;if(f+c<0)return null;Ca(t)&&(m+=.175*y,y*=.65);var b=Math.max(f,0),w=b-f,x=Math.max(2,Math.min(c-w,u));return t.parent()&&"intron"===t.get("type")?null:(0,B.jsxs)(B.Fragment,{children:[o?(0,B.jsx)(la,(0,h.Z)({},e)):null,(0,B.jsx)("rect",{"data-testid":"box-".concat(t.id()),x:b,y:m,width:x,height:y,fill:Ca(t)?(0,l.readConfObject)(r,"color3",{feature:t}):(0,l.readConfObject)(r,"color1",{feature:t}),stroke:(0,l.readConfObject)(r,"outline",{feature:t})})]})})),fa=(0,ct.observer)((function(e){var t=e.feature,n=e.featureLayout,r=e.selected,a=e.config,i=e.subfeatures,o=void 0===i?t.get("subfeatures"):i,s=(0,na.Z)(),u=(0,l.readConfObject)(a,"color2",{feature:t}),c="#f0f"===u?(0,m.stripAlpha)(s.palette.text.secondary):u,d=n.absolute,f=d.left,p=void 0===f?0:f,g=d.top,v=void 0===g?0:g,y=d.width,b=void 0===y?0:y,w=d.height,x=v+(void 0===w?0:w)/2;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("line",{"data-testid":t.id(),x1:p,y1:x,y2:x,x2:p+b,stroke:c}),null===o||void 0===o?void 0:o.map((function(t){var a=String(t.id()),i=n.getSubRecord(a);if(!i)return null;var o=(i.data||{}).GlyphComponent;return(0,B.jsx)(o,(0,h.Z)((0,h.Z)({},e),{},{feature:t,topLevel:!1,featureLayout:i,selected:r}),"glyph-".concat(a))})),(0,B.jsx)(la,(0,h.Z)({},e))]})}));function pa(e,t){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"subParts",t=arguments.length>1?arguments[1]:void 0,n=(0,l.readConfObject)(t,e);return"string"==typeof n&&(n=n.split(/\s*,\s*/)),function(e){return n.map((function(e){return e.toLowerCase()})).includes(e.get("type").toLowerCase())}}("subParts",t)(e)}function ha(e){return/(\bUTR|_UTR|untranslated[_\s]region)\b/.test(e.get("type")||"")}function ga(e,t){var n=e.get("subfeatures");if(!n||0===n.length)return[];var r=n.some((function(e){return ha(e)})),a=["mRNA","transcript"].includes(e.get("type"));return(!r&&a||(0,l.readConfObject)(t,"impliedUTRs"))&&(n=function(e,t){var n,r,a,i=(0,xe.Z)(t),o=1/0,s=-1/0,u=[],c=(0,Tt.Z)(i);try{for(c.s();!(a=c.n()).done;){var l=a.value,d=l.get("type");/^cds/i.test(d)?(o>l.get("start")&&(o=l.get("start")),s<l.get("end")&&(s=l.get("end"))):/exon/i.test(d)?u.push(l):ha(l)&&(n=l.get("start")===e.get("start"),r=l.get("end")===e.get("end"))}}catch(w){c.e(w)}finally{c.f()}if(!(u.length&&o<1/0&&s>-1/0))return i;u.sort((function(e,t){return e.get("start")-t.get("start")}));var f,p,h=e.get("strand");if(!n)for(var g=0;g<u.length&&!((f=u[g].get("start"))>=o);g++){p=o>u[g].get("end")?u[g].get("end"):o;var v=h>=0?"five_prime_UTR":"three_prime_UTR";i.unshift(new m.SimpleFeature({parent:e,id:"".concat(e.id(),"_").concat(v,"_").concat(g),data:{start:f,end:p,strand:h,type:v}}))}if(!r)for(var y=u.length-1;y>=0&&!((p=u[y].get("end"))<=s);y--){f=s<u[y].get("start")?u[y].get("start"):s;var b=h>=0?"three_prime_UTR":"five_prime_UTR";i.push(new m.SimpleFeature({parent:e,id:"".concat(e.id(),"_").concat(b,"_").concat(y),data:{start:f,end:p,strand:h,type:b}}))}return i}(e,n)),n.filter((function(e){return pa(e,t)}))}var ma=(0,ct.observer)((function(e){var t=ga(e.feature,e.config);return(0,B.jsx)(fa,(0,h.Z)((0,h.Z)({},e),{},{subfeatures:t}))}));ma.layOut=function(e){var t=e.layout,n=e.feature,r=e.bpPerPx,a=e.reversed,i=e.config,o=e.extraGlyphs,s=ka({layout:t,feature:n,bpPerPx:r,reversed:a,config:i,extraGlyphs:o});return Za({layout:s,subfeatures:ga(n,i),bpPerPx:r,reversed:a,config:i,extraGlyphs:o}),s};var va=ma,ya=(0,ct.observer)((function(e){var t,n=e.feature,r=e.featureLayout,a=e.selected;return(0,B.jsx)(B.Fragment,{children:null===(t=n.get("subfeatures"))||void 0===t?void 0:t.map((function(t){var n=String(t.id()),i=r.getSubRecord(n);if(!i)return null;var o=(i.data||{}).GlyphComponent;return(0,B.jsx)(o,(0,h.Z)((0,h.Z)({},e),{},{feature:t,featureLayout:i,selected:a}),"glyph-".concat(n))}))})}));ya.layOut=function(e){var t=e.layout,n=e.feature,r=e.bpPerPx,a=e.reversed,i=e.config,o=e.extraGlyphs,s=ka({layout:t,feature:n,bpPerPx:r,reversed:a,config:i,extraGlyphs:o}),u=(0,l.readConfObject)(i,"displayMode");if("reducedRepresentation"!==u){var c,d=0;null===(c=n.get("subfeatures"))||void 0===c||c.forEach((function(e){var t=wa(e,o),n=(0,l.readConfObject)(i,"height",{feature:e});(t.layOut||xa)({layout:s,feature:e,bpPerPx:r,reversed:a,config:i,extraGlyphs:o}).move(0,d),d+="collapse"===u?0:("compact"===u?n/3:n)+2}))}return s};var ba=ya;function wa(e,t){var n,r=e.get("type"),a=e.get("subfeatures");if(a&&"CDS"!==r){var i=a.find((function(e){return!!e.get("subfeatures")}));return["mRNA","transcript","primary_transcript"].includes(r)&&a.some((function(e){return"CDS"===e.get("type")}))?va:!e.parent()&&i?ba:fa}return(null===t||void 0===t||null===(n=t.find((function(t){return t.validator(e)})))||void 0===n?void 0:n.glyph)||da}function xa(e){var t=e.layout,n=e.feature,r=e.bpPerPx,a=e.reversed,i=e.config,o=e.extraGlyphs,s=(0,l.readConfObject)(i,"displayMode"),u=ka({layout:t,feature:n,bpPerPx:r,reversed:a,config:i,extraGlyphs:o});return"reducedRepresentation"!==s&&Za({layout:u,subfeatures:n.get("subfeatures")||[],bpPerPx:r,reversed:a,config:i,extraGlyphs:o}),u}function ka(e){var t=e.layout,n=e.feature,r=e.bpPerPx,a=e.reversed,i=e.config,o=e.extraGlyphs,s=(0,l.readConfObject)(i,"displayMode"),u="reducedRepresentation"===s?da:wa(n,o),c=n.parent(),d=0;c&&(d=(a?c.get("end")-n.get("end"):n.get("start")-c.get("start"))/r);var f=(0,l.readConfObject)(i,"height",{feature:n}),p=(n.get("end")-n.get("start"))/r,h=t.parent,g=h?h.top:0;return t.addChild(String(n.id()),d,"collapse"===s?0:g,Math.max(p,1),"compact"===s?f/2:f,{GlyphComponent:u})}function Za(e){var t=e.layout,n=e.subfeatures,r=e.bpPerPx,a=e.reversed,i=e.config,o=e.extraGlyphs;n.forEach((function(e){(wa(e,o).layOut||xa)({layout:t,feature:e,bpPerPx:r,reversed:a,config:i,extraGlyphs:o})}))}function Ca(e){return/(\bUTR|_UTR|untranslated[_\s]region)\b/.test(e.get("type")||"")}function Sa(e){var t=e.feature,n=e.detectRerender,r=e.bpPerPx,a=e.region,i=e.config,o=e.displayMode,s=e.layout,u=e.extraGlyphs;null===n||void 0===n||n();var c=a.reversed,d=t.get(c?"end":"start"),f=(0,m.bpToPx)(d,a,r),p="collapsed"!==o,g=new ta.SceneGraph("root",0,0,0,0),v=(wa(t,u).layOut||xa)({layout:g,feature:t,bpPerPx:r,reversed:c,config:i,extraGlyphs:u}),y=!1,b=!1,w="",x="",k=0,Z=0;if(p){var C=(0,l.readConfObject)(i,"showLabels"),S=(0,l.readConfObject)(i,"showDescriptions");k=(0,l.readConfObject)(i,["labels","fontSize"],{feature:t}),Z=(0,l.readConfObject)(i,"maxFeatureGlyphExpansion")||0,w=String((0,l.readConfObject)(i,["labels","name"],{feature:t})||""),y=/\S/.test(w)&&C;var T=function(e){var t=g.width+Z,n=(0,m.measureText)(e,k);return Math.round(Math.min(n,t))};if(x=String((0,l.readConfObject)(i,["labels","description"],{feature:t})||""),b=/\S/.test(x)&&S,y&&g.addChild("nameLabel",0,v.bottom,T(w),k),b){var P=y?g.getSubRecord("nameLabel"):v;g.addChild("descriptionLabel",0,P.bottom,T(x),k)}}var M=s.addRect(t.id(),t.get("start"),t.get("start")+g.width*r+3*r,g.height+5);return null===M?null:(g.move(f,M),(0,B.jsx)(ia,(0,h.Z)({rootLayout:g,name:w,shouldShowName:y,description:x,shouldShowDescription:b,fontHeight:k,allowedWidthExpansion:Z,reversed:a.reversed,topLevel:!0},e)))}var Ta=(0,ct.observer)((function(e){var t=e.features,n=void 0===t?new Map:t,r=e.isFeatureDisplayed;return(0,B.jsx)(B.Fragment,{children:(0,xe.Z)(n.values()).filter((function(e){return!r||r(e)})).map((function(t){return(0,B.jsx)(Sa,(0,h.Z)({feature:t},e),t.id())}))})})),Pa=(0,ct.observer)((function(e){var t=e.layout,n=e.blockKey,r=e.regions,a=void 0===r?[]:r,i=e.bpPerPx,o=e.config,s=e.displayModel,u=void 0===s?{}:s,c=e.exportSVG,d=e.featureDisplayHandler,f=e.onMouseOut,p=e.onMouseDown,g=e.onMouseLeave,m=e.onMouseEnter,v=e.onMouseOver,y=e.onMouseMove,b=e.onMouseUp,w=e.onClick,x=(0,A.Z)(a,1)[0],k=(x.end-x.start)/i,Z=(0,l.readConfObject)(o,"displayMode"),C=(0,I.useRef)(null),S=(0,I.useState)(!1),T=(0,A.Z)(S,2),P=T[0],M=T[1],R=(0,I.useState)(0),L=(0,A.Z)(R,2),N=L[0],F=L[1],j=(0,I.useState)(!1),D=(0,A.Z)(j,2),E=D[0],V=D[1],z=(0,I.useCallback)((function(e){return M(!0),V(!1),null===p||void 0===p?void 0:p(e)}),[p]),O=(0,I.useCallback)((function(e){return M(!1),null===b||void 0===b?void 0:b(e)}),[b]),W=(0,I.useCallback)((function(e){var t;if(C.current){P&&V(!0);var r=C.current.getBoundingClientRect(),a=r.left,o=r.top,s=e.clientX-a,c=e.clientY-o,l=x.reversed?k-s:s,d=x.start+i*l,f=null===(t=u.getFeatureOverlapping)||void 0===t?void 0:t.call(u,n,d,c);y&&y(e,f)}}),[n,i,P,y,x.reversed,x.start,u,k]),H=(0,I.useCallback)((function(e){E||null===w||void 0===w||w(e)}),[E,w]);return(0,I.useEffect)((function(){F(t.getTotalHeight())}),[t]),c?(0,B.jsx)(Ta,(0,h.Z)({displayMode:Z,isFeatureDisplayed:d,region:x},e)):(0,B.jsxs)("svg",{ref:C,"data-testid":"svgfeatures",width:k,height:N+100,onMouseDown:z,onMouseUp:O,onMouseEnter:m,onMouseLeave:g,onMouseOver:v,onMouseOut:f,onMouseMove:W,onClick:H,children:[(0,B.jsx)(Ta,(0,h.Z)({displayMode:Z,region:x,movedDuringLastMouseDown:E,isFeatureDisplayed:d},e)),(0,B.jsx)(ca,(0,h.Z)((0,h.Z)({},e),{},{region:x,movedDuringLastMouseDown:E}))]})}));var Ma=(0,l.ConfigurationSchema)("SvgFeatureRenderer",{color1:{type:"color",description:"the main color of each feature",defaultValue:"goldenrod",contextVariable:["feature"]},color2:{type:"color",description:"the secondary color of each feature, used for connecting lines, etc",defaultValue:"#f0f",contextVariable:["feature"]},color3:{type:"color",description:"the tertiary color of each feature, often used for contrasting fills, like on UTRs",defaultValue:"#357089",contextVariable:["feature"]},outline:{type:"color",description:"the outline for features",defaultValue:"",contextVariable:["feature"]},height:{type:"number",description:"height in pixels of the main body of each feature",defaultValue:10,contextVariable:["feature"]},showLabels:{type:"boolean",defaultValue:!0},showDescriptions:{type:"boolean",defaultValue:!0},labels:(0,l.ConfigurationSchema)("SvgFeatureLabels",{name:{type:"string",description:"the primary name of the feature to show, if space is available",defaultValue:"jexl:get(feature,'name') || get(feature,'id')",contextVariable:["feature"]},nameColor:{type:"color",description:"the color of the name label, if shown",defaultValue:"#f0f",contextVariable:["feature"]},description:{type:"string",description:"the text description to show, if space is available",defaultValue:"jexl:get(feature,'note') || get(feature,'description')",contextVariable:["feature"]},descriptionColor:{type:"color",description:"the color of the description, if shown",defaultValue:"blue",contextVariable:["feature"]},fontSize:{type:"number",description:"height in pixels of the text to use for names and descriptions",defaultValue:12,contextVariable:["feature"]}}),displayMode:{type:"stringEnum",model:v.types.enumeration("displayMode",["normal","compact","reducedRepresentation","collapse"]),description:"Alternative display modes",defaultValue:"normal"},maxFeatureGlyphExpansion:{type:"number",description:"maximum number of pixels on each side of a feature's bounding coordinates that a glyph is allowed to use",defaultValue:500},maxHeight:{type:"integer",description:"the maximum height to be used in a svg rendering",defaultValue:600},subParts:{type:"string",description:"subparts for a glyph",defaultValue:"CDS,UTR,five_prime_UTR,three_prime_UTR"},impliedUTRs:{type:"boolean",description:"imply UTR from the exon and CDS differences",defaultValue:!1}},{explicitlyTyped:!0}),Ra=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).supportsSVG=!0,e}return(0,i.Z)(n)}(ir.default),Aa=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="SVGPlugin",e}return(0,i.Z)(n,[{key:"install",value:function(e){e.addRendererType((function(){return new Ra({name:"SvgFeatureRenderer",ReactComponent:Pa,configSchema:Ma,pluginManager:e})}))}}]),n}(u.Z),Ia=n(91211),La=n(39727);var Na=function(e){return(0,l.ConfigurationSchema)("GCContentAdapter",{sequenceAdapter:{type:"frozen",defaultValue:null}},{explicitlyTyped:!0})};var Fa=function(e){e.addDisplayType((function(){var t=function(e){return(0,l.ConfigurationSchema)("LinearGCContentDisplay",{},{baseConfiguration:e.getDisplayType("LinearWiggleDisplay").configSchema,explicitlyTyped:!0})}(e),n=function(e,t){return v.types.compose("LinearGCContentDisplay",(0,La.LT)(e,t),v.types.model({type:v.types.literal("LinearGCContentDisplay")})).views((function(e){var t=e.renderProps;return{renderProps:function(){var n=(0,l.getConf)(e.parentTrack,"adapter");return(0,h.Z)((0,h.Z)({},t()),{},{adapterConfig:{type:"GCContentAdapter",sequenceAdapter:n}})}}}))}(e,t);return new ge.DisplayType({name:"LinearGCContentDisplay",configSchema:t,stateModel:n,displayName:"GC content display",trackType:"ReferenceSequenceTrack",viewType:"LinearGenomeView",ReactComponent:La.Xl})}))},ja=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="GCContentPlugin",e}return(0,i.Z)(r,[{key:"install",value:function(e){!function(e){e.addAdapterType((function(){return new se.Z({name:"GCContentAdapter",displayName:"GC content adapter",adapterMetadata:{hiddenFromGUI:!0},configSchema:Na(e),getAdapterClass:function(){return n.e(6556).then(n.bind(n,36556)).then((function(e){return e.default}))}})}))}(e),Fa(e)}}]),r}(u.Z),Da=n(44058),Ba=n(27724),Ea=n(32665),Va=n(70983),za=n(2689),Oa=n(4953),Wa=n(94551),Ha=n(83265),Ga=n(44181);function qa(e,t){var n=t.DataCellReactComponent,r=void 0===n?null:n,a=t.FilterModelType,i=void 0===a?null:a,o=t.compare,s=t.displayName,u=void 0===s?void 0:s,c=t.categoryName,l=void 0===c?void 0:c;return v.types.model("ColumnDataType".concat(e),{type:v.types.literal(e)}).volatile((function(){return{DataCellReactComponent:r,FilterModelType:i,displayName:u||e,categoryName:l}})).views((function(){return{compare:o,get hasFilter(){return!!i}}}))}var _a=(0,st.ZL)()({textFilterControlAdornment:{marginRight:"-18px"},textFilterControl:{"& .MuiInput-formControl":{marginTop:8},"& .MuiInputLabel-formControl":{top:"-7px","&.MuiInputLabel-shrink":{top:"-3px"}}}}),Ua=(0,ct.observer)((function(e){var t=e.filterModel,n=_a().classes,r=(0,Ha.getEnumerationValues)((0,Ha.getSubType)((0,Ha.getPropertyType)((0,v.getPropertyMembers)(t),"operation")));return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Va.Z,{value:t.operation,onChange:function(e){return t.setOperation(String(e.target.value))},children:r.map((function(e){return(0,B.jsx)(za.Z,{value:e,children:e},e)}))})," ",(0,B.jsx)(N.Z,{label:"range",placeholder:"chr1:100-200",error:t.locStringIsInvalid,value:t.locString,onChange:function(e){return t.setLocString(e.target.value)},className:n.textFilterControl,InputProps:{endAdornment:(0,B.jsx)(Oa.Z,{className:n.textFilterControlAdornment,position:"end",children:(0,B.jsx)(Wa.Z,{"aria-label":"clear filter",onClick:function(){return t.setLocString("")},children:(0,B.jsx)(Ga.Z,{})})})}})]})})),Ja=["overlaps with","contained within","fully contains","does not overlap","not contained within","does not contain"],Xa={"overlaps with":function(e,t){return e.refName===t.refName&&(0,m.doesIntersect2)(e.start,e.end,t.start,t.end)},"contained within":function(e,t){return e.refName===t.refName&&(0,m.isContainedWithin)(e.start,e.end,t.start,t.end)},"fully contains":function(e,t){return e.refName===t.refName&&(0,m.isContainedWithin)(t.start,t.end,e.start,e.end)},"does not overlap":function(e,t){return!Xa["overlaps with"](e,t)},"not contained within":function(e,t){return!Xa["contained within"](e,t)},"does not contain":function(e,t){return!Xa["fully contains"](e,t)}},Ya=v.types.model("ColumnLocStringFilter",{type:v.types.literal("LocString"),columnNumber:v.types.integer,locString:"",operation:v.types.optional(v.types.enumeration(Ja),Ja[0])}).views((function(e){return{get locStringIsInvalid(){if(e.locString){var t=this.parsedLocString;return!t||""===t.refName||"number"!==typeof t.start||"number"!==typeof t.end||t.start>t.end}return!1},get parsedLocString(){var t=(0,m.getSession)(e),n=(0,v.getParent)(e,3).spreadsheet.assemblyName;try{return(0,m.parseLocString)(e.locString,(function(e){return t.assemblyManager.isValidRefName(e,n)}))}catch(r){return}}}})).views((function(e){return{get predicate(){var t=e.locString,n=e.locStringIsInvalid,r=e.parsedLocString,a=e.operation,i=e.columnNumber;return t&&!n&&r?function(e,t){var n=t.cellsWithDerived[i];if(null===n||void 0===n||!n.text||!n.extendedData)return!1;var o=n.extendedData;if(!o.refName)return!1;var s=Xa[a];if(!s)throw new Error('"'.concat(a,'" not implemented in location filter'));return s(o,r)}:function(){return!0}}}})).actions((function(e){return{setLocString:function(t){e.locString=t},setOperation:function(t){e.operation=t}}})).volatile((function(){return{ReactComponent:Ua}}));function Qa(e,t,n){return Ka.apply(this,arguments)}function Ka(){return(Ka=(0,g.Z)((0,p.Z)().mark((function e(t,n,r){var a,i,o,s,u,c;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,m.getSession)(t),i=t.assemblyName,o=(0,v.getParent)(t),s=o.id,u="".concat(s,"_").concat(i),(c=a.views.find((function(e){return e.id===u})))||(c=a.addView("LinearGenomeView",{id:u})),e.next=8,c.navToLocString(r.text,i);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var $a=(0,ct.observer)((function(e){var t=e.cell,n=e.columnNumber,r=e.spreadsheet;return(0,B.jsx)("a",{onClick:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(a){var i;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),i=(0,m.getSession)(r),e.prev=2,e.next=5,Qa(r,n,t);case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(2),console.error(e.t0),i.notify("".concat(e.t0),"error");case 11:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}(),title:"open a new linear genome view here",href:"#link",children:t.text})})),ei=qa("LocString",{categoryName:"Location",displayName:"Full location",compare:function(e,t){return(0,m.compareLocs)(e.extendedData,t.extendedData)},FilterModelType:Ya,DataCellReactComponent:$a}),ti=["equals","contains","does not contain","does not equal","starts with","ends with"],ni={contains:function(e,t){return e.toLowerCase().includes(t)},equals:function(e,t){return e.toLowerCase()===t},"starts with":function(e,t){return e.toLowerCase().startsWith(t)},"ends with":function(e,t){var n=e.toLowerCase().indexOf(t);return-1!==n&&n===e.length-t.length},"does not contain":function(e,t){return!ni.contains(e,t)},"does not equal":function(e,t){return!ni.equals(e,t)}},ri=(0,st.ZL)()({textFilterControlAdornment:{marginRight:"-18px"},textFilterControl:{margin:0,"& .MuiInput-formControl":{marginTop:8},"& .MuiInputLabel-formControl":{top:"-7px","&.MuiInputLabel-shrink":{top:"-3px"}}}}),ai=(0,ct.observer)((function(e){var t=e.filterModel,n=ri().classes,r=(0,Ha.getEnumerationValues)((0,Ha.getSubType)((0,Ha.getPropertyType)((0,v.getPropertyMembers)(t),"operation")));return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Va.Z,{value:t.operation,onChange:function(e){t.setOperation(String(e.target.value))},children:r.map((function(e){return(0,B.jsx)(za.Z,{value:e,children:e},e)}))})," ",(0,B.jsx)(N.Z,{label:"text",value:t.stringToFind,onChange:function(e){return t.setString(e.target.value)},className:n.textFilterControl,InputProps:{endAdornment:(0,B.jsx)(Oa.Z,{className:n.textFilterControlAdornment,position:"end",children:(0,B.jsx)(Wa.Z,{"aria-label":"clear filter",onClick:function(){return t.setString("")},children:(0,B.jsx)(Ga.Z,{})})})}})]})})),ii=v.types.model("ColumnTextFilter",{type:v.types.literal("Text"),columnNumber:v.types.integer,stringToFind:"",operation:v.types.optional(v.types.enumeration(ti),ti[0])}).views((function(e){return{get predicate(){var t=e.stringToFind,n=e.columnNumber,r=e.operation;if(!t)return function(){return!0};var a=t.toLowerCase();return function(e,t){var i=t.cellsWithDerived[n];if(null===i||void 0===i||!i.text)return!1;var o=ni[r];if(!o)throw new Error('"'.concat(r,'" not implemented in location filter'));return o(i.text,a)}}}})).actions((function(e){return{setString:function(t){e.stringToFind=t},setOperation:function(t){e.operation=t}}})).volatile((function(){return{ReactComponent:ai}})),oi=qa("Text",{compare:function(e,t){return e.text.localeCompare(t.text)},FilterModelType:ii}),si=qa("LocRef",{categoryName:"Location",displayName:"Reference seq",compare:function(e,t){return e.text.localeCompare(t.text)},FilterModelType:v.types.compose(ii,v.types.model({type:v.types.literal("LocRef")}))}),ui=["equals","greater than","less than","between","not between"],ci={equals:function(e,t){return e===t},"greater than":function(e,t){return e>t},"less than":function(e,t){return e<t},between:function(e,t,n){return e>t&&void 0!==n&&e<n},"not between":function(e,t,n){return!ci.between(e,t,n)}},li=(0,st.ZL)()({textFilterControlAdornment:{marginRight:"-18px"},textFilterControl:{"& .MuiInput-formControl":{marginTop:8},"& .MuiInputLabel-formControl":{top:"-7px","&.MuiInputLabel-shrink":{top:"-3px"}}}}),di=(0,ct.observer)((function(e){var t=e.filterModel,n=li().classes,r=ui;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Va.Z,{value:t.operation,onChange:function(e){return t.setOperation(String(e.target.value))},children:r.map((function(e){return(0,B.jsx)(za.Z,{value:e,children:e},e)}))})," ",(0,B.jsx)(N.Z,{label:"number",placeholder:"123",type:"number",error:t.firstNumberIsInvalid,defaultValue:t.firstNumber,onChange:function(e){t.setFirstNumber(parseFloat(e.target.value))},className:n.textFilterControl}),"between"!==t.operation&&"not between"!==t.operation?null:(0,B.jsxs)(B.Fragment,{children:[" and ",(0,B.jsx)(N.Z,{label:"number",placeholder:"456",type:"number",error:t.secondNumberIsInvalid,defaultValue:t.secondNumber,onChange:function(e){return t.setSecondNumber(parseFloat(e.target.value))},className:n.textFilterControl})]})]})})),fi=v.types.model("ColumnNumberFilter",{type:v.types.literal("Number"),columnNumber:v.types.integer,firstNumber:v.types.maybe(v.types.number),secondNumber:v.types.maybe(v.types.number),operation:v.types.optional(v.types.enumeration(ui),ui[0])}).views((function(e){return{get predicate(){if("number"!==typeof e.firstNumber)return function(){return!0};var t=e.firstNumber,n=e.secondNumber,r=e.operation,a=e.columnNumber;return function(e,i){var o=i.cellsWithDerived[a];if(null===o||void 0===o||!o.text)return!1;var s=parseFloat(o.text);if("number"!==typeof s)return!1;var u=ci[r];if(!u)throw new Error('"'.concat(r,'" not implemented in location filter'));return u(s,t,n)}}}})).actions((function(e){return{setFirstNumber:function(t){e.firstNumber=Number.isNaN(t)||"number"!==typeof t?void 0:t},setSecondNumber:function(t){e.secondNumber=Number.isNaN(t)||"number"!==typeof t?void 0:t},setOperation:function(t){e.operation=t}}})).volatile((function(){return{ReactComponent:di}})),pi={Number:qa("Number",{compare:function(e,t){return parseFloat(e.text)-parseFloat(t.text)},FilterModelType:fi}),Text:oi,LocString:ei,LocRef:si,LocStart:qa("LocStart",{categoryName:"Location",displayName:"Start",compare:function(e,t){return parseFloat(e.text)-parseFloat(t.text)},FilterModelType:v.types.compose(fi,v.types.model({type:v.types.literal("LocStart")}))}),LocEnd:qa("LocEnd",{categoryName:"Location",displayName:"End",compare:function(e,t){return parseFloat(e.text)-parseFloat(t.text)},FilterModelType:v.types.compose(fi,v.types.model({type:v.types.literal("LocEnd")}))})},hi=Object.values(pi),gi=v.types.union.apply(v.types,hi),mi=v.types.union.apply(v.types,(0,xe.Z)(hi.map((function(e){return e.create({type:e.properties.type.value}).FilterModelType})).filter((function(e){return!!e})))),vi=v.types.model("SpreadsheetCell",{text:v.types.string,extendedData:v.types.maybe(v.types.frozen())}),yi=v.types.model("SpreadsheetRow",{id:v.types.identifier,cells:v.types.array(vi),extendedData:v.types.maybe(v.types.frozen()),isSelected:!1}).actions((function(e){return{toggleSelect:function(){e.isSelected=!e.isSelected},unSelect:function(){e.isSelected=!1},select:function(){e.isSelected=!0},setExtendedData:function(t){e.extendedData=t}}})).views((function(e){return{get cellsWithDerived(){var t=(0,v.getParent)(e,3).columns,n=0;return t.map((function(t){return t.isDerived?t.expr.evalSync({row:e}):e.cells[n++]}))}}})),bi=v.types.model("StaticRowSet",{isLoaded:v.types.literal(!0),rows:v.types.array(yi)}).views((function(e){return{get count(){return e.rows.length},get passingFiltersCount(){return this.sortedFilteredRows.length},get selectedCount(){return this.selectedRows.length},get selectedAndPassingFiltersCount(){return this.selectedFilteredRows.length},get sortedRows(){var t=(0,v.getParent)(e);return(0,xe.Z)(e.rows).sort(t.rowSortingComparisonFunction)},get selectedRows(){return e.rows.filter((function(e){return e.isSelected}))},get selectedFilteredRows(){var t=(0,v.getParent)(e),n=(0,v.getParent)(t).filterControls;return this.selectedRows.filter((function(e){return n.rowPassesFilters(t,e)}))},get sortedFilteredRows(){var t=(0,v.getParent)(e),n=(0,v.getParent)(t).filterControls;return e.rows.filter((function(e){return n.rowPassesFilters(t,e)})).sort(t.rowSortingComparisonFunction)}}})).actions((function(e){return{unselectAll:function(){e.rows.forEach((function(e){return e.unSelect()}))}}})),wi=bi,xi=v.types.model("ColumnDefinition",{name:v.types.maybe(v.types.string),dataType:v.types.optional(gi,(function(){return{type:"Text"}})),isDerived:!1,derivationFunctionText:v.types.maybe(v.types.string)}).views((function(e){return{get expr(){if(e.isDerived)return(0,Ea.P)(String(e.derivationFunctionText),(0,m.getEnv)(e).pluginManager.jexl)}}}));var ki=v.types.model("Spreadsheet",{rowSet:v.types.optional(wi,(function(){return wi.create()})),columns:v.types.array(xi),columnDisplayOrder:v.types.array(v.types.number),hasColumnNames:!1,sortColumns:v.types.array(v.types.model("SortColumns",{columnNumber:v.types.number,descending:!1}).actions((function(e){return{switchDirection:function(){e.descending=!e.descending}}}))),assemblyName:v.types.maybe(v.types.string)}).volatile((function(){return{defaultDataType:pi.Text,rowMenuPosition:null,isLoaded:!1}})).views((function(e){return{get initialized(){var t,n=(0,m.getSession)(e),r=e.assemblyName;return!!r&&(null===(t=n.assemblyManager.get(r))||void 0===t?void 0:t.initialized)},get hideRowSelection(){return(0,v.getParent)(e).hideRowSelection},get dataTypeChoices(){return Object.keys(pi).map((function(e){var t=pi[e].create({type:e});return{typeName:e,displayName:t.displayName,categoryName:t.categoryName}}))},rowSortingComparisonFunction:function(t,n){var r,a=(0,Tt.Z)(e.sortColumns);try{for(a.s();!(r=a.n()).done;){var i=r.value,o=i.columnNumber,s=i.descending,u=e.columns[o].dataType.compare(t.cellsWithDerived[o],n.cellsWithDerived[o]);if(u)return s?-u:u}}catch(c){a.e(c)}finally{a.f()}return 0}}})).actions((function(e){return{afterAttach:function(){var t=this;(0,v.addDisposer)(e,(0,ke.autorun)((0,g.Z)((0,p.Z)().mark((function n(){var r,a;return(0,p.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=(0,m.getSession)(e),a=r.assemblyManager,n.prev=2,!e.assemblyName){n.next=7;break}return n.next=6,a.waitForAssembly(e.assemblyName);case 6:t.setLoaded(!0);case 7:n.next=12;break;case 9:n.prev=9,n.t0=n.catch(2),r.notify("failed to load assembly ".concat(e.assemblyName," ").concat(n.t0),"error");case 12:case"end":return n.stop()}}),n,null,[[2,9]])})))))},setLoaded:function(t){e.isLoaded=t},setRowMenuPosition:function(t){e.rowMenuPosition=t},setSortColumns:function(t){t&&(e.sortColumns=t)},setColumnType:function(t,n){e.columns[t].dataType={type:n}},unselectAll:function(){return e.rowSet.unselectAll()}}})),Zi=3e7,Ci=["CSV","TSV","VCF","BED","BEDPE","STAR-Fusion"],Si={CSV:function(){return n.e(5997).then(n.bind(n,45997)).then((function(e){return e.parseCsvBuffer}))},TSV:function(){return n.e(5997).then(n.bind(n,45997)).then((function(e){return e.parseTsvBuffer}))},VCF:function(){return n.e(5098).then(n.bind(n,25098)).then((function(e){return e.parseVcfBuffer}))},BED:function(){return n.e(847).then(n.bind(n,90847)).then((function(e){return e.parseBedBuffer}))},BEDPE:function(){return n.e(847).then(n.bind(n,90847)).then((function(e){return e.parseBedPEBuffer}))},"STAR-Fusion":function(){return n.e(2533).then(n.bind(n,32533)).then((function(e){return e.parseSTARFusionBuffer}))}},Ti=new RegExp("\\.(".concat(Ci.join("|"),")(\\.gz)?$"),"i");var Pi=v.types.model("SpreadsheetImportWizard",{fileType:v.types.optional(v.types.enumeration(Ci),"CSV"),hasColumnNameLine:!0,columnNameLineNumber:1,selectedAssemblyName:v.types.maybe(v.types.string)}).volatile((function(){return{fileTypes:Ci,fileSource:void 0,error:void 0,loading:!1}})).views((function(e){return{get isReadyToOpen(){return!e.error&&e.fileSource&&(e.fileSource.blobId||e.fileSource.localPath||e.fileSource.uri)},get canCancel(){return(0,v.getParent)(e).readyToDisplay},get fileName(){return e.fileSource.uri||e.fileSource.localPath||e.fileSource.blobId&&e.fileSource.name},get requiresUnzip(){return this.fileName.endsWith("gz")},isValidRefName:function(t,n){var r=(0,m.getSession)(e).assemblyManager;return!!n&&r.isValidRefName(t,n)}}})).actions((function(e){return{setSelectedAssemblyName:function(t){e.selectedAssemblyName=t},setFileSource:function(t){if(e.fileSource=t,e.error=void 0,e.fileSource){var n=e.fileName;if(n){var r,a=null===(r=Ti.exec(n))||void 0===r?void 0:r[1];a&&(e.fileType="tsv"===a&&n.includes("star-fusion")?"STAR-Fusion":a.toUpperCase())}}},toggleHasColumnNameLine:function(){e.hasColumnNameLine=!e.hasColumnNameLine},setColumnNameLineNumber:function(t){t>0&&(e.columnNameLineNumber=t)},setFileType:function(t){e.fileType=t},setError:function(t){console.error(t),e.loading=!1,e.error=t},setLoaded:function(){e.loading=!1,e.error=void 0},cancelButton:function(){e.error=void 0,(0,v.getParent)(e).setDisplayMode()},import:function(t){var r=this;return(0,g.Z)((0,p.Z)().mark((function a(){var i,o,s,u,c,l,d;return(0,p.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.fileSource){a.next=2;break}return a.abrupt("return");case 2:if(!e.loading){a.next=4;break}throw new Error("Cannot import, load already in progress");case 4:return e.selectedAssemblyName=t,e.loading=!0,i=e.fileType,a.next=9,Si[i]();case 9:if(o=a.sent){a.next=12;break}throw new Error("cannot open files of type '".concat(e.fileType,"'"));case 12:return a.next=14,Promise.all([n.e(6700),n.e(2098)]).then(n.bind(n,42098));case 14:return s=a.sent,u=s.unzip,c=(0,m.getEnv)(e),l=c.pluginManager,d=(0,te.openLocation)(e.fileSource,l),a.prev=18,a.next=21,d.stat();case 21:if(!(a.sent.size>Zi)){a.next=24;break}throw new Error("File is too big. Tabular files are limited to at most ".concat(3e4.toLocaleString(),"kb."));case 24:a.next=29;break;case 26:a.prev=26,a.t0=a.catch(18),console.warn(a.t0);case 29:return a.prev=29,a.next=32,d.readFile().then((function(t){return e.requiresUnzip?u(t):t})).then((function(t){return o(t,e)})).then((function(t){r.setLoaded(),(0,v.getParent)(e).displaySpreadsheet(t)}));case 32:a.next=37;break;case 34:a.prev=34,a.t1=a.catch(29),r.setError(a.t1);case 37:case"end":return a.stop()}}),a,null,[[18,26],[29,34]])})))()}}})),Mi=v.types.model("RowFullTextFilter",{type:v.types.literal("RowFullText"),stringToFind:""}).views((function(e){return{get predicate(){var t=e.stringToFind;return t?(t=t.toLowerCase(),function(e,n){var r,a=n.cellsWithDerived,i=(0,Tt.Z)(a);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o.text&&o.text.toLowerCase().includes(t))return!0}}catch(s){i.e(s)}finally{i.f()}return!1}):function(){return!0}}}})).actions((function(e){return{setString:function(t){e.stringToFind=t},clear:function(){e.stringToFind=""}}})),Ri=v.types.model("SpreadsheetFilterControls",{rowFullText:v.types.optional(Mi,(function(){return{type:"RowFullText",stringToFind:""}})),columnFilters:v.types.array(mi)}).views((function(e){return{get filters(){return[e.rowFullText].concat((0,xe.Z)(e.columnFilters)).filter((function(e){return!!e}))},setRowFullTextFilter:function(t){e.rowFullText={type:"RowFullText",stringToFind:t}},rowPassesFilters:function(e,t){var n,r=(0,Tt.Z)(this.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.predicate(e,t))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}}})).actions((function(e){return{addBlankColumnFilter:function(t){var n=(0,v.getParent)(e).spreadsheet.columns[t].dataType;e.columnFilters.push({type:n.type,columnNumber:t})},removeColumnFilter:function(t){return e.columnFilters.remove(t)},clearAllFilters:function(){e.columnFilters.clear(),e.rowFullText.clear()}}})),Ai=Ri,Ii=[{label:"Toggle select",icon:Ba.Z,onClick:function(e,t){var n,r=null===(n=t.rowMenuPosition)||void 0===n?void 0:n.rowNumber;void 0!==r&&t.rowSet.rows[+r-1].toggleSelect()}}];var Li=v.types.model("SpreadsheetView",{type:v.types.literal("SpreadsheetView"),offsetPx:0,height:v.types.optional(v.types.refinement("SpreadsheetViewHeight",v.types.number,(function(e){return e>=40})),440),hideVerticalResizeHandle:!1,hideFilterControls:!1,filterControls:v.types.optional(Ai,(function(){return Ai.create({})})),mode:v.types.optional(v.types.enumeration("SpreadsheetViewMode",["import","display"]),"import"),importWizard:v.types.optional(Pi,(function(){return Pi.create()})),spreadsheet:v.types.maybe(ki)}).volatile((function(){return{width:400,rowMenuItems:Ii}})).views((function(e){return{get readyToDisplay(){return!!e.spreadsheet&&e.spreadsheet.isLoaded},get hideRowSelection(){return!!(0,v.getEnv)(e).hideRowSelection},get outputRows(){if(e.spreadsheet&&e.spreadsheet.rowSet.isLoaded){var t=e.spreadsheet.rowSet.selectedFilteredRows;return t.length?t:e.spreadsheet.rowSet.sortedFilteredRows}},get assembly(){var t,n=null===(t=e.spreadsheet)||void 0===t?void 0:t.assemblyName;if(n){var r=(0,m.getSession)(e).assemblies;return null===r||void 0===r?void 0:r.find((function(e){return(0,l.readConfObject)(e,"name")===n}))}}}})).actions((function(e){return{setRowMenuItems:function(t){e.rowMenuItems=t},setWidth:function(t){return e.width=t,e.width},setHeight:function(t){return e.height=t>40?t:40,e.height},resizeHeight:function(t){var n=e.height;return this.setHeight(e.height+t)-n},resizeWidth:function(t){var n=e.width;return this.setWidth(e.width+t)-n},displaySpreadsheet:function(t){e.filterControls.clearAllFilters(),e.spreadsheet=(0,v.cast)(t),e.mode="display"},setImportMode:function(){e.mode="import"},setDisplayMode:function(){e.readyToDisplay&&(e.mode="display")},closeView:function(){(0,v.getParent)(e,2).removeView(e)}}})).views((function(e){return{menuItems:function(){return[{label:"Return to import form",onClick:function(){return e.setImportMode()},icon:Ue.Z}]}}})),Ni=v.types.compose(d.BaseViewModel,Li),Fi=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="SpreadsheetViewPlugin",e}return(0,i.Z)(r,[{key:"install",value:function(e){!function(e){e.addViewType((function(){return new ge.ViewType({name:"SpreadsheetView",displayName:"Spreadsheet view",stateModel:Ni,ReactComponent:(0,I.lazy)((function(){return Promise.all([n.e(6962),n.e(7038),n.e(3)]).then(n.bind(n,3))}))})}))}(e),function(e){e.addToExtensionPoint("LaunchView-SpreadsheetView",function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t){var n,r,a,i,o,s,u,c,l;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.session,a=t.assembly,i=t.uri,o=t.fileType,s=r.addView("SpreadsheetView")){e.next=4;break}throw new Error("Failed to initialize view");case 4:return u=i.split("."),"GZ"===(c=null===u||void 0===u||null===(n=u.pop())||void 0===n?void 0:n.toUpperCase())&&(c=null===u||void 0===u||null===(l=u.pop())||void 0===l?void 0:l.toUpperCase()),s.importWizard.setFileType(o||c||""),s.importWizard.setSelectedAssemblyName(a),s.importWizard.setFileSource({uri:i,locationType:"UriLocation"}),e.next=12,s.importWizard.import(a);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}(e)}},{key:"configure",value:function(e){var t=e.rootModel;(0,m.isAbstractMenuManager)(t)&&t.appendToSubMenu(["Add"],{label:"Spreadsheet view",icon:Da.Z,onClick:function(e){e.addView("SpreadsheetView",{})}})}}]),r}(u.Z),ji=n(8438),Di=n(59322),Bi=n(3994),Ei=n(49884),Vi=n(88876),zi=(0,st.ZL)()((function(e){return{circularViewOptions:{padding:e.spacing(1)}}})),Oi=(0,ct.observer)((function(e){var t=e.svInspector,n=zi().classes;return(0,B.jsx)(Bi.ZP,{container:!0,className:n.circularViewOptions,style:{height:t.circularViewOptionsBarHeight},children:(0,B.jsx)(Bi.ZP,{item:!0,children:(0,B.jsx)(Ei.Z,{control:(0,B.jsx)(Vi.Z,{checked:t.onlyDisplayRelevantRegionsInCircularView,onChange:function(e){return t.setOnlyDisplayRelevantRegionsInCircularView(e.target.checked)}}),label:"show only regions with data"})})})})),Wi=(0,st.ZL)()((function(e){return{resizeHandleVert:{background:e.palette.action.selected,width:4,boxSizing:"border-box",borderTop:"1px solid #fafafa"},resizeHandleHoriz:{background:e.palette.action.selected,height:4,boxSizing:"border-box",borderTop:"1px solid #fafafa"},viewControls:{margin:0},viewsContainer:{display:"flex"},container:{overflow:"hidden"}}})),Hi=(0,ct.observer)((function(e){var t=e.model,n=Wi().classes,r=t.SpreadsheetViewReactComponent,a=t.CircularViewReactComponent,i=t.showCircularView;return(0,B.jsxs)("div",{className:n.container,children:[(0,B.jsxs)("div",{className:n.viewsContainer,children:[(0,B.jsx)("div",{style:{width:t.spreadsheetView.width},className:n.container,children:(0,B.jsx)(r,{model:t.spreadsheetView})}),i?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(D.ResizeHandle,{onDrag:function(e){var n=t.circularView.resizeWidth(-e);return t.spreadsheetView.resizeWidth(-n)},vertical:!0,flexbox:!0,className:n.resizeHandleVert}),(0,B.jsxs)("div",{style:{width:t.circularView.width},children:[(0,B.jsx)(Oi,{svInspector:t}),(0,B.jsx)(a,{model:t.circularView})]})]}):null]}),(0,B.jsx)(D.ResizeHandle,{onDrag:t.resizeHeight,className:n.resizeHandleHoriz})]})})),Gi=Hi,qi=n(16374);function _i(e,t,n,r,a,i){var o={};return e.forEach((function(e,r){if(!t.includes(r)){var a=n.cells[r].text;"Number"===e.dataType.type&&(a=parseFloat(a)),o[e.name]=a}})),(0,h.Z)((0,h.Z)({},o),{},{uniqueId:"sv-inspector-adhoc-".concat(i),refName:r.refName,start:r.start,end:r.end,mate:{refName:a.refName,start:a.start,end:a.end}})}function Ui(e,t,n,r){var a=e.columns,i=e.columnDisplayOrder,o={};i.forEach((function(e){var t=a[e];o[t.dataType.type]||(o[t.dataType.type]=[]),o[t.dataType.type].push(e)}));var s=o.LocString||[],u=o.LocStart||[],c=o.LocEnd||[],l=o.LocRef||[];return s.length>=2?function(e,t,n,r,a){var i=(0,m.parseLocString)(n.cells[t[0]].text,a),o=(0,m.parseLocString)(n.cells[t[1]].text,a);return _i(e,[t[0],t[1]],n,i,o,r)}(a,s,n,t,r):l.length>=2&&u.length>=2&&c.length>=2?function(e,t,n,r,a,i){var o=function(e){return a.cells[e].text},s={refName:o(t[0]),start:parseInt(o(n[0]),10)-1,end:parseInt(o(r[0]),10)},u={refName:o(t[1]),start:parseInt(o(n[1]),10)-1,end:parseInt(o(r[1]),10)};return _i(e,[t[0],n[0],r[0],t[1],n[1],r[1]],a,s,u,i)}(a,l,u,c,n,t):void 0}function Ji(e,t,n,r){var a,i;return(null===(a=n.extendedData)||void 0===a?void 0:a.vcfFeature)||(null===(i=n.extendedData)||void 0===i?void 0:i.feature)||Ui(t.spreadsheet,r,n,e.assemblyManager.isValidRefName)}function Xi(e,t,n,r,a){var i=(0,m.getEnv)(e).pluginManager,o=(0,m.getSession)(t),s=Ji(o,n,r,a);if(s){var u=new m.SimpleFeature(s);return o.setSelection(u),i.getViewType("BreakpointSplitView").snapshotFromBreakendFeature(u,e.circularView)}}var Yi=function(e){var t=e.getViewType("SpreadsheetView"),n=e.getViewType("CircularView"),r=t.stateModel,a=n.stateModel;return v.types.compose(d.BaseViewModel,v.types.model("SvInspectorView",{id:he.ElementId,type:v.types.literal("SvInspectorView"),height:v.types.optional(v.types.refinement("SvInspectorViewHeight",v.types.number,(function(e){return e>=400})),550),onlyDisplayRelevantRegionsInCircularView:!1,mode:v.types.optional(v.types.enumeration("SvInspectorViewMode",["import","display"]),"import"),spreadsheetView:v.types.optional(r,(function(){return r.create({type:"SpreadsheetView",hideVerticalResizeHandle:!0})})),circularView:v.types.optional(a,(function(){return a.create({type:"CircularView",hideVerticalResizeHandle:!0,hideTrackSelectorButton:!0,disableImportForm:!0})}))})).volatile((function(){return{width:800}})).views((function(e){return{get selectedRows(){return e.spreadsheetView.rowSet.selectedRows},get assemblyName(){var t=e.spreadsheetView.assembly;return t?(0,l.readConfObject)(t,"name"):void 0},get showCircularView(){return"display"===e.spreadsheetView.mode},get features(){var t=(0,m.getSession)(e),n=e.spreadsheetView,r=n.outputRows;return(void 0===r?[]:r).map((function(e,r){return Ji(t,n,e,r)})).filter((function(e){return!!e}))},get featuresAdapterConfigSnapshot(){return{type:"FromConfigAdapter",features:this.features}},get featureRefNames(){var e=this.features.map((function(e){return e.refName})),t=this.features.flatMap((function(e){var t;return null===(t=e.INFO)||void 0===t?void 0:t.CHR2})).filter((function(e){return!!e}));return[].concat((0,xe.Z)(e),(0,xe.Z)(t))},get featuresCircularTrackConfiguration(){return{type:"VariantTrack",trackId:"sv-inspector-variant-track-".concat(e.id),name:"features from tabular data",adapter:this.featuresAdapterConfigSnapshot,assemblyNames:[this.assemblyName],displays:[{type:"ChordVariantDisplay",displayId:"sv-inspector-variant-track-chord-display-".concat(e.id),onChordClick:"jexl:defaultOnChordClick(feature, track, pluginManager)",renderer:{type:"StructuralVariantChordRenderer"}}]}}}})).volatile((function(){return{SpreadsheetViewReactComponent:t.ReactComponent,CircularViewReactComponent:n.ReactComponent,circularViewOptionsBarHeight:52}})).actions((function(e){return{setWidth:function(t){e.width=t},setHeight:function(t){return e.height=t>400?t:400,e.height},setImportMode:function(){e.spreadsheetView.setImportMode()},setDisplayMode:function(){e.spreadsheetView.setDisplayMode()},closeView:function(){(0,v.getParent)(e,2).removeView(e)},setDisplayedRegions:function(t){e.circularView.setDisplayedRegions(t)},setOnlyDisplayRelevantRegionsInCircularView:function(t){e.onlyDisplayRelevantRegionsInCircularView=Boolean(t)}}})).views((function(e){return{menuItems:function(){return[{label:"Return to import form",onClick:function(){return e.setImportMode()},icon:Ue.Z}]}}})).actions((function(e){return{resizeHeight:function(t){var n=e.height;return e.setHeight(e.height+t)-n},afterAttach:function(){(0,v.addDisposer)(e,(0,ke.autorun)((function(){if(e.showCircularView){var t=Math.round(.66*e.width),n=e.width-t;e.spreadsheetView.setWidth(t-1),e.circularView.setWidth(n)}else e.spreadsheetView.setWidth(e.width)}),{name:"SvInspectorView width binding"})),(0,v.addDisposer)(e,(0,ke.autorun)((function(){e.spreadsheetView.setHeight(e.height-52),e.circularView.setHeight(e.height-52-52)}),{name:"SvInspectorView height binding"})),(0,v.addDisposer)(e,(0,ke.autorun)((0,g.Z)((0,p.Z)().mark((function t(){var n,r,a,i,o,s,u,c,l,d,f,h;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.assemblyName,r=e.onlyDisplayRelevantRegionsInCircularView,a=e.circularView,i=e.featureRefNames,o=a.tracks,s=(0,m.getSession)(e),u=s.assemblyManager,n){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,u.waitForAssembly(n);case 7:if(c=t.sent){t.next=10;break}return t.abrupt("return");case 10:if(l=c.getCanonicalRefName,d=c.regions,f=void 0===d?[]:d,r){if(1===o.length)try{h=new Set(i.map((function(e){return l(e)||e}))),a.setDisplayedRegions(vt()(f.filter((function(e){return h.has(e.refName)}))))}catch(p){a.setError(p)}}else a.setDisplayedRegions(f);case 12:case"end":return t.stop()}}),t)}))),{name:"SvInspectorView displayed regions bind"})),(0,v.addDisposer)(e,(0,ke.reaction)((function(){return{generatedTrackConf:null===e||void 0===e?void 0:e.featuresCircularTrackConfiguration,assemblyName:null===e||void 0===e?void 0:e.assemblyName}}),(function(t){if(t){var n=t.assemblyName,r=t.generatedTrackConf,a=e.circularView;a.tracks.forEach((function(e){return a.hideTrack(e.configuration.trackId)})),n&&r&&a.addTrackConf(r,{assemblyName:n})}}),{name:"SvInspectorView track configuration binding",fireImmediately:!0})),(0,v.addDisposer)(e,(0,ke.autorun)((function(){e.spreadsheetView.setRowMenuItems([{label:"Open split detail view",icon:qi.Z,disabled:function(t,n,r,a){return!function(e,t,n,r,a){try{return Boolean(Xi(e,t,n,r,a))}catch(i){return console.error("Unable to open breakpoint split view from table row",i),!1}}(e,t,n,a,r)},onClick:function(t,n,r,a){!function(e,t,n,r,a){var i=Xi(e,t,n,r,a);if(i){var o=e.circularView;i.views[0].offsetPx-=o.width/2+100,i.views[1].offsetPx-=o.width/2+100,(0,m.getSession)(t).addView("BreakpointSplitView",i)}}(e,t,n,a,r)}}])})))}}}))};function Qi(e,t,n){var r=(0,m.getSession)(t);r.setSelection(e);var a=(0,m.getContainingView)(t),i=n.getViewType("BreakpointSplitView").snapshotFromBreakendFeature(e,a);i.views[0].offsetPx-=a.width/2+100,i.views[1].offsetPx-=a.width/2+100,i.featureData=e.toJSON(),r.addView("BreakpointSplitView",i)}var Ki=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="SvInspectorViewPlugin",e}return(0,i.Z)(n,[{key:"install",value:function(e){!function(e){e.jexl.addFunction("defaultOnChordClick",Qi),e.addViewType((function(){var t=Yi(e);return new ye.Z({name:"SvInspectorView",displayName:"SV inspector",stateModel:t,ReactComponent:Gi})}))}(e),function(e){e.addToExtensionPoint("LaunchView-SvInspectorView",function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t){var n,r,a,i,o,s,u,c,l;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.session,a=t.assembly,i=t.uri,o=t.fileType,s=r.addView("SvInspectorView")){e.next=4;break}throw new Error("Failed to initialize view");case 4:return u=i.split("."),"GZ"===(c=null===u||void 0===u||null===(n=u.pop())||void 0===n?void 0:n.toUpperCase())&&(c=null===u||void 0===u||null===(l=u.pop())||void 0===l?void 0:l.toUpperCase()),s.spreadsheetView.importWizard.setFileType(o||c||""),s.spreadsheetView.importWizard.setSelectedAssemblyName(a),s.spreadsheetView.importWizard.setFileSource({uri:i,locationType:"UriLocation"}),e.next=12,s.spreadsheetView.importWizard.import(a);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}(e)}},{key:"configure",value:function(e){(0,ji.J0)(e.rootModel)&&e.rootModel.appendToSubMenu(["Add"],{label:"SV inspector",icon:Di.Z,onClick:function(e){e.addView("SvInspectorView",{})}})}}]),n}(u.Z),$i=n(10346),eo=(0,ct.observer)((function(e){var t=e.width,n=e.height,r=Math.ceil(t);return(0,B.jsx)("div",{style:{position:"relative",width:r,height:n},children:(0,B.jsx)(D.PrerenderedCanvas,(0,h.Z)((0,h.Z)({},e),{},{style:{position:"absolute",left:0,top:0}}))})}));var to=(0,l.ConfigurationSchema)("HicRenderer",{baseColor:{type:"color",description:"base color to be used in the hic alignment",defaultValue:"#f00"},color:{type:"color",description:"the color of each feature in a hic alignment",defaultValue:"jexl:colorString(hsl(alpha(baseColor,min(1,count/(maxScore/20)))))",contextVariable:["count","maxScore","baseColor"]},maxHeight:{type:"integer",description:"the maximum height to be used in a hic rendering",defaultValue:600}},{explicitlyTyped:!0}),no=n(67688),ro=n(54306),ao=n(95915),io=n(3011),oo=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).supportsSVG=!0,e}return(0,i.Z)(n,[{key:"makeImageData",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t,n){var r,a,i,o,s,u,c,d,f,h,g,v,y,b,w,x,k,Z,C,S,T,P,M,R,I,L,N,F,j,D,B,E,V;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.features,a=n.config,i=n.bpPerPx,o=n.signal,s=n.resolution,u=n.sessionId,c=n.adapterConfig,d=n.regions,f=(0,A.Z)(d,1),h=f[0],e.next=4,(0,io.uP)(this.pluginManager,u,c);case 4:return g=e.sent,v=g.dataAdapter,e.next=8,v.getResolution(i/s);case 8:if(y=e.sent,b=y/(i*Math.sqrt(2)),w=(0,$i.V)((0,l.readConfObject)(a,"baseColor")),!r.length){e.next=47;break}return x=function(){t.scale(-1,1);var e=(h.end-h.start)/i;t.translate(-e,0)},k=r[0].bin1,Z=0,C=0,S=0,e.next=19,(0,m.abortBreakPoint)(o);case 19:T=(0,Tt.Z)(r);try{for(T.s();!(P=T.n()).done;)M=P.value,R=M.bin1,I=M.bin2,L=M.counts,Z=Math.max(L,Z),C=Math.min(Math.min(R,I),C),S=Math.max(Math.max(R,I),S)}catch(p){T.e(p)}finally{T.f()}return e.next=23,(0,m.abortBreakPoint)(o);case 23:!0===h.reversed&&x(),t.rotate(-Math.PI/4),N=Date.now(),F=(0,Tt.Z)(r),e.prev=27,F.s();case 29:if((j=F.n()).done){e.next=39;break}if(D=j.value,B=D.bin1,E=D.bin2,V=D.counts,t.fillStyle=(0,l.readConfObject)(a,"color",{count:V,maxScore:Z,baseColor:w}),t.fillRect((B-k)*b,(E-k)*b,b,b),!(+Date.now()-N>400)){e.next=37;break}return e.next=36,(0,m.abortBreakPoint)(o);case 36:N=+Date.now();case 37:e.next=29;break;case 39:e.next=44;break;case 41:e.prev=41,e.t0=e.catch(27),F.e(e.t0);case 44:return e.prev=44,F.f(),e.finish(44);case 47:case"end":return e.stop()}}),e,this,[[27,41,44,47]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t){var r,a,i,o,s,u,c,d,f,g,m=this;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.config,a=t.regions,i=t.bpPerPx,o=(0,A.Z)(a,1),s=o[0],u=(s.end-s.start)/i,c=(0,l.readConfObject)(r,"maxHeight"),e.next=6,this.getFeatures(t);case 6:return d=e.sent,e.next=9,(0,ro.Cj)(u,c,t,(function(e){return m.makeImageData(e,(0,h.Z)((0,h.Z)({},t),{},{features:d}))}));case 9:return f=e.sent,e.next=12,(0,$.Z)((0,ee.Z)(n.prototype),"render",this).call(this,(0,h.Z)((0,h.Z)((0,h.Z)({},t),f),{},{features:d,region:t.regions[0],height:c,width:u}));case 12:return g=e.sent,e.abrupt("return",(0,h.Z)((0,h.Z)((0,h.Z)({},g),f),{},{height:c,width:u}));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getFeatures",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t){var n,r,a,i,o,s;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.regions,r=t.sessionId,a=t.adapterConfig,e.next=3,(0,io.uP)(this.pluginManager,r,a);case 3:return i=e.sent,o=i.dataAdapter,e.next=7,o.getFeatures(n[0],t).pipe((0,ao.q)()).toPromise();case 7:return s=e.sent,e.abrupt("return",s);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(no.default);var so=function(e){return(0,l.ConfigurationSchema)("HicTrack",{},{baseConfiguration:(0,ge.createBaseTrackConfig)(e)})};var uo=function(e){return(0,l.ConfigurationSchema)("LinearHicDisplay",{renderer:e.getRendererType("HicRenderer").configSchema},{baseConfiguration:mn.fU,explicitlyTyped:!0})};var co=function(e){return v.types.compose("LinearHicDisplay",mn.fV,v.types.model({type:v.types.literal("LinearHicDisplay"),configuration:(0,l.ConfigurationReference)(e),resolution:v.types.optional(v.types.number,1)})).views((function(e){var t=e.renderProps;return{get blockType(){return"dynamicBlocks"},get rendererTypeName(){return"HicRenderer"},renderProps:function(){var n=e.rendererType.configSchema.create((0,l.getConf)(e,"renderer")||{},(0,v.getEnv)(e));return(0,h.Z)((0,h.Z)({},t()),{},{config:n,rpcDriverName:e.rpcDriverName,displayModel:e,resolution:e.resolution})}}})).actions((function(e){return{setResolution:function(t){e.resolution=t}}})).views((function(e){var t=e.trackMenuItems;return{trackMenuItems:function(){return[].concat((0,xe.Z)(t()),[{label:"Resolution",subMenu:[{label:"Finer resolution",onClick:function(){e.setResolution(2*e.resolution)}},{label:"Coarser resolution",onClick:function(){e.setResolution(e.resolution/2)}}]}])}}}))};var lo=(0,l.ConfigurationSchema)("HicAdapter",{hicLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.hic",locationType:"UriLocation"}}},{explicitlyTyped:!0}),fo=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="HicPlugin",e}return(0,i.Z)(r,[{key:"install",value:function(e){!function(e){e.addAdapterType((function(){return new ge.AdapterType({name:"HicAdapter",displayName:"Hi-C adapter",configSchema:lo,getAdapterClass:function(){return Promise.all([n.e(3980),n.e(3212)]).then(n.bind(n,43212)).then((function(e){return e.default}))}})}))}(e),function(e){e.addRendererType((function(){return new oo({name:"HicRenderer",ReactComponent:eo,configSchema:to,pluginManager:e})}))}(e),function(e){e.addTrackType((function(){var t=so(e);return new En.Z({name:"HicTrack",displayName:"Hi-C track",configSchema:t,stateModel:(0,d.createBaseTrackModel)(e,"HicTrack",t)})}))}(e),function(e){e.addDisplayType((function(){var t=uo(e);return new ge.DisplayType({name:"LinearHicDisplay",displayName:"Hi-C contact matrix display",configSchema:t,stateModel:co(t),trackType:"HicTrack",viewType:"LinearGenomeView",ReactComponent:mn.qb})}))}(e),e.addToExtensionPoint("Core-guessAdapterForLocation",(function(e){return function(t,n,r){var a="HicAdapter",i=(0,fe.getFileName)(t),o={type:a,hicLocation:t};return/\.hic/i.test(i)&&!r||r===a?o:e(t,n,r)}})),e.addToExtensionPoint("Core-guessTrackTypeForLocation",(function(e){return function(t){return"HicAdapter"===t?"HicTrack":e(t)}}))}},{key:"configure",value:function(e){var t=e.jexl;t.addFunction("alpha",(function(e,t){return e.alpha(t)})),t.addFunction("hsl",(function(e){return(0,$i.V)(e.toHsl())})),t.addFunction("colorString",(function(e){return e.toHex()}))}}]),r}(u.Z),po=n(46840),ho=n(36806);function go(e){try{return decodeURIComponent(e)}catch(t){return e}}function mo(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15,r=e.toLowerCase().indexOf(t);return e.length<40?e:(Math.max(0,r-n)>0?"...":"")+e.slice(Math.max(0,r-n),r+t.length+n).trim()+(r+t.length<e.length?"...":"")}var vo=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e,r,i){var o;(0,a.Z)(this,n),(o=t.call(this,e,r,i)).indexingAttributes=void 0,o.trixJs=void 0,o.tracksNames=void 0;var s=(0,l.readConfObject)(e,"ixFilePath"),u=(0,l.readConfObject)(e,"ixxFilePath");if(!s)throw new Error("must provide out.ix");if(!u)throw new Error("must provide out.ixx");return o.trixJs=new ho.Z((0,te.openLocation)(u,i),(0,te.openLocation)(s,i),1500),o}return(0,i.Z)(n,[{key:"searchIndex",value:function(){var e=(0,g.Z)((0,p.Z)().mark((function e(t){var n,r,a,i;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.queryString.toLowerCase(),r=n.split(" "),e.next=4,this.trixJs.search(n);case 4:return a=e.sent,i=a.filter((function(e){var t=(0,A.Z)(e,2)[1];return r.every((function(e){return go(t).toLowerCase().includes(e)}))})).map((function(e){var t=(0,A.Z)(e,2),n=t[0],r=t[1],a=JSON.parse(r.replaceAll("|",",")),i=a.map((function(e){return go(e)})),o=(0,po.Z)(i),s=o[0],u=o[1],c=o.slice(2),l=c.findIndex((function(e){return!!e})),d=c.map((function(e){return e.toLowerCase()})).findIndex((function(e){return e.includes(n.toLowerCase())})),f=c[l],p=c[d],h=-1!==d?mo(p,n):void 0,g=mo(f,n),m=h&&g.toLowerCase()!==h.toLowerCase()?"".concat(g," (").concat(h,")"):g;return new an.Z({locString:s,label:f,displayString:m,matchedObject:a.map((function(e){return decodeURIComponent(e)})),trackId:u})})),e.abrupt("return","exact"===t.searchType?i.filter((function(e){return e.getLabel().toLowerCase()===t.queryString.toLowerCase()})):i);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"freeResources",value:function(){}}]),n}(rn.BaseAdapter);var yo=(0,l.ConfigurationSchema)("TrixTextSearchAdapter",{ixFilePath:{type:"fileLocation",defaultValue:{uri:"out.ix",locationType:"UriLocation"},description:"the location of the trix ix file"},ixxFilePath:{type:"fileLocation",defaultValue:{uri:"out.ixx",locationType:"UriLocation"},description:"the location of the trix ixx file"},metaFilePath:{type:"fileLocation",defaultValue:{uri:"meta.json",locationType:"UriLocation"},description:"the location of the metadata json file for the trix index"},tracks:{type:"stringArray",defaultValue:[],description:"List of tracks covered by text search adapter"},assemblyNames:{type:"stringArray",defaultValue:[],description:"List of assemblies covered by text search adapter"}},{explicitlyTyped:!0,explicitIdentifier:"textSearchAdapterId"}),bo=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="TrixPlugin",e}return(0,i.Z)(n,[{key:"install",value:function(e){e.addTextSearchAdapterType((function(){return new nn.Z({name:"TrixTextSearchAdapter",displayName:"Trix text search adapter",configSchema:yo,AdapterClass:vo,description:"Trix adapter"})}))}}]),n}(u.Z),wo=n(63451),xo=n(84385),ko=["bookmarks"],Zo=v.types.compose(he.Region,v.types.model("Label",{label:v.types.optional(v.types.string,"")})).actions((function(e){return{setLabel:function(t){e.label=t}}})),Co=v.types.model("SharedBookmarksModel",{sharedBookmarks:v.types.maybe(v.types.array(Zo))}),So=function(){return void 0!==typeof window?"bookmarks-".concat([window.location.host+window.location.pathname].join("-")):"empty"};var To=(0,l.ConfigurationSchema)("GridBookmarkWidget",{}),Po=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).name="GridBookmarkPlugin",e}return(0,i.Z)(r,[{key:"install",value:function(e){!function(e){e.addWidgetType((function(){return new ge.WidgetType({name:"GridBookmarkWidget",heading:"Bookmarked regions",configSchema:To,stateModel:v.types.model("GridBookmarkModel",{id:he.ElementId,type:v.types.literal("GridBookmarkWidget"),bookmarks:v.types.optional(v.types.array(Zo),(function(){return JSON.parse((0,m.localStorageGetItem)(So())||"[]")}))}).volatile((function(){return{selectedBookmarks:[],selectedAssembliesPre:void 0}})).views((function(e){return{get bookmarkAssemblies(){return(0,xe.Z)(new Set(e.bookmarks.map((function(e){return e.assemblyName}))))},get validAssemblies(){var t=(0,m.getSession)(e).assemblyManager;return new Set(this.bookmarkAssemblies.filter((function(e){return t.get(e)})))}}})).views((function(e){return{get bookmarksWithValidAssemblies(){return e.bookmarks.filter((function(t){return e.validAssemblies.has(t.assemblyName)}))}}})).views((function(e){return{get sharedBookmarksModel(){return Co.create({sharedBookmarks:JSON.parse(JSON.stringify(e.selectedBookmarks))})},get allBookmarksModel(){return Co.create({sharedBookmarks:JSON.parse(JSON.stringify(e.bookmarksWithValidAssemblies))})}}})).actions((function(e){return{setSelectedAssemblies:function(t){e.selectedAssembliesPre=t}}})).views((function(e){return{get selectedAssemblies(){var t,n;return null!==(t=null===(n=e.selectedAssembliesPre)||void 0===n?void 0:n.filter((function(t){return e.validAssemblies.has(t)})))&&void 0!==t?t:(0,xe.Z)(e.validAssemblies)}}})).actions((function(e){return{importBookmarks:function(t){e.bookmarks=(0,v.cast)([].concat((0,xe.Z)(e.bookmarks),(0,xe.Z)(t)))},addBookmark:function(t){e.bookmarks.push(t)},removeBookmark:function(t){e.bookmarks.splice(t,1)},updateBookmarkLabel:function(e,t){e.correspondingObj.setLabel(t)},setSelectedBookmarks:function(t){e.selectedBookmarks=t},setBookmarkedRegions:function(t){e.bookmarks=(0,v.cast)(t)}}})).actions((function(e){return{clearAllBookmarks:function(){var t,n=(0,Tt.Z)(e.bookmarks);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.validAssemblies.has(r.assemblyName)&&e.bookmarks.remove(r)}}catch(a){n.e(a)}finally{n.f()}},clearSelectedBookmarks:function(){var t,n=(0,Tt.Z)(e.selectedBookmarks);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.bookmarks.remove(r.correspondingObj)}}catch(a){n.e(a)}finally{n.f()}e.selectedBookmarks=[]}}})).actions((function(e){return{afterAttach:function(){var t=So();(0,v.addDisposer)(e,(0,ke.autorun)((function(){(0,m.localStorageSetItem)(t,JSON.stringify(e.bookmarks))})))}}})).postProcessSnapshot((function(e){var t=e;return t.bookmarks,(0,Ge.Z)(t,ko)})),ReactComponent:(0,I.lazy)((function(){return Promise.all([n.e(6962),n.e(9563),n.e(772),n.e(9496)]).then(n.bind(n,69496))}))})}))}(e),e.addToExtensionPoint("Core-extendPluggableElement",(function(e){if("LinearGenomeView"===e.name){var t=e.stateModel.actions((function(e){return{activateBookmarkWidget:function(){var t=(0,m.getSession)(e);if((0,m.isSessionModelWithWidgets)(t)){var n=t.widgets.get("GridBookmark");return n||(n=t.addWidget("GridBookmarkWidget","GridBookmark")),t.showWidget(n),t.widgets.get("GridBookmark")}throw new Error("Could not open bookmark widget")}}})).actions((function(e){return{navigateNewestBookmark:function(){var t=(0,m.getSession)(e),n=e.activateBookmarkWidget().bookmarks;null!==n&&void 0!==n&&n.length?e.navTo(n.at(-1)):t.notify("There are no recent bookmarks to navigate to.","info")},bookmarkCurrentRegion:function(){if(e.id===(0,m.getSession)(e).focusedViewId){var t=e.getSelectedRegions(void 0,void 0);e.activateBookmarkWidget().addBookmark(t[0])}}}})).views((function(e){var t=e.menuItems,n=e.rubberBandMenuItems;return{menuItems:function(){return[].concat((0,xe.Z)(t()),[{type:"divider"},{label:"Open bookmark widget",icon:xo.Z,onClick:function(){return e.activateBookmarkWidget()}},{label:"Bookmark current region",icon:wo.Z,onClick:function(){return e.bookmarkCurrentRegion()}}])},rubberBandMenuItems:function(){return[].concat((0,xe.Z)(n()),[{label:"Bookmark region",icon:wo.Z,onClick:function(){var t=e.leftOffset,n=e.rightOffset,r=e.getSelectedRegions(t,n);e.activateBookmarkWidget().addBookmark(r[0])}}])}}})).actions((function(e){return{afterCreate:function(){document.addEventListener("keydown",(function(t){var n=(t.ctrlKey||t.metaKey)&&t.shiftKey;n&&"KeyD"===t.code&&(t.preventDefault(),e.activateBookmarkWidget(),e.bookmarkCurrentRegion(),(0,m.getSession)(e).notify("Bookmark created.","success")),n&&"KeyM"===t.code&&(t.preventDefault(),e.navigateNewestBookmark())}))}}}));e.stateModel=t}return e}))}},{key:"configure",value:function(e){(0,m.isAbstractMenuManager)(e.rootModel)&&e.rootModel.appendToMenu("Tools",{label:"Bookmarks",icon:xo.Z,onClick:function(e){var t=e.widgets.get("GridBookmark");t||(t=e.addWidget("GridBookmarkWidget","GridBookmark")),e.showWidget(t)}})}}]),r}(u.Z),Mo=[Aa,mn.ZP,r.ZP,oe,pe,Ne.ZP,Fe.ZP,We.Z,qt,Ut,Yt,en,gn,Yn,fr,wr,Ir,Er,ea,Ia.Z,La.ZP,ja,Fi,Ki,Le,fo,bo,Po,Oe]},31158:function(){}}]);
//# sourceMappingURL=4180.cb9a50e1.chunk.js.map