"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[16],{15659:function(e,n,t){t.d(n,{Mv:function(){return y},ZP:function(){return w},bm:function(){return h},sI:function(){return p}});var r=t(96234),o=t(32723),i=t(9249),a=t(87371),s=t(34795),c=t(29893),u=t.n(c),l=t(87977),f=t(20167),d=t(27664);function p(e){return(void 0!==e.umdUrl||void 0!==e.url||void 0!==e.umdLoc)&&void 0!==e.name}function h(e){return void 0!==e.esmUrl||void 0!==e.esmLoc}function v(e){return new Promise((function(n,t){u()(e,(function(e,r){e?t(e):n(r.src)}))}))}function m(e){return g.apply(this,arguments)}function g(){return(g=(0,s.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Boolean("WorkerGlobalScope"in globalThis)){e.next=2;break}return e.abrupt("return",v(n));case 2:if(null===globalThis||void 0===globalThis||!globalThis.importScripts){e.next=6;break}return e.next=5,globalThis.importScripts(n);case 5:return e.abrupt("return");case 6:throw new Error("cannot figure out how to load external JS scripts in this environment");case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return void 0!==e.cjsUrl}function b(e){return p(e)?"UMD plugin ".concat(e.name):h(e)?"ESM plugin ".concat(e.esmUrl||(null===(n=e.esmLoc)||void 0===n?void 0:n.uri)):y(e)?"CJS plugin ".concat(e.cjsUrl):"unknown plugin";var n}var w=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;(0,i.Z)(this,e),this.definitions=[],this.fetchESM=void 0,this.fetchCJS=void 0,this.fetchESM=null===t||void 0===t?void 0:t.fetchESM,this.fetchCJS=null===t||void 0===t?void 0:t.fetchCJS,this.definitions=JSON.parse(JSON.stringify(n))}return(0,a.Z)(e,[{key:"loadCJSPlugin",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(n,t){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("http:"===(r=new URL(n.cjsUrl,t)).protocol||"https:"===r.protocol){e.next=3;break}throw new Error('Cannot load plugins using protocol "'.concat(r.protocol,'"'));case 3:if(this.fetchCJS){e.next=5;break}throw new Error("No fetchCJS callback provided");case 5:return e.abrupt("return",this.fetchCJS(r.href));case 6:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"loadESMPlugin",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(n,t){var r,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("http:"===(r="esmUrl"in n?new URL(n.esmUrl,t):new URL(n.esmLoc.uri,n.esmLoc.baseUri)).protocol||"https:"===r.protocol){e.next=3;break}throw new Error('cannot load plugins using protocol "'.concat(r.protocol,'"'));case 3:if(this.fetchESM){e.next=5;break}throw new Error("No ESM fetcher installed");case 5:return e.next=7,this.fetchESM(r.href);case 7:if(i=e.sent){e.next=10;break}throw new Error("Could not load ESM plugin: ".concat(r));case 10:return e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"loadUMDPlugin",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(n,t){var r,i,a,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("http:"===(r="url"in n?new URL(n.url,t):"umdUrl"in n?new URL(n.umdUrl,t):new URL(n.umdLoc.uri,n.umdLoc.baseUri)).protocol||"https:"===r.protocol){e.next=3;break}throw new Error('cannot load plugins using protocol "'.concat(r.protocol,'"'));case 3:if(i=n.name,a="JBrowsePlugin".concat(i),"undefined"!==typeof jest){e.next=10;break}return e.next=8,m(r.href);case 8:e.next=11;break;case 10:globalThis[a]={default:l.Z};case 11:if(s=globalThis[a]){e.next=14;break}throw new Error("Failed to load UMD bundle for ".concat(i,", ").concat(a," is undefined"));case 14:return e.abrupt("return",s);case 15:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"loadPlugin",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(n,t){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d.isElectron||!y(n)){e.next=6;break}return e.next=3,this.loadCJSPlugin(n,t);case 3:case 9:case 15:r=e.sent,e.next=23;break;case 6:if(!h(n)){e.next=12;break}return e.next=9,this.loadESMPlugin(n,t);case 12:if(!p(n)){e.next=18;break}return e.next=15,this.loadUMDPlugin(n,t);case 18:if(d.isElectron||!y(n)){e.next=22;break}throw new Error("CommonJS plugin found, but not in a NodeJS environment: ".concat(JSON.stringify(n)));case 22:throw new Error("Could not determine plugin type: ".concat(JSON.stringify(n)));case 23:if(r.default){e.next=25;break}throw new Error("".concat(b(n)," does not have a default export, cannot load"));case 25:return e.abrupt("return",r.default);case 26:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"installGlobalReExports",value:function(e){e.JBrowseExports=Object.fromEntries(Object.entries(f.Z).map((function(e){var n=(0,r.Z)(e,2);return[n[0],n[1]]})))}},{key:"load",value:function(){var e=(0,s.Z)((0,o.Z)().mark((function e(n){var t=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(this.definitions.map(function(){var e=(0,s.Z)((0,o.Z)().mark((function e(r){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.loadPlugin(r,n);case 2:return e.t0=e.sent,e.t1=r,e.abrupt("return",{plugin:e.t0,definition:e.t1});case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())));case 1:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()}]),e}()},99836:function(e,n,t){t.r(n),t.d(n,{ConfigurationReference:function(){return r.B},ConfigurationSchema:function(){return r.c},getConf:function(){return o.bc},getTypeNamesFromExplicitlyTypedUnion:function(){return o.G},isBareConfigurationSchemaType:function(){return o.Pb},isConfigurationModel:function(){return o.yt},isConfigurationSchemaType:function(){return o.qN},isConfigurationSlotType:function(){return o.mu},readConfObject:function(){return o.pS}});var r=t(9159),o=t(29558)},95439:function(e,n,t){t.d(n,{Iy:function(){return i},ie:function(){return c},k$:function(){return a}});var r=0,o=new WeakMap;function i(e,n){var t=o.get(e);return t||(r+=1,o.set(e,r),t=r,e.addEventListener("abort",(function(){var t=o.get(e);void 0!==t&&n("signalAbort",t)}))),{abortSignalId:t}}function a(e){return"object"===typeof e&&null!==e&&"abortSignalId"in e&&"number"===typeof e.abortSignalId}var s=new Map;function c(e){var n=e.abortSignalId,t=s.get(n);return t||(t=new AbortController,s.set(n,t)),t.signal}},78884:function(e,n,t){var r=t(33028),o=t(96234),i=t(96902),a=t(66519),s=t(15996),c=t(4782),u=t(91188),l=t(99836),f=t(27664),d=t(29938),p=(0,u.ZL)()({importFormEntry:{minWidth:180}}),h=(0,c.observer)((function(e){var n=e.session,t=e.onChange,c=e.selected,u=e.InputProps,h=e.TextFieldProps,v=e.localStorageKey,m=e.helperText,g=void 0===m?"Select assembly to view":m,y=p().classes,b=n.assemblyNames,w=n.assemblyManager,x=new URLSearchParams(window.location.search).get("config"),Z="undefined"===typeof jest&&v?(0,f.useLocalStorage)("lastAssembly-".concat([window.location.host+window.location.pathname,x,v].join("-")),c):(0,i.useState)(c),k=(0,o.Z)(Z,2),S=k[0],C=k[1],j=b.includes(S||"")?S:c;(0,i.useEffect)((function(){j&&j!==c&&t(j)}),[j,t,c]);var A=b.length?"":"No configured assemblies";return(0,d.jsx)(a.Z,(0,r.Z)((0,r.Z)({select:!0,label:"Assembly",variant:"outlined",helperText:A||g,value:j||"",inputProps:{"data-testid":"assembly-selector"},onChange:function(e){return C(e.target.value)},error:!!A,InputProps:u,disabled:!!A,className:y.importFormEntry},h),{},{children:b.map((function(e){var n=w.get(e),t=n?(0,l.getConf)(n,"displayName"):"";return(0,d.jsx)(s.Z,{value:e,children:t||e},e)}))}))}));n.Z=h},46751:function(e,n,t){var r=t(33028),o=t(59740),i=t(96902),a=t(15996),s=t(45985),c=t(5966),u=t(12546),l=t(71610),f=t(52080),d=t(41590),p=t(98517),h=t(67918),v=t(48785),m=t(29938),g=["onClick"],y=["title","inset","popupId"],b=["popupState","onMenuItemClick","menuItems","classes"],w=["popupState","onMenuItemClick","menuItems"],x=["onMenuItemClick","menuItems"],Z=i.createContext({parentPopupState:null,rootPopupState:null});function k(e){var n=e.onClick,t=(0,o.Z)(e,g),s=(0,i.useContext)(Z).rootPopupState;if(!s)throw new Error("must be used inside a CascadingMenu");var c=(0,i.useCallback)((function(e){s.close(),null===n||void 0===n||n(e)}),[s,n]);return(0,m.jsx)(a.Z,(0,r.Z)((0,r.Z)({},t),{},{onClick:c}))}function S(e){var n=e.title,t=e.inset,c=e.popupId,u=(0,o.Z)(e,y),l=i.useContext(Z).parentPopupState,f=(0,p.o_)({popupId:c,variant:"popover",parentPopupState:l});return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(a.Z,(0,r.Z)((0,r.Z)((0,r.Z)({},(0,p.b8)(f)),(0,p.bs)(f)),{},{children:[(0,m.jsx)(s.Z,{primary:n,inset:t}),(0,m.jsx)(v.Z,{})]})),(0,m.jsx)(C,(0,r.Z)((0,r.Z)({},u),{},{anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},popupState:f}))]})}function C(e){var n=e.popupState,t=(e.onMenuItemClick,e.menuItems,e.classes,(0,o.Z)(e,b)),a=(0,i.useContext)(Z).rootPopupState,s=(0,i.useMemo)((function(){return{rootPopupState:a||n,parentPopupState:n}}),[a,n]);return(0,m.jsx)(Z.Provider,{value:s,children:(0,m.jsx)(h.Z,(0,r.Z)((0,r.Z)({},t),(0,p.wK)(n)))})}function j(e){var n=e.popupState,t=(e.onMenuItemClick,e.menuItems,(0,o.Z)(e,w)),a=i.useContext(Z).rootPopupState,s=i.useMemo((function(){return{rootPopupState:a||n,parentPopupState:n}}),[a,n]);return(0,m.jsx)(Z.Provider,{value:s,children:(0,m.jsx)(c.Z,(0,r.Z)((0,r.Z)({},t),(0,p.wK)(n)))})}function A(e){var n=e.item;return"subMenu"in n?(0,m.jsx)(d.J,{type:"subMenu"}):"checkbox"===n.type||"radio"===n.type?(0,m.jsx)(d.J,{type:n.type,checked:n.checked,disabled:n.disabled}):null}function T(e){var n=e.onMenuItemClick,t=e.menuItems,i=(0,o.Z)(e,x);var a=t.some((function(e){return"icon"in e&&e.icon}));return(0,m.jsx)(m.Fragment,{children:t.map((function(e,t){return"subMenu"in e?(0,m.jsx)(S,{popupId:"subMenu-".concat(e.label),title:e.label,inset:a,onMenuItemClick:n,menuItems:e.subMenu,children:(0,m.jsx)(T,(0,r.Z)((0,r.Z)({},i),{},{onMenuItemClick:n,menuItems:e.subMenu}))},"subMenu-".concat(e.label,"-").concat(t)):"divider"===e.type?(0,m.jsx)(u.Z,{component:"li"},"divider-".concat(t)):"subHeader"===e.type?(0,m.jsx)(l.Z,{children:e.label},"subHeader-".concat(e.label,"-").concat(t)):(0,m.jsxs)(k,{onClick:"onClick"in e?(o=e.onClick,function(e){n(e,o)}):void 0,disabled:Boolean(e.disabled),children:[e.icon?(0,m.jsx)(f.Z,{children:(0,m.jsx)(e.icon,{})}):null," ",(0,m.jsx)(s.Z,{primary:e.label,secondary:e.subLabel,inset:a&&!e.icon}),(0,m.jsx)("div",{style:{flexGrow:1,minWidth:10}}),(0,m.jsx)(A,{item:e})]},"".concat(e.label,"-").concat(t));var o}))})}n.Z=function(e){return(0,m.jsx)(j,(0,r.Z)((0,r.Z)({},e),{},{children:(0,m.jsx)(T,(0,r.Z)({},e))}))}},43971:function(e,n,t){var r=t(33028),o=t(96902),i=t(88636),a=t(99826),s=t(51479),c=t(83674),u=t(25322),l=t(12546),f=t(93751),d=t(11244),p=t(4782),h=t(91188),v=t(36897),m=t(47057),g=t(66379),y=t(29938),b=(0,h.ZL)()((function(e){return{closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}));function w(e){var n=e.error;return(0,y.jsx)("div",{style:{width:800,margin:40},children:(0,y.jsx)(g.Z,{error:n})})}n.Z=(0,p.observer)((function(e){var n=b().classes,t=e.title,p=e.header,h=e.children,g=e.onClose,x=(0,i.Z)();return(0,y.jsx)(a.Z,(0,r.Z)((0,r.Z)({},e),{},{children:(0,y.jsxs)(s.Z,{children:[o.isValidElement(p)?(0,y.jsx)(y.Fragment,{children:p}):(0,y.jsxs)(c.Z,{children:[t,g?(0,y.jsx)(u.Z,{className:n.closeButton,onClick:function(){g()},children:(0,y.jsx)(m.Z,{})}):null]}),(0,y.jsx)(l.Z,{}),(0,y.jsx)(v.SV,{FallbackComponent:w,children:(0,y.jsx)(f.Z,{theme:(0,d.Z)(x,{components:{MuiInputBase:{styleOverrides:{input:{boxSizing:"content-box!important"}}}}}),children:h})})]})}))}))},35130:function(e,n,t){var r=t(33028),o=t(96234),i=t(59740),a=t(96902),s=t(88636),c=t(35388),u=t(14368),l=t(91188),f=t(29938),d=["value","setValue","variant"],p=(0,l.ZL)()((function(e){return{input:{},inputBase:{},typography:{top:6,left:2,position:"absolute",whiteSpace:"nowrap",visibility:"hidden"},inputRoot:{padding:e.spacing(.5)},inputFocused:{borderStyle:"solid",borderWidth:2}}})),h=a.forwardRef((function(e,n){var t=e.value,l=e.setValue,h=e.variant,v=(0,i.Z)(e,d),m=(0,a.useState)(),g=(0,o.Z)(m,2),y=g[0],b=g[1],w=(0,a.useState)(null),x=(0,o.Z)(w,2),Z=x[0],k=x[1],S=(0,a.useState)(null),C=(0,o.Z)(S,2),j=C[0],A=C[1],T=(0,a.useState)(!1),M=(0,o.Z)(T,2),E=M[0],P=M[1];(0,a.useEffect)((function(){E&&(null===j||void 0===j||j.blur(),P(!1))}),[E,j]);var I=p(e,{props:e}).classes,N=(0,s.Z)(),R=(null===Z||void 0===Z?void 0:Z.clientWidth)||0,D=void 0===y?t:y;return(0,f.jsxs)("div",(0,r.Z)((0,r.Z)({},v),{},{ref:n,children:[(0,f.jsx)("div",{style:{position:"relative"},children:(0,f.jsx)(c.Z,{ref:function(e){return k(e)},component:"span",variant:h,className:I.typography,children:D})}),(0,f.jsx)(u.ZP,{inputRef:function(e){return A(e)},className:I.inputBase,inputProps:{style:(0,r.Z)({width:R},h&&"inherit"!==h?N.typography[h]:{})},classes:{input:I.input,root:I.inputRoot,focused:I.inputFocused},value:D,onChange:function(e){return b(e.target.value)},onKeyDown:function(e){"Enter"===e.key?null===j||void 0===j||j.blur():"Escape"===e.key&&(b(void 0),P(!0))},onBlur:function(){l(y||t||""),b(void 0)}})]}))}));n.Z=h},66379:function(e,n,t){t(96902);var r=t(29938);n.Z=function(e){var n=e.error,t="".concat(n),o=function(e){var n="",t="is not assignable",r=e.indexOf(t);if(-1!==r){var o=e.slice(0,r+17),i=o.match(/.*at path "(.*)" snapshot `(.*)` is not assignable/m);i&&(e="Failed to load element at ".concat(i[1],"...Failed element had snapshot"),n=i[2]);var a=o.match(/.*snapshot `(.*)` is not assignable/);a&&(e="Failed to load element...Failed element had snapshot",n=a[1])}return n}(t);return(0,r.jsxs)("div",{style:{padding:4,margin:4,overflow:"auto",maxHeight:200,background:"#f88",border:"1px solid black"},children:[t.slice(0,1e4),o?(0,r.jsx)("pre",{style:{background:"lightgrey",border:"1px solid black",margin:20},children:JSON.stringify(JSON.parse(o),null,2)}):null]})}},97342:function(e,n,t){t(96902);var r=t(52809),o=t(92735),i=t(99688),a=t(44536),s=t(43971),c=t(29938);n.Z=function(e){var n=e.onClose,t=e.open,u=e.onFactoryReset;function l(e){"reset"===e&&u(),n()}return(0,c.jsxs)(s.Z,{title:"Reset",onClose:function(){return l()},open:t,children:[(0,c.jsx)(r.Z,{children:(0,c.jsx)(o.Z,{children:"Are you sure you want to reset? This will restore the default configuration."})}),(0,c.jsxs)(i.Z,{children:[(0,c.jsx)(a.Z,{onClick:function(){return l()},color:"primary",children:"Cancel"}),(0,c.jsx)(a.Z,{onClick:function(){return l("reset")},color:"primary",variant:"contained",children:"OK"})]})]})}},23642:function(e,n,t){t.d(n,{GD:function(){return s},pt:function(){return a},sB:function(){return c}});var r=t(33028),o=t(66026),i=(t(96902),t(29938));function a(e){return(0,i.jsx)(o.Z,(0,r.Z)((0,r.Z)({},e),{},{children:(0,i.jsx)("path",{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"})}))}function s(e){return(0,i.jsx)(o.Z,(0,r.Z)((0,r.Z)({},e),{},{children:(0,i.jsx)("path",{d:"M21 19v-2H8v2h13m0-6v-2H8v2h13M8 7h13V5H8v2M4 5v2h2V5H4M3 5a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V5m1 6v2h2v-2H4m-1 0a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1v-2m1 6v2h2v-2H4m-1 0a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1v-2z"})}))}function c(e){return(0,i.jsx)(o.Z,(0,r.Z)((0,r.Z)({},e),{},{children:(0,i.jsx)("path",{d:"M20 5V4c0-.55-.45-1-1-1h-2c-.55 0-1 .45-1 1v1h-1v4c0 .55.45 1 1 1h1v7c0 1.1-.9 2-2 2s-2-.9-2-2V7c0-2.21-1.79-4-4-4S5 4.79 5 7v7H4c-.55 0-1 .45-1 1v4h1v1c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-1h1v-4c0-.55-.45-1-1-1H7V7c0-1.1.9-2 2-2s2 .9 2 2v10c0 2.21 1.79 4 4 4s4-1.79 4-4v-7h1c.55 0 1-.45 1-1V5h-1z"})}))}},16690:function(e,n,t){t.d(n,{c:function(){return i},e:function(){return a}});t(96902);var r=t(29938);function o(e){return"black"===e?{midnight:"#808080",forrest:"#666666",grape:"#4d4d4d",mandarin:"#333333",gray:"#1a1a1a"}:"white"===e?{midnight:"#ffffff",forrest:"#e6e6e6",grape:"#cccccc",mandarin:"#b3b3b3",gray:"#999999"}:{midnight:"#0d233f",forrest:"#135560",grape:"#721e63",mandarin:"#ffb11d",gray:"#dadada"}}function i(e){var n=e.variant;return(0,r.jsx)("svg",{viewBox:"0 0 175 175",children:(0,r.jsx)(s,{variant:n})})}function a(e){var n=e.variant;return(0,r.jsxs)("svg",{viewBox:"0 0 641 175",children:[(0,r.jsx)(c,{variant:n}),(0,r.jsx)(s,{variant:n})]})}function s(e){var n=o(e.variant);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{style:{fill:n.midnight},d:"M120.5,57.5c.168,0,.333.012.5.013V40.506c-.167,0-.333-.006-.5-.006a98.325,98.325,0,0,0-77.4,37.565q-2.664,3.378-5.023,6.994l14.206,9.327Q54.043,91.709,56,89.179A81.363,81.363,0,0,1,120.5,57.5Z"}),(0,r.jsx)("path",{style:{fill:n.forrest},d:"M148.668,86.223c.308.133.6.283.908.42l6.746-15.618c-.153-.067-.3-.143-.454-.21a81.36,81.36,0,0,0-71.777,3.5q-2.8,1.544-5.469,3.309l9.249,14.054A63.93,63.93,0,0,1,148.668,86.223Z"}),(0,r.jsx)("path",{style:{fill:n.grape},d:"M170.894,109.37A63.929,63.929,0,0,0,113.4,88.861l2.336,15.474a48.456,48.456,0,0,1,44.322,15.42c.111.125.214.255.324.381l11.16-10C171.323,109.879,171.118,109.62,170.894,109.37Z"}),(0,r.jsx)("path",{style:{fill:n.mandarin},d:"M150.921,150.314c.04.163.07.326.107.489l16.509-4.058c-.039-.163-.067-.326-.107-.489A48.457,48.457,0,0,0,135.575,111.8l-5.515,15.591A32.466,32.466,0,0,1,150.921,150.314Z"}),(0,r.jsx)("path",{style:{fill:n.gray},d:"M134.1,138.129l-9.779,13.213a32.486,32.486,0,0,1,7.823,14.463l15.147.852c.012-.166.032-.331.041-.5A32.464,32.464,0,0,0,134.1,138.129Z"})]})}function c(e){var n=o(e.variant);return(0,r.jsxs)("g",{"aria-label":"JBrowse",transform:"translate(213.084 144.241)",style:{fill:n.midnight},children:[(0,r.jsx)("path",{d:"m 26.355,-71.505 v 54.075 2.835 q 0,6.825 -0.42,10.185 -0.735,5.67 -2.835,9.135 -3.255,5.355 -8.505,8.4 -4.83,2.73 -11.55,3.57 L 1.47,11.76 Q 7.35,10.185 9.24,4.2 10.605,-0.105 10.605,-9.975 v -5.565 -55.965 q 1.785,0 4.62,0.315 2.835,0.21 3.255,0.21 1.785,0 2.94,-0.105 4.515,-0.42 4.935,-0.42 z"}),(0,r.jsx)("path",{d:"m 60.68836,-65.415 v 24.78 h 3.255 q 2.94,0 4.935,-0.525 2.1,-0.525 3.885,-2.1 2.31,-1.995 3.36,-4.83 1.155,-2.835 1.155,-6.09 0,-5.565 -2.94,-8.61 -2.94,-3.045 -8.295,-3.045 -2.52,0 -5.355,0.42 z m 0,30.87 V -6.09 h 5.25 q 4.725,0 8.505,-3.675 3.885,-3.78 3.885,-10.08 0,-8.19 -4.62,-11.655 -4.095,-3.045 -13.02,-3.045 z M 44.93836,0 v -71.505 h 27.09 q 9.135,0 14.385,3.255 6.51,3.99 6.51,12.6 0,7.035 -5.25,11.655 -4.62,4.095 -11.97,5.145 v 0.945 q 7.56,0.735 12.285,3.99 6.615,4.62 6.615,13.335 0,10.185 -7.98,15.75 -6.93,4.83 -17.43,4.83 z"}),(0,r.jsx)("path",{d:"M 109.44281,0.525 V -50.4 q 1.785,0.21 3.99,0.42 2.31,0.105 3.255,0.105 2.31,0 4.2,-0.21 1.89,-0.21 3.045,-0.315 v 13.02 q 1.89,-6.51 5.46,-9.87 4.41,-4.095 11.655,-4.095 -0.315,2.73 -0.42,6.825 -0.105,3.99 -0.105,7.455 l -0.945,0.84 q -0.945,-0.735 -2.415,-1.05 -1.47,-0.315 -2.94,-0.315 -3.57,0 -6.195,1.89 -2.52,1.785 -3.465,5.04 -0.42,1.155 -0.525,3.15 -0.105,1.89 -0.105,4.515 v 4.515 19.005 q -1.785,-0.21 -2.625,-0.21 -3.675,-0.315 -4.62,-0.315 -2.31,0 -4.2,0.21 -1.89,0.21 -3.045,0.315 z"}),(0,r.jsx)("path",{d:"m 173.77337,1.47 q -11.655,0 -18.585,-6.825 -6.93,-6.825 -6.93,-18.48 0,-12.6 6.72,-20.055 6.825,-7.455 18.9,-7.455 11.97,0 18.9,6.72 6.93,6.72 6.93,18.48 0,12.285 -6.72,19.74 -7.14,7.875 -19.215,7.875 z m 0.735,-48.09 q -5.88,0 -8.505,6.51 -2.205,5.565 -2.205,15.96 0,8.19 1.47,12.915 2.415,7.98 8.505,7.98 5.565,0 8.19,-7.875 2.205,-6.51 2.205,-16.695 0,-8.505 -2.1,-13.23 -2.52,-5.565 -7.56,-5.565 z"}),(0,r.jsx)("path",{d:"m 222.03563,-50.4 10.5,36.015 q 3.675,-11.235 5.67,-17.85 2.415,-8.085 5.04,-18.165 1.05,0.105 3.045,0.315 2.1,0.21 2.835,0.21 1.995,0 3.15,-0.105 1.26,-0.21 2.73,-0.42 l 10.71,36.015 q 5.88,-17.43 10.71,-36.015 l 4.2,0.315 4.095,-0.315 q -5.145,13.125 -9.135,24.57 -5.04,14.28 -8.505,26.355 -1.89,-0.21 -3.36,-0.42 -1.365,-0.105 -2.205,-0.105 -1.89,0 -3.36,0.21 -1.365,0.21 -2.31,0.315 l -10.605,-34.755 q -4.41,13.65 -6.72,21.105 -2.31,7.35 -4.095,13.65 -1.89,-0.21 -3.36,-0.42 -1.365,-0.105 -2.31,-0.105 -1.995,0 -3.465,0.21 -1.365,0.21 -2.31,0.315 -3.78,-12.81 -5.04,-17.01 -2.205,-7.245 -5.46,-17.01 -2.835,-8.4 -5.88,-16.905 1.575,0 4.305,0.315 2.73,0.21 3.36,0.21 1.47,0 4.305,-0.21 2.835,-0.315 3.465,-0.315 z"}),(0,r.jsx)("path",{d:"m 292.84172,-12.81 h 2.625 q 1.47,4.095 4.62,6.51 3.15,2.415 7.35,2.415 2.94,0 5.46,-1.785 2.625,-1.89 2.625,-4.62 0,-3.885 -6.195,-6.615 -10.395,-4.62 -11.655,-5.46 -6.405,-4.515 -6.405,-12.285 0,-7.77 5.25,-12.18 5.25,-4.515 12.81,-4.515 3.99,0 8.085,1.365 4.095,1.26 7.14,3.57 l -2.52,9.24 h -2.94 q -0.63,-3.57 -3.57,-6.195 -2.835,-2.625 -6.405,-2.625 -3.15,0 -5.46,1.575 -2.31,1.47 -2.31,4.515 0,3.885 6.405,6.51 10.185,4.095 11.865,5.25 6.405,4.41 6.405,12.81 0,7.455 -5.46,12.18 -5.355,4.62 -14.805,4.62 -8.19,0 -14.49,-4.305 z"}),(0,r.jsx)("path",{d:"m 349.61228,-29.925 h 15.54 q 0,-6.51 -1.05,-10.395 -1.68,-6.3 -5.88,-6.3 -5.04,0 -7.14,6.195 -1.47,4.305 -1.47,10.5 z m 30.03,5.04 h -30.03 q 0,9.135 3.045,13.86 3.57,5.67 11.55,5.67 3.255,0 6.405,-1.26 3.15,-1.26 5.88,-3.465 l 1.26,0.945 -2.31,5.88 q -6.72,4.725 -15.015,4.725 -12.915,0 -19.635,-7.245 -6.72,-7.245 -6.72,-20.37 0,-11.235 6.405,-18.165 6.51,-7.035 17.64,-7.035 11.655,0 16.905,7.56 4.62,6.615 4.62,18.9 z"})]})}},41590:function(e,n,t){t.d(n,{J:function(){return j}});var r=t(59740),o=t(33028),i=t(96234),a=t(96902),s=t(56537),c=t(12546),u=t(71610),l=t(52080),f=t(15996),d=t(45985),p=t(8281),h=t(6880),v=t(78566),m=t(91188),g=t(90001),y=t(26838),b=t(87851),w=t(24667),x=t(77668),Z=t(27664),k=t(29938),S=["open","onClose","menuItems","onMenuItemClick"],C=(0,m.ZL)()({paper:{position:"fixed",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",top:0,left:0,outline:0},menuItemEndDecoration:{padding:0,margin:0,height:16}});function j(e){var n,t,r,o=C().classes,i=e.type;switch("checked"in e&&(n=e.checked,t=e.disabled),i){case"subMenu":r=(0,k.jsx)(g.Z,{color:"action"});break;case"checkbox":if(n){var a=t?"inherit":void 0;r=(0,k.jsx)(y.Z,{color:a})}else r=(0,k.jsx)(b.Z,{color:"action"});break;case"radio":if(n){var s=t?"inherit":void 0;r=(0,k.jsx)(w.Z,{color:s})}else r=(0,k.jsx)(x.Z,{color:"action"})}return(0,k.jsx)("div",{className:o.menuItemEndDecoration,children:r})}var A=a.forwardRef((function(e,n){var t=(0,a.useState)(),r=(0,i.Z)(t,2),v=r[0],m=r[1],g=(0,a.useState)(),y=(0,i.Z)(g,2),b=y[0],w=y[1],x=(0,a.useState)(!1),S=(0,i.Z)(x,2),T=S[0],M=S[1],E=(0,a.useState)(),P=(0,i.Z)(E,2),I=P[0],N=P[1],R=(0,a.useState)(),D=(0,i.Z)(R,2),W=D[0],L=D[1],O=(0,a.useRef)(null),z=C().classes,_=e.menuItems,U=e.onMenuItemClick,V=e.open,F=e.onClose,B=e.anchorEl,G=e.top,q=void 0!==G&&G;(0,a.useEffect)((function(){V||(m(void 0),w(void 0))}),[V]),(0,a.useEffect)((function(){var e,n=V&&Boolean(v);return n&&!T?e=setTimeout((function(){M(!0)}),300):!n&&T&&(e=setTimeout((function(){M(!1)}),300)),function(){clearTimeout(e)}}),[T,V,v]),(0,a.useEffect)((function(){if(B){var e=B.getBoundingClientRect();W&&e.top===W.top&&e.left+e.width===W.left||L({top:e.top,left:e.left+e.width})}else W||L({})}),[W,B]);var J=_.some((function(e){return"icon"in e&&e.icon})),H={};var K=(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(s.Z,{autoFocusItem:V&&!T,dense:!0,children:_.sort((function(e,n){return(n.priority||0)-(e.priority||0)})).map((function(e,n){if("divider"===e.type)return(0,k.jsx)(c.Z,{component:"li"},"divider-".concat(n));if("subHeader"===e.type)return(0,k.jsx)(u.Z,{children:e.label},"subHeader-".concat(e.label,"-").concat(n));var t=null,r=null;if(e.icon){var o=e.icon;t=(0,k.jsx)(l.Z,{children:(0,k.jsx)(o,{})})}"subMenu"in e?r=(0,k.jsx)(j,{type:"subMenu"}):"checkbox"!==e.type&&"radio"!==e.type||(r=(0,k.jsx)(j,{type:e.type,checked:e.checked,disabled:e.disabled}));var i,a="onClick"in e?(i=e.onClick,function(e){U(e,i)}):void 0;return(0,k.jsxs)(f.Z,{style:H,selected:n===I,onClick:a,onMouseMove:function(t){t.currentTarget!==document.activeElement&&(t.currentTarget.focus(),N(n)),"subMenu"in e?b!==n&&(m(t.currentTarget),w(n)):(m(void 0),w(void 0))},onKeyDown:function(t){switch(t.key){case"ArrowLeft":case"Escape":F&&F(t,"escapeKeyDown");break;case"ArrowUp":N(function(e,n){return(0,Z.findLastIndex)(e.slice(0,n),(function(e){return"divider"!==e.type&&"subHeader"!==e.type&&!e.disabled}))}(_,n));break;case"ArrowDown":var r=function(e,n){var t=e.slice(n+1).findIndex((function(e){return"divider"!==e.type&&"subHeader"!==e.type&&!e.disabled}));return-1===t?t:n+1+t}(_,n);N(r);break;default:!("subMenu"in e)||"ArrowRight"!==t.key&&"Enter"!==t.key||(m(t.currentTarget),w(n),M(!0))}},disabled:Boolean(e.disabled),children:[t,(0,k.jsx)(d.Z,{primary:e.label,secondary:e.subLabel,inset:J&&!e.icon}),r]},e.label)}))}),_.map((function(e,n){var t=null;return"subMenu"in e&&(t=(0,k.jsx)(A,{anchorEl:v,open:T&&b===n,onClose:function(){M(!1),m(void 0)},onMenuItemClick:U,menuItems:e.subMenu},e.label)),t}))]});return q?K:(0,k.jsx)(p.Z,{in:V,style:{transformOrigin:"0 0 0"},ref:n,children:(0,k.jsx)(h.Z,{elevation:8,ref:O,className:z.paper,style:(0,o.Z)({},W),children:K})})}));n.Z=function(e){var n=e.open,t=e.onClose,i=e.menuItems,a=e.onMenuItemClick,s=(0,r.Z)(e,S);return(0,k.jsx)(v.ZP,(0,o.Z)((0,o.Z)({open:n,onClose:t,BackdropProps:{invisible:!0},anchorOrigin:(0,o.Z)({vertical:"bottom",horizontal:"right"},s.anchorOrigin),transformOrigin:(0,o.Z)({vertical:"top",horizontal:"left"},s.transformOrigin)},s),{},{children:(0,k.jsx)(A,{open:n,onClose:t,menuItems:i,onMenuItemClick:a,top:!0})}))}},54896:function(e,n,t){var r=t(33028),o=t(96234),i=t(59740),a=t(96902),s=t(91188),c=t(29938),u=["onDrag","vertical","flexbox","className"],l=(0,s.ZL)()({horizontalHandle:{cursor:"row-resize",width:"100%"},verticalHandle:{cursor:"col-resize",height:"100%"},flexbox_verticalHandle:{cursor:"col-resize",alignSelf:"stretch"},flexbox_horizontalHandle:{cursor:"row-resize",alignSelf:"stretch"}});n.Z=function(e){var n,t=e.onDrag,s=e.vertical,f=void 0!==s&&s,d=e.flexbox,p=void 0!==d&&d,h=e.className,v=(0,i.Z)(e,u),m=(0,a.useState)(!1),g=(0,o.Z)(m,2),y=g[0],b=g[1],w=(0,a.useRef)(0),x=l(),Z=x.classes,k=x.cx;return(0,a.useEffect)((function(){function e(e){e.preventDefault();var n=f?e.clientX:e.clientY,r=n-w.current;r&&(t(r),w.current=n)}function n(){b(!1)}return y?(window.addEventListener("mousemove",e,!0),window.addEventListener("mouseup",n,!0),function(){window.removeEventListener("mousemove",e,!0),window.removeEventListener("mouseup",n,!0)}):function(){}}),[y,t,f]),n=p?f?Z.flexbox_verticalHandle:Z.flexbox_horizontalHandle:f?Z.verticalHandle:Z.horizontalHandle,(0,c.jsx)("div",(0,r.Z)({"data-resizer":"true",onMouseDown:function(e){e.preventDefault(),w.current=f?e.clientX:e.clientY,b(!0)},className:k(n,h)},v))}},41750:function(e,n,t){t.r(n);t(96902);var r=t(4782),o=t(52809),i=t(35388),a=t(99688),s=t(44536),c=t(43971),u=t(29938);n.default=(0,r.observer)((function(e){var n=e.model,t=e.handleClose;return(0,u.jsxs)(c.Z,{maxWidth:"xl",open:!0,onClose:t,title:"Reference sequence",children:[(0,u.jsx)(o.Z,{children:(0,u.jsx)(i.Z,{children:"Are you sure you want to return to the import form? This will lose your current view"})}),(0,u.jsxs)(a.Z,{children:[(0,u.jsx)(s.Z,{onClick:function(){n.clearView(),t()},variant:"contained",color:"primary",autoFocus:!0,children:"OK"}),(0,u.jsx)(s.Z,{onClick:function(){return t()},color:"secondary",variant:"contained",children:"Cancel"})]})]})}))},82769:function(e,n,t){t.d(n,{Z:function(){return l}});t(96902);var r=t(1599),o=t.n(r),i=t(57244),a=t.n(i),s=t(29938),c=!1,u=new RegExp(["a","b","br","code","div","em","h1","h2","h3","h4","h5","h6","i","img","li","p","pre","span","small","strong","table","tbody","sup","sub","td","tfoot","th","thead","tr","u","ul"].map((function(e){return"<".concat(e,"\\b[^>]*>")})).join("|"),"i");function l(e){var n,t=e.html,r=(n=t,u.test(n)?t:o()(t));return c||(c=!0,a().addHook("afterSanitizeAttributes",(function(e){"A"===e.tagName&&(e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank"))}))),(0,s.jsx)("span",{dangerouslySetInnerHTML:{__html:a().sanitize(r)}})}},17867:function(e,n,t){t.r(n),t.d(n,{AssemblySelector:function(){return k.Z},CascadingMenu:function(){return S.Z},Dialog:function(){return C.Z},EditableTypography:function(){return j.Z},ErrorMessage:function(){return A.Z},FactoryResetDialog:function(){return T.Z},FatalErrorDialog:function(){return M.Z},FileSelector:function(){return $},LoadingEllipses:function(){return X.Z},LogoFull:function(){return Z.e},Logomark:function(){return Z.c},Menu:function(){return ee.Z},MenuItemEndDecoration:function(){return ee.J},PrerenderedCanvas:function(){return te},ResizeHandle:function(){return ce.Z},ReturnToImportFormDialog:function(){return se.default},SanitizedHTML:function(){return ue.Z},Tooltip:function(){return ae},createJBrowseBaseTheme:function(){return b},createJBrowseTheme:function(){return w},defaultThemes:function(){return y}});var r=t(33028),o=t(67092),i=t(31253),a=t(1985),s=t(2911),c=t(36282),u=t(11244),l=t(67928),f=t.n(l),d="#0D233F",p="#721E63",h="#135560",v="#FFB11D",m=(0,u.Z)();function g(){return{palette:{mode:void 0,primary:{main:d},secondary:{main:p},tertiary:m.palette.augmentColor({color:{main:h}}),quaternary:m.palette.augmentColor({color:{main:v}}),stopCodon:"#e22",startCodon:"#3e3",bases:{A:m.palette.augmentColor({color:o.Z}),C:m.palette.augmentColor({color:i.Z}),G:m.palette.augmentColor({color:a.Z}),T:m.palette.augmentColor({color:s.Z})}},components:{MuiLink:{styleOverrides:{root:function(e){return{color:e.theme.palette.tertiary.main}}}}}}}var y={default:(0,r.Z)({name:"Default (from config)"},g()),lightStock:(0,r.Z)({name:"Light (stock)"},g()),lightMinimal:{name:"Light (minimal)",palette:{primary:{main:c.Z[900]},secondary:{main:c.Z[800]},tertiary:m.palette.augmentColor({color:{main:c.Z[900]}}),quaternary:m.palette.augmentColor({color:{main:v}}),stopCodon:"#e22",startCodon:"#3e3",bases:{A:m.palette.augmentColor({color:o.Z}),C:m.palette.augmentColor({color:i.Z}),G:m.palette.augmentColor({color:a.Z}),T:m.palette.augmentColor({color:s.Z})}}},darkMinimal:{name:"Dark (minimal)",palette:{mode:"dark",primary:{main:c.Z[700]},secondary:{main:c.Z[800]},tertiary:m.palette.augmentColor({color:{main:c.Z[900]}}),quaternary:m.palette.augmentColor({color:{main:v}}),stopCodon:"#e22",startCodon:"#3e3",bases:{A:m.palette.augmentColor({color:o.Z}),C:m.palette.augmentColor({color:i.Z}),G:m.palette.augmentColor({color:a.Z}),T:m.palette.augmentColor({color:s.Z})}}},darkStock:{name:"Dark (stock)",palette:{mode:"dark",primary:{main:d},secondary:{main:p},tertiary:m.palette.augmentColor({color:{main:h}}),quaternary:m.palette.augmentColor({color:{main:v}}),stopCodon:"#e22",startCodon:"#3e3",bases:{A:m.palette.augmentColor({color:o.Z}),C:m.palette.augmentColor({color:i.Z}),G:m.palette.augmentColor({color:a.Z}),T:m.palette.augmentColor({color:s.Z})}},components:{MuiAppBar:{defaultProps:{enableColorOnDark:!0},styleOverrides:{primary:function(e){return e.theme.palette.primary.main}}}}}};function b(e){return f()((0,r.Z)({palette:null===e||void 0===e?void 0:e.palette,typography:{fontSize:12},spacing:4},function(e){var n,t,r,o,i,a;return{components:{MuiButton:{defaultProps:{size:"small"},styleOverrides:{root:function(e){var n=e.theme;return"dark"===n.palette.mode?{color:n.palette.text.primary}:void 0}}},MuiAccordion:{defaultProps:{disableGutters:!0,TransitionProps:{timeout:150}}},MuiFilledInput:{defaultProps:{margin:"dense"}},MuiFormControl:{defaultProps:{margin:"dense",size:"small"}},MuiFormHelperText:{defaultProps:{margin:"dense"}},MuiIconButton:{defaultProps:{size:"small"}},MuiInputBase:{defaultProps:{margin:"dense"}},MuiAutocomplete:{defaultProps:{size:"small"}},MuiInputLabel:{defaultProps:{margin:"dense"}},MuiToolbar:{defaultProps:{variant:"dense"}},MuiListItem:{defaultProps:{dense:!0}},MuiOutlinedInput:{defaultProps:{margin:"dense"}},MuiFab:{defaultProps:{size:"small"},styleOverrides:{secondary:{backgroundColor:null===e||void 0===e||null===(n=e.palette)||void 0===n||null===(t=n.quaternary)||void 0===t?void 0:t.main}}},MuiTable:{defaultProps:{size:"small"}},MuiPopover:{defaultProps:{transitionDuration:0}},MuiMenu:{defaultProps:{transitionDuration:0}},MuiMenuItem:{defaultProps:{dense:!0}},MuiTextField:{defaultProps:{margin:"dense",variant:"standard"}},MuiLink:{styleOverrides:{root:function(e){return{color:e.theme.palette.text.secondary}}}},MuiCheckbox:{styleOverrides:{root:function(e){var n=e.theme;return"dark"===n.palette.mode?{color:n.palette.text.secondary,"&.Mui-checked":{color:n.palette.text.secondary}}:void 0}}},MuiRadio:{styleOverrides:{root:function(e){var n=e.theme;return"dark"===n.palette.mode?{color:n.palette.text.secondary,"&.Mui-checked":{color:n.palette.text.secondary}}:void 0}}},MuiFormLabel:{styleOverrides:{root:function(e){var n=e.theme;return"dark"===n.palette.mode?{color:n.palette.text.secondary,"&.Mui-focused":{color:n.palette.text.secondary}}:void 0}}},MuiAccordionSummary:{styleOverrides:{root:{backgroundColor:null===e||void 0===e||null===(r=e.palette)||void 0===r||null===(o=r.tertiary)||void 0===o?void 0:o.main},content:{color:null===e||void 0===e||null===(i=e.palette)||void 0===i||null===(a=i.tertiary)||void 0===a?void 0:a.contrastText}}},MuiToggleButtonGroup:{defaultProps:{size:"small"}}}}}(e)),e||{})}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default";return(0,u.Z)(b("default"===t?f()(n.default,x(e)):function(){var e,n,t,r,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o=x(o),null!==(e=o)&&void 0!==e&&null!==(n=e.palette)&&void 0!==n&&n.quaternary||(o=f()(o,{palette:{quaternary:m.palette.augmentColor({color:{main:"#aaa"}})}}));null!==(t=o)&&void 0!==t&&null!==(r=t.palette)&&void 0!==r&&r.tertiary||(o=f()(o,{palette:{tertiary:m.palette.augmentColor({color:{main:"#aaa"}})}}));return o}(n[t])||n.default))}function x(){var e,n,t,r,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return null!==(e=o)&&void 0!==e&&null!==(n=e.palette)&&void 0!==n&&n.tertiary&&(o=f()(o,{palette:{tertiary:m.palette.augmentColor("color"in o.palette.tertiary?o.palette.tertiary:{color:o.palette.tertiary})}})),null!==(t=o)&&void 0!==t&&null!==(r=t.palette)&&void 0!==r&&r.quaternary&&(o=f()(o,{palette:{quaternary:m.palette.augmentColor("color"in o.palette.quaternary?o.palette.quaternary:{color:o.palette.quaternary})}})),o}var Z=t(16690),k=t(78884),S=t(46751),C=t(43971),j=t(35130),A=t(66379),T=t(97342),M=t(90264),E=t(68079),P=t(96234),I=t(59740),N=t(96902),R=t(4782),D=t(50543),W=t(72540),L=t(37676),O=t(36276),z=t(52868),_=t(5966),U=t(15996),V=t(82793),F=t(73),B=t(50811),G=t(58865),q=t(74859),J=t(27664),H=t(29938),K=["title","children"];function Q(e){var n=e.title,t=e.children,o=(0,I.Z)(e,K);return(0,H.jsx)(D.Z,{title:n||"",children:(0,H.jsx)(W.Z,(0,r.Z)((0,r.Z)({},o),{},{children:t}))})}function Y(e,n){return"string"===typeof e&&e.length>n?"".concat(e.slice(0,Math.max(0,n)),"\u2026"):e}var $=(0,R.observer)((function(e){var n=e.location,t=e.name,o=e.description,i=e.rootModel,a=e.setLocation,s=!n||(0,F.hb)(n)?"url":"file",c=(0,N.useState)(n&&"internetAccountId"in n&&n.internetAccountId?n.internetAccountId:s),u=(0,P.Z)(c,2),l=u[0],f=u[1],d=(0,F.dc)(i)?(0,E.Z)(i.internetAccounts):[],p=(0,N.useState)(d.slice(0,2)),h=(0,P.Z)(p,2),v=h[0],m=h[1],g=(0,N.useState)(d.slice(2)),y=(0,P.Z)(g,2),b=y[0],w=y[1],x=(0,N.useState)(null),Z=(0,P.Z)(x,2),k=Z[0],S=Z[1],C=d.find((function(e){return e.internetAccountId===l})),j=(0,N.useCallback)((function(e){a((0,r.Z)((0,r.Z)({},e),(0,F.hb)(e)?{internetAccountId:null===C||void 0===C?void 0:C.internetAccountId}:{}))}),[a,C]);(0,N.useEffect)((function(){C&&(0,F.hb)(n)&&n.internetAccountId!==C.internetAccountId&&j(n)}),[n,C,j]);var A=(0,H.jsx)(G.Z,(0,r.Z)((0,r.Z)({},e),{},{setLocation:j,label:null===C||void 0===C?void 0:C.selectorLabel}));if("file"===l&&(A=(0,H.jsx)(B.Z,(0,r.Z)({},e))),null!==C&&void 0!==C&&C.SelectorComponent){var T=C.SelectorComponent;A=(0,H.jsx)(T,(0,r.Z)((0,r.Z)({},e),{},{setLocation:j}))}return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(L.Z,{display:"flex",children:(0,H.jsx)(O.Z,{shrink:!0,children:t})}),(0,H.jsx)(L.Z,{display:"flex",flexDirection:"row",children:(0,H.jsxs)(L.Z,{children:[(0,H.jsxs)(z.Z,{value:l,exclusive:!0,onChange:function(e,t){t&&f(t),(0,F.hb)(n)&&j(n)},"aria-label":"file, url, or account picker",children:[new URLSearchParams(window.location.search).get("adminKey")?null:(0,H.jsx)(W.Z,{value:"file","aria-label":"local file",children:"File"}),(0,H.jsx)(W.Z,{value:"url","aria-label":"url",children:"URL"}),v.map((function(e){var n=e.internetAccountId,t=e.toggleContents,r=e.name;return(0,H.jsx)(Q,{value:n,"aria-label":r,title:r,children:"string"===typeof t?Y(t,5):t||Y(r,5)},n)})),b.length>0?(0,H.jsxs)(W.Z,{onClick:function(e){return S(e.target)},selected:!1,children:["More",(0,H.jsx)(q.Z,{})]}):null]}),(0,H.jsx)(_.Z,{open:Boolean(k),anchorEl:k,onClose:function(){return S(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:null===b||void 0===b?void 0:b.map((function(e,n){return(0,H.jsx)(U.Z,{value:e.internetAccountId,onClick:function(){var t=v.at(-1);m([].concat((0,E.Z)(v.slice(0,-1)),[e])),w([t].concat((0,E.Z)(b.slice(0,n)),(0,E.Z)(b.slice(n+1))).filter(J.notEmpty)),f(e.internetAccountId),S(null)},children:e.name},e.internetAccountId)}))})]})}),A,(0,H.jsx)(V.Z,{children:o})]})})),X=t(20893),ee=t(41590),ne=t(15446);var te=function(e){var n=e.width,t=e.height,o=e.highResolutionScaling,i=void 0===o?1:o,a=e.style,s=void 0===a?{}:a,c=e.imageData,u=e.blockKey,l=e.showSoftClip,f=(0,N.useState)(!1),d=(0,P.Z)(f,2),p=d[0],h=d[1],v=(0,N.useRef)(null);(0,N.useEffect)((function(){if(c){var e=v.current;if(e){var n=e.getContext("2d");n&&((0,ne.kv)(c,n),h(!0))}}}),[c]);var m=u?"_"+u:"",g="prerendered_canvas".concat(l?"_softclipped":"").concat(m).concat(p?"_done":"");return(0,H.jsx)("canvas",{"data-testid":g,ref:v,width:n*i,height:t*i,style:(0,r.Z)({width:n,height:t},s)})},re=t(91188),oe=t(99836),ie=(0,re.ZL)()({hoverLabel:{border:"1px solid black",position:"absolute",background:"#fffa",pointerEvents:"none",zIndex:1e4}}),ae=(0,R.observer)((function(e){var n=e.offsetX,t=e.offsetY,r=e.configuration,o=e.feature,i=e.timeout,a=void 0===i?300:i,s=ie().classes,c=(0,N.useState)(!1),u=(0,P.Z)(c,2),l=u[0],f=u[1];if((0,N.useEffect)((function(){var e=setTimeout((function(){return f(!0)}),a);return function(){return clearTimeout(e)}})),o&&l){var d=(0,oe.readConfObject)(r,"mouseover",{feature:o});return(0,H.jsx)("div",{className:s.hoverLabel,style:{left:n,top:t},children:d})}return null})),se=t(41750),ce=t(54896),ue=t(82769)},10361:function(e,n,t){t.d(n,{Z:function(){return f}});var r=t(68079),o=t(32723),i=t(96234),a=t(41361),s=t(9249),c=t(87371),u=t(45754),l=t(13820),f=function(e,n,t){(0,u.Z)(d,e);var f=(0,l.Z)(d);function d(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,s.Z)(this,d),e=f.call(this),!(n.maxSize&&n.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"===typeof n.maxAge&&0===n.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");return e.maxSize=n.maxSize,e.maxAge=n.maxAge||Number.POSITIVE_INFINITY,e.onEviction=n.onEviction,e.cache=new Map,e.oldCache=new Map,e._size=0,e}return(0,c.Z)(d,[{key:"_emitEvictions",value:function(e){if("function"===typeof this.onEviction){var n,t=(0,a.Z)(e);try{for(t.s();!(n=t.n()).done;){var r=(0,i.Z)(n.value,2),o=r[0],s=r[1];this.onEviction(o,s.value)}}catch(c){t.e(c)}finally{t.f()}}}},{key:"_deleteIfExpired",value:function(e,n){return"number"===typeof n.expiry&&n.expiry<=Date.now()&&("function"===typeof this.onEviction&&this.onEviction(e,n.value),this.delete(e))}},{key:"_getOrDeleteIfExpired",value:function(e,n){if(!1===this._deleteIfExpired(e,n))return n.value}},{key:"_getItemValue",value:function(e,n){return n.expiry?this._getOrDeleteIfExpired(e,n):n.value}},{key:"_peek",value:function(e,n){var t=n.get(e);return this._getItemValue(e,t)}},{key:"_set",value:function(e,n){this.cache.set(e,n),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}},{key:"_moveToRecent",value:function(e,n){this.oldCache.delete(e),this._set(e,n)}},{key:"_entriesAscending",value:(0,o.Z)().mark((function e(){var n,t,r,s,c,u,l,f,d,p,h,v;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,a.Z)(this.oldCache),e.prev=1,n.s();case 3:if((t=n.n()).done){e.next=13;break}if(r=t.value,s=(0,i.Z)(r,2),c=s[0],u=s[1],this.cache.has(c)){e.next=11;break}if(!1!==this._deleteIfExpired(c,u)){e.next=11;break}return e.next=11,r;case 11:e.next=3;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),n.e(e.t0);case 18:return e.prev=18,n.f(),e.finish(18);case 21:l=(0,a.Z)(this.cache),e.prev=22,l.s();case 24:if((f=l.n()).done){e.next=33;break}if(d=f.value,p=(0,i.Z)(d,2),h=p[0],v=p[1],!1!==this._deleteIfExpired(h,v)){e.next=31;break}return e.next=31,d;case 31:e.next=24;break;case 33:e.next=38;break;case 35:e.prev=35,e.t1=e.catch(22),l.e(e.t1);case 38:return e.prev=38,l.f(),e.finish(38);case 41:case"end":return e.stop()}}),e,this,[[1,15,18,21],[22,35,38,41]])}))},{key:"get",value:function(e){if(this.cache.has(e)){var n=this.cache.get(e);return this._getItemValue(e,n)}if(this.oldCache.has(e)){var t=this.oldCache.get(e);if(!1===this._deleteIfExpired(e,t))return this._moveToRecent(e,t),t.value}}},{key:"set",value:function(e,n){var t=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).maxAge,r=void 0===t?this.maxAge:t,o="number"===typeof r&&r!==Number.POSITIVE_INFINITY?Date.now()+r:void 0;this.cache.has(e)?this.cache.set(e,{value:n,expiry:o}):this._set(e,{value:n,expiry:o})}},{key:"has",value:function(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):!!this.oldCache.has(e)&&!this._deleteIfExpired(e,this.oldCache.get(e))}},{key:"peek",value:function(e){return this.cache.has(e)?this._peek(e,this.cache):this.oldCache.has(e)?this._peek(e,this.oldCache):void 0}},{key:"delete",value:function(e){var n=this.cache.delete(e);return n&&this._size--,this.oldCache.delete(e)||n}},{key:"clear",value:function(){this.cache.clear(),this.oldCache.clear(),this._size=0}},{key:"resize",value:function(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");var n=(0,r.Z)(this._entriesAscending()),t=n.length-e;t<0?(this.cache=new Map(n),this.oldCache=new Map,this._size=n.length):(t>0&&this._emitEvictions(n.slice(0,t)),this.oldCache=new Map(n.slice(t)),this.cache=new Map,this._size=0),this.maxSize=e}},{key:"keys",value:(0,o.Z)().mark((function e(){var n,t,r,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,a.Z)(this),e.prev=1,n.s();case 3:if((t=n.n()).done){e.next=9;break}return r=(0,i.Z)(t.value,1),s=r[0],e.next=7,s;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"values",value:(0,o.Z)().mark((function e(){var n,t,r,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,a.Z)(this),e.prev=1,n.s();case 3:if((t=n.n()).done){e.next=9;break}return r=(0,i.Z)(t.value,2),s=r[1],e.next=7,s;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:n,value:(0,o.Z)().mark((function(){var e,n,t,r,s,c,u,l,f,d,p,h;return(0,o.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:e=(0,a.Z)(this.cache),o.prev=1,e.s();case 3:if((n=e.n()).done){o.next=12;break}if(t=n.value,r=(0,i.Z)(t,2),s=r[0],c=r[1],!1!==this._deleteIfExpired(s,c)){o.next=10;break}return o.next=10,[s,c.value];case 10:o.next=3;break;case 12:o.next=17;break;case 14:o.prev=14,o.t0=o.catch(1),e.e(o.t0);case 17:return o.prev=17,e.f(),o.finish(17);case 20:u=(0,a.Z)(this.oldCache),o.prev=21,u.s();case 23:if((l=u.n()).done){o.next=33;break}if(f=l.value,d=(0,i.Z)(f,2),p=d[0],h=d[1],this.cache.has(p)){o.next=31;break}if(!1!==this._deleteIfExpired(p,h)){o.next=31;break}return o.next=31,[p,h.value];case 31:o.next=23;break;case 33:o.next=38;break;case 35:o.prev=35,o.t1=o.catch(21),u.e(o.t1);case 38:return o.prev=38,u.f(),o.finish(38);case 41:case"end":return o.stop()}}),c,this,[[1,14,17,20],[21,35,38,41]])}))},{key:"entriesDescending",value:(0,o.Z)().mark((function e(){var n,t,a,s,c,u,l,f,d,p,h;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,r.Z)(this.cache),t=n.length-1;case 2:if(!(t>=0)){e.next=12;break}if(a=n[t],s=(0,i.Z)(a,2),c=s[0],u=s[1],!1!==this._deleteIfExpired(c,u)){e.next=9;break}return e.next=9,[c,u.value];case 9:--t,e.next=2;break;case 12:n=(0,r.Z)(this.oldCache),l=n.length-1;case 14:if(!(l>=0)){e.next=25;break}if(f=n[l],d=(0,i.Z)(f,2),p=d[0],h=d[1],this.cache.has(p)){e.next=22;break}if(!1!==this._deleteIfExpired(p,h)){e.next=22;break}return e.next=22,[p,h.value];case 22:--l,e.next=14;break;case 25:case"end":return e.stop()}}),e,this)}))},{key:"entriesAscending",value:(0,o.Z)().mark((function e(){var n,t,r,s,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,a.Z)(this._entriesAscending()),e.prev=1,n.s();case 3:if((t=n.n()).done){e.next=9;break}return r=(0,i.Z)(t.value,2),s=r[0],c=r[1],e.next=7,[s,c.value];case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"size",get:function(){if(!this._size)return this.oldCache.size;var e,n=0,t=(0,a.Z)(this.oldCache.keys());try{for(t.s();!(e=t.n()).done;){var r=e.value;this.cache.has(r)||n++}}catch(o){t.e(o)}finally{t.f()}return Math.min(this._size+n,this.maxSize)}},{key:"entries",value:function(){return this.entriesAscending()}},{key:"forEach",value:function(e){var n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,r=(0,a.Z)(this.entriesAscending());try{for(r.s();!(n=r.n()).done;){var o=(0,i.Z)(n.value,2),s=o[0],c=o[1];e.call(t,c,s,this)}}catch(u){r.e(u)}finally{r.f()}}},{key:t,get:function(){return JSON.stringify((0,r.Z)(this.entriesAscending()))}}]),d}((0,t(30364).Z)(Map),Symbol.iterator,Symbol.toStringTag)},27664:function(e,n,t){t.r(n),t.d(n,{AuthNeededError:function(){return h.yb},ImageBitmapType:function(){return w.Ck},ReactRendering:function(){return x.AN},RetryError:function(){return h.Ms},SimpleFeature:function(){return Z.Z},abortBreakPoint:function(){return v.ML},assembleLocString:function(){return D},assembleLocStringFast:function(){return W},avg:function(){return Ue},blobToDataURL:function(){return fe},bpSpanPx:function(){return Q},bpToPx:function(){return V},bytesForRegions:function(){return ke},cartesianToPolar:function(){return H},checkAbortSignal:function(){return v.O8},clamp:function(){return U},compareLocStrings:function(){return _},compareLocs:function(){return z},complement:function(){return le},createCanvas:function(){return w.vL},createImageBitmap:function(){return w.MC},dedupe:function(){return b.D},defaultCodonTable:function(){return ge},defaultStarts:function(){return ve},defaultStops:function(){return me},degToRad:function(){return q},doesIntersect2:function(){return y.qY},drawImageOntoCanvasContext:function(){return w.kv},featureSpanPx:function(){return K},findLast:function(){return X},findLastIndex:function(){return $},findParentThat:function(){return T},findParentThatIs:function(){return E},gatherOverlaps:function(){return Ge},generateCodonTable:function(){return ye},getBpDisplayStr:function(){return je},getContainingDisplay:function(){return R},getContainingTrack:function(){return N},getContainingView:function(){return I},getEnv:function(){return De},getLayoutId:function(){return Ee},getSerializedSvg:function(){return x.E9},getSession:function(){return P},getStr:function(){return Ne},getTickDisplayStr:function(){return Te},getUriLink:function(){return Ie},getViewParams:function(){return Me},groupBy:function(){return Ve},hashCode:function(){return xe},inDevelopment:function(){return k},inProduction:function(){return S},intersection2:function(){return y.U0},isAbortException:function(){return v.zF},isAbstractMenuManager:function(){return h.J0},isAppRootModel:function(){return h.dc},isAuthNeededException:function(){return h.PK},isBlobLocation:function(){return h.ld},isContainedWithin:function(){return y.J7},isDisplayModel:function(){return h.yZ},isElectron:function(){return se},isFeature:function(){return Z.T},isLocalPathLocation:function(){return h.fx},isRetryException:function(){return h.Z6},isRootModelWithInternetAccounts:function(){return h.At},isSelectionContainer:function(){return h.zL},isSessionModel:function(){return h.k$},isSessionModelWithConfigEditing:function(){return h.cX},isSessionModelWithConnectionEditing:function(){return h._2},isSessionModelWithConnections:function(){return h.gC},isSessionModelWithWidgets:function(){return h.gI},isSessionWithAddTracks:function(){return h._L},isSessionWithSessionPlugins:function(){return h.uF},isTrackModel:function(){return h.d6},isTrackViewModel:function(){return h.Um},isUriLocation:function(){return h.hb},isViewContainer:function(){return h.BQ},isViewModel:function(){return h.zN},iterMap:function(){return Y},localStorageGetItem:function(){return We},localStorageSetItem:function(){return Le},makeAbortError:function(){return v.fP},makeAbortableReaction:function(){return ee},max:function(){return Oe},measureGridWidth:function(){return Re},measureText:function(){return he},mergeIntervals:function(){return Be},min:function(){return ze},minmax:function(){return oe},notEmpty:function(){return Fe},objectHash:function(){return Ze},observeAbortSignal:function(){return v.N7},parseLocString:function(){return O},parseLocStringOneBased:function(){return L},polarToCartesian:function(){return J},rIC:function(){return de},radToDeg:function(){return G},renameRegionIfNeeded:function(){return ne},renameRegionsIfNeeded:function(){return te},renderToAbstractCanvas:function(){return x.Cj},revcom:function(){return ce},reverse:function(){return ue},shorten:function(){return ie},springAnimate:function(){return M},stringify:function(){return ae},sum:function(){return _e},supportedIndexingAdapters:function(){return Ce},toLocale:function(){return Ae},updateStatus:function(){return be},useDebounce:function(){return C},useDebouncedCallback:function(){return A},useLocalStorage:function(){return Pe},useWidthSetter:function(){return j},when:function(){return g.g},whenPresent:function(){return g.q}});var r=t(33028),o=t(32723),i=t(34795),a=t(41361),s=t(68079),c=t(96234),u=t(96902),l=t(71112),f=t.n(l),d=t(63680),p=t(75717),h=t(73),v=t(78950),m=t(49629),g=t(67813),y=t(23995),b=t(29943),w=t(15446),x=t(31440),Z=t(43430),k="object"===typeof t(80341)&&{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}&&!1,S=!k;function C(e,n){var t=(0,u.useState)(e),r=(0,c.Z)(t,2),o=r[0],i=r[1];return(0,u.useEffect)((function(){var t=setTimeout((function(){i(e)}),n);return function(){clearTimeout(t)}}),[e,n]),o}function j(e,n){var t=(0,m.Z)(),r=(0,c.Z)(t,2),o=r[0],i=r[1].width;return(0,u.useEffect)((function(){i&&(0,d.isAlive)(e)&&requestAnimationFrame((function(){return e.setWidth(i-2*Number.parseInt(n,10))}))}),[n,e,i]),o}function A(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,t=(0,u.useRef)(),r=(0,u.useRef)();function o(){r.current&&clearTimeout(r.current)}return(0,u.useEffect)((function(){return o}),[]),function(){for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];t.current=a,o(),r.current=setTimeout((function(){t.current&&e.apply(void 0,(0,s.Z)(t.current))}),n)}}function T(e,n){if(!(0,d.hasParent)(e))throw new Error("node does not have parent");for(var t=(0,d.getParent)(e);t&&(0,d.isAlive)(t);){if(n(t))return t;if(!(0,d.hasParent)(t))break;t=(0,d.getParent)(t)}throw new Error("no matching node found")}function M(e,n,t){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:170,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:26;function c(e){var u=Date.now(),l=e.lastPosition,f=e.lastTime||u,d=e.lastVelocity||0;u>f+64&&(f=u);for(var p=Math.floor(u-f),h=0;h<p;++h){l+=1*(d+=1*((-a*(l-n)+-s*d)/1)/1e3)/1e3}var v=Math.abs(d)<=i,m=0===a||Math.abs(n-l)<=i;v&&m?(t(n),o()):(t(l),r=requestAnimationFrame((function(){return c({lastPosition:l,lastTime:u,lastVelocity:d})})))}return i||(i=Math.abs(n-e)/1e3),[function(){return c({lastPosition:e})},function(){return cancelAnimationFrame(r)}]}function E(e,n){return T(e,n)}function P(e){try{return E(e,h.k$)}catch(n){throw new Error("no session model found!")}}function I(e){try{return E(e,h.zN)}catch(n){throw new Error("no containing view found")}}function N(e){try{return E(e,h.d6)}catch(n){throw new Error("no containing track found")}}function R(e){try{return E(e,h.yZ)}catch(n){throw new Error("no containing display found")}}function D(e){return W(e,Ae)}function W(e){var n,t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e},o=e.assemblyName,i=e.refName,a=e.start,s=e.end,c=e.reversed,u=o?"{".concat(o,"}"):"";n=void 0!==a?":".concat(r(a+1)):void 0!==s?":1":"",t=void 0!==s?void 0!==a&&a+1===s?"":"..".concat(r(s)):void 0!==a?"..":"";var l="";return c&&(l="[rev]"),"".concat(u).concat(i).concat(n).concat(t).concat(l)}function L(e,n){if(!e)throw new Error("no location string provided, could not parse");var t=!1;e.endsWith("[rev]")&&(t=!0,e=e.replace(/\[rev]$/,""));var r=(e=e.replace(/\s/,"")).match(/({(.+)})?(.+)/);if(!r)throw new Error('invalid location string: "'.concat(e,'"'));var o=(0,c.Z)(r,4),i=o[2],a=o[3];if(!i&&a.startsWith("{}"))throw new Error('no assembly name was provided in location "'.concat(a,'"'));var s=a.lastIndexOf(":");if(-1===s){if(n(a,i))return{assemblyName:i,refName:a,reversed:t};throw new Error('Unknown reference sequence "'.concat(a,'"'))}var u=a.slice(0,s),l=a.slice(s+1);if(n(u,i)&&n(a,i))throw new Error('ambiguous location string: "'.concat(e,'"'));if(n(u,i)){if(!l)return{assemblyName:i,refName:u,reversed:t};var f=l.match(/^(-?(\d+|\d{1,3}(,\d{3})*))(\.\.|-)(-?(\d+|\d{1,3}(,\d{3})*))$/),d=l.match(/^(-?(\d+|\d{1,3}(,\d{3})*))(\.\.|-)?$/);if(f){var p=(0,c.Z)(f,6),h=p[1],v=p[5];if(void 0!==h&&void 0!==v)return{assemblyName:i,refName:u,start:+h.replaceAll(",",""),end:+v.replaceAll(",",""),reversed:t}}else{if(!d)throw new Error('could not parse range "'.concat(l,'" on location "').concat(e,'"'));var m=(0,c.Z)(d,5),g=m[1],y=m[4];if(void 0!==g)return y?{assemblyName:i,refName:u,start:+g.replaceAll(",",""),reversed:t}:{assemblyName:i,refName:u,start:+g.replaceAll(",",""),end:+g.replaceAll(",",""),reversed:t}}}else if(n(a,i))return{assemblyName:i,refName:a,reversed:t};throw new Error('unknown reference sequence name in location "'.concat(e,'"'))}function O(e,n){var t=L(e,n);return"number"===typeof t.start&&(t.start-=1),t}function z(e,n){var t=e.assemblyName||n.assemblyName?(e.assemblyName||"").localeCompare(n.assemblyName||""):0;if(t)return t;var r=e.refName||n.refName?(e.refName||"").localeCompare(n.refName||""):0;if(r)return r;if(void 0!==e.start&&void 0!==n.start){var o=e.start-n.start;if(o)return o}if(void 0!==e.end&&void 0!==n.end){var i=e.end-n.end;if(i)return i}return 0}function _(e,n,t){return z(O(e,t),O(n,t))}function U(e,n,t){return e<n?n:e>t?t:e}function V(e,n,t){var r,o=n.reversed,i=n.end,a=void 0===i?0:i,s=n.start;return r=(o?a-e:e-(void 0===s?0:s))/t,Math.round(10*r)/10}var F=180/Math.PI,B=Math.PI/180;function G(e){return e*F%360}function q(e){return e*B%(2*Math.PI)}function J(e,n){return[e*Math.cos(n),e*Math.sin(n)]}function H(e,n){return[Math.sqrt(e*e+n*n),Math.atan(n/e)]}function K(e,n,t){return Q(e.get("start"),e.get("end"),n,t)}function Q(e,n,t,r){var o=V(e,t,r),i=V(n,t,r);return t.reversed?[i,o]:[o,i]}function Y(e,n,t){var r,o=Array.from({length:t||0}),i=0,s=(0,a.Z)(e);try{for(s.s();!(r=s.n()).done;){var c=r.value;o[i]=n(c),i+=1}}catch(u){s.e(u)}finally{s.f()}return o}function $(e,n){for(var t=e.length;t--;)if(n(e[t],t,e))return t;return-1}function X(e,n){for(var t=e.length;t--;)if(n(e[t],t,e))return e[t]}function ee(e,n,t,r,a,s,c){var u;function l(n){(0,v.zF)(n)||((0,d.isAlive)(e)?c(n):console.error(n))}(0,d.addDisposer)(e,(0,p.reaction)((function(){try{return n(e)}catch(t){return void l(t)}}),function(){var n=(0,i.Z)((0,o.Z)().mark((function n(r,i){var c,f;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(u&&!u.signal.aborted&&u.abort(),(0,d.isAlive)(e)){n.next=3;break}return n.abrupt("return");case 3:return u=new AbortController,a(c=u),n.prev=6,n.next=9,t(r,c.signal,e,i);case 9:f=n.sent,(0,v.O8)(c.signal),(0,d.isAlive)(e)&&s(f),n.next=18;break;case 14:n.prev=14,n.t0=n.catch(6),c&&!c.signal.aborted&&c.abort(),l(n.t0);case 18:case"end":return n.stop()}}),n,null,[[6,14]])})));return function(e,t){return n.apply(this,arguments)}}(),r)),(0,d.addDisposer)(e,(function(){u&&!u.signal.aborted&&u.abort()}))}function ne(e,n){if((0,d.isStateTreeNode)(n)&&!(0,d.isAlive)(n))return n;if(n&&null!==e&&void 0!==e&&e[n.refName]){var t=e[(n=(0,d.isStateTreeNode)(n)?(0,r.Z)({},(0,d.getSnapshot)(n)):(0,r.Z)({},n)).refName];if(t)return(0,r.Z)((0,r.Z)({},n),{},{refName:t,originalRefName:n.refName})}return n}function te(e,n){return re.apply(this,arguments)}function re(){return re=(0,i.Z)((0,o.Z)().mark((function e(n,t){var a,c,u,l,f;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.regions,c=void 0===a?[]:a,u=t.adapterConfig,t.sessionId){e.next=3;break}throw new Error("sessionId is required");case 3:return l=c.map((function(e){return e.assemblyName})),e.t0=Object,e.next=7,Promise.all((0,s.Z)(new Set(l)).map(function(){var e=(0,i.Z)((0,o.Z)().mark((function e(r){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=r,e.next=3,n.getRefNameMapForAdapter(u,r,t);case 3:return e.t1=e.sent,e.abrupt("return",[e.t0,e.t1]);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 7:return e.t1=e.sent,f=e.t0.fromEntries.call(e.t0,e.t1),e.abrupt("return",(0,r.Z)((0,r.Z)({},t),{},{regions:c.map((function(e,n){return ne(f[l[n]],e)}))}));case 10:case"end":return e.stop()}}),e)}))),re.apply(this,arguments)}function oe(e,n){return[Math.min(e,n),Math.max(e,n)]}function ie(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:70,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;return e.length>n?e.slice(0,t)+"..."+e.slice(-t):e}function ae(e,n){var t=e.refName,r=e.coord,o=e.assemblyName,i=e.oob;return[o&&n?"{".concat(o,"}"):"",t?"".concat(ie(t),":").concat(Ae(r)).concat(i?" (out of bounds)":""):""].join("")}var se=/electron/i.test("undefined"!==typeof navigator?navigator.userAgent:"");function ce(e){return ue(le(e))}function ue(e){return e.split("").reverse().join("")}var le=function(){var e=/[ACGT]/gi,n={S:"S",w:"w",T:"A",r:"y",a:"t",N:"N",K:"M",x:"x",d:"h",Y:"R",V:"B",y:"r",M:"K",h:"d",k:"m",C:"G",g:"c",t:"a",A:"T",n:"n",W:"W",X:"X",m:"k",v:"b",B:"V",s:"s",H:"D",c:"g",D:"H",b:"v",R:"Y",G:"C"};return function(t){return t.replaceAll(e,(function(e){return n[e]||""}))}}();function fe(e){var n=new FileReader;return new Promise((function(t,r){n.onload=function(e){e.target?t(e.target.result):r(new Error("unknown result reading blob from canvas"))},n.readAsDataURL(e)}))}var de="undefined"===typeof jest?"undefined"!==typeof window&&window.requestIdleCallback?window.requestIdleCallback:function(e){return setTimeout((function(){return e()}),1)}:function(e){return e()},pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2796875,.2765625,.3546875,.5546875,.5546875,.8890625,.665625,.190625,.3328125,.3328125,.3890625,.5828125,.2765625,.3328125,.2765625,.3015625,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.2765625,.2765625,.584375,.5828125,.584375,.5546875,1.0140625,.665625,.665625,.721875,.721875,.665625,.609375,.7765625,.721875,.2765625,.5,.665625,.5546875,.8328125,.721875,.7765625,.665625,.7765625,.721875,.665625,.609375,.721875,.665625,.94375,.665625,.665625,.609375,.2765625,.3546875,.2765625,.4765625,.5546875,.3328125,.5546875,.5546875,.5,.5546875,.5546875,.2765625,.5546875,.5546875,.221875,.240625,.5,.221875,.8328125,.5546875,.5546875,.5546875,.5546875,.3328125,.5,.2765625,.5546875,.5,.721875,.5,.5,.5,.3546875,.259375,.353125,.5890625];function he(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,t=String(e),r=0,o=0;o<t.length;o++){var i,a=t.charCodeAt(o);r+=null!==(i=pe[a])&&void 0!==i?i:.5279276315789471}return r*n}var ve=["ATG"],me=["TAA","TAG","TGA"],ge={TCA:"S",TCC:"S",TCG:"S",TCT:"S",TTC:"F",TTT:"F",TTA:"L",TTG:"L",TAC:"Y",TAT:"Y",TAA:"*",TAG:"*",TGC:"C",TGT:"C",TGA:"*",TGG:"W",CTA:"L",CTC:"L",CTG:"L",CTT:"L",CCA:"P",CCC:"P",CCG:"P",CCT:"P",CAC:"H",CAT:"H",CAA:"Q",CAG:"Q",CGA:"R",CGC:"R",CGG:"R",CGT:"R",ATA:"I",ATC:"I",ATT:"I",ATG:"M",ACA:"T",ACC:"T",ACG:"T",ACT:"T",AAC:"N",AAT:"N",AAA:"K",AAG:"K",AGC:"S",AGT:"S",AGA:"R",AGG:"R",GTA:"V",GTC:"V",GTG:"V",GTT:"V",GCA:"A",GCC:"A",GCG:"A",GCT:"A",GAC:"D",GAT:"D",GAA:"E",GAG:"E",GGA:"G",GGC:"G",GGG:"G",GGT:"G"};function ye(e){var n={};return Object.keys(e).forEach((function(t){for(var r=e[t],o=[],i=0;i<3;i++){var a=t.charAt(i);o[i]=[],o[i][0]=a.toUpperCase(),o[i][1]=a.toLowerCase()}for(var s=0;s<2;s++)for(var c=o[0][s],u=0;u<2;u++)for(var l=o[1][u],f=0;f<2;f++){var d=o[2][f];n[c+l+d]=r}})),n}function be(e,n,t){return we.apply(this,arguments)}function we(){return(we=(0,i.Z)((0,o.Z)().mark((function e(n,t,r){var i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(n),e.next=3,r();case 3:return i=e.sent,t(""),e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xe(e){var n=0;if(0===e.length)return n;for(var t=0;t<e.length;t++){n=(n<<5)-n+e.charCodeAt(t),n|=0}return n}function Ze(e){return"".concat(xe(JSON.stringify(e)))}function ke(e,n){return Se.apply(this,arguments)}function Se(){return(Se=(0,i.Z)((0,o.Z)().mark((function e(n,t){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(n.map((function(e){return t.blocksForRange(e.refName,e.start,e.end)})));case 2:return r=e.sent,e.abrupt("return",r.flat().map((function(e){return{start:e.minv.blockPosition,end:e.maxv.blockPosition+65535}})).reduce((function(e,n){return e+n.end-n.start}),0));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ce(e){return["Gff3TabixAdapter","VcfTabixAdapter","Gff3Adapter","VcfAdapter"].includes(e)}function je(e){return Math.floor(e/1e6)>0?"".concat(Number.parseFloat((e/1e6).toPrecision(3)),"Mbp"):Math.floor(e/1e3)>0?"".concat(Number.parseFloat((e/1e3).toPrecision(3)),"Kbp"):"".concat(Ae(Math.floor(e)),"bp")}function Ae(e){return e.toLocaleString("en-US")}function Te(e,n){return Math.floor(n/1e3)>0?"".concat(Ae(Number.parseFloat((e/1e6).toFixed(2))),"M"):"".concat(Ae(Math.floor(e)))}function Me(e,n){var t=I(e),r=t.dynamicBlocks,o=t.staticBlocks,i=t.offsetPx,a=(null===r||void 0===r?void 0:r.contentBlocks[0])||{},s=(null===o||void 0===o?void 0:o.contentBlocks[0])||{},c=(null===o||void 0===o?void 0:o.contentBlocks[1])||{};return{offsetPx:n?0:i-s.offsetPx,offsetPx1:n?0:i-c.offsetPx,start:a.start,end:a.end}}function Ee(e){return e.sessionId+"-"+e.layoutId}function Pe(e,n){var t=(0,u.useState)((function(){if("undefined"===typeof window)return n;try{var t=window.localStorage.getItem(e);return t?JSON.parse(t):n}catch(r){return console.error(r),n}})),r=(0,c.Z)(t,2),o=r[0],i=r[1];return[o,function(n){try{var t=n instanceof Function?n(o):n;i(t),"undefined"!==typeof window&&window.localStorage.setItem(e,JSON.stringify(t))}catch(r){console.error(r)}}]}function Ie(e){var n,t=e.uri,r=e.baseUri,o=void 0===r?"":r;try{n=new URL(t,o).href}catch(i){n=t}return n}function Ne(e){return f()(e)?(0,h.hb)(e)?Ie(e):JSON.stringify(e):String(e)}function Re(e,n){var t=n||{},r=t.padding,o=void 0===r?30:r,i=t.minWidth,a=void 0===i?80:i,s=t.fontSize,c=void 0===s?12:s,u=t.maxWidth,l=void 0===u?1e3:u,f=t.stripHTML,d=void 0!==f&&f;return Oe(e.map((function(e){return Ne(e)})).map((function(e){return d?e.replaceAll(/(<([^>]+)>)/gi,""):e})).map((function(e){return he(e,c)})).map((function(e){return Math.min(Math.max(e+o,a),l)})))}function De(e){return(0,d.getEnv)(e)}function We(e){return"undefined"!==typeof localStorage?localStorage.getItem(e):void 0}function Le(e,n){return"undefined"!==typeof localStorage?localStorage.setItem(e,n):void 0}function Oe(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0,t=0;t<e.length;t++)n=e[t]>n?e[t]:n;return n}function ze(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,t=0;t<e.length;t++)n=e[t]<n?e[t]:n;return n}function _e(e){for(var n=0,t=0;t<e.length;t++)n+=e[t];return n}function Ue(e){return _e(e)/e.length}function Ve(e,n){var t,r={},o=(0,a.Z)(e);try{for(o.s();!(t=o.n()).done;){var i,s=t.value;(r[i=n(s)]||(r[i]=[])).push(s)}}catch(c){o.e(c)}finally{o.f()}return r}function Fe(e){return null!==e&&void 0!==e}function Be(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;if(e.length<=1)return e;var t=[],r=null;e=e.sort((function(e,n){return e.start-n.start})),t.push(e[0]);for(var o=1;o<e.length;o++)(r=t.at(-1)).end+n<e[o].start-n?t.push(e[o]):r.end<e[o].end&&(r.end=Math.max(r.end,e[o].end),t.pop(),t.push(r));return t}function Ge(e){var n,t={},r=(0,a.Z)(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;t[o.refName]||(t[o.refName]=[]),t[o.refName].push(o)}}catch(i){r.e(i)}finally{r.f()}return Object.values(t).flatMap((function(e){return Be(e.sort((function(e,n){return e.start-n.start})))}))}},48879:function(e,n,t){t.d(n,{KW:function(){return v},ZP:function(){return m},uh:function(){return h}});var r=t(9249),o=t(87371),i=t(45754),a=t(13820),s=t(96902),c=t(87977),u=t(66262),l=t(22820),f=t(69218),d=t(32979),p=t(52089),h=(0,s.lazy)((function(){return t.e(791).then(t.bind(t,40791))})),v=(0,s.lazy)((function(){return t.e(869).then(t.bind(t,80869))})),m=function(e){(0,i.Z)(t,e);var n=(0,a.Z)(t);function t(){var e;(0,r.Z)(this,t);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(e=n.call.apply(n,[this].concat(i))).name="DataManagementPlugin",e.exports={AssemblyManager:v,SetDefaultSession:h},e}return(0,o.Z)(t,[{key:"install",value:function(e){(0,u.Z)(e),(0,l.Z)(e),(0,p.ZP)(e),(0,f.Z)(e),(0,d.Z)(e)}},{key:"configure",value:function(e){}}]),t}(c.Z)},57395:function(e,n,t){t.r(n),t.d(n,{Loader:function(){return xt},default:function(){return kt}});var r=t(33028),o=t(96234),i=t(96902),a=t(4782),s=t(36897),c=t(52044),u=t(79261),l=t(17867),f=(t(72519),t(22272)),d=t(32723),p=t(34795),h=t(63680),v=t(93751),m=t(7583),g=t(19459),y=t(91188),b=t(66552),w=t(49408),x=t(44536),Z=t(25322),k=t(47057),S=t(29938),C=(0,a.observer)((function(e){var n=e.session,t=n.snackbarMessages.at(-1),r=function(e,t){"clickaway"!==t&&n.popSnackbarMessage()};return t?(0,S.jsx)(b.Z,{open:!0,onClose:r,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:(0,S.jsx)(w.Z,{onClose:r,action:t.action?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(x.Z,{color:"inherit",onClick:function(e){var n;null===(n=t.action)||void 0===n||n.onClick(),r()},children:t.action.name}),(0,S.jsx)(Z.Z,{color:"inherit",onClick:r,children:(0,S.jsx)(k.Z,{})})]}):null,severity:t.level||"warning",children:t.message})}):null})),j=t(82658),A=t(50543),T=t(16644),M=t(74859),E=t(41590),P=(0,y.ZL)()((function(e){return{buttonRoot:{"&:hover":{backgroundColor:(0,T.Fq)(e.palette.primary.contrastText,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}}}}));var I=(0,a.observer)((function(e){var n=e.menuTitle,t=e.session,r=e.menuItems,a=(0,i.useState)(!1),s=(0,o.Z)(a,2),c=s[0],u=s[1],l=(0,i.useRef)(null),f=P().classes;function d(){u(!1)}return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(x.Z,{ref:l,onClick:function(){u(!c)},color:"inherit","data-testid":"dropDownMenuButton",classes:{root:f.buttonRoot},children:[n,(0,S.jsx)(M.Z,{})]}),(0,S.jsx)(E.Z,{anchorEl:l.current,anchorOrigin:{vertical:"bottom",horizontal:"left"},onMenuItemClick:function(e,n){n(t),d()},open:c,onClose:d,menuItems:r})]})})),N=t(35130),R=t(99836),D=t(16690),W=(0,a.observer)((function(e){var n=e.session.configuration,t=(0,R.readConfObject)(n,"logoPath");return null!==t&&void 0!==t&&t.uri?(0,S.jsx)("img",{src:t.uri,alt:"Custom logo"}):(0,S.jsx)(D.e,{variant:"white"})})),L=(0,y.ZL)()((function(e){return{grow:{flexGrow:1},inputBase:{color:e.palette.primary.contrastText},inputRoot:{"&:hover":{backgroundColor:e.palette.primary.light}},inputFocused:{borderColor:e.palette.secondary.main,backgroundColor:e.palette.primary.light}}})),O=(0,a.observer)((function(e){var n=e.session,t=e.HeaderButtons,r=void 0===t?(0,S.jsx)("div",{}):t,o=L().classes,i=n.savedSessionNames,a=n.name,s=n.menus;return(0,S.jsxs)(j.Z,{children:[s.map((function(e){return(0,S.jsx)(I,{menuTitle:e.label,menuItems:e.menuItems,session:n},e.label)})),(0,S.jsx)("div",{className:o.grow}),(0,S.jsx)(A.Z,{title:"Rename Session",arrow:!0,children:(0,S.jsx)(N.Z,{value:a,setValue:function(e){null!==i&&void 0!==i&&i.includes(e)?n.notify('Cannot rename session to "'.concat(e,'", a saved session with that name already exists'),"warning"):n.renameCurrentSession(e)},variant:"body1",classes:{inputBase:o.inputBase,inputRoot:o.inputRoot,inputFocused:o.inputFocused}})}),r,(0,S.jsx)("div",{className:o.grow}),(0,S.jsx)("div",{style:{width:150,maxHeight:48},children:(0,S.jsx)(W,{session:n})})]})})),z=t(6880),_=t(35388),U=t(13655),V=t(33266),F=t(15996),B=t(27664),G=(0,y.ZL)()((function(e){return{selectPaper:{padding:e.spacing(4)}}})),q=(0,a.observer)((function(e){var n,t=e.session,r=G().classes,a=(0,B.getEnv)(t).pluginManager.getElementTypeRecord("view").all(),s=(0,i.useState)(null===(n=a[0])||void 0===n?void 0:n.name),c=(0,o.Z)(s,2),u=c[0],l=c[1];return(0,S.jsxs)(z.Z,{className:r.selectPaper,children:[(0,S.jsx)(_.Z,{children:"Select a view to launch"}),(0,S.jsx)(U.Z,{style:{margin:2},children:(0,S.jsx)(V.Z,{value:u,onChange:function(e){return l(e.target.value)},children:a.map((function(e){var n=e.displayName,t=e.name;return(0,S.jsx)(F.Z,{value:t,children:n},t)}))})}),(0,S.jsx)(U.Z,{style:{margin:2},children:(0,S.jsx)(x.Z,{onClick:function(){return t.addView(u,{})},variant:"contained",color:"primary",children:"Launch view"})})]})})),J=t(66379),H=t(20893),K=t(88636),Q=t(21630),Y=t(51467),$=t(68079),X=t(62561),ee=t(4645),ne=t(39077),te=t(41499),re=(0,a.observer)((function(e){var n=e.model,t=(e.IconButtonProps,e.IconProps),o=n.menuItems,i=(0,B.getSession)(n),a=[].concat((0,$.Z)(i.views.length>1?[{label:"Move view up",icon:te.Z,onClick:function(){return i.moveViewUp(n.id)}},{label:"Move view down",icon:ne.Z,onClick:function(){return i.moveViewDown(n.id)}}]:[]),(0,$.Z)(("function"===typeof o?o():o)||[]));return a.length?(0,S.jsx)(X.Z,{menuItems:a,"data-testid":"view_menu_icon",children:(0,S.jsx)(ee.Z,(0,r.Z)((0,r.Z)({},t),{},{fontSize:"small"}))}):null})),oe=(0,y.ZL)()((function(e){return{input:{paddingBottom:0,paddingTop:2},inputBase:{color:e.palette.secondary.contrastText},inputRoot:{"&:hover":{backgroundColor:e.palette.secondary.light}},inputFocused:{borderColor:e.palette.primary.main,backgroundColor:e.palette.secondary.light}}})),ie=(0,a.observer)((function(e){var n,t=e.view,r=oe().classes;return(0,S.jsx)(A.Z,{title:"Rename view",arrow:!0,children:(0,S.jsx)(N.Z,{value:t.displayName||"".concat((null===(n=t.assemblyNames)||void 0===n?void 0:n.join(","))||"Untitled view").concat(t.minimized?" (minimized)":""),setValue:function(e){return t.setDisplayName(e)},variant:"body2",classes:{input:r.input,inputBase:r.inputBase,inputRoot:r.inputRoot,inputFocused:r.inputFocused}})})})),ae=(0,y.ZL)()((function(e){return{viewContainer:{overflow:"hidden",background:e.palette.secondary.main,margin:e.spacing(.5),padding:"0 ".concat(e.spacing(1)," ").concat(e.spacing(1))},icon:{color:e.palette.secondary.contrastText},grow:{flexGrow:1}}})),se=(0,a.observer)((function(e){var n=e.view,t=e.onClose,r=e.onMinimize,o=e.children,a=ae().classes,s=(0,K.Z)(),c=(0,B.useWidthSetter)(n,s.spacing(1)),u=(0,i.useRef)(null);return(0,i.useEffect)((function(){var e,n;null===(e=u.current)||void 0===e||null===(n=e.scrollIntoView)||void 0===n||n.call(e,{block:"center"})}),[]),(0,S.jsxs)(z.Z,{ref:c,elevation:12,className:a.viewContainer,children:[(0,S.jsxs)("div",{ref:u,style:{display:"flex"},children:[(0,S.jsx)(re,{model:n,IconProps:{className:a.icon}}),(0,S.jsx)("div",{className:a.grow}),(0,S.jsx)(ie,{view:n}),(0,S.jsx)("div",{className:a.grow}),(0,S.jsx)(Z.Z,{"data-testid":"minimize_view",onClick:r,children:n.minimized?(0,S.jsx)(Y.Z,{className:a.icon,fontSize:"small"}):(0,S.jsx)(Q.Z,{className:a.icon,fontSize:"small"})}),(0,S.jsx)(Z.Z,{"data-testid":"close_view",onClick:t,children:(0,S.jsx)(k.Z,{className:a.icon,fontSize:"small"})})]}),(0,S.jsx)(z.Z,{children:o})]})})),ce=(0,a.observer)((function(e){var n=e.view,t=e.session,r=(0,B.getEnv)(t).pluginManager.getViewType(n.type);if(!r)throw new Error("unknown view type ".concat(n.type));var o=r.ReactComponent;return(0,S.jsx)(se,{view:n,onClose:function(){return t.removeView(n)},onMinimize:function(){return n.setMinimized(!n.minimized)},children:!n.minimized&&(0,S.jsx)(s.SV,{FallbackComponent:function(e){var n=e.error;return(0,S.jsx)(J.Z,{error:n})},children:(0,S.jsx)(i.Suspense,{fallback:(0,S.jsx)(H.Z,{variant:"h6"}),children:(0,S.jsx)(o,{model:n,session:t})})})})})),ue=(0,a.observer)((function(e){var n=e.session,t=n.DialogComponent,o=n.DialogProps;return(0,S.jsx)(S.Fragment,{children:t?(0,S.jsx)(i.Suspense,{fallback:(0,S.jsx)(i.Fragment,{}),children:(0,S.jsx)(t,(0,r.Z)({},o))}):null})})),le=t(88539),fe=t(8019),de=(0,y.ZL)()((function(e){return{left:{zIndex:1e4,position:"fixed",bottom:e.spacing(2),left:e.spacing(2)},right:{zIndex:1e4,position:"fixed",bottom:e.spacing(2),right:e.spacing(2)}}})),pe=(0,a.observer)((function(e){var n=e.session,t=n.minimized,r=n.activeWidgets,o=n.drawerPosition,i=de().classes;return r.size>0&&t?(0,S.jsx)(A.Z,{title:"Open drawer widget",children:(0,S.jsx)(le.Z,{className:"right"===o?i.right:i.left,color:"primary","data-testid":"drawer-maximize",onClick:function(){return n.showWidgetDrawer()},children:(0,S.jsx)(fe.Z,{})})}):null})),he=(0,i.lazy)((function(){return t.e(3017).then(t.bind(t,33017))})),ve=(0,y.ZL)()((function(e){return{root:{display:"grid",height:"100vh",width:"100%",colorScheme:e.palette.mode},appContainer:{gridColumn:"main",display:"grid",gridTemplateRows:"[menubar] min-content [components] auto",height:"100vh"},viewContainer:{overflowY:"auto",gridRow:"components"},appBar:{flexGrow:1,gridRow:"menubar"}}})),me=(0,a.observer)((function(e){var n=e.session;return(0,S.jsx)(i.Suspense,{fallback:(0,S.jsx)(i.Fragment,{}),children:(0,S.jsx)(he,{session:n})})})),ge=(0,a.observer)((function(e){var n=e.session,t=n.views,o=ve().classes;return(0,S.jsxs)("div",{className:o.viewContainer,children:[t.length>0?t.map((function(e){return(0,S.jsx)(ce,{view:e,session:n},"view-".concat(e.id))})):(0,S.jsx)(q,(0,r.Z)({},e)),(0,S.jsx)("div",{style:{height:300}})]})})),ye=(0,a.observer)((function(e){var n=e.session,t=ve().classes,o=n.minimized,i=n.visibleWidget,a=n.drawerWidth,s=n.drawerPosition,c=i&&!o,u=c?"[drawer] ".concat(a,"px"):void 0,l="right"===s?["[main] 1fr",u]:[u,"[main] 1fr"];return(0,S.jsxs)("div",{className:t.root,style:{gridTemplateColumns:null===l||void 0===l?void 0:l.filter((function(e){return!!e})).join(" ")},children:[c&&"left"===s?(0,S.jsx)(me,{session:n}):null,(0,S.jsx)(ue,{session:n}),(0,S.jsxs)("div",{className:t.appContainer,children:[(0,S.jsx)(g.Z,{className:t.appBar,position:"static",children:(0,S.jsx)(O,(0,r.Z)({},e))}),(0,S.jsx)(ge,(0,r.Z)({},e))]}),(0,S.jsx)(pe,{session:n}),c&&"right"===s?(0,S.jsx)(me,{session:n}):null,(0,S.jsx)(C,{session:n})]})}));var be=h.types.model("TimeTraveller",{undoIdx:-1,targetPath:""}).volatile((function(){return{history:[],notTrackingUndo:!1}})).views((function(e){return{get canUndo(){return e.undoIdx>0&&!e.notTrackingUndo},get canRedo(){return e.undoIdx<e.history.length-1&&!e.notTrackingUndo}}})).actions((function(e){var n,t,r=!1;return{stopTrackingUndo:function(){e.notTrackingUndo=!0},resumeTrackingUndo:function(){e.notTrackingUndo=!1},addUndoState:function(n){e.notTrackingUndo||(r?r=!1:(e.history.splice(e.undoIdx+1),e.history.push(n),e.history.length>20&&e.history.shift(),e.undoIdx=e.history.length-1))},beforeDestroy:function(){t()},initialize:function(){var r=this;if(!(n=e.targetPath?(0,h.resolvePath)(e,e.targetPath):(0,h.getEnv)(e).targetStore))throw new Error("Failed to find target store for TimeTraveller. Please provide `targetPath` property, or a `targetStore` in the environment");t=(0,h.onSnapshot)(n,function(e){var n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];clearTimeout(n),n=setTimeout((function(){return e.apply(void 0,o)}),t)}}((function(e){return r.addUndoState(e)}),300)),0===e.history.length&&this.addUndoState((0,h.getSnapshot)(n))},undo:function(){e.undoIdx--,r=!0,(0,h.applySnapshot)(n,e.history[e.undoIdx])},redo:function(){e.undoIdx++,r=!0,(0,h.applySnapshot)(n,e.history[e.undoIdx])}}})),we=be,xe=t(75717);var Ze=t(9249),ke=t(87371);var Se=(0,R.ConfigurationSchema)("BaseRpcDriver",{workerCount:{type:"number",description:"The number of workers to use. If 0 (the default) JBrowse will decide how many workers to use.",defaultValue:0}},{explicitlyTyped:!0});var Ce=(0,R.ConfigurationSchema)("WebWorkerRpcDriver",{},{baseConfiguration:Se,explicitlyTyped:!0});var je=(0,R.ConfigurationSchema)("MainThreadRpcDriver",{},{baseConfiguration:Se,explicitlyTyped:!0});var Ae=(0,R.ConfigurationSchema)("RpcOptions",{defaultDriver:{type:"string",description:"the RPC driver to use for tracks and tasks that are not configured to use a specific RPC backend",defaultValue:"MainThreadRpcDriver"},drivers:h.types.optional(h.types.map(h.types.union(je,Ce)),{MainThreadRpcDriver:{type:"MainThreadRpcDriver"},WebWorkerRpcDriver:{type:"WebWorkerRpcDriver"}})},{actions:function(e){return{addDriverConfig:function(n,t){e.drivers.set(n,t)}}}}),Te=t(93069),Me=t(95058),Ee=t(45754),Pe=t(13820),Ie=t(81018),Ne=t(26968),Re=t.n(Ne),De=t(95439);function We(e){return!("function"===typeof e)&&!(e instanceof Error)}function Le(e,n,t){return Oe.apply(this,arguments)}function Oe(){return(Oe=(0,p.Z)((0,d.Z)().mark((function e(n,t,r){return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,n.call("ping",[],{timeout:2*t,rpcDriverClassName:r});case 3:return e.next=5,new Promise((function(e){return setTimeout(e,t)}));case 5:e.next=0;break;case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ze=function(){function e(n){(0,Ze.Z)(this,e),this.driver=n,this.workerP=void 0}return(0,ke.Z)(e,[{key:"getWorker",value:function(){var e=(0,p.Z)((0,d.Z)().mark((function e(){var n=this;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.workerP||(this.workerP=this.driver.makeWorker().then((function(e){return Le(e,n.driver.maxPingTime,n.driver.name).catch((function(t){e&&(console.error("worker did not respond, killing and generating new one"),console.error(t),e.destroy(),e.status="killed",e.error=t,n.workerP=void 0)})),e})).catch((function(e){throw n.workerP=void 0,e}))),e.abrupt("return",this.workerP);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),_e=function(){function e(n){(0,Ze.Z)(this,e),this.name=void 0,this.lastWorkerAssignment=-1,this.workerAssignments=new Map,this.workerPool=void 0,this.maxPingTime=3e4,this.workerCheckFrequency=5e3,this.config=void 0,this.config=n.config}return(0,ke.Z)(e,[{key:"filterArgs",value:function(e,n){var t=this;if(Array.isArray(e))return e.filter((function(e){return We(e)})).map((function(e){return t.filterArgs(e,n)}));if("object"===typeof e&&null!==e){if(e instanceof AbortSignal)return(0,De.Iy)(e,this.remoteAbort.bind(this,n));if((0,h.isStateTreeNode)(e)&&!(0,h.isAlive)(e))throw new Error("dead state tree node passed to RPC call");return e instanceof File?e:Object.fromEntries(Object.entries(e).filter((function(e){return We(e[1])})).map((function(e){var r=(0,o.Z)(e,2),i=r[0],a=r[1];return[i,t.filterArgs(a,n)]})))}return e}},{key:"remoteAbort",value:function(){var e=(0,p.Z)((0,d.Z)().mark((function e(n,t,r){var o;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getWorker(n);case 2:return o=e.sent,e.next=5,o.call(t,{signalId:r},{timeout:1e6,rpcDriverClassName:this.name});case 5:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()},{key:"createWorkerPool",value:function(){for(var e=function(){var e="undefined"!==typeof window,n=e&&"hardwareConcurrency"in window.navigator;return e&&n?window.navigator.hardwareConcurrency:1}(),n=(0,R.readConfObject)(this.config,"workerCount")||(0,B.clamp)(1,Math.max(1,e-1),5),t=[],r=0;r<n;r++)t.push(new ze(this));return t}},{key:"getWorkerPool",value:function(){if(!this.workerPool){var e=this.createWorkerPool();return this.workerPool=e,e}return this.workerPool}},{key:"getWorker",value:function(){var e=(0,p.Z)((0,d.Z)().mark((function e(n){var t,r,o;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getWorkerPool(),void 0===(r=this.workerAssignments.get(n))&&(o=(this.lastWorkerAssignment+1)%t.length,this.workerAssignments.set(n,o),this.lastWorkerAssignment=o,r=o),e.abrupt("return",t[r].getWorker());case 4:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"call",value:function(){var e=(0,p.Z)((0,d.Z)().mark((function e(n,t,o,i){var a,s,c,u,l,f,p,h,v,m,g=this,y=arguments;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=y.length>4&&void 0!==y[4]?y[4]:{},t){e.next=3;break}throw new TypeError("sessionId is required");case 3:return s=!1,e.next=6,this.getWorker(t);case 6:return c=e.sent,u=n.getRpcMethodType(o),e.next=10,u.serializeArguments(i,this.name);case 10:return l=e.sent,f=this.filterArgs(l,t),p=c.call(o,f,(0,r.Z)({timeout:3e5,statusCallback:i.statusCallback,rpcDriverClassName:this.name},a)).finally((function(){s=!0})),v=new Promise((function(e,n){h=setInterval((function(){"killed"===c.status?n(new Error("operation timed out, worker process stopped responding, ".concat(c.error))):s&&e(!0)}),g.workerCheckFrequency)})).finally((function(){clearInterval(h)})),m=Promise.race([p,v]),e.abrupt("return",u.deserializeReturn(m,i,this.name));case 16:case"end":return e.stop()}}),e,this)})));return function(n,t,r,o){return e.apply(this,arguments)}}()}]),e}(),Ue=t(96699),Ve=function(e){(0,Ee.Z)(t,e);var n=(0,Pe.Z)(t);function t(){return(0,Ze.Z)(this,t),n.apply(this,arguments)}return(0,ke.Z)(t,[{key:"destroy",value:function(){this.workers[0].terminate()}},{key:"call",value:function(){var e=(0,p.Z)((0,d.Z)().mark((function e(n,o,i){var a,s,c,u,l;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.statusCallback,s=i.rpcDriverClassName,c="message-".concat(Re().generate()),u=function(e){null===a||void 0===a||a(e)},this.on(c,u),e.next=6,(0,Te.Z)((0,Me.Z)(t.prototype),"call",this).call(this,n,(0,r.Z)((0,r.Z)({},o),{},{channel:c,rpcDriverClassName:s}),i);case 6:return l=e.sent,this.off(c,u),e.abrupt("return",l);case 9:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()}]),t}(Ie.Z.Client),Fe=function(e){(0,Ee.Z)(t,e);var n=(0,Pe.Z)(t);function t(e,r){var o;return(0,Ze.Z)(this,t),(o=n.call(this,e)).workerBootConfiguration=r,o.name="WebWorkerRpcDriver",o.makeWorkerInstance=void 0,o.makeWorkerInstance=e.makeWorkerInstance,o}return(0,ke.Z)(t,[{key:"makeWorker",value:function(){var e=(0,p.Z)((0,d.Z)().mark((function e(){var n,t,r=this;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.makeWorkerInstance(),t=new Ve({workers:[n]}),/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&console.log("console logging the webworker handle avoids the track going into an infinite loading state, this is a hacky workaround for safari",n),e.abrupt("return",new Promise((function(e,n){t.workers[0].addEventListener("message",(function o(i){switch(i.data.message){case"ready":e(t),t.workers[0].removeEventListener("message",o);break;case"readyForConfig":t.workers[0].postMessage({message:"config",config:r.workerBootConfiguration});break;case"error":n((0,Ue.deserializeError)(i.data.error))}}))})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(_e),Be=function(){function e(){(0,Ze.Z)(this,e)}return(0,ke.Z)(e,[{key:"destroy",value:function(){}},{key:"call",value:function(){var e=(0,p.Z)((0,d.Z)().mark((function e(n,t){var r=arguments;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.length>2&&void 0!==r[2]?r[2]:{},e.abrupt("return",void 0);case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()}]),e}(),Ge=function(e){(0,Ee.Z)(t,e);var n=(0,Pe.Z)(t);function t(e){var r;return(0,Ze.Z)(this,t),(r=n.call(this,e)).name="MainThreadRpcDriver",r.makeWorker=void 0,r.makeWorker=(0,p.Z)((0,d.Z)().mark((function e(){return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Be);case 1:case"end":return e.stop()}}),e)}))),r}return(0,ke.Z)(t,[{key:"call",value:function(){var e=(0,p.Z)((0,d.Z)().mark((function e(n,t,r,o){var i,a,s;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new TypeError("sessionId is required");case 2:return i=n.getRpcMethodType(r),e.next=5,i.serializeArguments(o,this.name);case 5:return a=e.sent,e.next=8,i.execute(a,this.name);case 8:return s=e.sent,e.abrupt("return",i.deserializeReturn(s,o,this.name));case 10:case"end":return e.stop()}}),e,this)})));return function(n,t,r,o){return e.apply(this,arguments)}}()}]),t}(_e),qe=function(){function e(n,t,r){if((0,Ze.Z)(this,e),this.pluginManager=n,this.mainConfiguration=t,this.backendConfigurations=r,this.driverObjects=void 0,!t)throw new Error("RpcManager requires at least a main configuration");this.driverObjects=new Map}return(0,ke.Z)(e,[{key:"getDriver",value:function(e){var n,t=this.driverObjects.get(e);if(t)return t;var o=this.mainConfiguration.drivers.get("WebWorkerRpcDriver");if("MainThreadRpcDriver"===e){var i=this.backendConfigurations.MainThreadRpcDriver;if(!i)throw new Error('requested RPC driver "'.concat(e,'" is missing config'));n=new Ge((0,r.Z)((0,r.Z)({},i),{},{config:o}))}else{if("WebWorkerRpcDriver"!==e)throw new Error('requested RPC driver "'.concat(e,'" is not installed'));var a=this.backendConfigurations.WebWorkerRpcDriver;if(!a)throw new Error('requested RPC driver "'.concat(e,'" is missing config'));n=new Fe((0,r.Z)((0,r.Z)({},a),{},{config:o}),{plugins:this.pluginManager.runtimePluginDefinitions,windowHref:window.location.href})}return this.driverObjects.set(e,n),n}},{key:"getDriverForCall",value:function(){var e=(0,p.Z)((0,d.Z)().mark((function e(n,t,r){var o;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.rpcDriverName||(0,R.readConfObject)(this.mainConfiguration,"defaultDriver"),e.abrupt("return",this.getDriver(o));case 2:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()},{key:"call",value:function(){var e=(0,p.Z)((0,d.Z)().mark((function e(n,t,r){var o,i,a=arguments;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=a.length>3&&void 0!==a[3]?a[3]:{},n){e.next=3;break}throw new Error("sessionId is required");case 3:return e.next=5,this.getDriverForCall(n,t,r);case 5:return i=e.sent,e.abrupt("return",i.call(this.pluginManager,n,t,r,o));case 7:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()}]),e}();function Je(e){return function(e){var n=e.pluginManager,t=e.assemblyConfigSchema;return h.types.model("JBrowseConfig",{configuration:(0,R.ConfigurationSchema)("Root",(0,r.Z)({rpc:qe.configSchema,highResolutionScaling:{type:"number",defaultValue:2},formatDetails:(0,R.ConfigurationSchema)("FormatDetails",{feature:{type:"frozen",description:"adds extra fields to the feature details",defaultValue:{},contextVariable:["feature"]},subfeatures:{type:"frozen",description:"adds extra fields to the subfeatures of a feature",defaultValue:{},contextVariable:["feature"]},depth:{type:"number",defaultValue:2,description:"depth to iterate on subfeatures"}}),formatAbout:(0,R.ConfigurationSchema)("FormatAbout",{config:{type:"frozen",description:"formats configuration object in about dialog",defaultValue:{},contextVariable:["config"]},hideUris:{type:"boolean",defaultValue:!1}}),shareURL:{type:"string",defaultValue:"https://share.jbrowse.org/api/v1/"},disableAnalytics:{type:"boolean",defaultValue:!1},hierarchical:(0,R.ConfigurationSchema)("hierarchical",{sort:(0,R.ConfigurationSchema)("hierarchicalSort",{trackNames:{type:"boolean",defaultValue:!1},categories:{type:"boolean",defaultValue:!1}}),defaultCollapsed:(0,R.ConfigurationSchema)("defaultCollapsed",{categoryNames:{type:"stringArray",defaultValue:[]},topLevelCategories:{type:"boolean",defaultValue:!1},subCategories:{type:"boolean",defaultValue:!1}})}),theme:{type:"frozen",defaultValue:{}},extraThemes:{type:"frozen",defaultValue:{}},logoPath:{type:"fileLocation",defaultValue:{uri:"",locationType:"UriLocation"}}},n.pluginConfigurationSchemas())),plugins:h.types.array(h.types.frozen()),assemblies:h.types.array(t),tracks:h.types.array(n.pluggableConfigSchemaType("track")),internetAccounts:h.types.array(n.pluggableConfigSchemaType("internet account")),aggregateTextSearchAdapters:h.types.array(n.pluggableConfigSchemaType("text search adapter")),connections:h.types.array(n.pluggableConfigSchemaType("connection")),defaultSession:h.types.optional(h.types.frozen(),{name:"New Session"})})}({pluginManager:e.pluginManager,assemblyConfigSchema:e.assemblyConfigSchema}).views((function(e){return{get assemblyNames(){return e.assemblies.map((function(e){return(0,R.readConfObject)(e,"name")}))},get rpcManager(){return(0,h.getParent)(e).rpcManager}}})).actions((function(e){return{addAssemblyConf:function(n){var t=n.name;if(!t)throw new Error('Can\'t add assembly with no "name"');if(e.assemblyNames.includes(t))throw new Error("Can't add assembly with name \"".concat(t,'", an assembly with that name already exists'));var o=e.assemblies.push((0,r.Z)((0,r.Z)({},n),{},{sequence:(0,r.Z)({type:"ReferenceSequenceTrack",trackId:"".concat(t,"-").concat(Date.now())},n.sequence)}));return e.assemblies[o-1]},removeAssemblyConf:function(n){var t=e.assemblies.find((function(e){return e.name===n}));t&&e.assemblies.remove(t)},addTrackConf:function(n){var t=n.type;if(!t)throw new Error("unknown track type ".concat(t));var r=e.tracks.push(n);return e.tracks[r-1]},addConnectionConf:function(n){var t=n.type;if(!t)throw new Error("unknown connection type ".concat(t));var r=e.connections.push(n);return e.connections[r-1]},deleteConnectionConf:function(n){var t=e.connections.find((function(e){return e.id===n.id}));return e.connections.remove(t)},deleteTrackConf:function(n){var t=e.tracks.find((function(e){return e.trackId===n.trackId}));return e.tracks.remove(t)},addPlugin:function(n){e.plugins.push(n),(0,h.getParent)(e).setPluginsUpdated(!0)},removePlugin:function(n){e.plugins=(0,h.cast)(e.plugins.filter((function(e){return e.url!==n.url||e.umdUrl!==n.umdUrl||e.cjsUrl!==n.cjsUrl||e.esmUrl!==n.esmUrl}))),(0,h.getParent)(e).setPluginsUpdated(!0)},addInternetAccountConf:function(n){var t=n.type;if(!t)throw new Error("unknown internetAccount type ".concat(t));var r=e.internetAccounts.push(n);return e.internetAccounts[r-1]},deleteInternetAccountConf:function(n){var t=e.internetAccounts.find((function(e){return e.id===n.id}));return e.internetAccounts.remove(t)}}}))}qe.configSchema=Ae;var He=t(43647),Ke=(0,y.ZL)()((function(e){return{shareDiv:{textAlign:"center",paddingLeft:"2px"},shareButton:{backgroundColor:(0,T.Fq)(e.palette.primary.contrastText,e.palette.action.hoverOpacity),"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}})),Qe=(0,i.lazy)((function(){return t.e(7086).then(t.bind(t,67086))})),Ye=(0,a.observer)((function(e){var n=(0,i.useState)(!1),t=(0,o.Z)(n,2),r=t[0],a=t[1],s=e.session,c=Ke().classes;return(0,S.jsxs)("div",{className:c.shareDiv,children:[(0,S.jsx)(x.Z,{onClick:(0,p.Z)((0,d.Z)().mark((function e(){return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a(!0));case 1:case"end":return e.stop()}}),e)}))),size:"small",color:"inherit",startIcon:(0,S.jsx)(He.Z,{}),classes:{root:c.shareButton},children:"Share"}),r?(0,S.jsx)(i.Suspense,{fallback:(0,S.jsx)(i.Fragment,{}),children:(0,S.jsx)(Qe,{handleClose:function(){return a(!1)},session:s})}):null]})})),$e=t(48879);var Xe=(0,a.observer)((function(e){var n=e.pluginManager.rootModel,t=n,r=t.isAssemblyEditing,o=t.isDefaultSessionEditing,i=t.setDefaultSessionEditing,a=t.setAssemblyEditing;return(0,S.jsxs)(S.Fragment,{children:[r?(0,S.jsx)($e.KW,{rootModel:n,onClose:function(){return a(!1)}}):null,o?(0,S.jsx)($e.uh,{rootModel:n,onClose:function(){return i(!1)}}):null]})})),en=(0,a.observer)((function(e){var n=e.pluginManager,t=(0,c.useQueryParam)("adminKey",c.StringParam),r=(0,o.Z)(t,1)[0],a=(0,c.useQueryParam)("adminServer",c.StringParam),s=(0,o.Z)(a,1)[0],u=(0,c.useQueryParam)("config",c.StringParam),l=(0,o.Z)(u,1)[0],f=(0,c.useQueryParam)("session",c.StringParam),g=(0,o.Z)(f,2)[1],y=n.rootModel,b=y||{},w=b.error,x=b.jbrowse,Z=null===y||void 0===y?void 0:y.session,k=Z.id;if((0,i.useEffect)((function(){g("local-".concat(k)),window.JBrowseRootModel=y,window.JBrowseSession=Z}),[k,y,Z,g]),(0,i.useEffect)((function(){if(x&&r)return(0,h.onSnapshot)(x,function(){var e=(0,p.Z)((0,d.Z)().mark((function e(n){var t,o;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(s||"/updateConfig",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminKey:r,configPath:l,config:n})});case 3:if((t=e.sent).ok){e.next=9;break}return e.next=7,t.text();case 7:throw o=e.sent,new Error("HTTP ".concat(t.status," (").concat(o,")"));case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),null===Z||void 0===Z||Z.notify("Admin server error: ".concat(e.t0));case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(n){return e.apply(this,arguments)}}())}),[x,Z,r,s,l]),w)throw w;if(!y)throw new Error("No rootModel found");if(!Z)throw new Error("No session found");return(0,S.jsxs)(v.Z,{theme:Z.theme,children:[(0,S.jsx)(m.ZP,{}),(0,S.jsx)(ye,{session:Z,HeaderButtons:(0,S.jsx)(Ye,{session:Z})}),r?(0,S.jsx)(Xe,{pluginManager:n}):null]})})),nn=t(73207),tn=t(15659),rn=t(32145),on=t(65828),an=t(35719),sn=h.types.model({configPath:h.types.maybe(h.types.string),sessionQuery:h.types.maybe(h.types.string),password:h.types.maybe(h.types.string),adminKey:h.types.maybe(h.types.string),loc:h.types.maybe(h.types.string),sessionTracks:h.types.maybe(h.types.string),assembly:h.types.maybe(h.types.string),tracks:h.types.maybe(h.types.string),initialTimestamp:h.types.number}).volatile((function(){return{blankSession:!1,sessionTriaged:void 0,shareWarningOpen:!1,configSnapshot:void 0,sessionSnapshot:void 0,sessionSpec:void 0,runtimePlugins:[],sessionPlugins:[],sessionError:void 0,configError:void 0,bc1:window.BroadcastChannel&&new window.BroadcastChannel("jb_request_session"),bc2:window.BroadcastChannel&&new window.BroadcastChannel("jb_respond_session")}})).views((function(e){return{get isSharedSession(){var n;return!(null===(n=e.sessionQuery)||void 0===n||!n.startsWith("share-"))},get isSpecSession(){var n;return!(null===(n=e.sessionQuery)||void 0===n||!n.startsWith("spec-"))},get isJb1StyleSession(){return!!e.loc},get isEncodedSession(){var n;return!(null===(n=e.sessionQuery)||void 0===n||!n.startsWith("encoded-"))},get isJsonSession(){var n;return!(null===(n=e.sessionQuery)||void 0===n||!n.startsWith("json-"))},get isLocalSession(){var n;return!(null===(n=e.sessionQuery)||void 0===n||!n.startsWith("local-"))},get ready(){return Boolean(this.isSessionLoaded&&!e.configError)},get error(){return e.configError||e.sessionError},get isSessionLoaded(){return Boolean(e.sessionError||e.sessionSnapshot||e.blankSession||e.sessionSpec)},get isConfigLoaded(){return Boolean(e.configError||e.configSnapshot)},get sessionTracksParsed(){return e.sessionTracks?JSON.parse(e.sessionTracks):[]}}})).actions((function(e){return{setSessionQuery:function(n){e.sessionQuery=n},setConfigError:function(n){e.configError=n},setSessionError:function(n){e.sessionError=n},setRuntimePlugins:function(n){e.runtimePlugins=n},setSessionPlugins:function(n){e.sessionPlugins=n},setConfigSnapshot:function(n){e.configSnapshot=n},setBlankSession:function(n){e.blankSession=n},setSessionTriaged:function(n){e.sessionTriaged=n},setSessionSnapshotSuccess:function(n){e.sessionSnapshot=n}}})).actions((function(e){return{fetchPlugins:function(n){return(0,p.Z)((0,d.Z)().mark((function t(){var r,o;return(0,d.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(r=new tn.ZP(n.plugins,{fetchESM:function(e){return import(e)}})).installGlobalReExports(window),t.next=5,r.load(window.location.href);case 5:o=t.sent,e.setRuntimePlugins((0,$.Z)(o)),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0),e.setConfigError(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()},fetchSessionPlugins:function(n){return(0,p.Z)((0,d.Z)().mark((function t(){var r,o;return(0,d.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(r=new tn.ZP(n.sessionPlugins||[],{fetchESM:function(e){return import(e)}})).installGlobalReExports(window),t.next=5,r.load(window.location.href);case 5:o=t.sent,e.setSessionPlugins((0,$.Z)(o)),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0),e.setConfigError(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()},setSessionSnapshot:function(n,t){var r=this;return(0,p.Z)((0,d.Z)().mark((function o(){var i,a;return(0,d.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,i=n.sessionPlugins,a=void 0===i?[]:i,o.next=4,(0,an.t$)(a);case 4:if(!o.sent&&!t){o.next=11;break}return o.next=8,r.fetchSessionPlugins(n);case 8:e.setSessionSnapshotSuccess(n),o.next=12;break;case 11:e.setSessionTriaged({snap:n,origin:"session",reason:a});case 12:o.next=18;break;case 14:o.prev=14,o.t0=o.catch(0),console.error(o.t0),e.setConfigError(o.t0);case 18:case"end":return o.stop()}}),o,null,[[0,14]])})))()},fetchConfig:function(){var n=this;return(0,p.Z)((0,d.Z)().mark((function t(){var r,o,i,a,s,c;return(0,d.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.configPath,o=void 0===r?"config.json":r,window.__jbrowseCacheBuster&&(o+="?rand=".concat(Math.random())),t.next=4,(0,rn.openLocation)({uri:o,locationType:"UriLocation"}).readFile("utf8");case 4:if(i=t.sent,a=JSON.parse(i),s=new URL(o,window.location.href),(0,an.H1)(a,s),s.hostname===window.location.hostname){t.next=15;break}return c=a.plugins||[],t.next=12,(0,an.t$)(c);case 12:if(t.sent){t.next=15;break}return t.abrupt("return",e.setSessionTriaged({snap:a,origin:"config",reason:c}));case 15:return t.next=17,n.fetchPlugins(a);case 17:e.setConfigSnapshot(a);case 18:case"end":return t.stop()}}),t)})))()},fetchSessionStorageSession:function(){var n=this;return(0,p.Z)((0,d.Z)().mark((function t(){var o,i,a,s;return(0,d.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=sessionStorage.getItem("current"),i=e.sessionQuery.replace("local-",""),!o){t.next=6;break}if(a=JSON.parse(o).session||{},i!==a.id){t.next=6;break}return t.abrupt("return",n.setSessionSnapshot(a));case 6:if(!e.bc1){t.next=17;break}return e.bc1.postMessage(i),t.prev=8,t.next=11,new Promise((function(n,t){e.bc2&&(e.bc2.onmessage=function(e){n(e.data)}),setTimeout((function(){return t()}),1e3)}));case 11:return s=t.sent,t.abrupt("return",n.setSessionSnapshot((0,r.Z)((0,r.Z)({},s),{},{id:Re()()})));case 15:t.prev=15,t.t0=t.catch(8);case 17:throw new Error("Local storage session not found");case 18:case"end":return t.stop()}}),t,null,[[8,15]])})))()},fetchSharedSession:function(){var n=this;return(0,p.Z)((0,d.Z)().mark((function t(){var o,i;return(0,d.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"https://share.jbrowse.org/api/v1/",t.next=3,(0,on.h)("".concat((0,an.bP)(e.configSnapshot,"shareURL","https://share.jbrowse.org/api/v1/"),"load"),e.sessionQuery||"",e.password||"");case 3:return o=t.sent,t.t0=JSON,t.next=7,(0,an.cD)(o);case 7:return t.t1=t.sent,i=t.t0.parse.call(t.t0,t.t1),t.next=11,n.setSessionSnapshot((0,r.Z)((0,r.Z)({},i),{},{id:Re()()}));case 11:case"end":return t.stop()}}),t)})))()},decodeEncodedUrlSession:function(){var n=this;return(0,p.Z)((0,d.Z)().mark((function t(){var o;return(0,d.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=JSON,t.next=3,(0,an.cD)(e.sessionQuery.replace("encoded-",""));case 3:return t.t1=t.sent,o=t.t0.parse.call(t.t0,t.t1),t.next=7,n.setSessionSnapshot((0,r.Z)((0,r.Z)({},o),{},{id:Re()()}));case 7:case"end":return t.stop()}}),t)})))()},decodeSessionSpec:function(){e.sessionQuery&&(e.sessionSpec=JSON.parse(e.sessionQuery.replace("spec-","")))},decodeJb1StyleSession:function(){var n=e.loc,t=e.tracks,r=e.assembly,o=e.sessionTracksParsed;n&&(e.sessionSpec={sessionTracks:o,views:[{type:"LinearGenomeView",tracks:null===t||void 0===t?void 0:t.split(","),sessionTracks:o,loc:n,assembly:r}]})},decodeJsonUrlSession:function(){var n=this;return(0,p.Z)((0,d.Z)().mark((function t(){var o;return(0,d.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=JSON.parse(e.sessionQuery.replace("json-","")),t.next=3,n.setSessionSnapshot((0,r.Z)((0,r.Z)({},o.session),{},{id:Re()()}));case 3:case"end":return t.stop()}}),t)})))()},afterCreate:function(){var n=this;return(0,p.Z)((0,d.Z)().mark((function t(){var r,o;return(0,d.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{r=e.configPath,(o=localStorage.getItem("autosave-".concat(r)))&&localStorage.setItem("previousAutosave-".concat(r),o)}catch(i){console.error("failed to create previousAutosave",i)}return t.prev=1,t.next=4,n.fetchConfig();case 4:t.next=11;break;case 6:return t.prev=6,t.t0=t.catch(1),console.error(t.t0),e.setConfigError(t.t0),t.abrupt("return");case 11:(0,h.addDisposer)(e,(0,xe.autorun)((0,p.Z)((0,d.Z)().mark((function t(){var r,o,i,a,s,c,u;return(0,d.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=e.isLocalSession,o=e.isEncodedSession,i=e.isSpecSession,a=e.isSharedSession,s=e.isJsonSession,c=e.isJb1StyleSession,u=e.sessionQuery,e.configSnapshot){t.next=4;break}return t.abrupt("return");case 4:if(e.bc1&&(e.bc1.onmessage=function(n){var t=JSON.parse(sessionStorage.getItem("current")||"{}").session||{};t.id===n.data&&e.bc2&&e.bc2.postMessage(t)}),!a){t.next=10;break}return t.next=8,n.fetchSharedSession();case 8:t.next=38;break;case 10:if(!i){t.next=14;break}n.decodeSessionSpec(),t.next=38;break;case 14:if(!c){t.next=18;break}n.decodeJb1StyleSession(),t.next=38;break;case 18:if(!o){t.next=23;break}return t.next=21,n.decodeEncodedUrlSession();case 21:t.next=38;break;case 23:if(!s){t.next=28;break}return t.next=26,n.decodeJsonUrlSession();case 26:t.next=38;break;case 28:if(!r){t.next=33;break}return t.next=31,n.fetchSessionStorageSession();case 31:t.next=38;break;case 33:if(!u){t.next=37;break}throw new Error("unrecognized session format");case 37:e.setBlankSession(!0);case 38:t.next=44;break;case 40:t.prev=40,t.t0=t.catch(0),console.error(t.t0),e.setSessionError(t.t0);case 44:case"end":return t.stop()}}),t,null,[[0,40]])})))));case 12:case"end":return t.stop()}}),t,null,[[1,6]])})))()}}}));var cn=t(59740),un=["config"];function ln(){var e=window.location,n=e.href,t=e.search,i=Object.fromEntries(new URLSearchParams(t)),a=(i.config,(0,cn.Z)(i,un)),s=n.split("?")[0];return(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{children:"Configuration not found. You may have arrived here if you requested a config that does not exist or you have not set up your JBrowse yet."}),B.inDevelopment?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{children:"Sample JBrowse configs:"}),(0,S.jsx)("ul",{children:[["test_data/volvox/config.json","Volvox (sample data)"],["test_data/config.json","Human basic"],["test_data/config_demo.json","Human sample data"],["test_data/tomato/config.json","Tomato SVs"],["test_data/breakpoint/config.json","Breakpoint"],["test_data/config_dotplot.json","Grape/Peach dotplot"],["test_data/config_synteny_grape_peach.json","Grape/Peach synteny"],["test_data/human_vs_mouse.json","Human vs mouse synteny"],["test_data/yeast_synteny/config.json","Yeast synteny"],["test_data/config_many_contigs.json","Many contigs"],["test_data/config_honeybee.json","Honeybee"],["test_data/config_wormbase.json","Wormbase"],["test_data/config_human_dotplot.json","Human dotplot"],["test_data/volvox/theme.json","Theme test (wild color)"],["test_data/volvox/theme2.json","Theme test (wormbase color)"],["test_data/wgbs/config.json","WGBS methylation"],["test_data/methylation_test/config.json","Nanopore methylation"],["test_data/volvox/config_main_thread.json","Volvox (mainthreadrpc)"],["test_data/volvox/config_auth.json","Volvox (auth)"],["test_data/volvox/config_auth_main.json","Volvox (auth, mainthreadrpc)"],["test_data/volvoxhub/config.json","Volvox (with ucsc-hub)"]].map((function(e){var n=(0,o.Z)(e,2),t=n[0],i=n[1],c=new URLSearchParams(Object.entries((0,r.Z)((0,r.Z)({},a),{},{config:t})));return(0,S.jsx)("li",{children:(0,S.jsx)("a",{href:"".concat(s,"?").concat(c),children:i})},i)}))})]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{children:"Sample JBrowse config:"}),(0,S.jsx)("ul",{children:(0,S.jsx)("li",{children:(0,S.jsx)("a",{href:"?config=test_data/volvox/config.json",children:"Volvox sample data"})})})]})]})}function fn(e){var n=e.error;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ln,{}),"".concat(n).match(/HTTP 404 fetching config.json/)?(0,S.jsxs)("div",{style:{margin:8,padding:8,border:"1px solid black",background:"#9f9"},children:["No config.json found. If you want to learn how to complete your setup, visit our"," ",(0,S.jsx)("a",{href:"https://jbrowse.org/jb2/docs/quickstart_web/",children:"quick start guide"}),"."]}):(0,S.jsx)(l.ErrorMessage,{error:n})]})}var dn=t(41860);function pn(){return(pn=(0,p.Z)((0,d.Z)().mark((function e(n,t,r){var o,i,a,s,c,u,l,f,p,h;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"https://analytics.jbrowse.org/api/v1",o=n.jbrowse.tracks.filter((function(e){return((0,R.readConfObject)(e,"assemblyNames")||[]).length>1})).length,i=Object.keys(localStorage).filter((function(e){return e.includes("localSaved-")})).length,a=n.jbrowse,s=n.session,c=n.version,u=a.tracks,l=a.assemblies,f=a.plugins,p={ver:c,"plugins-count":(null===f||void 0===f?void 0:f.length)||0,"plugin-names":null===f||void 0===f?void 0:f.map((function(e){return e.name})).join(","),"assemblies-count":l.length,"tracks-count":u.length,"session-tracks-count":(null===s||void 0===s?void 0:s.sessionTracks.length)||0,"open-views":(null===s||void 0===s?void 0:s.views.length)||0,"synteny-tracks-count":o,"saved-sessions-count":i,"existing-session-param-type":(null===r||void 0===r?void 0:r.split("-")[0])||"none","scn-h":window.screen.height,"scn-w":window.screen.width,"win-h":window.innerHeight,"win-w":window.innerWidth,electron:B.isElectron,loadTime:(Date.now()-t)/1e3,jb2:!0},u.forEach((function(e){var n="track-types-".concat(e.type);p[n]=p[n]+1||1})),null===s||void 0===s||s.sessionTracks.forEach((function(e){var n="sessionTrack-types-".concat(e.type);p[n]=p[n]+1||1})),h=Object.keys(p).map((function(e){return"".concat(e,"=").concat(p[e])})).join("&"),e.next=12,fetch("".concat("https://analytics.jbrowse.org/api/v1","?").concat(h));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("Failed to write analytics to AWS.",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}function hn(){return(hn=(0,p.Z)((0,d.Z)().mark((function e(n,t){var r,o,i,a,s;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"UA-7115575-5",o={"tracks-count":n.jbrowse.tracks.length,ver:n.version,electron:B.isElectron,loadTime:Date.now()-t,pluginNames:(null===(r=n.jbrowse.plugins)||void 0===r?void 0:r.map((function(e){return e.name})))||""},i="(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){",i+="(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),",i+="m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)",i+="})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');",i+="ga('create', '".concat("UA-7115575-5","', 'auto', 'jbrowseTracker');"),a={},"tracks-count ver electron loadTime pluginNames","tracks-count ver electron loadTime pluginNames".split(/\s+/).forEach((function(e,n){a["dimension".concat(n+1)]=o[e]})),a.metric1=Math.round(o.loadTime),i+="ga('jbrowseTracker.send', 'pageview',".concat(JSON.stringify(a),");"),(s=document.createElement("script")).innerHTML=i,document.getElementsByTagName("head")[0].append(s);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vn(e,n,t){e&&!(0,R.readConfObject)(e.jbrowse.configuration,"disableAnalytics")&&(function(e,n,t){pn.apply(this,arguments)}(e,n,t),function(e,n){hn.apply(this,arguments)}(e,n))}var mn=t(41361),gn=t(64837);var yn=function(e){return(0,R.ConfigurationSchema)("BaseAssembly",{aliases:{type:"stringArray",defaultValue:[],description:"Other possible names for the assembly"},sequence:e.getTrackType("ReferenceSequenceTrack").configSchema,refNameColors:{type:"stringArray",defaultValue:[],description:"Define custom colors for each reference sequence. Will cycle through this list if there are not enough colors for every sequence."},refNameAliases:(0,R.ConfigurationSchema)("RefNameAliases",{adapter:e.pluggableConfigSchemaType("adapter")},{preProcessSnapshot:function(e){return e.adapter?e:{adapter:{type:"RefNameAliasAdapter"}}}}),cytobands:(0,R.ConfigurationSchema)("Cytoband",{adapter:e.pluggableConfigSchemaType("adapter")},{preProcessSnapshot:function(e){return e.adapter?e:{adapter:{type:"CytobandAdapter"}}}}),displayName:{type:"string",defaultValue:"",description:'A human readable display name for the assembly e.g. "Homo sapiens (hg38)" while the assembly name may just be "hg38"'}},{explicitIdentifier:"name"})},bn=t(10361),wn=function(){function e(n){(0,Ze.Z)(this,e),this.pluginManager=n,this.adapterCache=new bn.Z({maxSize:15})}return(0,ke.Z)(e,[{key:"loadTextSearchAdapters",value:function(e){var n=this,t=this.pluginManager;return this.relevantAdapters(e).map((function(e){var r=(0,R.readConfObject)(e,"textSearchAdapterId"),o=n.adapterCache.get(r);if(o)return o;var i=new(0,t.getTextSearchAdapterType(e.type).AdapterClass)(e,void 0,t);return n.adapterCache.set(r,i),i}))}},{key:"relevantAdapters",value:function(e){var n,t,r=this.pluginManager,o=(null===(n=r.rootModel)||void 0===n?void 0:n.jbrowse).aggregateTextSearchAdapters,i=(null===(t=r.rootModel)||void 0===t?void 0:t.session).tracks,a=e.assemblyName;return[].concat((0,$.Z)(this.getAdaptersWithAssembly(a,o)),(0,$.Z)(this.getTrackAdaptersWithAssembly(a,i)))}},{key:"getAdaptersWithAssembly",value:function(e,n){return n.filter((function(n){var t;return null===(t=(0,R.readConfObject)(n,"assemblyNames"))||void 0===t?void 0:t.includes(e)}))}},{key:"getTrackAdaptersWithAssembly",value:function(e,n){return n.filter((function(n){var t;return null===(t=(0,R.readConfObject)(n,["textSearching","textSearchAdapter","assemblyNames"]))||void 0===t?void 0:t.includes(e)})).map((function(e){return e.textSearching.textSearchAdapter}))}},{key:"search",value:function(){var e=(0,p.Z)((0,d.Z)().mark((function e(n,t,r){var o,i;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.loadTextSearchAdapters(t),e.next=3,Promise.all(o.map((function(e){return e.searchIndex(n)})));case 3:return i=e.sent,e.abrupt("return",this.sortResults(i.flat(),r));case 5:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()},{key:"sortResults",value:function(e,n){return n(e.sort((function(e,n){return-n.getLabel().localeCompare(e.getLabel())}))).sort((function(e,n){return e.getScore()-n.getScore()}))}}]),e}(),xn=t(25471),Zn=t(41181),kn=t(49181),Sn=t(93472),Cn=t(14393),jn=t(73823),An=t(18563),Tn=t(74119),Mn=t(59978),En=t(78748),Pn=t(55824),In=t(23642);function Nn(){return new Worker(new URL(t.p+t.u(2634),t.b))}var Rn=t(73636),Dn=t.n(Rn);window.getSnapshot=h.getSnapshot,window.resolveIdentifier=h.resolveIdentifier;var Wn={i8:"2.6.3"},Ln=t(43586),On=t.n(Ln),zn=t(64926),_n=t.n(zn),Un=["signal","statusCallback"],Vn=new RegExp("[0-9A-Za-z!#$%&+./:;?@^_|~-][0-9A-Za-z!#$%&*+./:;=?@^_|~-]*"),Fn=["rgb(153, 102, 0)","rgb(102, 102, 0)","rgb(153, 153, 30)","rgb(204, 0, 0)","rgb(255, 0, 0)","rgb(255, 0, 204)","rgb(165, 132, 132)","rgb(204, 122, 0)","rgb(178, 142, 0)","rgb(153, 153, 0)","rgb(122, 153, 0)","rgb(0, 165, 0)","rgb(53, 128, 0)","rgb(0, 0, 204)","rgb(96, 145, 242)","rgb(107, 142, 178)","rgb(0, 165, 165)","rgb(122, 153, 153)","rgb(153, 0, 204)","rgb(204, 51, 255)","rgb(173, 130, 216)","rgb(102, 102, 102)","rgb(145, 145, 145)","rgb(142, 142, 142)","rgb(142, 142, 107)","rgb(96, 163, 48)"];function Bn(e,n,t,r){return Gn.apply(this,arguments)}function Gn(){return(Gn=(0,p.Z)((0,d.Z)().mark((function e(n,t,i,a){var s,c,u,l;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=i.sessionId,e.next=3,(0,B.when)((function(){return!(!n.regions||!n.refNameAliases)}),{signal:a,name:"when assembly ready"});case 3:return e.next=5,n.rpcManager.call(s||"assemblyRpc","CoreGetRefNames",(0,r.Z)({adapterConfig:t,signal:a},i),{timeout:1e6});case 5:if(c=e.sent,n.refNameAliases){e.next=9;break}throw new Error("error loading assembly ".concat(n.name,"'s refNameAliases"));case 9:return u=Object.fromEntries(c.map((function(e){return qn(e),[n.getCanonicalRefName(e),e]}))),l=Object.fromEntries(Object.entries(u).map((function(e){var n=(0,o.Z)(e,2),t=n[0];return[n[1],t]}))),e.abrupt("return",{forwardMap:u,reverseMap:l});case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qn(e){if(!Vn.test(e))throw new Error('Encountered invalid refName: "'.concat(e,'"'))}function Jn(e,n){var t=new(_n())({cache:new bn.Z({maxSize:1e3}),fill:function(e,n,t){return(0,p.Z)((0,d.Z)().mark((function o(){var i,a,s;return(0,d.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i=e.adapterConf,a=e.self,s=e.options,o.abrupt("return",Bn(a,i,(0,r.Z)((0,r.Z)({},s),{},{statusCallback:t}),n));case 2:case"end":return o.stop()}}),o)})))()}});return h.types.model({configuration:h.types.safeReference(e)}).volatile((function(){return{error:void 0,loaded:!1,loadingP:void 0,volatileRegions:void 0,refNameAliases:void 0,lowerCaseRefNameAliases:void 0,cytobands:void 0}})).views((function(e){return{get initialized(){return e.load(),!!e.refNameAliases},get name(){return(0,R.getConf)(e,"name")},get regions(){return e.load(),e.volatileRegions},get aliases(){return(0,R.getConf)(e,"aliases")},get displayName(){return(0,R.getConf)(e,"displayName")},hasName:function(e){return this.allAliases.includes(e)},get allAliases(){return[this.name].concat((0,$.Z)(this.aliases))},get allRefNames(){return e.refNameAliases?Object.keys(e.refNameAliases):void 0},get lowerCaseRefNames(){return e.lowerCaseRefNameAliases?Object.keys(e.lowerCaseRefNameAliases||{}):void 0},get allRefNamesWithLowerCase(){return this.allRefNames&&this.lowerCaseRefNames?(0,$.Z)(new Set([].concat((0,$.Z)(this.allRefNames),(0,$.Z)(this.lowerCaseRefNames)))):void 0},get rpcManager(){return(0,h.getParent)(e,2).rpcManager},get refNameColors(){var n=(0,R.getConf)(e,"refNameColors");return 0===n.length?Fn:n}}})).views((function(e){return{get refNames(){var n;return null===(n=e.regions)||void 0===n?void 0:n.map((function(e){return e.refName}))}}})).views((function(e){return{getCanonicalRefName:function(n){if(!e.refNameAliases||!e.lowerCaseRefNameAliases)throw new Error("aliases not loaded, we expect them to be loaded before getCanonicalRefName can be called");return e.refNameAliases[n]||e.lowerCaseRefNameAliases[n]},getRefNameColor:function(n){if(e.refNames){var t=e.refNames.indexOf(n);if(-1!==t)return e.refNameColors[t%e.refNameColors.length]}},isValidRefName:function(n){if(!e.refNameAliases)throw new Error("isValidRefName cannot be called yet, the assembly has not finished loading");return!!this.getCanonicalRefName(n)}}})).actions((function(e){return{setLoaded:function(n){var t=n.adapterRegionsWithAssembly,r=n.refNameAliases,o=n.lowerCaseRefNameAliases,i=n.cytobands;e.loaded=!0,this.setRegions(t),this.setRefNameAliases(r,o),this.setCytobands(i)},setError:function(n){console.error(n),e.error=n},setRegions:function(n){e.volatileRegions=n},setRefNameAliases:function(n,t){e.refNameAliases=n,e.lowerCaseRefNameAliases=t},setCytobands:function(n){e.cytobands=n},setLoadingP:function(n){e.loadingP=n},load:function(){var n=this;return e.loadingP||(e.loadingP=this.loadPre().catch((function(e){n.setLoadingP(void 0),n.setError(e)}))),e.loadingP},loadPre:function(){var t=this;return(0,p.Z)((0,d.Z)().mark((function i(){var a,s,c,u,l,f,p,h,v,m,g,y,b;return(0,d.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return c=e.configuration,u=null===c||void 0===c||null===(a=c.refNameAliases)||void 0===a?void 0:a.adapter,l=null===c||void 0===c||null===(s=c.cytobands)||void 0===s?void 0:s.adapter,f=null===c||void 0===c?void 0:c.sequence.adapter,p=e.name,i.next=7,$n(f,n);case 7:return h=i.sent,v=h.map((function(e){return qn(e.refName),(0,r.Z)((0,r.Z)({},e),{},{assemblyName:p})})),m={},i.next=12,Hn(u,n);case 12:return g=i.sent,i.next=15,Qn(l,n);case 15:y=i.sent,g.forEach((function(e){var n=e.refName;e.aliases.forEach((function(e){qn(e),m[e]=n}))})),v.forEach((function(e){m[e.refName]=e.refName})),b=Object.fromEntries(Object.entries(m).map((function(e){var n=(0,o.Z)(e,2),t=n[0],r=n[1];return[t.toLowerCase(),r]}))),t.setLoaded({adapterRegionsWithAssembly:v,refNameAliases:m,lowerCaseRefNameAliases:b,cytobands:y});case 20:case"end":return i.stop()}}),i)})))()}}})).views((function(e){return{getAdapterMapEntry:function(n,r){r.signal;var o=r.statusCallback,i=(0,cn.Z)(r,Un);if(!r.sessionId)throw new Error("sessionId is required");var a=function(e){return On()(e)}(n);return t.get(a,{adapterConf:n,self:e,options:i},void 0,o)},getRefNameMapForAdapter:function(e,n){var t=this;return(0,p.Z)((0,d.Z)().mark((function r(){var o;return(0,d.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null!==n&&void 0!==n&&n.sessionId){r.next=2;break}throw new Error("sessionId is required");case 2:return r.next=4,t.getAdapterMapEntry(e,n);case 4:return o=r.sent,r.abrupt("return",o.forwardMap);case 6:case"end":return r.stop()}}),r)})))()},getReverseRefNameMapForAdapter:function(e,n){var t=this;return(0,p.Z)((0,d.Z)().mark((function r(){var o;return(0,d.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getAdapterMapEntry(e,n);case 2:return o=r.sent,r.abrupt("return",o.reverseMap);case 4:case"end":return r.stop()}}),r)})))()}}}))}function Hn(e,n,t){return Kn.apply(this,arguments)}function Kn(){return(Kn=(0,p.Z)((0,d.Z)().mark((function e(n,t,r){var o,i,a;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.getAdapterType(n.type),e.next=3,o.getAdapterClass();case 3:return i=e.sent,a=new i(n,void 0,t),e.abrupt("return",a.getRefNameAliases({signal:r}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qn(e,n){return Yn.apply(this,arguments)}function Yn(){return(Yn=(0,p.Z)((0,d.Z)().mark((function e(n,t){var r,o,i;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.getAdapterType(n.type),e.next=3,r.getAdapterClass();case 3:return o=e.sent,i=new o(n,void 0,t),e.abrupt("return",i.getData());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $n(e,n,t){return Xn.apply(this,arguments)}function Xn(){return(Xn=(0,p.Z)((0,d.Z)().mark((function e(n,t,r){var o,i,a;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.getAdapterType(n.type),e.next=3,o.getAdapterClass();case 3:return i=e.sent,a=new i(n,void 0,t),e.abrupt("return",a.getRegions({signal:r}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var et=function(e,n){return h.types.model({assemblies:h.types.array(Jn(e,n))}).views((function(e){return{get assemblyNameMap(){var n,t={},r=(0,mn.Z)(e.assemblies);try{for(r.s();!(n=r.n()).done;){var o,i=n.value,a=(0,mn.Z)(i.allAliases);try{for(a.s();!(o=a.n()).done;){t[o.value]=i}}catch(s){a.e(s)}finally{a.f()}}}catch(s){r.e(s)}finally{r.f()}return t}}})).views((function(e){return{get:function(n){return e.assemblyNameMap[n]},get assemblyNamesList(){return this.assemblyList.map((function(e){return e.name}))},get assemblyList(){var n=(0,h.getParent)(e),t=n.jbrowse.assemblies,r=n.session,o=void 0===r?{}:r,i=o.sessionAssemblies,a=void 0===i?[]:i,s=o.temporaryAssemblies,c=void 0===s?[]:s;return[].concat((0,$.Z)(t),(0,$.Z)(a),(0,$.Z)(c))},get rpcManager(){return(0,h.getParent)(e).rpcManager}}})).views((function(e){return{waitForAssembly:function(n){return(0,p.Z)((0,d.Z)().mark((function t(){var r;return(0,d.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}throw new Error("no assembly name supplied to waitForAssembly");case 2:if(r=e.get(n)){t.next=12;break}return t.prev=4,t.next=7,(0,B.when)((function(){return Boolean(e.get(n))}),{timeout:1e3});case 7:r=e.get(n),t.next=12;break;case 10:t.prev=10,t.t0=t.catch(4);case 12:if(r){t.next=14;break}return t.abrupt("return",void 0);case 14:return t.next=16,r.load();case 16:return t.next=18,(0,B.when)((function(){var e,n;return Boolean((null===(e=r)||void 0===e?void 0:e.regions)&&r.refNameAliases)||!(null===(n=r)||void 0===n||!n.error)}));case 18:if(!r.error){t.next=20;break}throw r.error;case 20:return t.abrupt("return",r);case 21:case"end":return t.stop()}}),t,null,[[4,10]])})))()},getRefNameMapForAdapter:function(e,n,t){var r=this;return(0,p.Z)((0,d.Z)().mark((function o(){var i;return(0,d.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!n){o.next=5;break}return o.next=3,r.waitForAssembly(n);case 3:return i=o.sent,o.abrupt("return",null===i||void 0===i?void 0:i.getRefNameMapForAdapter(e,t));case 5:return o.abrupt("return",{});case 6:case"end":return o.stop()}}),o)})))()},getReverseRefNameMapForAdapter:function(e,n,t){var r=this;return(0,p.Z)((0,d.Z)().mark((function o(){var i;return(0,d.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!n){o.next=5;break}return o.next=3,r.waitForAssembly(n);case 3:return i=o.sent,o.abrupt("return",null===i||void 0===i?void 0:i.getReverseRefNameMapForAdapter(e,t));case 5:return o.abrupt("return",{});case 6:case"end":return o.stop()}}),o)})))()},isValidRefName:function(n,t){var r=e.get(t);if(r)return r.isValidRefName(n);throw new Error("isValidRefName for ".concat(t," failed, assembly does not exist"))}}})).actions((function(e){return{afterAttach:function(){var n=this;(0,h.addDisposer)(e,(0,xe.reaction)((function(){return e.assemblyList}),(function(t){e.assemblies.forEach((function(e){e.configuration||n.removeAssembly(e)})),t.forEach((function(t){e.assemblies.some((function(e){return e.name===(0,R.readConfObject)(t,"name")}))||n.addAssembly(t)}))}),{fireImmediately:!0,name:"assemblyManagerAfterAttach"}))},removeAssembly:function(n){e.assemblies.remove(n)},addAssembly:function(n){e.assemblies.push({configuration:n})},replaceAssembly:function(n,t){e.assemblies[n]=(0,h.cast)({configuration:t})}}}))};var nt=(0,i.lazy)((function(){return t.e(2426).then(t.bind(t,22426))}));function tt(e){var n=e.pluginManager,t=e.sessionModelFactory,i=e.adminMode,a=void 0!==i&&i,s=yn(n),c=function(e){var n=e.pluginManager,t=e.assemblyConfigSchema;return h.types.snapshotProcessor(Je({pluginManager:n,assemblyConfigSchema:t}),{postProcessor:function(e){return(0,an.uV)(Dn()(e),"baseUri")}})}({pluginManager:n,assemblyConfigSchema:s}),u=t({pluginManager:n,assemblyConfigSchema:s});return h.types.compose(function(e){var n=e.pluginManager,t=e.jbrowseModelType,r=e.sessionModelType,o=e.assemblyConfigSchema;return h.types.model("BaseRootModel",{jbrowse:t,session:h.types.maybe(r),sessionPath:h.types.optional(h.types.string,""),assemblyManager:h.types.optional(et(o,n),{})}).volatile((function(e){return{rpcManager:new qe(n,e.jbrowse.configuration.rpc,{MainThreadRpcDriver:{}}),adminMode:!1,isAssemblyEditing:!1,error:void 0,textSearchManager:new wn(n),pluginManager:n}})).actions((function(e){return{setError:function(n){e.error=n},setSession:function(n){e.session=(0,h.cast)(n)},setDefaultSession:function(){this.setSession(e.jbrowse.defaultSession)},setSessionPath:function(n){e.sessionPath=n},renameCurrentSession:function(n){if(e.session){var t=JSON.parse(JSON.stringify((0,h.getSnapshot)(e.session)));t.name=n,this.setSession(t)}},setAssemblyEditing:function(n){e.isAssemblyEditing=n}}}))}({pluginManager:n,jbrowseModelType:c,sessionModelType:u,assemblyConfigSchema:s}),function(e){return h.types.model({internetAccounts:h.types.array(e.pluggableMstType("internet account","stateModel"))}).actions((function(n){return{initializeInternetAccount:function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.getInternetAccountType(t.type))throw new Error("unknown internet account type ".concat(t.type));var i=n.internetAccounts.push((0,r.Z)((0,r.Z)({},o),{},{type:t.type,configuration:t}));return n.internetAccounts[i-1]},createEphemeralInternetAccount:function(t){var o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;try{o=new URL(a).origin}catch(l){}var s=t.split("-"),c={type:s[0],internetAccountId:t,name:s.slice(1).join("-"),description:"",domains:o?[o]:[]},u=e.getInternetAccountType(c.type).stateModel.create((0,r.Z)((0,r.Z)({},i),{},{type:c.type,configuration:c}));return n.internetAccounts.push(u),u},findAppropriateInternetAccount:function(e){var t=e.internetAccountId;if(t){var r=n.internetAccounts.find((function(e){return e.internetAccountId===t}));if(r)return r}var o,i=(0,mn.Z)(n.internetAccounts);try{for(i.s();!(o=i.n()).done;){var a=o.value;if(a.handlesLocation(e))return a}}catch(s){i.e(s)}finally{i.f()}return t?this.createEphemeralInternetAccount(t,{},e.uri):null}}})).actions((function(e){return{afterCreate:function(){(0,h.addDisposer)(e,(0,xe.autorun)((function(){e.jbrowse.internetAccounts.forEach(e.initializeInternetAccount)})))}}}))}(n),h.types.model({history:h.types.optional(we,{targetPath:"../session"})}).actions((function(e){return{afterCreate:function(){document.addEventListener("keydown",(function(n){var t,r;e.history.canRedo&&((n.ctrlKey||n.metaKey)&&n.shiftKey&&"KeyZ"===n.code||n.ctrlKey&&!n.shiftKey&&"KeyY"===n.code)&&"INPUT"!==(null===(t=document.activeElement)||void 0===t?void 0:t.tagName.toUpperCase())&&e.history.redo(),e.history.canUndo&&(n.ctrlKey||n.metaKey)&&!n.shiftKey&&"KeyZ"===n.code&&"INPUT"!==(null===(r=document.activeElement)||void 0===r?void 0:r.tagName.toUpperCase())&&e.history.undo()})),(0,h.addDisposer)(e,(0,xe.autorun)((function(){e.session&&e.history.initialize()})))}}})),h.types.model({}).actions((function(e){var n=e;return{setMenus:function(e){n.menus=e},appendMenu:function(e){return n.menus.push({label:e,menuItems:[]})},insertMenu:function(e,t){return n.menus.splice((t<0?n.menus.length:0)+t,0,{label:e,menuItems:[]}),n.menus.length},appendToMenu:function(e,t){var r=n.menus.find((function(n){return n.label===e}));return r?r.menuItems.push(t):(n.menus.push({label:e,menuItems:[t]}),1)},insertInMenu:function(e,t,r){var o=n.menus.find((function(n){return n.label===e}));if(!o)return n.menus.push({label:e,menuItems:[t]}),1;var i=r<0?o.menuItems.length+r:r;return o.menuItems.splice(i,0,t),o.menuItems.length},appendToSubMenu:function(e,t){var r=n.menus.find((function(n){return n.label===e[0]}));if(!r){var o=this.appendMenu(e[0]);r=n.menus[o-1]}var i=r.menuItems,a=[e[0]];return e.slice(1).forEach((function(e){a.push(e);var n=i.find((function(n){return"label"in n&&n.label===e}));if(!n){var t=i.push({label:e,subMenu:[]});n=i[t-1]}if(!("subMenu"in n))throw new Error('"'.concat(e,'" in path "').concat(a,'" is not a subMenu'));i=n.subMenu})),i.push(t)},insertInSubMenu:function(e,t,r){var o=n.menus.find((function(n){return n.label===e[0]}));if(!o){var i=this.appendMenu(e[0]);o=n.menus[i-1]}var a=o.menuItems,s=[e[0]];return e.slice(1).forEach((function(e){s.push(e);var n=a.find((function(n){return"label"in n&&n.label===e}));if(!n){var t=a.push({label:e,subMenu:[]});n=a[t-1]}if(!("subMenu"in n))throw new Error('"'.concat(e,'" in path "').concat(s,'" is not a subMenu'));a=n.subMenu})),a.splice(r,0,t),a.length}}}))).props({configPath:h.types.maybe(h.types.string)}).volatile((function(e){return{version:Wn.i8,isAssemblyEditing:!1,isDefaultSessionEditing:!1,pluginsUpdated:!1,rpcManager:new qe(n,e.jbrowse.configuration.rpc,{WebWorkerRpcDriver:{makeWorkerInstance:Nn},MainThreadRpcDriver:{}}),savedSessionsVolatile:xe.observable.map({}),textSearchManager:new wn(n),error:void 0}})).views((function(e){return{get savedSessions(){return(0,$.Z)(e.savedSessionsVolatile.values())},localStorageId:function(n){return"localSaved-".concat(n,"-").concat(e.configPath)},get autosaveId(){return"autosave-".concat(e.configPath)},get previousAutosaveId(){return"previousAutosave-".concat(e.configPath)}}})).views((function(e){return{get savedSessionNames(){return e.savedSessions.map((function(e){return e.name}))},get currentSessionId(){var e,n=new URL(window.location.href),t=new URLSearchParams(n.search);return null===t||void 0===t||null===(e=t.get("session"))||void 0===e?void 0:e.split("local-")[1]}}})).actions((function(e){return{afterCreate:function(){var n,t=(0,mn.Z)(Object.entries(localStorage).filter((function(e){var n=(0,o.Z)(e,2),t=n[0];n[1];return t.startsWith("localSaved-")})).filter((function(n){return(0,o.Z)(n,1)[0].includes(e.configPath||"undefined")})));try{for(t.s();!(n=t.n()).done;){var i=(0,o.Z)(n.value,2),a=i[0],s=i[1];try{var c=JSON.parse(s).session;e.savedSessionsVolatile.set(a,c)}catch(u){console.error("bad session encountered",a,s)}}}catch(l){t.e(l)}finally{t.f()}(0,h.addDisposer)(e,(0,xe.autorun)((function(){var n,t=(0,mn.Z)(e.savedSessionsVolatile.entries());try{for(t.s();!(n=t.n()).done;){var r=(0,o.Z)(n.value,2)[1];try{var i=e.localStorageId(r.name);localStorage.setItem(i,JSON.stringify({session:r}))}catch(u){"22"!==u.code&&"1024"!==u.code||alert('Local storage is full! Please use the "Open sessions" panel to remove old sessions')}}}catch(l){t.e(l)}finally{t.f()}}))),(0,h.addDisposer)(e,(0,xe.autorun)((function(){if(e.session){var n=(0,h.getSnapshot)(e.session)||{name:"empty"},t=JSON.stringify;sessionStorage.setItem("current",t({session:n})),localStorage.setItem("autosave-".concat(e.configPath),t({session:(0,r.Z)((0,r.Z)({},n),{},{name:"".concat(n.name,"-autosaved")})})),e.pluginsUpdated&&window.location.reload()}}),{delay:400}))},setSession:function(n){var t=e.session;if(e.session=(0,h.cast)(n),e.session)try{(0,an.Yr)(e.session,(0,h.getType)(e.session))}catch(r){throw e.session=t,r}},setAssemblyEditing:function(n){e.isAssemblyEditing=n},setDefaultSessionEditing:function(n){e.isDefaultSessionEditing=n},setPluginsUpdated:function(n){e.pluginsUpdated=n},setDefaultSession:function(){var n=e.jbrowse.defaultSession,t=(0,r.Z)((0,r.Z)({},n),{},{name:"".concat(n.name," ").concat((new Date).toLocaleString())});this.setSession(t)},renameCurrentSession:function(n){if(e.session){var t=JSON.parse(JSON.stringify((0,h.getSnapshot)(e.session)));t.name=n,this.setSession(t)}},addSavedSession:function(n){var t=e.localStorageId(n.name);e.savedSessionsVolatile.set(t,n)},removeSavedSession:function(n){var t=e.localStorageId(n.name);localStorage.removeItem(t),e.savedSessionsVolatile.delete(t)},duplicateCurrentSession:function(){if(e.session){var n=JSON.parse(JSON.stringify((0,h.getSnapshot)(e.session))),t="".concat(e.session.name," (copy)");if(e.savedSessionNames.includes(t)){var r=2;do{t="".concat(e.session.name," (copy ").concat(r,")"),r+=1}while(e.savedSessionNames.includes(t))}n.name=t,this.setSession(n)}},activateSession:function(n){var t=e.localStorageId(n),r=localStorage.getItem(t);if(!r)throw new Error("Can't activate session ".concat(n,", it is not in the savedSessions"));this.setSession(JSON.parse(r).session)},saveSessionToLocalStorage:function(){if(e.session){var n=e.localStorageId(e.session.name);e.savedSessionsVolatile.set(n,(0,h.getSnapshot)(e.session))}},loadAutosaveSession:function(){var n=localStorage.getItem(e.previousAutosaveId),t=n?JSON.parse(n).session:{},r=t.name;t.name="".concat(r.replace("-autosaved",""),"-restored"),this.setSession(t)},setError:function(n){e.error=n}}})).volatile((function(e){return{menus:[{label:"File",menuItems:[{label:"New session",icon:Y.Z,onClick:function(n){var t=localStorage.getItem(e.autosaveId);t&&localStorage.setItem(e.previousAutosaveId,t),n.setDefaultSession()}},{label:"Import session\u2026",icon:jn.Z,onClick:function(e){var n=e.addWidget("ImportSessionWidget","importSessionWidget");e.showWidget(n)}},{label:"Export session",icon:Cn.Z,onClick:function(e){var n=new Blob([JSON.stringify({session:(0,h.getSnapshot)(e)},null,2)],{type:"text/plain;charset=utf-8"});(0,gn.saveAs)(n,"session.json")}},{label:"Open session\u2026",icon:Sn.Z,onClick:function(e){var n=e.addWidget("SessionManager","sessionManager");e.showWidget(n)}},{label:"Save session",icon:Mn.Z,onClick:function(n){e.saveSessionToLocalStorage(),n.notify('Saved session "'.concat(n.name,'"'),"success")}},{label:"Duplicate session",icon:kn.Z,onClick:function(e){e.duplicateCurrentSession&&e.duplicateCurrentSession()}},{type:"divider"},{label:"Open track...",icon:Tn.Z,onClick:function(e){if(0===e.views.length)e.notify("Please open a view to add a track first");else if(e.views.length>0){var n=e.addWidget("AddTrackWidget","addTrackWidget",{view:e.views[0].id});e.showWidget(n),e.views.length>1&&e.notify("This will add a track to the first view. Note: if you want to open a track in a specific view open the track selector for that view and use the add track (plus icon) in the bottom right")}}},{label:"Open connection...",icon:In.sB,onClick:function(e){var n=e.addWidget("AddConnectionWidget","addConnectionWidget");e.showWidget(n)}},{type:"divider"},{label:"Return to splash screen",icon:Zn.Z,onClick:function(){return e.setSession(void 0)}}]}].concat((0,$.Z)(a?[{label:"Admin",menuItems:[{label:"Open assembly manager",onClick:function(){return e.setAssemblyEditing(!0)}},{label:"Set default session",onClick:function(){return e.setDefaultSessionEditing(!0)}}]}]:[]),[{label:"Add",menuItems:[]},{label:"Tools",menuItems:[{label:"Undo",icon:En.Z,onClick:function(){e.history.canUndo&&e.history.undo()}},{label:"Redo",icon:Pn.Z,onClick:function(){e.history.canRedo&&e.history.redo()}},{type:"divider"},{label:"Plugin store",icon:An.Z,onClick:function(){if(e.session){var n=e.session.addWidget("PluginStoreWidget","pluginStoreWidget");e.session.showWidget(n)}}},{label:"Preferences",icon:xn.Z,onClick:function(){e.session&&e.session.queueDialog((function(n){return[nt,{session:e.session,handleClose:n}]}))}}]}]),adminMode:a}}))}function rt(e){return e.extend((function(){return function(e){return{views:{get snackbarMessages(){return e}},actions:{notify:function(e,n,t){var r=this;this.pushSnackbarMessage(e,n,t),"info"!==n&&"success"!==n||setTimeout((function(){r.removeSnackbarMessage(e)}),5e3)},pushSnackbarMessage:function(n,t,r){return e.push({message:n,level:t,action:r})},popSnackbarMessage:function(){return e.pop()},removeSnackbarMessage:function(n){var t=e.find((function(e){return e.message===n}));t&&e.remove(t)}}}}(xe.observable.array())}))}var ot=t(31946),it=t(47306);function at(e){return h.types.model("ReferenceManagementSessionMixin",{}).views((function(e){return{getReferring:function(n){var t=[];return(0,h.walk)((0,h.getParent)(e),(function(e){if((0,h.isModelType)((0,h.getType)(e))){var r=(0,h.getMembers)(e);Object.entries(r.properties).forEach((function(r){var i=(0,o.Z)(r,2),a=i[0],s=i[1];(0,h.isReferenceType)(s)&&e[a]===n&&t.push({node:e,key:a})}))}})),t}}})).actions((function(e){return{removeReferring:function(n,t,r,o){n.forEach((function(n){var i=n.node,a=!1;try{var s="open track(s)",c=(0,B.getContainingView)(i);r.push((function(){return c.hideTrack(t.trackId)})),a=!0,o[s]||(o[s]=0),o[s]+=1}catch(l){}if((0,B.isSessionModelWithWidgets)(e)&&e.widgets.has(i.id)){var u="configuration editor widget(s)";(0,B.isSessionModelWithWidgets)(e)&&r.push((function(){return e.hideWidget(i)})),a=!0,o[u]||(o[u]=0),o[u]+=1}if(!a)throw new Error("Error when closing this connection, the following node is still referring to a track configuration: ".concat(JSON.stringify((0,h.getSnapshot)(i))))}))}}}))}var st=128;function ct(e){var n=e.pluggableMstType("widget","stateModel");return h.types.model({drawerPosition:h.types.optional(h.types.string,(function(){return(0,B.localStorageGetItem)("drawerPosition")||"right"})),drawerWidth:h.types.optional(h.types.refinement(h.types.integer,(function(e){return e>=st})),384),widgets:h.types.map(n),activeWidgets:h.types.map(h.types.safeReference(n)),minimized:h.types.optional(h.types.boolean,!1)}).views((function(e){return{get visibleWidget(){if((0,h.isAlive)(e))return(0,$.Z)(e.activeWidgets.values())[e.activeWidgets.size-1]}}})).actions((function(n){return{setDrawerPosition:function(e){n.drawerPosition=e,localStorage.setItem("drawerPosition",e)},updateDrawerWidth:function(e){if(e===n.drawerWidth)return n.drawerWidth;var t=e;return t<st&&(t=st),n.drawerWidth=t,t},resizeDrawer:function(e){"left"===n.drawerPosition&&(e*=-1);var t=n.drawerWidth;return t-this.updateDrawerWidth(t-e)},addWidget:function(t,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;if(!e.getElementType("widget",t))throw new Error("unknown widget type ".concat(t));var s=(0,r.Z)((0,r.Z)({},i),{},{id:o,type:t,configuration:a||{type:t}});return n.widgets.set(o,s),n.widgets.get(o)},showWidget:function(e){n.activeWidgets.has(e.id)&&n.activeWidgets.delete(e.id),n.activeWidgets.set(e.id,e),n.minimized=!1},hasWidget:function(e){return n.activeWidgets.has(e.id)},hideWidget:function(e){n.activeWidgets.delete(e.id)},minimizeWidgetDrawer:function(){n.minimized=!0},showWidgetDrawer:function(){n.minimized=!1},hideAllWidgets:function(){n.activeWidgets.clear()},editConfiguration:function(e){if(!(0,R.isConfigurationModel)(e))throw new Error("must pass a configuration model to editConfiguration");var n=this.addWidget("ConfigurationEditorWidget","configEditor",{target:e});this.showWidget(n)},afterAttach:function(){(0,h.addDisposer)(n,(0,xe.autorun)((function(){(0,B.localStorageSetItem)("drawerPosition",n.drawerPosition)})))}}}))}function ut(e){return h.types.model({id:h.types.optional(h.types.identifier,Re()()),name:h.types.string,margin:0}).volatile((function(){return{selection:void 0}})).views((function(e){return{get root(){return(0,h.getParent)(e)}}})).views((function(e){return{get jbrowse(){return e.root.jbrowse},get rpcManager(){return e.root.rpcManager},get configuration(){return this.jbrowse.configuration},get adminMode(){return e.root.adminMode},get textSearchManager(){return e.root.textSearchManager}}})).views((function(e){return{get assemblies(){return e.jbrowse.assemblies}}})).actions((function(e){return{setSelection:function(n){e.selection=n},clearSelection:function(){e.selection=void 0}}}))}function lt(e){return h.types.compose("TracksManagerSessionMixin",ut(),at()).views((function(e){return{get tracks(){return e.jbrowse.tracks}}})).actions((function(e){return{addTrackConf:function(n){return e.jbrowse.addTrackConf(n)},deleteTrackConf:function(n){var t=[],r=e.getReferring(n);if(e.removeReferring(r,n,t,{}),t.forEach((function(e){return e()})),e.adminMode)return e.jbrowse.deleteTrackConf(n)}}})).named("SessionTracksManagerSessionMixin").props({sessionTracks:h.types.array(e.pluggableConfigSchemaType("track"))}).views((function(e){return{get tracks(){return e.jbrowse.tracks}}})).actions((function(e){var n=e.addTrackConf,t=e.deleteTrackConf;return{addTrackConf:function(t){if(e.adminMode)return n(t);var r=t,o=r.trackId,i=r.type;if(!i)throw new Error("unknown track type ".concat(i));var a=e.sessionTracks.find((function(e){return e.trackId===o}));if(a)return a;var s=e.sessionTracks.push(t);return e.sessionTracks[s-1]},deleteTrackConf:function(n){var r=t(n);if(r)return r;var o=n.trackId,i=e.sessionTracks.findIndex((function(e){return e.trackId===o}));return-1!==i?e.sessionTracks.splice(i,1):void 0}}}))}function ft(e){return h.types.compose("SessionConnectionsManagement",function(e){return h.types.model({connectionInstances:h.types.array(e.pluggableMstType("connection","stateModel"))}).views((function(e){return{get connections(){return e.jbrowse.connections}}})).actions((function(n){return{makeConnection:function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.type;if(!i)throw new Error("track configuration has no `type` listed");var a=(0,R.readConfObject)(t,"name");if(!e.getConnectionType(i))throw new Error("unknown connection type ".concat(i));var s=n.connectionInstances.push((0,r.Z)((0,r.Z)({},o),{},{name:a,type:i,configuration:t}));return n.connectionInstances[s-1]},prepareToBreakConnection:function(e){var t=this,r=n,o=[],i={},a=(0,R.readConfObject)(e,"name"),s=n.connectionInstances.find((function(e){return e.name===a}));if(s){var c,u=(0,mn.Z)(s.tracks);try{for(u.s();!(c=u.n()).done;){var l=c.value,f=r.getReferring(l);r.removeReferring(f,l,o,i)}}catch(d){u.e(d)}finally{u.f()}return[function(){o.forEach((function(e){return e()})),t.breakConnection(e)},i]}},breakConnection:function(e){var t=(0,R.readConfObject)(e,"name"),r=n.connectionInstances.find((function(e){return e.name===t}));if(!r)throw new Error("no connection found with name ".concat(t));n.connectionInstances.remove(r)},deleteConnection:function(e){return n.jbrowse.deleteConnectionConf(e)},addConnectionConf:function(e){return n.jbrowse.addConnectionConf(e)},clearConnections:function(){n.connectionInstances.clear()}}}))}(e),h.types.model({sessionConnections:h.types.array(e.pluggableConfigSchemaType("connection"))})).actions((function(e){var n=e,t=n.deleteConnection,r=n.addConnectionConf;return{addConnectionConf:function(e){if(n.adminMode)return r(e);var t=e.connectionId,o=e.type;if(!o)throw new Error("unknown connection type ".concat(o));var i=n.sessionTracks.find((function(e){return e.connectionId===t}));if(i)return i;var a=n.sessionConnections.push(e);return n.sessionConnections[a-1]},deleteConnection:function(e){var r;if(n.adminMode&&(r=t(e)),!r){var o=e.connectionId,i=n.sessionConnections.findIndex((function(e){return e.connectionId===o}));if(-1===i)return;return n.sessionConnections.splice(i,1)}return r}}}))}var dt=["connectionInstances"],pt=(0,i.lazy)((function(){return Promise.all([t.e(534),t.e(4721),t.e(952),t.e(1637),t.e(6822),t.e(6251),t.e(2665)]).then(t.bind(t,22665))}));function ht(e){var n,t=e.pluginManager,i=e.assemblyConfigSchema,a=h.types.compose("WebCoreSessionModel",at(),ct(t),h.types.model("DialogQueueSessionMixin",{}).volatile((function(){return{queueOfDialogs:[]}})).views((function(e){return{get DialogComponent(){var n;return null===(n=e.queueOfDialogs[0])||void 0===n?void 0:n[0]},get DialogProps(){var n;return null===(n=e.queueOfDialogs[0])||void 0===n?void 0:n[1]}}})).actions((function(e){return{removeActiveDialog:function(){e.queueOfDialogs=e.queueOfDialogs.slice(1)},queueDialog:function(n){var t=this,r=n((function(){t.removeActiveDialog()})),i=(0,o.Z)(r,2),a=i[0],s=i[1];e.queueOfDialogs=[].concat((0,$.Z)(e.queueOfDialogs),[[a,s]])}}})),h.types.model({}).volatile((function(){return{sessionThemeName:(0,B.localStorageGetItem)("themeName")||"default"}})).views((function(e){return{allThemes:function(){var n=e,t=(0,R.getConf)(n.jbrowse,"extraThemes");return(0,r.Z)((0,r.Z)({},l.defaultThemes),t)},get themeName(){var n=e.sessionThemeName;return this.allThemes()[n]?n:"default"},get theme(){var n=e,t=(0,R.getConf)(n.jbrowse,"theme"),r=this.allThemes();return(0,l.createJBrowseTheme)(t,r,this.themeName)}}})).actions((function(e){return{setThemeName:function(n){e.sessionThemeName=n},afterAttach:function(){(0,h.addDisposer)(e,(0,xe.autorun)((function(){(0,B.localStorageSetItem)("themeName",e.themeName)})))}}})),function(e){return h.types.compose(ut(),ct(e)).props({views:h.types.array(e.pluggableMstType("view","stateModel"))}).actions((function(n){return{moveViewUp:function(e){var t=n.views.findIndex((function(n){return n.id===e}));-1!==t&&t>0&&n.views.splice(t-1,2,n.views[t],n.views[t-1])},moveViewDown:function(e){var t=n.views.findIndex((function(n){return n.id===e}));-1!==t&&t<n.views.length-1&&n.views.splice(t,2,n.views[t+1],n.views[t])},addView:function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.getElementType("view",t))throw new Error("unknown view type ".concat(t));var i=n.views.push((0,r.Z)((0,r.Z)({},o),{},{type:t}));return n.views[i-1]},removeView:function(e){var t,r=(0,mn.Z)(n.activeWidgets);try{for(r.s();!(t=r.n()).done;){var i=(0,o.Z)(t.value,2)[1];i.view&&i.view.id===e.id&&n.hideWidget(i)}}catch(a){r.e(a)}finally{r.f()}n.views.remove(e)},addLinearGenomeViewOfAssembly:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addViewOfAssembly("LinearGenomeView",e,n)},addViewOfAssembly:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.assemblies.find((function(e){return(0,R.readConfObject)(e,"name")===t}));if(!i)throw new Error('Could not add view of assembly "'.concat(t,'", assembly name not found'));return this.addView(e,(0,r.Z)((0,r.Z)({},o),{},{displayRegionsFromAssemblyName:(0,R.readConfObject)(i,"name")}))},addViewFromAnotherView:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=(0,r.Z)({},t);return o.displayedRegions=(0,h.getSnapshot)(n.displayedRegions),this.addView(e,o)}}}))}(t),lt(t),(n=i,h.types.model({sessionAssemblies:h.types.array(n)}).actions((function(e){var n=e;return{addSessionAssembly:function(e){var t=n.sessionAssemblies.find((function(n){return n.name===e.name}));if(t)return console.warn("Assembly ".concat(e.name," already exists")),t;var r=n.sessionAssemblies.push(e);return n.sessionAssemblies[r-1]},removeSessionAssembly:function(e){var t=n.sessionAssemblies.find((function(n){return n.name===e}));t&&n.sessionAssemblies.remove(t)}}}))),function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.types.frozen();return h.types.model({temporaryAssemblies:h.types.array(n)}).actions((function(e){var n=e;return{addTemporaryAssembly:function(e){var t=n.temporaryAssemblies.find((function(n){return n.name===e.name}));if(t)return console.warn("Assembly ".concat(e.name," was already existing")),t;var r=n.temporaryAssemblies.push(e);return n.temporaryAssemblies[r-1]},removeTemporaryAssembly:function(e){var t=n.temporaryAssemblies.find((function(n){return n.name===e}));t&&n.temporaryAssemblies.remove(t)}}}))}(t,i),ft(t)).props({margin:0,sessionPlugins:h.types.array(h.types.frozen())}).views((function(e){return{get tracks(){return[].concat((0,$.Z)(e.sessionTracks),(0,$.Z)(e.jbrowse.tracks))},get root(){return(0,h.getParent)(e)},get assemblies(){return[].concat((0,$.Z)(e.jbrowse.assemblies),(0,$.Z)(e.sessionAssemblies))},get connections(){return[].concat((0,$.Z)(e.jbrowse.connections),(0,$.Z)(e.sessionConnections))}}})).actions((function(e){return{setName:function(n){e.name=n}}})).volatile((function(){return{sessionThemeName:(0,B.localStorageGetItem)("themeName")||"default",task:void 0}})).views((function(e){return{get assemblyNames(){return e.assemblies.map((function(e){return(0,R.readConfObject)(e,"name")}))},get version(){return e.root.version},get shareURL(){return(0,R.getConf)(e.jbrowse,"shareURL")},get textSearchManager(){return e.root.textSearchManager},get assemblyManager(){return e.root.assemblyManager},get savedSessions(){return e.root.savedSessions},get previousAutosaveId(){return e.root.previousAutosaveId},get savedSessionNames(){return e.root.savedSessionNames},get history(){return e.root.history},get menus(){return e.root.menus},renderProps:function(){return{theme:e.theme}}}})).actions((function(e){return{addAssemblyConf:function(n){e.jbrowse.addAssemblyConf(n)},addSessionPlugin:function(n){if(e.sessionPlugins.some((function(e){return e.name===n.name})))throw new Error("session plugin cannot be installed twice");e.sessionPlugins.push(n),e.root.setPluginsUpdated(!0)},removeSessionPlugin:function(n){e.sessionPlugins=(0,h.cast)(e.sessionPlugins.filter((function(e){return e.url!==n.url||e.umdUrl!==n.umdUrl||e.cjsUrl!==n.cjsUrl||e.esmUrl!==n.esmUrl}))),(0,h.getParent)(e).setPluginsUpdated(!0)},addSavedSession:function(n){return e.root.addSavedSession(n)},removeSavedSession:function(n){return e.root.removeSavedSession(n)},renameCurrentSession:function(n){return e.root.renameCurrentSession(n)},duplicateCurrentSession:function(){return e.root.duplicateCurrentSession()},activateSession:function(n){return e.root.activateSession(n)},setDefaultSession:function(){return e.root.setDefaultSession()},saveSessionToLocalStorage:function(){return e.root.saveSessionToLocalStorage()},loadAutosaveSession:function(){return e.root.loadAutosaveSession()},setSession:function(n){return e.root.setSession(n)}}})).actions((function(e){return{editTrackConfiguration:function(n){var t=e.adminMode,r=e.sessionTracks;if(!t&&!r.includes(n))throw new Error("Can't edit the configuration of a non-session track");e.editConfiguration(n)}}})).views((function(e){return{getTrackActionMenuItems:function(n){var t=e.adminMode,r=e.sessionTracks,o=t||r.find((function(e){return e.trackId===n.trackId})),i="ReferenceSequenceTrack"===n.type;return[{label:"About track",onClick:function(){e.queueDialog((function(e){return[pt,{config:n,handleClose:e}]}))},icon:it.Z},{label:"Settings",disabled:!o,onClick:function(){return e.editTrackConfiguration(n)},icon:xn.Z},{label:"Delete track",disabled:!o||i,onClick:function(){return e.deleteTrackConf(n)},icon:ot.Z},{label:"Copy track",disabled:i,onClick:function(){var t=Dn()((0,h.getSnapshot)(n)),r=Date.now();t.trackId+="-".concat(r),t.displays.forEach((function(e){e.displayId+="-".concat(r)})),e.adminMode||(t.trackId+="-sessionTrack",t.category=void 0),t.name+=" (copy)",e.addTrackConf(t)},icon:kn.Z}]}}})).actions((function(e){return{afterAttach:function(){(0,h.addDisposer)(e,(0,xe.autorun)((function(){(0,B.localStorageSetItem)("drawerPosition",e.drawerPosition),(0,B.localStorageSetItem)("themeName",e.themeName)})))}}})),s=t.evaluateExtensionPoint("Core-extendSession",a);return h.types.snapshotProcessor(rt(s),{preProcessor:function(e){if(e){var n=e||{},t=n.connectionInstances,r=(0,cn.Z)(n,dt);if(!Array.isArray(t))return r}return e}})}function vt(e){return ht({pluginManager:e.pluginManager,assemblyConfigSchema:e.assemblyConfigSchema})}var mt=t(7694);function gt(e){var n,t,o,i=new dn.Z([].concat((0,$.Z)(mt.Z.map((function(e){return{plugin:new e,metadata:{isCore:!0}}}))),(0,$.Z)(e.runtimePlugins.map((function(e){var n=e.plugin,t=e.definition;return{plugin:new n,definition:t,metadata:{url:t.url}}}))),(0,$.Z)(e.sessionPlugins.map((function(e){var n=e.plugin,t=e.definition;return{plugin:new n,definition:t,metadata:{url:t.url}}})))));i.createPluggableElements();var a=tt({pluginManager:i,sessionModelFactory:vt,adminMode:!!e.adminKey});if(e.configSnapshot){var s=a.create({jbrowse:e.configSnapshot,configPath:e.configPath},{pluginManager:i});if(null===(n=e.configSnapshot)||void 0===n||null===(t=n.configuration)||void 0===t||null===(o=t.rpc)||void 0===o||!o.defaultDriver)s.jbrowse.configuration.rpc.defaultDriver.set("WebWorkerRpcDriver");var c=function(){};try{var u,l;e.sessionError?(s.setDefaultSession(),s.session.notify("Error loading session: ".concat(e.sessionError,'. If you\n                received this URL from another user, request that they send you\n                a session generated with the "Share" button instead of copying\n                and pasting their URL'))):e.sessionSnapshot?s.setSession(e.sessionSnapshot):e.sessionSpec?c=function(e,n){var t=e.views,o=e.sessionTracks,i=void 0===o?[]:o;return(0,p.Z)((0,d.Z)().mark((function e(){var o,a;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.rootModel){e.next=3;break}throw new Error("rootModel not initialized");case 3:return e.prev=3,o.setSession({name:"New session ".concat((new Date).toLocaleString())}),i.forEach((function(e){return o.session.addTrackConf(e)})),e.next=8,Promise.all(t.map((function(e){return n.evaluateAsyncExtensionPoint("LaunchView-"+e.type,(0,r.Z)((0,r.Z)({},e),{},{session:o.session}))})));case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),console.error(e.t0),null===(a=o.session)||void 0===a||a.notify("".concat(e.t0));case 14:case"end":return e.stop()}}),e,null,[[3,10]])})))}(e.sessionSpec,i):null!==(u=s.jbrowse.defaultSession)&&void 0!==u&&null!==(l=u.views)&&void 0!==l&&l.length&&s.setDefaultSession()}catch(v){var f;s.setDefaultSession();var h="".concat(v).replace("[mobx-state-tree] ","").replace(/\(.+/,"");null===(f=s.session)||void 0===f||f.notify("Session could not be loaded. ".concat(h.length>1e3?"".concat(h.slice(0,1e3),"...see more in console"):h)),console.error(v)}return vn(s,e.initialTimestamp,e.sessionQuery),i.setRootModel(s),i.configure(),c(),i}}var yt=(0,i.lazy)((function(){return t.e(2327).then(t.bind(t,72327))})),bt=(0,i.lazy)((function(){return t.e(3720).then(t.bind(t,33720))})),wt=(0,i.lazy)((function(){return Promise.all([t.e(8581),t.e(995)]).then(t.bind(t,7906))}));function xt(e){var n=e.initialTimestamp,t=void 0===n?Date.now():n,r=function(e){return null===e?void 0:e},a=c.StringParam,s=(0,c.useQueryParam)("config",a),u=(0,o.Z)(s,1)[0],l=(0,c.useQueryParam)("session",a),f=(0,o.Z)(l,1)[0],d=(0,c.useQueryParam)("adminKey",a),p=(0,o.Z)(d,1)[0],h=(0,c.useQueryParam)("password",a),v=(0,o.Z)(h,2),m=v[0],g=v[1],y=(0,c.useQueryParam)("loc",a),b=(0,o.Z)(y,2),w=b[0],x=b[1],Z=(0,c.useQueryParam)("sessionTracks",a),k=(0,o.Z)(Z,2),C=k[0],j=k[1],A=(0,c.useQueryParam)("assembly",a),T=(0,o.Z)(A,2),M=T[0],E=T[1],P=(0,c.useQueryParam)("tracks",a),I=(0,o.Z)(P,2),N=I[0],R=I[1],D=sn.create({configPath:r(u),sessionQuery:r(f),password:r(m),adminKey:r(p),loc:r(w),assembly:r(M),tracks:r(N),sessionTracks:r(C),initialTimestamp:t});return(0,i.useEffect)((function(){x(void 0),R(void 0),E(void 0),g(void 0),j(void 0)}),[E,x,R,g,j]),(0,S.jsx)(Zt,{loader:D})}var Zt=(0,a.observer)((function(e){var n,t=e.loader,r=t.configError,a=t.ready,s=t.shareWarningOpen,c=(0,i.useState)(),u=(0,o.Z)(c,2),d=u[0],p=u[1],h=(0,i.useState)(),v=(0,o.Z)(h,2),m=v[0],g=v[1];return(0,i.useEffect)((function(){try{if(!a||s)return;var e=gt(t);p(e)}catch(n){console.error(n),g(n)}}),[t,a,s]),r||m?(0,S.jsx)(fn,{error:r||m}):t.sessionTriaged?(0,S.jsx)(i.Suspense,{fallback:(0,S.jsx)(i.Fragment,{}),children:"session"===t.sessionTriaged.origin?(0,S.jsx)(bt,{loader:t,handleClose:function(){return t.setSessionTriaged(void 0)}}):(0,S.jsx)(yt,{loader:t,handleClose:function(){return t.setSessionTriaged(void 0)}})}):d?null!==(n=d.rootModel)&&void 0!==n&&n.session?(0,S.jsx)(en,{pluginManager:d}):(0,S.jsx)(i.Suspense,{fallback:(0,S.jsx)(l.LoadingEllipses,{}),children:(0,S.jsx)(wt,{rootModel:d.rootModel,onFactoryReset:nn.Z})}):(0,S.jsx)(f.Z,{})})),kt=function(e){var n=e.initialTimestamp;return(0,S.jsx)(s.SV,{FallbackComponent:function(e){return(0,S.jsx)(l.FatalErrorDialog,(0,r.Z)((0,r.Z)({},e),{},{resetButtonText:"Reset Session",onFactoryReset:nn.Z}))},children:(0,S.jsx)(c.QueryParamProvider,{adapter:u.V,children:(0,S.jsx)(xt,{initialTimestamp:n})})})}},73207:function(e,n,t){t.d(n,{Z:function(){return i}});var r=t(32723),o=t(34795);function i(){return a.apply(this,arguments)}function a(){return(a=(0,o.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.location=window.location.pathname;case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},65828:function(e,n,t){t.d(n,{h:function(){return d},p:function(){return l}});var r=t(32723),o=t(34795),i=t(68079),a=t(35719);var s=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n,o){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(8682),t.e(6125)]).then(t.t.bind(t,66125,23));case 2:return i=e.sent,e.abrupt("return",i.encrypt(n,o).toString());case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),c=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n,o){var i,a,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(8682),t.e(6125)]).then(t.t.bind(t,66125,23));case 2:return i=e.sent,e.next=5,t.e(25).then(t.t.bind(t,90025,23));case 5:return a=e.sent,s=i.decrypt(n,o),e.abrupt("return",s.toString(a));case 8:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}();function u(e){try{return JSON.parse(e).message}catch(n){return e}}function l(e,n,t){return f.apply(this,arguments)}function f(){return(f=(0,o.Z)((0,r.Z)().mark((function e(n,t,o){var c,l,f,d,p,h,v;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.JY)(JSON.stringify(n));case 2:return c=e.sent,r=5,l=window.btoa((0,i.Z)(window.crypto.getRandomValues(new Uint8Array(2*r))).map((function(e){return String.fromCharCode(e)})).join("")).replaceAll(/[+/]/g,"").slice(0,r),e.next=6,s(c,l);case 6:return f=e.sent,(d=new FormData).append("session",f),d.append("dateShared","".concat(Date.now())),d.append("referer",o),e.next=13,fetch("".concat(t,"share"),{method:"POST",mode:"cors",body:d});case 13:if((p=e.sent).ok){e.next=19;break}return e.next=17,p.text();case 17:throw h=e.sent,new Error(u(h));case 19:return e.next=21,p.json();case 21:return v=e.sent,e.abrupt("return",{json:v,encryptedSession:f,password:l});case 23:case"end":return e.stop()}var r}),e)})))).apply(this,arguments)}function d(e,n,t,r){return p.apply(this,arguments)}function p(){return(p=(0,o.Z)((0,r.Z)().mark((function e(n,t,o,i){var a,s,l,f,d;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.split("share-")[1],s="".concat(n,"?sessionId=").concat(encodeURIComponent(a)),e.next=4,fetch(s,{signal:i});case 4:if((l=e.sent).ok){e.next=10;break}return e.next=8,l.text();case 8:throw f=e.sent,new Error(u(f));case 10:return e.next=12,l.json();case 12:return d=e.sent,e.abrupt("return",c(d.session,o));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},35719:function(e,n,t){t.d(n,{H1:function(){return h},JY:function(){return f},Yr:function(){return p},bP:function(){return v},cD:function(){return u},t$:function(){return y},uV:function(){return w}});var r=t(32723),o=t(96234),i=t(34795),a=t(15659),s=t(63680);function c(e){var n=0;switch(e.length%4){case 3:n=1;break;case 2:n=2;break;case 0:n=0;break;default:throw new Error("base64 not a valid length")}return e+"=".repeat(n)}function u(e){return l.apply(this,arguments)}function l(){return(l=(0,i.Z)((0,r.Z)().mark((function e(n){var o,i,a,s,u,l,f;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=c(n.replaceAll("-","+").replaceAll("_","/")),e.next=3,Promise.resolve().then(t.t.bind(t,95145,19));case 3:return i=e.sent,a=i.toByteArray,e.next=7,t.e(5470).then(t.bind(t,95470));case 7:return s=e.sent,u=s.inflate,l=a(o),f=u(l),e.abrupt("return",(new TextDecoder).decode(f));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return d.apply(this,arguments)}function d(){return(d=(0,i.Z)((0,r.Z)().mark((function e(n){var o,i,a,s,c,u,l,f;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(new TextEncoder).encode(n),e.next=3,t.e(5470).then(t.bind(t,95470));case 3:return i=e.sent,a=i.deflate,e.next=7,Promise.resolve().then(t.t.bind(t,95145,19));case 7:return s=e.sent,c=s.fromByteArray,u=a(o),l=c(u),f=l.indexOf("="),e.abrupt("return",f>0?l.slice(0,f).replaceAll("+","-").replaceAll("/","_"):l.replaceAll("+","-").replaceAll("/","_"));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e,n){if(void 0!==e)if((0,s.isArrayType)(n)){var t=e,r=(0,s.getChildType)(e);if((0,s.isReferenceType)(r))for(var i=function(e){(0,s.isValidReference)((function(){return t[e]}))?e+=1:t.splice(e,1),a=e},a=0;a<t.length;)i(a);t.forEach((function(e){p(e,r)}))}else if((0,s.isMapType)(n)){var c=e,u=(0,s.getChildType)(c);if((0,s.isReferenceType)(u)){var l=function(e){(0,s.isValidReference)((function(){return c.get(e)}))||c.delete(e)};for(var f in c.keys())l(f)}c.forEach((function(e){p(e,u)}))}else if((0,s.isModelType)(n)){var d=(0,s.getPropertyMembers)(e).properties;Object.entries(d).forEach((function(n){var t=(0,o.Z)(n,2),r=t[0],i=t[1];p(e[r],i)}))}}function h(e,n){if("object"===typeof e)for(var t=0,r=Object.keys(e);t<r.length;t++){var o=r[t];"object"===typeof e[o]?h(e[o],n):"uri"===o&&(e.baseUri=n.href)}}function v(e,n,t){var r=e.configuration;return(null===r||void 0===r?void 0:r[n])||t}function m(){return g.apply(this,arguments)}function g(){return(g=(0,i.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://jbrowse.org/plugin-store/plugins.json");case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("HTTP ".concat(n.status," ").concat(n.statusText," fetching plugins"));case 5:return e.abrupt("return",n.json());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return b.apply(this,arguments)}function b(){return(b=(0,i.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==n.length){e.next=2;break}return e.abrupt("return",!0);case 2:return e.next=4,m();case 4:return t=e.sent,e.abrupt("return",n.every((function(e){return(0,a.sI)(e)?t.plugins.some((function(n){return(0,a.sI)(e)&&("url"in n&&"url"in e&&e.url===n.url||"umdUrl"in n&&"umdUrl"in e&&e.umdUrl===n.umdUrl)})):(0,a.bm)(e)?t.plugins.some((function(n){return(0,a.bm)(e)&&"esmUrl"in e&&e.esmUrl===n.esmUrl})):!!(0,a.Mv)(e)&&t.plugins.some((function(n){return(0,a.Mv)(e)&&e.cjsUrl===n.cjsUrl}))})));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,n){for(var t in e)t===n?delete e[t]:"object"===typeof e[t]&&w(e[t],n);return e}}}]);
//# sourceMappingURL=16.e6cd58a2.chunk.js.map