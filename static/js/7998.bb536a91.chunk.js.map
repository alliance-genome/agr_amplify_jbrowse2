{"version":3,"file":"static/js/7998.bb536a91.chunk.js","mappings":"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","sources":["../../../plugins/alignments/src/AlignmentsFeatureDetail/AlignmentsFeatureDetail.tsx","../../../node_modules/@mui/icons-material/Settings.js"],"sourcesContent":["import React, { useState } from 'react'\nimport {\n  Typography,\n  Link,\n  Paper,\n  Checkbox,\n  FormControlLabel,\n  FormGroup,\n} from '@mui/material'\nimport { makeStyles } from 'tss-react/mui'\nimport { observer } from 'mobx-react'\nimport { getSession } from '@jbrowse/core/util'\nimport copy from 'copy-to-clipboard'\nimport clone from 'clone'\nimport {\n  FeatureDetails,\n  BaseCard,\n  SimpleValue,\n} from '@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail'\nimport { parseCigar } from '../MismatchParser'\n\nconst useStyles = makeStyles()({\n  compact: {\n    paddingRight: 0,\n    paddingTop: 0,\n    paddingBottom: 0,\n  },\n})\n\nconst omit = ['clipPos', 'flags']\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction AlignmentFlags(props: { feature: any }) {\n  const { classes } = useStyles()\n  const { feature } = props\n  const { flags } = feature\n  const flagNames = [\n    'read paired',\n    'read mapped in proper pair',\n    'read unmapped',\n    'mate unmapped',\n    'read reverse strand',\n    'mate reverse strand',\n    'first in pair',\n    'second in pair',\n    'not primary alignment',\n    'read fails platform/vendor quality checks',\n    'read is PCR or optical duplicate',\n    'supplementary alignment',\n  ]\n  return (\n    <BaseCard {...props} title=\"Flags\">\n      <SimpleValue name={'Flag'} value={flags} />\n\n      <FormGroup>\n        {flagNames.map((name, index) => {\n          const val = flags & (1 << index)\n          const key = `${name}_${val}`\n          return (\n            <FormControlLabel\n              key={key}\n              control={\n                <Checkbox\n                  className={classes.compact}\n                  checked={Boolean(val)}\n                  name={name}\n                  readOnly\n                />\n              }\n              label={name}\n            />\n          )\n        })}\n      </FormGroup>\n    </BaseCard>\n  )\n}\n\nfunction Formatter({ value }: { value: unknown }) {\n  const [show, setShow] = useState(false)\n  const [copied, setCopied] = useState(false)\n  const display = String(value)\n  if (display.length > 100) {\n    return (\n      <>\n        <button\n          type=\"button\"\n          onClick={() => {\n            copy(display)\n            setCopied(true)\n            setTimeout(() => {\n              setCopied(false)\n            }, 700)\n          }}\n        >\n          {copied ? 'Copied to clipboard' : 'Copy'}\n        </button>\n        <button type=\"button\" onClick={() => setShow(val => !val)}>\n          {show ? 'Show less' : 'Show more'}\n        </button>\n        <div>{show ? display : `${display.slice(0, 100)}...`}</div>\n      </>\n    )\n  }\n  return <div>{display}</div>\n}\n\n// utility function to get length of alignment from cigar\nfunction getLengthOnRef(cigar: string) {\n  const cigarOps = parseCigar(cigar)\n  let lengthOnRef = 0\n  for (let i = 0; i < cigarOps.length; i += 2) {\n    const len = +cigarOps[i]\n    const op = cigarOps[i + 1]\n    if (op !== 'H' && op !== 'S' && op !== 'I') {\n      lengthOnRef += len\n    }\n  }\n  return lengthOnRef\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction SupplementaryAlignments(props: { tag: string; model: any }) {\n  const { tag, model } = props\n  const session = getSession(model)\n  return (\n    <BaseCard {...props} title=\"Supplementary alignments\">\n      <Typography>List of supplementary alignment locations</Typography>\n      <ul>\n        {tag\n          .split(';')\n          .filter(SA => !!SA)\n          .map((SA, index) => {\n            const [saRef, saStart, saStrand, saCigar] = SA.split(',')\n            const saLength = getLengthOnRef(saCigar)\n            const extra = Math.floor(saLength / 5)\n            const start = +saStart\n            const end = +saStart + saLength\n            const locString = `${saRef}:${Math.max(1, start - extra)}-${\n              end + extra\n            }`\n            const displayStart = start.toLocaleString('en-US')\n            const displayEnd = end.toLocaleString('en-US')\n            const displayString = `${saRef}:${displayStart}-${displayEnd} (${saStrand})`\n            return (\n              <li key={`${locString}-${index}`}>\n                <Link\n                  onClick={async event => {\n                    event.preventDefault()\n                    const { view } = model\n                    try {\n                      if (view) {\n                        await view.navToLocString(locString)\n                      } else {\n                        throw new Error(\n                          'No view associated with this view anymore',\n                        )\n                      }\n                    } catch (e) {\n                      console.error(e)\n                      session.notify(`${e}`)\n                    }\n                  }}\n                  href=\"#\"\n                >\n                  {displayString}\n                </Link>\n              </li>\n            )\n          })}\n      </ul>\n    </BaseCard>\n  )\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction PairLink({ locString, model }: { locString: string; model: any }) {\n  const session = getSession(model)\n  return (\n    <Link\n      onClick={async () => {\n        const { view } = model\n        if (!view) {\n          throw new Error(\n            'No view associated with this feature detail panel anymore',\n          )\n        }\n        try {\n          await view.navToLocString(locString)\n        } catch (e) {\n          console.error(e)\n          session.notify(`${e}`)\n        }\n      }}\n      href=\"#\"\n    >\n      {locString}\n    </Link>\n  )\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction AlignmentFeatureDetails(props: { model: any }) {\n  const { model } = props\n  const feat = clone(model.featureData)\n  const SA = (feat.tags && feat.tags.SA) || feat.SA\n  return (\n    <Paper data-testid=\"alignment-side-drawer\">\n      <FeatureDetails\n        {...props}\n        omit={omit}\n        feature={feat}\n        formatter={(value, key) => {\n          return key === 'next_segment_position' ? (\n            <PairLink model={model} locString={value as string} />\n          ) : (\n            <Formatter value={value} />\n          )\n        }}\n      />\n      {SA ? <SupplementaryAlignments model={model} tag={SA} /> : null}\n      {feat.flags !== undefined ? (\n        <AlignmentFlags feature={feat} {...props} />\n      ) : null}\n    </Paper>\n  )\n}\n\nexport default observer(AlignmentFeatureDetails)\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z\"\n}), 'Settings');\nexports.default = _default;"],"names":["useStyles","makeStyles","compact","paddingRight","paddingTop","paddingBottom","omit","AlignmentFlags","props","classes","flags","feature","_jsxs","BaseCard","_objectSpread","title","children","_jsx","SimpleValue","name","value","FormGroup","map","index","val","key","concat","FormControlLabel","control","Checkbox","className","checked","Boolean","readOnly","label","Formatter","_ref","_useState","useState","_useState2","_slicedToArray","show","setShow","_useState3","_useState4","copied","setCopied","display","String","length","_Fragment","type","onClick","copy","setTimeout","slice","SupplementaryAlignments","tag","model","session","getSession","Typography","split","filter","SA","_SA$split","_SA$split2","saRef","saStart","saStrand","saLength","cigar","cigarOps","parseCigar","lengthOnRef","i","len","op","getLengthOnRef","extra","Math","floor","start","end","locString","max","displayStart","toLocaleString","displayEnd","displayString","Link","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","view","wrap","_context","prev","next","preventDefault","navToLocString","Error","t0","console","error","notify","stop","_x","apply","arguments","href","PairLink","_ref3","_callee2","_context2","observer","feat","clone","featureData","tags","Paper","FeatureDetails","formatter","undefined","_interopRequireDefault","require","exports","_createSvgIcon","_jsxRuntime","_default","default","jsx","d"],"sourceRoot":""}