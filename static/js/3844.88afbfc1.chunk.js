"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[3844],{63844:(e,t,a)=>{a.r(t),a.d(t,{default:()=>I});var r=a(66204),o=a(80846),n=a(90872),s=a(55022),i=a(35421),c=a(29520),l=a(31617),m=a(90228),d=a(80013),p=a(23540),h=a(2749),u=a(46338),w=a(62301),f=a(7146),k=a(59062),b=a(78155),g=a(38684),Z=a(49084),y=a(2266),E=a(98621),S=a(71932),x=a(97990);const v=(0,g.ZL)()((e=>({flexItem:{margin:5},expandIcon:{color:e.palette.tertiary?.contrastText||"#fff"}}))),I=(0,o.observer)((function({onClose:e,model:t}){const{classes:a}=v(),[o,g]=(0,r.useState)(),[I,C]=(0,r.useState)(),[N,A]=(0,r.useState)(""),D=(0,n.getSession)(t),{assemblyNames:L}=D,[j,P]=(0,r.useState)(L[0]),[R,T]=(0,r.useState)("shareLinkAccordion");return r.createElement(i.Dialog,{open:!0,onClose:e,maxWidth:"xl",title:"Import bookmarks"},r.createElement(c.Z,null,r.createElement(l.Z,{expanded:"shareLinkAccordion"===R,onChange:()=>T("shareLinkAccordion")},r.createElement(m.Z,{expandIcon:r.createElement(y.Z,{className:a.expandIcon})},r.createElement(d.Z,{style:{display:"flex",alignItems:"center",gap:"5px"}},"Import from share link"," ",r.createElement(p.Z,{title:"The appropriate share link for sharing bookmarks is one generated via the 'Share' button in the 'Bookmarked regions' drawer. Paste it below to import shared bookmarks."},r.createElement(E.Z,null)))),r.createElement(h.Z,null,r.createElement(u.Z,{label:"Enter URL",variant:"outlined",style:{width:"100%"},value:N,onChange:e=>A(e.target.value)}))),r.createElement(l.Z,{expanded:"fileAccordion"===R,onChange:()=>T("fileAccordion")},r.createElement(m.Z,{expandIcon:r.createElement(y.Z,{className:a.expandIcon})},r.createElement(d.Z,null,"Import from file")),r.createElement(h.Z,null,r.createElement(i.FileSelector,{location:o,setLocation:g,name:"File",description:"Choose a BED or TSV format file to import."}),r.createElement(b.Z,{onChange:e=>P(e),helperText:"Select the assembly your bookmarks belong to (BED or TSV without assembly column).",session:D,selected:j}))),I?r.createElement(d.Z,{color:"error",variant:"h6"},`${I}`):null),r.createElement(w.Z,null,r.createElement(f.Z,{variant:"contained",color:"secondary",onClick:e},"Cancel"),r.createElement(f.Z,{className:a.flexItem,"data-testid":"dialogImport",variant:"contained",color:"primary",disabled:!o&&!N,startIcon:r.createElement(Z.Z,null),onClick:async()=>{try{o?t.importBookmarks(await async function(e,t){return(await(0,k.openLocation)(e).readFile("utf8")).split(/\n|\r\n|\r/).filter((e=>!!e.trim())).filter((e=>!e.startsWith("#")&&!e.startsWith("track")&&!e.startsWith("browser"))).map((e=>{const[a,r,o,n,s]=e.split("\t");return{assemblyName:s??t,refName:a,start:+r,end:+o,label:"."===n?void 0:n}}))}(o,j)):N&&(0,s.gx)(D)&&t.importBookmarks(await async function(e,t){const a=new URL(e),r=a.searchParams.get("bookmarks"),o=a.searchParams.get("password"),n=await(0,x.h)(`${t??"https://share.jbrowse.org/api/v1/"}load`,r||"",o||"");return JSON.parse(await(0,S.cD)(n)).sharedBookmarks}(N,D.shareURL)),e()}catch(e){console.error(e),C(e)}}},"Import")))}))},97990:(e,t,a)=>{a.d(t,{h:()=>c,p:()=>i});var r=a(71932);const o=async(e,t)=>(await Promise.all([a.e(1034),a.e(5456),a.e(633)]).then(a.t.bind(a,55456,23))).encrypt(e,t).toString(),n=async(e,t)=>{const r=await Promise.all([a.e(1034),a.e(5456),a.e(633)]).then(a.t.bind(a,55456,23)),o=await Promise.all([a.e(1034),a.e(7926)]).then(a.t.bind(a,99693,23));return r.decrypt(e,t).toString(o)};function s(e){try{return JSON.parse(e).message}catch(t){return e}}async function i(e,t,a){const n=await(0,r.JY)(JSON.stringify(e)),i=(5,window.btoa([...window.crypto.getRandomValues(new Uint8Array(10))].map((e=>String.fromCharCode(e))).join("")).replaceAll(/[+/]/g,"").slice(0,5));const c=await o(n,i),l=new FormData;l.append("session",c),l.append("dateShared",`${Date.now()}`),l.append("referer",a);const m=await fetch(`${t}share`,{method:"POST",mode:"cors",body:l});if(!m.ok){const e=await m.text();throw new Error(s(e))}return{json:await m.json(),encryptedSession:c,password:i}}async function c(e,t,a,r){const o=t.split("share-")[1],i=`${e}?sessionId=${encodeURIComponent(o)}`,c=await fetch(i,{signal:r});if(!c.ok){const e=await c.text();throw new Error(s(e))}const l=await c.json();return n(l.session,a)}},2749:(e,t,a)=>{a.d(t,{Z:()=>u});var r=a(30984),o=a(55559),n=a(66204),s=a(56317),i=a(58029),c=a(61125),l=a(57369),m=a(72197),d=a(43188);const p=["className"],h=(0,c.ZP)("div",{name:"MuiAccordionDetails",slot:"Root",overridesResolver:(e,t)=>t.root})((({theme:e})=>({padding:e.spacing(1,2,2)}))),u=n.forwardRef((function(e,t){const a=(0,l.Z)({props:e,name:"MuiAccordionDetails"}),{className:n}=a,c=(0,o.Z)(a,p),u=a,w=(e=>{const{classes:t}=e;return(0,i.Z)({root:["root"]},m.s,t)})(u);return(0,d.jsx)(h,(0,r.Z)({className:(0,s.Z)(w.root,n),ref:t,ownerState:u},c))}))},72197:(e,t,a)=>{a.d(t,{Z:()=>s,s:()=>n});var r=a(58109),o=a(95201);function n(e){return(0,o.Z)("MuiAccordionDetails",e)}const s=(0,r.Z)("MuiAccordionDetails",["root"])}}]);
//# sourceMappingURL=3844.88afbfc1.chunk.js.map