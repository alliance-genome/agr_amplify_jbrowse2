"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[3135],{3135:function(e,n,o){o.r(n),o.d(n,{default:function(){return he}});var t=o(96234),r=o(96902),l=o(54417),i=o(91188),s=o(4782),a=o(17867),c=o(13655),d=o(2868),u=o(52),m=o(99782),p=o(80367),h=o(12221),f=o(32114),g=o(44536),b=o(63680),x=o(27664),v=o(66519),j=o(29938),w=(0,i.ZL)()({textField:{width:"2rem",verticalAlign:"baseline"}}),N=(0,s.observer)((function(e){var n=e.model,o=e.disabled,l=e.modelPropName,i=e.modelSetterName,s=(0,r.useState)(n[l]),a=(0,t.Z)(s,2),c=a[0],d=a[1],u=w().classes;return(0,r.useEffect)((function(){var e=Number.parseInt(c,10);Number.isNaN(e)||(e>0?n[i](e):d(1))}),[n,i,c]),(0,j.jsx)(v.Z,{value:c,disabled:o,type:"number",onChange:function(e){return d(e.target.value)},className:u.textField})})),C=(0,i.ZL)()({container:{margin:"0 auto",maxWidth:"25em",padding:20}}),Z=(0,s.observer)((function(e){var n,o=e.model,l=(0,x.getSession)(o),i=C().classes,s=l.assemblyNames,v=l.assemblyManager,w=o.fileType,Z=o.canCancel,y=o.fileSource,M=o.isReadyToOpen,S=o.fileTypes,k=o.hasColumnNameLine,P=o.error,F=(0,r.useState)(s[0]),T=(0,t.Z)(F,2),I=T[0],L=T[1],R=(null===(n=v.get(I))||void 0===n?void 0:n.error)||P,B="CSV"===w||"TSV"===w,z=(0,b.getRoot)(o);return(0,j.jsxs)("div",{className:i.container,children:[R?(0,j.jsx)(a.ErrorMessage,{error:R}):null,(0,j.jsx)("div",{children:(0,j.jsxs)(c.Z,{component:"fieldset",children:[(0,j.jsx)(d.Z,{component:"legend",children:"Tabular file"}),(0,j.jsx)(u.Z,{children:(0,j.jsx)(a.FileSelector,{location:y,setLocation:function(e){return o.setFileSource(e)},rootModel:z})})]})}),(0,j.jsx)("div",{children:(0,j.jsxs)(c.Z,{component:"fieldset",children:[(0,j.jsx)(d.Z,{component:"legend",children:"File Type"}),(0,j.jsx)(m.Z,{row:!0,"aria-label":"file type",name:"type",value:w,children:S.map((function(e){return(0,j.jsx)(p.Z,{checked:w===e,value:e,onClick:function(){return o.setFileType(e)},control:(0,j.jsx)(h.Z,{}),label:e},e)}))})]})}),B?(0,j.jsx)("div",{children:(0,j.jsxs)(c.Z,{component:"fieldset",children:[(0,j.jsx)(d.Z,{component:"legend",children:"Column Names"}),(0,j.jsx)(p.Z,{disabled:!B,label:"has column names on line",labelPlacement:"end",control:(0,j.jsx)(f.Z,{checked:k,onClick:function(){return o.toggleHasColumnNameLine()}})}),(0,j.jsx)(N,{model:o,disabled:!B||!k,modelPropName:"columnNameLineNumber",modelSetterName:"setColumnNameLineNumber"})]})}):null,(0,j.jsx)("div",{children:(0,j.jsx)(a.AssemblySelector,{session:l,selected:I,onChange:function(e){return L(e)}})}),(0,j.jsxs)("div",{children:[Z?(0,j.jsx)(g.Z,{variant:"contained",color:"secondary",onClick:function(){return o.cancelButton()},disabled:!Z,children:"Cancel"}):null," ",(0,j.jsx)(g.Z,{disabled:!M||!!R,variant:"contained","data-testid":"open_spreadsheet",color:"primary",onClick:function(){o.import(I)},children:"Open"})]})]})})),y=o(33028),M=(0,s.observer)((function(e){var n,o=e.viewModel,t=e.spreadsheetModel,r=t.rowMenuPosition,l=t.setRowMenuPosition,i=function(){l(null)},s=null===(n=t.rowMenuPosition)||void 0===n?void 0:n.rowNumber;if(void 0===s)return null;var c=t.rowSet.rows[+s-1];var d=o.rowMenuItems.map((function(e){if("function"===typeof e.disabled){var n=e.disabled(o,t,+s,c);return(0,y.Z)((0,y.Z)({},e),{},{disabled:n})}return e}));return(0,j.jsx)(a.Menu,{anchorEl:r&&r.anchorEl,open:Boolean(r),onMenuItemClick:function(e,n){n(o,t,s,c),i()},onClose:i,menuItems:d,anchorOrigin:{vertical:"bottom",horizontal:"right"}})})),S=o(25322),k=o(59953),P=o(74859),F=(0,s.observer)((function(e){var n=e.cell,o=e.spreadsheetModel,t=e.columnNumber,r=o.columns[t];return r&&"dataType"in r&&r.dataType.DataCellReactComponent?(0,j.jsx)(r.dataType.DataCellReactComponent,{cell:n,dataType:r.dataType,columnNumber:t,spreadsheet:o}):n.text})),T=(0,i.ZL)()((function(e){return{rowNumCell:{textAlign:"left",border:"1px solid ".concat(e.palette.action.disabledBackground),position:"relative",padding:"0 2px 0 0",whiteSpace:"nowrap",userSelect:"none"},rowNumber:{fontWeight:"normal",display:"inline-block",flex:"none",paddingRight:"20px",margin:0,whiteSpace:"nowrap"},rowMenuButton:{padding:0,margin:0,position:"absolute",right:0,display:"inline-block",whiteSpace:"nowrap",flex:"none"},rowMenuButtonIcon:{},rowSelector:{position:"relative",top:"-2px",margin:0,padding:"0 0.2rem"},dataRowSelected:{background:k.Z[100],"& th":{background:k.Z[100]}}}})),I=(0,s.observer)((function(e){var n=e.rowModel,o=e.rowNumber,t=e.spreadsheetModel,r=T().classes,l=t.hideRowSelection,i=t.columnDisplayOrder,s="";function a(e){n.toggleSelect(),e.stopPropagation(),e.preventDefault()}return n.isSelected&&(s+="".concat(r.dataRowSelected)),(0,j.jsxs)("tr",{className:s,children:[(0,j.jsxs)("td",{className:r.rowNumCell,onClick:a,children:[l?(0,j.jsx)(p.Z,{className:r.rowNumber,control:(0,j.jsx)(f.Z,{className:r.rowSelector,checked:n.isSelected,onClick:a}),label:n.id}):null,(0,j.jsx)(S.Z,{className:r.rowMenuButton,onClick:function(e){t.setRowMenuPosition({anchorEl:e.currentTarget,rowNumber:o}),e.preventDefault(),e.stopPropagation()},children:(0,j.jsx)(P.Z,{className:r.rowMenuButtonIcon})})]}),i.map((function(e){return(0,j.jsx)("td",{children:(0,j.jsx)(F,{cell:n.cellsWithDerived[e],spreadsheetModel:t,columnNumber:e})},e)}))]})})),L=o(50543),R=o(3252),B=o(24274),z=o(57738),E=o(53737),A=o(72824),D=(0,s.observer)((function(e){var n=e.viewModel,o=e.spreadsheetModel,r=e.currentColumnMenu,l=e.setColumnMenu,i=function(){return l(void 0)},s=(null===r||void 0===r?void 0:r.colNumber)||0,c=function(e){o.setSortColumns([{columnNumber:s,descending:e}])},d=o.dataTypeChoices,u=new Map;d.forEach((function(e){var n=e.displayName,o=e.categoryName;if(o){var t=u.get(o);t||(t={isCategory:!0,subMenuItems:[]},u.set(o,t)),t.subMenuItems.push(e)}else u.set(n,e)}));var m=o.columns,p=o.sortColumns,h=r&&m[s].dataType,f=(null===h||void 0===h?void 0:h.type)||"",g=r&&m[s].dataType.displayName||"",b=!!r&&p.some((function(e){return e.columnNumber===r.colNumber&&!e.descending})),v=!!r&&p.some((function(e){return e.columnNumber===r.colNumber&&e.descending})),w=[{label:"Sort ascending",icon:A.Z,type:"radio",checked:b,onClick:function(){return c(!1)}},{label:"Sort descending",icon:A.Z,type:"radio",checked:v,onClick:function(){return c(!0)}},{label:"No sort",icon:A.Z,type:"radio",checked:!v&&!b,onClick:function(){return o.setSortColumns([])}},{label:"Type: ".concat(g),icon:E.Z,subMenu:(0,x.iterMap)(u.entries(),(function(e){var n=(0,t.Z)(e,2),r=n[0],l=n[1];if("typeName"in l&&l.typeName){var i=l.typeName;return{label:r||i,icon:f===i?B.Z:void 0,onClick:function(){return o.setColumnType(s,i)}}}if("subMenuItems"in l&&l.subMenuItems){var a=l.subMenuItems;return{label:r,icon:a.some((function(e){return e.typeName===f}))?B.Z:void 0,subMenu:a.map((function(e){var n=e.typeName;return{label:e.displayName,icon:n===f?B.Z:void 0,onClick:function(){return o.setColumnType(s,n)}}}))}}return null})).filter(Boolean)}];return null!==h&&void 0!==h&&h.hasFilter&&w.push({label:"Create filter",icon:z.Z,onClick:function(){return n.filterControls.addBlankColumnFilter(s)}}),(0,j.jsx)(a.Menu,{anchorEl:null===r||void 0===r?void 0:r.anchorEl,open:Boolean(r),onMenuItemClick:function(e,n){n(),i()},onClose:i,menuItems:w,anchorOrigin:{vertical:"bottom",horizontal:"right"}})})),O=o(51688),H=o(48974),W=(0,i.ZL)()({sortIndicator:{position:"relative",top:"0.2rem",fontSize:"1rem"}});function _(e){var n=e.model,o=e.columnNumber,t=W().classes,r=n.sortColumns.find((function(e){return e.columnNumber===o}));return r?r.descending?(0,j.jsx)(O.Z,{className:t.sortIndicator}):(0,j.jsx)(H.Z,{className:t.sortIndicator}):null}function V(e){return String.fromCharCode(e+65)}function G(e){if(e>=0){if(e<26)return V(e);if(e<702)return V(Math.floor(e/26-1))+V(e%26)}throw new RangeError("column number out of range")}var U=(0,i.ZL)()((function(e){return{columnHead:{fontWeight:"normal",background:"dark"===e.palette.mode?"#333":"#eee",position:"sticky",top:0,zIndex:2,whiteSpace:"nowrap"},columnButtonContainer:{display:"none",position:"absolute",right:0,top:0,background:e.palette.background.paper,height:"100%"},topLeftCorner:{background:"dark"===e.palette.mode?"#333":"#eee",zIndex:2,position:"sticky",top:0,minWidth:e.spacing(2),textAlign:"left"}}})),q=(0,s.observer)((function(e){var n=e.model,o=U().classes,l=n.columnDisplayOrder,i=n.columns,s=n.hasColumnNames,a=n.rowSet,c=(0,r.useState)(),d=(0,t.Z)(c,2),u=d[0],m=d[1],p=(0,r.useState)(),h=(0,t.Z)(p,2),f=h[0],g=h[1];return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{className:o.topLeftCorner,children:(0,j.jsx)(L.Z,{title:"Unselect all",placement:"right",children:(0,j.jsx)("span",{children:(0,j.jsx)(S.Z,{onClick:function(){return n.unselectAll()},disabled:!a.selectedCount,children:(0,j.jsx)(R.Z,{})})})})}),l.map((function(e){var t;return(0,j.jsxs)("th",{className:o.columnHead,onMouseOver:function(){return g(e)},onMouseOut:function(){return g(void 0)},children:[(0,j.jsx)(_,{model:n,columnNumber:e}),s&&(null===(t=i[e])||void 0===t?void 0:t.name)||G(e),(0,j.jsx)("div",{className:o.columnButtonContainer,style:{display:f===e||(null===u||void 0===u?void 0:u.colNumber)===e?"block":"none"},children:(0,j.jsx)(S.Z,{onClick:function(n){m({colNumber:e,anchorEl:n.currentTarget})},children:(0,j.jsx)(P.Z,{})})})]},e)}))]})}),(0,j.jsx)(D,{viewModel:(0,b.getParent)(n),spreadsheetModel:n,currentColumnMenu:u,setColumnMenu:m})]})})),J=(0,i.ZL)()((function(e){return{dataTable:{borderCollapse:"collapse","& td":{border:"1px solid ".concat(e.palette.action.disabledBackground),padding:"0.2rem",maxWidth:"50em",overflow:"hidden",textOverflow:"ellipsis"}},emptyMessage:{captionSide:"bottom"}}})),K=(0,s.observer)((function(e){var n=e.rows,o=e.spreadsheetModel,t=e.page,r=e.rowsPerPage;return(0,j.jsx)("tbody",{children:n.slice(r*t,r*(t+1)).map((function(e){return(0,j.jsx)(I,{rowNumber:e.id,spreadsheetModel:o,rowModel:e},e.id)}))})})),Q=(0,s.observer)((function(e){var n=e.model,o=e.page,t=e.rowsPerPage,r=n.rowSet,l=J().classes,i=r.sortedFilteredRows;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(M,{viewModel:(0,b.getParent)(n),spreadsheetModel:n}),(0,j.jsxs)("table",{className:l.dataTable,children:[(0,j.jsx)(q,{model:n}),(0,j.jsx)(K,{rows:i,spreadsheetModel:n,page:o,rowsPerPage:t}),i.length?null:(0,j.jsx)("caption",{className:l.emptyMessage,children:r.count?"no rows match criteria":"no rows present"})]})]})})),X=(0,i.ZL)()((function(e){return{root:{position:"relative",marginBottom:e.spacing(1),background:e.palette.background.paper,overflow:"auto"}}})),Y=(0,s.observer)((function(e){var n,o=e.model,t=e.height,r=e.page,l=e.rowsPerPage,i=X().classes;return(0,j.jsx)("div",{className:i.root,style:{height:t},children:null!==o&&void 0!==o&&null!==(n=o.rowSet)&&void 0!==n&&n.isLoaded&&o.initialized?(0,j.jsx)(Q,{model:o,page:r,rowsPerPage:l}):(0,j.jsx)(a.LoadingEllipses,{variant:"h6"})})})),$=o(5738),ee=o(30570),ne=(0,i.ZL)()({textFilterControlEndAdornment:{marginRight:"-18px"}}),oe=(0,s.observer)((function(e){var n=e.textFilter,o=ne().classes,l=(0,r.useState)(n.stringToFind),i=(0,t.Z)(l,2),s=i[0],a=i[1],c=(0,x.useDebounce)(s,500);return(0,r.useEffect)((function(){n.setString(c)}),[c,n]),(0,j.jsx)("div",{children:(0,j.jsx)(v.Z,{label:"text filter",value:s,onChange:function(e){return a(e.target.value)},variant:"outlined",InputProps:{startAdornment:(0,j.jsx)($.Z,{position:"start",children:(0,j.jsx)(z.Z,{})}),endAdornment:(0,j.jsx)($.Z,{className:o.textFilterControlEndAdornment,position:"end",children:(0,j.jsx)(S.Z,{"aria-label":"clear filter",onClick:function(){return a("")},children:(0,j.jsx)(ee.Z,{})})})}})})})),te=(0,s.observer)((function(e){var n=e.model.filterControls.rowFullText;return(0,j.jsx)(oe,{textFilter:n})})),re=o(35388),le=o(47057),ie=(0,i.ZL)()((function(e){return{columnName:{verticalAlign:"middle",paddingRight:"0.3em"},columnFilter:{overflow:"hidden",whiteSpace:"nowrap",boxSizing:"border-box",width:"100%",position:"relative"},filterIcon:{position:"relative",top:"12px"},filterIconBg:{background:e.palette.tertiary.main,color:"white",padding:e.spacing(1.5)}}}));function se(e){var n=e.filterModel;return n?(0,j.jsx)(n.ReactComponent,{filterModel:n}):null}var ae=(0,s.observer)((function(e){var n=e.viewModel,o=e.filterModel,t=e.columnNumber,r=e.height,i=ie().classes,s=n.spreadsheet.columns[t];if(!s)throw new Error("no column definition! filters are probably out of date");return(0,j.jsxs)(l.ZP,{container:!0,direction:"row",className:i.columnFilter,style:{height:r},children:[(0,j.jsx)(l.ZP,{item:!0,className:i.filterIconBg,children:(0,j.jsx)(z.Z,{className:i.filterIcon})}),(0,j.jsxs)(l.ZP,{item:!0,children:[(0,j.jsx)(S.Z,{onClick:function(){return(0,b.getParent)(o,2).removeColumnFilter(o)},title:"remove filter",children:(0,j.jsx)(le.Z,{})}),(0,j.jsx)(re.Z,{className:i.columnName,component:"span",children:s.name})," ",(0,j.jsx)(se,{filterModel:o})]})]})})),ce=o(30534),de=(0,s.observer)((function(e){var n=e.spreadsheet;if(n.rowSet.isLoaded){var o,t=n.rowSet,r=t.passingFiltersCount,l=t.count,i=t.selectedCount,s=t.selectedAndPassingFiltersCount;if(r!==l){if(o="".concat(n.rowSet.passingFiltersCount," rows of ").concat(n.rowSet.count," total"),i){o+=", ".concat(s," selected");var a=i-s;a&&(o+=" (".concat(a," selected rows do not pass filters)"))}}else o="".concat(n.rowSet.count," rows"),i&&(o+=", ".concat(i," selected"));return(0,j.jsx)(j.Fragment,{children:o})}return null})),ue=(0,i.ZL)()((function(e){return{statusBar:{height:40,boxSizing:"border-box",borderTop:"1px outset #b1b1b1",paddingLeft:e.spacing(1)},verticallyCenter:{display:"flex",justifyContent:"center",flexDirection:"column"},spacer:{flexGrow:1}}})),me=(0,s.observer)((function(e){var n=e.page,o=e.rowsPerPage,t=e.setPage,r=e.setRowsPerPage,l=e.spreadsheet,i=e.mode,s=ue().classes;return(0,j.jsx)("div",{className:s.statusBar,style:{display:"display"===i?void 0:"none"},children:l?(0,j.jsxs)(u.Z,{row:!0,children:[(0,j.jsx)("div",{className:s.verticallyCenter,children:(0,j.jsx)(de,{spreadsheet:l})}),(0,j.jsx)("div",{className:s.spacer}),(0,j.jsx)(ce.Z,{rowsPerPageOptions:[10,25,100,1e3],count:l.rowSet.count,component:"div",rowsPerPage:o,page:n,onPageChange:function(e,n){return t(n)},onRowsPerPageChange:function(e){r(+e.target.value),t(0)}}),(0,j.jsx)("div",{className:s.spacer})]}):null})})),pe=(0,i.ZL)()((function(e){return{header:{overflow:"hidden",whiteSpace:"nowrap",boxSizing:"border-box",height:52,paddingLeft:e.spacing(1)},contentArea:{overflow:"auto"},resizeHandle:{height:3,position:"absolute",bottom:0,left:0,background:e.palette.action.disabled,boxSizing:"border-box",borderTop:"1px solid #fafafa"}}})),he=(0,s.observer)((function(e){var n=e.model,o=pe().classes,i=n.spreadsheet,s=n.filterControls,c=n.hideFilterControls,d=n.hideVerticalResizeHandle,u=n.mode,m=n.height,p=(0,r.useState)(0),h=(0,t.Z)(p,2),f=h[0],g=h[1],b=(0,r.useState)(100),x=(0,t.Z)(b,2),v=x[0],w=x[1];return(0,j.jsxs)("div",{children:["display"!==u||c?null:(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(l.ZP,{container:!0,direction:"row",className:o.header,children:(0,j.jsx)(l.ZP,{item:!0,children:(0,j.jsx)(te,{model:n})})}),s.columnFilters.map((function(e,o){return(0,j.jsx)(ae,{viewModel:n,filterModel:e,columnNumber:e.columnNumber,height:46},"".concat(e.columnNumber,"-").concat(o))}))]}),"import"===u?(0,j.jsx)(Z,{model:n.importWizard}):(0,j.jsx)("div",{className:o.contentArea,children:(0,j.jsx)("div",{style:{position:"relative",display:"display"===u?void 0:"none"},children:i?(0,j.jsx)(Y,{page:f,rowsPerPage:v,model:i,height:m-52-46*s.columnFilters.length-40}):null})}),i?(0,j.jsx)(me,{page:f,setPage:g,rowsPerPage:v,setRowsPerPage:w,mode:u,spreadsheet:i}):null,d?null:(0,j.jsx)(a.ResizeHandle,{onDrag:n.resizeHeight,className:o.resizeHandle})]})}))}}]);
//# sourceMappingURL=3135.19c9fc64.chunk.js.map