{"version":3,"file":"static/js/2152.be84c58a.chunk.js","mappings":"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","sources":["../../../plugins/linear-comparative-view/src/LinearComparativeView/components/VerticalGuide.tsx","../../../plugins/linear-comparative-view/src/LinearComparativeView/components/Rubberband.tsx","../../../plugins/linear-comparative-view/src/LinearComparativeView/components/Header.tsx","../../../plugins/linear-comparative-view/src/LinearComparativeView/components/LinearComparativeView.tsx"],"sourcesContent":["import React from 'react'\nimport { Tooltip, Typography } from '@mui/material'\nimport { observer } from 'mobx-react'\nimport { stringify } from '@jbrowse/core/util'\nimport { makeStyles } from 'tss-react/mui'\nimport { LinearComparativeViewModel } from '../model'\n\ntype LCV = LinearComparativeViewModel\n\nconst useStyles = makeStyles()({\n  guide: {\n    pointerEvents: 'none',\n    height: '100%',\n    width: 1,\n    position: 'absolute',\n    zIndex: 10,\n  },\n  sm: {\n    fontSize: 10,\n  },\n})\n\nconst VerticalGuide = observer(function ({\n  model,\n  coordX,\n}: {\n  model: LCV\n  coordX: number\n}) {\n  const { classes } = useStyles()\n  return (\n    <Tooltip\n      open\n      placement=\"top\"\n      title={model.views\n        .map(view => view.pxToBp(coordX))\n        .map((elt, idx) => (\n          <Typography\n            className={classes.sm}\n            key={[JSON.stringify(elt), idx].join('-')}\n          >\n            {stringify(elt, true)}\n          </Typography>\n        ))}\n      arrow\n    >\n      <div\n        className={classes.guide}\n        style={{\n          left: coordX,\n          background: 'red',\n        }}\n      />\n    </Tooltip>\n  )\n})\n\nexport default VerticalGuide\n","import React, { useRef, useEffect, useState } from 'react'\nimport { observer } from 'mobx-react'\nimport { Popover, Typography, alpha } from '@mui/material'\nimport { makeStyles } from 'tss-react/mui'\nimport { stringify } from '@jbrowse/core/util'\nimport { Menu } from '@jbrowse/core/ui'\nimport { LinearGenomeViewModel } from '@jbrowse/plugin-linear-genome-view'\n\n// locals\nimport { LinearComparativeViewModel } from '../model'\nimport VerticalGuide from './VerticalGuide'\n\ntype LCV = LinearComparativeViewModel\ntype LGV = LinearGenomeViewModel\n\nconst useStyles = makeStyles()(theme => {\n  const { tertiary, primary } = theme.palette\n  const background = tertiary\n    ? alpha(tertiary.main, 0.7)\n    : alpha(primary.main, 0.7)\n  return {\n    rubberband: {\n      height: '100%',\n      background,\n      position: 'absolute',\n      zIndex: 10,\n      textAlign: 'center',\n      overflow: 'hidden',\n    },\n    rubberbandControl: {\n      cursor: 'crosshair',\n      width: '100%',\n      minHeight: 8,\n    },\n    rubberbandText: {\n      color: tertiary ? tertiary.contrastText : primary.contrastText,\n    },\n    popover: {\n      mouseEvents: 'none',\n      cursor: 'crosshair',\n    },\n    paper: {\n      paddingLeft: theme.spacing(1),\n      paddingRight: theme.spacing(1),\n    },\n  }\n})\n\nfunction Rubberband({\n  model,\n  ControlComponent = <div />,\n}: {\n  model: LCV\n  ControlComponent?: React.ReactElement\n}) {\n  const [startX, setStartX] = useState<number>()\n  const [currentX, setCurrentX] = useState<number>()\n\n  // clientX and clientY used for anchorPosition for menu\n  // offsetX used for calculations about width of selection\n  const [anchorPosition, setAnchorPosition] = useState<{\n    offsetX: number\n    clientX: number\n    clientY: number\n  }>()\n  const [guideX, setGuideX] = useState<number>()\n  const controlsRef = useRef<HTMLDivElement>(null)\n  const rubberbandRef = useRef(null)\n  const { classes } = useStyles()\n  const mouseDragging = startX !== undefined && anchorPosition === undefined\n\n  useEffect(() => {\n    function computeOffsets(offsetX: number, view: LGV) {\n      if (startX === undefined) {\n        return\n      }\n      let leftPx = startX\n      let rightPx = offsetX\n      // handles clicking and dragging to the left\n      if (rightPx < leftPx) {\n        ;[leftPx, rightPx] = [rightPx, leftPx]\n      }\n      const leftOffset = view.pxToBp(leftPx)\n      const rightOffset = view.pxToBp(rightPx)\n\n      return { leftOffset, rightOffset }\n    }\n\n    function globalMouseMove(event: MouseEvent) {\n      if (controlsRef.current && mouseDragging) {\n        const relativeX =\n          event.clientX - controlsRef.current.getBoundingClientRect().left\n        setCurrentX(relativeX)\n      }\n    }\n\n    function globalMouseUp(event: MouseEvent) {\n      if (startX !== undefined && controlsRef.current) {\n        const { clientX, clientY } = event\n        const ref = controlsRef.current\n        const offsetX = clientX - ref.getBoundingClientRect().left\n        // as stated above, store both clientX/Y and offsetX for different\n        // purposes\n        setAnchorPosition({\n          offsetX,\n          clientX,\n          clientY,\n        })\n        model.views.forEach(view => {\n          const args = computeOffsets(offsetX, view)\n          if (args) {\n            const { leftOffset, rightOffset } = args\n            view.setOffsets(leftOffset, rightOffset)\n          }\n        })\n        setGuideX(undefined)\n      }\n    }\n    if (mouseDragging) {\n      window.addEventListener('mousemove', globalMouseMove)\n      window.addEventListener('mouseup', globalMouseUp)\n      return () => {\n        window.removeEventListener('mousemove', globalMouseMove)\n        window.removeEventListener('mouseup', globalMouseUp)\n      }\n    }\n    return () => {}\n  }, [startX, mouseDragging, anchorPosition, model])\n\n  useEffect(() => {\n    if (\n      !mouseDragging &&\n      currentX !== undefined &&\n      startX !== undefined &&\n      Math.abs(currentX - startX) <= 3\n    ) {\n      handleClose()\n    }\n  }, [mouseDragging, currentX, startX])\n\n  function mouseDown(event: React.MouseEvent<HTMLDivElement>) {\n    event.preventDefault()\n    event.stopPropagation()\n    const relativeX =\n      event.clientX -\n      (event.target as HTMLDivElement).getBoundingClientRect().left\n    setStartX(relativeX)\n    setCurrentX(relativeX)\n  }\n\n  function mouseMove(event: React.MouseEvent<HTMLDivElement>) {\n    const target = event.target as HTMLDivElement\n    setGuideX(event.clientX - target.getBoundingClientRect().left)\n  }\n\n  function mouseOut() {\n    setGuideX(undefined)\n    model.views.forEach(view => view.setOffsets(undefined, undefined))\n  }\n\n  function handleClose() {\n    setAnchorPosition(undefined)\n    setStartX(undefined)\n    setCurrentX(undefined)\n  }\n\n  const open = Boolean(anchorPosition)\n\n  function handleMenuItemClick(_: unknown, callback: Function) {\n    callback()\n    handleClose()\n  }\n\n  if (startX === undefined) {\n    return (\n      <>\n        {guideX !== undefined ? (\n          <VerticalGuide model={model} coordX={guideX} />\n        ) : null}\n        <div\n          ref={controlsRef}\n          className={classes.rubberbandControl}\n          onMouseDown={mouseDown}\n          onMouseOut={mouseOut}\n          onMouseMove={mouseMove}\n        >\n          {ControlComponent}\n        </div>\n      </>\n    )\n  }\n\n  const right = anchorPosition ? anchorPosition.offsetX : currentX || 0\n  const left = right < startX ? right : startX\n  const width = Math.abs(right - startX)\n  const { views } = model\n  const leftBpOffset = views.map(view => view.pxToBp(left))\n  const rightBpOffset = views.map(view => view.pxToBp(left + width))\n  const numOfBpSelected = views.map(view => Math.ceil(width * view.bpPerPx))\n  return (\n    <>\n      {rubberbandRef.current ? (\n        <>\n          <Popover\n            className={classes.popover}\n            classes={{ paper: classes.paper }}\n            open\n            anchorEl={rubberbandRef.current}\n            anchorOrigin={{\n              vertical: 'top',\n              horizontal: 'left',\n            }}\n            transformOrigin={{\n              vertical: 'bottom',\n              horizontal: 'right',\n            }}\n            keepMounted\n            disableRestoreFocus\n          >\n            {leftBpOffset.map((l, idx) => (\n              <Typography key={[JSON.stringify(l), idx, 'left'].join('-')}>\n                {stringify(l, true)}\n              </Typography>\n            ))}\n          </Popover>\n          <Popover\n            className={classes.popover}\n            classes={{ paper: classes.paper }}\n            open\n            anchorEl={rubberbandRef.current}\n            anchorOrigin={{\n              vertical: 'top',\n              horizontal: 'right',\n            }}\n            transformOrigin={{\n              vertical: 'bottom',\n              horizontal: 'left',\n            }}\n            keepMounted\n            disableRestoreFocus\n          >\n            {rightBpOffset.map((l, idx) => (\n              <Typography key={[JSON.stringify(l), idx, 'right'].join('-')}>\n                {stringify(l, true)}\n              </Typography>\n            ))}\n          </Popover>\n        </>\n      ) : null}\n      <div\n        ref={rubberbandRef}\n        className={classes.rubberband}\n        style={{ left, width }}\n      >\n        <Typography variant=\"h6\" className={classes.rubberbandText}>\n          {numOfBpSelected.map((n, i) => (\n            <Typography key={`${n}_${i}`}>\n              {`${n.toLocaleString('en-US')}bp`}\n            </Typography>\n          ))}\n        </Typography>\n      </div>\n      <div\n        className={classes.rubberbandControl}\n        ref={controlsRef}\n        onMouseDown={mouseDown}\n        onMouseOut={mouseOut}\n        onMouseMove={mouseMove}\n      >\n        {ControlComponent}\n      </div>\n      {anchorPosition ? (\n        <Menu\n          anchorReference=\"anchorPosition\"\n          anchorPosition={{\n            left: anchorPosition.clientX,\n            top: anchorPosition.clientY,\n          }}\n          onMenuItemClick={handleMenuItemClick}\n          open={open}\n          onClose={handleClose}\n          menuItems={model.rubberBandMenuItems()}\n        />\n      ) : null}\n    </>\n  )\n}\n\nexport default observer(Rubberband)\n","import React, { useState } from 'react'\nimport { IconButton, Typography } from '@mui/material'\nimport { makeStyles } from 'tss-react/mui'\nimport { SearchBox } from '@jbrowse/plugin-linear-genome-view'\nimport { observer } from 'mobx-react'\nimport { Menu } from '@jbrowse/core/ui'\n\n// icons\nimport MoreVertIcon from '@mui/icons-material/MoreVert'\n\n// locals\nimport { LinearComparativeViewModel } from '../model'\nimport { TrackSelector as TrackSelectorIcon } from '@jbrowse/core/ui/Icons'\nimport CascadingMenuButton from '@jbrowse/core/ui/CascadingMenuButton'\n\ntype LCV = LinearComparativeViewModel\n\nconst useStyles = makeStyles()(() => ({\n  headerBar: {\n    gridArea: '1/1/auto/span 2',\n    display: 'flex',\n  },\n  spacer: {\n    flexGrow: 1,\n  },\n  iconButton: {\n    margin: 5,\n  },\n  bp: {\n    display: 'flex',\n    alignItems: 'center',\n    marginLeft: 10,\n  },\n  searchContainer: {\n    marginLeft: 5,\n  },\n  searchBox: {\n    display: 'flex',\n  },\n}))\n\nconst TrackSelector = observer(({ model }: { model: LCV }) => {\n  return (\n    <CascadingMenuButton\n      menuItems={[\n        {\n          label: 'Synteny track selector',\n          onClick: () => model.activateTrackSelector(),\n        },\n        ...model.views.map((view, idx) => ({\n          label: `View ${idx + 1} track selector`,\n          onClick: () => view.activateTrackSelector(),\n        })),\n      ]}\n    >\n      <TrackSelectorIcon />\n    </CascadingMenuButton>\n  )\n})\n\nconst Header = observer(function ({ model }: { model: LCV }) {\n  const { classes } = useStyles()\n  const [menuAnchorEl, setMenuAnchorEl] = useState<HTMLElement>()\n  const anyShowHeaders = model.views.some(view => !view.hideHeader)\n  return (\n    <div className={classes.headerBar}>\n      <TrackSelector model={model} />\n\n      <IconButton\n        onClick={event => setMenuAnchorEl(event.currentTarget)}\n        className={classes.iconButton}\n      >\n        <MoreVertIcon />\n      </IconButton>\n      {!anyShowHeaders\n        ? model.views.map(view => (\n            <div key={view.id} className={classes.searchBox}>\n              <div className={classes.searchContainer}>\n                <SearchBox model={view} showHelp={false} />\n              </div>\n              <div className={classes.bp}>\n                <Typography\n                  variant=\"body2\"\n                  color=\"textSecondary\"\n                  className={classes.bp}\n                >\n                  {Math.round(view.coarseTotalBp).toLocaleString('en-US')} bp\n                </Typography>\n              </div>\n            </div>\n          ))\n        : null}\n\n      <div className={classes.spacer} />\n\n      {menuAnchorEl ? (\n        <Menu\n          anchorEl={menuAnchorEl}\n          open\n          onMenuItemClick={(_event, callback) => {\n            callback()\n            setMenuAnchorEl(undefined)\n          }}\n          menuItems={model.headerMenuItems()}\n          onClose={() => setMenuAnchorEl(undefined)}\n        />\n      ) : null}\n    </div>\n  )\n})\n\nexport default Header\n","import React from 'react'\nimport { makeStyles } from 'tss-react/mui'\nimport { observer } from 'mobx-react'\nimport { getConf, AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport { getEnv } from '@jbrowse/core/util'\nimport { ResizeHandle } from '@jbrowse/core/ui'\n\n// locals\nimport { LinearComparativeViewModel } from '../model'\nimport Rubberband from './Rubberband'\nimport Header from './Header'\n\nconst useStyles = makeStyles()(theme => ({\n  container: {\n    display: 'grid',\n  },\n  overlay: {\n    zIndex: 100,\n    gridArea: '1/1',\n  },\n  content: {\n    gridArea: '1/1',\n    position: 'relative',\n  },\n  grid: {\n    display: 'grid',\n  },\n  relative: {\n    position: 'relative',\n  },\n\n  // this helps keep the vertical guide inside the parent view container,\n  // similar style exists in the single LGV's trackscontainer\n  rubberbandContainer: {\n    position: 'relative',\n    overflow: 'hidden',\n  },\n\n  rubberbandDiv: {\n    width: '100%',\n    background: theme.palette.action.disabledBackground,\n    height: 15,\n    '&:hover': {\n      background: theme.palette.action.selected,\n    },\n  },\n}))\n\ntype LCV = LinearComparativeViewModel\n\nconst Overlays = observer(({ model }: { model: LCV }) => {\n  const { classes } = useStyles()\n  return (\n    <>\n      {model.tracks.map(track => {\n        const [display] = track.displays\n        const { RenderingComponent } = display\n        const trackId = getConf(track, 'trackId')\n        return RenderingComponent ? (\n          <div\n            className={classes.overlay}\n            key={trackId}\n            style={{\n              height: model.middleComparativeHeight,\n              overflow: 'hidden',\n            }}\n          >\n            <RenderingComponent model={display} />\n          </div>\n        ) : null\n      })}\n    </>\n  )\n})\n\n// The comparative is in the middle of the views\nconst MiddleComparativeView = observer(({ model }: { model: LCV }) => {\n  const { classes } = useStyles()\n  const { views } = model\n  const { pluginManager } = getEnv(model)\n  const { ReactComponent } = pluginManager.getViewType(views[0].type)\n\n  return (\n    <div className={classes.rubberbandContainer}>\n      <Header model={model} />\n      <Rubberband\n        model={model}\n        ControlComponent={<div className={classes.rubberbandDiv} />}\n      />\n      <div className={classes.container}>\n        <ReactComponent model={views[0]} />\n        <div className={classes.grid}>\n          <Overlays model={model} />\n        </div>\n        <ResizeHandle\n          onDrag={n =>\n            model.setMiddleComparativeHeight(model.middleComparativeHeight + n)\n          }\n          style={{\n            height: 4,\n            background: '#ccc',\n          }}\n        />\n        <ReactComponent model={views[1]} />\n      </div>\n    </div>\n  )\n})\nconst OverlayComparativeView = observer(({ model }: { model: LCV }) => {\n  const { classes } = useStyles()\n  const { views } = model\n  const { pluginManager } = getEnv(model)\n  return (\n    <div className={classes.rubberbandContainer}>\n      <Header model={model} />\n      <Rubberband\n        model={model}\n        ControlComponent={<div className={classes.rubberbandDiv} />}\n      />\n\n      <div className={classes.container}>\n        <div className={classes.content}>\n          <div className={classes.relative}>\n            {views.map(view => {\n              const { ReactComponent } = pluginManager.getViewType(view.type)\n              return <ReactComponent key={view.id} model={view} />\n            })}\n          </div>\n          <Overlays model={model} />\n        </div>\n      </div>\n    </div>\n  )\n})\n\nexport default observer(function (props: {\n  ExtraButtons?: React.ReactNode\n  model: LCV\n}) {\n  const { model } = props\n\n  const middle = model.tracks.some(({ displays }) =>\n    displays.some((d: { configuration: AnyConfigurationModel }) =>\n      getConf(d, 'middle'),\n    ),\n  )\n  return middle ? (\n    <MiddleComparativeView {...props} />\n  ) : (\n    <OverlayComparativeView {...props} />\n  )\n})\n"],"names":["useStyles","makeStyles","guide","pointerEvents","height","width","position","zIndex","sm","fontSize","observer","_ref","model","coordX","classes","_jsx","Tooltip","open","placement","title","views","map","view","pxToBp","elt","idx","Typography","className","children","stringify","JSON","join","arrow","style","left","background","theme","_theme$palette","palette","tertiary","primary","rubberband","alpha","main","textAlign","overflow","rubberbandControl","cursor","minHeight","rubberbandText","color","contrastText","popover","mouseEvents","paper","paddingLeft","spacing","paddingRight","_ref$ControlComponent","ControlComponent","_useState","useState","_useState2","_slicedToArray","startX","setStartX","_useState3","_useState4","currentX","setCurrentX","_useState5","_useState6","anchorPosition","setAnchorPosition","_useState7","_useState8","guideX","setGuideX","controlsRef","useRef","rubberbandRef","mouseDragging","undefined","mouseDown","event","preventDefault","stopPropagation","relativeX","clientX","target","getBoundingClientRect","mouseMove","mouseOut","forEach","setOffsets","handleClose","useEffect","globalMouseMove","current","globalMouseUp","clientY","offsetX","args","leftPx","rightPx","_ref2","leftOffset","rightOffset","computeOffsets","window","addEventListener","removeEventListener","Math","abs","Boolean","_jsxs","_Fragment","VerticalGuide","ref","onMouseDown","onMouseOut","onMouseMove","right","leftBpOffset","rightBpOffset","numOfBpSelected","ceil","bpPerPx","Popover","anchorEl","anchorOrigin","vertical","horizontal","transformOrigin","keepMounted","disableRestoreFocus","l","variant","n","i","concat","toLocaleString","Menu","anchorReference","top","onMenuItemClick","_","callback","onClose","menuItems","rubberBandMenuItems","headerBar","gridArea","display","spacer","flexGrow","iconButton","margin","bp","alignItems","marginLeft","searchContainer","searchBox","TrackSelector","CascadingMenuButton","label","onClick","activateTrackSelector","_toConsumableArray","TrackSelectorIcon","menuAnchorEl","setMenuAnchorEl","anyShowHeaders","some","hideHeader","IconButton","currentTarget","MoreVertIcon","SearchBox","showHelp","round","coarseTotalBp","id","_event","headerMenuItems","container","overlay","content","grid","relative","rubberbandContainer","rubberbandDiv","action","disabledBackground","selected","Overlays","tracks","track","displays","RenderingComponent","trackId","getConf","middleComparativeHeight","MiddleComparativeView","ReactComponent","getEnv","pluginManager","getViewType","type","Header","Rubberband","ResizeHandle","onDrag","setMiddleComparativeHeight","OverlayComparativeView","_ref3","props","_ref4","d","_objectSpread"],"sourceRoot":""}