"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[6177],{36177:function(e,t,i){i.r(t),i.d(t,{doAfterAttach:function(){return d}});var a=i(33028),n=i(63680),o=i(27664),r=i(98103),f=i(55871),s=i(75717),l=i(70833);function d(e){(0,n.addDisposer)(e,(0,s.autorun)((function(){var t,i,a=(0,o.getContainingView)(e);if(a.initialized){var n=null===(t=e.mainCanvas)||void 0===t?void 0:t.getContext("2d"),r=null===(i=e.cigarClickMapCanvas)||void 0===i?void 0:i.getContext("2d");if(n&&r){var f=a.middleComparativeHeight,s=a.width;n.clearRect(0,0,s,f),r.clearRect(0,0,s,f),(0,l.Bf)(e,n,r)}}}))),(0,n.addDisposer)(e,(0,s.autorun)((function(){(0,o.getContainingView)(e).initialized&&(0,l.z8)(e)}))),(0,n.addDisposer)(e,(0,s.reaction)((function(){var t=(0,o.getContainingView)(e);return{bpPerPx:t.views.map((function(e){return e.bpPerPx})),displayedRegions:JSON.stringify(t.views.map((function(e){return e.displayedRegions}))),features:e.features,initialized:t.initialized}}),(function(t){if(t.initialized){for(var i=(0,o.getSession)(e).assemblyManager,s=(0,o.getContainingView)(e).views.map((function(e){return(0,a.Z)((0,a.Z)({},(0,n.getSnapshot)(e)),{},{width:e.width,staticBlocks:e.staticBlocks,interRegionPaddingWidth:e.interRegionPaddingWidth,minimumBlockWidth:e.minimumBlockWidth})})),l=[],d=e.features||[],v=0;v<d.length;v++){var u=d[v],c=u.get("mate"),h=u.get("start"),g=u.get("end"),m=c.start,b=c.end;if(-1===u.get("strand")){var p=[h,g];g=p[0],h=p[1]}var w=null===i||void 0===i?void 0:i.get(u.get("assemblyName")),C=null===i||void 0===i?void 0:i.get(c.assemblyName),M=u.get("refName"),P=c.refName,x=(null===w||void 0===w?void 0:w.getCanonicalRefName(M))||M,y=(null===C||void 0===C?void 0:C.getCanonicalRefName(P))||P,T=s[0],k=s[1],R=(0,r.R)({self:T,refName:x,coord:h}),S=(0,r.R)({self:T,refName:x,coord:g}),N=(0,r.R)({self:k,refName:y,coord:m}),z=(0,r.R)({self:k,refName:y,coord:b});if(void 0!==R&&void 0!==S&&void 0!==N&&void 0!==z){var I=u.get("CIGAR");l.push({p11:R,p12:S,p21:N,p22:z,f:u,cigar:f.tr.parseCigar(I)})}}e.setFeatPositions(l)}}),{fireImmediately:!0}))}},70833:function(e,t,i){i.d(t,{EU:function(){return r},z8:function(){return c},Bf:function(){return u},zv:function(){return v}});var a=i(27664);function n(e){var t=e.feature,i=e.ctx,n=e.offsets,r=e.cb,f=e.height,s=e.drawCurves,l=e.oobLimit,d=e.viewWidth,v=e.hideTiny,u=t.p11,c=t.p12,h=t.p21,g=t.p22,m=u.offsetPx-n[0],b=c.offsetPx-n[0],p=h.offsetPx-n[1],w=g.offsetPx-n[1],C=Math.abs(b-m),M=Math.abs(w-p),P=f,x=(P-0)/2,y=Math.min(p,w),T=Math.max(p,w);(0,a.doesIntersect2)(y,T,-l,d+l)&&(C<=1&&M<=1?v||(i.beginPath(),i.moveTo(m,0),s?i.bezierCurveTo(m,x,p,x,p,P):i.lineTo(p,P),i.stroke()):(o(i,m,b,0,w,p,P,x,s),r(i)))}function o(e,t,i,a,n,o,r,f,s){s?function(e,t,i,a,n,o,r,f){var s=Math.abs(t-i),l=Math.abs(t-i);if(s<5&&l<5&&i<t&&Math.abs(t-n)>100){var d=t;t=i,i=d}e.beginPath(),e.moveTo(t,a),e.lineTo(i,a),e.bezierCurveTo(i,f,n,f,n,r),e.lineTo(o,r),e.bezierCurveTo(o,f,t,f,t,a),e.closePath(),e.fill()}(e,t,i,a,n,o,r,f):function(e,t,i,a,n,o,r){e.beginPath(),e.moveTo(t,a),e.lineTo(i,a),e.lineTo(n,r),e.lineTo(o,r),e.closePath(),e.fill()}(e,t,i,a,n,o,r)}var r=16581375;function f(e){var t=Math.floor(e/65025)%255,i=Math.floor(e/255)%255,a=e%255;return"rgb(".concat(t,",").concat(i,",").concat(a,")")}var s={I:"#ff03",N:"#0a03",D:"#00f3",X:"brown",M:"#f003","=":"#f003"},l=3,d=1600;function v(e,t,i,a){return Math.floor((255*e*255+255*t+i-1)/a)}function u(e,t,i){var v,u=(0,a.getContainingView)(e),c=u.drawCurves,h=u.drawCIGAR,g=u.middleComparativeHeight,m=u.width,b=u.views.map((function(e){return e.bpPerPx}));i&&(i.imageSmoothingEnabled=!1),t.beginPath();var p=e.featPositions,w=u.views.map((function(e){return e.offsetPx})),C=Math.floor(r/p.length);t.fillStyle=s.M,t.strokeStyle=s.M;for(var M=0;M<p.length;M++){var P=p[M],x=P.p11,y=P.p12,T=P.p21,k=P.p22,R=x.offsetPx-w[0],S=y.offsetPx-w[0],N=T.offsetPx-w[1],z=k.offsetPx-w[1],I=Math.abs(S-R),W=Math.abs(z-N),B=g,V=(B-0)/2;I<=l&&W<=l&&N<m+d&&N>-d&&(t.moveTo(R,0),c?t.bezierCurveTo(R,V,N,V,N,B):t.lineTo(N,B))}t.stroke(),t.fillStyle=s.M,t.strokeStyle=s.M;for(var D=0;D<p.length;D++){var A=p[D],L=A.p11,_=A.p12,E=A.p21,H=A.p22,j=A.f,G=A.cigar,X=L.offsetPx-w[0],Z=_.offsetPx-w[0],F=E.offsetPx-w[1],J=H.offsetPx-w[1],O=Math.abs(Z-X),U=Math.abs(J-F),q=Math.min(F,J),K=Math.max(F,J),Q=g,Y=(Q-0)/2;if(!(O<=l&&U<=l)&&(0,a.doesIntersect2)(q,K,-d,u.width+d)){var $=j.get("strand"),ee=-1===$?Z:X,te=ee<(-1===$?X:Z)?1:-1,ie=(F<J?1:-1)*$,ae=ee,ne=-1===$?J:F;if(null!==G&&void 0!==G&&G.length&&h)for(var oe=!1,re=0,fe=0,se=Math.floor(r/G.length),le=0;le<G.length;le+=2){var de=le*se+1,ve=+G[le],ue=G[le+1];oe||(re=ae,fe=ne);var ce=ve/b[0],he=ve/b[1];if("M"===ue||"="===ue||"X"===ue?(ae+=ce*te,ne+=he*ie):"D"===ue||"N"===ue?ae+=ce*te:"I"===ue&&(ne+=he*ie),!(Math.max(re,fe,ae,ne)<0||Math.min(re,fe,ae,ne)>m)){var ge=le<G.length-2;Math.abs(ae-re)<=1&&Math.abs(ne-fe)<=1&&ge?oe=!0:(oe=!1,t.fillStyle=s[oe&&ce>1||he>1?ue:"M"],o(t,re,ae,0,ne,fe,Q,Y,c),i&&(i.fillStyle=f(de),o(i,re,ae,0,ne,fe,Q,Y,c)))}}else o(t,X,Z,0,J,F,Q,Y,c)}}var me=null===(v=e.clickMapCanvas)||void 0===v?void 0:v.getContext("2d");if(me){me.imageSmoothingEnabled=!1,me.clearRect(0,0,m,g);for(var be=0;be<p.length;be++){var pe=p[be],we=be*C+1;me.fillStyle=f(we),n({cb:function(e){return e.fill()},feature:pe,ctx:me,drawCurves:c,offsets:w,oobLimit:d,viewWidth:u.width,hideTiny:!0,height:g})}}}function c(e){var t,i=e.clickId,o=e.mouseoverId,r=(0,a.getContainingView)(e),f=r.drawCurves,s=r.middleComparativeHeight,l=r.width,v=null===(t=e.mouseoverCanvas)||void 0===t?void 0:t.getContext("2d"),u=r.views.map((function(e){return e.offsetPx}));if(v){v.resetTransform(),v.scale(1,1),v.clearRect(0,0,l,s);var c=e.featMap[o||""];c&&(v.fillStyle="rgb(0,0,0,0.1)",n({cb:function(e){return e.fill()},feature:c,ctx:v,oobLimit:d,viewWidth:r.width,drawCurves:f,offsets:u,height:s}));var h=e.featMap[i||""];h&&(v.strokeStyle="rgb(0, 0, 0, 0.9)",n({cb:function(e){return e.stroke()},feature:h,ctx:v,oobLimit:d,viewWidth:r.width,drawCurves:f,offsets:u,height:s}))}}}}]);
//# sourceMappingURL=6177.7d094f66.chunk.js.map