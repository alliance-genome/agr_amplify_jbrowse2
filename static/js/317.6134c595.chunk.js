"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[317,2836],{35352:function(e,t,n){n.d(t,{Z:function(){return f},x:function(){return l}});var r=n(68079),i=n(96234),o=n(96902),a=n(91188),u=n(54896),c=n(29938),s=(0,a.ZL)()((function(e){return{resizeBar:{background:e.palette.action.disabledBackground,height:12,position:"relative",overflow:"hidden"},tick:{position:"absolute",height:"100%",pointerEvents:"none",background:e.palette.action.disabled,width:1},hiddenTick:{position:"absolute",height:"100%",width:5}}}));function l(){var e=(0,o.useRef)(null),t=(0,o.useState)(0),n=(0,i.Z)(t,2),r=n[0],a=n[1];return(0,o.useEffect)((function(){var t=setInterval((function(){var t,n=null===(t=e.current)||void 0===t?void 0:t.querySelector(".MuiDataGrid-virtualScroller");n&&a(n.scrollLeft)}),100);return function(){clearInterval(t)}}),[]),{ref:e,scrollLeft:r}}function d(e){var t=e.left,n=e.scrollLeft,r=e.idx,i=e.onDrag,a=s().classes,l=(0,o.useCallback)((function(e){i(e,r)}),[r,i]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(u.Z,{onDrag:l,vertical:!0,className:a.hiddenTick,style:{left:t-n-2.5}}),(0,c.jsx)("div",{style:{left:t-n},className:a.tick})]})}function f(e){for(var t=e.widths,n=e.setWidths,i=e.checkbox,a=e.scrollLeft,u=void 0===a?0:a,l=s().classes,f=[],h=i?52:0,m=0;m<t.length;m++){var v=t[m];f[m]=v+h,h+=v}var p=(0,o.useCallback)((function(e,i){var o=(0,r.Z)(t);o[i]=Math.max(o[i]+e,50),n(o)}),[t,n]);return(0,c.jsx)("div",{className:l.resizeBar,children:f.map((function(e,t){return(0,c.jsx)(d,{left:t===f.length-1?e-3:e,onDrag:p,idx:t,scrollLeft:u},t)}))})}},71960:function(e,t,n){n.r(t),n.d(t,{default:function(){return U}});var r=n(33028),i=n(96902),o=n(52809),a=n(17867),u=n(4782),c=n(68079),s=n(56666),l=n(96234),d=n(25322),f=n(75717),h=n(63680),m=n(34721),v=n(41637),p=n(16151),g=n(82769),Z=n(41590),x=n(35352),j=n(27664),b=n(99836),w=n(90386),k=n(51932),C=n(54417),S=n(66519),y=n(5738),E=n(30570),M=n(38238),T=n(35920),L=n(29938);function O(e){var t=e.setFilterText,n=e.setUseShoppingCart,r=e.setHideSparse,o=e.setShowOptions,u=e.showOptions,c=e.hideSparse,s=e.useShoppingCart,f=e.filterText,h=e.model,m=(0,i.useState)(null),v=(0,l.Z)(m,2),p=v[0],g=v[1];return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(C.ZP,{container:!0,spacing:4,alignItems:"center",children:[(0,L.jsx)(C.ZP,{item:!0,children:(0,L.jsx)(S.Z,{label:"Search...",value:f,onChange:function(e){return t(e.target.value)},InputProps:{endAdornment:(0,L.jsx)(y.Z,{position:"end",children:(0,L.jsx)(d.Z,{onClick:function(){return t("")},children:(0,L.jsx)(E.Z,{})})})}})}),(0,L.jsx)(C.ZP,{item:!0,children:(0,L.jsx)(d.Z,{onClick:function(e){return g(e.currentTarget)},children:(0,L.jsx)(M.Z,{})})}),(0,L.jsx)(C.ZP,{item:!0,children:(0,L.jsx)(T.Z,{model:h})})]}),(0,L.jsx)(a.Menu,{anchorEl:p,open:!!p,onClose:function(){return g(null)},onMenuItemClick:function(e,t){t(),g(null)},menuItems:[{label:"Add tracks to selection instead of turning them on/off",onClick:function(){return n(!s)},type:"checkbox",checked:s},{label:"Hide sparse metadata columns",onClick:function(){return r(!c)},checked:c,type:"checkbox"},{label:"Show extra table options",onClick:function(){return o(!u)},checked:u,type:"checkbox"}]})]})}var R=n(41361),H=n(13655),W=n(35388),I=n(50543),G=n(33266),N=n(91188),P=n(21630),D=n(51467),F=(0,N.ZL)()((function(e){return{facet:{margin:0,marginLeft:e.spacing(2)},select:{marginBottom:e.spacing(2)}}}));function z(e){var t=e.column,n=e.vals,r=e.width,o=e.dispatch,a=e.filters,u=F().classes,c=(0,i.useState)(!0),s=(0,l.Z)(c,2),f=s[0],h=s[1];return(0,L.jsxs)(H.Z,{className:u.facet,style:{width:r},children:[(0,L.jsxs)("div",{style:{display:"flex"},children:[(0,L.jsx)(W.Z,{children:t.field}),(0,L.jsx)(I.Z,{title:"Clear selection on this facet filter",children:(0,L.jsx)(d.Z,{onClick:function(){o({key:t.field,val:[]})},size:"small",children:(0,L.jsx)(E.Z,{})})}),(0,L.jsx)(I.Z,{title:"Minimize/expand this facet filter",children:(0,L.jsx)(d.Z,{onClick:function(){return h(!f)},size:"small",children:f?(0,L.jsx)(P.Z,{}):(0,L.jsx)(D.Z,{})})})]}),f?(0,L.jsx)(G.Z,{multiple:!0,native:!0,className:u.select,value:a[t.field],onChange:function(e){for(var n=e.target.options,r=[],i=n.length,a=0;a<i;a++)n[a].selected&&r.push(n[a].value);o({key:t.field,val:r})},children:n.sort((function(e,t){return e[0].localeCompare(t[0])})).map((function(e){var t=(0,l.Z)(e,2),n=t[0],r=t[1];return(0,L.jsxs)("option",{value:n,children:[n," (",r,")"]},n)}))}):null]},t.field)}function B(e){var t,n=e.rows,r=e.columns,i=e.dispatch,o=e.filters,a=e.width,u=r.slice(1),s=u.map((function(){return new Map})),d=(0,R.Z)(n);try{for(d.s();!(t=d.n()).done;){var f,h=t.value,m=(0,R.Z)(u.entries());try{for(m.s();!(f=m.n()).done;){var v=(0,l.Z)(f.value,2),p=v[0],g=v[1],Z=s[p],x="".concat(h[g.field]||""),j=Z.get(x);x&&(void 0===j?Z.set(x,1):Z.set(x,j+1))}}catch(b){m.e(b)}finally{m.f()}}}catch(b){d.e(b)}finally{d.f()}return(0,L.jsx)("div",{children:u.map((function(e,t){return(0,L.jsx)(z,{vals:(0,c.Z)(s[t]),column:e,width:a,dispatch:i,filters:o},e.field)}))})}var _=["category","adapter","description"],A=.75,X=(0,u.observer)((function(e){var t,n,o=e.model,u=o.view,C=o.selection,S=(0,j.getEnv)(o).pluginManager,y=(0,x.x)(),E=y.ref,M=y.scrollLeft,T=(0,i.useState)(""),R=(0,l.Z)(T,2),H=R[0],W=R[1],I=(0,i.useState)(!1),G=(0,l.Z)(I,2),N=G[0],P=G[1],D=(0,i.useState)(),F=(0,l.Z)(D,2),z=F[0],X=F[1],U=(0,i.useState)(!1),V=(0,l.Z)(U,2),Y=V[0],q=V[1],J=(0,i.useState)(!0),K=(0,l.Z)(J,2),Q=K[0],$=K[1],ee=(0,i.useState)(400),te=(0,l.Z)(ee,2),ne=te[0],re=te[1],ie=(0,j.getSession)(o),oe=(0,j.useDebounce)(H,400),ae=u.tracks,ue=(0,i.useReducer)((function(e,t){return(0,r.Z)((0,r.Z)({},e),{},(0,s.Z)({},t.key,t.val))}),{}),ce=(0,l.Z)(ue,2),se=ce[0],le=ce[1],de=(0,i.useMemo)((function(){return o.trackConfigurations.filter((function(e){return(0,k.wB)(oe,e,ie)})).map((function(e){var t,n,i=(0,b.readConfObject)(e,"metadata");return(0,r.Z)({id:e.trackId,conf:e,name:(0,p.getTrackName)(e,ie),category:null===(t=(0,b.readConfObject)(e,"category"))||void 0===t?void 0:t.join(", "),adapter:null===(n=(0,b.readConfObject)(e,"adapter"))||void 0===n?void 0:n.type,description:(0,b.readConfObject)(e,"description"),metadata:i},i)}))}),[o,oe,ie]),fe=(0,i.useMemo)((function(){return _.filter((function(e){return!Q||de.map((function(t){return t[e]})).filter((function(e){return!!e})).length>5}))}),[Q,de]),he=(0,i.useMemo)((function(){return(0,c.Z)(new Set(de.flatMap((function(e){return t=e.metadata,Object.entries(t).map((function(e){var t=(0,l.Z)(e,2),n=t[0];return"string"===typeof t[1]?n:""})).filter((function(e){return!!e}));var t})))).filter((function(e){return!Q||de.map((function(t){return t.metadata[e]})).filter((function(e){return!!e})).length>5}))}),[Q,de]),me=(0,i.useMemo)((function(){return["name"].concat((0,c.Z)(fe),(0,c.Z)(he))}),[fe,he]),ve=(0,i.useState)((0,r.Z)((0,r.Z)({name:(0,j.measureGridWidth)(de.map((function(e){return e.name})),{maxWidth:500,stripHTML:!0})+15},Object.fromEntries(fe.map((function(e){return[e,(0,j.measureGridWidth)(de.map((function(t){return t[e]})),{maxWidth:400,stripHTML:!0})]})))),Object.fromEntries(he.map((function(e){return[e,(0,j.measureGridWidth)(de.map((function(t){return t.metadata[e]})),{maxWidth:400,stripHTML:!0})]}))))),pe=(0,l.Z)(ve,2),ge=pe[0],Ze=pe[1],xe=(0,i.useState)(Object.fromEntries(me.map((function(e){return[e,!0]})))),je=(0,l.Z)(xe,2),be=je[0],we=je[1];(0,i.useEffect)((function(){we((function(e){return(0,r.Z)((0,r.Z)({},Object.fromEntries(me.map((function(e){return[e,!0]})))),e)}))}),[me]),(0,i.useEffect)((function(){Ze((function(e){return(0,r.Z)((0,r.Z)({name:e.name},Object.fromEntries(fe.filter((function(e){return be[e]})).map((function(e){return[e,(0,j.measureGridWidth)(de.map((function(t){return t[e]})),{stripHTML:!0,maxWidth:400})]})))),Object.fromEntries(he.filter((function(e){return be[e]})).map((function(e){return[e,(0,j.measureGridWidth)(de.map((function(t){return t.metadata[e]})),{stripHTML:!0,maxWidth:400})]}))))}))}),[he,be,fe,Q,de]);var ke=(0,j.useDebounce)(ge,400),Ce=[{field:"name",hideable:!1,renderCell:function(e){var t=e.value,n=e.id,r=e.row;return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(g.Z,{html:t}),(0,L.jsx)(d.Z,{onClick:function(e){return X({target:e.currentTarget,id:n,conf:r.conf})},children:(0,L.jsx)(w.Z,{})})]})},width:null!==(t=ke.name)&&void 0!==t?t:100}].concat((0,c.Z)(fe.map((function(e){var t;return{field:e,width:null!==(t=ke[e])&&void 0!==t?t:100,renderCell:function(e){var t=e.value;return t?(0,L.jsx)(g.Z,{html:t}):""}}}))),(0,c.Z)(he.map((function(e){var t;return{field:e,width:null!==(t=ke[e])&&void 0!==t?t:100,renderCell:function(e){var t=e.value;return t?(0,L.jsx)(g.Z,{html:t}):""}}})))),Se=ae.map((function(e){return e.configuration.trackId})),ye=Object.entries(se).filter((function(e){return e[1].length>0}));return(0,L.jsxs)(L.Fragment,{children:[z?(0,L.jsx)(Z.Z,{anchorEl:null===z||void 0===z?void 0:z.target,menuItems:(null===(n=ie.getTrackActionMenuItems)||void 0===n?void 0:n.call(ie,z.conf))||[],onMenuItemClick:function(e,t){t(),X(void 0)},open:!!z,onClose:function(){return X(void 0)}}):null,(0,L.jsx)(O,{setHideSparse:$,setShowOptions:P,setFilterText:W,setUseShoppingCart:q,hideSparse:Q,showOptions:N,filterText:H,useShoppingCart:Y,model:o}),(0,L.jsxs)("div",{ref:E,style:{display:"flex",overflow:"hidden",height:window.innerHeight*A,width:window.innerWidth*A},children:[(0,L.jsxs)("div",{style:{height:window.innerHeight*A,width:window.innerWidth*A-ne},children:[(0,L.jsx)(x.Z,{checkbox:!0,widths:Object.values(ge).map((function(e){return null!==e&&void 0!==e?e:100})),setWidths:function(e){return Ze(Object.fromEntries(Object.entries(ge).map((function(t,n){return[t[0],e[n]]}))))},scrollLeft:M}),(0,L.jsx)(m._,{rows:de.filter((function(e){return ye.every((function(t){var n=(0,l.Z)(t,2),r=n[0];return n[1].includes(e[r])}))})),columnVisibilityModel:be,onColumnVisibilityModelChange:function(e){return we(e)},columnHeaderHeight:35,checkboxSelection:!0,disableRowSelectionOnClick:!0,keepNonExistentRowsSelected:!0,onRowSelectionModelChange:function(e){if(Y){var t=(0,h.getRoot)(o),n=S.pluggableConfigSchemaType("track"),r=e.map((function(e){return(0,h.resolveIdentifier)(n,t,e)}));o.setSelection(r)}else{var i=Se,a=e;(0,f.transaction)((function(){i.filter((function(e){return!a.includes(e)})).map((function(e){return u.hideTrack(e)})),a.filter((function(e){return!i.includes(e)})).map((function(e){return u.showTrack(e)}))}))}},rowSelectionModel:Y?C.map((function(e){return e.trackId})):Se,slots:{toolbar:N?v.n:null},slotProps:{toolbar:{printOptions:{disableToolbarButton:!0}}},columns:Ce,rowHeight:25})]}),(0,L.jsx)(a.ResizeHandle,{vertical:!0,onDrag:function(e){return re(ne-e)},style:{background:"grey",width:5}}),(0,L.jsx)("div",{style:{width:ne,overflowY:"auto",overflowX:"hidden"},children:(0,L.jsx)(B,{width:ne-10,rows:de,columns:Ce,dispatch:le,filters:se})})]})]})}));var U=(0,u.observer)((function(e){var t=e.handleClose;return(0,L.jsx)(a.Dialog,{open:!0,onClose:t,maxWidth:"xl",title:"Faceted track selector",children:(0,L.jsx)(o.Z,{children:(0,L.jsx)(X,(0,r.Z)({},e))})})}))},99051:function(e,t,n){n.d(t,{d:function(){return s}});var r=n(96902),i=n(69989),o=n(41561),a=n(62009),u=n(29938);function c(e){return e.substring(2).toLowerCase()}function s(e){var t=e.children,n=e.disableReactTree,s=void 0!==n&&n,l=e.mouseEvent,d=void 0===l?"onClick":l,f=e.onClickAway,h=e.touchEvent,m=void 0===h?"onTouchEnd":h,v=r.useRef(!1),p=r.useRef(null),g=r.useRef(!1),Z=r.useRef(!1);r.useEffect((function(){return setTimeout((function(){g.current=!0}),0),function(){g.current=!1}}),[]);var x=(0,i.Z)(t.ref,p),j=(0,o.Z)((function(e){var t=Z.current;Z.current=!1;var n=(0,a.Z)(p.current);!g.current||!p.current||"clientX"in e&&function(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}(e,n)||(v.current?v.current=!1:(e.composedPath?e.composedPath().indexOf(p.current)>-1:!n.documentElement.contains(e.target)||p.current.contains(e.target))||!s&&t||f(e))})),b=function(e){return function(n){Z.current=!0;var r=t.props[e];r&&r(n)}},w={ref:x};return!1!==m&&(w[m]=b(m)),r.useEffect((function(){if(!1!==m){var e=c(m),t=(0,a.Z)(p.current),n=function(){v.current=!0};return t.addEventListener(e,j),t.addEventListener("touchmove",n),function(){t.removeEventListener(e,j),t.removeEventListener("touchmove",n)}}}),[j,m]),!1!==d&&(w[d]=b(d)),r.useEffect((function(){if(!1!==d){var e=c(d),t=(0,a.Z)(p.current);return t.addEventListener(e,j),function(){t.removeEventListener(e,j)}}}),[j,d]),(0,u.jsx)(r.Fragment,{children:r.cloneElement(t,w)})}},82658:function(e,t,n){var r=n(56666),i=n(31461),o=n(7896),a=n(96902),u=n(37032),c=n(73674),s=n(53068),l=n(2252),d=n(24248),f=n(29938),h=["className","component","disableGutters","variant"],m=(0,l.ZP)("div",{name:"MuiToolbar",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,!n.disableGutters&&t.gutters,t[n.variant]]}})((function(e){var t=e.theme,n=e.ownerState;return(0,o.Z)({position:"relative",display:"flex",alignItems:"center"},!n.disableGutters&&(0,r.Z)({paddingLeft:t.spacing(2),paddingRight:t.spacing(2)},t.breakpoints.up("sm"),{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}),"dense"===n.variant&&{minHeight:48})}),(function(e){var t=e.theme;return"regular"===e.ownerState.variant&&t.mixins.toolbar})),v=a.forwardRef((function(e,t){var n=(0,s.Z)({props:e,name:"MuiToolbar"}),r=n.className,a=n.component,l=void 0===a?"div":a,v=n.disableGutters,p=void 0!==v&&v,g=n.variant,Z=void 0===g?"regular":g,x=(0,i.Z)(n,h),j=(0,o.Z)({},n,{component:l,disableGutters:p,variant:Z}),b=function(e){var t=e.classes,n={root:["root",!e.disableGutters&&"gutters",e.variant]};return(0,c.Z)(n,d.N,t)}(j);return(0,f.jsx)(m,(0,o.Z)({as:l,className:(0,u.Z)(b.root,r),ref:t,ownerState:j},x))}));t.Z=v},24248:function(e,t,n){n.d(t,{N:function(){return o}});var r=n(74732),i=n(61235);function o(e){return(0,i.Z)("MuiToolbar",e)}var a=(0,r.Z)("MuiToolbar",["root","gutters","regular","dense"]);t.Z=a}}]);
//# sourceMappingURL=317.6134c595.chunk.js.map