"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[2887,4801,7182,9563,1944,5277,7658,39,2420],{48927:(e,t,r)=>{r.r(t),r.d(t,{default:()=>z});var n=r(7552),a=r(29499),o=r(49823),i=r(68446),l=r(42489),s=r(36422),c=r(77110),d=r(76157),m=r(13476),u=r(99546),h=r(75785),f=r(67314),p=r(1343),v=r(93117),g=r(61723),w=r(61848),k=r(64359),A=r(9469);function b({model:e}){const{faceted:t}=e,[r,a]=(0,n.useState)(null),{showOptions:i,showFilters:l,showSparse:s,useShoppingCart:c}=t;return n.createElement(n.Fragment,null,n.createElement(f.Ay,{container:!0,spacing:4,alignItems:"center"},n.createElement(f.Ay,{item:!0},n.createElement(p.A,{label:"Search...",value:t.filterText,onChange:e=>t.setFilterText(e.target.value),InputProps:{endAdornment:n.createElement(v.A,{position:"end"},n.createElement(g.A,{onClick:()=>t.setFilterText("")},n.createElement(w.A,null)))}})),n.createElement(f.Ay,{item:!0},n.createElement(g.A,{onClick:e=>a(e.currentTarget)},n.createElement(k.A,null))),n.createElement(f.Ay,{item:!0},n.createElement(A.A,{model:e}))),n.createElement(o.Menu,{anchorEl:r,open:!!r,onClose:()=>a(null),onMenuItemClick:(e,t)=>{t(),a(null)},menuItems:[{label:"Add tracks to selection instead of turning them on/off",onClick:()=>t.setUseShoppingCart(!c),type:"checkbox",checked:c},{label:"Show sparse metadata columns",onClick:()=>t.setShowSparse(!s),checked:s,type:"checkbox"},{label:"Show facet filters",onClick:()=>t.setShowFilters(!l),checked:l,type:"checkbox"},{label:"Show extra table options",onClick:()=>t.setShowOptions(!i),checked:i,type:"checkbox"}]}))}var E=r(89003),S=r(48171),C=r(36715),y=r(98360),x=r(21909),M=r(57610);const T=(0,h.n9)()((e=>({facet:{margin:0,marginLeft:e.spacing(2)},select:{marginBottom:e.spacing(2)}})));function R({onClick:e}){return n.createElement(E.A,{title:"Clear selection on this facet filter"},n.createElement(g.A,{onClick:()=>e(),size:"small"},n.createElement(w.A,null)))}function N({visible:e,onClick:t}){return n.createElement(E.A,{title:"Minimize/expand this facet filter"},n.createElement(g.A,{onClick:()=>t(),size:"small"},e?n.createElement(x.A,null):n.createElement(M.A,null)))}const H=(0,i.observer)((function({column:e,vals:t,model:r}){const{classes:a}=T(),[o,i]=(0,n.useState)(!0),{faceted:l}=r,{filters:s}=l,{field:c}=e;return n.createElement(S.A,{className:a.facet,fullWidth:!0},n.createElement("div",null,n.createElement(C.A,{component:"span"},c),n.createElement(R,{onClick:()=>l.setFilter(c,[])}),n.createElement(N,{visible:o,onClick:()=>i(!o)})),o?n.createElement(y.A,{multiple:!0,native:!0,className:a.select,value:s.get(e.field)||[],onChange:t=>{l.setFilter(e.field,[...t.target.options].filter((e=>e.selected)).map((e=>e.value)))}},t.sort(((e,t)=>e[0].localeCompare(t[0]))).map((([e,t])=>n.createElement("option",{key:e,value:e},(0,u.coarseStripHTML)(e)," (",t,")")))):null)}));var L=r(6842);const W=(0,i.observer)((function({rows:e,columns:t,model:r}){const{faceted:a}=r,{filters:o}=a,i=t.slice(1),l=new Map(i.map((e=>[e.field,new Map]))),s=a.filters.keys(),c=i.map((e=>e.field)),d=new Set;for(const e of s)o.get(e)?.length&&d.add(e);for(const e of c)d.add(e);let m=e;for(const e of d){const t=l.get(e);for(const r of m){const n=(0,L.a)(e,r),a=t.get(n);n&&(void 0===a?t.set(n,1):t.set(n,a+1))}const r=o.get(e)?.length?new Set(o.get(e)):void 0;m=m.filter((t=>void 0===r||r.has((0,L.a)(e,t))))}return n.createElement("div",null,i.map((e=>n.createElement(H,{key:e.field,vals:[...l.get(e.field)],column:e,model:r}))))}));var F=r(48408);const P=(0,h.n9)()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},resizeHandle:{marginLeft:5,background:"grey",width:5}}),D=.75,I=(0,i.observer)((function({model:e}){const{classes:t}=P(),{view:r,selection:a,shownTrackIds:i,faceted:h}=e,{rows:f,panelWidth:p,showFilters:v,useShoppingCart:g,showOptions:w,filteredRows:k,filteredNonMetadataKeys:A,filteredMetadataKeys:E,visible:S}=h,{pluginManager:C}=(0,u.getEnv)(e),[y,x]=(0,n.useState)({name:(0,u.measureGridWidth)(f.map((e=>e.name)),{maxWidth:500,stripHTML:!0})+15,...Object.fromEntries(A.filter((e=>S[e])).map((e=>[e,(0,u.measureGridWidth)(f.map((t=>t[e])),{maxWidth:400,stripHTML:!0})]))),...Object.fromEntries(E.filter((e=>S["metadata."+e])).map((e=>["metadata."+e,(0,u.measureGridWidth)(f.map((t=>t.metadata[e])),{maxWidth:400,stripHTML:!0})])))}),M=[{field:"name",hideable:!1,renderCell:r=>{const{value:a,row:o}=r,{id:i,conf:l}=o;return n.createElement("div",{className:t.cell},n.createElement(m.A,{html:a}),n.createElement(F.A,{id:i,conf:l,trackId:i,model:e}))},width:y.name??100},...A.map((e=>({field:e,width:y[e]??100,renderCell:e=>{const r=e.value;return r?n.createElement(m.A,{className:t.cell,html:r}):""}}))),...E.map((e=>({field:`metadata.${e}`,headerName:["name",...A].includes(e)?`${e} (from metadata)`:e,width:y["metadata."+e]??100,valueGetter:(t,r)=>`${r.metadata[e]??""}`,renderCell:e=>{const r=e.value;return r?n.createElement(m.A,{className:t.cell,html:r}):""}})))];return n.createElement(n.Fragment,null,n.createElement(b,{model:e}),n.createElement("div",{style:{display:"flex",overflow:"hidden",height:window.innerHeight*D,width:window.innerWidth*D}},n.createElement("div",{style:{height:window.innerHeight*D,width:window.innerWidth*D-(v?p:0)}},n.createElement(c.z,{rows:k,onColumnWidthChange:e=>x({...y,[e.colDef.field]:e.width}),columnVisibilityModel:S,onColumnVisibilityModelChange:e=>h.setVisible(e),columnHeaderHeight:35,checkboxSelection:!0,disableRowSelectionOnClick:!0,keepNonExistentRowsSelected:!0,onRowSelectionModelChange:t=>{if(g){const r=(0,s.getRoot)(e),n=C.pluggableConfigSchemaType("track");e.setSelection(t.map((e=>(0,s.resolveIdentifier)(n,r,e))))}else{const n=i,a=new Set(t);(0,l.transaction)((()=>{[...n].filter((e=>!a.has(e))).map((e=>r.hideTrack(e))),[...a].filter((e=>!n.has(e))).map((t=>{r.showTrack(t),e.addToRecentlyUsed(t)}))}))}},rowSelectionModel:g?a.map((e=>e.trackId)):[...i],slots:{toolbar:w?d.O:null},slotProps:{toolbar:{printOptions:{disableToolbarButton:!0}}},columns:M,rowHeight:25})),v?n.createElement(n.Fragment,null,n.createElement(o.ResizeHandle,{vertical:!0,onDrag:e=>h.setPanelWidth(p-e),className:t.resizeHandle}),n.createElement("div",{style:{width:p,overflow:"auto"}},n.createElement(W,{model:e,rows:f,columns:M}))):null))})),z=(0,i.observer)((function(e){const{handleClose:t}=e;return n.createElement(o.Dialog,{open:!0,onClose:t,maxWidth:"xl",title:"Faceted track selector"},n.createElement(a.A,null,n.createElement(I,e)))}))},54767:(e,t,r)=>{r.d(t,{x:()=>c});var n=r(7552),a=r(24979),o=r(74795),i=r(89301),l=r(69500);function s(e){return e.substring(2).toLowerCase()}function c(e){const{children:t,disableReactTree:r=!1,mouseEvent:c="onClick",onClickAway:d,touchEvent:m="onTouchEnd"}=e,u=n.useRef(!1),h=n.useRef(null),f=n.useRef(!1),p=n.useRef(!1);n.useEffect((()=>(setTimeout((()=>{f.current=!0}),0),()=>{f.current=!1})),[]);const v=(0,a.A)(t.ref,h),g=(0,o.A)((e=>{const t=p.current;p.current=!1;const n=(0,i.A)(h.current);if(!f.current||!h.current||"clientX"in e&&function(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}(e,n))return;if(u.current)return void(u.current=!1);let a;a=e.composedPath?e.composedPath().indexOf(h.current)>-1:!n.documentElement.contains(e.target)||h.current.contains(e.target),a||!r&&t||d(e)})),w=e=>r=>{p.current=!0;const n=t.props[e];n&&n(r)},k={ref:v};return!1!==m&&(k[m]=w(m)),n.useEffect((()=>{if(!1!==m){const e=s(m),t=(0,i.A)(h.current),r=()=>{u.current=!0};return t.addEventListener(e,g),t.addEventListener("touchmove",r),()=>{t.removeEventListener(e,g),t.removeEventListener("touchmove",r)}}}),[g,m]),!1!==c&&(k[c]=w(c)),n.useEffect((()=>{if(!1!==c){const e=s(c),t=(0,i.A)(h.current);return t.addEventListener(e,g),()=>{t.removeEventListener(e,g)}}}),[g,c]),(0,l.jsx)(n.Fragment,{children:n.cloneElement(t,k)})}},59705:(e,t,r)=>{r.d(t,{A:()=>y});var n=r(83673),a=r(6614),o=r(7552),i=r(93878),l=r(60827),s=r(64761),c=r(15622),d=r(31049),m=r(51148),u=r(72489),h=r(69500);const f=["className","color","disableShrink","size","style","thickness","value","variant"];let p,v,g,w,k=e=>e;const A=(0,s.i7)(p||(p=k`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),b=(0,s.i7)(v||(v=k`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),E=(0,m.Ay)("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.variant],t[`color${(0,c.A)(r.color)}`]]}})((({ownerState:e,theme:t})=>(0,a.A)({display:"inline-block"},"determinate"===e.variant&&{transition:t.transitions.create("transform")},"inherit"!==e.color&&{color:(t.vars||t).palette[e.color].main})),(({ownerState:e})=>"indeterminate"===e.variant&&(0,s.AH)(g||(g=k`
      animation: ${0} 1.4s linear infinite;
    `),A))),S=(0,m.Ay)("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(e,t)=>t.svg})({display:"block"}),C=(0,m.Ay)("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.circle,t[`circle${(0,c.A)(r.variant)}`],r.disableShrink&&t.circleDisableShrink]}})((({ownerState:e,theme:t})=>(0,a.A)({stroke:"currentColor"},"determinate"===e.variant&&{transition:t.transitions.create("stroke-dashoffset")},"indeterminate"===e.variant&&{strokeDasharray:"80px, 200px",strokeDashoffset:0})),(({ownerState:e})=>"indeterminate"===e.variant&&!e.disableShrink&&(0,s.AH)(w||(w=k`
      animation: ${0} 1.4s ease-in-out infinite;
    `),b))),y=o.forwardRef((function(e,t){const r=(0,d.A)({props:e,name:"MuiCircularProgress"}),{className:o,color:s="primary",disableShrink:m=!1,size:p=40,style:v,thickness:g=3.6,value:w=0,variant:k="indeterminate"}=r,A=(0,n.A)(r,f),b=(0,a.A)({},r,{color:s,disableShrink:m,size:p,thickness:g,value:w,variant:k}),y=(e=>{const{classes:t,variant:r,color:n,disableShrink:a}=e,o={root:["root",r,`color${(0,c.A)(n)}`],svg:["svg"],circle:["circle",`circle${(0,c.A)(r)}`,a&&"circleDisableShrink"]};return(0,l.A)(o,u.b,t)})(b),x={},M={},T={};if("determinate"===k){const e=2*Math.PI*((44-g)/2);x.strokeDasharray=e.toFixed(3),T["aria-valuenow"]=Math.round(w),x.strokeDashoffset=`${((100-w)/100*e).toFixed(3)}px`,M.transform="rotate(-90deg)"}return(0,h.jsx)(E,(0,a.A)({className:(0,i.A)(y.root,o),style:(0,a.A)({width:p,height:p},M,v),ownerState:b,ref:t,role:"progressbar"},T,A,{children:(0,h.jsx)(S,{className:y.svg,ownerState:b,viewBox:"22 22 44 44",children:(0,h.jsx)(C,{className:y.circle,style:x,ownerState:b,cx:44,cy:44,r:(44-g)/2,fill:"none",strokeWidth:g})})}))}))},72489:(e,t,r)=>{r.d(t,{A:()=>i,b:()=>o});var n=r(55549),a=r(9577);function o(e){return(0,a.Ay)("MuiCircularProgress",e)}const i=(0,n.A)("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"])},17515:(e,t,r)=>{r.d(t,{A:()=>f});var n=r(83673),a=r(6614),o=r(7552),i=r(93878),l=r(60827),s=r(31049),c=r(51148),d=r(89663),m=r(69500);const u=["className","component","disableGutters","variant"],h=(0,c.Ay)("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,!r.disableGutters&&t.gutters,t[r.variant]]}})((({theme:e,ownerState:t})=>(0,a.A)({position:"relative",display:"flex",alignItems:"center"},!t.disableGutters&&{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}},"dense"===t.variant&&{minHeight:48})),(({theme:e,ownerState:t})=>"regular"===t.variant&&e.mixins.toolbar)),f=o.forwardRef((function(e,t){const r=(0,s.A)({props:e,name:"MuiToolbar"}),{className:o,component:c="div",disableGutters:f=!1,variant:p="regular"}=r,v=(0,n.A)(r,u),g=(0,a.A)({},r,{component:c,disableGutters:f,variant:p}),w=(e=>{const{classes:t,disableGutters:r,variant:n}=e,a={root:["root",!r&&"gutters",n]};return(0,l.A)(a,d.U,t)})(g);return(0,m.jsx)(h,(0,a.A)({as:c,className:(0,i.A)(w.root,o),ref:t,ownerState:g},v))}))},89663:(e,t,r)=>{r.d(t,{A:()=>i,U:()=>o});var n=r(55549),a=r(9577);function o(e){return(0,a.Ay)("MuiToolbar",e)}const i=(0,n.A)("MuiToolbar",["root","gutters","regular","dense"])}}]);
//# sourceMappingURL=2887.42dfa660.chunk.js.map