"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[7690,4334],{63754:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(66204),a=r(38684),o=r(72291);const l=(0,a.ZL)()((e=>({resizeBar:{background:e.palette.action.disabledBackground,height:12,position:"relative",overflow:"hidden"},tick:{position:"absolute",height:"100%",pointerEvents:"none",background:e.palette.action.disabled,width:1},hiddenTick:{position:"absolute",height:"100%",width:5}})));function s({left:e,scrollLeft:t,idx:r,onDrag:a,onMouseDown:s}){const{classes:i}=l(),c=(0,n.useCallback)(((e,t)=>a(e,t,r)),[r,a]);return n.createElement(n.Fragment,null,n.createElement(o.Z,{onDrag:c,onMouseDown:s,vertical:!0,className:i.hiddenTick,style:{left:e-t-2.5}}),n.createElement("div",{style:{left:e-t},className:i.tick}))}function i({widths:e,setWidths:t,checkbox:r,scrollLeft:a=0}){const{classes:o}=l(),i=[],[c,d]=(0,n.useState)();let m=r?52:0;for(let t=0;t<e.length;t++){const r=e[t];i[t]=r+m,m+=r}return n.createElement("div",{className:o.resizeBar},i.map(((r,o)=>n.createElement(s,{key:o,onMouseDown:()=>{d([...e])},left:o===i.length-1?r-3:r,onDrag:(r,n,a)=>{const o=[...e];o[a]=Math.max(c[a]-n,50),t(o)},idx:o,scrollLeft:a}))))}},77540:(e,t,r)=>{r.d(t,{x:()=>a});var n=r(66204);function a(){const e=(0,n.useRef)(null),[t,r]=(0,n.useState)(0);return(0,n.useEffect)((()=>{const t=setInterval((()=>{const t=e.current?.querySelector(".MuiDataGrid-virtualScroller");t&&r(t.scrollLeft)}),100);return()=>{clearInterval(t)}}),[]),{ref:e,scrollLeft:t}}},31358:(e,t,r)=>{r.r(t),r.d(t,{default:()=>j});var n=r(66204),a=r(29520),o=r(43902),l=r(80846),s=r(99247),i=r(88196),c=r(23155),d=r(84081),m=r(18510),u=r(63754),h=r(31211),f=r(77540),v=r(38684),p=r(93840),g=r(46338),w=r(81799),k=r(49140),b=r(92292),E=r(98313),Z=r(65429);function S({model:e}){const{faceted:t}=e,[r,a]=(0,n.useState)(null),{showOptions:l,showFilters:s,showSparse:i,useShoppingCart:c}=t;return n.createElement(n.Fragment,null,n.createElement(p.ZP,{container:!0,spacing:4,alignItems:"center"},n.createElement(p.ZP,{item:!0},n.createElement(g.Z,{label:"Search...",value:t.filterText,onChange:e=>t.setFilterText(e.target.value),InputProps:{endAdornment:n.createElement(w.Z,{position:"end"},n.createElement(k.Z,{onClick:()=>t.setFilterText("")},n.createElement(b.Z,null)))}})),n.createElement(p.ZP,{item:!0},n.createElement(k.Z,{onClick:e=>a(e.currentTarget)},n.createElement(E.Z,null))),n.createElement(p.ZP,{item:!0},n.createElement(Z.Z,{model:e}))),n.createElement(o.Menu,{anchorEl:r,open:!!r,onClose:()=>a(null),onMenuItemClick:(e,t)=>{t(),a(null)},menuItems:[{label:"Add tracks to selection instead of turning them on/off",onClick:()=>t.setUseShoppingCart(!c),type:"checkbox",checked:c},{label:"Show sparse metadata columns",onClick:()=>t.setShowSparse(!i),checked:i,type:"checkbox"},{label:"Show facet filters",onClick:()=>t.setShowFilters(!s),checked:s,type:"checkbox"},{label:"Show extra table options",onClick:()=>t.setShowOptions(!l),checked:l,type:"checkbox"}]}))}var C=r(23540),x=r(94926),y=r(80013),M=r(32339),R=r(41997),L=r(97916);const N=(0,v.ZL)()((e=>({facet:{margin:0,marginLeft:e.spacing(2)},select:{marginBottom:e.spacing(2)}})));function T({onClick:e}){return n.createElement(C.Z,{title:"Clear selection on this facet filter"},n.createElement(k.Z,{onClick:()=>e(),size:"small"},n.createElement(b.Z,null)))}function P({visible:e,onClick:t}){return n.createElement(C.Z,{title:"Minimize/expand this facet filter"},n.createElement(k.Z,{onClick:()=>t(),size:"small"},e?n.createElement(R.Z,null):n.createElement(L.Z,null)))}const D=(0,l.observer)((function({column:e,vals:t,model:r}){const{classes:a}=N(),[o,l]=(0,n.useState)(!0),{faceted:s}=r,{filters:i}=s,{field:c}=e;return n.createElement(x.Z,{className:a.facet,fullWidth:!0},n.createElement("div",null,n.createElement(y.Z,{component:"span"},c),n.createElement(T,{onClick:()=>s.setFilter(c,[])}),n.createElement(P,{visible:o,onClick:()=>l(!o)})),o?n.createElement(M.Z,{multiple:!0,native:!0,className:a.select,value:i.get(e.field)||[],onChange:t=>{s.setFilter(e.field,[...t.target.options].filter((e=>e.selected)).map((e=>e.value)))}},t.sort(((e,t)=>e[0].localeCompare(t[0]))).map((([e,t])=>n.createElement("option",{key:e,value:e},(0,h.coarseStripHTML)(e)," (",t,")")))):null)}));var F=r(52101);const I=(0,l.observer)((function({rows:e,columns:t,model:r}){const{faceted:a}=r,{filters:o}=a,l=t.slice(1),s=new Map(l.map((e=>[e.field,new Map]))),i=a.filters.keys(),c=l.map((e=>e.field)),d=new Set;for(const e of i)o.get(e)?.length&&d.add(e);for(const e of c)d.add(e);let m=e;for(const e of d){const t=s.get(e);for(const r of m){const n=(0,F.O)(e,r),a=t.get(n);n&&(void 0===a?t.set(n,1):t.set(n,a+1))}const r=o.get(e)?.length?new Set(o.get(e)):void 0;m=m.filter((t=>void 0===r||r.has((0,F.O)(e,t))))}return n.createElement("div",null,l.map((e=>n.createElement(D,{key:e.field,vals:[...s.get(e.field)],column:e,model:r}))))}));var O=r(17783);const z=(0,v.ZL)()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},resizeHandle:{marginLeft:5,background:"grey",width:5}}),H=.75,W=(0,l.observer)((function({model:e}){const{classes:t}=z(),{view:r,selection:a,shownTrackIds:l,faceted:v}=e,{rows:p,panelWidth:g,showFilters:w,useShoppingCart:k,showOptions:b,filteredRows:E,filteredNonMetadataKeys:Z,filteredMetadataKeys:C,visible:x,widths:y}=v,{pluginManager:M}=(0,h.getEnv)(e),{ref:R,scrollLeft:L}=(0,f.x)(),N=(0,h.useDebounce)(y,200),T=[{field:"name",hideable:!1,renderCell:r=>{const{value:a,row:o}=r,{id:l,conf:s}=o;return n.createElement("div",{className:t.cell},n.createElement(m.Z,{html:a}),n.createElement(O.Z,{id:l,conf:s,trackId:l,model:e}))},width:N.name??100},...Z.map((e=>({field:e,width:N[e]??100,renderCell:e=>{const r=e.value;return r?n.createElement(m.Z,{className:t.cell,html:r}):""}}))),...C.map((e=>({field:`metadata.${e}`,headerName:["name",...Z].includes(e)?`${e} (from metadata)`:e,width:N["metadata."+e]??100,valueGetter:t=>t.row.metadata[e],renderCell:r=>{const a=r.row.metadata[e];return a?n.createElement(m.Z,{className:t.cell,html:a}):""}})))];return n.createElement(n.Fragment,null,n.createElement(S,{model:e}),n.createElement("div",{ref:R,style:{display:"flex",overflow:"hidden",height:window.innerHeight*H,width:window.innerWidth*H}},n.createElement("div",{style:{height:window.innerHeight*H,width:window.innerWidth*H-(w?g:0)}},n.createElement(u.Z,{checkbox:!0,widths:Object.values(y).map((e=>e??100)),setWidths:e=>v.setWidths(Object.fromEntries(Object.entries(y).map(((t,r)=>[t[0],e[r]])))),scrollLeft:L}),n.createElement(c._$,{rows:E,columnVisibilityModel:x,onColumnVisibilityModelChange:e=>v.setVisible(e),columnHeaderHeight:35,checkboxSelection:!0,disableRowSelectionOnClick:!0,keepNonExistentRowsSelected:!0,onRowSelectionModelChange:t=>{if(k){const r=(0,i.getRoot)(e),n=M.pluggableConfigSchemaType("track");e.setSelection(t.map((e=>(0,i.resolveIdentifier)(n,r,e))))}else{const n=l,a=new Set(t);(0,s.transaction)((()=>{[...n].filter((e=>!a.has(e))).map((e=>r.hideTrack(e))),[...a].filter((e=>!n.has(e))).map((t=>{r.showTrack(t),e.addToRecentlyUsed(t)}))}))}},rowSelectionModel:k?a.map((e=>e.trackId)):[...l],slots:{toolbar:b?d.n:null},slotProps:{toolbar:{printOptions:{disableToolbarButton:!0}}},columns:T,rowHeight:25})),w?n.createElement(n.Fragment,null,n.createElement(o.ResizeHandle,{vertical:!0,onDrag:e=>v.setPanelWidth(g-e),className:t.resizeHandle}),n.createElement("div",{style:{width:g,overflow:"auto"}},n.createElement(I,{model:e,rows:p,columns:T}))):null))})),j=(0,l.observer)((function(e){const{handleClose:t}=e;return n.createElement(o.Dialog,{open:!0,onClose:t,maxWidth:"xl",title:"Faceted track selector"},n.createElement(a.Z,null,n.createElement(W,e)))}))},6816:(e,t,r)=>{r.d(t,{d:()=>c});var n=r(66204),a=r(52682),o=r(76734),l=r(26074),s=r(43188);function i(e){return e.substring(2).toLowerCase()}function c(e){const{children:t,disableReactTree:r=!1,mouseEvent:c="onClick",onClickAway:d,touchEvent:m="onTouchEnd"}=e,u=n.useRef(!1),h=n.useRef(null),f=n.useRef(!1),v=n.useRef(!1);n.useEffect((()=>(setTimeout((()=>{f.current=!0}),0),()=>{f.current=!1})),[]);const p=(0,a.Z)(t.ref,h),g=(0,o.Z)((e=>{const t=v.current;v.current=!1;const n=(0,l.Z)(h.current);if(!f.current||!h.current||"clientX"in e&&function(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}(e,n))return;if(u.current)return void(u.current=!1);let a;a=e.composedPath?e.composedPath().indexOf(h.current)>-1:!n.documentElement.contains(e.target)||h.current.contains(e.target),a||!r&&t||d(e)})),w=e=>r=>{v.current=!0;const n=t.props[e];n&&n(r)},k={ref:p};return!1!==m&&(k[m]=w(m)),n.useEffect((()=>{if(!1!==m){const e=i(m),t=(0,l.Z)(h.current),r=()=>{u.current=!0};return t.addEventListener(e,g),t.addEventListener("touchmove",r),()=>{t.removeEventListener(e,g),t.removeEventListener("touchmove",r)}}}),[g,m]),!1!==c&&(k[c]=w(c)),n.useEffect((()=>{if(!1!==c){const e=i(c),t=(0,l.Z)(h.current);return t.addEventListener(e,g),()=>{t.removeEventListener(e,g)}}}),[g,c]),(0,s.jsx)(n.Fragment,{children:n.cloneElement(t,k)})}},10126:(e,t,r)=>{r.d(t,{Z:()=>x});var n=r(55559),a=r(30984),o=r(66204),l=r(56317),s=r(58029),i=r(71580),c=r(40118),d=r(57369),m=r(61125),u=r(22489),h=r(43188);const f=["className","color","disableShrink","size","style","thickness","value","variant"];let v,p,g,w,k=e=>e;const b=(0,i.F4)(v||(v=k`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),E=(0,i.F4)(p||(p=k`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),Z=(0,m.ZP)("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.variant],t[`color${(0,c.Z)(r.color)}`]]}})((({ownerState:e,theme:t})=>(0,a.Z)({display:"inline-block"},"determinate"===e.variant&&{transition:t.transitions.create("transform")},"inherit"!==e.color&&{color:(t.vars||t).palette[e.color].main})),(({ownerState:e})=>"indeterminate"===e.variant&&(0,i.iv)(g||(g=k`
      animation: ${0} 1.4s linear infinite;
    `),b))),S=(0,m.ZP)("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(e,t)=>t.svg})({display:"block"}),C=(0,m.ZP)("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.circle,t[`circle${(0,c.Z)(r.variant)}`],r.disableShrink&&t.circleDisableShrink]}})((({ownerState:e,theme:t})=>(0,a.Z)({stroke:"currentColor"},"determinate"===e.variant&&{transition:t.transitions.create("stroke-dashoffset")},"indeterminate"===e.variant&&{strokeDasharray:"80px, 200px",strokeDashoffset:0})),(({ownerState:e})=>"indeterminate"===e.variant&&!e.disableShrink&&(0,i.iv)(w||(w=k`
      animation: ${0} 1.4s ease-in-out infinite;
    `),E))),x=o.forwardRef((function(e,t){const r=(0,d.Z)({props:e,name:"MuiCircularProgress"}),{className:o,color:i="primary",disableShrink:m=!1,size:v=40,style:p,thickness:g=3.6,value:w=0,variant:k="indeterminate"}=r,b=(0,n.Z)(r,f),E=(0,a.Z)({},r,{color:i,disableShrink:m,size:v,thickness:g,value:w,variant:k}),x=(e=>{const{classes:t,variant:r,color:n,disableShrink:a}=e,o={root:["root",r,`color${(0,c.Z)(n)}`],svg:["svg"],circle:["circle",`circle${(0,c.Z)(r)}`,a&&"circleDisableShrink"]};return(0,s.Z)(o,u.C,t)})(E),y={},M={},R={};if("determinate"===k){const e=2*Math.PI*((44-g)/2);y.strokeDasharray=e.toFixed(3),R["aria-valuenow"]=Math.round(w),y.strokeDashoffset=`${((100-w)/100*e).toFixed(3)}px`,M.transform="rotate(-90deg)"}return(0,h.jsx)(Z,(0,a.Z)({className:(0,l.Z)(x.root,o),style:(0,a.Z)({width:v,height:v},M,p),ownerState:E,ref:t,role:"progressbar"},R,b,{children:(0,h.jsx)(S,{className:x.svg,ownerState:E,viewBox:"22 22 44 44",children:(0,h.jsx)(C,{className:x.circle,style:y,ownerState:E,cx:44,cy:44,r:(44-g)/2,fill:"none",strokeWidth:g})})}))}))},22489:(e,t,r)=>{r.d(t,{C:()=>o,Z:()=>l});var n=r(58109),a=r(95201);function o(e){return(0,a.Z)("MuiCircularProgress",e)}const l=(0,n.Z)("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"])},96987:(e,t,r)=>{r.d(t,{Z:()=>f});var n=r(55559),a=r(30984),o=r(66204),l=r(56317),s=r(58029),i=r(57369),c=r(61125),d=r(41666),m=r(43188);const u=["className","component","disableGutters","variant"],h=(0,c.ZP)("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,!r.disableGutters&&t.gutters,t[r.variant]]}})((({theme:e,ownerState:t})=>(0,a.Z)({position:"relative",display:"flex",alignItems:"center"},!t.disableGutters&&{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}},"dense"===t.variant&&{minHeight:48})),(({theme:e,ownerState:t})=>"regular"===t.variant&&e.mixins.toolbar)),f=o.forwardRef((function(e,t){const r=(0,i.Z)({props:e,name:"MuiToolbar"}),{className:o,component:c="div",disableGutters:f=!1,variant:v="regular"}=r,p=(0,n.Z)(r,u),g=(0,a.Z)({},r,{component:c,disableGutters:f,variant:v}),w=(e=>{const{classes:t,disableGutters:r,variant:n}=e,a={root:["root",!r&&"gutters",n]};return(0,s.Z)(a,d.N,t)})(g);return(0,m.jsx)(h,(0,a.Z)({as:c,className:(0,l.Z)(w.root,o),ref:t,ownerState:g},p))}))},41666:(e,t,r)=>{r.d(t,{N:()=>o,Z:()=>l});var n=r(58109),a=r(95201);function o(e){return(0,a.Z)("MuiToolbar",e)}const l=(0,n.Z)("MuiToolbar",["root","gutters","regular","dense"])}}]);
//# sourceMappingURL=7690.195e3820.chunk.js.map