{"version":3,"file":"static/js/8857.bdc2f901.chunk.js","mappings":"sMAUe,MAAMA,UAAuBC,EAAAA,QAC1C,cAAMC,CAASC,GACb,MAAMC,GAASC,EAAAA,EAAAA,cAAaC,KAAKC,QAAQ,eAAgBD,KAAKE,eACxDC,QAAgBL,EAAOM,SAASP,GAChCQ,EARV,SAAgBA,GACd,OAAkB,KAAXA,EAAI,IAAwB,MAAXA,EAAI,IAAyB,IAAXA,EAAI,EAChD,CAMgBC,CAAOH,SAAgBI,EAAAA,EAAAA,OAAMJ,GAAUA,EACnD,OAAOK,EAAAA,EAAAA,IAAgBH,EAAKI,EAC9B,EAGF,SAASA,EAAiBC,GACxB,MAAMC,EAASD,EAAKE,MAAM,KAC1B,GAAID,EAAOE,OAAS,EAElB,MAAM,IAAIC,MAAM,8BAAgCJ,GAElD,MAAOK,EAAM,CAAGC,EAAQC,EAAMC,EAAQC,EAAM,CAAGC,EAAQC,EAAMC,GAAMX,EAEnE,MAAO,CACLQ,QACAC,QAASA,EACTC,MAAOA,EACPN,QACAC,QAASA,EACTC,MAAOA,EACPC,OAAmB,MAAXA,GAAkB,EAAI,EAC9BK,MAAO,CACLC,aAAcF,GAGpB,C","sources":["../../../plugins/comparative-adapters/src/MashMapAdapter/MashMapAdapter.ts"],"sourcesContent":["import { BaseOptions } from '@jbrowse/core/data_adapters/BaseAdapter'\nimport { openLocation } from '@jbrowse/core/util/io'\nimport { unzip } from '@gmod/bgzf-filehandle'\nimport PAFAdapter from '../PAFAdapter/PAFAdapter'\nimport { parseLineByLine } from '../util'\n\nfunction isGzip(buf: Buffer) {\n  return buf[0] === 31 && buf[1] === 139 && buf[2] === 8\n}\n\nexport default class MashMapAdapter extends PAFAdapter {\n  async setupPre(opts?: BaseOptions) {\n    const outLoc = openLocation(this.getConf('outLocation'), this.pluginManager)\n    const buffer = (await outLoc.readFile(opts)) as Buffer\n    const buf = isGzip(buffer) ? await unzip(buffer) : buffer\n    return parseLineByLine(buf, parseMashMapLine)\n  }\n}\n\nfunction parseMashMapLine(line: string) {\n  const fields = line.split(' ')\n  if (fields.length < 9) {\n    // xref https://github.com/marbl/MashMap/issues/38\n    throw new Error('improperly formatted line: ' + line)\n  }\n  const [qname, , qstart, qend, strand, tname, , tstart, tend, mq] = fields\n\n  return {\n    tname,\n    tstart: +tstart,\n    tend: +tend,\n    qname,\n    qstart: +qstart,\n    qend: +qend,\n    strand: strand === '-' ? -1 : 1,\n    extra: {\n      mappingQual: +mq,\n    },\n  }\n}\n"],"names":["MashMapAdapter","PAFAdapter","setupPre","opts","outLoc","openLocation","this","getConf","pluginManager","buffer","readFile","buf","isGzip","unzip","parseLineByLine","parseMashMapLine","line","fields","split","length","Error","qname","qstart","qend","strand","tname","tstart","tend","mq","extra","mappingQual"],"sourceRoot":""}