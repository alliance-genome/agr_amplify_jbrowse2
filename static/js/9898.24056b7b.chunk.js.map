{"version":3,"file":"static/js/9898.24056b7b.chunk.js","mappings":"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","sources":["../../../plugins/linear-comparative-view/src/LinearSyntenyDisplay/components/SyntenyTooltip.tsx","../../../plugins/linear-comparative-view/src/LinearSyntenyDisplay/components/LinearSyntenyRendering.tsx","../../../plugins/linear-comparative-view/src/LinearSyntenyDisplay/components/Component.tsx","../../../plugins/linear-comparative-view/src/LinearSyntenyDisplay/components/util.ts","../../../plugins/linear-comparative-view/src/LinearSyntenyDisplay/drawSynteny.ts"],"sourcesContent":["import React, { useMemo, useState } from 'react'\nimport { observer } from 'mobx-react'\nimport { Portal, alpha } from '@mui/material'\nimport { makeStyles } from 'tss-react/mui'\nimport { usePopper } from 'react-popper'\nimport { SanitizedHTML } from '@jbrowse/core/ui'\n\nfunction round(value: number) {\n  return Math.round(value * 1e5) / 1e5\n}\n\nconst useStyles = makeStyles()(theme => ({\n  // these styles come from\n  // https://github.com/mui-org/material-ui/blob/master/packages/material-ui/src/Tooltip/Tooltip.js\n  tooltip: {\n    position: 'absolute',\n    pointerEvents: 'none',\n    backgroundColor: alpha(theme.palette.grey[700], 0.9),\n    borderRadius: theme.shape.borderRadius,\n    color: theme.palette.common.white,\n    fontFamily: theme.typography.fontFamily,\n    padding: '4px 8px',\n    fontSize: theme.typography.pxToRem(12),\n    lineHeight: `${round(14 / 10)}em`,\n    maxWidth: 300,\n    wordWrap: 'break-word',\n  },\n}))\n\nconst SyntenyTooltip = observer(function ({\n  x,\n  y,\n  title,\n}: {\n  x: number\n  y: number\n  title: string\n}) {\n  const [width, setWidth] = useState(0)\n  const [anchorEl, setAnchorEl] = useState<HTMLDivElement | null>(null)\n  const { classes } = useStyles()\n\n  // must be memoized a la https://github.com/popperjs/react-popper/issues/391\n  const virtElement = useMemo(\n    () => ({\n      getBoundingClientRect: () => {\n        return {\n          top: y,\n          left: x + width / 2,\n          bottom: y,\n          right: x,\n          width: 0,\n          height: 0,\n          x,\n          y,\n          toJSON() {},\n        }\n      },\n    }),\n    [x, y, width],\n  )\n  const { styles, attributes } = usePopper(virtElement, anchorEl)\n\n  return title ? (\n    <Portal>\n      <div\n        ref={ref => {\n          setWidth(ref?.getBoundingClientRect().width || 0)\n          setAnchorEl(ref)\n        }}\n        className={classes.tooltip}\n        // zIndex needed to go over widget drawer\n        style={{ ...styles.popper, zIndex: 100000 }}\n        {...attributes.popper}\n      >\n        <SanitizedHTML html={title} />\n      </div>\n    </Portal>\n  ) : null\n})\n\nexport default SyntenyTooltip\n","import React, { useState, useCallback } from 'react'\nimport { observer } from 'mobx-react'\nimport {\n  assembleLocString,\n  getContainingView,\n  getSession,\n  isSessionModelWithWidgets,\n} from '@jbrowse/core/util'\n\n// locals\nimport SyntenyTooltip from './SyntenyTooltip'\nimport { LinearSyntenyDisplayModel } from '../model'\nimport { getId, MAX_COLOR_RANGE } from '../drawSynteny'\n\nexport default observer(function LinearSyntenyRendering({\n  model,\n}: {\n  model: LinearSyntenyDisplayModel\n}) {\n  const highResolutionScaling = 1\n  const view = getContainingView(model)\n  const height = view.middleComparativeHeight\n  const width = view.width\n\n  const [tooltip, setTooltip] = useState('')\n  const [currX, setCurrX] = useState<number>()\n  const [currY, setCurrY] = useState<number>()\n\n  // these useCallbacks avoid new refs from being created on any mouseover, etc.\n  const k1 = useCallback(\n    (ref: HTMLCanvasElement) => model.setMouseoverCanvasRef(ref),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [model, height, width],\n  )\n  const k2 = useCallback(\n    (ref: HTMLCanvasElement) => model.setMainCanvasRef(ref),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [model, height, width],\n  )\n  const k3 = useCallback(\n    (ref: HTMLCanvasElement) => model.setClickMapCanvasRef(ref),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [model, height, width],\n  )\n  const k4 = useCallback(\n    (ref: HTMLCanvasElement) => model.setCigarClickMapCanvasRef(ref),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [model, height, width],\n  )\n\n  return (\n    <div style={{ position: 'relative' }}>\n      <canvas\n        ref={k1}\n        width={width}\n        height={height}\n        style={{ width, height, position: 'absolute', pointerEvents: 'none' }}\n      />\n      <canvas\n        ref={k2}\n        onMouseMove={event => {\n          const ref1 = model.clickMapCanvas\n          const ref2 = model.cigarClickMapCanvas\n          if (!ref1 || !ref2) {\n            return\n          }\n          const rect = ref1.getBoundingClientRect()\n          const ctx1 = ref1.getContext('2d')\n          const ctx2 = ref2.getContext('2d')\n          if (!ctx1 || !ctx2) {\n            return\n          }\n          const { clientX, clientY } = event\n          const x = clientX - rect.left\n          const y = clientY - rect.top\n          setCurrX(clientX)\n          setCurrY(clientY)\n          const [r1, g1, b1] = ctx1.getImageData(x, y, 1, 1).data\n          const [r2, g2, b2] = ctx2.getImageData(x, y, 1, 1).data\n          const unitMultiplier = Math.floor(MAX_COLOR_RANGE / model.numFeats)\n          const id = getId(r1, g1, b1, unitMultiplier)\n          model.setMouseoverId(model.featPositions[id]?.f.id())\n          if (id === -1) {\n            setTooltip('')\n          } else if (model.featPositions[id]) {\n            const { f, cigar } = model.featPositions[id]\n            // @ts-expect-error\n            const f1 = f.toJSON() as {\n              refName: string\n              start: number\n              end: number\n              strand?: number\n              assemblyName: string\n              identity?: number\n              name?: string\n              mate: {\n                start: number\n                end: number\n                refName: string\n                name: string\n              }\n            }\n            const f2 = f1.mate\n            const unitMultiplier2 = Math.floor(MAX_COLOR_RANGE / cigar.length)\n            const cigarIdx = getId(r2, g2, b2, unitMultiplier2)\n            const l1 = f1.end - f1.start\n            const l2 = f2.end - f2.start\n            const identity = f1.identity\n            const n1 = f1.name\n            const n2 = f2.name\n            const tooltip = [\n              `Loc1: ${assembleLocString(f1)}`,\n              `Loc2: ${assembleLocString(f2)}`,\n              `Inverted: ${f1.strand === -1}`,\n              `Query len: ${l1}`,\n              `Target len: ${l2}`,\n            ]\n            if (identity) {\n              tooltip.push(`Identity: ${identity}`)\n            }\n\n            if (cigar[cigarIdx]) {\n              tooltip.push(\n                `CIGAR operator: ${cigar[cigarIdx]}${cigar[cigarIdx + 1]}`,\n              )\n            }\n            if (n1 && n2) {\n              tooltip.push(`Name 1: ${n1}`, `Name 2: ${n2}`)\n            }\n            setTooltip(tooltip.join('<br/>'))\n          }\n        }}\n        onMouseLeave={() => model.setMouseoverId(undefined)}\n        onClick={event => {\n          const ref1 = model.clickMapCanvas\n          const ref2 = model.cigarClickMapCanvas\n          if (!ref1 || !ref2) {\n            return\n          }\n          const rect = ref1.getBoundingClientRect()\n          const ctx1 = ref1.getContext('2d')\n          const ctx2 = ref2.getContext('2d')\n          if (!ctx1 || !ctx2) {\n            return\n          }\n          const x = event.clientX - rect.left\n          const y = event.clientY - rect.top\n          const [r1, g1, b1] = ctx1.getImageData(x, y, 1, 1).data\n          const unitMultiplier = Math.floor(MAX_COLOR_RANGE / model.numFeats)\n          const id = getId(r1, g1, b1, unitMultiplier)\n          const f = model.featPositions[id]\n          if (!f) {\n            return\n          }\n          model.setClickId(f.f.id())\n          const session = getSession(model)\n          if (isSessionModelWithWidgets(session)) {\n            session.showWidget(\n              session.addWidget('SyntenyFeatureWidget', 'syntenyFeature', {\n                featureData: {\n                  feature1: f.f.toJSON(),\n                  feature2: f.f.get('mate'),\n                },\n              }),\n            )\n          }\n        }}\n        data-testid=\"synteny_canvas\"\n        style={{ width, height, position: 'absolute' }}\n        width={width * highResolutionScaling}\n        height={height * highResolutionScaling}\n      />\n      <canvas\n        ref={k3}\n        style={{\n          imageRendering: 'pixelated',\n          pointerEvents: 'none',\n          visibility: 'hidden',\n          position: 'absolute',\n        }}\n        width={width}\n        height={height}\n      />\n      <canvas\n        ref={k4}\n        style={{\n          imageRendering: 'pixelated',\n          pointerEvents: 'none',\n          visibility: 'hidden',\n          position: 'absolute',\n        }}\n        width={width}\n        height={height}\n      />\n      {model.mouseoverId && tooltip && currX && currY ? (\n        <SyntenyTooltip x={currX} y={currY} title={tooltip} />\n      ) : null}\n    </div>\n  )\n})\n","import React, { useEffect, useState } from 'react'\nimport { makeStyles } from 'tss-react/mui'\nimport { observer } from 'mobx-react'\nimport { LoadingEllipses } from '@jbrowse/core/ui'\n\n// locals\nimport LinearSyntenyRendering from './LinearSyntenyRendering'\nimport { LinearSyntenyDisplayModel } from '../model'\n\nconst useStyles = makeStyles()(theme => {\n  const bg = theme.palette.action.disabledBackground\n  return {\n    loading: {\n      paddingLeft: '0.6em',\n      backgroundColor: theme.palette.background.default,\n      backgroundImage: `repeating-linear-gradient(45deg, transparent, transparent 5px, ${bg} 5px, ${bg} 10px)`,\n      textAlign: 'center',\n    },\n    blockMessage: {\n      background: '#f1f1f1',\n      padding: 10,\n    },\n    blockError: {\n      background: '#f1f1f1',\n      padding: 10,\n      color: 'red',\n    },\n  }\n})\n\nfunction LoadingMessage() {\n  // only show the loading message after 300ms to prevent excessive flickering\n  const [shown, setShown] = useState(false)\n  const { classes } = useStyles()\n  useEffect(() => {\n    const timeout = setTimeout(() => setShown(true), 300)\n    return () => clearTimeout(timeout)\n  })\n\n  return shown ? (\n    <div className={classes.loading}>\n      <LoadingEllipses />\n    </div>\n  ) : null\n}\n\nfunction BlockMessage({ messageText }: { messageText: string }) {\n  const { classes } = useStyles()\n  return <div className={classes.blockMessage}>{messageText}</div>\n}\n\nfunction BlockError({ error }: { error: unknown }) {\n  const { classes } = useStyles()\n  return <div className={classes.blockError}>{`${error}`}</div>\n}\n\nconst ServerSideRenderedBlockContent = observer(function ({\n  model,\n}: {\n  model: LinearSyntenyDisplayModel\n}) {\n  if (model.error) {\n    return <BlockError error={model.error} />\n  }\n  if (model.message) {\n    return <BlockMessage messageText={model.message} />\n  }\n  if (!model.features) {\n    return <LoadingMessage />\n  }\n\n  return <LinearSyntenyRendering model={model} />\n})\n\nexport default ServerSideRenderedBlockContent\n","import { doesIntersect2, Feature } from '@jbrowse/core/util'\n\ninterface Pos {\n  offsetPx: number\n}\n\ninterface FeatPos {\n  p11: Pos\n  p12: Pos\n  p21: Pos\n  p22: Pos\n  f: Feature\n  cigar: string[]\n}\n\nexport function drawMatchSimple({\n  feature,\n  ctx,\n  offsets,\n  cb,\n  height,\n  drawCurves,\n  oobLimit,\n  viewWidth,\n  hideTiny,\n}: {\n  feature: FeatPos\n  ctx: CanvasRenderingContext2D\n  offsets: number[]\n  oobLimit: number\n  viewWidth: number\n  cb: (ctx: CanvasRenderingContext2D) => void\n  height: number\n  drawCurves?: boolean\n  hideTiny?: boolean\n}) {\n  const { p11, p12, p21, p22 } = feature\n\n  const x11 = p11.offsetPx - offsets[0]\n  const x12 = p12.offsetPx - offsets[0]\n  const x21 = p21.offsetPx - offsets[1]\n  const x22 = p22.offsetPx - offsets[1]\n\n  const l1 = Math.abs(x12 - x11)\n  const l2 = Math.abs(x22 - x21)\n  const y1 = 0\n  const y2 = height\n  const mid = (y2 - y1) / 2\n  const minX = Math.min(x21, x22)\n  const maxX = Math.max(x21, x22)\n\n  if (!doesIntersect2(minX, maxX, -oobLimit, viewWidth + oobLimit)) {\n    return\n  }\n\n  // drawing a line if the results are thin: drawing a line results in much\n  // less pixellation than filling in a thin polygon\n  if (l1 <= 1 && l2 <= 1) {\n    // hideTiny can be used to avoid drawing mouseover for thin lines in this\n    // case\n    if (!hideTiny) {\n      ctx.beginPath()\n      ctx.moveTo(x11, y1)\n      if (drawCurves) {\n        ctx.bezierCurveTo(x11, mid, x21, mid, x21, y2)\n      } else {\n        ctx.lineTo(x21, y2)\n      }\n      ctx.stroke()\n    }\n  } else {\n    draw(ctx, x11, x12, y1, x22, x21, y2, mid, drawCurves)\n    cb(ctx)\n  }\n}\n\nexport function draw(\n  ctx: CanvasRenderingContext2D,\n  x1: number,\n  x2: number,\n  y1: number,\n  x3: number,\n  x4: number,\n  y2: number,\n  mid: number,\n  drawCurves?: boolean,\n) {\n  if (drawCurves) {\n    drawBezierBox(ctx, x1, x2, y1, x3, x4, y2, mid)\n  } else {\n    drawBox(ctx, x1, x2, y1, x3, x4, y2)\n  }\n}\n\nexport function drawBox(\n  ctx: CanvasRenderingContext2D,\n  x1: number,\n  x2: number,\n  y1: number,\n  x3: number,\n  x4: number,\n  y2: number,\n) {\n  ctx.beginPath()\n  ctx.moveTo(x1, y1)\n  ctx.lineTo(x2, y1)\n  ctx.lineTo(x3, y2)\n  ctx.lineTo(x4, y2)\n  ctx.closePath()\n  ctx.fill()\n}\n\nexport function drawBezierBox(\n  ctx: CanvasRenderingContext2D,\n  x1: number,\n  x2: number,\n  y1: number,\n  x3: number,\n  x4: number,\n  y2: number,\n  mid: number,\n) {\n  const len1 = Math.abs(x1 - x2)\n  const len2 = Math.abs(x1 - x2)\n\n  // heuristic to not draw hourglass inversions with bezier curves when they\n  // are thin and far apart because it results in areas that are not drawn well\n  // demo https://codesandbox.io/s/fast-glitter-q3b1or?file=/src/index.js\n  if (len1 < 5 && len2 < 5 && x2 < x1 && Math.abs(x1 - x3) > 100) {\n    const tmp = x1\n    x1 = x2\n    x2 = tmp\n  }\n  ctx.beginPath()\n  ctx.moveTo(x1, y1)\n  ctx.lineTo(x2, y1)\n  ctx.bezierCurveTo(x2, mid, x3, mid, x3, y2)\n  ctx.lineTo(x4, y2)\n  ctx.bezierCurveTo(x4, mid, x1, mid, x1, y1)\n  ctx.closePath()\n  ctx.fill()\n}\n","import { doesIntersect2, getContainingView } from '@jbrowse/core/util'\nimport { LinearSyntenyViewModel } from '../LinearSyntenyView/model'\nimport { LinearSyntenyDisplayModel } from './model'\nimport { draw, drawMatchSimple } from './components/util'\n\nexport const MAX_COLOR_RANGE = 255 * 255 * 255 // max color range\n\nfunction makeColor(idx: number) {\n  const r = Math.floor(idx / (255 * 255)) % 255\n  const g = Math.floor(idx / 255) % 255\n  const b = idx % 255\n  return `rgb(${r},${g},${b})`\n}\n\nconst colorMap = {\n  I: '#ff03',\n  N: '#0a03',\n  D: '#00f3',\n  X: 'brown',\n  M: '#f003',\n  '=': '#f003',\n}\n\nconst lineLimit = 3\n\nconst oobLimit = 1600\n\nexport function getId(r: number, g: number, b: number, unitMultiplier: number) {\n  return Math.floor((r * 255 * 255 + g * 255 + b - 1) / unitMultiplier)\n}\n\nexport function drawRef(\n  model: LinearSyntenyDisplayModel,\n  ctx1: CanvasRenderingContext2D,\n  ctx3?: CanvasRenderingContext2D,\n) {\n  const view = getContainingView(model) as LinearSyntenyViewModel\n  const drawCurves = view.drawCurves\n  const drawCIGAR = view.drawCIGAR\n  const height = view.middleComparativeHeight\n  const width = view.width\n  const bpPerPxs = view.views.map(v => v.bpPerPx)\n\n  if (ctx3) {\n    ctx3.imageSmoothingEnabled = false\n  }\n\n  ctx1.beginPath()\n  const featPos = model.featPositions\n  const offsets = view.views.map(v => v.offsetPx)\n\n  const unitMultiplier = Math.floor(MAX_COLOR_RANGE / featPos.length)\n\n  // this loop is optimized to draw many thin lines with a single ctx.stroke\n  // call, a separate loop below draws larger boxes\n  ctx1.fillStyle = colorMap.M\n  ctx1.strokeStyle = colorMap.M\n  for (let i = 0; i < featPos.length; i++) {\n    const { p11, p12, p21, p22 } = featPos[i]\n    const x11 = p11.offsetPx - offsets[0]\n    const x12 = p12.offsetPx - offsets[0]\n    const x21 = p21.offsetPx - offsets[1]\n    const x22 = p22.offsetPx - offsets[1]\n    const l1 = Math.abs(x12 - x11)\n    const l2 = Math.abs(x22 - x21)\n    const y1 = 0\n    const y2 = height\n    const mid = (y2 - y1) / 2\n\n    // drawing a line if the results are thin results in much less pixellation\n    // than filling in a thin polygon\n    if (\n      l1 <= lineLimit &&\n      l2 <= lineLimit &&\n      x21 < width + oobLimit &&\n      x21 > -oobLimit\n    ) {\n      ctx1.moveTo(x11, y1)\n      if (drawCurves) {\n        ctx1.bezierCurveTo(x11, mid, x21, mid, x21, y2)\n      } else {\n        ctx1.lineTo(x21, y2)\n      }\n    }\n  }\n  ctx1.stroke()\n\n  // this loop only draws small lines as a polyline, the polyline calls\n  // ctx.stroke once is much more efficient than calling stroke() many times\n  ctx1.fillStyle = colorMap.M\n  ctx1.strokeStyle = colorMap.M\n  for (let i = 0; i < featPos.length; i++) {\n    const { p11, p12, p21, p22, f, cigar } = featPos[i]\n    const x11 = p11.offsetPx - offsets[0]\n    const x12 = p12.offsetPx - offsets[0]\n    const x21 = p21.offsetPx - offsets[1]\n    const x22 = p22.offsetPx - offsets[1]\n    const l1 = Math.abs(x12 - x11)\n    const l2 = Math.abs(x22 - x21)\n    const minX = Math.min(x21, x22)\n    const maxX = Math.max(x21, x22)\n    const y1 = 0\n    const y2 = height\n    const mid = (y2 - y1) / 2\n\n    if (\n      !(l1 <= lineLimit && l2 <= lineLimit) &&\n      doesIntersect2(minX, maxX, -oobLimit, view.width + oobLimit)\n    ) {\n      const s1 = f.get('strand')\n      const k1 = s1 === -1 ? x12 : x11\n      const k2 = s1 === -1 ? x11 : x12\n\n      // rev1/rev2 flip the direction of the CIGAR drawing in horizontally flipped\n      // modes. somewhat heuristically determined, but tested for\n      const rev1 = k1 < k2 ? 1 : -1\n      const rev2 = (x21 < x22 ? 1 : -1) * s1\n\n      // cx1/cx2 are the current x positions on top and bottom rows\n      let cx1 = k1\n      let cx2 = s1 === -1 ? x22 : x21\n      if (cigar?.length && drawCIGAR) {\n        // continuingFlag skips drawing commands on very small CIGAR features\n        let continuingFlag = false\n\n        // px1/px2 are the previous x positions on the top and bottom rows\n        let px1 = 0\n        let px2 = 0\n        const unitMultiplier2 = Math.floor(MAX_COLOR_RANGE / cigar.length)\n        for (let j = 0; j < cigar.length; j += 2) {\n          const idx = j * unitMultiplier2 + 1\n\n          const len = +cigar[j]\n          const op = cigar[j + 1] as keyof typeof colorMap\n\n          if (!continuingFlag) {\n            px1 = cx1\n            px2 = cx2\n          }\n\n          const d1 = len / bpPerPxs[0]\n          const d2 = len / bpPerPxs[1]\n\n          if (op === 'M' || op === '=' || op === 'X') {\n            cx1 += d1 * rev1\n            cx2 += d2 * rev2\n          } else if (op === 'D' || op === 'N') {\n            cx1 += d1 * rev1\n          } else if (op === 'I') {\n            cx2 += d2 * rev2\n          }\n\n          // check that we are even drawing in view here, e.g. that all\n          // points are not all less than 0 or greater than width\n          if (\n            !(\n              Math.max(px1, px2, cx1, cx2) < 0 ||\n              Math.min(px1, px2, cx1, cx2) > width\n            )\n          ) {\n            // if it is a small feature and not the last element of the\n            // CIGAR (which could skip rendering it entire if we did turn\n            // it on), then turn on continuing flag\n            const isNotLast = j < cigar.length - 2\n            if (\n              Math.abs(cx1 - px1) <= 1 &&\n              Math.abs(cx2 - px2) <= 1 &&\n              isNotLast\n            ) {\n              continuingFlag = true\n            } else {\n              continuingFlag = false\n\n              // allow rendering the dominant color when using continuing\n              // flag if the last element of continuing was a large\n              // feature, else just use match\n              ctx1.fillStyle =\n                colorMap[(continuingFlag && d1 > 1) || d2 > 1 ? op : 'M']\n\n              draw(ctx1, px1, cx1, y1, cx2, px2, y2, mid, drawCurves)\n              if (ctx3) {\n                ctx3.fillStyle = makeColor(idx)\n                draw(ctx3, px1, cx1, y1, cx2, px2, y2, mid, drawCurves)\n              }\n            }\n          }\n        }\n      } else {\n        draw(ctx1, x11, x12, y1, x22, x21, y2, mid, drawCurves)\n      }\n    }\n  }\n\n  // draw click map\n  const ctx2 = model.clickMapCanvas?.getContext('2d')\n  if (!ctx2) {\n    return\n  }\n  ctx2.imageSmoothingEnabled = false\n  ctx2.clearRect(0, 0, width, height)\n  for (let i = 0; i < featPos.length; i++) {\n    const feature = featPos[i]\n    const idx = i * unitMultiplier + 1\n    ctx2.fillStyle = makeColor(idx)\n\n    // too many click map false positives with colored stroked lines\n    drawMatchSimple({\n      cb: ctx => ctx.fill(),\n      feature,\n      ctx: ctx2,\n      drawCurves,\n      offsets,\n      oobLimit,\n      viewWidth: view.width,\n      hideTiny: true,\n      height,\n    })\n  }\n}\n\nexport function drawMouseoverSynteny(model: LinearSyntenyDisplayModel) {\n  const { clickId, mouseoverId } = model\n  const highResolutionScaling = 1\n  const view = getContainingView(model) as LinearSyntenyViewModel\n  const drawCurves = view.drawCurves\n  const height = view.middleComparativeHeight\n  const width = view.width\n  const ctx = model.mouseoverCanvas?.getContext('2d')\n  const offsets = view.views.map(v => v.offsetPx)\n\n  if (!ctx) {\n    return\n  }\n  ctx.resetTransform()\n  ctx.scale(highResolutionScaling, highResolutionScaling)\n  ctx.clearRect(0, 0, width, height)\n  const feature1 = model.featMap[mouseoverId || '']\n  if (feature1) {\n    ctx.fillStyle = 'rgb(0,0,0,0.1)'\n    drawMatchSimple({\n      cb: ctx => ctx.fill(),\n      feature: feature1,\n      ctx,\n      oobLimit,\n      viewWidth: view.width,\n      drawCurves,\n      offsets,\n      height,\n    })\n  }\n  const feature2 = model.featMap[clickId || '']\n  if (feature2) {\n    ctx.strokeStyle = 'rgb(0, 0, 0, 0.9)'\n\n    drawMatchSimple({\n      cb: ctx => ctx.stroke(),\n      feature: feature2,\n      ctx,\n      oobLimit,\n      viewWidth: view.width,\n      drawCurves,\n      offsets,\n      height,\n    })\n  }\n}\n"],"names":["useStyles","makeStyles","theme","tooltip","position","pointerEvents","backgroundColor","alpha","palette","grey","borderRadius","shape","color","common","white","fontFamily","typography","padding","fontSize","pxToRem","lineHeight","concat","value","Math","round","maxWidth","wordWrap","observer","_ref","x","y","title","_useState","useState","_useState2","_slicedToArray","width","setWidth","_useState3","_useState4","anchorEl","setAnchorEl","classes","virtElement","useMemo","getBoundingClientRect","top","left","bottom","right","height","toJSON","_usePopper","usePopper","styles","attributes","_jsx","Portal","children","_objectSpread","ref","className","style","popper","zIndex","SanitizedHTML","html","model","view","getContainingView","middleComparativeHeight","setTooltip","currX","setCurrX","_useState5","_useState6","currY","setCurrY","k1","useCallback","setMouseoverCanvasRef","k2","setMainCanvasRef","k3","setClickMapCanvasRef","k4","setCigarClickMapCanvasRef","_jsxs","onMouseMove","event","_model$featPositions$","ref1","clickMapCanvas","ref2","cigarClickMapCanvas","rect","ctx1","getContext","ctx2","clientX","clientY","_ctx1$getImageData$da","getImageData","data","r1","g1","b1","_ctx2$getImageData$da","r2","g2","b2","unitMultiplier","floor","MAX_COLOR_RANGE","numFeats","id","getId","setMouseoverId","featPositions","f","_model$featPositions$2","cigar","f1","f2","mate","unitMultiplier2","length","cigarIdx","l1","end","start","l2","identity","n1","name","n2","assembleLocString","strand","push","join","onMouseLeave","undefined","onClick","_ctx1$getImageData$da2","setClickId","session","getSession","isSessionModelWithWidgets","showWidget","addWidget","featureData","feature1","feature2","get","imageRendering","visibility","mouseoverId","SyntenyTooltip","bg","action","disabledBackground","loading","paddingLeft","background","default","backgroundImage","textAlign","blockMessage","blockError","LoadingMessage","shown","setShown","useEffect","timeout","setTimeout","clearTimeout","LoadingEllipses","BlockMessage","messageText","BlockError","_ref2","error","_ref3","message","features","LinearSyntenyRendering","drawMatchSimple","feature","ctx","offsets","cb","drawCurves","oobLimit","viewWidth","hideTiny","p11","p12","p21","p22","x11","offsetPx","x12","x21","x22","abs","y2","mid","minX","min","maxX","max","doesIntersect2","beginPath","moveTo","bezierCurveTo","lineTo","stroke","draw","x1","x2","y1","x3","x4","len1","len2","tmp","closePath","fill","drawBezierBox","drawBox","makeColor","idx","r","g","b","colorMap","I","N","D","X","M","lineLimit","drawRef","ctx3","_model$clickMapCanvas","drawCIGAR","bpPerPxs","views","map","v","bpPerPx","imageSmoothingEnabled","featPos","fillStyle","strokeStyle","i","_featPos$i","_featPos$_i","s1","rev1","rev2","cx1","cx2","continuingFlag","px1","px2","j","len","op","d1","d2","isNotLast","clearRect","drawMouseoverSynteny","_model$mouseoverCanva","clickId","mouseoverCanvas","resetTransform","scale","featMap"],"sourceRoot":""}