"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[8377],{98377:function(e,n,t){t.r(n),t.d(n,{default:function(){return te}});var r=t(96234),o=t(30969),s=t(39712),i=t(53557),a=t(90550),c=t(90689),l=t(2374),d=t(87321),u=t.n(d),f=t(59594),h=t(22523),m=t.n(h),x=t(59802),v=t(58467),p=t(65629),j=t(70054),y=t(72243),g=t(78742),b=t(52849),w=t(69852),k=t(81073),Z=t(37574),C=(0,l.ZL)()((function(e){return{importFormContainer:{padding:e.spacing(4),margin:"0 auto"},assemblySelector:{width:"75%",margin:"0 auto"}}}));function P(e){return e?e.uri||e.localPath||e.name:void 0}var S=(0,a.observer)((function(e){var n=e.model,t=C().classes,s=(0,k.getSession)(n),a=s.assemblyNames,l=s.assemblyManager,d=(0,o.useState)(),u=(0,r.Z)(d,2),f=u[0],h=u[1],S=(0,o.useState)(),L=(0,r.Z)(S,2),N=L[0],M=L[1],A=(0,o.useState)(),B=(0,r.Z)(A,2),R=B[0],T=B[1],E=(0,o.useState)(a[0]),I=(0,r.Z)(E,2),z=I[0],D=I[1],F=(0,o.useState)(a[0]),H=(0,r.Z)(F,2),O=H[0],V=H[1],q=[O,z],W=(0,o.useState)(),X=(0,r.Z)(W,2),Y=X[0],J=X[1],_=(0,o.useState)(""),G=(0,r.Z)(_,2),$=G[0],Q=G[1],U=P(f),K=$||(U?m().extname(function(e){return e.endsWith(".gz")?e.slice(0,e.length-3):e}(U)):""),ee=a.length?q.map((function(e){var n;return null===(n=l.get(e))||void 0===n?void 0:n.error})).filter((function(e){return!!e})).join(", "):"No configured assemblies";function ne(){if(".paf"===K)return{type:"PAFAdapter",pafLocation:f,queryAssembly:O,targetAssembly:z};if(".out"===K)return{type:"MashMapAdapter",outLocation:f,queryAssembly:O,targetAssembly:z};if(".delta"===K)return{type:"DeltaAdapter",deltaLocation:f,queryAssembly:O,targetAssembly:z};if(".chain"===K)return{type:"ChainAdapter",chainLocation:f,queryAssembly:O,targetAssembly:z};if(".anchors"===K)return{type:"MCScanAnchorsAdapter",mcscanAnchorsLocation:f,bed1Location:R,bed2Location:N,assemblyNames:[O,z]};if(".anchors.simple"===K)return{type:"MCScanSimpleAnchorsAdapter",mcscanSimpleAnchorsLocation:f,bed1Location:R,bed2Location:N,assemblyNames:[O,z]};throw new Error("Unknown type")}var te=Y||ee;return(0,Z.jsxs)(x.Z,{className:t.importFormContainer,children:[te?(0,Z.jsx)(i.ErrorMessage,{error:te}):null,(0,Z.jsxs)(v.ZP,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",className:t.assemblySelector,children:[(0,Z.jsxs)(v.ZP,{item:!0,children:[(0,Z.jsxs)(p.Z,{style:{padding:12},children:[(0,Z.jsx)("p",{style:{textAlign:"center"},children:"Select assemblies for dotplot view"}),(0,Z.jsxs)(v.ZP,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",children:[(0,Z.jsxs)(v.ZP,{item:!0,children:[(0,Z.jsx)(j.Z,{children:".anchors"===$||".anchors.simple"===$?"Left column of anchors file":"Query"}),(0,Z.jsx)(i.AssemblySelector,{extra:0,selected:O,onChange:function(e){return V(e)},session:s})]}),(0,Z.jsxs)(v.ZP,{item:!0,children:[(0,Z.jsx)(j.Z,{children:".anchors"===$||".anchors.simple"===$?"Right column of anchors file":"Target"}),(0,Z.jsx)(i.AssemblySelector,{extra:1,selected:z,onChange:function(e){return D(e)},session:s})]})]})]}),(0,Z.jsxs)(p.Z,{style:{padding:12},children:[(0,Z.jsxs)(j.Z,{style:{textAlign:"center"},children:[(0,Z.jsx)("b",{children:"Optional"}),": Add a .paf, .out (MashMap), .delta (Mummer), .chain, .anchors or .anchors.simple (MCScan) file to view in the dotplot. These file types can also be gzipped. The first assembly should be the query sequence (e.g. left column of the PAF) and the second assembly should be the target sequence (e.g. right column of the PAF)"]}),(0,Z.jsx)(y.Z,{value:K,onChange:function(e){return Q(e.target.value)},children:(0,Z.jsxs)(v.ZP,{container:!0,justifyContent:"center",children:[(0,Z.jsx)(v.ZP,{item:!0,children:(0,Z.jsx)(g.Z,{value:".paf",control:(0,Z.jsx)(b.Z,{}),label:".paf"})}),(0,Z.jsx)(v.ZP,{item:!0,children:(0,Z.jsx)(g.Z,{value:".out",control:(0,Z.jsx)(b.Z,{}),label:".out"})}),(0,Z.jsx)(v.ZP,{item:!0,children:(0,Z.jsx)(g.Z,{value:".delta",control:(0,Z.jsx)(b.Z,{}),label:".delta"})}),(0,Z.jsx)(v.ZP,{item:!0,children:(0,Z.jsx)(g.Z,{value:".chain",control:(0,Z.jsx)(b.Z,{}),label:".chain"})}),(0,Z.jsx)(v.ZP,{item:!0,children:(0,Z.jsx)(g.Z,{value:".anchors",control:(0,Z.jsx)(b.Z,{}),label:".anchors"})}),(0,Z.jsx)(v.ZP,{item:!0,children:(0,Z.jsx)(g.Z,{value:".anchors.simple",control:(0,Z.jsx)(b.Z,{}),label:".anchors.simple"})})]})}),(0,Z.jsx)(v.ZP,{container:!0,justifyContent:"center",children:(0,Z.jsx)(v.ZP,{item:!0,children:".anchors"===$||".anchors.simple"===$?(0,Z.jsxs)("div",{children:[(0,Z.jsxs)("div",{style:{margin:20},children:["Open the ",$," and .bed files for both genome assemblies from the MCScan (Python verson) pipeline"," ",(0,Z.jsx)("a",{href:"https://github.com/tanghaibao/jcvi/wiki/MCscan-(Python-version)",children:"(more info)"})]}),(0,Z.jsxs)("div",{style:{display:"flex"},children:[(0,Z.jsx)("div",{children:(0,Z.jsx)(i.FileSelector,{name:".anchors file",description:"",location:f,setLocation:function(e){return h(e)}})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(i.FileSelector,{name:"genome 1 .bed (left column of anchors file)",description:"",location:R,setLocation:function(e){return T(e)}})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(i.FileSelector,{name:"genome 2 .bed (right column of anchors file)",description:"",location:N,setLocation:function(e){return M(e)}})})]})]}):(0,Z.jsx)(i.FileSelector,{name:$?$+" location":"",description:"",location:f,setLocation:function(e){return h(e)}})})})]})]}),(0,Z.jsx)(v.ZP,{item:!0,children:(0,Z.jsx)(w.Z,{"data-testid":"submitDotplot",onClick:function(){try{if(!(0,k.isSessionWithAddTracks)(s))return;(0,c.transaction)((function(){if(f){var e=m().basename(P(f))||"MyTrack",t="".concat(e,"-").concat(Date.now());s.addTrackConf({trackId:t,name:e,assemblyNames:[z,O],type:"SyntenyTrack",adapter:ne()}),n.toggleTrack(t)}n.setViews([{bpPerPx:.1,offsetPx:0},{bpPerPx:.1,offsetPx:0}]),n.setAssemblyNames(z,O)}))}catch(e){console.error(e),J(e)}},disabled:!!ee,variant:"contained",color:"primary",children:"Open"})})]})]})})),L=t(66581),N=t(90042),M=t(74424),A=t(16888),B=t(37973),R=t(33028),T=t(30878);function E(e){return(0,Z.jsx)(T.Z,(0,R.Z)((0,R.Z)({},e),{},{children:(0,Z.jsx)("path",{fill:"currentColor",d:"M13,6V11H18V7.75L22.25,12L18,16.25V13H13V18H16.25L12,22.25L7.75,18H11V13H6V16.25L1.75,12L6,7.75V11H11V6H7.75L12,1.75L16.25,6H13Z"})}))}function I(e){return(0,Z.jsx)(T.Z,(0,R.Z)((0,R.Z)({},e),{},{children:(0,Z.jsx)("path",{fill:"currentColor",d:"M10.07,14.27C10.57,14.03 11.16,14.25 11.4,14.75L13.7,19.74L15.5,18.89L13.19,13.91C12.95,13.41 13.17,12.81 13.67,12.58L13.95,12.5L16.25,12.05L8,5.12V15.9L9.82,14.43L10.07,14.27M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z"})}))}var z=t(22417),D=(0,o.lazy)((function(){return Promise.all([t.e(147),t.e(1817),t.e(7456),t.e(6271)]).then(t.bind(t,36271))})),F=(0,l.ZL)()({iconButton:{margin:5},bp:{display:"flex",alignItems:"center",marginLeft:10},spacer:{flexGrow:1},headerBar:{display:"flex"}}),H=(0,a.observer)((function(e){var n=e.model,t=F().classes,s=(0,o.useState)(null),a=(0,r.Z)(s,2),c=a[0],l=a[1],d=(0,o.useState)(null),u=(0,r.Z)(d,2),f=u[0],h=u[1];return(0,Z.jsxs)("div",{children:[(0,Z.jsx)(L.Z,{onClick:function(e){return h(e.currentTarget)},className:t.iconButton,color:"secondary",children:(0,Z.jsx)(I,{})}),(0,Z.jsx)(L.Z,{onClick:n.zoomOutButton,className:t.iconButton,color:"secondary",children:(0,Z.jsx)(M.Z,{})}),(0,Z.jsx)(L.Z,{onClick:n.zoomInButton,className:t.iconButton,title:"zoom in",color:"secondary",children:(0,Z.jsx)(A.Z,{})}),(0,Z.jsx)(L.Z,{onClick:n.activateTrackSelector,className:t.iconButton,title:"Open track selector","data-testid":"circular_track_select",color:"secondary",children:(0,Z.jsx)(z.GD,{})}),(0,Z.jsx)(L.Z,{onClick:function(e){return l(e.currentTarget)},className:t.iconButton,color:"secondary",children:(0,Z.jsx)(B.Z,{})}),c?(0,Z.jsx)(i.Menu,{anchorEl:c,open:!0,onMenuItemClick:function(e,n){n(),l(null)},menuItems:[{onClick:function(){return n.squareView()},label:"Square view - same base pairs per pixel"},{onClick:function(){return n.squareViewProportional()},label:"Rectanglular view - same total bp"},{onClick:function(){return n.setDrawCigar(!n.drawCigar)},type:"checkbox",label:"Draw CIGAR",checked:n.drawCigar}],onClose:function(){return l(null)}}):null,f?(0,Z.jsx)(i.Menu,{anchorEl:f,open:!0,onMenuItemClick:function(e,n){n(),h(null)},menuItems:[{onClick:function(){return n.setCursorMode("move")},label:"Cursor mode - click and drag to move",icon:E,type:"radio",checked:"move"===n.cursorMode},{onClick:function(){return n.setCursorMode("crosshair")},label:"Cursor mode - select region",type:"radio",checked:"crosshair"===n.cursorMode}],onClose:function(){return h(null)}}):null]})})),O=(0,a.observer)((function(e){var n=e.model.tracks.filter((function(e){var n;return null===(n=e.displays[0].warnings)||void 0===n?void 0:n.length})),t=(0,o.useState)(!1),s=(0,r.Z)(t,2),i=s[0],a=s[1];return n.length?(0,Z.jsxs)(N.Z,{severity:"warning",children:["Warnings during render"," ",(0,Z.jsx)(w.Z,{onClick:function(){return a(!0)},children:"More info"}),i?(0,Z.jsx)(D,{tracksWithWarnings:n,handleClose:function(){return a(!1)}}):null]}):null})),V=(0,a.observer)((function(e){var n=e.model,t=e.selection,r=F().classes,o=n.hview,s=n.vview;return(0,Z.jsxs)("div",{className:r.headerBar,children:[(0,Z.jsx)(H,{model:n}),(0,Z.jsxs)(j.Z,{className:r.bp,variant:"body2",color:"textSecondary",children:["x: ",o.assemblyNames.join(",")," ",(0,k.getBpDisplayStr)(o.currBp),(0,Z.jsx)("br",{}),"y: ",s.assemblyNames.join(",")," ",(0,k.getBpDisplayStr)(s.currBp)]}),t?(0,Z.jsxs)(j.Z,{className:r.bp,variant:"body2",color:"textSecondary",children:["width:".concat((0,k.getBpDisplayStr)(o.bpPerPx*t.width))," ",(0,Z.jsx)("br",{}),"height:".concat((0,k.getBpDisplayStr)(s.bpPerPx*t.height))]}):null,(0,Z.jsx)("div",{className:r.spacer}),(0,Z.jsx)(O,{model:n})]})}));var q=(0,a.observer)((function(e){var n,t,r=e.model,o=e.children,s=e.stroke,i=void 0===s?"#0003":s,a=r.viewWidth,c=r.viewHeight,l=r.hview,d=r.vview,u=l.dynamicBlocks.contentBlocks,f=d.dynamicBlocks.contentBlocks,h=l.displayedRegionsTotalPx-l.offsetPx,m=d.displayedRegionsTotalPx-d.offsetPx,x=(null===(n=u[0])||void 0===n?void 0:n.offsetPx)-l.offsetPx,v=(null===(t=f[0])||void 0===t?void 0:t.offsetPx)-d.offsetPx,p=Math.max(x,0),j=Math.max(c-m,0),y=Math.min(h-x,a),g=Math.min(m-v,c);return(0,Z.jsxs)("svg",{style:{background:"rgba(0,0,0,0.12)"},width:a,height:c,children:[(0,Z.jsx)("rect",{x:p,y:j,width:y,height:g,fill:"#fff"}),(0,Z.jsxs)("g",{children:[u.map((function(e){var n=e.offsetPx-l.offsetPx;return(0,Z.jsx)("line",{x1:n,y1:0,x2:n,y2:c,stroke:i},JSON.stringify(e))})),f.map((function(e){var n=c-(e.offsetPx-d.offsetPx);return(0,Z.jsx)("line",{x1:0,y1:n,x2:a,y2:n,stroke:i},JSON.stringify(e))})),(0,Z.jsx)("line",{x1:h,y1:0,x2:h,y2:c,stroke:i}),(0,Z.jsx)("line",{x1:0,y1:c-m,x2:a,y2:c-m,stroke:i})]}),o]})})),W=t(40909),X=t(68554),Y=(0,l.ZL)()((function(){return{vtext:{gridColumn:"1/2",gridRow:"1/2",pointerEvents:"none",userSelect:"none"},htext:{gridColumn:"2/2",gridRow:"2/2",pointerEvents:"none",userSelect:"none"},majorTickLabel:{fontSize:"11px"},majorTick:{stroke:"#555"},minorTick:{stroke:"#999"}}})),J=(0,a.observer)((function(e){var n=e.model,t=Y().classes,r=n.viewWidth,o=n.borderX,s=n.borderY,i=n.hview,a=n.htextRotation,c=n.hticks,l=i.offsetPx,d=i.width,u=i.dynamicBlocks,h=i.bpPerPx,m=u.contentBlocks,x=(0,f.F$)(m,r,l),v=(0,R.Z)((0,R.Z)({},(0,W.getSnapshot)(i)),{},{width:d,staticBlocks:i.staticBlocks});return(0,Z.jsxs)("svg",{width:r,height:s,className:t.htext,children:[m.filter((function(e){return!x.includes(e.key)})).map((function(e){var n=e.offsetPx-i.offsetPx;return(0,Z.jsx)("text",{transform:"rotate(".concat(a,",").concat(n,",").concat(0,")"),x:n,y:1,fill:"#000000",dominantBaseline:"hanging",textAnchor:"end",children:[e.refName,0!==e.start?Math.floor(e.start):""].filter((function(e){return!!e})).join(":")},JSON.stringify(e))})),c.map((function(e){var n,r=((null===(n=(0,X.R)({refName:e.refName,coord:e.base,self:v}))||void 0===n?void 0:n.offsetPx)||0)-l;return(0,Z.jsx)("line",{x1:r,x2:r,y1:0,y2:"major"===e.type?6:4,strokeWidth:1,stroke:"major"===e.type?"#555":"#999",className:"major"===e.type?t.majorTick:t.minorTick,"data-bp":e.base},"line-".concat(JSON.stringify(e)))})),c.filter((function(e){return"major"===e.type})).map((function(e){var n,r=((null===(n=(0,X.R)({refName:e.refName,coord:e.base,self:v}))||void 0===n?void 0:n.offsetPx)||0)-l;return(0,Z.jsx)("text",{x:r-7,y:0,transform:"rotate(".concat(a,",").concat(r,",").concat(0,")"),style:{fontSize:"11px"},className:t.majorTickLabel,dominantBaseline:"middle",textAnchor:"end",children:(0,k.getTickDisplayStr)(e.base+1,h)},"text-".concat(JSON.stringify(e)))})),1===i.assemblyNames.length?(0,Z.jsx)("text",{y:s-12,x:(r-o)/2,fill:"black",textAnchor:"middle",children:i.assemblyNames[0]}):null]})})),_=(0,a.observer)((function(e){var n=e.model,t=Y().classes,r=n.borderX,o=n.viewHeight,s=n.borderY,i=n.vview,a=n.vtextRotation,c=n.vticks,l=i.offsetPx,d=i.width,u=i.dynamicBlocks,h=i.bpPerPx,m=u.contentBlocks,x=(0,f.F$)(m,o,l),v=(0,R.Z)((0,R.Z)({},(0,W.getSnapshot)(i)),{},{width:d,staticBlocks:i.staticBlocks});return(0,Z.jsxs)("svg",{className:t.vtext,width:r,height:o,children:[m.filter((function(e){return!x.includes(e.key)})).map((function(e){var n=e.offsetPx,t=r;return(0,Z.jsx)("text",{transform:"rotate(".concat(a,",").concat(t,",").concat(n,")"),x:t,y:o-n+l,fill:"#000000",textAnchor:"end",children:[e.refName,0!==e.start?Math.floor(e.start):""].filter((function(e){return!!e})).join(":")},JSON.stringify(e))})),c.map((function(e){var n,s=((null===(n=(0,X.R)({refName:e.refName,coord:e.base,self:v}))||void 0===n?void 0:n.offsetPx)||0)-l;return(0,Z.jsx)("line",{y1:o-s,y2:o-s,x1:r,x2:r-("major"===e.type?6:4),strokeWidth:1,stroke:"major"===e.type?"#555":"#999",className:"major"===e.type?t.majorTick:t.minorTick,"data-bp":e.base},"line-".concat(JSON.stringify(e)))})),c.filter((function(e){return"major"===e.type})).map((function(e){var n,s=((null===(n=(0,X.R)({refName:e.refName,coord:e.base,self:v}))||void 0===n?void 0:n.offsetPx)||0)-l;return(0,Z.jsx)("text",{y:o-s-3,x:r-7,textAnchor:"end",dominantBaseline:"hanging",style:{fontSize:"11px"},className:t.majorTickLabel,children:(0,k.getTickDisplayStr)(e.base+1,h)},"text-".concat(JSON.stringify(e)))})),1===i.assemblyNames.length?(0,Z.jsx)("text",{y:(o-s)/2,x:12,transform:"rotate(-90,12,".concat((o-s)/2,")"),textAnchor:"middle",children:i.assemblyNames[0]}):null]})})),G={left:0,top:0,width:0,height:0},$=(0,l.ZL)()((function(e){return{spacer:{gridColumn:"1/2",gridRow:"2/2"},root:{position:"relative",marginBottom:e.spacing(1),overflow:"hidden"},container:{display:"grid",padding:5,position:"relative"},overlay:{pointerEvents:"none",overflow:"hidden",display:"flex",width:"100%",gridRow:"1/2",gridColumn:"2/2",zIndex:100,"& path":{cursor:"crosshair",fill:"none"}},content:{position:"relative",gridColumn:"2/2",gridRow:"1/2"},popover:{background:"#fff",maxWidth:400,wordBreak:"break-all",zIndex:1e3,border:"1px solid black",pointerEvents:"none",position:"absolute"}}}));function Q(e,n){return e&&[e[0]-n.left,e[1]-n.top]}var U=(0,a.observer)((function(e){var n=e.model,t=$().classes;return(0,Z.jsx)("div",{className:t.overlay,children:n.tracks.map((function(e){var n=(0,r.Z)(e.displays,1)[0],t=n.RenderingComponent;return t?(0,Z.jsx)(t,{model:n},e.configuration.trackId):null}))})})),K=(0,a.observer)((function(e){var n,t=e.model,r=e.mouserect,s=e.xdistance,i=e.ydistance,a=$().classes,c=t.hview,l=t.vview,d=t.viewHeight,u=(0,o.useRef)(null),h=(null===(n=u.current)||void 0===n?void 0:n.getBoundingClientRect())||G;return(0,Z.jsx)(Z.Fragment,{children:r?(0,Z.jsxs)("div",{ref:u,className:a.popover,style:{left:6+r[0]-(s<0?h.width+12:0),top:6+r[1]-(i<0?h.height+12:0)},children:["x - ".concat((0,f.c4)(r[0],c)),(0,Z.jsx)("br",{}),"y - ".concat((0,f.c4)(d-r[1],l)),(0,Z.jsx)("br",{})]}):null})})),ee=(0,a.observer)((function(e){var n,t=e.model,r=e.mousedown,s=e.xdistance,i=e.ydistance,a=$().classes,c=t.hview,l=t.vview,d=t.viewHeight,u=(0,o.useRef)(null),h=(null===(n=u.current)||void 0===n?void 0:n.getBoundingClientRect())||G;return(0,Z.jsx)(Z.Fragment,{children:r&&Math.abs(s)>3&&Math.abs(i)>3?(0,Z.jsxs)("div",{ref:u,className:a.popover,style:{left:r[0]-(s<0?0:h.width),top:r[1]-(i<0?0:h.height)},children:["x - ".concat((0,f.c4)(r[0],c)),(0,Z.jsx)("br",{}),"y - ".concat((0,f.c4)(d-r[1],l)),(0,Z.jsx)("br",{})]}):null})})),ne=(0,a.observer)((function(e){var n,t=e.model,s=t.cursorMode,a=$().classes,l=(0,o.useState)(),d=(0,r.Z)(l,2),f=d[0],h=d[1],m=(0,o.useState)(),x=(0,r.Z)(m,2),v=x[0],p=x[1],j=(0,o.useState)(!1),y=(0,r.Z)(j,2),g=y[0],b=y[1],w=(0,o.useState)(),k=(0,r.Z)(w,2),C=k[0],P=k[1],S=(0,o.useRef)(null),L=(0,o.useRef)(null),N=(0,o.useRef)(0),M=(0,o.useRef)(0),A=(0,o.useRef)(!1),B=(null===(n=S.current)||void 0===n?void 0:n.getBoundingClientRect())||G,R=Q(v,B),T=Q(f,B),E=Q(C,B),I=E||T,z=R&&I?I[0]-R[0]:0,D=R&&I?I[1]-R[1]:0;return(0,o.useEffect)((function(){function e(e){var n=u()(e);e.preventDefault(),N.current+=n.pixelX,M.current-=n.pixelY,A.current||(A.current=!0,window.requestAnimationFrame((function(){(0,c.transaction)((function(){t.hview.scroll(N.current),t.vview.scroll(M.current)})),A.current=!1,N.current=0,M.current=0})))}if(S.current){var n=S.current;return n.addEventListener("wheel",e),function(){return n.removeEventListener("wheel",e)}}return function(){}}),[t.hview,t.vview]),(0,o.useEffect)((function(){function e(e){h([e.clientX,e.clientY]),f&&v&&"move"===s&&(t.hview.scroll(-e.clientX+f[0]),t.vview.scroll(e.clientY-f[1]))}return window.addEventListener("mousemove",e),function(){return window.removeEventListener("mousemove",e)}}),[f,v,s,t.hview,t.vview]),(0,o.useEffect)((function(){var e=function(){};function n(e){Math.abs(z)>3&&Math.abs(D)>3&&"crosshair"===s?P([e.clientX,e.clientY]):p(void 0)}return R&&!E&&(window.addEventListener("mouseup",n,!0),e=function(){return window.removeEventListener("mouseup",n,!0)}),e}),[R,T,E,z,D,s]),(0,Z.jsxs)("div",{children:[(0,Z.jsx)(V,{model:t,selection:"move"!==s&&R&&I?{width:Math.abs(z),height:Math.abs(D)}:void 0}),(0,Z.jsxs)("div",{ref:L,className:a.root,onMouseLeave:function(){return b(!1)},onMouseEnter:function(){return b(!0)},children:[(0,Z.jsxs)("div",{className:a.container,style:{transform:"scaleX(".concat(t.hview.scaleFactor,") scaleY(").concat(t.vview.scaleFactor,")")},children:[(0,Z.jsx)(_,{model:t}),(0,Z.jsx)(J,{model:t}),(0,Z.jsxs)("div",{ref:S,className:a.content,children:[g&&"crosshair"===s?(0,Z.jsx)(K,{model:t,mouserect:I,xdistance:z,ydistance:D}):null,"crosshair"===s?(0,Z.jsx)(ee,{model:t,mousedown:R,xdistance:z,ydistance:D}):null,(0,Z.jsx)("div",{style:{cursor:s},onMouseDown:function(e){0===e.button&&(p([e.clientX,e.clientY]),h([e.clientX,e.clientY]))},children:(0,Z.jsx)(q,{model:t,children:"crosshair"===s&&R&&I?(0,Z.jsx)("rect",{fill:"rgba(255,0,0,0.3)",x:Math.min(I[0],R[0]),y:Math.min(I[1],R[1]),width:Math.abs(z),height:Math.abs(D)}):null})}),(0,Z.jsx)("div",{className:a.spacer})]}),(0,Z.jsx)(U,{model:t}),(0,Z.jsx)(i.Menu,{open:Boolean(E),onMenuItemClick:function(e,n){n(),P(void 0),p(void 0)},onClose:function(){P(void 0),p(void 0)},anchorReference:"anchorPosition",anchorPosition:C?{top:C[1]+30,left:C[0]+30}:void 0,style:{zIndex:1e4},menuItems:[{label:"Zoom in",onClick:function(){R&&E&&t.zoomIn(R,E)}},{label:"Open linear synteny view",onClick:function(){R&&E&&t.onDotplotView(R,E)}}]})]}),(0,Z.jsx)(i.ResizeHandle,{onDrag:function(e){return t.setHeight(t.height+e)},style:{height:4,background:"#ccc",boxSizing:"border-box",borderTop:"1px solid #fafafa"}})]})]})})),te=(0,a.observer)((function(e){var n=e.model,t=n.initialized,r=n.loading,o=n.error;return!t&&!r||o?(0,Z.jsx)(S,{model:n}):r?(0,Z.jsxs)("div",{children:[(0,Z.jsx)("p",{children:"Loading..."}),(0,Z.jsx)(s.Z,{})]}):(0,Z.jsx)(ne,{model:n})}))}}]);
//# sourceMappingURL=8377.84b00dc4.chunk.js.map