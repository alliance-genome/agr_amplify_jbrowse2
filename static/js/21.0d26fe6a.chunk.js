(this["webpackJsonp@jbrowse/web"]=this["webpackJsonp@jbrowse/web"]||[]).push([[21],{1592:function(e,t,n){"use strict";var r=n(946);n.d(t,"a",(function(){return r.a}))},259:function(e,t,n){"use strict";function r(e){return r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o=n(99).Buffer,s=n(356),i=n(357).Context,a=n(211);"undefined"!==typeof window&&(window.Buffer=o),"undefined"!==typeof self&&(self.Buffer=o);var f={UInt8:1,UInt16LE:2,UInt16BE:2,UInt32LE:4,UInt32BE:4,Int8:1,Int16LE:2,Int16BE:2,Int32LE:4,Int32BE:4,FloatLE:4,FloatBE:4,DoubleLE:8,DoubleBE:8,UInt64:8,Int64:8},u={},c="___parser_",p=[];!function(){var e;for(e=1;e<=32;e++)p.push(e)}();var h={};Object.keys(f).concat(Object.keys({String:null,Buffer:null,Array:null,Skip:null,Choice:null,Nest:null,Bit:null,Itf8:null,Ltf8:null})).forEach((function(e){h[e.toLowerCase()]=e}));var l=function(){this.varName="",this.type="",this.options={},this.next=null,this.head=null,this.compiled=null,this.endian="le",this.constructorFn=null,this.alias=null};l.start=function(){return new l},Object.keys(f).forEach((function(e){l.prototype[e.toLowerCase()]=function(t,n){return this.setNextParser(e.toLowerCase(),t,n)};var t=e.replace(/BE|LE/,"").toLowerCase();t in l.prototype||(l.prototype[t]=function(e,n){return this[t+this.endian](e,n)})})),p.forEach((function(e){l.prototype["bit".concat(e.toString())]=function(t,n){return n||(n={}),n.length=e,this.setNextParser("bit",t,n)}})),l.prototype.namely=function(e){return u[e]=this,this.alias=e,this},l.prototype.skip=function(e,t){if(t&&t.assert)throw new Error("assert option on skip is not allowed.");return this.setNextParser("skip","",{length:e})},l.prototype.string=function(e,t){if(!t.zeroTerminated&&!t.length&&!t.greedy)throw new Error("Neither length, zeroTerminated, nor greedy is defined for string.");if((t.zeroTerminated||t.length)&&t.greedy)throw new Error("greedy is mutually exclusive with length and zeroTerminated for string.");if(t.stripNull&&!t.length&&!t.greedy)throw new Error("Length or greedy must be defined if stripNull is defined.");return t.encoding=t.encoding||"utf8",this.setNextParser("string",e,t)},l.prototype.buffer=function(e,t){if(!t.length&&!t.readUntil)throw new Error("Length nor readUntil is defined in buffer parser");return this.setNextParser("buffer",e,t)},l.prototype.array=function(e,t){if(!t.readUntil&&!t.length&&!t.lengthInBytes)throw new Error("Length option of array is not defined.");if(!t.type)throw new Error("Type option of array is not defined.");if("string"===typeof t.type&&!u[t.type]&&Object.keys(f).indexOf(h[t.type])<0)throw new Error('Specified primitive type "'.concat(t.type,'" is not supported.'));return this.setNextParser("array",e,t)},l.prototype.choice=function(e,t){if(1===arguments.length&&"object"===r(e)&&(t=e,e=null),!t.tag)throw new Error("Tag option of array is not defined.");if(!t.choices)throw new Error("Choices option of array is not defined.");return Object.keys(t.choices).forEach((function(n){if(!t.choices[n])throw new Error("Choice Case ".concat(n," of ").concat(e," is not valid."));if("string"===typeof t.choices[n]&&!u[t.choices[n]]&&Object.keys(f).indexOf(h[t.choices[n]])<0)throw new Error('Specified primitive type "'.concat(t.choices[n],'" is not supported.'))}),this),this.setNextParser("choice",e,t)},l.prototype.nest=function(e,t){if(1===arguments.length&&"object"===r(e)&&(t=e,e=null),!t.type)throw new Error("Type option of nest is not defined.");if(!(t.type instanceof l)&&!u[t.type])throw new Error("Type option of nest must be a Parser object.");if(!(t.type instanceof l)&&!e)throw new Error("options.type must be a object if variable name is omitted.");return this.setNextParser("nest",e,t)},l.prototype.endianess=function(e){switch(e.toLowerCase()){case"little":this.endian="le";break;case"big":this.endian="be";break;default:throw new Error("Invalid endianess: ".concat(e))}return this},l.prototype.create=function(e){if(!(e instanceof Function))throw new Error("Constructor must be a Function object.");return this.constructorFn=e,this},l.prototype.getCode=function(){var e=new i;return e.pushCode("if (!Buffer.isBuffer(buffer)) {"),e.generateError('"argument buffer is not a Buffer object"'),e.pushCode("}"),this.alias?this.addAliasedCode(e):this.addRawCode(e),this.alias?e.pushCode("return {0}(0)",c+this.alias):e.pushCode("return { offset: offset, result: vars };"),e.code},l.prototype.addRawCode=function(e){e.pushCode("var offset = 0;"),this.constructorFn?e.pushCode("var vars = new constructorFn();"):e.pushCode("var vars = {};"),this.generate(e),this.resolveReferences(e),e.pushCode("return { offset: offset, result: vars };")},l.prototype.addAliasedCode=function(e){return e.pushCode("function {0}(offset) {",c+this.alias),this.constructorFn?e.pushCode("var vars = new constructorFn();"):e.pushCode("var vars = {};"),this.generate(e),e.markResolved(this.alias),this.resolveReferences(e),e.pushCode("return { offset: offset, result: vars };"),e.pushCode("}"),e},l.prototype.resolveReferences=function(e){var t=e.getUnresolvedReferences();e.markRequested(t),t.forEach((function(t){u[t].addAliasedCode(e)}))},l.prototype.compile=function(){var e="(function(buffer, constructorFn, Long) { ".concat(this.getCode()," })");this.compiled=s.runInThisContext(e)},l.prototype.sizeOf=function(){var e=NaN;if(Object.keys(f).indexOf(this.type)>=0)e=f[this.type];else if("String"===this.type&&"number"===typeof this.options.length)e=this.options.length;else if("Buffer"===this.type&&"number"===typeof this.options.length)e=this.options.length;else if("Array"===this.type&&"number"===typeof this.options.length){var t=NaN;"string"===typeof this.options.type?t=f[h[this.options.type]]:this.options.type instanceof l&&(t=this.options.type.sizeOf()),e=this.options.length*t}else"Skip"===this.type?e=this.options.length:"Nest"===this.type?e=this.options.type.sizeOf():this.type||(e=0);return this.next&&(e+=this.next.sizeOf()),e},l.prototype.parse=function(e){return this.compiled||this.compile(),this.compiled(e,this.constructorFn,a)},l.prototype.setNextParser=function(e,t,n){var r=new l;return r.type=h[e],r.varName=t,r.options=n||r.options,r.endian=this.endian,this.head?this.head.next=r:this.next=r,this.head=r,this},l.prototype.generate=function(e){this.type&&(this["generate".concat(this.type)](e),this.generateAssert(e));var t=e.generateVariable(this.varName);return this.options.formatter&&this.generateFormatter(e,t,this.options.formatter),this.generateNext(e)},l.prototype.generateAssert=function(e){if(this.options.assert){var t=e.generateVariable(this.varName);switch(r(this.options.assert)){case"function":e.pushCode("if (!({0}).call(vars, {1})) {",this.options.assert,t);break;case"number":e.pushCode("if ({0} !== {1}) {",this.options.assert,t);break;case"string":e.pushCode('if ("{0}" !== {1}) {',this.options.assert,t);break;default:throw new Error("Assert option supports only strings, numbers and assert functions.")}e.generateError('"Assert error: {0} is " + {0}',t),e.pushCode("}")}},l.prototype.generateNext=function(e){return this.next&&(e=this.next.generate(e)),e},Object.keys(f).forEach((function(e){l.prototype["generate".concat(e)]=function(t){"UInt64"===e?t.pushCode("{0} = Long.fromBytes(buffer.slice(offset,offset+8), true, this.endian === 'le').toNumber();",t.generateVariable(this.varName),e):"Int64"===e?t.pushCode("{0} = Long.fromBytes(buffer.slice(offset,offset+8), false, this.endian === 'le').toNumber();",t.generateVariable(this.varName),e):t.pushCode("{0} = buffer.read{1}(offset);",t.generateVariable(this.varName),e),t.pushCode("offset += {0};",f[e])}})),l.prototype.generateBit=function(e){var t=JSON.parse(JSON.stringify(this));if(t.varName=e.generateVariable(t.varName),e.bitFields.push(t),!this.next||this.next&&["Bit","Nest"].indexOf(this.next.type)<0){var n=0;e.bitFields.forEach((function(e){n+=e.options.length}));var r=e.generateTmpVariable();if(n<=8)e.pushCode("var {0} = buffer.readUInt8(offset);",r),n=8;else if(n<=16)e.pushCode("var {0} = buffer.readUInt16BE(offset);",r),n=16;else if(n<=24){var o=e.generateTmpVariable(),s=e.generateTmpVariable();e.pushCode("var {0} = buffer.readUInt16BE(offset);",o),e.pushCode("var {0} = buffer.readUInt8(offset + 2);",s),e.pushCode("var {2} = ({0} << 8) | {1};",o,s,r),n=24}else{if(!(n<=32))throw new Error("Currently, bit field sequence longer than 4-bytes is not supported.");e.pushCode("var {0} = buffer.readUInt32BE(offset);",r),n=32}e.pushCode("offset += {0};",n/8);var i=0,a="be"===this.endian;e.bitFields.forEach((function(t){e.pushCode("{0} = {1} >> {2} & {3};",t.varName,r,a?n-i-t.options.length:i,(1<<t.options.length)-1),i+=t.options.length})),e.bitFields=[]}},l.prototype.generateSkip=function(e){var t=e.generateOption(this.options.length);e.pushCode("offset += {0};",t)},l.prototype.generateString=function(e){var t=e.generateVariable(this.varName),n=e.generateTmpVariable();this.options.length&&this.options.zeroTerminated?(e.pushCode("var {0} = offset;",n),e.pushCode("while(buffer.readUInt8(offset++) !== 0 && offset - {0}  < {1});",n,this.options.length),e.pushCode("{0} = buffer.toString('{1}', {2}, offset - {2} < {3} ? offset - 1 : offset);",t,this.options.encoding,n,this.options.length)):this.options.length?(e.pushCode("{0} = buffer.toString('{1}', offset, offset + {2});",t,this.options.encoding,e.generateOption(this.options.length)),e.pushCode("offset += {0};",e.generateOption(this.options.length))):this.options.zeroTerminated?(e.pushCode("var {0} = offset;",n),e.pushCode("while(buffer.readUInt8(offset++) !== 0);"),e.pushCode("{0} = buffer.toString('{1}', {2}, offset - 1);",t,this.options.encoding,n)):this.options.greedy&&(e.pushCode("var {0} = offset;",n),e.pushCode("while(buffer.length > offset++);"),e.pushCode("{0} = buffer.toString('{1}', {2}, offset);",t,this.options.encoding,n)),this.options.stripNull&&e.pushCode("{0} = {0}.replace(/\\x00+$/g, '')",t)},l.prototype.generateBuffer=function(e){"eof"===this.options.readUntil?e.pushCode("{0} = buffer.slice(offset);",e.generateVariable(this.varName)):(e.pushCode("{0} = buffer.slice(offset, offset + {1});",e.generateVariable(this.varName),e.generateOption(this.options.length)),e.pushCode("offset += {0};",e.generateOption(this.options.length))),this.options.clone&&e.pushCode("{0} = Buffer.from({0});",e.generateVariable(this.varName))},l.prototype.generateArray=function(e){var t=e.generateOption(this.options.length),n=e.generateOption(this.options.lengthInBytes),r=this.options.type,o=e.generateTmpVariable(),s=e.generateVariable(this.varName),i=e.generateTmpVariable(),a=this.options.key,p="string"===typeof a;if(p?e.pushCode("{0} = {};",s):e.pushCode("{0} = [];",s),"function"===typeof this.options.readUntil?e.pushCode("do {"):"eof"===this.options.readUntil?e.pushCode("for (var {0} = 0; offset < buffer.length; {0}++) {",o):void 0!==n?e.pushCode("for (var {0} = offset; offset - {0} < {1}; ) {",o,n):e.pushCode("for (var {0} = 0; {0} < {1}; {0}++) {",o,t),"string"===typeof r)if(u[r]){var d=e.generateTmpVariable();e.pushCode("var {0} = {1}(offset);",d,c+r),e.pushCode("var {0} = {1}.result; offset = {1}.offset;",i,d),r!==this.alias&&e.addReference(r)}else e.pushCode("var {0} = buffer.read{1}(offset);",i,h[r]),e.pushCode("offset += {0};",f[h[r]]);else r instanceof l&&(e.pushCode("var {0} = {};",i),e.pushScope(i),r.generate(e),e.popScope());p?e.pushCode("{0}[{2}.{1}] = {2};",s,a,i):e.pushCode("{0}.push({1});",s,i),e.pushCode("}"),"function"===typeof this.options.readUntil&&e.pushCode(" while (!({0}).call(this, {1}, buffer.slice(offset)));",this.options.readUntil,i)},l.prototype.generateChoiceCase=function(e,t,n){if("string"===typeof n)if(u[n]){var r=e.generateTmpVariable();e.pushCode("var {0} = {1}(offset);",r,c+n),e.pushCode("{0} = {1}.result; offset = {1}.offset;",e.generateVariable(this.varName),r),n!==this.alias&&e.addReference(n)}else e.pushCode("{0} = buffer.read{1}(offset);",e.generateVariable(this.varName),h[n]),e.pushCode("offset += {0};",f[h[n]]);else n instanceof l&&(e.pushPath(t),n.generate(e),e.popPath(t))},l.prototype.generateChoice=function(e){var t=e.generateOption(this.options.tag);this.varName&&e.pushCode("{0} = {};",e.generateVariable(this.varName)),e.pushCode("switch({0}) {",t),Object.keys(this.options.choices).forEach((function(t){var n=this.options.choices[t];Number.isNaN(parseInt(t,10))?e.pushCode("case '{0}':",t):e.pushCode("case {0}:",t),this.generateChoiceCase(e,this.varName,n),e.pushCode("break;")}),this),e.pushCode("default:"),this.options.defaultChoice?this.generateChoiceCase(e,this.varName,this.options.defaultChoice):e.generateError('"Met undefined tag value " + {0} + " at choice"',t),e.pushCode("}")},l.prototype.generateNest=function(e){var t=e.generateVariable(this.varName);if(this.options.type instanceof l)this.varName&&e.pushCode("{0} = {};",t),e.pushPath(this.varName),this.options.type.generate(e),e.popPath(this.varName);else if(u[this.options.type]){var n=e.generateTmpVariable();e.pushCode("var {0} = {1}(offset);",n,c+this.options.type),e.pushCode("{0} = {1}.result; offset = {1}.offset;",t,n),this.options.type!==this.alias&&e.addReference(this.options.type)}},l.prototype.generateFormatter=function(e,t,n){"function"===typeof n&&e.pushCode("{0} = ({1}).call(this, {0});",t,n)},l.prototype.isInteger=function(){return!!this.type.match(/U?Int[8|16|32][BE|LE]?|Bit\d+/)},l.prototype.itf8=function(e,t){return this.setNextParser("itf8",e,t)},l.prototype.itf8=function(e,t){return this.setNextParser("itf8",e,t)},l.prototype.generateItf8=function(e){var t=e.generateVariable(this.varName),n=e.generateTmpVariable();e.pushCode("\n    var ".concat(n," = buffer[offset];\n    if (").concat(n," < 0x80) {\n      ").concat(t," = ").concat(n,";\n      offset += 1;\n    } else if (").concat(n," < 0xc0) {\n      ").concat(t," = ((").concat(n,"<<8) | buffer[offset+1]) & 0x3fff;\n      offset += 2;\n    } else if (").concat(n," < 0xe0) {\n      ").concat(t," = ((").concat(n,"<<16) | (buffer[offset+1]<< 8) |  buffer[offset+2]) & 0x1fffff;\n      offset += 3;\n    } else if (").concat(n," < 0xf0) {\n      ").concat(t," = ((").concat(n,"<<24) | (buffer[offset+1]<<16) | (buffer[offset+2]<<8) | buffer[offset+3]) & 0x0fffffff;\n      offset += 4\n    } else {\n      ").concat(t," = ((").concat(n," & 0x0f)<<28) | (buffer[offset+1]<<20) | (buffer[offset+2]<<12) | (buffer[offset+3]<<4) | (buffer[offset+4] & 0x0f);\n      // x=((0xff & 0x0f)<<28) | (0xff<<20) | (0xff<<12) | (0xff<<4) | (0x0f & 0x0f);\n      // TODO *val_p = uv < 0x80000000UL ? uv : -((int32_t) (0xffffffffUL - uv)) - 1;\n      offset += 5\n    }\n  "))},l.prototype.ltf8=function(e,t){return this.setNextParser("ltf8",e,t)},l.prototype.generateLtf8=function(e){var t=e.generateVariable(this.varName),n=e.generateTmpVariable();e.pushCode("\n  var ".concat(n," = buffer[offset];\n  if (").concat(n," < 0x80) {\n    ").concat(t," = ").concat(n,";\n    offset += 1;\n  } else if (").concat(n," < 0xc0) {\n    ").concat(t," = ((buffer[offset]<<8) | buffer[offset+1]) & 0x3fff;\n    offset += 2;\n  } else if (").concat(n," < 0xe0) {\n    ").concat(t," = ((buffer[offset]<<16) | (buffer[offset+1]<<8) | buffer[offset+2]) & 0x1fffff;\n    ").concat(t," = (((").concat(n," & 63) << 16) | buffer.readUInt16LE(offset + 1));\n    offset += 3;\n  } else if (").concat(n," < 0xf0) {\n    ").concat(t," = ((buffer[offset]<<24) | (buffer[offset+1]<<16) | (buffer[offset+2]<<8) | buffer[offset+3]) & 0x0fffffff;\n    offset += 4;\n  } else if (").concat(n," < 0xf8) {\n    ").concat(t," = (((buffer[offset] & 15) * Math.pow(2,32))) +\n      (buffer[offset+1]<<24) | (buffer[offset+2]<<16 | buffer[offset+3]<<8 | buffer[offset+4])\n    // TODO *val_p = uv < 0x80000000UL ? uv : -((int32_t) (0xffffffffUL - uv)) - 1;\n    offset += 5;\n  } else if (").concat(n," < 0xfc) {\n    ").concat(t," = ((((buffer[offset] & 7) << 8) | buffer[offset+1] )) * Math.pow(2,32) +\n      (buffer[offset+2]<<24) | (buffer[offset+3]<<16 | buffer[offset+4]<<8 | buffer[offset+5])\n    offset += 6;\n  } else if (").concat(n," < 0xfe) {\n    ").concat(t," = ((((buffer[offset] & 3) << 16) | buffer[offset+1]<<8 | buffer[offset+2])) * Math.pow(2,32) +\n      (buffer[offset+3]<<24) | (buffer[offset+4]<<16 | buffer[offset+5]<<8 | buffer[offset+6])\n    offset += 7;\n  } else if (").concat(n," < 0xff) {\n    ").concat(t," = Long.fromBytesBE(buffer.slice(offset+1,offset+8));\n    if (").concat(t,".greaterThan(Number.MAX_SAFE_INTEGER) || ").concat(t,".lessThan(Number.MIN_SAFE_INTEGER))\n      throw new Error('integer overflow')\n    ").concat(t," = ").concat(t,".toNumber()\n    offset += 8;\n  } else {\n    ").concat(t," = Long.fromBytesBE(buffer.slice(offset+1,offset+9));\n    if (").concat(t,".greaterThan(Number.MAX_SAFE_INTEGER) || ").concat(t,".lessThan(Number.MIN_SAFE_INTEGER))\n      throw new Error('integer overflow')\n    ").concat(t," = ").concat(t,".toNumber()\n    offset += 9;\n  }\n  "))},t.Parser=l},356:function(e,t){e.exports.runInThisContext=function(e){return new Function("code","return eval(code);").call(globalThis,e)}},357:function(e,t,n){"use strict";function r(e){return r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o=function(){this.code="",this.scopes=[["vars"]],this.isAsync=!1,this.bitFields=[],this.tmpVariableCount=0,this.references={}};o.prototype.generateVariable=function(e){var t=[];for(Array.prototype.push.apply(t,this.scopes[this.scopes.length-1]);/^\$parent\./.test(e);)t.pop(),e=e.replace(/^\$parent\./,"");return e&&t.push(e),t.join(".")},o.prototype.generateOption=function(e){switch(r(e)){case"number":return e.toString();case"string":return this.generateVariable(e);case"function":return"(".concat(e,").call(").concat(this.generateVariable(),", vars)");default:return}},o.prototype.generateError=function(){var e=Array.prototype.slice.call(arguments),t=o.interpolate.apply(this,e);this.isAsync?this.pushCode("return process.nextTick(function() { callback(new Error(".concat(t,"), vars); });")):this.pushCode("throw new Error(".concat(t,");"))},o.prototype.generateTmpVariable=function(){return"$tmp".concat(this.tmpVariableCount++)},o.prototype.pushCode=function(){var e=Array.prototype.slice.call(arguments);this.code+="".concat(o.interpolate.apply(this,e),"\n")},o.prototype.pushPath=function(e){e&&this.scopes[this.scopes.length-1].push(e)},o.prototype.popPath=function(e){e&&this.scopes[this.scopes.length-1].pop()},o.prototype.pushScope=function(e){this.scopes.push([e])},o.prototype.popScope=function(){this.scopes.pop()},o.prototype.addReference=function(e){this.references[e]||(this.references[e]={resolved:!1,requested:!1})},o.prototype.markResolved=function(e){this.references[e].resolved=!0},o.prototype.markRequested=function(e){e.forEach(function(e){this.references[e].requested=!0}.bind(this))},o.prototype.getUnresolvedReferences=function(){var e=this.references;return Object.keys(this.references).filter((function(t){return!e[t].resolved&&!e[t].requested}))},o.interpolate=function(e){var t=/{\d+}/g,n=e.match(t),r=Array.prototype.slice.call(arguments,1);return n&&n.forEach((function(t){var n=parseInt(t.substr(1,t.length-2),10);e=e.replace(t,r[n].toString())})),e},t.Context=o},946:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return v}));var r=n(83),o=n(81),s=n(11),i=n(80),a=n.n(i),f=n(211),u=n.n(f),c=n(164),p=n(259),h=440477507;function l(e,t){var n=e.prototype[t],r="_memo_".concat(t);e.prototype[t]=function(){return r in this||(this[r]=n.call(this)),this[r]}}for(var d=["T","C","A","G"],b=[],g=0;g<256;g++)b.push(d[g>>6&3]+d[g>>4&3]+d[g>>2&3]+d[3&g]);var y=b.map((function(e){return e.toLowerCase()})),v=function(){function t(e){var n=e.filehandle,r=e.path;if(Object(o.a)(this,t),n)this.filehandle=n;else{if(!r)throw new Error("must supply path or filehandle");this.filehandle=new c.LocalFile(r)}this.isBigEndian=void 0}return Object(s.a)(t,[{key:"_getParser",value:function(){var e=Object(r.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getParsers();case 2:if(e.t0=t,n=e.sent[e.t0]){e.next=6;break}throw new Error("parser ".concat(t," not found"));case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_detectEndianness",value:function(){var t=Object(r.a)(a.a.mark((function t(){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.filehandle.read(e.allocUnsafe(8),0,8,0);case 2:if(n=t.sent,(r=n.buffer).readInt32LE(0)!==h){t.next=9;break}this.isBigEndian=!1,this.version=r.readInt32LE(4),t.next=15;break;case 9:if(r.readInt32BE(0)!==h){t.next=14;break}this.isBigEndian=!0,this.version=r.readInt32BE(4),t.next=15;break;case 14:throw new Error("not a 2bit file");case 15:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"_getParsers",value:function(){var e=Object(r.a)(a.a.mark((function e(){var t,n,r,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._detectEndianness();case 2:return t=this.isBigEndian?"big":"little",n=this.isBigEndian?"be":"le",r=(new p.Parser).endianess(t).uint8("nameLength").string("name",{length:"nameLength"}),r=1===this.version?r.buffer("offsetBytes",{length:8}):r.uint32("offset"),o=(new p.Parser).endianess(t).int32("magic",{assert:function(e){return 440477507===e}}).int32("version",{assert:function(e){return 0===e||1===e}}).uint32("sequenceCount",{assert:function(e){return e>=0}}).uint32("reserved"),e.abrupt("return",{header:o,index:(new p.Parser).endianess(t).uint32("sequenceCount").uint32("reserved").array("index",{length:"sequenceCount",type:r}),record1:(new p.Parser).endianess(t).uint32("dnaSize").uint32("nBlockCount"),record2:(new p.Parser).endianess(t).uint32("nBlockCount").array("nBlockStarts",{length:"nBlockCount",type:"uint32".concat(n)}).array("nBlockSizes",{length:"nBlockCount",type:"uint32".concat(n)}).uint32("maskBlockCount"),record3:(new p.Parser).endianess(t).uint32("maskBlockCount").array("maskBlockStarts",{length:"maskBlockCount",type:"uint32".concat(n)}).array("maskBlockSizes",{length:"maskBlockCount",type:"uint32".concat(n)}).int32("reserved")});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeader",value:function(){var t=Object(r.a)(a.a.mark((function t(){var n,r,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._detectEndianness();case 2:return t.next=4,this.filehandle.read(e.allocUnsafe(16),0,16,0);case 4:return n=t.sent,r=n.buffer,t.next=8,this._getParser("header");case 8:return o=t.sent,t.abrupt("return",o.parse(r).result);case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getIndex",value:function(){var t=Object(r.a)(a.a.mark((function t(){var n,r,o,s,i,f,c,p=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getHeader();case 2:return n=t.sent,r=8+n.sequenceCount*(257+(1===this.version?8:4)),t.next=6,this.filehandle.read(e.allocUnsafe(r),0,r,8);case 6:return o=t.sent,s=o.buffer,t.next=10,this._getParser("index");case 10:return i=t.sent,f=i.parse(s).result.index,c={},1===this.version?f.forEach((function(e){var t=e.name,n=e.offsetBytes,r=u.a.fromBytes(n,!0,!p.isBigEndian);if(r.greaterThan(Number.MAX_SAFE_INTEGER))throw new Error("integer overflow. File offset greater than 2^53-1 encountered. This library can only handle offsets up to 2^53-1.");c[t]=r.toNumber()})):f.forEach((function(e){var t=e.name,n=e.offset;c[t]=n})),t.abrupt("return",c);case 15:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getSequenceNames",value:function(){var e=Object(r.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIndex();case 2:return t=e.sent,e.abrupt("return",Object.keys(t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSequenceSizes",value:function(){var e=Object(r.a)(a.a.mark((function e(){var t,n,r,o,s,i,f=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIndex();case 2:return t=e.sent,n=Object.keys(t),r=Object.values(t).map((function(e){return f._getSequenceSize(e)})),e.next=7,Promise.all(r);case 7:for(o=e.sent,s={},i=0;i<n.length;i+=1)s[n[i]]=o[i];return e.abrupt("return",s);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSequenceSize",value:function(){var e=Object(r.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIndex();case 2:if(n=e.sent,r=n[t]){e.next=6;break}return e.abrupt("return",void 0);case 6:return e.abrupt("return",this._getSequenceSize(r));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getSequenceSize",value:function(){var e=Object(r.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(void 0===t||t<0)){e.next=2;break}throw new Error("invalid offset");case 2:return e.next=4,this._parseItem(t,8,"record1");case 4:return n=e.sent,e.abrupt("return",n.dnaSize);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getSequenceRecord",value:function(){var e=Object(r.a)(a.a.mark((function e(t){var n,r,o,s,i,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(void 0===t||t<0)){e.next=2;break}throw new Error("invalid offset");case 2:return e.next=4,this._parseItem(t,8,"record1");case 4:return n=e.sent,r=8*n.nBlockCount+8,e.next=8,this._parseItem(t+4,r,"record2");case 8:return o=e.sent,s=8*o.maskBlockCount+8,e.next=12,this._parseItem(t+4+r-4,s,"record3");case 12:return i=e.sent,f={dnaSize:n.dnaSize,nBlocks:{starts:o.nBlockStarts,sizes:o.nBlockSizes},maskBlocks:{starts:i.maskBlockStarts,sizes:i.maskBlockSizes},dnaPosition:t+4+r-4+s},e.abrupt("return",f);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_parseItem",value:function(){var t=Object(r.a)(a.a.mark((function t(n,r,o){var s,i,f;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.filehandle.read(e.allocUnsafe(r),0,r,n);case 2:return s=t.sent,i=s.buffer,t.next=6,this._getParser(o);case 6:return f=t.sent,t.abrupt("return",f.parse(i).result);case 8:case"end":return t.stop()}}),t,this)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"getSequence",value:function(){var t=Object(r.a)(a.a.mark((function t(n){var r,o,s,i,f,u,c,p,h,l,d,g,v,m,w,C,x,k,E=arguments;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=E.length>1&&void 0!==E[1]?E[1]:0,o=E.length>2?E[2]:void 0,t.next=4,this.getIndex();case 4:if(s=t.sent,i=s[n]){t.next=8;break}return t.abrupt("return",void 0);case 8:return t.next=10,this._getSequenceRecord(i);case 10:if(f=t.sent,!(r<0)){t.next=13;break}throw new TypeError("regionStart cannot be less than 0");case 13:return(void 0===o||o>f.dnaSize)&&(o=f.dnaSize),u=this._getOverlappingBlocks(r,o,f.nBlocks.starts,f.nBlocks.sizes),c=this._getOverlappingBlocks(r,o,f.maskBlocks.starts,f.maskBlocks.sizes),p=e.allocUnsafe(Math.ceil((o-r)/4)+1),h=Math.floor(r/4),t.next=20,this.filehandle.read(p,0,p.length,f.dnaPosition+h);case 20:for(l=t.sent,d=l.buffer,g="",v=r;v<o;v+=1){for(;c.length&&c[0].end<=v;)c.shift();if(m=c[0]&&c[0].start<=v&&c[0].end>v,u[0]&&v>=u[0].start&&v<u[0].end){for(w=u.shift();v<w.end&&v<o;v+=1)g+=m?"n":"N";v-=1}else C=Math.floor(v/4)-h,x=v%4,k=d[C],g+=m?y[k][x]:b[k][x]}return t.abrupt("return",g);case 25:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"_getOverlappingBlocks",value:function(e,t,n,r){for(var o,s,i=0;i<n.length;i+=1){var a=n[i];if(e>=a+r[i]||t<=a){if(void 0!==o){s=i;break}}else void 0===o&&(o=i)}if(void 0===o)return[];void 0===s&&(s=n.length);for(var f=new Array(s-o),u=o;u<s;u+=1)f[u-o]={start:n[u],end:n[u]+r[u],size:r[u]};return f}}]),t}();l(v,"_getParsers"),l(v,"getIndex"),l(v,"getHeader")}).call(this,n(99).Buffer)}}]);
//# sourceMappingURL=21.0d26fe6a.chunk.js.map