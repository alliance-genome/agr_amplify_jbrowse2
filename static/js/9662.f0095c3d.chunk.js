"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[9662],{79662:function(e,n,r){r.r(n),r.d(n,{default:function(){return q}});var t=r(32723),o=r(34795),a=r(68079),i=r(33028),s=r(59740),l=r(96234),c=r(96902),u=r(4782),d=r(63348),m=r(25322),f=r(35388),h=r(91188),x=r(4514),v=r(97531),b=r(31946),Z=r(13655),p=r(33266),j=r(15996),k=r(29938),y=(0,h.ZL)()((function(){return{container:{display:"flex",flexDirection:"row",margin:5},selectText:{marginRight:8,marginTop:10},flexItem:{marginRight:8}}}));var g=(0,u.observer)((function(e){var n=e.model,r=y().classes,t=n.assemblies,o=n.selectedAssembly,a=n.setSelectedAssembly,i=0===t.length;return(0,k.jsxs)("div",{className:r.container,children:[(0,k.jsx)(f.Z,{className:r.selectText,children:"Select assembly:"}),(0,k.jsx)(Z.Z,{className:r.flexItem,disabled:i,children:(0,k.jsxs)(p.Z,{value:function(e){return"all"===e?"all":t.includes(e)?e:"none"}(o),onChange:function(e){return a(e.target.value)},children:[(0,k.jsx)(j.Z,{value:"none",children:"none"}),(0,k.jsx)(j.Z,{value:"all",children:"all"}),t.map((function(e){return(0,k.jsx)(j.Z,{value:e,children:e},e)}))]})})]})})),w=r(46186),C=r(52809),S=r(99688),N=r(44536);var D=(0,u.observer)((function(e){var n=e.rowNumber,r=e.model,t=e.onClose;return(0,k.jsxs)(w.Dialog,{open:void 0!==n,onClose:t,title:"Delete bookmark",children:[(0,k.jsx)(C.Z,{children:(0,k.jsxs)(f.Z,{children:["Remove"," ",(0,k.jsx)("code",{children:void 0!==n?(0,v.assembleLocString)(r.bookmarkedRegions[n]):""})," ","?"]})}),(0,k.jsxs)(S.Z,{children:[(0,k.jsx)(N.Z,{variant:"contained",color:"secondary",onClick:function(){return t()},children:"Cancel"}),(0,k.jsx)(N.Z,{variant:"contained",color:"primary",onClick:function(){void 0!==n&&(r.removeBookmark(n),t())},children:"Confirm"})]})]})})),L=r(14393),B=r(64837);function F(e,n,r){return I.apply(this,arguments)}function I(){return(I=(0,o.Z)((0,t.Z)().mark((function e(n,r,o){var a,i,s,l;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,v.getSession)(o),e.prev=1,i=o.selectedAssembly,s="".concat(o.id,"_").concat(i),(l=r.find((function(e){return"LinearGenomeView"===e.type&&e.id===s}))||r.find((function(e){return"LinearGenomeView"===e.type&&e.assemblyNames[0]===i})))||(l=a.addView("LinearGenomeView",{id:s})),e.next=8,l.navToLocString(n,i);case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0),a.notify("".concat(e.t0),"error");case 14:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}var A=(0,h.ZL)()((function(){return{flexItem:{margin:5}}}));var V=(0,u.observer)((function(e){var n=e.model,r=A().classes,t=(0,c.useState)(!1),o=(0,l.Z)(t,2),a=o[0],i=o[1],s=(0,c.useState)("BED"),u=(0,l.Z)(s,2),d=u[0],m=u[1],h=n.bookmarkedRegions;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(N.Z,{startIcon:(0,k.jsx)(L.Z,{}),onClick:function(){return i(!0)},children:"Download"}),(0,k.jsxs)(w.Dialog,{open:a,onClose:function(){return i(!1)},title:"Download bookmarks",children:[(0,k.jsxs)(C.Z,{children:[(0,k.jsx)(f.Z,{children:"Format to download"}),(0,k.jsxs)(p.Z,{className:r.flexItem,"data-testid":"selectFileType",value:d,onChange:function(e){return m(e.target.value)},children:[(0,k.jsx)(j.Z,{value:"BED",children:"BED"}),(0,k.jsx)(j.Z,{value:"TSV",children:"TSV"})]})]}),(0,k.jsxs)(S.Z,{children:[(0,k.jsx)(N.Z,{variant:"contained",color:"secondary",onClick:function(){return i(!1)},children:"Cancel"}),(0,k.jsx)(N.Z,{className:r.flexItem,"data-testid":"dialogDownload",variant:"contained",color:"primary",startIcon:(0,k.jsx)(L.Z,{}),onClick:function(){!function(e,n,r){var t,o=r.selectedAssembly,a="TSV"===n?"chrom\tstart\tend\tlabel\tassembly_name\tcoord_range\n":"",i=e.map((function(e){var r=e.label,t=""===r?".":r,a=(0,v.assembleLocString)(e);return"BED"===n?e.assemblyName===o||"all"===o?"".concat(e.refName,"\t").concat(e.start,"\t").concat(e.end,"\t").concat(t,"\n"):"":"".concat(e.refName,"\t").concat(e.start+1,"\t").concat(e.end,"\t").concat(t,"\t").concat(e.assemblyName,"\t").concat(a,"\n")})).reduce((function(e,n){return e+n}),a),s=new Blob([i||""],{type:"BED"===n?"text/x-bed;charset=utf-8":"text/tab-separated-values;charset=utf-8"});t="BED"===n?"jbrowse_bookmarks_".concat(o,".bed"):"jbrowse_bookmarks.tsv",(0,B.saveAs)(s,t)}(h,d,n),i(!1)},children:"Download"})]})]})]})})),M=r(78884),T=r(32145),R=r(73823),_=(0,h.ZL)()((function(){return{dialogContainer:{margin:15},flexItem:{margin:5}}}));var E=(0,u.observer)((function(e){var n=e.model,r=e.assemblyName,a=_().classes,i=(0,v.getSession)(n),s=i.assemblyNames,u=(0,c.useState)(!1),d=(0,l.Z)(u,2),m=d[0],h=d[1],x=(0,c.useState)(),b=(0,l.Z)(x,2),Z=b[0],p=b[1],j=(0,c.useState)(),y=(0,l.Z)(j,2),g=y[0],D=y[1],L=(0,c.useState)(r||s[0]),B=(0,l.Z)(L,2),F=B[0],I=B[1];return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(N.Z,{startIcon:(0,k.jsx)(R.Z,{}),onClick:function(){return h(!0)},children:"Import"}),(0,k.jsxs)(w.Dialog,{open:m,onClose:function(){return h(!1)},maxWidth:"xl",title:"Import bookmarks",children:[(0,k.jsxs)(C.Z,{children:[(0,k.jsx)(f.Z,{children:"Choose a BED format file to import. The first 4 columns will be used"}),(0,k.jsx)(w.FileSelector,{location:Z,setLocation:p,name:"File"}),(0,k.jsx)(f.Z,{children:"Select assembly that your data belongs to"}),(0,k.jsx)(M.Z,{onChange:function(e){return I(e)},session:i,selected:F}),g?(0,k.jsx)(f.Z,{color:"error",variant:"h6",children:"".concat(g)}):null]}),(0,k.jsxs)(S.Z,{children:[(0,k.jsx)(N.Z,{variant:"contained",color:"secondary",onClick:function(){return h(!1)},children:"Cancel"}),(0,k.jsx)(N.Z,{className:a.flexItem,"data-testid":"dialogImport",variant:"contained",color:"primary",disabled:!Z,startIcon:(0,k.jsx)(R.Z,{}),onClick:(0,o.Z)((0,t.Z)().mark((function e(){var r,o;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,Z){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,(0,T.openLocation)(Z).readFile("utf8");case 5:r=e.sent,o=r.split(/\n|\r\n|\r/).filter((function(e){return!!e.trim()})).filter((function(e){return!e.startsWith("#")&&!e.startsWith("track")&&!e.startsWith("browser")})).map((function(e){var n=e.split("\t"),r=(0,l.Z)(n,4),t=r[0],o=r[1],a=r[2],i=r[3];return{assemblyName:F,refName:t,start:+o,end:+a,label:"."===i?void 0:i}})),n.importBookmarks(o),h(!1),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0),D(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,11]])}))),children:"Import"})]})]})]})})),W=r(4987);var z=(0,u.observer)((function(e){var n=e.model,r=(0,c.useState)(!1),t=(0,l.Z)(r,2),o=t[0],a=t[1];return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(N.Z,{startIcon:(0,k.jsx)(W.Z,{}),"aria-label":"clear bookmarks",onClick:function(){return a(!0)},children:"Clear"}),(0,k.jsxs)(w.Dialog,{open:o,onClose:function(){return a(!1)},title:"Clear bookmarks",children:[(0,k.jsx)(C.Z,{children:(0,k.jsx)(f.Z,{children:"Clear all bookmarks? Note this will clear bookmarks for all assemblies"})}),(0,k.jsxs)(S.Z,{children:[(0,k.jsx)(N.Z,{variant:"contained",color:"secondary",onClick:function(){a(!1)},children:"Cancel"}),(0,k.jsx)(N.Z,{variant:"contained",color:"primary",onClick:function(){n.clearAllBookmarks(),a(!1)},children:"Confirm"})]})]})]})})),G=["assemblyName"],H=(0,h.ZL)()((function(){return{link:{cursor:"pointer"}}})),P=function(e,n){return Math.min(Math.max((0,v.measureText)(String(e[n]),14)+20,80),1e3)},O=(0,u.observer)((function(e){var n=e.model,r=H().classes,u=(0,c.useState)(),f=(0,l.Z)(u,2),h=f[0],Z=f[1],p=n.bookmarkedRegions,j=n.selectedAssembly,y=(0,v.getSession)(n).views,g=p.filter((function(e){return"all"===j||e.assemblyName===j})).map((function(e,n){e.assemblyName;var r=(0,s.Z)(e,G);return(0,i.Z)((0,i.Z)({},e),{},{id:n,delete:n,locString:(0,v.assembleLocString)("all"===j?e:r)})})),w=[{field:"locString",headerName:"bookmark link",width:Math.max.apply(Math,(0,a.Z)(g.map((function(e){return P(e,"locString")})))),renderCell:function(e){var a=e.value;return(0,k.jsx)(d.Z,{className:r.link,onClick:function(){var e=(0,o.Z)((0,t.Z)().mark((function e(r){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,F(a,y,n);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),children:a})}},{field:"label",width:Math.max(100,Math.max.apply(Math,(0,a.Z)(g.map((function(e){return P(e,"label")}))))),editable:!0},{field:"delete",width:30,renderCell:function(e){var n=e.value;return(0,k.jsx)(m.Z,{"data-testid":"deleteBookmark","aria-label":"delete",onClick:function(){null!==n&&void 0!==n&&Z(+n)},children:(0,k.jsx)(b.Z,{})})}}];return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(x._,{density:"compact",rows:g,columns:w,onCellEditCommit:function(e){var r=e.value,t=e.id;n.updateBookmarkLabel(t,r)},disableSelectionOnClick:!0}),(0,k.jsx)(D,{rowNumber:h,model:n,onClose:function(){return Z(void 0)}})]})}));var q=(0,u.observer)((function(e){var n=e.model,r=n.selectedAssembly;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(g,{model:n}),(0,k.jsx)(V,{model:n}),(0,k.jsx)(E,{model:n,assemblyName:r}),(0,k.jsx)(z,{model:n}),(0,k.jsx)("div",{style:{margin:12},children:(0,k.jsxs)(f.Z,{children:["Note: you can double click the ",(0,k.jsx)("code",{children:"label"})," field to add your own custom notes"]})}),(0,k.jsx)("div",{style:{height:750,width:"100%"},children:(0,k.jsx)(O,{model:n})})]})}))},73823:function(e,n,r){var t=r(71600);n.Z=void 0;var o=t(r(7152)),a=r(29938),i=(0,o.default)((0,a.jsx)("path",{d:"M5 4v2h14V4H5zm0 10h4v6h6v-6h4l-7-7-7 7z"}),"Publish");n.Z=i},63348:function(e,n,r){r.d(n,{Z:function(){return C}});var t=r(68079),o=r(96234),a=r(56666),i=r(31461),s=r(7896),l=r(96902),c=r(24463),u=r(73674),d=r(70378),m=r(2252),f=r(53068),h=r(89779),x=r(22756),v=r(35388),b=r(974),Z=r(72762),p=r(16644),j={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},k=function(e){var n=e.theme,r=e.ownerState,t=function(e){return j[e]||e}(r.color),o=(0,Z.DW)(n,"palette.".concat(t),!1)||r.color,a=(0,Z.DW)(n,"palette.".concat(t,"Channel"));return"vars"in n&&a?"rgba(".concat(a," / 0.4)"):(0,p.Fq)(o,.4)},y=r(29938),g=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],w=(0,m.ZP)(v.Z,{name:"MuiLink",slot:"Root",overridesResolver:function(e,n){var r=e.ownerState;return[n.root,n["underline".concat((0,d.Z)(r.underline))],"button"===r.component&&n.button]}})((function(e){var n=e.theme,r=e.ownerState;return(0,s.Z)({},"none"===r.underline&&{textDecoration:"none"},"hover"===r.underline&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},"always"===r.underline&&(0,s.Z)({textDecoration:"underline"},"inherit"!==r.color&&{textDecorationColor:k({theme:n,ownerState:r})},{"&:hover":{textDecorationColor:"inherit"}}),"button"===r.component&&(0,a.Z)({position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"}},"&.".concat(b.Z.focusVisible),{outline:"auto"}))})),C=l.forwardRef((function(e,n){var r=(0,f.Z)({props:e,name:"MuiLink"}),a=r.className,m=r.color,v=void 0===m?"primary":m,Z=r.component,p=void 0===Z?"a":Z,k=r.onBlur,C=r.onFocus,S=r.TypographyClasses,N=r.underline,D=void 0===N?"always":N,L=r.variant,B=void 0===L?"inherit":L,F=r.sx,I=(0,i.Z)(r,g),A=(0,h.Z)(),V=A.isFocusVisibleRef,M=A.onBlur,T=A.onFocus,R=A.ref,_=l.useState(!1),E=(0,o.Z)(_,2),W=E[0],z=E[1],G=(0,x.Z)(n,R),H=(0,s.Z)({},r,{color:v,component:p,focusVisible:W,underline:D,variant:B}),P=function(e){var n=e.classes,r=e.component,t=e.focusVisible,o=e.underline,a={root:["root","underline".concat((0,d.Z)(o)),"button"===r&&"button",t&&"focusVisible"]};return(0,u.Z)(a,b.w,n)}(H);return(0,y.jsx)(w,(0,s.Z)({color:v,className:(0,c.default)(P.root,a),classes:S,component:p,onBlur:function(e){M(e),!1===V.current&&z(!1),k&&k(e)},onFocus:function(e){T(e),!0===V.current&&z(!0),C&&C(e)},ref:G,ownerState:H,variant:B,sx:[].concat((0,t.Z)(Object.keys(j).includes(v)?[]:[{color:v}]),(0,t.Z)(Array.isArray(F)?F:[F]))},I))}))},974:function(e,n,r){r.d(n,{w:function(){return a}});var t=r(74732),o=r(61235);function a(e){return(0,o.Z)("MuiLink",e)}var i=(0,t.Z)("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]);n.Z=i}}]);
//# sourceMappingURL=9662.f0095c3d.chunk.js.map