(this["webpackJsonp@jbrowse/web"]=this["webpackJsonp@jbrowse/web"]||[]).push([[28],{1585:function(e,t,n){"use strict";var a=n(90),r=n(93);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(1)),c=(0,a(n(94)).default)(o.createElement("path",{d:"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"}),"KeyboardArrowLeft");t.default=c},1586:function(e,t,n){"use strict";var a=n(90),r=n(93);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(1)),c=(0,a(n(94)).default)(o.createElement("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),"KeyboardArrowRight");t.default=c},1750:function(e,t,n){"use strict";n.r(t);var a=n(29),r=n(1),o=n.n(r),c=n(84),i=n(107),l=n(51),s=n(1690),u=n(79),m=n(118),f=n(861),d=n.n(f),v=n(1684),b=n(1687),p=n(1634),h=n(1639),y=n(83),x=n(287),g=n(289),E=Object(l.a)((function(e){return{importFormContainer:{padding:e.spacing(4),margin:"0 auto"}}})),w=Object(c.observer)((function(e){var t=e.model,n=E(),c=Object(y.getSession)(t),i=c.assemblyNames,l=c.assemblyManager,s=Object(r.useState)(),u=Object(a.a)(s,2),f=u[0],d=u[1],w=Object(r.useState)(i[0]),k=Object(a.a)(w,2),j=k[0],O=k[1],P=Object(r.useState)(i[0]),N=Object(a.a)(P,2),B=N[0],S=N[1],M=[j,B],C=Object(r.useState)(),T=Object(a.a)(C,2),R=T[0],L=T[1],A=i.length?M.map((function(e){var t;return null===(t=l.get(e))||void 0===t?void 0:t.error})).filter((function(e){return!!e})).join(", "):"No configured assemblies";var z=R||A;return o.a.createElement(v.a,{className:n.importFormContainer},z?o.a.createElement(x.default,{error:z}):null,o.a.createElement(b.a,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",style:{width:"50%",margin:"0 auto"}},o.a.createElement(b.a,{item:!0},o.a.createElement(p.a,{style:{padding:12}},o.a.createElement("p",{style:{textAlign:"center"}},"Select assemblies for dotplot view"),o.a.createElement(g.a,{selected:j,onChange:function(e){return O(e)},session:c}),o.a.createElement(g.a,{selected:B,onChange:function(e){return S(e)},session:c})),o.a.createElement(p.a,{style:{padding:12}},o.a.createElement("p",{style:{textAlign:"center"}},o.a.createElement("b",null,"Optional"),": Add a PAF"," ",o.a.createElement("a",{href:"https://github.com/lh3/miniasm/blob/master/PAF.md"},"(pairwise mapping format)")," ","file for the dotplot view. Note that the first assembly should be the left column of the PAF and the second assembly should be the right column. PAF-like files from MashMap (.out) are also allowed"),o.a.createElement(b.a,{container:!0,justifyContent:"center"},o.a.createElement(b.a,{item:!0},o.a.createElement(m.FileSelector,{name:"URL",description:"",location:f,setLocation:function(e){return d(e)}}))))),o.a.createElement(b.a,{item:!0},o.a.createElement(h.a,{"data-testid":"submitDotplot",onClick:function(){try{if(!Object(y.isSessionWithAddTracks)(c))return;if(t.setViews([{bpPerPx:.1,offsetPx:0},{bpPerPx:.1,offsetPx:0}]),t.setAssemblyNames([j,B]),f){var e=f&&"uri"in f&&f.uri?f.uri.slice(f.uri.lastIndexOf("/")+1):"MyTrack",n="".concat(e,"-").concat(Date.now());c.addTrackConf({trackId:n,name:e,assemblyNames:M,type:"SyntenyTrack",adapter:{type:"PAFAdapter",pafLocation:f,assemblyNames:M}}),t.toggleTrack(n)}}catch(a){console.error(a),L(a)}},disabled:!!A,variant:"contained",color:"primary"},"Open"))))})),k=n(1646),j=n(456),O=n.n(j),P=n(347),N=n.n(P),B=n(642),S=n.n(B),M=n(590),C=n.n(M),T=n(1585),R=n.n(T),L=n(1586),A=n.n(L),z=n(350),F=n.n(z),I=n(194),J=Object(l.a)({iconButton:{margin:5},controls:{overflow:"hidden",display:"flex",background:"white",whiteSpace:"nowrap",boxSizing:"border-box",border:"1px solid #a2a2a2"}}),Y=Object(c.observer)((function(e){var t=e.model,n=J();return o.a.createElement("div",{className:n.controls},o.a.createElement(k.a,{onClick:function(){t.hview.scroll(-100)},className:n.iconButton,title:"left",color:"secondary"},o.a.createElement(R.a,null)),o.a.createElement(k.a,{onClick:function(){t.hview.scroll(100)},className:n.iconButton,title:"left",color:"secondary"},o.a.createElement(A.a,null)),o.a.createElement(k.a,{onClick:function(){t.vview.scroll(100)},className:n.iconButton,title:"left",color:"secondary"},o.a.createElement(C.a,null)),o.a.createElement(k.a,{onClick:function(){t.vview.scroll(-100)},className:n.iconButton,title:"left",color:"secondary"},o.a.createElement(S.a,null)),o.a.createElement(k.a,{onClick:t.zoomOutButton,className:n.iconButton,color:"secondary"},o.a.createElement(O.a,null)),o.a.createElement(k.a,{onClick:t.zoomInButton,className:n.iconButton,title:"zoom in",color:"secondary"},o.a.createElement(N.a,null)),o.a.createElement(k.a,{onClick:t.activateTrackSelector,className:n.iconButton,title:"Open track selector","data-testid":"circular_track_select",color:"secondary"},o.a.createElement(I.c,null)),o.a.createElement(k.a,{onClick:t.squareView,className:n.iconButton,title:"Square view",color:"secondary"},o.a.createElement(F.a,null)))}));function _(e,t){var n=t.pxToBp(e),a=n.refName,r=n.start,o=n.offset,c=n.oob,i=Math.floor(r+o);return c?"out of bounds":"".concat(a,":").concat(i.toLocaleString("en-US"))}function X(e,t,n){var a=[],r=e.slice(0).sort((function(e,t){var n=e.end-e.start;return t.end-t.start-n})),o=new Array(Math.round(t));return r.forEach((function(e){var r=e.key,c=e.offsetPx,i=Math.round(t-c+n),l=[Math.max(i-12,0),i];0===i||o.slice.apply(o,l).some(Boolean)?a.push(r):o.fill.apply(o,[!0].concat(l))})),a}function D(e,t,n){for(var a=t*(e=Math.abs(e)),r=parseInt(Number(a).toExponential().split(/e/i)[1],10),o=Math.pow(10,r);o<a&&!((o*=2)>=a);)o*=2.5;var c=(o=Math.max(o,5))/e,i=0;return!(o%10)&&c/10>=n?i=o/10:!(o%5)&&c/5>=n?i=o/5:!(o%2)&&c/2>=n&&(i=o/2),{majorPitch:o,minorPitch:i}}function W(e,t){for(var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=[],o=D(t,60,15),c=o.minorPitch||o.majorPitch,i=0;i<e.length;i++)for(var l=e[i],s=l.start,u=l.end,m=l.refName,f=0,d=s,v=u,b=Math.ceil(d/c)*c;b<v;b+=c)a&&b%o.majorPitch?(r.push({type:"minor",base:b-1,index:f,refName:m}),f+=1):n&&Math.abs(b-l.start)>o.minorPitch&&(r.push({type:"major",base:b-1,index:f,refName:m}),f+=1);return r}var H=Object(l.a)((function(){return{vtext:{gridColumn:"1/2",gridRow:"1/2",pointerEvents:"none",userSelect:"none"},htext:{gridColumn:"2/2",gridRow:"2/2",pointerEvents:"none",userSelect:"none"},majorTickLabel:{fontSize:"11px"},majorTick:{stroke:"#555"},minorTick:{stroke:"#999"}}})),U=Object(c.observer)((function(e){var t=e.model,n=H(),a=t.viewWidth,r=t.borderY,c=t.hview,i=t.htextRotation,l=X(c.dynamicBlocks.contentBlocks,a,c.offsetPx),s=c.staticBlocks.contentBlocks.length>5?[]:W(c.staticBlocks.contentBlocks,c.bpPerPx);return o.a.createElement("svg",{width:a,height:r,className:n.htext},c.dynamicBlocks.contentBlocks.filter((function(e){return!l.includes(e.key)})).map((function(e){var t=e.offsetPx-c.offsetPx;return o.a.createElement("text",{transform:"rotate(".concat(i,",").concat(t,",").concat(0,")"),key:JSON.stringify(e),x:t,y:1,fill:"#000000",dominantBaseline:"hanging",textAnchor:"end"},[e.refName,0!==e.start?Math.floor(e.start):""].filter((function(e){return!!e})).join(":"))})),s.map((function(e){var t=(c.bpToPx({refName:e.refName,coord:e.base})||0)-c.offsetPx;return o.a.createElement("line",{key:"line-".concat(JSON.stringify(e)),x1:t,x2:t,y1:0,y2:"major"===e.type?6:4,strokeWidth:1,stroke:"major"===e.type?"#555":"#999",className:"major"===e.type?n.majorTick:n.minorTick,"data-bp":e.base})})),s.filter((function(e){return"major"===e.type})).map((function(e){var t=(c.bpToPx({refName:e.refName,coord:e.base})||0)-c.offsetPx;return o.a.createElement("text",{x:t-7,y:0,transform:"rotate(".concat(i,",").concat(t,",").concat(0,")"),key:"text-".concat(JSON.stringify(e)),style:{fontSize:"11px"},className:n.majorTickLabel,dominantBaseline:"middle",textAnchor:"end"},(e.base+1).toLocaleString("en-US"))})))})),K=Object(c.observer)((function(e){var t=e.model,n=H(),a=t.borderX,r=t.viewHeight,c=t.vview,i=t.vtextRotation,l=X(c.dynamicBlocks.contentBlocks,r,c.offsetPx),s=c.staticBlocks.contentBlocks.length>5?[]:W(c.staticBlocks.contentBlocks,c.bpPerPx);return o.a.createElement("svg",{className:n.vtext,width:a,height:r},c.dynamicBlocks.contentBlocks.filter((function(e){return!l.includes(e.key)})).map((function(e){var t=e.offsetPx,n=a;return o.a.createElement("text",{transform:"rotate(".concat(i,",").concat(n,",").concat(t,")"),key:JSON.stringify(e),x:n,y:r-t+c.offsetPx,fill:"#000000",textAnchor:"end"},[e.refName,0!==e.start?Math.floor(e.start):""].filter((function(e){return!!e})).join(":"))})),s.map((function(e){var t=(c.bpToPx({refName:e.refName,coord:e.base})||0)-c.offsetPx;return o.a.createElement("line",{key:"line-".concat(JSON.stringify(e)),y1:r-t,y2:r-t,x1:a,x2:a-("major"===e.type?6:4),strokeWidth:1,stroke:"major"===e.type?"#555":"#999",className:"major"===e.type?n.majorTick:n.minorTick,"data-bp":e.base})})),s.filter((function(e){return"major"===e.type})).map((function(e){var t=(c.bpToPx({refName:e.refName,coord:e.base})||0)-c.offsetPx;return o.a.createElement("text",{y:r-t-3,x:a-7,key:"text-".concat(JSON.stringify(e)),textAnchor:"end",dominantBaseline:"hanging",style:{fontSize:"11px"},className:n.majorTickLabel},(e.base+1).toLocaleString("en-US"))})))})),q=Object(l.a)((function(e){return{spacer:{gridColumn:"1/2",gridRow:"2/2"},root:{position:"relative",marginBottom:e.spacing(1),overflow:"hidden"},container:{display:"grid",padding:5,position:"relative"},overlay:{pointerEvents:"none",overflow:"hidden",display:"flex",width:"100%",gridRow:"1/2",gridColumn:"2/2",zIndex:100,"& path":{cursor:"crosshair",fill:"none"}},content:{gridColumn:"2/2",gridRow:"1/2"},popover:{background:"#fff",maxWidth:400,wordBreak:"break-all",zIndex:1e3,border:"1px solid black",pointerEvents:"none",position:"absolute"}}})),V=Object(c.observer)((function(e){var t,n,a=e.model,r=e.children,c=e.stroke,i=void 0===c?"#000a":c,l=a.viewWidth,s=a.viewHeight,u=a.hview,m=a.vview,f=u.dynamicBlocks.contentBlocks,d=m.dynamicBlocks.contentBlocks,v=u.displayedRegionsTotalPx-u.offsetPx,b=(null===(t=f[0])||void 0===t?void 0:t.offsetPx)-u.offsetPx,p=m.displayedRegionsTotalPx-m.offsetPx,h=(null===(n=d[0])||void 0===n?void 0:n.offsetPx)-m.offsetPx;return o.a.createElement("svg",{style:{background:"rgba(0,0,0,0.12)"},width:l,height:s},o.a.createElement("rect",{x:b,y:s-p,width:v-b,height:p-h,fill:"#fff"}),o.a.createElement("g",null,f.map((function(e){var t=e.offsetPx-u.offsetPx;return o.a.createElement("line",{key:JSON.stringify(e),x1:t,y1:0,x2:t,y2:s,stroke:i})})),d.map((function(e){var t=s-(e.offsetPx-m.offsetPx);return o.a.createElement("line",{key:JSON.stringify(e),x1:0,y1:t,x2:l,y2:t,stroke:i})})),o.a.createElement("line",{x1:v,y1:0,x2:v,y2:s,stroke:i}),o.a.createElement("line",{x1:0,y1:s-p,x2:l,y2:s-p,stroke:i})),r)}));function Z(e,t){return e&&[e[0]-t.left,e[1]-t.top]}var G=Object(c.observer)((function(e){var t,n,c,l=e.model,s=l.hview,f=l.vview,v=l.viewHeight,b=q(),p=Object(r.useState)(),h=Object(a.a)(p,2),y=h[0],x=h[1],g=Object(r.useState)(),E=Object(a.a)(g,2),w=E[0],k=E[1],j=Object(r.useState)(!1),O=Object(a.a)(j,2),P=O[0],N=O[1],B=Object(r.useState)(),S=Object(a.a)(B,2),M=S[0],C=S[1],T=Object(r.useRef)(null),R=Object(r.useRef)(null),L=Object(r.useRef)(0),A=Object(r.useRef)(0),z=Object(r.useRef)(null),F=Object(r.useRef)(null),I=Object(r.useRef)(),J=Object(r.useRef)(0),X=Object(r.useRef)(!1),D={left:0,top:0,width:0,height:0},W=(null===(t=T.current)||void 0===t?void 0:t.getBoundingClientRect())||D,H=(null===(n=F.current)||void 0===n?void 0:n.getBoundingClientRect())||D,G=(null===(c=z.current)||void 0===c?void 0:c.getBoundingClientRect())||D,Q=Z(w,W),$=Z(y,W),ee=Z(M,W),te=ee||$;return Object(r.useEffect)((function(){function e(e){var t=d()(e);e.preventDefault(),!0===e.ctrlKey?(J.current+=t.pixelY/500,l.vview.setScaleFactor(J.current<0?1-J.current:1/(1+J.current)),l.hview.setScaleFactor(J.current<0?1-J.current:1/(1+J.current)),I.current&&clearTimeout(I.current),I.current=setTimeout((function(){Object(i.transaction)((function(){l.hview.setScaleFactor(1),l.vview.setScaleFactor(1),l.hview.zoomTo(J.current>0?l.hview.bpPerPx*(1+J.current):l.hview.bpPerPx/(1-J.current)),l.vview.zoomTo(J.current>0?l.vview.bpPerPx*(1+J.current):l.vview.bpPerPx/(1-J.current))})),J.current=0}),300)):(L.current+=t.pixelX,A.current-=t.pixelY,X.current||(X.current=!0,window.requestAnimationFrame((function(){Object(i.transaction)((function(){l.hview.scroll(L.current),l.vview.scroll(A.current)})),X.current=!1,L.current=0,A.current=0}))))}if(T.current){var t=T.current;return t.addEventListener("wheel",e),function(){t.removeEventListener("wheel",e)}}return function(){}}),[l.hview,l.vview]),Object(r.useEffect)((function(){function e(e){x([e.clientX,e.clientY])}return window.addEventListener("mousemove",e),function(){window.removeEventListener("mousemove",e)}}),[]),Object(r.useEffect)((function(){var e=function(){};function t(e){Q&&$&&Math.abs(Q[0]-$[0])>3&&Math.abs(Q[1]-$[1])>3?C([e.clientX,e.clientY]):k(void 0)}return Q&&!ee&&(window.addEventListener("mouseup",t,!0),e=function(){window.removeEventListener("mouseup",t,!0)}),e}),[Q,$,ee]),o.a.createElement("div",null,o.a.createElement(Y,{model:l}),o.a.createElement("div",{ref:R,className:b.root,onMouseLeave:function(){return N(!1)},onMouseEnter:function(){return N(!0)}},o.a.createElement("div",{className:b.container},o.a.createElement("div",{style:{display:"grid",transform:"scaleX(".concat(l.hview.scaleFactor,") scaleY(").concat(l.vview.scaleFactor,")")}},o.a.createElement(K,{model:l}),o.a.createElement(U,{model:l}),o.a.createElement("div",{ref:T,style:{position:"relative"},className:b.content},P&&te?o.a.createElement("div",{ref:z,className:b.popover,style:{left:te[0]-(Q&&te[0]-Q[0]<0?G.width:0),top:te[1]-(Q&&te[1]-Q[1]<0?G.height:0)}},"x-".concat(_(te[0],s)),o.a.createElement("br",null),"y-".concat(_(v-te[1],f))):null,Q&&te&&Math.abs(Q[0]-te[0])>3&&Math.abs(Q[1]-te[1])>3?o.a.createElement("div",{ref:F,className:b.popover,style:{left:Q[0]-(te[0]-Q[0]<0?0:H.width),top:Q[1]-(te[1]-Q[1]<0?0:H.height)}},"x-".concat(_(Q[0],s)),o.a.createElement("br",null),"y-".concat(_(v-Q[1],f))):null,o.a.createElement("div",{role:"presentation",style:{cursor:"crosshair"},onMouseDown:function(e){0===e.button&&(k([e.clientX,e.clientY]),x([e.clientX,e.clientY]))}},o.a.createElement(V,{model:l},Q&&te?o.a.createElement("rect",{fill:"rgba(255,0,0,0.3)",x:Math.min(te[0],Q[0]),y:Math.min(te[1],Q[1]),width:Math.abs(te[0]-Q[0]),height:Math.abs(te[1]-Q[1])}):null)),o.a.createElement("div",{className:b.spacer})),o.a.createElement("div",{className:b.overlay},l.tracks.map((function(e){var t=Object(a.a)(e.displays,1)[0],n=t.RenderingComponent;return n?o.a.createElement(n,{key:Object(u.getConf)(e,"trackId"),model:t}):null}))),o.a.createElement(m.Menu,{open:Boolean(ee),onMenuItemClick:function(e,t){t(),C(void 0),k(void 0)},onClose:function(){C(void 0),k(void 0)},anchorReference:"anchorPosition",anchorPosition:M?{top:M[1]+30,left:M[0]+30}:void 0,style:{zIndex:1e3},menuItems:[{label:"Zoom in",onClick:function(){Q&&ee&&l.zoomIn(Q,ee)}},{label:"Open linear synteny view",onClick:function(){Q&&ee&&l.onDotplotView(Q,ee)}}]}))),o.a.createElement(m.ResizeHandle,{onDrag:function(e){return l.setHeight(l.height+e)},style:{height:4,background:"#ccc",boxSizing:"border-box",borderTop:"1px solid #fafafa"}})))})),Q=Object(c.observer)((function(e){var t=e.model,n=t.initialized,a=t.loading,r=t.error;return!n&&!a||r?o.a.createElement(w,{model:t}):a?o.a.createElement("div",null,o.a.createElement("p",null,"Loading..."),o.a.createElement(s.a,null)):o.a.createElement(G,{model:t})}));t.default=Q},642:function(e,t,n){"use strict";var a=n(90),r=n(93);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(1)),c=(0,a(n(94)).default)(o.createElement("path",{d:"M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),"KeyboardArrowUp");t.default=c}}]);
//# sourceMappingURL=28.fb5bd9d5.chunk.js.map