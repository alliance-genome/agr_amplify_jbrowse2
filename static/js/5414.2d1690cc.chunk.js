(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[5414],{47762:function(e,n,t){"use strict";t.r(n),t.d(n,{Attributes:function(){return J},BaseAttributes:function(){return q},BaseCard:function(){return R},BaseCoreDetails:function(){return z},BasicValue:function(){return D},FeatureDetails:function(){return V},FieldName:function(){return N},SimpleValue:function(){return W},useStyles:function(){return I}});var r=t(59740),i=t(33028),a=t(68079),o=t(96234),s=t(30969),c=t(51921),u=t(22714),l=t(31273),d=t(76647),f=t(80975),p=t(81254),h=t(317),g=t(89001),v=t(5088),m=t(22099),y=t(90550),b=t(81856),w=t(38184),x=t.n(w),Z=t(9077),k=t(81073),S=t(36174),j=t(92407),C=t(33853),T=t(37574),M=["id"],E=["__jbrowsefmt"],A=["__jbrowsefmt","length","position","subfeatures","uniqueId","exonFrames","parentId","thickStart","thickEnd"],P=["name","start","end","strand","refName","description","type"],I=(0,u.Z)((function(e){return{expansionPanelDetails:{display:"block",padding:e.spacing(1)},expandIcon:{color:"#FFFFFF"},field:{display:"flex",flexWrap:"wrap"},fieldDescription:{"&:hover":{background:"yellow"}},fieldName:{wordBreak:"break-all",minWidth:"90px",borderBottom:"1px solid #0003",background:e.palette.grey[200],marginRight:e.spacing(1),padding:e.spacing(.5)},fieldValue:{wordBreak:"break-word",maxHeight:300,padding:e.spacing(.5),overflow:"auto"},fieldSubvalue:{wordBreak:"break-word",maxHeight:300,padding:e.spacing(.5),background:e.palette.grey[100],border:"1px solid ".concat(e.palette.grey[300]),boxSizing:"border-box",overflow:"auto"}}}));function R(e){var n=e.children,t=e.title,r=e.defaultExpanded,i=void 0===r||r,a=I(),c=(0,s.useState)(i),u=(0,o.Z)(c,2),h=u[0],g=u[1];return(0,T.jsxs)(l.Z,{expanded:h,onChange:function(){return g((function(e){return!e}))},TransitionProps:{unmountOnExit:!0},children:[(0,T.jsx)(d.Z,{expandIcon:(0,T.jsx)(v.Z,{className:a.expandIcon}),children:(0,T.jsxs)(f.Z,{variant:"button",children:[" ",t]})}),(0,T.jsx)(p.Z,{className:a.expansionPanelDetails,children:n})]})}var N=function(e){var n=e.description,t=e.name,r=e.width,i=e.prefix,o=void 0===i?[]:i,s=I(),c=[].concat((0,a.Z)(o),[t]).join(".");return n?(0,T.jsx)(h.ZP,{title:n,placement:"left",children:(0,T.jsx)("div",{className:(0,b.Z)(s.fieldDescription,s.fieldName),children:c})}):(0,T.jsx)("div",{className:s.fieldName,style:{width:r},children:c})},D=function(e){var n=e.value,t=I(),r="".concat(n).match(/^https?:\/\//);return(0,T.jsx)("div",{className:t.fieldValue,children:s.isValidElement(n)?n:r?(0,T.jsx)(S.Z,{html:'<a href="'.concat(n,'">').concat(n,"</a>")}):(0,T.jsx)(S.Z,{html:x()(n)?JSON.stringify(n):String(n)})})},W=function(e){var n=e.name,t=e.value,r=e.description,i=e.prefix,a=e.width,o=I();return null!==t&&void 0!==t?(0,T.jsxs)("div",{className:o.field,children:[(0,T.jsx)(N,{prefix:i,description:r,name:n,width:a}),(0,T.jsx)(D,{value:t})]}):null},O=function(e){var n=e.name,t=e.value,r=e.description,i=e.prefix,o=void 0===i?[]:i,s=I();return 1===t.length?x()(t[0])?(0,T.jsx)(J,{attributes:t[0],prefix:[].concat((0,a.Z)(o),[n])}):(0,T.jsxs)("div",{className:s.field,children:[(0,T.jsx)(N,{prefix:o,description:r,name:n}),(0,T.jsx)(D,{value:t[0]})]}):t.every((function(e){return x()(e)}))?(0,T.jsx)(T.Fragment,{children:t.map((function(e,t){return(0,T.jsx)(J,{attributes:e,prefix:[].concat((0,a.Z)(o),[n+"-"+t])},JSON.stringify(e)+"-"+t)}))}):(0,T.jsxs)("div",{className:s.field,children:[(0,T.jsx)(N,{prefix:o,description:r,name:n}),t.map((function(e,n){return(0,T.jsx)("div",{className:s.fieldSubvalue,children:(0,T.jsx)(D,{value:e})},JSON.stringify(e)+"-"+n)}))]})},L=function(e){return e.toLocaleString("en-US")};function B(e){var n=e.feature,t=(0,i.Z)((0,i.Z)({},n),n.__jbrowsefmt),r=t.start,a=t.strand,s=t.end,c=t.refName,u={"-1":"-",0:"",1:"+"},l=u[a]?"(".concat(u[a],")"):"",d=(0,i.Z)((0,i.Z)({},t),{},{length:L(s-r),position:"".concat(c,":").concat(L(r+1),"..").concat(L(s)," ").concat(l)});return(0,T.jsx)(T.Fragment,{children:["Position","Description","Name","Length","Type"].map((function(e){return[e,d[e.toLowerCase()]]})).filter((function(e){var n=(0,o.Z)(e,2)[1];return null!==n&&void 0!==n})).map((function(e){var n=(0,o.Z)(e,2),t=n[0],r=n[1];return(0,T.jsx)(W,{name:t,value:r},t)}))})}var z=function(e){return(0,T.jsx)(R,(0,i.Z)((0,i.Z)({},e),{},{title:"Primary data",children:(0,T.jsx)(B,(0,i.Z)({},e))}))},U=function(e){var n=e.value,t=e.prefix,s=e.name,c=Object.keys(n[0]).sort(),u=new Set(c);if(n.forEach((function(e){return Object.keys(e).forEach((function(e){return u.add(e)}))})),u.size<c.length+5){var l,d=Object.entries(n).map((function(e){var n=(0,o.Z)(e,2),t=n[0],a=n[1],s=a.id,c=(0,r.Z)(a,M);return(0,i.Z)({id:t,identifier:s},c)}));u.has("id")?(u.delete("id"),l=["identifier"].concat((0,a.Z)(u))):l=(0,a.Z)(u);var f=l.map((function(e){return{field:e,width:Math.max.apply(Math,(0,a.Z)(d.map((function(n){return Math.min(Math.max((0,k.measureText)(String(n[e]),14)+50,80),1e3)}))))}}));return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(N,{prefix:t,name:s}),(0,T.jsx)("div",{style:{height:20*Math.min(d.length,100)+50+(d.length<100?0:50),width:"100%"},children:(0,T.jsx)(m.DataGrid,{disableSelectionOnClick:!0,rowHeight:20,headerHeight:25,rows:d,rowsPerPageOptions:[],hideFooterRowCount:!0,hideFooterSelectedRowCount:!0,columns:f,hideFooter:d.length<100})})]})}return null};function F(e){var n,t=e.value,r=e.prefix,i=e.name,a=I(),o=t.uri,s=t.baseUri,c=void 0===s?"":s;try{n=new URL(o,c).href}catch(u){n=o}return(0,T.jsxs)("div",{className:a.field,children:[(0,T.jsx)(N,{prefix:r,name:i}),(0,T.jsx)(D,{value:n})]})}function J(e){var n=e.attributes,t=e.omit,s=void 0===t?[]:t,c=e.descriptions,u=e.formatter,l=void 0===u?function(e){return e}:u,d=e.prefix,f=void 0===d?[]:d,p=[].concat((0,a.Z)(s),A),h=n.__jbrowsefmt,g=(0,r.Z)(n,E),v=(0,i.Z)((0,i.Z)({},g),h),m=function(e,n){var t=[];return e.forEach((function(e,r){var i=[].concat((0,a.Z)(n),[e[0]]).join(".");t.push((0,k.measureText)(i,12))})),Math.ceil(Math.max.apply(Math,t))+10}(Object.entries(v).filter((function(e){var n=(0,o.Z)(e,2),t=n[0];return void 0!==n[1]&&!p.includes(t)})),f),y=m<=170?m:170;return(0,T.jsx)(T.Fragment,{children:Object.entries(v).filter((function(e){var n=(0,o.Z)(e,2),t=n[0];return void 0!==n[1]&&!p.includes(t)})).map((function(e){var n=(0,o.Z)(e,2),t=n[0],r=n[1],i=function(e){var n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.forEach((function(e){t&&(t=t[e])})),"string"===typeof t?t:"string"===typeof(null===(n=t)||void 0===n?void 0:n.Description)?t.Description:void 0}([].concat((0,a.Z)(f),[t]),c);return Array.isArray(r)?r.length>2&&r.every((function(e){return x()(e)}))?(0,T.jsx)(U,{name:t,prefix:f,value:r},t):(0,T.jsx)(O,{name:t,value:r,description:i,prefix:f},t):x()(r)?(0,k.isUriLocation)(r)?(0,T.jsx)(F,{name:t,prefix:f,value:r},t):(0,T.jsx)(J,{omit:p,attributes:r,descriptions:c,prefix:[].concat((0,a.Z)(f),[t])},t):(0,T.jsx)(W,{name:t,value:l(r,t),description:i,prefix:f,width:y},t)}))})}var q=function(e){var n=e.feature;return(0,T.jsx)(R,(0,i.Z)((0,i.Z)({},e),{},{title:"Attributes",children:(0,T.jsx)(J,(0,i.Z)((0,i.Z)({},e),{},{attributes:n}))}))};function _(e,n,t){return[(0,C.Cn)("".concat(e)||"".concat(n)),"".concat(t)].filter((function(e){return!!e})).join(" - ")}var V=function e(n){var t=n.omit,r=void 0===t?[]:t,o=n.model,s=n.feature,u=n.depth,l=void 0===u?0:u,d=s.name,p=void 0===d?"":d,h=s.id,v=void 0===h?"":h,m=s.type,y=void 0===m?"":m,b=s.subfeatures,w=(0,k.getSession)(o),x=(0,Z.getConf)(w,["featureDetails","sequenceTypes"])||["mRNA","transcript"];return(0,T.jsxs)(R,{title:_(p,v,y),children:[(0,T.jsx)(f.Z,{children:"Core details"}),(0,T.jsx)(B,(0,i.Z)({},n)),(0,T.jsx)(g.Z,{}),(0,T.jsx)(f.Z,{children:"Attributes"}),(0,T.jsx)(J,(0,i.Z)((0,i.Z)({attributes:s},n),{},{omit:[].concat((0,a.Z)(r),P)})),x.includes(s.type)?(0,T.jsx)(c.ErrorBoundary,{FallbackComponent:function(e){var n=e.error;return(0,T.jsx)(f.Z,{color:"error",children:"".concat(n)})},children:(0,T.jsx)(j.Z,(0,i.Z)({},n))}):null,null!==b&&void 0!==b&&b.length?(0,T.jsx)(R,{title:"Subfeatures",defaultExpanded:!x.includes(s.type),children:b.map((function(n){return(0,T.jsx)(e,{feature:n,model:o,depth:l+1},JSON.stringify(n))}))}):null]})},H=(0,y.observer)((function(e){var n=e.model,t=n.featureData;if(!t)return null;var r,i=JSON.parse(JSON.stringify(t,(function(e,n){return"undefined"===typeof n?null:n})));return r=i,0===Object.keys(r).length?null:(0,T.jsx)(V,{model:n,feature:i})}));n.default=H},9077:function(e,n,t){"use strict";t.r(n),t.d(n,{ConfigurationReference:function(){return r.B},ConfigurationSchema:function(){return r.c},getConf:function(){return i.bc},getTypeNamesFromExplicitlyTypedUnion:function(){return i.G},isBareConfigurationSchemaType:function(){return i.Pb},isConfigurationModel:function(){return i.yt},isConfigurationSchemaType:function(){return i.qN},isConfigurationSlotType:function(){return i.mu},readConfObject:function(){return i.pS}});var r=t(76085),i=t(47741)},94943:function(e,n,t){"use strict";t.d(n,{Iy:function(){return a},ie:function(){return c},k$:function(){return o}});var r=0,i=new WeakMap;function a(e,n){var t=i.get(e);return t||(r+=1,i.set(e,r),t=r,e.addEventListener("abort",(function(){var t=i.get(e);void 0!==t&&n("signalAbort",t)}))),{abortSignalId:t}}function o(e){return"object"===typeof e&&null!==e&&"abortSignalId"in e&&"number"===typeof e.abortSignalId}var s=new Map;function c(e){var n=e.abortSignalId,t=s.get(n);return t||(t=new AbortController,s.set(n,t)),t.signal}},84291:function(e,n,t){"use strict";var r=t(96234),i=t(30969),a=t(90550),o=t(9077),s=t(22714),c=t(7690),u=t(1720),l=t(37574),d=(0,s.Z)((function(){return{importFormEntry:{minWidth:180}}}));var f=(0,a.observer)((function(e){var n=e.session,t=e.onChange,a=e.selected,s=e.InputProps,f=e.extra,p=void 0===f?0:f,h=d(),g=n.assemblyNames,v=n.assemblyManager,m=new URLSearchParams(window.location.search).get("config"),y=function(e,n){var t=(0,i.useState)((function(){if("undefined"===typeof window)return n;try{var t=window.localStorage.getItem(e);return t?JSON.parse(t):n}catch(k){return console.error(k),n}})),a=(0,r.Z)(t,2),o=a[0],s=a[1];return[o,function(n){try{var t=n instanceof Function?n(o):n;s(t),"undefined"!==typeof window&&window.localStorage.setItem(e,JSON.stringify(t))}catch(k){console.error(k)}}]}("lastAssembly-".concat([window.location.host+window.location.pathname,m,p].join("-")),a),b=(0,r.Z)(y,2),w=b[0],x=b[1],Z=g.includes(w||"")?w:a;(0,i.useEffect)((function(){Z&&Z!==a&&t(Z)}),[Z,t,a]);var k=g.length?"":"No configured assemblies";return(0,l.jsx)(c.Z,{select:!0,label:"Assembly",variant:"outlined",helperText:k||"Select assembly to view",value:k?"":Z,inputProps:{"data-testid":"assembly-selector"},onChange:function(e){return x(e.target.value)},error:!!k,InputProps:s,disabled:!!k,className:h.importFormEntry,children:g.map((function(e){var n=v.get(e),t=n?(0,o.getConf)(n,"displayName"):"";return(0,l.jsx)(u.Z,{value:e,children:t||e},e)}))})}));n.Z=f},99537:function(e,n,t){"use strict";var r=t(33028),i=t(59740),a=t(30969),o=t(1720),s=t(83421),c=t(11112),u=t(89001),l=t(74062),d=t(93999),f=t(76770),p=t(3708),h=t(39430),g=t(12200),v=t(37574),m=["onClick"],y=["title","inset","popupId"],b=["popupState","onMenuItemClick","menuItems","classes"],w=["popupState","onMenuItemClick","menuItems"],x=["onMenuItemClick","menuItems"],Z=a.createContext({parentPopupState:null,rootPopupState:null});function k(e){var n=e.onClick,t=(0,i.Z)(e,m),s=(0,a.useContext)(Z).rootPopupState;if(!s)throw new Error("must be used inside a CascadingMenu");var c=(0,a.useCallback)((function(e){s.close(e),n&&n(e)}),[s,n]);return(0,v.jsx)(o.Z,(0,r.Z)((0,r.Z)({},t),{},{onClick:c}))}function S(e){var n=e.title,t=e.inset,c=e.popupId,u=(0,i.Z)(e,y),l=a.useContext(Z).parentPopupState,d=(0,p.o_)({popupId:c,variant:"popover",parentPopupState:l});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(o.Z,(0,r.Z)((0,r.Z)((0,r.Z)({},(0,p.b8)(d)),(0,p.bs)(d)),{},{children:[(0,v.jsx)(s.Z,{primary:n,inset:t}),(0,v.jsx)(g.Z,{})]})),(0,v.jsx)(j,(0,r.Z)((0,r.Z)({},u),{},{anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},popupState:d}))]})}function j(e){var n=e.popupState,t=(e.onMenuItemClick,e.menuItems,e.classes,(0,i.Z)(e,b)),o=(0,a.useContext)(Z).rootPopupState,s=(0,a.useMemo)((function(){return{rootPopupState:o||n,parentPopupState:n}}),[o,n]);return(0,v.jsx)(Z.Provider,{value:s,children:(0,v.jsx)(h.Z,(0,r.Z)((0,r.Z)({},t),(0,p.wK)(n)))})}function C(e){var n=e.popupState,t=(e.onMenuItemClick,e.menuItems,(0,i.Z)(e,w)),o=a.useContext(Z).rootPopupState,s=a.useMemo((function(){return{rootPopupState:o||n,parentPopupState:n}}),[o,n]);return(0,v.jsx)(Z.Provider,{value:s,children:(0,v.jsx)(c.Z,(0,r.Z)((0,r.Z)({},t),(0,p.wK)(n)))})}function T(e){var n=e.item;return"subMenu"in n?(0,v.jsx)(f.J,{type:"subMenu"}):"checkbox"===n.type||"radio"===n.type?(0,v.jsx)(f.J,{type:n.type,checked:n.checked,disabled:n.disabled}):null}function M(e){var n=e.onMenuItemClick,t=e.menuItems,a=(0,i.Z)(e,x);var o=t.some((function(e){return"icon"in e&&e.icon}));return(0,v.jsx)(v.Fragment,{children:t.map((function(e,t){return"subMenu"in e?(0,v.jsx)(S,{popupId:"subMenu-".concat(e.label),title:e.label,inset:o,onMenuItemClick:n,menuItems:e.subMenu,children:(0,v.jsx)(M,(0,r.Z)((0,r.Z)({},a),{},{onMenuItemClick:n,menuItems:e.subMenu}))},"subMenu-".concat(e.label,"-").concat(t)):"divider"===e.type?(0,v.jsx)(u.Z,{component:"li"},"divider-".concat(t)):"subHeader"===e.type?(0,v.jsx)(l.Z,{children:e.label},"subHeader-".concat(e.label,"-").concat(t)):(0,v.jsxs)(k,{onClick:"onClick"in e?(i=e.onClick,function(e){n(e,i)}):void 0,disabled:Boolean(e.disabled),children:[e.icon?(0,v.jsx)(d.Z,{children:(0,v.jsx)(e.icon,{})}):null," ",(0,v.jsx)(s.Z,{primary:e.label,secondary:e.subLabel,inset:o&&!e.icon}),(0,v.jsx)("div",{style:{flexGrow:1,minWidth:10}}),(0,v.jsx)(T,{item:e})]},"".concat(e.label,"-").concat(t));var i}))})}n.Z=function(e){return(0,v.jsx)(C,(0,r.Z)((0,r.Z)({},e),{},{children:(0,v.jsx)(M,(0,r.Z)({},e))}))}},78033:function(e,n,t){"use strict";var r=t(33028),i=t(96234),a=t(59740),o=t(57110),s=t(80975),c=t(22714),u=t(38827),l=t(30969),d=t(37574),f=["value","setValue","variant"],p=(0,c.Z)((function(e){return{input:{},inputBase:{},typography:{top:6,left:2,position:"absolute",whiteSpace:"nowrap",visibility:"hidden"},inputRoot:{padding:e.spacing(.5)},inputFocused:{borderStyle:"solid",borderRadius:e.shape.borderRadius,borderWidth:2}}})),h=l.forwardRef((function(e,n){var t=e.value,c=e.setValue,h=e.variant,g=(0,a.Z)(e,f),v=(0,l.useState)(),m=(0,i.Z)(v,2),y=m[0],b=m[1],w=(0,l.useState)(0),x=(0,i.Z)(w,2),Z=x[0],k=x[1],S=(0,l.useState)(null),j=(0,i.Z)(S,2),C=j[0],T=j[1],M=(0,l.useState)(null),E=(0,i.Z)(M,2),A=E[0],P=E[1],I=(0,l.useState)(!1),R=(0,i.Z)(I,2),N=R[0],D=R[1];(0,l.useEffect)((function(){N&&(A&&A.blur(),D(!1))}),[N,A]);var W=p(e),O=(0,u.Z)(),L=C&&C.clientWidth;L&&L!==Z&&k(L);return(0,d.jsxs)("div",(0,r.Z)((0,r.Z)({},g),{},{ref:n,children:[(0,d.jsx)("div",{style:{position:"relative"},children:(0,d.jsx)(s.Z,{ref:function(e){T(e)},component:"span",variant:h,className:W.typography,children:void 0===y?t:y})}),(0,d.jsx)(o.Z,{inputRef:function(e){P(e)},className:W.inputBase,inputProps:{style:(0,r.Z)({width:Z},h&&"inherit"!==h&&"srOnly"!==h?O.typography[h]:{})},classes:{input:W.input,root:W.inputRoot,focused:W.inputFocused},value:void 0===y?t:y,onChange:function(e){b(e.target.value)},onKeyDown:function(e){"Enter"===e.key?A&&A.blur():"Escape"===e.key&&(b(void 0),D(!0))},onBlur:function(){y&&y!==t&&c(y),b(void 0)}})]}))}));n.Z=h},16383:function(e,n,t){"use strict";t.r(n);t(30969);var r=t(22714),i=t(37574),a=(0,r.Z)((function(e){return{message:{border:"1px solid black",background:"#f88",overflow:"auto",maxHeight:200,margin:e.spacing(1),padding:e.spacing(1)},errorBox:{background:"lightgrey",border:"1px solid black",margin:20}}}));n.default=function(e){var n=e.error,t=a(),r="",o="".concat(n),s="is not assignable",c=o.indexOf(s);if(-1!==c){var u=o.slice(0,c+s.length),l=u.match(/.*at path "(.*)" snapshot `(.*)` is not assignable/m);l&&(o="Failed to load element at ".concat(l[1],"...Failed element had snapshot"),r=l[2]);var d=u.match(/.*snapshot `(.*)` is not assignable/);d&&(o="Failed to load element...Failed element had snapshot",r=d[1])}return(0,i.jsxs)("div",{className:t.message,children:[o.slice(0,1e4),r?(0,i.jsx)("pre",{className:t.errorBox,children:JSON.stringify(JSON.parse(r),null,2)}):null]})}},88896:function(e,n,t){"use strict";var r=t(28599),i=t(83483),a=t(64501),o=t(93138),s=t(54249),c=t(53033),u=(t(30969),t(37574));n.Z=function(e){var n=e.onClose,t=e.open,l=e.onFactoryReset;function d(e){"reset"===e&&l(),n()}return(0,u.jsxs)(i.Z,{open:t,onClose:function(){return d()},children:[(0,u.jsx)(a.Z,{id:"alert-dialog-title",children:"Reset"}),(0,u.jsx)(o.Z,{children:(0,u.jsx)(s.Z,{id:"alert-dialog-description",children:"Are you sure you want to reset? This will restore the default configuration."})}),(0,u.jsxs)(c.Z,{children:[(0,u.jsx)(r.Z,{onClick:function(){return d()},color:"primary",children:"Cancel"}),(0,u.jsx)(r.Z,{onClick:function(){return d("reset")},color:"primary",variant:"contained",children:"OK"})]})]})}},98553:function(e,n,t){"use strict";t.d(n,{Z:function(){return j}});var r=t(68079),i=t(96234),a=t(33028),o=t(59740),s=t(30969),c=t(317),u=t(27710),l=t(57071),d=t(11112),f=t(1720),p=t(98302),h=t(38601),g=t(83230),v=t(90550),m=t(8438),y=t(58459),b=t(84537),w=t(14808),x=t(37574),Z=["title","children"];function k(e){var n=e.title,t=e.children,r=(0,o.Z)(e,Z);return(0,x.jsx)(c.ZP,{title:n||"",children:(0,x.jsx)(h.Z,(0,a.Z)((0,a.Z)({},r),{},{children:t}))})}function S(e,n){return"string"===typeof e&&e.length>n?"".concat(e.substring(0,n),"\u2026"):e}var j=(0,v.observer)((function(e){var n=e.location,t=e.name,o=e.description,c=e.rootModel,v=e.setLocation,Z=!n||(0,m.hb)(n)?"url":"file",j=(0,s.useState)(n&&"internetAccountId"in n&&n.internetAccountId?n.internetAccountId:Z),C=(0,i.Z)(j,2),T=C[0],M=C[1],E=(0,m.dc)(c)?c.internetAccounts.slice():[],A=(0,s.useState)(E.slice(0,2)),P=(0,i.Z)(A,2),I=P[0],R=P[1],N=(0,s.useState)(E.slice(2)),D=(0,i.Z)(N,2),W=D[0],O=D[1],L=(0,s.useState)(null),B=(0,i.Z)(L,2),z=B[0],U=B[1],F=E.find((function(e){return e.internetAccountId===T})),J=function(e){v((0,a.Z)((0,a.Z)({},e),{},{internetAccountId:F?F.internetAccountId:void 0}))};n&&F&&(0,m.hb)(n)&&n.internetAccountId!==F.internetAccountId&&J(n);var q=(0,x.jsx)(w.Z,(0,a.Z)((0,a.Z)({},e),{},{setLocation:J,label:null===F||void 0===F?void 0:F.selectorLabel}));if("file"===T&&(q=(0,x.jsx)(b.Z,(0,a.Z)({},e))),null!==F&&void 0!==F&&F.SelectorComponent){var _=F.SelectorComponent;q=(0,x.jsx)(_,(0,a.Z)((0,a.Z)({},e),{},{setLocation:J}))}return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(u.Z,{display:"flex",children:(0,x.jsx)(l.Z,{shrink:!0,children:t})}),(0,x.jsx)(u.Z,{display:"flex",flexDirection:"row",children:(0,x.jsxs)(u.Z,{children:[(0,x.jsxs)(g.Z,{value:T,exclusive:!0,onChange:function(e,t){t&&M(t),(0,m.hb)(n)&&J(n)},"aria-label":"file, url, or account picker",children:[new URLSearchParams(window.location.search).get("adminKey")?null:(0,x.jsx)(h.Z,{value:"file","aria-label":"local file",children:"File"}),(0,x.jsx)(h.Z,{value:"url","aria-label":"url",children:"URL"}),I.map((function(e){var n=e.internetAccountId,t=e.toggleContents,r=e.name;return(0,x.jsx)(k,{value:n,"aria-label":r,title:r,children:"string"===typeof t?S(t,5):t||S(r,5)},n)})),W.length?(0,x.jsxs)(h.Z,{onClick:function(e){return U(e.target)},selected:!1,children:["More",(0,x.jsx)(y.Z,{})]}):null]}),(0,x.jsx)(d.Z,{open:Boolean(z),anchorEl:z,onClose:function(){return U(null)},getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:null===W||void 0===W?void 0:W.map((function(e,n){return(0,x.jsx)(f.Z,{value:e.internetAccountId,onClick:function(){var t=I[I.length-1];R([].concat((0,r.Z)(I.slice(0,I.length-1)),[e])),O([t].concat((0,r.Z)(W.slice(0,n)),(0,r.Z)(W.slice(n+1)))),M(e.internetAccountId),U(null)},children:e.name},e.internetAccountId)}))})]})}),q,(0,x.jsx)(p.Z,{children:o})]})}))},76770:function(e,n,t){"use strict";t.d(n,{J:function(){return C}});var r=t(59740),i=t(33028),a=t(96234),o=t(30969),s=t(22714),c=t(26545),u=t(89001),l=t(74062),d=t(93999),f=t(1720),p=t(83421),h=t(47366),g=t(51526),v=t(2296),m=t(34213),y=t(49232),b=t(89392),w=t(57656),x=t(4356),Z=t(81073),k=t(37574),S=["open","onClose","menuItems","onMenuItemClick"],j=(0,s.Z)({paper:{position:"fixed",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",top:0,left:0,outline:0},menuItemEndDecoration:{padding:0,margin:0,height:16}});function C(e){var n,t,r,i=j(),a=e.type;if("checked"in e&&(n=e.checked,t=e.disabled),"subMenu"===a)r=(0,k.jsx)(m.Z,{color:"action"});else if("checkbox"===a)if(n){var o=t?"inherit":"secondary";r=(0,k.jsx)(y.Z,{color:o})}else r=(0,k.jsx)(b.Z,{color:"action"});else if("radio"===a)if(n){var s=t?"inherit":"secondary";r=(0,k.jsx)(w.Z,{color:s})}else r=(0,k.jsx)(x.Z,{color:"action"});return(0,k.jsx)("div",{className:i.menuItemEndDecoration,children:r})}var T=o.forwardRef((function(e,n){var t=(0,o.useState)(),r=(0,a.Z)(t,2),s=r[0],v=r[1],m=(0,o.useState)(),y=(0,a.Z)(m,2),b=y[0],w=y[1],x=(0,o.useState)(!1),S=(0,a.Z)(x,2),M=S[0],E=S[1],A=(0,o.useState)(),P=(0,a.Z)(A,2),I=P[0],R=P[1],N=(0,o.useState)(),D=(0,a.Z)(N,2),W=D[0],O=D[1],L=(0,o.useRef)(),B=j(),z=e.menuItems,U=e.onMenuItemClick,F=e.open,J=e.onClose,q=e.anchorEl,_=e.top,V=void 0!==_&&_;(0,o.useEffect)((function(){F||(v(void 0),w(void 0))}),[F]),(0,o.useEffect)((function(){var e,n=F&&Boolean(s);return n&&!M?e=setTimeout((function(){E(!0)}),300):!n&&M&&(e=setTimeout((function(){E(!1)}),300)),function(){clearTimeout(e)}}),[M,F,s]),(0,o.useEffect)((function(){if(q){var e=q.getBoundingClientRect();W&&e.top===W.top&&e.left+e.width===W.left||O({top:e.top,left:e.left+e.width})}else W||O({})}),[W,q]);var H=z.some((function(e){return"icon"in e&&e.icon})),G={};var Q=(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(c.Z,{autoFocusItem:F&&!M,children:z.sort((function(e,n){return(n.priority||0)-(e.priority||0)})).map((function(e,n){if("divider"===e.type)return(0,k.jsx)(u.Z,{component:"li"},"divider-".concat(n));if("subHeader"===e.type)return(0,k.jsx)(l.Z,{children:e.label},"subHeader-".concat(e.label,"-").concat(n));var t=null,r=null;if(e.icon){var i=e.icon;t=(0,k.jsx)(d.Z,{children:(0,k.jsx)(i,{})})}"subMenu"in e?r=(0,k.jsx)(C,{type:"subMenu"}):"checkbox"!==e.type&&"radio"!==e.type||(r=(0,k.jsx)(C,{type:e.type,checked:e.checked,disabled:e.disabled}));var a,o="onClick"in e?(a=e.onClick,function(e){U(e,a)}):void 0;return(0,k.jsxs)(f.Z,{style:G,selected:n===I,onClick:o,onMouseMove:function(t){t.currentTarget!==document.activeElement&&(t.currentTarget.focus(),R(n)),"subMenu"in e?b!==n&&(v(t.currentTarget),w(n)):(v(void 0),w(void 0))},onKeyDown:function(t){if("ArrowLeft"===t.key||"Escape"===t.key)J&&J(t,"escapeKeyDown");else if("ArrowUp"===t.key)R(function(e,n){return(0,Z.findLastIndex)(e.slice(0,n),(function(e){return"divider"!==e.type&&"subHeader"!==e.type&&!e.disabled}))}(z,n));else if("ArrowDown"===t.key){var r=function(e,n){var t=e.slice(n+1).findIndex((function(e){return"divider"!==e.type&&"subHeader"!==e.type&&!e.disabled}));return-1===t?t:n+1+t}(z,n);R(r)}else"subMenu"in e&&("ArrowRight"!==t.key&&"Enter"!==t.key||(v(t.currentTarget),w(n),E(!0)))},disabled:Boolean(e.disabled),children:[t,(0,k.jsx)(p.Z,{primary:e.label,secondary:e.subLabel,inset:H&&!e.icon}),(0,k.jsx)("div",{style:{flexGrow:1,minWidth:10}}),r]},e.label)}))}),z.map((function(e,n){var t=null;return"subMenu"in e&&(t=(0,k.jsx)(T,{anchorEl:s,open:M&&b===n,onClose:function(){E(!1),v(void 0)},onMenuItemClick:U,menuItems:e.subMenu},e.label)),t}))]});return V?Q:(0,k.jsx)(h.Z,{in:F,style:{transformOrigin:"0 0 0"},ref:n,children:(0,k.jsx)(g.Z,{elevation:8,ref:L,className:B.paper,style:(0,i.Z)({},W),children:Q})})}));n.Z=function(e){var n=e.open,t=e.onClose,a=e.menuItems,o=e.onMenuItemClick,s=(0,r.Z)(e,S);return(0,k.jsx)(v.ZP,(0,i.Z)((0,i.Z)({transitionDuration:0,open:n,onClose:t,BackdropProps:{invisible:!0}},s),{},{children:(0,k.jsx)(T,{open:n,onClose:t,menuItems:a,onMenuItemClick:o,top:!0})}))}},26737:function(e,n,t){"use strict";var r=t(33028),i=t(96234),a=t(59740),o=t(30969),s=t(22714),c=t(81856),u=t(37574),l=["onDrag","vertical","flexbox","className"],d=(0,s.Z)({horizontalHandle:{cursor:"row-resize",width:"100%"},verticalHandle:{cursor:"col-resize",height:"100%"},flexbox_verticalHandle:{cursor:"col-resize",alignSelf:"stretch"},flexbox_horizontalHandle:{cursor:"row-resize",alignSelf:"stretch"}});n.Z=function(e){var n,t=e.onDrag,s=e.vertical,f=void 0!==s&&s,p=e.flexbox,h=void 0!==p&&p,g=e.className,v=(0,a.Z)(e,l),m=(0,o.useState)(!1),y=(0,i.Z)(m,2),b=y[0],w=y[1],x=(0,o.useRef)(0),Z=d();return(0,o.useEffect)((function(){function e(e){e.preventDefault();var n=f?e.clientX:e.clientY,r=n-x.current;r&&(t(r),x.current=n)}function n(){w(!1)}return b?(window.addEventListener("mousemove",e,!0),window.addEventListener("mouseup",n,!0),function(){window.removeEventListener("mousemove",e,!0),window.removeEventListener("mouseup",n,!0)}):function(){}}),[b,t,f]),n=h?f?Z.flexbox_verticalHandle:Z.flexbox_horizontalHandle:f?Z.verticalHandle:Z.horizontalHandle,(0,u.jsx)("div",(0,r.Z)({"data-resizer":"true",onMouseDown:function(e){e.preventDefault(),x.current=f?e.clientX:e.clientY,w(!0)},role:"presentation",className:(0,c.Z)(n,g)},v))}},36174:function(e,n,t){"use strict";t.d(n,{Z:function(){return d}});var r=t(30969),i=t(90261),a=t.n(i),o=t(35167),s=t.n(o),c=t(37574),u=!1,l=new RegExp(["a","b","br","code","div","em","h1","h2","h3","h4","h5","h6","i","img","li","p","pre","span","small","strong","table","tbody","td","tfoot","th","thead","tr","u","ul"].map((function(e){return"<".concat(e,"\\b[^>]*>")})).join("|"),"i");function d(e){var n,t=e.html,i=(n=t,l.test(n)?t:a()(t));return(0,r.useEffect)((function(){u||(u=!0,s().addHook("afterSanitizeAttributes",(function(e){"A"===e.tagName&&(e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank"))})))}),[]),(0,c.jsx)("div",{dangerouslySetInnerHTML:{__html:s().sanitize(i)}})}},24998:function(e,n,t){"use strict";t.r(n),t.d(n,{App:function(){return V},AssemblySelector:function(){return re.Z},CascadingMenu:function(){return he.Z},EditableTypography:function(){return U.Z},ErrorMessage:function(){return te.default},FactoryResetDialog:function(){return ue.Z},FatalErrorDialog:function(){return fe.Z},FileSelector:function(){return ie.Z},LogoFull:function(){return x},Logomark:function(){return w},Menu:function(){return pe.Z},MenuItemEndDecoration:function(){return pe.J},PrerenderedCanvas:function(){return se},ResizeHandle:function(){return ce.Z},ReturnToImportFormDialog:function(){return ne},SanitizedHTML:function(){return ge.Z},Tooltip:function(){return de},createJBrowseDefaultOverrides:function(){return h},createJBrowseDefaultProps:function(){return p},createJBrowseTheme:function(){return v},jbrowseBaseTheme:function(){return g},jbrowseDefaultPalette:function(){return f}});var r=t(33028),i=t(91503),a=t(14893),o=t(41989),s=t(7165),c=t(2078),u=t(67560),l=t.n(u),d=(0,c.Z)(),f={primary:{main:"#0D233F"},secondary:{main:"#721E63"},tertiary:d.palette.augmentColor({main:"#135560"}),quaternary:d.palette.augmentColor({main:"#FFB11D"}),stopCodon:"#e22",startCodon:"#3e3",bases:{A:d.palette.augmentColor(i.Z),C:d.palette.augmentColor(a.Z),G:d.palette.augmentColor(o.Z),T:d.palette.augmentColor(s.Z)}};function p(){return{MuiButton:{size:"small"},MuiFilledInput:{margin:"dense"},MuiFormControl:{margin:"dense"},MuiFormHelperText:{margin:"dense"},MuiIconButton:{size:"small"},MuiInputBase:{margin:"dense"},MuiList:{dense:!0},MuiListItem:{dense:!0},MuiOutlinedInput:{margin:"dense"},MuiFab:{size:"small"},MuiTable:{size:"small"},MuiTextField:{margin:"dense",size:"small"},MuiToolbar:{variant:"dense"},MuiSvgIcon:{fontSize:"small"},MuiToggleButtonGroup:{size:"small"},MuiCheckbox:{size:"small"},MuiLink:{underline:"always"}}}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=l()(f,e);return{MuiIconButton:{colorSecondary:{color:n.tertiary.main}},MuiButton:{textSecondary:{color:n.tertiary.main}},MuiFab:{secondary:{backgroundColor:n.quaternary.main}},MuiLink:{root:{color:n.tertiary.main}},MuiAccordion:{root:{margin:0,"&$expanded":{margin:0}}},MuiAccordionSummary:{root:{backgroundColor:n.tertiary.main+" !important",width:"100%","&$expanded":{minHeight:0,color:n.tertiary.contrastText,backgroundColor:n.tertiary.main},minHeight:0},content:{"&$expanded":{margin:"8px 8px"},margin:"8px 8px",color:n.tertiary.contrastText}},MuiMenuItem:{root:{paddingTop:3,paddingBottom:3}},MuiListItemIcon:{root:{minWidth:32}},MuiListItemText:{inset:{paddingLeft:32}}}}var g={palette:f,typography:{fontSize:12},spacing:4,props:{MuiButton:{size:"small"},MuiFilledInput:{margin:"dense"},MuiFormControl:{margin:"dense"},MuiFormHelperText:{margin:"dense"},MuiIconButton:{size:"small"},MuiInputBase:{margin:"dense"},MuiList:{dense:!0},MuiListItem:{dense:!0},MuiOutlinedInput:{margin:"dense"},MuiFab:{size:"small"},MuiTable:{size:"small"},MuiTextField:{margin:"dense",size:"small"},MuiToolbar:{variant:"dense"},MuiSvgIcon:{fontSize:"small"},MuiToggleButtonGroup:{size:"small"},MuiCheckbox:{size:"small"},MuiLink:{underline:"always"}},overrides:h()};function v(e){var n,t;return e?(null!==(n=e.palette)&&void 0!==n&&n.tertiary&&(e=(0,r.Z)((0,r.Z)({},e),{},{palette:(0,r.Z)((0,r.Z)({},e.palette),{},{tertiary:d.palette.augmentColor(e.palette.tertiary)})})),null!==(t=e.palette)&&void 0!==t&&t.quaternary&&(e=(0,r.Z)((0,r.Z)({},e),{},{palette:(0,r.Z)((0,r.Z)({},e.palette),{},{quaternary:d.palette.augmentColor(e.palette.quaternary)})})),e=(0,r.Z)((0,r.Z)({},e),{},{props:l()({MuiButton:{size:"small"},MuiFilledInput:{margin:"dense"},MuiFormControl:{margin:"dense"},MuiFormHelperText:{margin:"dense"},MuiIconButton:{size:"small"},MuiInputBase:{margin:"dense"},MuiList:{dense:!0},MuiListItem:{dense:!0},MuiOutlinedInput:{margin:"dense"},MuiFab:{size:"small"},MuiTable:{size:"small"},MuiTextField:{margin:"dense",size:"small"},MuiToolbar:{variant:"dense"},MuiSvgIcon:{fontSize:"small"},MuiToggleButtonGroup:{size:"small"},MuiCheckbox:{size:"small"},MuiLink:{underline:"always"}},e.props||{}),overrides:l()(h(e.palette),e.overrides||{})}),(0,c.Z)(l()(g,e))):(0,c.Z)(g)}var m=t(30969),y=t(37574);function b(e){return"black"===e?{midnight:"#808080",forrest:"#666666",grape:"#4d4d4d",mandarin:"#333333",gray:"#1a1a1a"}:"white"===e?{midnight:"#ffffff",forrest:"#e6e6e6",grape:"#cccccc",mandarin:"#b3b3b3",gray:"#999999"}:{midnight:"#0d233f",forrest:"#135560",grape:"#721e63",mandarin:"#ffb11d",gray:"#dadada"}}function w(e){var n=e.variant;return(0,y.jsx)("svg",{viewBox:"0 0 175 175",children:(0,y.jsx)(Z,{variant:n})})}function x(e){var n=e.variant;return(0,y.jsxs)("svg",{viewBox:"0 0 641 175",children:[(0,y.jsx)(k,{variant:n}),(0,y.jsx)(Z,{variant:n})]})}function Z(e){var n=b(e.variant);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{style:{fill:n.midnight},d:"M120.5,57.5c.168,0,.333.012.5.013V40.506c-.167,0-.333-.006-.5-.006a98.325,98.325,0,0,0-77.4,37.565q-2.664,3.378-5.023,6.994l14.206,9.327Q54.043,91.709,56,89.179A81.363,81.363,0,0,1,120.5,57.5Z"}),(0,y.jsx)("path",{style:{fill:n.forrest},d:"M148.668,86.223c.308.133.6.283.908.42l6.746-15.618c-.153-.067-.3-.143-.454-.21a81.36,81.36,0,0,0-71.777,3.5q-2.8,1.544-5.469,3.309l9.249,14.054A63.93,63.93,0,0,1,148.668,86.223Z"}),(0,y.jsx)("path",{style:{fill:n.grape},d:"M170.894,109.37A63.929,63.929,0,0,0,113.4,88.861l2.336,15.474a48.456,48.456,0,0,1,44.322,15.42c.111.125.214.255.324.381l11.16-10C171.323,109.879,171.118,109.62,170.894,109.37Z"}),(0,y.jsx)("path",{style:{fill:n.mandarin},d:"M150.921,150.314c.04.163.07.326.107.489l16.509-4.058c-.039-.163-.067-.326-.107-.489A48.457,48.457,0,0,0,135.575,111.8l-5.515,15.591A32.466,32.466,0,0,1,150.921,150.314Z"}),(0,y.jsx)("path",{style:{fill:n.gray},d:"M134.1,138.129l-9.779,13.213a32.486,32.486,0,0,1,7.823,14.463l15.147.852c.012-.166.032-.331.041-.5A32.464,32.464,0,0,0,134.1,138.129Z"})]})}function k(e){var n=b(e.variant);return(0,y.jsxs)("g",{"aria-label":"JBrowse",transform:"translate(213.084 144.241)",style:{fill:n.midnight},children:[(0,y.jsx)("path",{d:"m 26.355,-71.505 v 54.075 2.835 q 0,6.825 -0.42,10.185 -0.735,5.67 -2.835,9.135 -3.255,5.355 -8.505,8.4 -4.83,2.73 -11.55,3.57 L 1.47,11.76 Q 7.35,10.185 9.24,4.2 10.605,-0.105 10.605,-9.975 v -5.565 -55.965 q 1.785,0 4.62,0.315 2.835,0.21 3.255,0.21 1.785,0 2.94,-0.105 4.515,-0.42 4.935,-0.42 z"}),(0,y.jsx)("path",{d:"m 60.68836,-65.415 v 24.78 h 3.255 q 2.94,0 4.935,-0.525 2.1,-0.525 3.885,-2.1 2.31,-1.995 3.36,-4.83 1.155,-2.835 1.155,-6.09 0,-5.565 -2.94,-8.61 -2.94,-3.045 -8.295,-3.045 -2.52,0 -5.355,0.42 z m 0,30.87 V -6.09 h 5.25 q 4.725,0 8.505,-3.675 3.885,-3.78 3.885,-10.08 0,-8.19 -4.62,-11.655 -4.095,-3.045 -13.02,-3.045 z M 44.93836,0 v -71.505 h 27.09 q 9.135,0 14.385,3.255 6.51,3.99 6.51,12.6 0,7.035 -5.25,11.655 -4.62,4.095 -11.97,5.145 v 0.945 q 7.56,0.735 12.285,3.99 6.615,4.62 6.615,13.335 0,10.185 -7.98,15.75 -6.93,4.83 -17.43,4.83 z"}),(0,y.jsx)("path",{d:"M 109.44281,0.525 V -50.4 q 1.785,0.21 3.99,0.42 2.31,0.105 3.255,0.105 2.31,0 4.2,-0.21 1.89,-0.21 3.045,-0.315 v 13.02 q 1.89,-6.51 5.46,-9.87 4.41,-4.095 11.655,-4.095 -0.315,2.73 -0.42,6.825 -0.105,3.99 -0.105,7.455 l -0.945,0.84 q -0.945,-0.735 -2.415,-1.05 -1.47,-0.315 -2.94,-0.315 -3.57,0 -6.195,1.89 -2.52,1.785 -3.465,5.04 -0.42,1.155 -0.525,3.15 -0.105,1.89 -0.105,4.515 v 4.515 19.005 q -1.785,-0.21 -2.625,-0.21 -3.675,-0.315 -4.62,-0.315 -2.31,0 -4.2,0.21 -1.89,0.21 -3.045,0.315 z"}),(0,y.jsx)("path",{d:"m 173.77337,1.47 q -11.655,0 -18.585,-6.825 -6.93,-6.825 -6.93,-18.48 0,-12.6 6.72,-20.055 6.825,-7.455 18.9,-7.455 11.97,0 18.9,6.72 6.93,6.72 6.93,18.48 0,12.285 -6.72,19.74 -7.14,7.875 -19.215,7.875 z m 0.735,-48.09 q -5.88,0 -8.505,6.51 -2.205,5.565 -2.205,15.96 0,8.19 1.47,12.915 2.415,7.98 8.505,7.98 5.565,0 8.19,-7.875 2.205,-6.51 2.205,-16.695 0,-8.505 -2.1,-13.23 -2.52,-5.565 -7.56,-5.565 z"}),(0,y.jsx)("path",{d:"m 222.03563,-50.4 10.5,36.015 q 3.675,-11.235 5.67,-17.85 2.415,-8.085 5.04,-18.165 1.05,0.105 3.045,0.315 2.1,0.21 2.835,0.21 1.995,0 3.15,-0.105 1.26,-0.21 2.73,-0.42 l 10.71,36.015 q 5.88,-17.43 10.71,-36.015 l 4.2,0.315 4.095,-0.315 q -5.145,13.125 -9.135,24.57 -5.04,14.28 -8.505,26.355 -1.89,-0.21 -3.36,-0.42 -1.365,-0.105 -2.205,-0.105 -1.89,0 -3.36,0.21 -1.365,0.21 -2.31,0.315 l -10.605,-34.755 q -4.41,13.65 -6.72,21.105 -2.31,7.35 -4.095,13.65 -1.89,-0.21 -3.36,-0.42 -1.365,-0.105 -2.31,-0.105 -1.995,0 -3.465,0.21 -1.365,0.21 -2.31,0.315 -3.78,-12.81 -5.04,-17.01 -2.205,-7.245 -5.46,-17.01 -2.835,-8.4 -5.88,-16.905 1.575,0 4.305,0.315 2.73,0.21 3.36,0.21 1.47,0 4.305,-0.21 2.835,-0.315 3.465,-0.315 z"}),(0,y.jsx)("path",{d:"m 292.84172,-12.81 h 2.625 q 1.47,4.095 4.62,6.51 3.15,2.415 7.35,2.415 2.94,0 5.46,-1.785 2.625,-1.89 2.625,-4.62 0,-3.885 -6.195,-6.615 -10.395,-4.62 -11.655,-5.46 -6.405,-4.515 -6.405,-12.285 0,-7.77 5.25,-12.18 5.25,-4.515 12.81,-4.515 3.99,0 8.085,1.365 4.095,1.26 7.14,3.57 l -2.52,9.24 h -2.94 q -0.63,-3.57 -3.57,-6.195 -2.835,-2.625 -6.405,-2.625 -3.15,0 -5.46,1.575 -2.31,1.47 -2.31,4.515 0,3.885 6.405,6.51 10.185,4.095 11.865,5.25 6.405,4.41 6.405,12.81 0,7.455 -5.46,12.18 -5.355,4.62 -14.805,4.62 -8.19,0 -14.49,-4.305 z"}),(0,y.jsx)("path",{d:"m 349.61228,-29.925 h 15.54 q 0,-6.51 -1.05,-10.395 -1.68,-6.3 -5.88,-6.3 -5.04,0 -7.14,6.195 -1.47,4.305 -1.47,10.5 z m 30.03,5.04 h -30.03 q 0,9.135 3.045,13.86 3.57,5.67 11.55,5.67 3.255,0 6.405,-1.26 3.15,-1.26 5.88,-3.465 l 1.26,0.945 -2.31,5.88 q -6.72,4.725 -15.015,4.725 -12.915,0 -19.635,-7.245 -6.72,-7.245 -6.72,-20.37 0,-11.235 6.405,-18.165 6.51,-7.035 17.64,-7.035 11.655,0 16.905,7.56 4.62,6.615 4.62,18.9 z"})]})}var S=t(96234),j=t(22714),C=t(58257),T=t(36051),M=t(317),E=t(51526),A=t(80975),P=t(43175),I=t(1720),R=t(28599),N=t(22248),D=t(94727),W=t(90550),O=t(40909),L=t(9077),B=t(80303),z=t(31631),U=t(78033),F=t(72434),J=t(78734),q=(0,j.Z)((function(e){return{"@global":{html:{"font-family":"Roboto"},"*":{"scrollbar-width":"auto","scrollbar-color":"rgba(0,0,0,.5) rgba(128,128,128)"},"*::-webkit-scrollbar":{"-webkit-appearance":"none",width:"12px"},"*::-webkit-scrollbar-thumb":{"background-color":"rgba(0,0,0,.5)","-webkit-box-shadow":"0 0 1px rgba(255,255,255,.5)"}},root:{display:"grid",height:"100vh",width:"100%"},fabLeft:{zIndex:1e4,position:"fixed",bottom:e.spacing(2),left:e.spacing(2)},fabRight:{zIndex:1e4,position:"fixed",bottom:e.spacing(2),right:e.spacing(2)},menuBarAndComponents:{gridColumn:"main",display:"grid",gridTemplateRows:"[menubar] min-content [components] auto",height:"100vh"},menuBar:{gridRow:"menubar"},components:{overflowY:"auto",gridRow:"components"},appBar:{flexGrow:1},grow:{flexGrow:1},inputBase:{color:e.palette.primary.contrastText},inputRoot:{"&:hover":{backgroundColor:e.palette.primary.light}},inputFocused:{borderColor:e.palette.secondary.main,backgroundColor:e.palette.primary.light},selectPaper:{padding:e.spacing(4)}}})),_=(0,W.observer)((function(e){var n=e.session.configuration,t=(0,L.readConfObject)(n,"logoPath");return null!==t&&void 0!==t&&t.uri?(0,y.jsx)("img",{src:t.uri,alt:"Custom logo"}):(0,y.jsx)(x,{variant:"white"})})),V=(0,W.observer)((function(e){var n,t,i=e.session,a=e.HeaderButtons,o=void 0===a?(0,y.jsx)("div",{}):a,s=q(),c=(0,O.getEnv)(i).pluginManager,u=c.getElementTypeRecord("view").all(),l=(0,m.useState)(null===(n=u[0])||void 0===n?void 0:n.name),d=(0,S.Z)(l,2),f=d[0],p=d[1],h=i.visibleWidget,g=i.drawerWidth,v=i.minimized,b=i.activeWidgets,w=i.savedSessionNames,x=i.name,Z=i.menus,k=i.views,j=i.drawerPosition;var W,L=h&&!v;return"right"===j?W=["[main] 1fr",L?"[drawer] ".concat(g,"px"):void 0]:"left"===j&&(W=[L?"[drawer] ".concat(g,"px"):void 0,"[main] 1fr"]),(0,y.jsxs)("div",{className:s.root,style:{gridTemplateColumns:null===(t=W)||void 0===t?void 0:t.filter((function(e){return!!e})).join(" ")},children:[L&&"left"===j?(0,y.jsx)(B.Z,{session:i}):null,i.DialogComponent?(0,y.jsx)(m.Suspense,{fallback:(0,y.jsx)("div",{}),children:(0,y.jsx)(i.DialogComponent,(0,r.Z)({},i.DialogProps))}):null,(0,y.jsxs)("div",{className:s.menuBarAndComponents,children:[(0,y.jsx)("div",{className:s.menuBar,children:(0,y.jsx)(C.Z,{className:s.appBar,position:"static",children:(0,y.jsxs)(T.Z,{children:[Z.map((function(e){return(0,y.jsx)(z.Z,{menuTitle:e.label,menuItems:e.menuItems,session:i},e.label)})),(0,y.jsx)("div",{className:s.grow}),(0,y.jsx)(M.ZP,{title:"Rename Session",arrow:!0,children:(0,y.jsx)(U.Z,{value:x,setValue:function(e){null!==w&&void 0!==w&&w.includes(e)?i.notify('Cannot rename session to "'.concat(e,'", a saved session with that name already exists'),"warning"):i.renameCurrentSession(e)},variant:"body1",classes:{inputBase:s.inputBase,inputRoot:s.inputRoot,inputFocused:s.inputFocused}})}),o,(0,y.jsx)("div",{className:s.grow}),(0,y.jsx)("div",{style:{width:150,maxHeight:48},children:(0,y.jsx)(_,{session:i})})]})})}),(0,y.jsxs)("div",{className:s.components,children:[k.length?k.map((function(e){var n=c.getViewType(e.type);if(!n)throw new Error("unknown view type ".concat(e.type));var t=n.ReactComponent;return(0,y.jsx)(J.Z,{view:e,onClose:function(){return i.removeView(e)},children:(0,y.jsx)(m.Suspense,{fallback:(0,y.jsx)("div",{children:"Loading..."}),children:(0,y.jsx)(t,{model:e,session:i,getTrackType:c.getTrackType})})},"view-".concat(e.id))})):(0,y.jsxs)(E.Z,{className:s.selectPaper,children:[(0,y.jsx)(A.Z,{children:"Select a view to launch"}),(0,y.jsx)(P.Z,{value:f,onChange:function(e){return p(e.target.value)},children:u.map((function(e){var n=e.name;return(0,y.jsx)(I.Z,{value:n,children:n},n)}))}),(0,y.jsx)(R.Z,{onClick:function(){i.addView(f,{})},variant:"contained",color:"primary",children:"Launch view"})]}),(0,y.jsx)("div",{style:{height:300}})]})]}),b.size>0&&v?(0,y.jsx)(M.ZP,{title:"Open drawer widget",children:(0,y.jsx)(N.Z,{className:"right"===j?s.fabRight:s.fabLeft,color:"primary","data-testid":"drawer-maximize",onClick:function(){return i.showWidgetDrawer()},children:(0,y.jsx)(D.Z,{})})}):null,L&&"right"===j?(0,y.jsx)(B.Z,{session:i}):null,(0,y.jsx)(F.Z,{session:i})]})})),H=t(83483),G=t(64501),Q=t(32343),K=t(89001),$=t(93138),Y=t(53033),X=t(14008),ee=(0,j.Z)((function(e){return{closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}));var ne=(0,W.observer)((function(e){var n=e.model,t=e.handleClose,r=ee();return(0,y.jsxs)(H.Z,{maxWidth:"xl",open:!0,onClose:t,children:[(0,y.jsxs)(G.Z,{children:["Reference sequence",t?(0,y.jsx)(Q.Z,{className:r.closeButton,onClick:function(){return t()},children:(0,y.jsx)(X.Z,{})}):null]}),(0,y.jsx)(K.Z,{}),(0,y.jsx)($.Z,{children:(0,y.jsx)(A.Z,{children:"Are you sure you want to return to the import form? This will lose your current view"})}),(0,y.jsxs)(Y.Z,{children:[(0,y.jsx)(R.Z,{onClick:function(){n.clearView(),t()},variant:"contained",color:"primary",autoFocus:!0,children:"OK"}),(0,y.jsx)(R.Z,{onClick:function(){return t()},color:"secondary",variant:"contained",children:"Cancel"})]})]})})),te=t(16383),re=t(84291),ie=t(98553),ae=t(66025);function oe(e){var n=e.width,t=e.height,i=e.highResolutionScaling,a=e.style,o=e.imageData,s=e.blockKey,c=e.showSoftClip,u=(0,m.useRef)(null);(0,m.useEffect)((function(){if(o){var e=u.current;if(e){var n=e.getContext("2d");n&&(0,ae.kv)(o,n)}}}),[o]);var l=s?"_"+s:"",d="prerendered_canvas".concat(c?"_softclipped":"").concat(l);return(0,y.jsx)("canvas",{"data-testid":d,ref:u,width:n*i,height:t*i,style:(0,r.Z)({width:n,height:t},a)})}oe.defaultProps={imageData:void 0,highResolutionScaling:1,style:{}};var se=oe,ce=t(26737),ue=t(88896),le=(0,j.Z)({hoverLabel:{border:"1px solid black",position:"absolute",background:"#fffa",pointerEvents:"none",zIndex:1e4}}),de=(0,W.observer)((function(e){var n=e.offsetX,t=e.offsetY,r=e.configuration,i=e.feature,a=e.timeout,o=void 0===a?300:a,s=le(),c=(0,m.useState)(!1),u=(0,S.Z)(c,2),l=u[0],d=u[1];if((0,m.useEffect)((function(){var e=setTimeout((function(){return d(!0)}),o);return function(){return clearTimeout(e)}})),i&&l){var f=(0,L.readConfObject)(r,"mouseover",{feature:i});return(0,y.jsx)("div",{className:s.hoverLabel,style:{left:n,top:t},children:f})}return null})),fe=t(60092),pe=t(76770),he=t(99537),ge=t(36174)},63409:function(e,n,t){"use strict";var r=t(32723),i=t(96234),a=t(41361),o=t(9249),s=t(87371),c=function(e){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,o.Z)(this,n),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}return(0,s.Z)(n,[{key:"_set",value:function(e,n){this.cache.set(e,n),this._size+=1,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}},{key:"get",value:function(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){var n=this.oldCache.get(e);return this.oldCache.delete(e),this._set(e,n),n}}},{key:"set",value:function(e,n){return this.cache.has(e)?this.cache.set(e,n):this._set(e,n),this}},{key:"has",value:function(e){return this.cache.has(e)||this.oldCache.has(e)}},{key:"peek",value:function(e){return this.cache.has(e)?this.cache.get(e):this.oldCache.has(e)?this.oldCache.get(e):void 0}},{key:"delete",value:function(e){var n=this.cache.delete(e);return n&&(this._size-=1),this.oldCache.delete(e)||n}},{key:"clear",value:function(){this.cache.clear(),this.oldCache.clear(),this._size=0}},{key:"keys",value:(0,r.Z)().mark((function e(){var n,t,o,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,a.Z)(this),e.prev=1,n.s();case 3:if((t=n.n()).done){e.next=9;break}return o=(0,i.Z)(t.value,1),s=o[0],e.next=7,s;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"values",value:(0,r.Z)().mark((function e(){var n,t,o,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,a.Z)(this),e.prev=1,n.s();case 3:if((t=n.n()).done){e.next=9;break}return o=(0,i.Z)(t.value,2),s=o[1],e.next=7,s;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:e,value:(0,r.Z)().mark((function e(){var n,t,o,s,c,u,l,d;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,a.Z)(this.cache),e.prev=1,n.s();case 3:if((t=n.n()).done){e.next=9;break}return o=t.value,e.next=7,o;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:s=(0,a.Z)(this.oldCache),e.prev=18,s.s();case 20:if((c=s.n()).done){e.next=28;break}if(u=c.value,l=(0,i.Z)(u,1),d=l[0],this.cache.has(d)){e.next=26;break}return e.next=26,u;case 26:e.next=20;break;case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(18),s.e(e.t1);case 33:return e.prev=33,s.f(),e.finish(33);case 36:case"end":return e.stop()}}),e,this,[[1,11,14,17],[18,30,33,36]])}))},{key:"size",get:function(){var e,n=0,t=(0,a.Z)(this.oldCache.keys());try{for(t.s();!(e=t.n()).done;){var r=e.value;this.cache.has(r)||(n+=1)}}catch(i){t.e(i)}finally{t.f()}return this._size+n}}]),n}(Symbol.iterator);n.Z=c},55429:function(e,n,t){"use strict";t.d(n,{ML:function(){return g},N7:function(){return y},O8:function(){return p},fP:function(){return m},zF:function(){return b}});var r=t(32723),i=t(34795),a=t(87371),o=t(9249),s=t(45754),c=t(86906),u=t(25991),l=t(45996),d=t(69002),f=function(e){(0,s.Z)(t,e);var n=(0,c.Z)(t);function t(){var e;(0,o.Z)(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=n.call.apply(n,[this].concat(i))).code=void 0,e}return(0,a.Z)(t)}((0,u.Z)(Error));function p(e){if(e){if(!(e instanceof AbortSignal))throw new TypeError("must pass an AbortSignal");if(e.aborted)throw m()}}function h(e){return new Promise((function(n){return setTimeout(n,e)}))}function g(e){return v.apply(this,arguments)}function v(){return(v=(0,i.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(1);case 2:p(n);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){if("undefined"!==typeof DOMException)return new DOMException("aborted","AbortError");var e=new f("aborted");return e.code="ERR_ABORTED",e}function y(e){return e?(0,d.R)(e,"abort"):l.y.create()}function b(e){return e instanceof Error&&("AbortError"===e.name||"ERR_ABORTED"===e.code||!!e.message.match(/\b(aborted|AbortError)\b/i))}},66025:function(e,n,t){"use strict";t.d(n,{Ck:function(){return a},MC:function(){return i},kv:function(){return d},vL:function(){return r}});var r,i,a,o=t(32723),s=t(34795),c=t(88778),u=t.n(c),l=t(41496);function d(e,n){e.serializedCommands?new l.CanvasSequence(e.serializedCommands).execute(n):n.drawImage(e,0,0)}var f="function"===typeof OffscreenCanvas,p=u();f?(r=function(e,n){return new OffscreenCanvas(e,n)},i=window.createImageBitmap||self.createImageBitmap,a=window.ImageBitmap||self.ImageBitmap):p?(r=function(){return nodeCreateCanvas.apply(void 0,arguments)},i=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(n){var t,r,i=arguments;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.length<=1||!(i.length-1)){e.next=2;break}throw new Error("only one-argument uses of createImageBitmap are supported by the node offscreencanvas ponyfill");case 2:return t=n.toDataURL(),r=new nodeImage,e.abrupt("return",new Promise((function(e,n){r.onload=function(){return e(r)},r.onerror=n,r.src=t})));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()):(r=function(e,n){var t=new l.CanvasSequence;return{width:e,height:n,getContext:function(){return t}}},i=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(n){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.getContext("2d"),e.abrupt("return",{height:n.height,width:n.width,serializedCommands:t.toJSON(),containsNoTransferables:!0});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),a=String)},54306:function(e,n,t){"use strict";t.d(n,{C:function(){return u}});var r=t(32723),i=t(34795),a=(t(30969),t(66025)),o=t(41496),s=t(81073),c=t(37574);function u(e,n,t,r){return l.apply(this,arguments)}function l(){return(l=(0,i.Z)((0,r.Z)().mark((function e(n,t,i,u){var l,d,f,p,h,g,v,m,y;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=i.exportSVG,d=i.highResolutionScaling,f=void 0===d?1:d,!l){e.next=37;break}if(l.rasterizeLayers){e.next=9;break}return p=new o.CanvasSequence,e.next=6,u(p);case 6:return e.abrupt("return",{canvasRecordedData:p.toJSON()});case 9:if(h=4,g=(0,a.vL)(Math.ceil(n*h),t*h),v=g.getContext("2d")){e.next=14;break}throw new Error("2d canvas rendering not supported on this platform");case 14:return v.scale(h,h),e.next=17,u(v);case 17:if(e.t0=c.jsx,e.t1=n,e.t2=t,!("convertToBlob"in g)){e.next=30;break}return e.t4=s.blobToDataURL,e.next=24,g.convertToBlob({type:"image/png"});case 24:return e.t5=e.sent,e.next=27,(0,e.t4)(e.t5);case 27:e.t3=e.sent,e.next=31;break;case 30:e.t3=g.toDataURL();case 31:return e.t6=e.t3,e.t7={width:e.t1,height:e.t2,xlinkHref:e.t6},e.t8=(0,e.t0)("image",e.t7),e.abrupt("return",{reactElement:e.t8});case 35:e.next=48;break;case 37:if(m=(0,a.vL)(Math.ceil(n*f),t*f),y=m.getContext("2d")){e.next=41;break}throw new Error("2d canvas rendering not supported on this platform");case 41:return y.scale(f,f),e.next=44,u(y);case 44:return e.next=46,(0,a.MC)(m);case 46:return e.t9=e.sent,e.abrupt("return",{imageData:e.t9});case 48:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},8438:function(e,n,t){"use strict";t.d(n,{BQ:function(){return l},J0:function(){return k},Ms:function(){return C},PK:function(){return T},Um:function(){return x},Z6:function(){return M},_L:function(){return p},cX:function(){return f},d6:function(){return b},dc:function(){return Z},gC:function(){return g},gI:function(){return h},hb:function(){return S},k$:function(){return d},uF:function(){return v},yZ:function(){return w},yb:function(){return j},zL:function(){return m},zN:function(){return y}});var r=t(87371),i=t(9249),a=t(80753),o=t(45754),s=t(86906),c=t(25991),u=t(40909);function l(e){return(0,u.isStateTreeNode)(e)&&"removeView"in e&&"addView"in e&&"views"in e}function d(e){return"object"===typeof e&&null!==e&&"rpcManager"in e&&"configuration"in e}function f(e){return d(e)&&"editConfiguration"in e}function p(e){return d(e)&&"addTrackConf"in e}function h(e){return d(e)&&"widgets"in e}function g(e){return d(e)&&"addConnectionConf"in e}function v(e){return d(e)&&"sessionPlugins"in e}function m(e){return"object"===typeof e&&null!==e&&"selection"in e&&"setSelection"in e}function y(e){return"object"===typeof e&&null!==e&&"width"in e&&"setWidth"in e}function b(e){return"object"===typeof e&&null!==e&&"configuration"in e&&e.configuration.trackId}function w(e){return"object"===typeof e&&null!==e&&"configuration"in e&&e.configuration.displayId}function x(e){return"object"===typeof e&&null!==e&&"showTrack"in e&&"hideTrack"in e}function Z(e){return"object"===typeof e&&null!==e&&"isAssemblyEditing"in e&&"findAppropriateInternetAccount"in e}function k(e){return"object"===typeof e&&null!==e&&"appendMenu"in e&&"appendToSubMenu"in e}function S(e){return"object"===typeof e&&null!==e&&"locationType"in e&&"uri"in e}var j=function(e){(0,o.Z)(t,e);var n=(0,s.Z)(t);function t(e,r){var o;return(0,i.Z)(this,t),(o=n.call(this,e)).message=e,o.url=r,o.name="AuthNeededError",Object.setPrototypeOf((0,a.Z)(o),t.prototype),o}return(0,r.Z)(t)}((0,c.Z)(Error)),C=function(e){(0,o.Z)(t,e);var n=(0,s.Z)(t);function t(e,r){var a;return(0,i.Z)(this,t),(a=n.call(this,e)).message=e,a.internetAccountId=r,a.name="RetryError",a}return(0,r.Z)(t)}((0,c.Z)(Error));function T(e){return e instanceof Error&&("AuthNeededError"===e.name||void 0!==e.url)}function M(e){return"RetryError"===e.name||void 0!==e.internetAccountId}},26132:function(e,n,t){"use strict";t.d(n,{g:function(){return s},q:function(){return c}});var r=t(32723),i=t(34795),a=t(35247),o=t(55429);function s(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.timeout,r=n.signal,i=n.name;return new Promise((function(n,s){var c,u=!1,l=(0,a.when)(e),d=function(){};t&&(c=setTimeout((function(){u||(u=!0,l.cancel(),s(new Error("timed out waiting for ".concat(i||"whenPresent"))))}),t),d=function(){return c&&clearTimeout(c)}),r&&r.addEventListener("abort",(function(){u||(u=!0,l.cancel(),d(),s((0,o.fP)()))})),l.then((function(){u||(u=!0,d(),n(!0))})).catch((function(e){u||(u=!0,d(),s(e))}))}))}function c(e){return u.apply(this,arguments)}function u(){return u=(0,i.Z)((0,r.Z)().mark((function e(n){var t,i=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>1&&void 0!==i[1]?i[1]:{},e.next=3,s((function(){var e=n();return void 0!==e&&null!==e}),t);case 3:return e.abrupt("return",n());case 4:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}},53276:function(e,n,t){"use strict";t.r(n),t.d(n,{Loader:function(){return sr},default:function(){return pr}});var r=t(68079),i=t(32723),a=t(34795),o=t(33028),s=t(59740),c=t(96234),u=(t(84933),t(43064),t(59389),t(34466),t(11691),t(50893),t(32752),t(39867),t(71816),t(77351),t(62770),t(73427),t(22705),t(11672),t(41217),t(48841),t(72345),t(14366),t(37824),t(59039),t(67773),t(95922),t(21870),t(73767),t(28222),t(81837),t(91375),t(17996),t(45514),t(41536),t(56725),t(21400),t(86498),t(63108),t(41981),t(36948),t(86858),t(91435),t(92707),t(31497),t(27913),t(79826),t(17364),t(93051),t(92456),t(54798),t(21700),t(53176),t(51674),t(27422),t(99007),t(71873),t(2504),t(37419),t(56347),t(15279),t(69605),t(47419),t(36220),t(97339),t(33859),t(10116),t(9508),t(34010),t(21230),t(80465),t(94157),t(42195),t(77212),t(36308),t(21288),t(87370),t(44101),t(79001),t(26839),t(72315),t(93256),t(12860),t(32767),t(74792),t(27719),t(74106),t(14602),t(82256),t(92646),t(627),t(44633),t(5166),t(48629),t(38640),t(67460),t(79471),t(90224),t(1502),t(31823),t(59291),t(79775),t(69056),t(18122),t(58533),t(28813),t(96674),t(28091),t(11681),t(86670),t(60106),t(51571),t(67951),t(92543),t(2403),t(43847),t(46658),t(16567),t(21680),t(70389),t(65984),t(45220),t(36195),t(10798),t(10417),t(16823),t(80509),t(45933),t(92925),t(48847),t(67171),t(88290),t(80499),t(60164),t(94049),t(7348),t(75161),t(29894),t(32283),t(55074),t(50750),t(91605),t(9865),t(93640),t(94759),t(50164),t(11712),t(15225),t(8386),t(76515),t(8826),t(42788),t(61184),t(24704),t(65269),t(21944),t(34458),t(72161),t(14281),t(17443),t(24380),t(82759),t(73460),t(55910),t(63634),t(8636),t(38404),t(8376),t(8791),t(89799),t(29027),t(57367),t(5743),t(28632),t(44910),t(78014),t(40750),t(24179),t(24126),t(71423),t(58590),t(64674),t(60386),t(86447),t(40145),t(16185),t(27847),t(50210),t(30959),t(22283),t(26004),t(46555),t(36946),t(11940),t(50920),t(90698),t(17299),t(30969)),l=t(41361),d=t(9249),f=t(87371),p=t(40909),h=t(86297),g=t(93029),v=t(82044),m=t(81575),y=t(39798),b=t(66737),w=t(58096),x=t(71036),Z=t(15875),k=t(31145),S=t(9077),j=t(49767),C=t(10840),T=t(2171),M=t(11192),E=function(){function e(){(0,d.Z)(this,e),this.phaseCallbacks=new Map,this.phaseOrder=[];for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];this.phaseOrder=t}return(0,f.Z)(e,[{key:"add",value:function(e,n){if(!this.phaseOrder.includes(e))throw new Error("unknown phase ".concat(e));var t=this.phaseCallbacks.get(e);t||(t=[],this.phaseCallbacks.set(e,t)),t.push(n)}},{key:"run",value:function(){var e=this;this.phaseOrder.forEach((function(n){var t;null===(t=e.phaseCallbacks.get(n))||void 0===t||t.forEach((function(e){return e()}))}))}}]),e}(),A=function(){function e(n,t){(0,d.Z)(this,e),this.typeName=n,this.baseClass=t,this.registeredTypes={}}return(0,f.Z)(e,[{key:"add",value:function(e,n){this.registeredTypes[e]=n}},{key:"has",value:function(e){return e in this.registeredTypes}},{key:"get",value:function(e){if(!this.has(e))throw new Error("".concat(this.typeName," '").concat(e,"' not found, perhaps its plugin is not loaded or its plugin has not added it."));return this.registeredTypes[e]}},{key:"all",value:function(){return Object.values(this.registeredTypes)}}]),e}(),P=function(){function e(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,d.Z)(this,e),this.plugins=[],this.jexl=(0,M.Z)(),this.pluginMetadata={},this.runtimePluginDefinitions=[],this.elementCreationSchedule=new E("renderer","adapter","text search adapter","display","track","connection","view","widget","rpc method","internet account"),this.rendererTypes=new A("RendererType",h.default),this.adapterTypes=new A("AdapterType",g.Z),this.textSearchAdapterTypes=new A("TextSearchAdapterType",k.Z),this.trackTypes=new A("TrackType",v.Z),this.displayTypes=new A("DisplayType",m.Z),this.connectionTypes=new A("ConnectionType",w.Z),this.viewTypes=new A("ViewType",y.Z),this.widgetTypes=new A("WidgetType",b.Z),this.rpcMethods=new A("RpcMethodType",x.Z),this.internetAccountTypes=new A("InternetAccountType",Z.Z),this.configured=!1,this.rootModel=void 0,this.extensionPoints=new Map,this.jbrequireCache=new Map,this.lib=C.Z,this.load=function(e){return n.jbrequireCache.has(e)||n.jbrequireCache.set(e,e(n)),n.jbrequireCache.get(e)},this.jbrequire=function(e){if("string"===typeof e){var t=n.lib[e];if(!t)throw new TypeError("No jbrequire re-export defined for package '".concat(e,"'. If this package must be shared between plugins, add it to ReExports.js. If it does not need to be shared, just import it normally."));return t}if("function"===typeof e)return n.load(e);if(e.default)return n.jbrequire(e.default);throw new TypeError("lib passed to jbrequire must be either a string or a function")},this.addPlugin({plugin:new T.Z,metadata:{isCore:!0}}),t.forEach((function(e){n.addPlugin(e)}))}return(0,f.Z)(e,[{key:"pluginConfigurationSchemas",value:function(){var e={};return this.plugins.forEach((function(n){n.configurationSchema&&(e[n.name]=n.configurationSchema)})),e}},{key:"addPlugin",value:function(e){if(this.configured)throw new Error("JBrowse already configured, cannot add plugins");var n=e instanceof j.Z?[e,{}]:[e.plugin,e.metadata],t=(0,c.Z)(n,2),r=t[0],i=t[1],a=void 0===i?{}:i;if(this.plugins.includes(r))throw new Error("plugin already installed");return this.pluginMetadata[r.name]=a,"definition"in e&&this.runtimePluginDefinitions.push(e.definition),r.install(this),this.plugins.push(r),this}},{key:"getPlugin",value:function(e){return this.plugins.find((function(n){return n.name===e}))}},{key:"hasPlugin",value:function(e){return void 0!==this.getPlugin(e)}},{key:"createPluggableElements",value:function(){return this.elementCreationSchedule&&(this.elementCreationSchedule.run(),delete this.elementCreationSchedule),this}},{key:"setRootModel",value:function(e){this.rootModel=e}},{key:"configure",value:function(){var e=this;if(this.configured)throw new Error("already configured");return this.plugins.forEach((function(n){return n.configure(e)})),this.configured=!0,this}},{key:"getElementTypeRecord",value:function(e){switch(e){case"adapter":return this.adapterTypes;case"text search adapter":return this.textSearchAdapterTypes;case"connection":return this.connectionTypes;case"widget":return this.widgetTypes;case"renderer":return this.rendererTypes;case"display":return this.displayTypes;case"track":return this.trackTypes;case"view":return this.viewTypes;case"rpc method":return this.rpcMethods;case"internet account":return this.internetAccountTypes;default:throw new Error("invalid element type '".concat(e,"'"))}}},{key:"addElementType",value:function(e,n){var t=this;if("function"!==typeof n)throw new Error("must provide a callback function that returns the new type object");var r=this.getElementTypeRecord(e);return this.elementCreationSchedule&&this.elementCreationSchedule.add(e,(function(){var i=n(t);if(!i.name)throw new Error("cannot add a ".concat(e," with no name"));if(r.has(i.name))throw new Error("".concat(e," ").concat(i.name," already registered, cannot register it again"));i=t.evaluateExtensionPoint("Core-extendPluggableElement",i),r.add(i.name,i)})),this}},{key:"getElementType",value:function(e,n){return this.getElementTypeRecord(e).get(n)}},{key:"getElementTypesInGroup",value:function(e){return this.getElementTypeRecord(e).all()}},{key:"pluggableMstType",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p.types.maybe(p.types.null),i=this.getElementTypeRecord(e).all().map((function(e){return e[n]})).filter((function(e){return(0,p.isType)(e)&&(0,p.isModelType)(e)}));return 0===i.length?(console.warn("No JBrowse pluggable types found matching ('".concat(e,"','").concat(n,"')")),t):p.types.union.apply(p.types,(0,r.Z)(i))}},{key:"pluggableConfigSchemaType",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"configSchema",t=this.getElementTypeRecord(e).all().map((function(e){return e[n]})).filter((function(e){return(0,S.isBareConfigurationSchemaType)(e)}));return 0===t.length&&t.push((0,S.ConfigurationSchema)("Null",{})),p.types.union.apply(p.types,(0,r.Z)(t))}},{key:"getRendererType",value:function(e){return this.rendererTypes.get(e)}},{key:"getRendererTypes",value:function(){return this.rendererTypes.all()}},{key:"getAdapterType",value:function(e){return this.adapterTypes.get(e)}},{key:"getTextSearchAdapterType",value:function(e){return this.textSearchAdapterTypes.get(e)}},{key:"getTrackType",value:function(e){return this.trackTypes.get(e)}},{key:"getDisplayType",value:function(e){return this.displayTypes.get(e)}},{key:"getViewType",value:function(e){return this.viewTypes.get(e)}},{key:"getWidgetType",value:function(e){return this.widgetTypes.get(e)}},{key:"getConnectionType",value:function(e){return this.connectionTypes.get(e)}},{key:"getRpcMethodType",value:function(e){return this.rpcMethods.get(e)}},{key:"getInternetAccountType",value:function(e){return this.internetAccountTypes.get(e)}},{key:"addRendererType",value:function(e){return this.addElementType("renderer",e)}},{key:"addAdapterType",value:function(e){return this.addElementType("adapter",e)}},{key:"addTextSearchAdapterType",value:function(e){return this.addElementType("text search adapter",e)}},{key:"addTrackType",value:function(e){var n=this;return this.addElementType("track",(function(){var t=e(n);return n.getElementTypesInGroup("display").forEach((function(e){e.trackType!==t.name||t.displayTypes.includes(e)||t.addDisplayType(e)})),t}))}},{key:"addDisplayType",value:function(e){return this.addElementType("display",e)}},{key:"addViewType",value:function(e){var n=this;return this.addElementType("view",(function(){var t=e(n);return n.getElementTypesInGroup("display").forEach((function(e){e.viewType!==t.name||t.displayTypes.includes(e)||t.addDisplayType(e)})),t}))}},{key:"addWidgetType",value:function(e){return this.addElementType("widget",e)}},{key:"addConnectionType",value:function(e){return this.addElementType("connection",e)}},{key:"addRpcMethod",value:function(e){return this.addElementType("rpc method",e)}},{key:"addInternetAccountType",value:function(e){return this.addElementType("internet account",e)}},{key:"addToExtensionPoint",value:function(e,n){var t=this.extensionPoints.get(e);t||(t=[],this.extensionPoints.set(e,t)),t.push(n)}},{key:"evaluateExtensionPoint",value:function(e,n){var t=this.extensionPoints.get(e),r=n;if(t){var i,a=(0,l.Z)(t);try{for(a.s();!(i=a.n()).done;){var o=i.value;try{r=o(r)}catch(s){console.error(s)}}}catch(c){a.e(c)}finally{a.f()}}return r}},{key:"evaluateAsyncExtensionPoint",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,t){var r,a,o,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.extensionPoints.get(n),a=t,!r){e.next=27;break}o=(0,l.Z)(r),e.prev=4,o.s();case 6:if((s=o.n()).done){e.next=19;break}return c=s.value,e.prev=8,e.next=11,c(a);case 11:a=e.sent,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(8),console.error(e.t0);case 17:e.next=6;break;case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(4),o.e(e.t1);case 24:return e.prev=24,o.f(),e.finish(24);case 27:return e.abrupt("return",a);case 28:case"end":return e.stop()}}),e,this,[[4,21,24,27],[8,14]])})));return function(n,t){return e.apply(this,arguments)}}()}]),e}(),I=t(90550),R=t(81073),N=t(51921),D=t(15754),W=t(24998),O=(t(23440),t(65048),t(81700)),L=t(22809),B=t.n(L);function z(){return(z=(0,a.Z)((0,i.Z)().mark((function e(n,t,r){var a,o,s,c,u,l,d,f,p,h;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"https://analytics.jbrowse.org/api/v1",a=n.jbrowse.tracks.filter((function(e){return((0,S.readConfObject)(e,"assemblyNames")||[]).length>1})).length,o=Object.keys(localStorage).filter((function(e){return e.includes("localSaved-")})).length,s=n.jbrowse,c=n.session,u=n.version,l=s.tracks,d=s.assemblies,f=s.plugins,p={ver:u,"plugins-count":(null===f||void 0===f?void 0:f.length)||0,"plugin-names":null===f||void 0===f?void 0:f.map((function(e){return e.name})).join(","),"assemblies-count":d.length,"tracks-count":l.length,"session-tracks-count":(null===c||void 0===c?void 0:c.sessionTracks.length)||0,"open-views":(null===c||void 0===c?void 0:c.views.length)||0,"synteny-tracks-count":a,"saved-sessions-count":o,"existing-session-param-type":(null===r||void 0===r?void 0:r.split("-")[0])||"none","scn-h":window.screen.height,"scn-w":window.screen.width,"win-h":window.innerHeight,"win-w":window.innerWidth,electron:R.isElectron,loadTime:(Date.now()-t)/1e3,jb2:!0},l.forEach((function(e){var n="track-types-".concat(e.type);p[n]=p[n]+1||1})),null===c||void 0===c||c.sessionTracks.forEach((function(e){var n="sessionTrack-types-".concat(e.type);p[n]=p[n]+1||1})),h=Object.keys(p).map((function(e){return"".concat(e,"=").concat(p[e])})).join("&"),e.next=12,fetch("".concat("https://analytics.jbrowse.org/api/v1","?").concat(h));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("Failed to write analytics to AWS.",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}function U(){return(U=(0,a.Z)((0,i.Z)().mark((function e(n,t){var r,a,o,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"UA-7115575-5",a={"tracks-count":n.jbrowse.tracks.length,ver:n.version,electron:R.isElectron,loadTime:Date.now()-t,pluginNames:(null===(r=n.jbrowse.plugins)||void 0===r?void 0:r.map((function(e){return e.name})))||""},o="(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){",o+="(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),",o+="m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)",o+="})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');",o+="ga('create', '".concat("UA-7115575-5","', 'auto', 'jbrowseTracker');"),s={},"tracks-count ver electron loadTime pluginNames","tracks-count ver electron loadTime pluginNames".split(/\s+/).forEach((function(e,n){s["dimension".concat(n+1)]=a[e]})),s.metric1=Math.round(a.loadTime),o+="ga('jbrowseTracker.send', 'pageview',".concat(JSON.stringify(s),");"),(c=document.createElement("script")).innerHTML=o,document.getElementsByTagName("head")[0].appendChild(c);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,n,t){e&&!(0,S.readConfObject)(e.jbrowse.configuration,"disableAnalytics")&&(function(e,n,t){z.apply(this,arguments)}(e,n,t),function(e,n){U.apply(this,arguments)}(e,n))}var J=t(99060),q=t(26794),_=t(47672),V=t(64946),H=t(18549),G=t(35681),Q=t(5634),K=t(26742),$=t(45754),Y=t(86906),X=t(46891),ee=t(63824),ne=t(18287),te=t(94401),re=t(20120),ie=(0,u.lazy)((function(){return t.e(9393).then(t.bind(t,19393))})),ae=(0,u.lazy)((function(){return t.e(2439).then(t.bind(t,72439))})),oe=function(e){(0,$.Z)(r,e);var n=(0,Y.Z)(r);function r(){var e;(0,d.Z)(this,r);for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return(e=n.call.apply(n,[this].concat(i))).name="DataManagementPlugin",e.exports={AssemblyManager:ae,SetDefaultSession:ie},e}return(0,f.Z)(r,[{key:"install",value:function(e){e.addConnectionType((function(){return new w.Z({name:"UCSCTrackHubConnection",configSchema:X.j,stateModel:(0,X.u)(e),displayName:"UCSC Track Hub",description:"A track or assembly hub in the Track Hub format",url:"//genome.ucsc.edu/goldenPath/help/hgTrackHubHelp.html#Intro"})})),e.addWidgetType((function(){return new b.Z({name:"HierarchicalTrackSelectorWidget",heading:"Available tracks",configSchema:te.j,stateModel:(0,te.e)(e),ReactComponent:(0,u.lazy)((function(){return Promise.all([t.e(9815),t.e(1305)]).then(t.bind(t,61305))}))})})),e.addWidgetType((function(){return new b.Z({name:"AddTrackWidget",heading:"Add a track",configSchema:ee.j,stateModel:(0,ee.e)(e),ReactComponent:(0,u.lazy)((function(){return t.e(8752).then(t.bind(t,58752))}))})})),e.addWidgetType((function(){return new b.Z({name:"AddConnectionWidget",heading:"Add a connection",configSchema:ne.j,stateModel:ne.e,ReactComponent:(0,u.lazy)((function(){return t.e(7412).then(t.bind(t,17412))}))})})),e.addWidgetType((function(){return new b.Z({name:"PluginStoreWidget",heading:"Plugin store",configSchema:re.jS,stateModel:(0,re.e$)(e),ReactComponent:(0,u.lazy)((function(){return Promise.resolve().then(t.bind(t,72365))}))})}))}},{key:"configure",value:function(e){}}]),r}(j.Z),se=t(74767),ce=t(81919),ue=t(8512),le=t(1945),de=t(59917),fe=t(80685),pe=t(87146),he=t(2290),ge=t(49934),ve=t(47059),me=t(17816),ye=t(52044),be=t(29145),we=t(46413),xe=t(92854),Ze=t(30852),ke=t(63328),Se=t(74307),je=t(42123),Ce=t(73212),Te=[ye.ZP,de.ZP,q.Z,_.Z,V.Z,G.ZP,Q.ZP,oe,se.Z,ce.Z,ue.Z,le.Z,fe.Z,pe.Z,he.Z,ge.Z,ve.Z,me.Z,be.Z,we.Z,xe.ZP,Ze.Z,ke.Z,H.Z,Se.Z,je.Z,Ce.Z,K.Z],Me=t(60734),Ee=t(7139),Ae=t(34760),Pe=t.n(Ae),Ie=t(22714),Re=t(53239),Ne=t(83483),De=t(64501),We=t(32343),Oe=t(93138),Le=t(54249),Be=t(28224),ze=t(55788),Ue=t(93717),Fe=t(18189),Je=t(89001),qe=t(80975),_e=t(7690),Ve=t(53033),He=t(28599),Ge=t(4153),Qe=t(82678),Ke=t(57490),$e=t(14008),Ye=t(22417);function Xe(e){var n=0;switch(e.length%4){case 3:n=1;break;case 2:n=2;break;case 0:n=0;break;default:throw new Error("base64 not a valid length")}return e+"=".repeat(n)}function en(e){return nn.apply(this,arguments)}function nn(){return(nn=(0,a.Z)((0,i.Z)().mark((function e(n){var r,a,o,s,c,u,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Xe(n.replace(/-/g,"+").replace(/_/g,"/")),e.next=3,Promise.resolve().then(t.t.bind(t,63019,19));case 3:return a=e.sent,o=a.toByteArray,e.next=7,Promise.resolve().then(t.t.bind(t,26700,23));case 7:return s=e.sent,c=s.inflate,u=o(r),l=c(u),e.abrupt("return",(new TextDecoder).decode(l));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function tn(e){return rn.apply(this,arguments)}function rn(){return(rn=(0,a.Z)((0,i.Z)().mark((function e(n){var r,a,o,s,c,u,l,d;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(new TextEncoder).encode(n),e.next=3,Promise.resolve().then(t.t.bind(t,26700,23));case 3:return a=e.sent,o=a.deflate,e.next=7,Promise.resolve().then(t.t.bind(t,63019,19));case 7:return s=e.sent,c=s.fromByteArray,u=o(r),l=c(u),d=l.indexOf("="),e.abrupt("return",d>0?l.slice(0,d).replace(/\+/g,"-").replace(/\//g,"_"):l.replace(/\+/g,"-").replace(/\//g,"_"));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var an=t(46277),on=t.n(an),sn=t(33136),cn=t.n(sn);function un(e){return window.btoa(Array.from(window.crypto.getRandomValues(new Uint8Array(2*e))).map((function(e){return String.fromCharCode(e)})).join("")).replace(/[+/]/g,"").substring(0,e)}var ln=function(e,n){return on().encrypt(e,n).toString()},dn=function(e,n){return on().decrypt(e,n).toString(cn())};function fn(e){try{return JSON.parse(e).message}catch(n){return e}}function pn(e,n,t){return hn.apply(this,arguments)}function hn(){return(hn=(0,a.Z)((0,i.Z)().mark((function e(n,t,r){var a,o,s,c,u,l,d;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tn(JSON.stringify(n));case 2:return a=e.sent,o=un(5),s=ln(a,o),(c=new FormData).append("session",s),c.append("dateShared","".concat(Date.now())),c.append("referer",r),e.next=11,fetch("".concat(t,"share"),{method:"POST",mode:"cors",body:c});case 11:if((u=e.sent).ok){e.next=17;break}return e.next=15,u.text();case 15:throw l=e.sent,new Error(fn(l));case 17:return e.next=19,u.json();case 19:return d=e.sent,e.abrupt("return",{json:d,encryptedSession:s,password:o});case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gn(e,n,t,r){return vn.apply(this,arguments)}function vn(){return(vn=(0,a.Z)((0,i.Z)().mark((function e(n,t,r,a){var o,s,c,u,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.split("share-")[1],s="".concat(n,"?sessionId=").concat(o),e.next=4,fetch(s,{signal:a});case 4:if((c=e.sent).ok){e.next=10;break}return e.next=8,c.text();case 8:throw u=e.sent,new Error(fn(u));case 10:return e.next=12,c.json();case 12:return l=e.sent,e.abrupt("return",dn(l.session,r));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var mn=t(37574),yn=(0,Ie.Z)((function(e){return{shareDiv:{textAlign:"center",paddingLeft:"2px"},shareButton:{"&:hover":{backgroundColor:(0,Re.Fq)(e.palette.primary.contrastText,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},loadingMessage:{padding:e.spacing(5)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}})),bn="jbrowse-shareURL";function wn(e){var n=yn(),t=e.onClose,r=e.open,i=e.currentSetting,a=(0,u.useState)(i),o=(0,c.Z)(a,2),s=o[0],l=o[1],d=(0,u.useState)(!1),f=(0,c.Z)(d,2),p=f[0],h=f[1],g=function(){localStorage.setItem(bn,s),t(s)};return(0,mn.jsxs)(mn.Fragment,{children:[(0,mn.jsxs)(Ne.Z,{onClose:g,open:r,children:[(0,mn.jsxs)(De.Z,{children:["Configure session sharing",g?(0,mn.jsx)(We.Z,{className:n.closeButton,onClick:g,children:(0,mn.jsx)($e.Z,{})}):null]}),(0,mn.jsxs)(Oe.Z,{children:[(0,mn.jsxs)(Le.Z,{children:["Select between generating long or short URLs for the session sharing",(0,mn.jsx)(We.Z,{onClick:function(){return h(!0)},children:(0,mn.jsx)(Qe.Z,{})})]}),(0,mn.jsx)(Be.Z,{component:"fieldset",children:(0,mn.jsxs)(ze.Z,{value:s,onChange:function(e){var n=e.target.value;l(n)},children:[(0,mn.jsx)(Ue.Z,{value:"short",control:(0,mn.jsx)(Fe.Z,{}),label:"Short URL"}),(0,mn.jsx)(Ue.Z,{value:"long",control:(0,mn.jsx)(Fe.Z,{}),label:"Long URL"})]})})]})]}),(0,mn.jsx)(xn,{open:p,onClose:function(){h(!1)}})]})}function xn(e){var n=yn(),t=e.onClose,r=e.open,i=function(){t()};return(0,mn.jsxs)(Ne.Z,{onClose:i,open:r,children:[(0,mn.jsxs)(De.Z,{id:"simple-dialog-title",children:["Info about session URLs",t?(0,mn.jsx)(We.Z,{className:n.closeButton,onClick:i,children:(0,mn.jsx)($e.Z,{})}):null]}),(0,mn.jsxs)(Oe.Z,{children:[(0,mn.jsx)(Le.Z,{children:"Because everything about the JBrowse session is encoded in the URL (e.g. state of the tracks, views, features selected, etc.) the sessions can get very long. Therefore, we created a URL shortener, both as a convenience and because long URLs can break some programs. Note that both the long and short URLs encode the same data, but due to long URLs causing problems with some programs, we recommend sharing short URLs."}),(0,mn.jsx)(Le.Z,{children:'We generate the short URLs in a secure manner which involves encrypting the session on the client side with a random password string and uploading them to a central database. Then the random password is added to the URL but is not uploaded to the central database, making these short URLs effectively "end-to-end encrypted"'}),(0,mn.jsx)(Le.Z,{children:"Only users with a share link can read the session."})]})]})}var Zn=(0,I.observer)((function(e){var n=e.handleClose,t=e.session,r=yn(),o=(0,u.useState)(""),s=(0,c.Z)(o,2),l=s[0],d=s[1],f=(0,u.useState)(""),h=(0,c.Z)(f,2),g=h[0],v=h[1],m=(0,u.useState)(!0),y=(0,c.Z)(m,2),b=y[0],w=y[1],x=(0,u.useState)(),Z=(0,c.Z)(x,2),k=Z[0],S=Z[1],j=(0,u.useState)(!1),C=(0,c.Z)(j,2),T=C[0],M=C[1],E=t.shareURL,A=localStorage.getItem(bn)||"short",P=(0,p.getSnapshot)(t);return(0,u.useEffect)((function(){var e=!1;return(0,a.Z)((0,i.Z)().mark((function n(){var t,r,a;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("short"!==A){n.next=16;break}return n.prev=1,w(!0),t=new URL(window.location.href),n.next=6,pn(P,E,t.href);case 6:r=n.sent,e||((a=new URLSearchParams(t.search)).set("session","share-".concat(r.json.sessionId)),a.set("password",r.password),t.search=a.toString(),d(t.href)),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),S(n.t0);case 13:return n.prev=13,w(!1),n.finish(13);case 16:case"end":return n.stop()}}),n,null,[[1,10,13,16]])})))(),function(){e=!0}}),[A,E,P]),(0,u.useEffect)((function(){var e=!1;return(0,a.Z)((0,i.Z)().mark((function n(){var r,a,o;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,tn(JSON.stringify((0,p.getSnapshot)(t)));case 3:r=n.sent,a=new URL(window.location.href),(o=new URLSearchParams(a.search)).set("session","encoded-".concat(r)),a.search=o.toString(),e||v(a.toString()),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(0),S(n.t0);case 14:case"end":return n.stop()}}),n,null,[[0,11]])})))(),function(){e=!0}}),[t]),(0,mn.jsxs)(mn.Fragment,{children:[(0,mn.jsxs)(Ne.Z,{maxWidth:"xl",open:!0,onClose:n,"data-testid":"share-dialog",children:[(0,mn.jsxs)(De.Z,{children:["JBrowse Shareable Link",n?(0,mn.jsx)(We.Z,{className:r.closeButton,onClick:n,children:(0,mn.jsx)($e.Z,{})}):null]}),(0,mn.jsx)(Je.Z,{}),(0,mn.jsxs)(Oe.Z,{children:[(0,mn.jsxs)(Le.Z,{children:["Copy the URL below to share your current JBrowse session.",(0,mn.jsx)(We.Z,{onClick:function(){return M(!0)},children:(0,mn.jsx)(Ke.Z,{})})]}),"short"===A?k?(0,mn.jsx)(qe.Z,{color:"error",children:"".concat(k)}):b?(0,mn.jsx)(qe.Z,{children:"Generating short URL..."}):(0,mn.jsx)(_e.Z,{label:"URL",value:l,InputProps:{readOnly:!0},inputProps:{"data-testid":"share-url-text"},variant:"filled",style:{width:"100%"},onClick:function(e){e.target.select()},"data-testid":"share-url-field"}):(0,mn.jsx)(_e.Z,{label:"URL",value:g,InputProps:{readOnly:!0},variant:"filled",style:{width:"100%"},onClick:function(e){e.target.select()}})]}),(0,mn.jsxs)(Ve.Z,{children:[(0,mn.jsx)(He.Z,{onClick:function(){Pe()(l||g.toString()),t.notify("Copied to clipboard","success")},color:"primary",startIcon:(0,mn.jsx)(Ye.pt,{}),disabled:"short"===A&&b,children:"Copy URL to Clipboard"}),(0,mn.jsx)(He.Z,{onClick:n,color:"primary",autoFocus:!0,children:"Close"})]})]}),(0,mn.jsx)(wn,{open:T,onClose:function(){M(!1)},currentSetting:A})]})})),kn=(0,I.observer)((function(e){var n=(0,u.useState)(!1),t=(0,c.Z)(n,2),r=t[0],o=t[1],s=e.session,l=yn();return(0,mn.jsxs)("div",{className:l.shareDiv,children:[(0,mn.jsx)(He.Z,{"data-testid":"share_button",onClick:(0,a.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o(!0));case 1:case"end":return e.stop()}}),e)}))),size:"small",color:"inherit",startIcon:(0,mn.jsx)(Ge.Z,{}),classes:{root:l.shareButton},children:"Share"}),r?(0,mn.jsx)(Zn,{handleClose:function(){o(!1)},session:s}):null]})}));var Sn=(0,I.observer)((function(e){var n=e.pluginManager.rootModel,t=n,r=t.isAssemblyEditing,i=t.isDefaultSessionEditing,a=t.setDefaultSessionEditing,o=t.setAssemblyEditing;return(0,mn.jsxs)(mn.Fragment,{children:[r?(0,mn.jsx)(ae,{rootModel:n,onClose:function(){return o(!1)}}):null,i?(0,mn.jsx)(ie,{rootModel:n,onClose:function(){return a(!1)}}):null]})})),jn=(0,I.observer)((function(e){var n=e.pluginManager,t=(0,D.Wd)("adminKey",D.Zp),r=(0,c.Z)(t,1)[0],o=(0,D.Wd)("adminServer",D.Zp),s=(0,c.Z)(o,1)[0],l=(0,D.Wd)("config",D.Zp),d=(0,c.Z)(l,1)[0],f=(0,D.Wd)("session",D.Zp),h=(0,c.Z)(f,2)[1],g=n.rootModel,v=g||{},m=v.error,y=v.jbrowse,b=null===g||void 0===g?void 0:g.session,w=b.id;if((0,u.useEffect)((function(){h("local-".concat(w)),window.JBrowseRootModel=g,window.JBrowseSession=b}),[w,g,b,h]),(0,u.useEffect)((function(){y&&(0,p.onSnapshot)(y,function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n){var t,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=9;break}return e.next=3,fetch(s||"/updateConfig",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminKey:r,configPath:d,config:n})});case 3:if((t=e.sent).ok){e.next=9;break}return e.next=7,t.text();case 7:a=e.sent,b&&b.notify("Admin server error: ".concat(t.status," (").concat(t.statusText,") ").concat(a||""));case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())}),[y,b,r,s,d]),m)throw m;if(!g)throw new Error("No rootModel found");if(!b)throw new Error("No session found");var x=(0,S.getConf)(g.jbrowse,"theme");return(0,mn.jsxs)(Me.Z,{theme:(0,W.createJBrowseTheme)(x),children:[(0,mn.jsx)(Ee.ZP,{}),(0,mn.jsx)(W.App,{session:b,HeaderButtons:(0,mn.jsx)(kn,{session:b})}),r?(0,mn.jsx)(Sn,{pluginManager:n}):null]})})),Cn=jn;function Tn(){return new Worker(new URL(t.p+t.u(6423),t.b))}var Mn=t(21918),En=t(35247),An=t(88807),Pn=t.n(An),In=t(89410),Rn=t.n(In),Nn=t(63409),Dn=["signal","statusCallback"],Wn=new RegExp("[0-9A-Za-z!#$%&+./:;?@^_|~-][0-9A-Za-z!#$%&*+./:;=?@^_|~-]*"),On=["rgb(153, 102, 0)","rgb(102, 102, 0)","rgb(153, 153, 30)","rgb(204, 0, 0)","rgb(255, 0, 0)","rgb(255, 0, 204)","rgb(165, 132, 132)","rgb(204, 122, 0)","rgb(178, 142, 0)","rgb(153, 153, 0)","rgb(122, 153, 0)","rgb(0, 165, 0)","rgb(53, 128, 0)","rgb(0, 0, 204)","rgb(96, 145, 242)","rgb(107, 142, 178)","rgb(0, 165, 165)","rgb(122, 153, 153)","rgb(153, 0, 204)","rgb(204, 51, 255)","rgb(173, 130, 216)","rgb(102, 102, 102)","rgb(145, 145, 145)","rgb(142, 142, 142)","rgb(142, 142, 107)","rgb(96, 163, 48)"];function Ln(e,n,t,r){return Bn.apply(this,arguments)}function Bn(){return(Bn=(0,a.Z)((0,i.Z)().mark((function e(n,t,r,a){var s,u,l,d;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.sessionId,e.next=3,(0,R.when)((function(){return Boolean(n.regions&&n.refNameAliases)}),{signal:a,name:"when assembly ready"});case 3:return e.next=5,n.rpcManager.call(s,"CoreGetRefNames",(0,o.Z)({adapterConfig:t,signal:a},r),{timeout:1e6});case 5:if(u=e.sent,n.refNameAliases){e.next=9;break}throw new Error("error loading assembly ".concat(n.name,"'s refNameAliases"));case 9:return l=Object.fromEntries(u.map((function(e){return zn(e),[n.getCanonicalRefName(e),e]}))),d=Object.fromEntries(Object.entries(l).map((function(e){var n=(0,c.Z)(e,2),t=n[0];return[n[1],t]}))),e.abrupt("return",{forwardMap:l,reverseMap:d});case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function zn(e){if(!e.match(Wn))throw new Error('Encountered invalid refName: "'.concat(e,'"'))}function Un(e,n){var t=new(Rn())({cache:new Nn.Z({maxSize:1e3}),fill:function(e,n,t){return(0,a.Z)((0,i.Z)().mark((function r(){var a,s,c;return(0,i.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=e.adapterConf,s=e.self,c=e.options,r.abrupt("return",Ln(s,a,(0,o.Z)((0,o.Z)({},c),{},{statusCallback:t}),n));case 2:case"end":return r.stop()}}),r)})))()}});return p.types.model({configuration:p.types.safeReference(e)}).volatile((function(){return{error:void 0,regions:void 0,refNameAliases:void 0,lowerCaseRefNameAliases:void 0,cytobands:void 0}})).views((function(e){return{get initialized(){return!!e.refNameAliases},get name(){return(0,S.getConf)(e,"name")},get aliases(){return(0,S.getConf)(e,"aliases")},hasName:function(e){return this.allAliases.includes(e)},get allAliases(){return[this.name].concat((0,r.Z)(this.aliases))},get refNames(){var n;return null===(n=e.regions)||void 0===n?void 0:n.map((function(e){return e.refName}))},get allRefNames(){return e.refNameAliases?Object.keys(e.refNameAliases):void 0},get rpcManager(){return(0,p.getParent)(e,2).rpcManager},get refNameColors(){var n=(0,S.getConf)(e,"refNameColors");return 0===n.length?On:n}}})).views((function(e){return{getCanonicalRefName:function(n){if(!e.refNameAliases||!e.lowerCaseRefNameAliases)throw new Error("aliases not loaded, we expect them to be loaded before getCanonicalRefName can be called");return e.refNameAliases[n]||e.lowerCaseRefNameAliases[n]},getRefNameColor:function(n){var t,r=null===(t=e.refNames)||void 0===t?void 0:t.findIndex((function(e){return e===n}));if(void 0!==r&&-1!==r)return e.refNameColors[r%e.refNameColors.length]},isValidRefName:function(n){if(!e.refNameAliases)throw new Error("isValidRefName cannot be called yet, the assembly has not finished loading");return!!this.getCanonicalRefName(n)}}})).actions((function(e){return{setLoading:function(){},setLoaded:function(e){var n=e.adapterRegionsWithAssembly,t=e.refNameAliases,r=e.lowerCaseRefNameAliases,i=e.cytobands;this.setRegions(n),this.setRefNameAliases(t,r),this.setCytobands(i)},setError:function(n){console.error(n),e.error=n},setRegions:function(n){e.regions=n},setRefNameAliases:function(n,t){e.refNameAliases=n,e.lowerCaseRefNameAliases=t},setCytobands:function(n){e.cytobands=n},afterAttach:function(){(0,R.makeAbortableReaction)(e,function(e){return function(n){if(n.configuration){var t=n.configuration,r=t.sequence,i=t.refNameAliases,a=t.cytobands,o=r.adapter,s=null===i||void 0===i?void 0:i.adapter,c=null===a||void 0===a?void 0:a.adapter;return{sequenceAdapterConfig:o,assemblyName:n.name,refNameAliasesAdapterConfig:s,cytobandAdapterConfig:c,pluginManager:e}}}}(n),Fn,{name:"".concat(e.name," assembly loading"),fireImmediately:!0},this.setLoading,this.setLoaded,this.setError)}}})).views((function(e){return{getAdapterMapEntry:function(n,r){r.signal;var i=r.statusCallback,a=(0,s.Z)(r,Dn);if(!r.sessionId)throw new Error("sessionId is required");var o=function(e){return Pn()(e)}(n);return t.get(o,{adapterConf:n,self:e,options:a},void 0,i)},getRefNameMapForAdapter:function(e,n){var t=this;return(0,a.Z)((0,i.Z)().mark((function r(){var a;return(0,i.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n&&n.sessionId){r.next=2;break}throw new Error("sessionId is required");case 2:return r.next=4,t.getAdapterMapEntry(e,n);case 4:return a=r.sent,r.abrupt("return",a.forwardMap);case 6:case"end":return r.stop()}}),r)})))()},getReverseRefNameMapForAdapter:function(e,n){var t=this;return(0,a.Z)((0,i.Z)().mark((function r(){var a;return(0,i.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getAdapterMapEntry(e,n);case 2:return a=r.sent,r.abrupt("return",a.reverseMap);case 4:case"end":return r.stop()}}),r)})))()}}}))}function Fn(e,n){return Jn.apply(this,arguments)}function Jn(){return(Jn=(0,a.Z)((0,i.Z)().mark((function e(n,t){var r,a,s,u,l,d,f,p,h,g,v;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return r=n.sequenceAdapterConfig,a=n.assemblyName,s=n.refNameAliasesAdapterConfig,u=n.cytobandAdapterConfig,l=n.pluginManager,e.next=5,Gn(r,l,t);case 5:return d=e.sent,f=d.map((function(e){return zn(e.refName),(0,o.Z)((0,o.Z)({},e),{},{assemblyName:a})})),p={},e.next=10,qn(s,l,t);case 10:return h=e.sent,e.next=13,Vn(u,l);case 13:return g=e.sent,h.forEach((function(e){var n=e.refName;e.aliases.forEach((function(e){zn(e),p[e]=n}))})),f.forEach((function(e){p[e.refName]=e.refName})),v=Object.fromEntries(Object.entries(p).map((function(e){var n=(0,c.Z)(e,2),t=n[0],r=n[1];return[t.toLowerCase(),r]}))),e.abrupt("return",{adapterRegionsWithAssembly:f,refNameAliases:p,lowerCaseRefNameAliases:v,cytobands:g});case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qn(e,n,t){return _n.apply(this,arguments)}function _n(){return(_n=(0,a.Z)((0,i.Z)().mark((function e(n,t,r){var a,o,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.getAdapterType(n.type),e.next=3,null===(a=o.getAdapterClass)||void 0===a?void 0:a.call(o);case 3:return s=e.sent,c=new s(n,void 0,t),e.abrupt("return",c.getRefNameAliases({signal:r}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Vn(e,n){return Hn.apply(this,arguments)}function Hn(){return(Hn=(0,a.Z)((0,i.Z)().mark((function e(n,t){var r,a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.getAdapterType(n.type),e.next=3,r.getAdapterClass();case 3:return a=e.sent,o=new a(n,void 0,t),e.abrupt("return",o.getData());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Gn(e,n,t){return Qn.apply(this,arguments)}function Qn(){return(Qn=(0,a.Z)((0,i.Z)().mark((function e(n,t,r){var a,o,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.getAdapterType(n.type),e.next=3,a.getAdapterClass();case 3:return o=e.sent,s=new o(n,void 0,t),e.abrupt("return",s.getRegions({signal:r}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Kn(e,n){var t=Un(e,n);return p.types.model({assemblies:p.types.array(t)}).views((function(e){return{get:function(n){return e.assemblies.find((function(e){return e.hasName(n)}))},get assemblyNamesList(){return this.assemblyList.map((function(e){return e.name}))},get assemblyList(){var n=(0,p.getParent)(e),t=n.jbrowse.assemblies,i=n.session,a=(i=void 0===i?{}:i).sessionAssemblies,o=void 0===a?[]:a;return[].concat((0,r.Z)(t),(0,r.Z)(o))},get rpcManager(){return(0,p.getParent)(e).rpcManager},get pluginManager(){return(0,p.getParent)(e).pluginManager},get allPossibleRefNames(){var n,t=[],r=(0,l.Z)(e.assemblies);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.allRefNames)return;t=t.concat(i.allRefNames)}}catch(a){r.e(a)}finally{r.f()}return t}}})).views((function(e){return{waitForAssembly:function(n){return(0,a.Z)((0,i.Z)().mark((function t(){var r;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}throw new Error("no assembly name supplied to waitForAssembly");case 2:if(r=e.get(n)){t.next=5;break}return t.abrupt("return",void 0);case 5:return t.next=7,(0,R.when)((function(){return Boolean(r.regions&&r.refNameAliases)||!!r.error}));case 7:if(!r.error){t.next=9;break}throw r.error;case 9:return t.abrupt("return",r);case 10:case"end":return t.stop()}}),t)})))()},getRefNameMapForAdapter:function(e,n,t){var r=this;return(0,a.Z)((0,i.Z)().mark((function a(){var o;return(0,i.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!n){i.next=5;break}return i.next=3,r.waitForAssembly(n);case 3:return o=i.sent,i.abrupt("return",null===o||void 0===o?void 0:o.getRefNameMapForAdapter(e,t));case 5:return i.abrupt("return",{});case 6:case"end":return i.stop()}}),a)})))()},getReverseRefNameMapForAdapter:function(e,n,t){var r=this;return(0,a.Z)((0,i.Z)().mark((function a(){var o;return(0,i.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!n){i.next=5;break}return i.next=3,r.waitForAssembly(n);case 3:return o=i.sent,i.abrupt("return",null===o||void 0===o?void 0:o.getReverseRefNameMapForAdapter(e,t));case 5:return i.abrupt("return",{});case 6:case"end":return i.stop()}}),a)})))()},isValidRefName:function(n,t){if(t){var r=e.get(t);if(r)return r.isValidRefName(n);throw new Error("isValidRefName for ".concat(t," failed, assembly does not exist"))}if(!e.allPossibleRefNames)throw new Error("isValidRefName not available, assemblyManager has not yet finished loading. If you are looking for a refname in a specific assembly, pass assembly argument");return e.allPossibleRefNames.includes(n)}}})).actions((function(e){return{removeAssembly:function(n){e.assemblies.remove(n)},afterAttach:function(){var n=this;(0,p.addDisposer)(e,(0,En.reaction)((function(){return e.assemblyList}),(function(t){e.assemblies.forEach((function(e){e.configuration||n.removeAssembly(e)})),t.forEach((function(t){-1===e.assemblies.findIndex((function(e){return e.name===(0,S.readConfObject)(t,"name")}))&&n.addAssembly(t)}))}),{fireImmediately:!0,name:"assemblyManagerAfterAttach"}))},addAssembly:function(n){e.assemblies.push({configuration:n})},replaceAssembly:function(n,t){e.assemblies[n]=(0,p.cast)({configuration:t})}}}))}var $n=function(e){return(0,S.ConfigurationSchema)("BaseAssembly",{aliases:{type:"stringArray",defaultValue:[],description:"Other possible names for the assembly"},sequence:e.getTrackType("ReferenceSequenceTrack").configSchema,refNameColors:{type:"stringArray",defaultValue:[],description:"Define custom colors for each reference sequence. Will cycle through this list if there are not enough colors for every sequence."},refNameAliases:(0,S.ConfigurationSchema)("RefNameAliases",{adapter:e.pluggableConfigSchemaType("adapter")},{preProcessSnapshot:function(e){return e.adapter?e:{adapter:{type:"RefNameAliasAdapter"}}}}),cytobands:(0,S.ConfigurationSchema)("Cytoband",{adapter:e.pluggableConfigSchemaType("adapter")},{preProcessSnapshot:function(e){return e.adapter?e:{adapter:{type:"CytobandAdapter"}}}}),displayName:{type:"string",defaultValue:"",description:'A human readable display name for the assembly e.g. "Homo sapiens (hg38)" while the assembly name may just be "hg38"'}},{explicitIdentifier:"name"})},Yn=(0,S.ConfigurationSchema)("BaseRpcDriver",{workerCount:{type:"number",description:"The number of workers to use. If 0 (the default) JBrowse will decide how many workers to use.",defaultValue:0}},{explicitlyTyped:!0}),Xn=(0,S.ConfigurationSchema)("MainThreadRpcDriver",{},{explicitlyTyped:!0,baseConfiguration:Yn}),et=(0,S.ConfigurationSchema)("WebWorkerRpcDriver",{},{explicitlyTyped:!0,baseConfiguration:Yn}),nt=(0,S.ConfigurationSchema)("RpcOptions",{defaultDriver:{type:"string",description:"the RPC driver to use for tracks and tasks that are not configured to use a specific RPC backend",defaultValue:"MainThreadRpcDriver"},drivers:p.types.optional(p.types.map(p.types.union(Xn,et)),{MainThreadRpcDriver:{type:"MainThreadRpcDriver"}})},{actions:function(e){return{addDriverConfig:function(n,t){e.drivers.set(n,t)}}}}),tt=t(93069),rt=t(95058),it=t(52743),at=t(94943);function ot(e){return"function"!==typeof e&&!(e instanceof Error)}function st(e,n,t){return ct.apply(this,arguments)}function ct(){return(ct=(0,a.Z)((0,i.Z)().mark((function e(n,t,r){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){!function e(){setTimeout((0,a.Z)((0,i.Z)().mark((function a(){return(0,i.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,n.call("ping",[],{timeout:2*t,rpcDriverClassName:r});case 3:e(),i.next=9;break;case 6:i.prev=6,i.t0=i.catch(0),o(i.t0);case 9:case"end":return i.stop()}}),a,null,[[0,6]])}))),t)}()})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ut=function(){function e(n){(0,d.Z)(this,e),this.driver=n,this.workerP=void 0}return(0,f.Z)(e,[{key:"getWorker",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var n=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.workerP||(this.workerP=this.driver.makeWorker().then((function(e){return st(e,n.driver.maxPingTime,n.driver.name).catch((function(t){e&&(console.error("worker did not respond, killing and generating new one"),console.error(t),e.destroy(),e.status="killed",e.error=t,n.workerP=void 0)})),e})).catch((function(e){throw n.workerP=void 0,e}))),e.abrupt("return",this.workerP);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),lt=function(){function e(n){(0,d.Z)(this,e),this.name=void 0,this.lastWorkerAssignment=-1,this.workerAssignments=new Map,this.workerPool=void 0,this.maxPingTime=3e4,this.workerCheckFrequency=5e3,this.config=void 0,this.config=n.config}return(0,f.Z)(e,[{key:"filterArgs",value:function(e,n){var t=this;if(Array.isArray(e))return e.filter(ot).map((function(e){return t.filterArgs(e,n)}));if("object"===typeof e&&null!==e){if(e instanceof AbortSignal)return(0,at.Iy)(e,this.remoteAbort.bind(this,n));if((0,p.isStateTreeNode)(e)&&!(0,p.isAlive)(e))throw new Error("dead state tree node passed to RPC call");return e instanceof File?e:(0,R.objectFromEntries)(Object.entries(e).filter((function(e){return ot(e[1])})).map((function(e){var r=(0,c.Z)(e,2),i=r[0],a=r[1];return[i,t.filterArgs(a,n)]})))}return e}},{key:"remoteAbort",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,t,r){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getWorker(n);case 2:e.sent.call(t,{signalId:r},{timeout:1e6,rpcDriverClassName:this.name});case 4:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()},{key:"createWorkerPool",value:function(){var e=this,n=function(){var e="undefined"!==typeof window,n=e&&"hardwareConcurrency"in window.navigator;return e&&n?window.navigator.hardwareConcurrency:1}(),t=(0,S.readConfObject)(this.config,"workerCount")||(0,R.clamp)(1,Math.max(1,n-1),5);return(0,r.Z)(new Array(t)).map((function(){return new ut(e)}))}},{key:"getWorkerPool",value:function(){if(!this.workerPool){var e=this.createWorkerPool();return this.workerPool=e,e}return this.workerPool}},{key:"getWorker",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n){var t,r,a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getWorkerPool(),void 0===(r=this.workerAssignments.get(n))&&(a=(this.lastWorkerAssignment+1)%t.length,this.workerAssignments.set(n,a),this.lastWorkerAssignment=a,r=a),o=t[r].getWorker()){e.next=6;break}throw new Error("no web workers registered for RPC");case 6:return e.abrupt("return",o);case 7:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"call",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,t,r,a){var s,c,u,l,d,f,p,h,g,v,m=this,y=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=y.length>4&&void 0!==y[4]?y[4]:{},t){e.next=3;break}throw new TypeError("sessionId is required");case 3:return c=!1,e.next=6,this.getWorker(t);case 6:return u=e.sent,l=n.getRpcMethodType(r),e.next=10,l.serializeArguments(a,this.name);case 10:return d=e.sent,f=this.filterArgs(d,t),p=u.call(r,f,(0,o.Z)({timeout:3e5,statusCallback:a.statusCallback,rpcDriverClassName:this.name},s)).finally((function(){c=!0})),g=new Promise((function(e,n){h=setInterval((function(){"killed"===u.status?n(new Error("operation timed out, worker process stopped responding, ".concat(u.error))):c&&e(!0)}),m.workerCheckFrequency)})).finally((function(){clearInterval(h)})),v=Promise.race([p,g]),e.abrupt("return",l.deserializeReturn(v,a,this.name));case 16:case"end":return e.stop()}}),e,this)})));return function(n,t,r,i){return e.apply(this,arguments)}}()}]),e}(),dt=function(e){(0,$.Z)(t,e);var n=(0,Y.Z)(t);function t(){return(0,d.Z)(this,t),n.apply(this,arguments)}return(0,f.Z)(t,[{key:"destroy",value:function(){this.workers[0].terminate()}},{key:"call",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,r,a){var s,c,u,l,d;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=a.statusCallback,c=a.rpcDriverClassName,u="message-".concat(B().generate()),l=function(e){s&&s(e)},this.on(u,l),e.next=6,(0,tt.Z)((0,rt.Z)(t.prototype),"call",this).call(this,n,(0,o.Z)((0,o.Z)({},r),{},{channel:u,rpcDriverClassName:c}),a);case 6:return d=e.sent,this.off(u,l),e.abrupt("return",d);case 9:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()}]),t}(it.Z.Client),ft=function(e){(0,$.Z)(t,e);var n=(0,Y.Z)(t);function t(e,r){var i;return(0,d.Z)(this,t),(i=n.call(this,e)).workerBootConfiguration=r,i.name="WebWorkerRpcDriver",i.makeWorkerInstance=void 0,i.makeWorkerInstance=e.makeWorkerInstance,i}return(0,f.Z)(t,[{key:"makeWorker",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var n,t,r,a=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.makeWorkerInstance(),t=new dt({workers:[n]}),r=new Promise((function(e,n){t.workers[0].onmessage=function(r){"ready"===r.data?e(t):"readyForConfig"===r.data?t.workers[0].postMessage(a.workerBootConfiguration):n()}})),e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(lt),pt=function(){function e(){(0,d.Z)(this,e)}return(0,f.Z)(e,[{key:"destroy",value:function(){}},{key:"call",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,t){var r=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.length>2&&void 0!==r[2]?r[2]:{},e.abrupt("return",void 0);case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()}]),e}(),ht=function(e){(0,$.Z)(t,e);var n=(0,Y.Z)(t);function t(e){var r;return(0,d.Z)(this,t),(r=n.call(this,e)).name="MainThreadRpcDriver",r.makeWorker=void 0,r.makeWorker=(0,a.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new pt);case 1:case"end":return e.stop()}}),e)}))),r}return(0,f.Z)(t,[{key:"call",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,t,r,a){var o,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new TypeError("sessionId is required");case 2:return o=n.getRpcMethodType(r),e.next=5,o.serializeArguments(a,this.name);case 5:return s=e.sent,e.next=8,o.execute(s,this.name);case 8:return c=e.sent,e.abrupt("return",o.deserializeReturn(c,a,this.name));case 10:case"end":return e.stop()}}),e,this)})));return function(n,t,r,i){return e.apply(this,arguments)}}()}]),t}(lt),gt=function(){function e(n,t,r){if((0,d.Z)(this,e),this.pluginManager=n,this.mainConfiguration=t,this.backendConfigurations=r,this.driverObjects=void 0,!t)throw new Error("RpcManager requires at least a main configuration");this.driverObjects=new Map}return(0,f.Z)(e,[{key:"getDriver",value:function(e){var n,t=this.driverObjects.get(e);if(t)return t;var r=this.mainConfiguration.drivers.get("WebWorkerRpcDriver");if("MainThreadRpcDriver"===e){var i=this.backendConfigurations.MainThreadRpcDriver;if(!i)throw new Error('requested RPC driver "'.concat(e,'" is missing config'));n=new ht((0,o.Z)((0,o.Z)({},i),{},{config:r}))}else{if("WebWorkerRpcDriver"!==e)throw new Error('requested RPC driver "'.concat(e,'" is not installed'));var a=this.backendConfigurations.WebWorkerRpcDriver;if(!a)throw new Error('requested RPC driver "'.concat(e,'" is missing config'));n=new ft((0,o.Z)((0,o.Z)({},a),{},{config:r}),{plugins:this.pluginManager.runtimePluginDefinitions})}return this.driverObjects.set(e,n),n}},{key:"getDriverForCall",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,t,r){var a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.rpcDriverName||(0,S.readConfObject)(this.mainConfiguration,"defaultDriver"),e.abrupt("return",this.getDriver(a));case 2:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()},{key:"call",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,t,r){var a,o,s=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=s.length>3&&void 0!==s[3]?s[3]:{},n){e.next=3;break}throw new Error("sessionId is required");case 3:return e.next=5,this.getDriverForCall(n,t,r);case 5:return o=e.sent,e.abrupt("return",o.call(this.pluginManager,n,t,r,a));case 7:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()}]),e}();gt.configSchema=nt;var vt=function(){function e(n){(0,d.Z)(this,e),this.pluginManager=n,this.adapterCache=void 0,this.adapterCache=new Nn.Z({maxSize:15})}return(0,f.Z)(e,[{key:"loadTextSearchAdapters",value:function(e){var n=this;return this.relevantAdapters(e).map((function(e){var t=(0,S.readConfObject)(e,"textSearchAdapterId");if(n.adapterCache.has(t))return n.adapterCache.get(t);var r=new(0,n.pluginManager.getTextSearchAdapterType(e.type).AdapterClass)(e,void 0,n.pluginManager);return n.adapterCache.set(t,r),r}))}},{key:"relevantAdapters",value:function(e){var n,t=null===(n=this.pluginManager.rootModel)||void 0===n?void 0:n.jbrowse,i=t.aggregateTextSearchAdapters,a=t.tracks,o=e.assemblyName;return[].concat((0,r.Z)(this.getAdaptersWithAssembly(o,i)),(0,r.Z)(this.getTrackAdaptersWithAssembly(o,a)))}},{key:"getAdaptersWithAssembly",value:function(e,n){return n.filter((function(n){var t;return null===(t=(0,S.readConfObject)(n,"assemblyNames"))||void 0===t?void 0:t.includes(e)}))}},{key:"getTrackAdaptersWithAssembly",value:function(e,n){return n.filter((function(n){var t;return null===(t=(0,S.readConfObject)(n,["textSearching","textSearchAdapter","assemblyNames"]))||void 0===t?void 0:t.includes(e)})).map((function(e){return e.textSearching.textSearchAdapter}))}},{key:"search",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n,t,r){var a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.loadTextSearchAdapters(t),e.next=3,Promise.all(a.map((function(e){return e.searchIndex(n)})));case 3:return o=e.sent,e.abrupt("return",this.sortResults(o.flat(),r));case 5:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()},{key:"sortResults",value:function(e,n){return n(e.sort((function(e,n){return-n.getLabel().localeCompare(e.getLabel())}))).sort((function(e,n){return e.getScore()-n.getScore()}))}}]),e}(),mt=t(10901),yt=t(74898),bt=t(6992),wt=t(52477),xt=t(75966),Zt=t(18765),kt=t(95589),St=t(38123),jt=t(43727),Ct=t(39554),Tt=t.n(Ct);function Mt(e,n,t){var r=p.types.model("JBrowseWeb",{configuration:(0,S.ConfigurationSchema)("Root",(0,o.Z)({rpc:gt.configSchema,highResolutionScaling:{type:"number",defaultValue:2},shareURL:{type:"string",defaultValue:"https://share.jbrowse.org/api/v1/"},featureDetails:(0,S.ConfigurationSchema)("FeatureDetails",{sequenceTypes:{type:"stringArray",defaultValue:["mRNA","transcript"]}}),disableAnalytics:{type:"boolean",defaultValue:!1},theme:{type:"frozen",defaultValue:{}},logoPath:{type:"fileLocation",defaultValue:{uri:"",locationType:"UriLocation"}}},e.pluginConfigurationSchemas())),plugins:p.types.array(p.types.frozen()),assemblies:p.types.array(t),tracks:p.types.array(e.pluggableConfigSchemaType("track")),internetAccounts:p.types.array(e.pluggableConfigSchemaType("internet account")),aggregateTextSearchAdapters:p.types.array(e.pluggableConfigSchemaType("text search adapter")),connections:p.types.array(e.pluggableConfigSchemaType("connection")),defaultSession:p.types.optional(p.types.frozen(n),{name:"New session"})}).views((function(e){return{get assemblyNames(){return e.assemblies.map((function(e){return(0,S.readConfObject)(e,"name")}))},get rpcManager(){return(0,p.getParent)(e).rpcManager}}})).actions((function(e){return{afterCreate:function(){var n=[];e.assemblyNames.forEach((function(e){if(!e)throw new Error('Encountered an assembly with no "name" defined');if(n.includes(e))throw new Error("Found two assemblies with the same name: ".concat(e));n.push(e)}))},addAssemblyConf:function(n){var t=n.name;if(!t)throw new Error('Can\'t add assembly with no "name"');var r=e.assemblies.find((function(e){return e.name===t}));if(r)return r;var i=e.assemblies.push((0,o.Z)((0,o.Z)({},n),{},{sequence:(0,o.Z)({type:"ReferenceSequenceTrack",trackId:"".concat(t,"-").concat(Date.now())},n.sequence||{})}));return e.assemblies[i-1]},removeAssemblyConf:function(n){var t=e.assemblies.find((function(e){return e.name===n}));t&&e.assemblies.remove(t)},addTrackConf:function(n){var t=n.type;if(!t)throw new Error("unknown track type ".concat(t));var r=e.tracks.find((function(e){return e.trackId===n.trackId}));if(r)return r;var i=e.tracks.push(n);return e.tracks[i-1]},addDisplayConf:function(n,t){var r=t.type;if(!r)throw new Error("unknown display type ".concat(r));var i=e.tracks.find((function(e){return e.trackId===n}));if(!i)throw new Error("could not find track with id ".concat(n));return i.addDisplayConf(t)},addConnectionConf:function(n){var t=n.type;if(!t)throw new Error("unknown connection type ".concat(t));var r=e.connections.push(n);return e.connections[r-1]},deleteConnectionConf:function(n){var t=e.connections.findIndex((function(e){return e.id===n.id}));if(-1!==t)return e.connections.splice(t,1)},deleteTrackConf:function(n){var t=n.trackId,r=e.tracks.findIndex((function(e){return e.trackId===t}));if(-1!==r)return e.tracks.splice(r,1)},setDefaultSessionConf:function(n){var t;if(!(t=(0,p.getParent)(e).session.name===n.name?(0,p.getSnapshot)(n):(0,En.toJS)(n)).name)throw new Error("unable to set default session to ".concat(t.name));e.defaultSession=(0,p.cast)(t)},addPlugin:function(n){e.plugins.push(n),(0,p.getRoot)(e).setPluginsUpdated(!0)},removePlugin:function(n){e.plugins=(0,p.cast)(e.plugins.filter((function(e){return e.url!==n.url||e.umdUrl!==n.umdUrl||e.cjsUrl!==n.cjsUrl||e.esmUrl!==n.esmUrl}))),(0,p.getParent)(e).setPluginsUpdated(!0)},addInternetAccountConf:function(n){var t=n.type;if(!t)throw new Error("unknown internetAccount type ".concat(t));var r=e.internetAccounts.push(n);return e.internetAccounts[r-1]},deleteInternetAccountConf:function(n){var t=e.internetAccounts.findIndex((function(e){return e.id===n.id}));if(-1!==t)return e.internetAccounts.splice(t,1)}}}));return p.types.snapshotProcessor(r,{postProcessor:function(e){return function e(n,t){for(var r in n)r===t?delete n[r]:"object"===typeof n[r]&&e(n[r],t);return n}(Tt()(e),"baseUri")}})}function Et(e){return e.extend((function(){return function(e){return{views:{get snackbarMessages(){return e}},actions:{notify:function(e,n,t){var r=this;this.pushSnackbarMessage(e,n,t),"info"!==n&&"success"!==n||setTimeout((function(){r.removeSnackbarMessage(e)}),5e3)},pushSnackbarMessage:function(n,t,r){return e.push([n,t,r])},popSnackbarMessage:function(){return e.pop()},removeSnackbarMessage:function(n){var t=e.find((function(e){return e[0]===n}));t&&e.remove(t)}}}}(En.observable.array())}))}window.getSnapshot=p.getSnapshot,window.resolveIdentifier=p.resolveIdentifier;var At=t(53017),Pt=t(43904),It=["connectionInstances"],Rt=(0,u.lazy)((function(){return t.e(2692).then(t.bind(t,82692))}));function Nt(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.types.frozen(),t=128,i=p.types.model("JBrowseWebSessionModel",{id:p.types.optional(p.types.identifier,B()()),name:p.types.string,margin:0,drawerWidth:p.types.optional(p.types.refinement(p.types.integer,(function(e){return e>=t})),384),views:p.types.array(e.pluggableMstType("view","stateModel")),widgets:p.types.map(e.pluggableMstType("widget","stateModel")),activeWidgets:p.types.map(p.types.safeReference(e.pluggableMstType("widget","stateModel"))),connectionInstances:p.types.array(e.pluggableMstType("connection","stateModel")),sessionTracks:p.types.array(e.pluggableConfigSchemaType("track")),sessionConnections:p.types.array(e.pluggableConfigSchemaType("connection")),sessionAssemblies:p.types.array(n),sessionPlugins:p.types.array(p.types.frozen()),minimized:p.types.optional(p.types.boolean,!1),drawerPosition:p.types.optional(p.types.string,localStorage.getItem("drawerPosition")||"right")}).volatile((function(){return{selection:void 0,task:void 0,queueOfDialogs:En.observable.array([])}})).views((function(e){return{get DialogComponent(){if(e.queueOfDialogs.length){var n=e.queueOfDialogs[0];return n&&n[0]}},get DialogProps(){if(e.queueOfDialogs.length){var n=e.queueOfDialogs[0];return n&&n[1]}},get shareURL(){return(0,S.getConf)((0,p.getParent)(e).jbrowse,"shareURL")},get rpcManager(){return(0,p.getParent)(e).jbrowse.rpcManager},get configuration(){return(0,p.getParent)(e).jbrowse.configuration},get assemblies(){return(0,p.getParent)(e).jbrowse.assemblies},get assemblyNames(){return(0,p.getParent)(e).jbrowse.assemblyNames},get tracks(){return[].concat((0,r.Z)(e.sessionTracks),(0,r.Z)((0,p.getParent)(e).jbrowse.tracks))},get textSearchManager(){return(0,p.getParent)(e).textSearchManager},get connections(){return[].concat((0,r.Z)(e.sessionConnections),(0,r.Z)((0,p.getParent)(e).jbrowse.connections))},get adminMode(){return(0,p.getParent)(e).adminMode},get savedSessions(){return(0,p.getParent)(e).savedSessions},get previousAutosaveId(){return(0,p.getParent)(e).previousAutosaveId},get savedSessionNames(){return(0,p.getParent)(e).savedSessionNames},get history(){return(0,p.getParent)(e).history},get menus(){return(0,p.getParent)(e).menus},get assemblyManager(){return(0,p.getParent)(e).assemblyManager},get version(){return(0,p.getParent)(e).version},renderProps:function(){return{theme:(0,S.readConfObject)(this.configuration,"theme")}},get visibleWidget(){if((0,p.isAlive)(e))return Array.from(e.activeWidgets.values())[e.activeWidgets.size-1]},getReferring:function(n){var t=[];return(0,p.walk)((0,p.getParent)(e),(function(e){if((0,p.isModelType)((0,p.getType)(e))){var r=(0,p.getMembers)(e);Object.entries(r.properties).forEach((function(r){var i=(0,c.Z)(r,2),a=i[0],o=i[1];(0,p.isReferenceType)(o)&&e[a]===n&&t.push({node:e,key:a})}))}})),t}}})).actions((function(n){return{setDrawerPosition:function(e){n.drawerPosition=e,localStorage.setItem("drawerPosition",e)},queueDialog:function(e){var t=e((function(){n.queueOfDialogs.shift()})),r=(0,c.Z)(t,2),i=r[0],a=r[1];n.queueOfDialogs.push([i,a])},setName:function(e){n.name=e},addAssembly:function(e){var t=n.sessionAssemblies.find((function(n){return n.name===e.name}));if(t)return console.warn("Assembly ".concat(e.name," was already existing")),t;n.sessionAssemblies.push(e)},addSessionPlugin:function(e){if(n.sessionPlugins.find((function(n){return n.name===e.name})))throw new Error("session plugin cannot be installed twice");n.sessionPlugins.push(e),(0,p.getRoot)(n).setPluginsUpdated(!0)},removeAssembly:function(e){var t=n.sessionAssemblies.findIndex((function(n){return n.name===e}));-1!==t&&n.sessionAssemblies.splice(t,1)},removeSessionPlugin:function(e){n.sessionPlugins=(0,p.cast)(n.sessionPlugins.filter((function(n){return n.url!==e.url||n.umdUrl!==e.umdUrl||n.cjsUrl!==e.cjsUrl||n.esmUrl!==e.esmUrl}))),(0,p.getParent)(n).setPluginsUpdated(!0)},makeConnection:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.type;if(!i)throw new Error("track configuration has no `type` listed");var a=(0,S.readConfObject)(t,"name"),s=e.getConnectionType(i);if(!s)throw new Error("unknown connection type ".concat(i));var c=(0,o.Z)((0,o.Z)({},r),{},{name:a,type:i,configuration:t}),u=n.connectionInstances.push(c);return n.connectionInstances[u-1]},removeReferring:function(e,t,r,i){var a=this;e.forEach((function(e){var o=e.node,s=!1;try{var c="open track(s)",u=(0,R.getContainingView)(o);r.push((function(){return u.hideTrack(t.trackId)})),s=!0,i[c]||(i[c]=0),i[c]+=1}catch(d){}if(n.widgets.has(o.id)){var l="configuration editor widget(s)";r.push((function(){return a.hideWidget(o)})),s=!0,i[l]||(i[l]=0),i[l]+=1}if(!s)throw new Error("Error when closing this connection, the following node is still referring to a track configuration: ".concat(JSON.stringify((0,p.getSnapshot)(o))))}))},prepareToBreakConnection:function(e){var t=this,r=[],i={},a=(0,S.readConfObject)(e,"name"),o=n.connectionInstances.find((function(e){return e.name===a}));if(o){o.tracks.forEach((function(e){var a=n.getReferring(e);t.removeReferring(a,e,r,i)}));return[function(){r.forEach((function(e){return e()})),t.breakConnection(e)},i]}},breakConnection:function(e){var t=(0,S.readConfObject)(e,"name"),r=n.connectionInstances.find((function(e){return e.name===t}));n.connectionInstances.remove(r)},deleteConnection:function(e){var t;if(n.adminMode&&(t=(0,p.getParent)(n).jbrowse.deleteConnectionConf(e)),!t){var r=e.connectionId,i=n.sessionConnections.findIndex((function(e){return e.connectionId===r}));if(-1===i)return;return n.sessionConnections.splice(i,1)}return t},updateDrawerWidth:function(e){if(e===n.drawerWidth)return n.drawerWidth;var r=e;return r<t&&(r=t),n.drawerWidth=r,r},resizeDrawer:function(e){"left"===n.drawerPosition&&(e*=-1);var t=n.drawerWidth;return t-this.updateDrawerWidth(t-e)},addView:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.getElementType("view",t);if(!i)throw new Error("unknown view type ".concat(t));var a=n.views.push((0,o.Z)((0,o.Z)({},r),{},{type:t}));return n.views[a-1]},removeView:function(e){var t,r=(0,l.Z)(n.activeWidgets);try{for(r.s();!(t=r.n()).done;){var i=(0,c.Z)(t.value,2)[1];i.view&&i.view.id===e.id&&this.hideWidget(i)}}catch(a){r.e(a)}finally{r.f()}n.views.remove(e)},addAssemblyConf:function(e){return(0,p.getParent)(n).jbrowse.addAssemblyConf(e)},addTrackConf:function(e){if(n.adminMode)return(0,p.getParent)(n).jbrowse.addTrackConf(e);var t=e.trackId,r=e.type;if(!r)throw new Error("unknown track type ".concat(r));var i=n.sessionTracks.find((function(e){return e.trackId===t}));if(i)return i;var a=n.sessionTracks.push(e);return n.sessionTracks[a-1]},deleteTrackConf:function(e){var t=[],r=n.getReferring(e);if(this.removeReferring(r,e,t,{}),t.forEach((function(e){return e()})),n.adminMode)return(0,p.getParent)(n).jbrowse.deleteTrackConf(e);var i=e.trackId,a=n.sessionTracks.findIndex((function(e){return e.trackId===i}));return-1!==a?n.sessionTracks.splice(a,1):void 0},addConnectionConf:function(e){if(n.adminMode)return(0,p.getParent)(n).jbrowse.addConnectionConf(e);var t=e.connectionId,r=e.type;if(!r)throw new Error("unknown connection type ".concat(r));var i=n.sessionTracks.find((function(e){return e.connectionId===t}));if(i)return i;var a=n.sessionConnections.push(e);return n.sessionConnections[a-1]},addLinearGenomeViewOfAssembly:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addViewOfAssembly("LinearGenomeView",e,n)},addViewOfAssembly:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.assemblies.find((function(e){return(0,S.readConfObject)(e,"name")===t}));if(!i)throw new Error('Could not add view of assembly "'.concat(t,'", assembly name not found'));return r.displayRegionsFromAssemblyName=(0,S.readConfObject)(i,"name"),this.addView(e,r)},addViewFromAnotherView:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(0,o.Z)({},t);return r.displayedRegions=(0,p.getSnapshot)(n.displayedRegions),this.addView(e,r)},addWidget:function(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{type:t},s=e.getElementType("widget",t);if(!s)throw new Error("unknown widget type ".concat(t));var c=(0,o.Z)((0,o.Z)({},i),{},{id:r,type:t,configuration:a});return n.widgets.set(r,c),n.widgets.get(r)},showWidget:function(e){n.activeWidgets.has(e.id)&&n.activeWidgets.delete(e.id),n.activeWidgets.set(e.id,e),n.minimized=!1},hasWidget:function(e){return n.activeWidgets.has(e.id)},hideWidget:function(e){n.activeWidgets.delete(e.id)},minimizeWidgetDrawer:function(){n.minimized=!0},showWidgetDrawer:function(){n.minimized=!1},hideAllWidgets:function(){n.activeWidgets.clear()},setSelection:function(e){n.selection=e},clearSelection:function(){n.selection=void 0},clearConnections:function(){n.connectionInstances.length=0},addSavedSession:function(e){return(0,p.getParent)(n).addSavedSession(e)},removeSavedSession:function(e){return(0,p.getParent)(n).removeSavedSession(e)},renameCurrentSession:function(e){return(0,p.getParent)(n).renameCurrentSession(e)},duplicateCurrentSession:function(){return(0,p.getParent)(n).duplicateCurrentSession()},activateSession:function(e){return(0,p.getParent)(n).activateSession(e)},setDefaultSession:function(){return(0,p.getParent)(n).setDefaultSession()},saveSessionToLocalStorage:function(){return(0,p.getParent)(n).saveSessionToLocalStorage()},loadAutosaveSession:function(){return(0,p.getParent)(n).loadAutosaveSession()},setSession:function(e){return(0,p.getParent)(n).setSession(e)}}})).actions((function(e){return{editConfiguration:function(n){if(!(0,S.isConfigurationModel)(n))throw new Error("must pass a configuration model to editConfiguration");var t=e,r=t.addWidget("ConfigurationEditorWidget","configEditor",{target:n});t.showWidget(r)},editTrackConfiguration:function(n){if(!e.adminMode&&-1===e.sessionTracks.indexOf(n))throw new Error("Can't edit the configuration of a non-session track");this.editConfiguration(n)}}})).views((function(e){return{getTrackActionMenuItems:function(n){var t=e,r=t.adminMode||t.sessionTracks.find((function(e){return e.trackId===n.trackId})),i="ReferenceSequenceTrack"===(0,S.readConfObject)(n,"type");return[{label:"About track",onClick:function(){t.queueDialog((function(e){return[Rt,{config:n,handleClose:e}]}))},icon:Pt.Z},{label:"Settings",disabled:!r,onClick:function(){t.editTrackConfiguration(n)},icon:Ke.Z},{label:"Delete track",disabled:!r||i,onClick:function(){t.deleteTrackConf(n)},icon:At.Z},{label:"Copy track",disabled:i,onClick:function(){var e=JSON.parse(JSON.stringify((0,p.getSnapshot)(n))),r=Date.now();e.trackId+="-".concat(r),e.displays.forEach((function(e){e.displayId+="-".concat(r)})),t.adminMode||(e.trackId+="-sessionTrack",e.category=void 0),e.name+=" (copy)",t.addTrackConf(e)},icon:bt.Z}]}}}));return p.types.snapshotProcessor(Et(i),{preProcessor:function(e){if(e){var n=e||{},t=n.connectionInstances,r=(0,s.Z)(n,It);if(!Array.isArray(t))return r}return e}})}function Dt(e,n){if(void 0!==e)if((0,p.isArrayType)(n))!function(){var n=e,t=(0,p.getChildType)(e);if((0,p.isReferenceType)(t))for(var r=function(e){(0,p.isValidReference)((function(){return n[e]}))?e+=1:n.splice(e,1),i=e},i=0;i<n.length;)r(i);n.forEach((function(e){Dt(e,t)}))}();else if((0,p.isMapType)(n))!function(){var n=e,t=(0,p.getChildType)(n);if((0,p.isReferenceType)(t)){var r=function(e){(0,p.isValidReference)((function(){return n.get(e)}))||n.delete(e)};for(var i in n.keys())r(i)}n.forEach((function(e){Dt(e,t)}))}();else if((0,p.isModelType)(n)){var t=(0,p.getPropertyMembers)(e).properties;Object.entries(t).forEach((function(n){var t=(0,c.Z)(n,2),r=t[0],i=t[1];Dt(e[r],i)}))}}function Wt(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=$n(e),i=Nt(e,t),a=Kn(t,e);return p.types.model("Root",{jbrowse:Mt(e,i,t),configPath:p.types.maybe(p.types.string),session:p.types.maybe(i),assemblyManager:a,version:p.types.maybe(p.types.string),internetAccounts:p.types.array(e.pluggableMstType("internet account","stateModel")),isAssemblyEditing:!1,isDefaultSessionEditing:!1}).volatile((function(n){return{pluginsUpdated:!1,rpcManager:new gt(e,n.jbrowse.configuration.rpc,{WebWorkerRpcDriver:{makeWorkerInstance:Tn},MainThreadRpcDriver:{}}),savedSessionsVolatile:En.observable.map({}),textSearchManager:new vt(e),pluginManager:e,error:void 0}})).views((function(e){return{get savedSessions(){return Array.from(e.savedSessionsVolatile.values())},localStorageId:function(n){return"localSaved-".concat(n,"-").concat(e.configPath)},get autosaveId(){return"autosave-".concat(e.configPath)},get previousAutosaveId(){return"previousAutosave-".concat(e.configPath)}}})).views((function(e){return{get savedSessionNames(){return e.savedSessions.map((function(e){return e.name}))},get currentSessionId(){var e,n=new URL(window.location.href),t=new URLSearchParams(n.search);return null===t||void 0===t||null===(e=t.get("session"))||void 0===e?void 0:e.split("local-")[1]}}})).actions((function(n){return{afterCreate:function(){var e=this;Object.entries(localStorage).filter((function(e){var n=(0,c.Z)(e,2),t=n[0];n[1];return t.startsWith("localSaved-")})).filter((function(e){var t=(0,c.Z)(e,2),r=t[0];t[1];return-1!==r.indexOf(n.configPath||"undefined")})).forEach((function(e){var t=(0,c.Z)(e,2),r=t[0],i=t[1];try{var a=JSON.parse(i).session;n.savedSessionsVolatile.set(r,a)}catch(o){console.error("bad session encountered",r,i)}})),(0,p.addDisposer)(n,(0,En.autorun)((function(){var e,t=(0,l.Z)(n.savedSessionsVolatile.entries());try{for(t.s();!(e=t.n()).done;){var r=(0,c.Z)(e.value,2)[1];try{var i=n.localStorageId(r.name);localStorage.setItem(i,JSON.stringify({session:r}))}catch(a){"22"!==a.code&&"1024"!==a.code||alert('Local storage is full! Please use the "Open sessions" panel to remove old sessions')}}}catch(o){t.e(o)}finally{t.f()}}))),(0,p.addDisposer)(n,(0,En.autorun)((function(){if(n.session){var e=(0,p.getSnapshot)(n.session)||{name:"empty"};sessionStorage.setItem("current",JSON.stringify({session:e})),localStorage.setItem("autosave-".concat(n.configPath),JSON.stringify({session:(0,o.Z)((0,o.Z)({},e),{},{name:"".concat(e.name,"-autosaved")})})),n.pluginsUpdated&&window.location.reload()}}),{delay:400})),(0,p.addDisposer)(n,(0,En.autorun)((function(){n.jbrowse.internetAccounts.forEach((function(n){e.initializeInternetAccount(n.internetAccountId)}))})))},setSession:function(e){var t=n.session;if(n.session=(0,p.cast)(e),n.session)try{Dt(n.session,(0,p.getType)(n.session))}catch(r){throw n.session=t,r}},initializeInternetAccount:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.pluggableConfigSchemaType("internet account"),a=(0,p.resolveIdentifier)(i,n,t),s=e.getInternetAccountType(a.type);if(!s)throw new Error("unknown internet account type ".concat(a.type));var c=s.stateModel.create((0,o.Z)((0,o.Z)({},r),{},{type:a.type,configuration:a}));return n.internetAccounts.push(c),c},createEphemeralInternetAccount:function(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;try{r=new URL(a).origin}catch(d){}var s=t.split("-"),c={type:s[0],internetAccountId:t,name:s.slice(1).join("-"),description:"",domains:r?[r]:[]},u=e.getInternetAccountType(c.type),l=u.stateModel.create((0,o.Z)((0,o.Z)({},i),{},{type:c.type,configuration:c}));return n.internetAccounts.push(l),l},setAssemblyEditing:function(e){n.isAssemblyEditing=e},setDefaultSessionEditing:function(e){n.isDefaultSessionEditing=e},setPluginsUpdated:function(e){n.pluginsUpdated=e},setDefaultSession:function(){var e=n.jbrowse.defaultSession,t=(0,o.Z)((0,o.Z)({},e),{},{name:"".concat(e.name," ").concat((new Date).toLocaleString())});this.setSession(t)},renameCurrentSession:function(e){if(n.session){var t=JSON.parse(JSON.stringify((0,p.getSnapshot)(n.session)));t.name=e,this.setSession(t)}},addSavedSession:function(e){var t=n.localStorageId(e.name);n.savedSessionsVolatile.set(t,e)},removeSavedSession:function(e){var t=n.localStorageId(e.name);localStorage.removeItem(t),n.savedSessionsVolatile.delete(t)},duplicateCurrentSession:function(){if(n.session){var e=JSON.parse(JSON.stringify((0,p.getSnapshot)(n.session))),t="".concat(n.session.name," (copy)");if(n.savedSessionNames.includes(t)){var r=2;do{t="".concat(n.session.name," (copy ").concat(r,")"),r+=1}while(n.savedSessionNames.includes(t))}e.name=t,this.setSession(e)}},activateSession:function(e){var t=n.localStorageId(e),r=localStorage.getItem(t);if(!r)throw new Error("Can't activate session ".concat(e,", it is not in the savedSessions"));this.setSession(JSON.parse(r).session)},saveSessionToLocalStorage:function(){if(n.session){var e=n.localStorageId(n.session.name);n.savedSessionsVolatile.set(e,(0,p.getSnapshot)(n.session))}},loadAutosaveSession:function(){var e=localStorage.getItem(n.previousAutosaveId),t=e?JSON.parse(e).session:{},r=t.name;t.name="".concat(r.replace("-autosaved",""),"-restored"),this.setSession(t)},setError:function(e){n.error=e},findAppropriateInternetAccount:function(e){var t=e.internetAccountId;if(t){var r=n.internetAccounts.find((function(e){return e.internetAccountId===t}));if(r)return r}var i,a=(0,l.Z)(n.internetAccounts);try{for(a.s();!(i=a.n()).done;){var o=i.value;if(o.handlesLocation(e))return o}}catch(s){a.e(s)}finally{a.f()}return t?this.createEphemeralInternetAccount(t,{},e.uri):null}}})).volatile((function(e){return{history:{},menus:[{label:"File",menuItems:[{label:"New session",icon:mt.Z,onClick:function(n){var t=localStorage.getItem(e.autosaveId);t&&localStorage.setItem(e.previousAutosaveId,t),n.setDefaultSession()}},{label:"Import session\u2026",icon:Zt.Z,onClick:function(e){var n=e.addWidget("ImportSessionWidget","importSessionWidget");e.showWidget(n)}},{label:"Export session",icon:xt.Z,onClick:function(e){var n=new Blob([JSON.stringify({session:(0,p.getSnapshot)(e)},null,2)],{type:"text/plain;charset=utf-8"});(0,Mn.saveAs)(n,"session.json")}},{label:"Open session\u2026",icon:wt.Z,onClick:function(e){var n=e.addWidget("SessionManager","sessionManager");e.showWidget(n)}},{label:"Save session",icon:jt.Z,onClick:function(n){e.saveSessionToLocalStorage(),n.notify('Saved session "'.concat(n.name,'"'),"success")}},{label:"Duplicate session",icon:bt.Z,onClick:function(e){e.duplicateCurrentSession&&e.duplicateCurrentSession()}},{type:"divider"},{label:"Open track...",icon:St.Z,onClick:function(e){if(0===e.views.length)e.notify("Please open a view to add a track first");else if(e.views.length>=1){var n=e.addWidget("AddTrackWidget","addTrackWidget",{view:e.views[0].id});e.showWidget(n),e.views.length>1&&e.notify("This will add a track to the first view. Note: if you want to open a track in a specific view open the track selector for that view and use the add track (plus icon) in the bottom right")}}},{label:"Open connection...",icon:Ye.sB,onClick:function(e){var n=e.addWidget("AddConnectionWidget","addConnectionWidget");e.showWidget(n)}},{type:"divider"},{label:"Return to splash screen",icon:yt.Z,onClick:function(){e.setSession(void 0)}}]}].concat((0,r.Z)(n?[{label:"Admin",menuItems:[{label:"Open assembly manager",icon:Ke.Z,onClick:function(){e.setAssemblyEditing(!0)}},{label:"Set default session",icon:Ke.Z,onClick:function(){e.setDefaultSessionEditing(!0)}}]}]:[]),[{label:"Add",menuItems:[]},{label:"Tools",menuItems:[{label:"Plugin store",icon:kt.Z,onClick:function(){if(e.session){var n=e.session.addWidget("PluginStoreWidget","pluginStoreWidget");e.session.showWidget(n)}}}]}]),adminMode:n}})).actions((function(e){return{setHistory:function(n){e.history=n},setMenus:function(n){e.menus=n},appendMenu:function(n){return e.menus.push({label:n,menuItems:[]})},insertMenu:function(n,t){return e.menus.splice((t<0?e.menus.length:0)+t,0,{label:n,menuItems:[]}),e.menus.length},appendToMenu:function(n,t){var r=e.menus.find((function(e){return e.label===n}));return r?r.menuItems.push(t):(e.menus.push({label:n,menuItems:[t]}),1)},insertInMenu:function(n,t,r){var i=e.menus.find((function(e){return e.label===n}));if(!i)return e.menus.push({label:n,menuItems:[t]}),1;var a=r<0?i.menuItems.length+r:r;return i.menuItems.splice(a,0,t),i.menuItems.length},appendToSubMenu:function(n,t){var r=e.menus.find((function(e){return e.label===n[0]}));if(!r){var i=this.appendMenu(n[0]);r=e.menus[i-1]}var a=r.menuItems,o=[n[0]];return n.slice(1).forEach((function(e){o.push(e);var n=a.find((function(n){return"label"in n&&n.label===e}));if(!n){var t=a.push({label:e,subMenu:[]});n=a[t-1]}if(!("subMenu"in n))throw new Error('"'.concat(e,'" in path "').concat(o,'" is not a subMenu'));a=n.subMenu})),a.push(t)},insertInSubMenu:function(n,t,r){var i=e.menus.find((function(e){return e.label===n[0]}));if(!i){var a=this.appendMenu(n[0]);i=e.menus[a-1]}var o=i.menuItems,s=[n[0]];return n.slice(1).forEach((function(e){s.push(e);var n=o.find((function(n){return"label"in n&&n.label===e}));if(!n){var t=o.push({label:e,subMenu:[]});n=o[t-1]}if(!("subMenu"in n))throw new Error('"'.concat(e,'" in path "').concat(s,'" is not a subMenu'));o=n.subMenu})),o.splice(r,0,t),o.length}}}))}var Ot="1.7.11";function Lt(){return Bt.apply(this,arguments)}function Bt(){return(Bt=(0,a.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.location=window.location.pathname;case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var zt=t(92371),Ut=t.n(zt);(0,S.ConfigurationSchema)("PluginSource",{name:{type:"string",defaultValue:""},url:{type:"string",defaultValue:""}});function Ft(e){return(void 0!==e.umdUrl||void 0!==e.url)&&void 0!==e.name}function Jt(e){return void 0!==e.esmUrl}function qt(e){return void 0!==e.cjsUrl}function _t(){return"object"===typeof self&&self.self===self&&self||"object"===typeof t.g&&t.g.global===t.g&&t.g||this}var Vt=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;(0,d.Z)(this,e),this.definitions=[],this.fetchESM=void 0,this.fetchCJS=void 0,this.fetchESM=null===t||void 0===t?void 0:t.fetchESM,this.fetchCJS=null===t||void 0===t?void 0:t.fetchCJS,this.definitions=JSON.parse(JSON.stringify(n))}return(0,f.Z)(e,[{key:"loadScript",value:function(e){var n=_t();if(!function(e){return Boolean("WorkerGlobalScope"in e)}(n))return Ut()(e);if(n&&n.importScripts)return new Promise((function(t,r){try{n.importScripts(e)}catch(i){return void r(i||new Error("failed to load ".concat(e)))}t()}));throw new Error("cannot figure out how to load external JS scripts in this environment")}},{key:"loadCJSPlugin",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n){var t,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.cjsUrl,e.prev=1,r=new URL(t,_t().location.href),e.next=9;break;case 5:throw e.prev=5,e.t0=e.catch(1),console.error(e.t0),new Error("Error parsing URL: ".concat(t));case 9:if("http:"===r.protocol||"https:"===r.protocol){e.next=11;break}throw new Error('Cannot load plugins using protocol "'.concat(r.protocol,'"'));case 11:if(this.fetchCJS){e.next=13;break}throw new Error("No fetchCJS callback provided");case 13:return e.abrupt("return",this.fetchCJS(r.href));case 14:case"end":return e.stop()}}),e,this,[[1,5]])})));return function(n){return e.apply(this,arguments)}}()},{key:"loadESMPlugin",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n){var t,r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=new URL(n.esmUrl,_t().location.href),e.next=8;break;case 4:throw e.prev=4,e.t0=e.catch(0),console.error(e.t0),new Error("Error parsing URL: ".concat(n.esmUrl));case 8:if("http:"===r.protocol||"https:"===r.protocol){e.next=10;break}throw new Error('cannot load plugins using protocol "'.concat(r.protocol,'"'));case 10:return e.next=12,null===(t=this.fetchESM)||void 0===t?void 0:t.call(this,r.href);case 12:if(a=e.sent){e.next=15;break}throw new Error("Could not load ESM plugin: ".concat(r));case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(n){return e.apply(this,arguments)}}()},{key:"loadUMDPlugin",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n){var t,r,a,o,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t="url"in n?n.url:n.umdUrl,e.prev=1,r=new URL(t,_t().location.href),e.next=9;break;case 5:throw e.prev=5,e.t0=e.catch(1),console.error(e.t0),new Error("Error parsing URL: ".concat(t));case 9:if("http:"===r.protocol||"https:"===r.protocol){e.next=11;break}throw new Error('cannot load plugins using protocol "'.concat(r.protocol,'"'));case 11:return e.next=13,this.loadScript(r.href);case 13:if(a=n.name,o="JBrowsePlugin".concat(a),s=_t(),c=s[o]){e.next=19;break}throw new Error("Failed to load UMD bundle for ".concat(a,", ").concat(s.constructor.name,".").concat(o," is undefined"));case 19:return e.abrupt("return",c);case 20:case"end":return e.stop()}}),e,this,[[1,5]])})));return function(n){return e.apply(this,arguments)}}()},{key:"loadPlugin",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(n){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!R.isElectron||!qt(n)){e.next=6;break}return e.next=3,this.loadCJSPlugin(n);case 3:case 9:case 15:t=e.sent,e.next=23;break;case 6:if(!Jt(n)){e.next=12;break}return e.next=9,this.loadESMPlugin(n);case 12:if(!Ft(n)){e.next=18;break}return e.next=15,this.loadUMDPlugin(n);case 18:if(R.isElectron||!qt(n)){e.next=22;break}throw new Error("Only CommonJS plugin found, but not in a NodeJS environment: ".concat(JSON.stringify(n)));case 22:throw new Error("Could not determine plugin type: ".concat(JSON.stringify(n)));case 23:return e.abrupt("return",t.default);case 24:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"installGlobalReExports",value:function(e){e.JBrowseExports=Object.fromEntries(Object.entries(C.Z).map((function(e){var n=(0,c.Z)(e,2);return[n[0],n[1]]})))}},{key:"load",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var n=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(this.definitions.map(function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.loadPlugin(t);case 2:return e.t0=e.sent,e.t1=t,e.abrupt("return",{plugin:e.t0,definition:e.t1});case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Ht=t(33528);function Gt(e,n){if("object"===typeof e)for(var t=0,r=Object.keys(e);t<r.length;t++){var i=r[t];"object"===typeof e[i]?Gt(e[i],n):"uri"===i&&(e.baseUri=n.href)}}function Qt(e,n,t){var r=e.configuration;return(void 0===r?{}:r)[n]||t}function Kt(){return $t.apply(this,arguments)}function $t(){return($t=(0,a.Z)((0,i.Z)().mark((function e(){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://jbrowse.org/plugin-store/plugins.json");case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("HTTP ".concat(n.status," ").concat(n.statusText," fetching plugins"));case 5:return e.abrupt("return",n.json());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Yt(e){return Xt.apply(this,arguments)}function Xt(){return(Xt=(0,a.Z)((0,i.Z)().mark((function e(n){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Kt();case 2:return t=e.sent,e.abrupt("return",n.every((function(e){return Ft(e)?Boolean(t.plugins.find((function(n){return Ft(n)&&("url"in n&&"url"in e&&n.url===e.url||"umdUrl"in n&&"umdUrl"in e&&n.umdUrl===e.umdUrl)}))):Jt(e)?Boolean(t.plugins.find((function(n){return Jt(n)&&n.esmUrl===e.esmUrl}))):!!qt(e)&&Boolean(t.plugins.find((function(n){return qt(n)&&n.cjsUrl===e.cjsUrl})))})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var er=p.types.model({configPath:p.types.maybe(p.types.string),sessionQuery:p.types.maybe(p.types.string),password:p.types.maybe(p.types.string),adminKey:p.types.maybe(p.types.string),loc:p.types.maybe(p.types.string),sessionTracks:p.types.maybe(p.types.string),assembly:p.types.maybe(p.types.string),tracks:p.types.maybe(p.types.string)}).volatile((function(){return{blankSession:!1,sessionTriaged:void 0,shareWarningOpen:!1,configSnapshot:void 0,sessionSnapshot:void 0,sessionSpec:void 0,runtimePlugins:[],sessionPlugins:[],sessionError:void 0,configError:void 0,bc1:window.BroadcastChannel&&new window.BroadcastChannel("jb_request_session"),bc2:window.BroadcastChannel&&new window.BroadcastChannel("jb_respond_session")}})).views((function(e){return{get isSharedSession(){var n;return!(null===(n=e.sessionQuery)||void 0===n||!n.startsWith("share-"))},get isSpecSession(){var n;return!(null===(n=e.sessionQuery)||void 0===n||!n.startsWith("spec-"))},get isJb1StyleSession(){return!!e.loc},get isEncodedSession(){var n;return!(null===(n=e.sessionQuery)||void 0===n||!n.startsWith("encoded-"))},get isJsonSession(){var n;return!(null===(n=e.sessionQuery)||void 0===n||!n.startsWith("json-"))},get isLocalSession(){var n;return!(null===(n=e.sessionQuery)||void 0===n||!n.startsWith("local-"))},get ready(){return Boolean(this.isSessionLoaded&&!e.configError)},get error(){return e.configError||e.sessionError},get isSessionLoaded(){return Boolean(e.sessionError||e.sessionSnapshot||e.blankSession||e.sessionSpec)},get isConfigLoaded(){return Boolean(e.configError||e.configSnapshot)},get sessionTracksParsed(){return e.sessionTracks?JSON.parse(e.sessionTracks):[]}}})).actions((function(e){return{setSessionQuery:function(n){e.sessionQuery=n},setConfigError:function(n){e.configError=n},setSessionError:function(n){e.sessionError=n},setRuntimePlugins:function(n){e.runtimePlugins=n},setSessionPlugins:function(n){e.sessionPlugins=n},setConfigSnapshot:function(n){e.configSnapshot=n},setBlankSession:function(n){e.blankSession=n},setSessionTriaged:function(n){e.sessionTriaged=n},setSessionSnapshotSuccess:function(n){e.sessionSnapshot=n}}})).actions((function(e){return{fetchPlugins:function(n){return(0,a.Z)((0,i.Z)().mark((function t(){var a,o;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(a=new Vt(n.plugins,{fetchESM:function(e){return import(e)}})).installGlobalReExports(window),t.next=5,a.load();case 5:o=t.sent,e.setRuntimePlugins((0,r.Z)(o)),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0),e.setConfigError(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()},fetchSessionPlugins:function(n){return(0,a.Z)((0,i.Z)().mark((function t(){var a,o;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(a=new Vt(n.sessionPlugins||[],{fetchESM:function(e){return import(e)}})).installGlobalReExports(window),t.next=5,a.load();case 5:o=t.sent,e.setSessionPlugins((0,r.Z)(o)),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0),e.setConfigError(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()},setSessionSnapshot:function(n,t){var r=this;return(0,a.Z)((0,i.Z)().mark((function a(){var o,s;return(0,i.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,o=n.sessionPlugins,s=void 0===o?[]:o,i.next=4,Yt(s);case 4:if(!i.sent&&!t){i.next=11;break}return i.next=8,r.fetchSessionPlugins(n);case 8:e.setSessionSnapshotSuccess(n),i.next=12;break;case 11:e.setSessionTriaged({snap:n,origin:"session",reason:s});case 12:i.next=18;break;case 14:i.prev=14,i.t0=i.catch(0),console.error(i.t0),e.setConfigError(i.t0);case 18:case"end":return i.stop()}}),a,null,[[0,14]])})))()},fetchConfig:function(){var n=this;return(0,a.Z)((0,i.Z)().mark((function t(){var r,a,o,s,c,u;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.configPath,a=void 0===r?"config.json":r,t.next=3,(0,Ht.openLocation)({uri:a,locationType:"UriLocation"}).readFile("utf8");case 3:if(o=t.sent,s=JSON.parse(o),c=new URL(a,window.location.href),Gt(s,c),c.hostname===window.location.hostname){t.next=21;break}return u=s.plugins||[],t.next=11,Yt(u);case 11:if(t.sent){t.next=16;break}e.setSessionTriaged({snap:s,origin:"config",reason:u}),t.next=19;break;case 16:return t.next=18,n.fetchPlugins(s);case 18:e.setConfigSnapshot(s);case 19:t.next=24;break;case 21:return t.next=23,n.fetchPlugins(s);case 23:e.setConfigSnapshot(s);case 24:case"end":return t.stop()}}),t)})))()},fetchSessionStorageSession:function(){var n=this;return(0,a.Z)((0,i.Z)().mark((function t(){var r,a,s,c,u;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=sessionStorage.getItem("current"),a=e.sessionQuery.replace("local-",""),!r){t.next=8;break}if(s=JSON.parse(r).session||{},a!==s.id){t.next=8;break}return t.next=7,n.setSessionSnapshot(s);case 7:return t.abrupt("return");case 8:if(!e.bc1){t.next=22;break}return e.bc1.postMessage(a),c=new Promise((function(n,t){e.bc2&&(e.bc2.onmessage=function(e){n(e.data)}),setTimeout((function(){return t()}),1e3)})),t.prev=11,t.next=14,c;case 14:return u=t.sent,t.next=17,e.setSessionSnapshot((0,o.Z)((0,o.Z)({},u),{},{id:B()()}));case 17:return t.abrupt("return");case 20:t.prev=20,t.t0=t.catch(11);case 22:throw new Error("Local storage session not found");case 23:case"end":return t.stop()}}),t,null,[[11,20]])})))()},fetchSharedSession:function(){var n=this;return(0,a.Z)((0,i.Z)().mark((function t(){var r,a;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"https://share.jbrowse.org/api/v1/",t.next=3,gn("".concat(Qt(e.configSnapshot,"shareURL","https://share.jbrowse.org/api/v1/"),"load"),e.sessionQuery||"",e.password||"");case 3:return r=t.sent,t.t0=JSON,t.next=7,en(r);case 7:return t.t1=t.sent,a=t.t0.parse.call(t.t0,t.t1),t.next=11,n.setSessionSnapshot((0,o.Z)((0,o.Z)({},a),{},{id:B()()}));case 11:case"end":return t.stop()}}),t)})))()},decodeEncodedUrlSession:function(){var n=this;return(0,a.Z)((0,i.Z)().mark((function t(){var r;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=JSON,t.next=3,en(e.sessionQuery.replace("encoded-",""));case 3:return t.t1=t.sent,r=t.t0.parse.call(t.t0,t.t1),t.next=7,n.setSessionSnapshot((0,o.Z)((0,o.Z)({},r),{},{id:B()()}));case 7:case"end":return t.stop()}}),t)})))()},decodeSessionSpec:function(){e.sessionQuery&&(e.sessionSpec=JSON.parse(e.sessionQuery.replace("spec-","")))},decodeJb1StyleSession:function(){var n=e.loc,t=e.tracks,r=e.assembly,i=e.sessionTracksParsed;n&&(e.sessionSpec={sessionTracks:i,views:[{type:"LinearGenomeView",tracks:null===t||void 0===t?void 0:t.split(","),sessionTracks:i,loc:n,assembly:r}]})},decodeJsonUrlSession:function(){var n=this;return(0,a.Z)((0,i.Z)().mark((function t(){var r;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=JSON.parse(e.sessionQuery.replace("json-","")),t.next=3,n.setSessionSnapshot((0,o.Z)((0,o.Z)({},r.session),{},{id:B()()}));case 3:case"end":return t.stop()}}),t)})))()},afterCreate:function(){var n=this;return(0,a.Z)((0,i.Z)().mark((function t(){var r,o;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{r=e.configPath,(o=localStorage.getItem("autosave-".concat(r)))&&localStorage.setItem("previousAutosave-".concat(r),o)}catch(s){console.error("failed to create previousAutosave",s)}return t.prev=1,t.next=4,n.fetchConfig();case 4:t.next=11;break;case 6:return t.prev=6,t.t0=t.catch(1),console.error(t.t0),e.setConfigError(t.t0),t.abrupt("return");case 11:(0,p.addDisposer)(e,(0,En.autorun)((0,a.Z)((0,i.Z)().mark((function t(){var r,a,o,s,c,u,l;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=e.isLocalSession,a=e.isEncodedSession,o=e.isSpecSession,s=e.isSharedSession,c=e.isJsonSession,u=e.isJb1StyleSession,l=e.sessionQuery,e.configSnapshot){t.next=4;break}return t.abrupt("return");case 4:if(!s){t.next=9;break}return t.next=7,n.fetchSharedSession();case 7:t.next=37;break;case 9:if(!o){t.next=13;break}n.decodeSessionSpec(),t.next=37;break;case 13:if(!u){t.next=17;break}n.decodeJb1StyleSession(),t.next=37;break;case 17:if(!a){t.next=22;break}return t.next=20,n.decodeEncodedUrlSession();case 20:t.next=37;break;case 22:if(!c){t.next=27;break}return t.next=25,n.decodeJsonUrlSession();case 25:t.next=37;break;case 27:if(!r){t.next=32;break}return t.next=30,n.fetchSessionStorageSession();case 30:t.next=37;break;case 32:if(!l){t.next=36;break}throw new Error("unrecognized session format");case 36:e.setBlankSession(!0);case 37:e.bc1&&(e.bc1.onmessage=function(n){var t=JSON.parse(sessionStorage.getItem("current")||"{}").session||{};t.id===n.data&&e.bc2&&e.bc2.postMessage(t)}),t.next=44;break;case 40:t.prev=40,t.t0=t.catch(0),console.error(t.t0),e.setSessionError(t.t0);case 44:case"end":return t.stop()}}),t,null,[[0,40]])})))));case 12:case"end":return t.stop()}}),t,null,[[1,6]])})))()}}}));var nr=["config"],tr=(0,u.lazy)((function(){return t.e(1716).then(t.bind(t,61716))})),rr=(0,u.lazy)((function(){return t.e(8208).then(t.bind(t,68208))})),ir=(0,u.lazy)((function(){return Promise.resolve().then(t.bind(t,16383))})),ar=(0,u.lazy)((function(){return t.e(9161).then(t.bind(t,29161))}));function or(){return(0,mn.jsxs)("div",{children:[(0,mn.jsx)("h4",{children:"Configuration not found. You may have arrived here if you requested a config that does not exist or you have not set up your JBrowse yet."}),(0,mn.jsxs)("p",{children:["If you want to complete your setup, visit our"," ",(0,mn.jsx)("a",{href:"https://jbrowse.org/jb2/docs/quickstart_web",children:"Quick start guide"})]}),R.inDevelopment?(0,mn.jsxs)(mn.Fragment,{children:[(0,mn.jsx)("div",{children:"Sample JBrowse configs:"}),(0,mn.jsx)("ul",{children:[["test_data/volvox/config.json","Volvox sample data"],["test_data/config.json","Human basic"],["test_data/config_demo.json","Human sample data"],["test_data/tomato/config.json","Tomato SVs"],["test_data/breakpoint/config.json","Breakpoint"],["test_data/config_dotplot.json","Grape/Peach dotplot"],["test_data/config_synteny_grape_peach.json","Grape/Peach synteny"],["test_data/yeast_synteny/config.json","Yeast synteny"],["test_data/config_many_contigs.json","Many contigs"],["test_data/config_honeybee.json","Honeybee"],["test_data/config_wormbase.json","Wormbase"],["test_data/wgbs/config.json","WGBS methylation"]].map((function(e){var n=(0,c.Z)(e,2),t=n[0],r=n[1],i=window.location,a=i.href,u=i.search,l=O.parse(u),d=(l.config,(0,s.Z)(l,nr)),f=a.split("?")[0],p=O.stringify((0,o.Z)((0,o.Z)({},d),{},{config:t}));return(0,mn.jsx)("li",{children:(0,mn.jsx)("a",{href:"".concat(f,"?").concat(p),children:r})},r)}))})]}):(0,mn.jsxs)(mn.Fragment,{children:[(0,mn.jsx)("div",{children:"Sample JBrowse config:"}),(0,mn.jsx)("ul",{children:(0,mn.jsx)("li",{children:(0,mn.jsx)("a",{href:"?config=test_data/volvox/config.json",children:"Volvox sample data"})})})]})]})}function sr(e){var n=e.initialTimestamp,t=void 0===n?Date.now():n,r=function(e){return null===e?void 0:e},i=D.Zp,a=(0,D.Wd)("config",i),o=(0,c.Z)(a,1)[0],s=(0,D.Wd)("session",i),l=(0,c.Z)(s,1)[0],d=(0,D.Wd)("adminKey",i),f=(0,c.Z)(d,1)[0],p=(0,D.Wd)("password",i),h=(0,c.Z)(p,2),g=h[0],v=h[1],m=(0,D.Wd)("loc",i),y=(0,c.Z)(m,2),b=y[0],w=y[1],x=(0,D.Wd)("sessionTracks",i),Z=(0,c.Z)(x,2),k=Z[0],S=Z[1],j=(0,D.Wd)("assembly",i),C=(0,c.Z)(j,2),T=C[0],M=C[1],E=(0,D.Wd)("tracks",i),A=(0,c.Z)(E,2),P=A[0],I=A[1],R=er.create({configPath:r(o),sessionQuery:r(l),password:r(g),adminKey:r(f),loc:r(b),assembly:r(T),tracks:r(P),sessionTracks:r(k)});return(0,u.useEffect)((function(){w(void 0),I(void 0),M(void 0),v(void 0),S(void 0)}),[M,w,I,v,S]),(0,mn.jsx)(dr,{loader:R,initialTimestamp:t,initialSessionQuery:l})}var cr=function(e){var n=e.loader,t=e.handleClose;return(0,mn.jsx)(u.Suspense,{fallback:(0,mn.jsx)("div",{}),children:(0,mn.jsx)(tr,{onConfirm:(0,a.Z)((0,i.Z)().mark((function e(){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=JSON.parse(JSON.stringify(n.sessionTriaged.snap)),e.next=3,n.setSessionSnapshot((0,o.Z)((0,o.Z)({},r),{},{id:B()()}),!0);case 3:t();case 4:case"end":return e.stop()}}),e)}))),onCancel:function(){n.setBlankSession(!0),t()},reason:n.sessionTriaged.reason})})},ur=function(e){var n=e.err;return(0,mn.jsxs)(mn.Fragment,{children:[(0,mn.jsx)(or,{}),"".concat(n).match(/HTTP 404 fetching config.json/)?(0,mn.jsxs)("div",{style:{margin:8,padding:8,border:"1px solid black",background:"#9f9"},children:["No config.json found. If you want to learn how to complete your setup, visit our"," ",(0,mn.jsx)("a",{href:"https://jbrowse.org/jb2/docs/quickstart_web",children:"Quick start guide"})]}):(0,mn.jsx)(u.Suspense,{fallback:(0,mn.jsx)("div",{children:"Loading..."}),children:(0,mn.jsx)(ir,{error:n})})]})};function lr(e){var n=e.loader,t=e.handleClose;return(0,mn.jsx)(u.Suspense,{fallback:(0,mn.jsx)("div",{}),children:(0,mn.jsx)(rr,{onConfirm:(0,a.Z)((0,i.Z)().mark((function e(){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=JSON.parse(JSON.stringify(n.sessionTriaged.snap)),e.next=3,n.fetchPlugins(r);case 3:n.setConfigSnapshot((0,o.Z)((0,o.Z)({},r),{},{id:B()()})),t();case 5:case"end":return e.stop()}}),e)}))),onCancel:function(){Lt(),t()},reason:n.sessionTriaged.reason})})}var dr=(0,I.observer)((function(e){var n=e.loader,t=e.initialTimestamp,s=e.initialSessionQuery,l=n.sessionError,d=n.configError,f=n.ready,p=n.shareWarningOpen,h=(0,u.useState)(),g=(0,c.Z)(h,2),v=g[0],m=g[1],y=(0,u.useState)(),b=(0,c.Z)(y,2),w=b[0],x=b[1];(0,u.useEffect)((function(){try{var e=n.runtimePlugins,c=n.sessionPlugins,u=n.adminKey,d=n.configSnapshot,h=n.sessionSnapshot,g=n.configPath,v=n.sessionSpec;if(f){var y=new P([].concat((0,r.Z)(Te.map((function(e){return{plugin:new e,metadata:{isCore:!0}}}))),(0,r.Z)(e.map((function(e){var n=e.plugin,t=e.definition;return{plugin:new n,definition:t,metadata:{url:t.url}}}))),(0,r.Z)(c.map((function(e){var n=e.plugin,t=e.definition;return{plugin:new n,definition:t,metadata:{url:t.url}}})))));y.createPluggableElements();var b=Wt(y,!!u);if(d){var w,Z,k,S=b.create({jbrowse:d,assemblyManager:{},version:Ot,configPath:g},{pluginManager:y});S.jbrowse.configuration.rpc.drivers.get("WebWorkerRpcDriver")||S.jbrowse.configuration.rpc.addDriverConfig("WebWorkerRpcDriver",{type:"WebWorkerRpcDriver"}),null!==(w=n.configSnapshot)&&void 0!==w&&null!==(Z=w.configuration)&&void 0!==Z&&null!==(k=Z.rpc)&&void 0!==k&&k.defaultDriver||S.jbrowse.configuration.rpc.defaultDriver.set("WebWorkerRpcDriver");var j=function(){};try{var C,T;l?(S.setDefaultSession(),S.session&&S.session.notify("Error loading session: ".concat(l,'. If you\n                received this URL from another user, request that they send you\n                a session generated with the "Share" button instead of copying\n                and pasting their URL'))):h&&!p?S.setSession(h):v?j=function(e,n){var t=e.views,r=e.sessionTracks,s=void 0===r?[]:r;return(0,a.Z)((0,i.Z)().mark((function e(){var r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.rootModel){e.next=3;break}throw new Error("rootModel not initialized");case 3:return e.prev=3,r.setSession({name:"New session ".concat((new Date).toLocaleString())}),s.forEach((function(e){return r.session.addTrackConf(e)})),e.next=8,Promise.all(t.map((function(e){return n.evaluateAsyncExtensionPoint("LaunchView-"+e.type,(0,o.Z)((0,o.Z)({},e),{},{session:r.session}))})));case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),console.error(e.t0),null===(a=r.session)||void 0===a||a.notify("".concat(e.t0));case 14:case"end":return e.stop()}}),e,null,[[3,10]])})))}(v,y):null!==(C=S.jbrowse.defaultSession)&&void 0!==C&&null!==(T=C.views)&&void 0!==T&&T.length&&S.setDefaultSession()}catch(A){var M;S.setDefaultSession();var E="".concat(A).replace("[mobx-state-tree] ","").replace(/\(.+/,"");null===(M=S.session)||void 0===M||M.notify("Session could not be loaded. ".concat(E.length>1e3?"".concat(E.slice(0,1e3),"...see more in console"):E)),console.error(A)}F(S,t,s),y.setRootModel(S),y.configure(),m(y),j()}}}catch(A){x(A),console.error(A)}}),[n,p,f,l,t,s]);var Z,k=d||w;return k?(0,mn.jsx)(ur,{err:k}):n.sessionTriaged?"session"===n.sessionTriaged.origin?(0,mn.jsx)(cr,{loader:n,handleClose:function(){return n.setSessionTriaged(void 0)}}):(0,mn.jsx)(lr,{loader:n,handleClose:function(){return n.setSessionTriaged(void 0)}}):v?null!==(Z=v.rootModel)&&void 0!==Z&&Z.session?(0,mn.jsx)(Cn,{pluginManager:v}):(0,mn.jsx)(u.Suspense,{fallback:(0,mn.jsx)("div",{children:"Loading..."}),children:(0,mn.jsx)(ar,{rootModel:v.rootModel,onFactoryReset:Lt})}):(0,mn.jsx)(J.Z,{})})),fr=function(e){return(0,mn.jsx)(W.FatalErrorDialog,(0,o.Z)({resetButtonText:"Reset Session",onFactoryReset:Lt},e))},pr=function(e){var n=e.initialTimestamp;return(0,mn.jsx)(N.ErrorBoundary,{FallbackComponent:fr,children:(0,mn.jsx)(D.Fz,{children:(0,mn.jsx)(sr,{initialTimestamp:n})})})}},31158:function(){}}]);
//# sourceMappingURL=5414.2d1690cc.chunk.js.map