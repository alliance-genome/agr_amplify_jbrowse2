/*! For license information please see 6925.ccdf122d.chunk.js.LICENSE.txt */
(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[6925],{66925:function(e,t,r){"use strict";r.d(t,{lr:function(){return Ge},ED:function(){return ze}});var n=r(32723),a=r(34795),i=r(9249),o=r(87371),s=r(26700),c=r(49882).Buffer;function u(e){return c.from((0,s.inflate)(e))}var f=r(10326),h=r.n(f),l=r(91371),d=r.n(l),p=r(45754),v=r(86906),y=r(25991),g=function(e){(0,p.Z)(r,e);var t=(0,v.Z)(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,o.Z)(r)}((0,y.Z)(Error)),m=function(e){(0,p.Z)(r,e);var t=(0,v.Z)(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,o.Z)(r)}((0,y.Z)(Error)),b=function(e){(0,p.Z)(r,e);var t=(0,v.Z)(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,o.Z)(r)}(g),w=function(e){(0,p.Z)(r,e);var t=(0,v.Z)(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,o.Z)(r)}(b),k=function(e){(0,p.Z)(r,e);var t=(0,v.Z)(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,o.Z)(r)}(g),A=function(e){(0,p.Z)(r,e);var t=(0,v.Z)(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,o.Z)(r)}(g),S=12,_=4096,x=1<<23,B=(0,o.Z)((function e(){(0,i.Z)(this,e),this.F=void 0,this.C=void 0})),R=(0,o.Z)((function e(){(0,i.Z)(this,e),this.fc=new Array(256);for(var t=0;t<this.fc.length;t+=1)this.fc[t]=new B;this.R=null}));function C(e,t,r,n){return r*(e>>n)+(e&(1<<n)-1)-t}var E={FC:B,AriDecoder:R,Symbol:(0,o.Z)((function e(){(0,i.Z)(this,e),this.start=void 0,this.freq=void 0})),symbolInit:function(e,t,r){if(!(t<=65536))throw new b("assertion failed: start <= 1<<16");if(!(r<=65536-t))throw new b("assertion failed: freq <= 1<<16");e.start=t,e.freq=r},advanceStep:C,advanceSymbolStep:function(e,t,r){return C(e,t.start,t.freq,r)},get:function(e,t){return e&(1<<t)-1},advanceSymbol:function(e,t,r,n){return function(e,t,r,n,a){if((e=n*(e>>a)+(e&(1<<a)-1)-r)<x)do{e=e<<8|255&t.get()}while(e<x);return e}(e,t,r.start,r.freq,n)},renormalize:function(e,t){if(e<x)do{e=e<<8|255&t.get()}while(e<x);return e}};function M(e){if(!e)throw new b("assertion failed")}var F=r(49882).Buffer;function I(e,t){for(var r=new E.AriDecoder,n=new Array(256),a=0;a<n.length;a+=1)n[a]=new E.Symbol;return function(e,t,r){var n=0,a=0,i=255&e.get();do{null==t.fc[i]&&(t.fc[i]=new E.FC),t.fc[i].F=255&e.get(),t.fc[i].F>=128&&(t.fc[i].F&=-129,t.fc[i].F=(127&t.fc[i].F)<<8|255&e.get()),t.fc[i].C=a,E.symbolInit(r[i],t.fc[i].C,t.fc[i].F),t.R||(t.R=new Array(_)),t.R.fill(i,a,a+t.fc[i].F),a+=t.fc[i].F,0===n&&i+1===(255&e.getByteAt(e.position()))?(i=255&e.get(),n=255&e.get()):0!==n?(n-=1,i+=1):i=255&e.get()}while(0!==i);M(a<_)}(e,r,n),function(e,t,r,n){for(var a,i=e.getInt(),o=e.getInt(),s=e.getInt(),c=e.getInt(),u=n.remaining(),f=-4&u,h=0;h<f;h+=4){var l=t.R[E.get(i,S)],d=t.R[E.get(o,S)],p=t.R[E.get(s,S)],v=t.R[E.get(c,S)];n.putAt(h,l),n.putAt(h+1,d),n.putAt(h+2,p),n.putAt(h+3,v),i=E.advanceSymbolStep(i,r[255&l],S),o=E.advanceSymbolStep(o,r[255&d],S),s=E.advanceSymbolStep(s,r[255&p],S),c=E.advanceSymbolStep(c,r[255&v],S),i=E.renormalize(i,e),o=E.renormalize(o,e),s=E.renormalize(s,e),c=E.renormalize(c,e)}switch(n.setPosition(f),3&u){case 0:break;case 1:a=t.R[E.get(i,S)],E.advanceSymbol(i,e,r[255&a],S),n.put(a);break;case 2:a=t.R[E.get(i,S)],E.advanceSymbol(i,e,r[255&a],S),n.put(a),a=t.R[E.get(o,S)],E.advanceSymbol(o,e,r[255&a],S),n.put(a);break;case 3:a=t.R[E.get(i,S)],E.advanceSymbol(i,e,r[255&a],S),n.put(a),a=t.R[E.get(o,S)],E.advanceSymbol(o,e,r[255&a],S),n.put(a),a=t.R[E.get(s,S)],E.advanceSymbol(s,e,r[255&a],S),n.put(a);break;default:throw new b("invalid output size encountered during rANS decoding")}n.setPosition(0)}(e,r,n,t),t}function Z(e,t){for(var r=new Array(256),n=0;n<r.length;n+=1)r[n]=new E.AriDecoder;for(var a=new Array(256),i=0;i<a.length;i+=1){a[i]=new Array(256);for(var o=0;o<a[i].length;o+=1)a[i][o]=new E.Symbol}return function(e,t,r){var n=0,a=255&e.get();do{var i=0,o=0,s=255&e.get();null==t[a]&&(t[a]=new E.AriDecoder);do{null==t[a].fc[s]&&(t[a].fc[s]=new E.FC),t[a].fc[s].F=255&e.get(),t[a].fc[s].F>=128&&(t[a].fc[s].F&=-129,t[a].fc[s].F=(127&t[a].fc[s].F)<<8|255&e.get()),t[a].fc[s].C=o,0===t[a].fc[s].F&&(t[a].fc[s].F=_),null==r[a][s]&&(r[a][s]=new E.RansDecSymbol),E.symbolInit(r[a][s],t[a].fc[s].C,t[a].fc[s].F),null==t[a].R&&(t[a].R=new Array(_)),t[a].R.fill(s,o,o+t[a].fc[s].F),M((o+=t[a].fc[s].F)<=_),0===i&&s+1===(255&e.getByteAt(e.position()))?(s=255&e.get(),i=255&e.get()):0!==i?(i-=1,s+=1):s=255&e.get()}while(0!==s);0===n&&a+1===(255&e.getByteAt(e.position()))?(a=255&e.get(),n=255&e.get()):0!==n?(n-=1,a+=1):a=255&e.get()}while(0!==a)}(e,r,a),function(e,t,r,n){for(var a=t.remaining(),i=e.getInt(),o=e.getInt(),s=e.getInt(),c=e.getInt(),u=a>>2,f=0,h=u,l=2*u,d=3*u,p=0,v=0,y=0,g=0;f<u;f+=1,h+=1,l+=1,d+=1){var m=255&r[p].R[E.get(i,S)],b=255&r[v].R[E.get(o,S)],w=255&r[y].R[E.get(s,S)],k=255&r[g].R[E.get(c,S)];t.putAt(f,m),t.putAt(h,b),t.putAt(l,w),t.putAt(d,k),i=E.advanceSymbolStep(i,n[p][m],S),o=E.advanceSymbolStep(o,n[v][b],S),s=E.advanceSymbolStep(s,n[y][w],S),c=E.advanceSymbolStep(c,n[g][k],S),i=E.renormalize(i,e),o=E.renormalize(o,e),s=E.renormalize(s,e),c=E.renormalize(c,e),p=m,v=b,y=w,g=k}for(;d<a;d+=1){var A=255&r[g].R[E.get(c,S)];t.putAt(d,A),c=E.advanceSymbol(c,e,n[g][A],S),g=A}}(e,t,r,a),t}var U=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,i.Z)(this,e),this._buffer=t,this._position=r,this.length=t.length}return(0,o.Z)(e,[{key:"get",value:function(){var e=this._buffer[this._position];return this._position+=1,e}},{key:"getByte",value:function(){return this.get()}},{key:"getByteAt",value:function(e){return this._buffer[e]}},{key:"position",value:function(){return this._position}},{key:"put",value:function(e){return this._buffer[this._position]=e,this._position+=1,e}},{key:"putAt",value:function(e,t){return this._buffer[e]=t,t}},{key:"setPosition",value:function(e){return this._position=e,e}},{key:"getInt",value:function(){var e=this._buffer.readInt32LE(this._position);return this._position+=4,e}},{key:"remaining",value:function(){return this._buffer.length-this._position}}]),e}();var P=r(76254),q=(new P._).itf8(),D={parser:(new P._).string("magic",{length:4}).uint8("majorVersion").uint8("minorVersion").string("fileId",{length:20,stripNull:!0}),maxLength:26},L={parser:(new P._).uint8("compressionMethod",{formatter:function(e){var t=["raw","gzip","bzip2","lzma","rans","rans4x16","arith","fqzcomp","tok3"][e];if(!t)throw new Error("compression method number ".concat(e," not implemented"));return t}}).uint8("contentType",{formatter:function(e){var t=["FILE_HEADER","COMPRESSION_HEADER","MAPPED_SLICE_HEADER","UNMAPPED_SLICE_HEADER","EXTERNAL_DATA","CORE_DATA"][e];if(!t)throw new Error("invalid block content type id ".concat(e));return t}}).itf8("contentId").itf8("compressedSize").itf8("uncompressedSize"),maxLength:17},T={parser:(new P._).uint32("crc32"),maxLength:4},N=(new P._).itf8("size").buffer("ents",{length:"size",formatter:function(e){function t(t,r){for(var n=e.toString("utf8",t,r),a=[],i=0;i<n.length;i+=3)a.push(n.substr(i,3));return a}var r,n=[],a=0;for(r=0;r<e.length;r+=1)e[r]||(n.push(t(a,r)),a=r+1);return r>a&&n.push(t(a,r)),n}}),z=(new P._).uint8(null,{formatter:function(e){return!!e}}),W=(new P._).itf8("mapSize").itf8("mapCount").array("ents",{length:"mapCount",type:(new P._).string("key",{length:2,stripNull:!1}).choice("value",{tag:"key",choices:{MI:z,UI:z,PI:z,RN:z,AP:z,RR:z,SM:(new P._).array(null,{type:"uint8",length:5}),TD:(new P._).nest(null,{type:N,formatter:function(e){return e.ents}})}})});function O(e){for(var t={},r=0;r<e.ents.length;r+=1){var n=e.ents[r],a=n.key,i=n.value;t[a]&&console.warn("duplicate key ".concat(a," in map")),t[a]=i}return t}var H={cramFileDefinition:D,cramBlockHeader:L,cramBlockCrc32:T},j={cramUnmappedSliceHeader:function(e){var t=0,r=(new P._).itf8("numRecords");t+=5,e>=3?(r=r.ltf8("recordCounter"),t+=9):2===e&&(r=r.itf8("recordCounter"),t+=5),r=r.itf8("numBlocks").itf8("numContentIds").array("contentIds",{type:q,length:"numContentIds"}),t+=10,e>=2&&(r=r.array("md5",{type:"uint8",length:16}),t+=16);return{parser:r,maxLength:function(e){return t+5*e}}},cramMappedSliceHeader:function(e){var t=(new P._).itf8("refSeqId").itf8("refSeqStart").itf8("refSeqSpan").itf8("numRecords"),r=20;e>=3?(t=t.ltf8("recordCounter"),r+=9):2===e&&(t=t.itf8("recordCounter"),r+=5),t=t.itf8("numBlocks").itf8("numContentIds").array("contentIds",{type:q,length:"numContentIds"}).itf8("refBaseBlockId"),r+=15,e>=2&&(t=t.array("md5",{type:"uint8",length:16}),r+=16);return{parser:t,maxLength:function(e){return r+5*e}}},cramEncoding:function(e){return{parser:(new P._).namely("cramEncoding").itf8("codecId").itf8("parametersBytes").choice("parameters",{tag:"codecId",choices:{0:new P._,1:(new P._).itf8("blockContentId"),2:(new P._).itf8("offset").itf8("M"),3:P._.start().itf8("numCodes").array("symbols",{length:"numCodes",type:q}).itf8("numLengths").array("bitLengths",{length:"numLengths",type:q}),4:P._.start().nest("lengthsEncoding",{type:"cramEncoding"}).nest("valuesEncoding",{type:"cramEncoding"}),5:(new P._).uint8("stopByte")[e>1?"itf8":"int"]("blockContentId"),6:(new P._).itf8("offset").itf8("length"),7:(new P._).itf8("offset").itf8("K"),8:(new P._).itf8("offset").itf8("log2m"),9:(new P._).itf8("offset")}})}},cramDataSeriesEncodingMap:function(e){return(new P._).itf8("mapSize").itf8("mapCount").array("ents",{length:"mapCount",type:(new P._).string("key",{length:2,stripNull:!1}).nest("value",{type:this.cramEncoding(e).parser})})},cramTagEncodingMap:function(e){return(new P._).itf8("mapSize").itf8("mapCount").array("ents",{length:"mapCount",type:(new P._).itf8("key",{formatter:function(e){return String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)}}).nest("value",{type:this.cramEncoding(e).parser})})},cramCompressionHeader:function(e){var t=new P._;return{parser:t=t.nest("preservation",{type:W,formatter:O}).nest("dataSeriesEncoding",{type:this.cramDataSeriesEncodingMap(e),formatter:O}).nest("tagEncoding",{type:this.cramTagEncodingMap(e),formatter:O})}},cramContainerHeader1:function(e){var t=(new P._).int32("length").itf8("refSeqId").itf8("refSeqStart").itf8("alignmentSpan").itf8("numRecords"),r=24;return e>=3?(t=t.ltf8("recordCounter"),r+=9):2===e&&(t=t.itf8("recordCounter"),r+=5),e>1&&(t=t.ltf8("numBases"),r+=9),{parser:t=t.itf8("numBlocks").itf8("numLandmarks"),maxLength:r+=10}},cramContainerHeader2:function(e){var t=(new P._).itf8("numLandmarks").array("landmarks",{type:(new P._).itf8(),length:"numLandmarks"}),r=0;return e>=3&&(t=t.uint32("crc32"),r=4),{parser:t,maxLength:function(e){return 5+5*e+r}}}};function G(e){var t=Object.assign({},H);return Object.keys(j).forEach((function(r){t[r]=j[r](e)})),t}var V=r(38536),Q=r.n(V),X=r(16318),K=r.n(X);function Y(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=t.parse(e),i=a.offset,o=a.result;return o._endPosition=i+n,o._size=i-r,o}function $(e,t){var r=e.prototype[t],n="_memo_".concat(t);e.prototype[t]=function(){var e=this;if(!(n in this)){var t=r.call(this);this[n]=t,Promise.resolve(t).catch((function(){delete e[n]}))}return this[n]}}function J(e){return K()(e.toUpperCase().replace(/[^\x21-\x7e]/g,""))}var ee=r(68079),te={CRAM_FLAG_PRESERVE_QUAL_SCORES:1,CRAM_FLAG_DETACHED:2,CRAM_FLAG_MATE_DOWNSTREAM:4,CRAM_FLAG_NO_SEQ:8,CRAM_FLAG_MASK:15,CRAM_M_REVERSE:1,CRAM_M_UNMAP:2,BAM_FPAIRED:1,BAM_FPROPER_PAIR:2,BAM_FUNMAP:4,BAM_FMUNMAP:8,BAM_FREVERSE:16,BAM_FMREVERSE:32,BAM_FREAD1:64,BAM_FREAD2:128,BAM_FSECONDARY:256,BAM_FQCFAIL:512,BAM_FDUP:1024,BAM_FSUPPLEMENTARY:2048,BAM_CMATCH:0,BAM_CINS:1,BAM_CDEL:2,BAM_CREF_SKIP:3,BAM_CSOFT_CLIP:4,BAM_CHARD_CLIP:5,BAM_CPAD:6,BAM_CEQUAL:7,BAM_CDIFF:8,BAM_CBACK:9,BAM_CIGAR_STR:"MIDNSHP:XB",BAM_CIGAR_SHIFT:4,BAM_CIGAR_MASK:15,BAM_CIGAR_TYPE:246183},re=r(96234),ne=r(62821),ae=r.n(ne);var ie={a:0,A:0,c:1,C:1,g:2,G:2,t:3,T:3,n:4,N:4};var oe=function(){function e(){(0,i.Z)(this,e),this.tags={}}return(0,o.Z)(e,[{key:"isPaired",value:function(){return!!(this.flags&te.BAM_FPAIRED)}},{key:"isProperlyPaired",value:function(){return!!(this.flags&te.BAM_FPROPER_PAIR)}},{key:"isSegmentUnmapped",value:function(){return!!(this.flags&te.BAM_FUNMAP)}},{key:"isMateUnmapped",value:function(){return!!(this.flags&te.BAM_FMUNMAP)}},{key:"isReverseComplemented",value:function(){return!!(this.flags&te.BAM_FREVERSE)}},{key:"isMateReverseComplemented",value:function(){return!!(this.flags&te.BAM_FMREVERSE)}},{key:"isRead1",value:function(){return!!(this.flags&te.BAM_FREAD1)}},{key:"isRead2",value:function(){return!!(this.flags&te.BAM_FREAD2)}},{key:"isSecondary",value:function(){return!!(this.flags&te.BAM_FSECONDARY)}},{key:"isFailedQc",value:function(){return!!(this.flags&te.BAM_FQCFAIL)}},{key:"isDuplicate",value:function(){return!!(this.flags&te.BAM_FDUP)}},{key:"isSupplementary",value:function(){return!!(this.flags&te.BAM_FSUPPLEMENTARY)}},{key:"isDetached",value:function(){return!!(this.cramFlags&te.CRAM_FLAG_DETACHED)}},{key:"hasMateDownStream",value:function(){return!!(this.cramFlags&te.CRAM_FLAG_MATE_DOWNSTREAM)}},{key:"isPreservingQualityScores",value:function(){return!!(this.cramFlags&te.CRAM_FLAG_PRESERVE_QUAL_SCORES)}},{key:"isUnknownBases",value:function(){return!!(this.cramFlags&te.CRAM_FLAG_NO_SEQ)}},{key:"getReadBases",value:function(){return!this.readBases&&this._refRegion&&(this.readBases=function(e,t){if((e.lengthOnRef||e.readLength)&&!e.isUnknownBases()){var r=e.alignmentStart-t.start;if(!e.readFeatures)return t.seq.substr(r,e.lengthOnRef).toUpperCase();for(var n="",a=r,i=0;n.length<e.readLength;)if(i<e.readFeatures.length){var o=e.readFeatures[i];if("Q"===o.code||"q"===o.code)i+=1;else if(o.pos===n.length+1)if(i+=1,"b"===o.code){var s=o.data.split(","),c=String.fromCharCode.apply(String,(0,ee.Z)(s));n+=c,a+=c.length}else"B"===o.code?(n+=o.data[0],a+=1):"X"===o.code?(n+=o.sub,a+=1):"I"===o.code?n+=o.data:"D"===o.code?a+=o.data:"i"===o.code?n+=o.data:"N"===o.code?a+=o.data:"S"===o.code?n+=o.data:"P"===o.code||o.code;else if(i<e.readFeatures.length){var u=t.seq.substr(a,e.readFeatures[i].pos-n.length-1);n+=u,a+=u.length}}else{var f=t.seq.substr(a,e.readLength-n.length);n+=f,a+=f.length}return n.toUpperCase()}}(this,this._refRegion)),this.readBases}},{key:"getPairOrientation",value:function(){if(!this.isSegmentUnmapped()&&this.isPaired()&&!this.isMateUnmapped()&&this.mate&&this.sequenceId===this.mate.sequenceId){var e=this.isReverseComplemented()?"R":"F",t=this.isMateReverseComplemented()?"R":"F",r=" ",n=" ";this.isRead1()?(r="1",n="2"):this.isRead2()&&(r="2",n="1");var a=[],i=this.templateLength||this.templateSize;return this.alignmentStart>this.mate.alignmentStart&&i>0&&(i=-i),i>0?(a[0]=e,a[1]=r,a[2]=t,a[3]=n):(a[2]=e,a[3]=r,a[0]=t,a[1]=n),a.join("")}return null}},{key:"addReferenceSequence",value:function(e,t){this.readFeatures&&this.readFeatures.forEach((function(r){"X"===r.code&&function(e,t,r,n){if(t){var a=n.refPos-t.start,i=t.seq.charAt(a);i&&(n.ref=i);var o=ie[i];void 0===o&&(o=4);var s=r.substitutionMatrix[o][n.data];s&&(n.sub=s)}}(0,e,t,r)})),!this.readBases&&e.start<=this.alignmentStart&&e.end>=this.alignmentStart+(this.lengthOnRef||this.readLength)-1&&(this._refRegion=e)}},{key:"toJSON",value:function(){var e=this,t={};return Object.keys(this).forEach((function(r){"_"!==r.charAt(0)&&(t[r]=e[r])})),t.readBases=this.getReadBases(),t}}]),e}();function se(e){for(var t="",r=0;r<e.length&&0!==e[r];r++)t+=String.fromCharCode(e[r]);return t}function ce(e,t){if("Z"===e)return se(t);if("A"===e)return String.fromCharCode(t[0]);if("I"===e)return ae().fromBytesLE(t).toNumber();if("i"===e)return new Int32Array(t.buffer)[0];if("s"===e)return new Int16Array(t.buffer)[0];if("S"===e)return new Uint16Array(t.buffer)[0];if("c"===e)return new Int8Array(t.buffer)[0];if("C"===e)return t[0];if("f"===e)return new Float32Array(t.buffer)[0];if("H"===e)return Number.parseInt(se(t).replace(/^0x/,""),16);if("B"===e)return function(e){var t=String.fromCharCode(e[0]),r=Int32Array.from(e.slice(1))[0],n=new Array(r);if(e=e.slice(5),"c"===t)for(var a=new Int8Array(e.buffer),i=0;i<r;i+=1)n[i]=a[i];else if("C"===t)for(var o=new Uint8Array(e.buffer),s=0;s<r;s+=1)n[s]=o[s];else if("s"===t)for(var c=new Int16Array(e.buffer),u=0;u<r;u+=1)n[u]=c[u];else if("S"===t)for(var f=new Uint16Array(e.buffer),h=0;h<r;h+=1)n[h]=f[h];else if("i"===t)for(var l=new Int32Array(e.buffer),d=0;d<r;d+=1)n[d]=l[d];else if("I"===t)for(var p=new Uint32Array(e.buffer),v=0;v<r;v+=1)n[v]=p[v];else{if("f"!==t)throw new Error("unknown type: "+t);for(var y=new Float32Array(e.buffer),g=0;g<r;g+=1)n[g]=y[g]}return n}(t);throw new b("Unrecognized tag type ".concat(e))}function ue(e,t,r,n,a,i,o,s,c){var u=new oe;if(u.flags=t("BF"),u.cramFlags=t("CF"),s>1&&-2===n.content.refSeqId?u.sequenceId=t("RI"):u.sequenceId=n.content.refSeqId,u.readLength=t("RL"),u.alignmentStart=t("AP"),r.APdelta&&(u.alignmentStart+=o.lastAlignmentStart),o.lastAlignmentStart=u.alignmentStart,u.readGroupId=t("RG"),r.readNamesIncluded&&(u.readName=se(t("RN"))),u.isDetached()){var f={};f.flags=t("MF"),r.readNamesIncluded||(f.readName=se(t("RN")),u.readName=f.readName),f.sequenceId=t("NS"),f.alignmentStart=t("NP"),(f.flags||f.sequenceId>-1)&&(u.mate=f),u.templateSize=t("TS"),f.flags&te.CRAM_M_UNMAP&&(u.flags|=te.BAM_FMUNMAP),f.flags&te.CRAM_M_REVERSE&&(u.flags|=te.BAM_FMREVERSE)}else u.hasMateDownStream()&&(u.mateRecordNumber=t("NF")+c+1);var h=t("TL");if(h<0)throw new b("invalid TL index");for(var l=r.getTagNames(h),d=l.length,p=0;p<d;p+=1){var v=l[p],y=v.substr(0,2),g=v.substr(2,1),m=r.getCodecForTag(v);if(!m)throw new b("no codec defined for auxiliary tag ".concat(v));var w=m.decode(e,a,i,o);u.tags[y]=ce(g,w)}if(u.isSegmentUnmapped())if(u.isUnknownBases())u.readBases=null,u.qualityScores=null;else{for(var k=new Array(u.readLength),A=0;A<k.length;A+=1)k[A]=t("BA");if(u.readBases=String.fromCharCode.apply(String,k),u.isPreservingQualityScores()){for(var S=0;S<k.length;S+=1)k[S]=t("QS");u.qualityScores=k}}else{var _=t("FN");_&&(u.readFeatures=function(e,t,r,n,a){var i=0,o=e.alignmentStart-1,s=new Array(t);function c(e){var t=(0,re.Z)(e,2),n=t[0],a=t[1],i=r(a);return"character"===n?String.fromCharCode(i):"string"===n?i.toString("utf8"):"numArray"===n?i.toArray():i}for(var u=0;u<t;u+=1){var f=String.fromCharCode(r("FC")),h=r("FP"),l={code:f},d={B:["character","BA"],S:["string",a>1?"SC":"IN"],X:["number","BS"],D:["number","DL"],I:["string","IN"],i:["character","BA"],b:["string","BB"],q:["numArray","QQ"],Q:["number","QS"],H:["number","HC"],P:["number","PD"],N:["number","RS"]}[f];if(!d)throw new b('invalid read feature code "'.concat(f,'"'));l.data=c(d);var p={B:["number","QS"]}[f];p&&(l.data=[l.data,c(p)]),i+=h,l.pos=i,o+=h,l.refPos=o,"D"===f||"N"===f?o+=l.data:"I"===f||"S"===f?o-=l.data.length:"i"===f&&(o-=1),s[u]=l}return s}(u,_,t,0,s));var x=u.readLength;if(u.readFeatures&&u.readFeatures.forEach((function(e){var t=e.code,r=e.data;"D"===t||"N"===t?x+=r:"I"===t||"S"===t?x-=r.length:"i"===t&&(x-=1)})),Number.isNaN(x)&&(console.warn("".concat(u.readName||"".concat(u.sequenceId,":").concat(u.alignmentStart)," record has invalid read features")),x=u.readLength),u.lengthOnRef=x,u.mappingQuality=t("MQ"),u.isPreservingQualityScores()){for(var B=new Array(u.readLength),R=0;R<B.length;R+=1)B[R]=t("QS");u.qualityScores=B}}return u}function fe(e,t,r,n){if(!n)throw new b("could not resolve intra-slice mate pairs, file seems truncated or malformed");var a=!!(n.mate||void 0!==n.mateRecordNumber&&n.mateRecordNumber!==t);r.readName||(r.readName=String(r.uniqueId),n.readName=r.readName),r.mate={sequenceId:n.sequenceId,alignmentStart:n.alignmentStart,uniqueId:n.uniqueId},n.readName&&(r.mate.readName=n.readName),n.mate||void 0!==n.mateRecordNumber||(n.mate={sequenceId:r.sequenceId,alignmentStart:r.alignmentStart,uniqueId:r.uniqueId},r.readName&&(n.mate.readName=r.readName)),r.flags|=te.BAM_FPAIRED,n.flags&te.BAM_FUNMAP&&(r.flags|=te.BAM_FMUNMAP),r.flags&te.BAM_FUNMAP&&(n.flags|=te.BAM_FMUNMAP),n.flags&te.BAM_FREVERSE&&(r.flags|=te.BAM_FMREVERSE),r.flags&te.BAM_FREVERSE&&(n.flags|=te.BAM_FMREVERSE),void 0===r.templateLength&&(a?function(e,t,r){var n=function t(r){var n=[r];if(r.mateRecordNumber>=0){var a=e[r.mateRecordNumber];if(!a)throw new b("intra-slice mate record not found, this file seems malformed");n.push.apply(n,(0,ee.Z)(t(a)))}return n}(r),a=n.map((function(e){return e.alignmentStart})),i=n.map((function(e){return e.alignmentStart+e.readLength-1})),o=Math.max.apply(Math,(0,ee.Z)(i))-Math.min.apply(Math,(0,ee.Z)(a))+1;o>=0&&n.forEach((function(e){if(void 0!==e.templateLength)throw new b("mate pair group has some members that have template lengths already, this file seems malformed");e.templateLength=o}))}(e,0,r):function(e,t){var r=Math.min(e.alignmentStart,t.alignmentStart),n=Math.max(e.alignmentStart+e.readLength-1,t.alignmentStart+t.readLength-1)-r+1;e.templateLength=n,t.templateLength=n}(r,n)),delete r.mateRecordNumber}var he=function(){function e(t,r){(0,i.Z)(this,e),this.container=t,this.file=t.file,this.containerPosition=r}return(0,o.Z)(e,[{key:"getHeader",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,r,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.file.getSectionParsers();case 2:return t=e.sent,e.next=5,this.container.getHeader();case 5:return r=e.sent,e.next=8,this.file.readBlock(r._endPosition+this.containerPosition);case 8:if("MAPPED_SLICE_HEADER"!==(a=e.sent).contentType){e.next=13;break}a.content=Y(a.content,t.cramMappedSliceHeader.parser,0,r._endPosition),e.next=18;break;case 13:if("UNMAPPED_SLICE_HEADER"!==a.contentType){e.next=17;break}a.content=Y(a.content,t.cramUnmappedSliceHeader.parser,0,r._endPosition),e.next=18;break;case 17:throw new b("error reading slice header block, invalid content type ".concat(a._contentType));case 18:return e.abrupt("return",a);case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getBlocks",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,r,a,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHeader();case 2:t=e.sent,r=t._endPosition,a=new Array(t.content.numBlocks),i=0;case 6:if(!(i<a.length)){e.next=14;break}return e.next=9,this.file.readBlock(r);case 9:a[i]=e.sent,r=a[i]._endPosition;case 11:i+=1,e.next=6;break;case 14:return e.abrupt("return",a);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCoreDataBlock",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getBlocks();case 2:return t=e.sent,e.abrupt("return",t[0]);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getBlocksContentIdIndex",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getBlocks();case 2:return t=e.sent,r={},t.forEach((function(e){"EXTERNAL_DATA"===e.contentType&&(r[e.contentId]=e)})),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getBlockByContentId",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getBlocksContentIdIndex();case 2:return r=e.sent,e.abrupt("return",r[t]);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getReferenceRegion",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,r,a,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHeader();case 2:if(!((t=e.sent.content).refSeqId<0)){e.next=5;break}return e.abrupt("return",void 0);case 5:return e.next=7,this.container.getCompressionScheme();case 7:if(r=e.sent,!(t.refBaseBlockId>=0)){e.next=15;break}if(a=this.getBlockByContentId(t.refBaseBlockId)){e.next=12;break}throw new b("embedded reference specified, but reference block does not exist");case 12:if(!(t.span>a.uncompressedSize)){e.next=14;break}throw new b("Embedded reference is too small");case 14:return e.abrupt("return",{seq:a.data.toString("utf8"),start:t.refSeqStart,end:t.refSeqStart+t.refSeqSpan-1,span:t.refSeqSpan});case 15:if(!r.referenceRequired&&!this.file.fetchReferenceSequenceCallback){e.next=24;break}if(this.file.fetchReferenceSequenceCallback){e.next=18;break}throw new Error("reference sequence not embedded, and seqFetch callback not provided, cannot fetch reference sequence");case 18:return e.next=20,this.file.fetchReferenceSequenceCallback(t.refSeqId,t.refSeqStart,t.refSeqStart+t.refSeqSpan-1);case 20:if((i=e.sent).length===t.refSeqSpan){e.next=23;break}throw new A("seqFetch callback returned a reference sequence of the wrong length");case 23:return e.abrupt("return",{seq:i,start:t.refSeqStart,end:t.refSeqStart+t.refSeqSpan-1,span:t.refSeqSpan});case 24:return e.abrupt("return",void 0);case 25:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAllRecords",value:function(){return this.getRecords((function(){return!0}))}},{key:"_fetchRecords",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,r,a,i,o,s,c,u,f,h,l,d,p,v,y,g,m,k,A=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.file.getDefinition();case 2:return t=e.sent,r=t.majorVersion,e.next=6,this.container.getCompressionScheme();case 6:return a=e.sent,e.next=9,this.getHeader();case 9:return i=e.sent,e.next=12,this._getBlocksContentIdIndex();case 12:if(o=e.sent,!(r>1&&this.file.options.checkSequenceMD5&&i.content.refSeqId>=0&&"0000000000000000"!==i.content.md5.join(""))){e.next=23;break}return e.next=16,this.getReferenceRegion();case 16:if(!(s=e.sent)){e.next=23;break}if(c=s.seq,u=s.start,f=s.end,h=J(c),l=i.content.md5.map((function(e){return(e<16?"0":"")+e.toString(16)})).join(""),h===l){e.next=23;break}throw new b("MD5 checksum reference mismatch for ref ".concat(i.content.refSeqId," pos ").concat(u,"..").concat(f,". recorded MD5: ").concat(l,", calculated MD5: ").concat(h));case 23:return e.next=25,this.getCoreDataBlock();case 25:d=e.sent,p={lastAlignmentStart:i.content.refSeqStart||0,coreBlock:{bitPosition:7,bytePosition:0},externalBlocks:{map:new Map,getCursor:function(e){var t=this.map.get(e);return void 0===t&&(t={bitPosition:7,bytePosition:0},this.map.set(e,t)),t}}},v=function(e){var t=a.getCodecForDataSeries(e);if(!t)throw new b("no codec defined for ".concat(e," data series"));return t.decode(A,d,o,p)},y=new Array(i.content.numRecords),g=0;case 30:if(!(g<y.length)){e.next=48;break}e.prev=31,y[g]=ue(this,v,a,i,d,o,p,r,g),y[g].uniqueId=i.contentPosition+i.content.recordCounter+g+1,e.next=45;break;case 36:if(e.prev=36,e.t0=e.catch(31),!(e.t0 instanceof w)){e.next=44;break}return console.warn("read attempted beyond end of buffer, file seems truncated."),y=y.filter((function(e){return!!e})),e.abrupt("break",48);case 44:throw e.t0;case 45:g+=1,e.next=30;break;case 48:for(m=0;m<y.length;m+=1)(k=y[m].mateRecordNumber)>=0&&fe(y,m,y[m],y[k]);return e.abrupt("return",y);case 50:case"end":return e.stop()}}),e,this,[[31,36]])})));return function(){return e.apply(this,arguments)}}()},{key:"getRecords",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r,i,o,s,c,u,f,h,l,d,p,v,y,g,m=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.container.filePosition+this.containerPosition,(i=this.file.featureCache.get(r))||(i=this._fetchRecords(),this.file.featureCache.set(r,i)),e.next=5,i;case 5:if(!(o=e.sent.filter(t)).length||!this.file.fetchReferenceSequenceCallback){e.next=20;break}return e.next=9,this.getHeader();case 9:if(!((s=e.sent).content.refSeqId>=0||-2===s.content.refSeqId)){e.next=20;break}return c=s.content.refSeqId>=0?s.content.refSeqId:void 0,e.next=14,this.container.getCompressionScheme();case 14:for(u=e.sent,f={},h=0;h<o.length;h+=1)l=void 0!==c?c:o[h].sequenceId,(d=f[l])||(d={id:l,start:o[h].alignmentStart,end:-1/0},f[l]=d),(p=o[h].alignmentStart+(o[h].lengthOnRef||o[h].readLength)-1)>d.end&&(d.end=p),o[h].alignmentStart<d.start&&(d.start=o[h].alignmentStart);return e.next=19,Promise.all(Object.values(f).map(function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(-1!==t.id&&t.start<=t.end)){e.next=4;break}return e.next=3,m.file.fetchReferenceSequenceCallback(t.id,t.start,t.end);case 3:t.seq=e.sent;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 19:for(v=0;v<o.length;v+=1)y=void 0!==c?c:o[v].sequenceId,(g=f[y])&&g.seq&&o[v].addReferenceSequence(g,u);case 20:return e.abrupt("return",o);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();"getHeader getBlocks _getBlocksContentIdIndex".split(" ").forEach((function(e){return $(he,e)}));var le={int:!0,byte:!0,long:!0,byteArray:!0,byteArrayBlock:!0},de=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if((0,i.Z)(this,e),this.parameters=t,this.dataType=r,!r)throw new TypeError("must provide a data type to codec constructor");if(!le[r])throw new TypeError("invalid data type ".concat(r))}return(0,o.Z)(e,[{key:"_getBits",value:function(e,t,r){var n=0;if(t.bytePosition+(7-t.bitPosition+r)/8>e.length)throw new w("read error during decoding. the file seems to be truncated.");for(var a=r;a;a-=1)n<<=1,n|=e[t.bytePosition]>>t.bitPosition&1,t.bitPosition-=1,t.bitPosition<0&&(t.bytePosition+=1),t.bitPosition&=7;return n}}]),e}();var pe=function(e){(0,p.Z)(r,e);var t=(0,v.Z)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;if((0,i.Z)(this,r),e=t.call(this,n,a),!["byte","int"].includes(e.dataType))throw new TypeError("".concat(e.dataType," decoding not yet implemented by HUFFMAN_INT codec"));return e.buildCodeBook(),e.buildCodes(),e.buildCaches(),0===e.sortedCodes[0].bitLength&&(e._decode=e._decodeZeroLengthCode),e}return(0,o.Z)(r,[{key:"buildCodeBook",value:function(){for(var e=this,t=new Array(this.parameters.numCodes),r=0;r<this.parameters.numCodes;r+=1)t[r]={symbol:this.parameters.symbols[r],bitLength:this.parameters.bitLengths[r]};t=t.sort((function(e,t){return e.bitLength-t.bitLength||e.symbol-t.symbol})),this.codeBook={},t.forEach((function(t){e.codeBook[t.bitLength]||(e.codeBook[t.bitLength]=[]),e.codeBook[t.bitLength].push(t.symbol)}))}},{key:"buildCodes",value:function(){var e=this;this.codes={};var t=0,r=-1;Object.entries(this.codeBook).forEach((function(n){var a=(0,re.Z)(n,2),i=a[0],o=a[1];i=parseInt(i,10),o.forEach((function(n){var a={bitLength:i,value:n};r+=1;var o=i-t;if(r<<=o,a.bitCode=r,t+=o,function(e){var t=e-(e>>1)&1431655765;return 16843009*((t=(858993459&t)+(t>>2&858993459))+(t>>4)&252645135)>>24}(r)>i)throw new b("Symbol out of range");e.codes[n]=a}))}))}},{key:"buildCaches",value:function(){this.sortedCodes=Object.values(this.codes).sort((function(e,t){return e.bitLength-t.bitLength||e.bitCode-t.bitCode})),this.sortedByValue=Object.values(this.codes).sort((function(e,t){return e.value-t.value})),this.sortedValuesByBitCode=this.sortedCodes.map((function(e){return e.value})),this.sortedBitCodes=this.sortedCodes.map((function(e){return e.bitCode})),this.sortedBitLengthsByBitCode=this.sortedCodes.map((function(e){return e.bitLength}));var e=Math.max.apply(Math,(0,ee.Z)(this.sortedBitCodes));this.bitCodeToValue=new Array(e+1).fill(-1);for(var t=0;t<this.sortedBitCodes.length;t+=1)this.bitCodeToValue[this.sortedCodes[t].bitCode]=t}},{key:"decode",value:function(e,t,r,n){return this._decode(e,t,n.coreBlock)}},{key:"_decodeZeroLengthCode",value:function(){return this.sortedCodes[0].value}},{key:"_decode",value:function(e,t,r){for(var n=t.content,a=0,i=0,o=0;o<this.sortedCodes.length;o+=1){var s=this.sortedCodes[o].bitLength;i<<=s-a,i|=this._getBits(n,r,s-a),a=s;var c=this.bitCodeToValue[i];if(c>-1&&this.sortedBitLengthsByBitCode[c]===s)return this.sortedValuesByBitCode[c];for(var u=o;this.sortedCodes[u+1].bitLength===s&&u<this.sortedCodes.length;u+=1)o+=1}throw new b("Huffman symbol not found.")}}]),r}(de),ve=function(e){(0,p.Z)(r,e);var t=(0,v.Z)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;if((0,i.Z)(this,r),"int"===(e=t.call(this,n,a)).dataType)e._decodeData=e._decodeInt;else{if("byte"!==e.dataType)throw new m("".concat(e.dataType," decoding not yet implemented by EXTERNAL codec"));e._decodeData=e._decodeByte}return e}return(0,o.Z)(r,[{key:"decode",value:function(e,t,r,n){var a=this.parameters.blockContentId,i=r[a];if(!i)throw new b("no block found with content ID ".concat(a));var o=n.externalBlocks.getCursor(a);return this._decodeData(i,o)}},{key:"_decodeInt",value:function(e,t){var r=function(e,t){var r,n=t,a=e[n];if(a<128?(r=a,n+=1):a<192?(r=16383&(a<<8|e[n+1]),n+=2):a<224?(r=2097151&(a<<16|e[n+1]<<8|e[n+2]),n+=3):a<240?(r=268435455&(a<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]),n+=4):(r=(15&a)<<28|e[n+1]<<20|e[n+2]<<12|e[n+3]<<4|15&e[n+4],n+=5),n>e.length)throw new w("Attempted to read beyond end of buffer; this file seems truncated.");return[r,n-t]}(e.content,t.bytePosition),n=(0,re.Z)(r,2),a=n[0],i=n[1];return t.bytePosition+=i,a}},{key:"_decodeByte",value:function(e,t){if(t.bytePosition>=e.content.length)throw new w("attempted to read beyond end of block. this file seems truncated.");return e.content[t.bytePosition++]}}]),r}(de),ye=function(e){(0,p.Z)(r,e);var t=(0,v.Z)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;if((0,i.Z)(this,r),e=t.call(this,n,a),"byteArray"!==a)throw new TypeError("byteArrayStop codec does not support data type ".concat(a));return e._decode=e._decodeByteArray,e}return(0,o.Z)(r,[{key:"decode",value:function(e,t,r,n){var a=this.parameters.blockContentId,i=r[a];if(!i)throw new b("no block found with content ID ".concat(a));var o=n.externalBlocks.getCursor(a);return this._decode(i,o)}},{key:"_decodeByteArray",value:function(e,t){for(var r=e.content,n=this.parameters.stopByte,a=t.bytePosition,i=t.bytePosition;r[i]!==n&&i<r.length;){if(i===r.length)throw new w("byteArrayStop reading beyond length of data buffer?");i+=1}return t.bytePosition=i+1,r.slice(a,i)}}]),r}(de),ge=function(e){(0,p.Z)(r,e);var t=(0,v.Z)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;if((0,i.Z)(this,r),(e=t.call(this,n,a)).instantiateCodec=o,"byteArray"!==a)throw new TypeError("byteArrayLength does not support data type ".concat(a));return e}return(0,o.Z)(r,[{key:"decode",value:function(e,t,r,n){for(var a=this._getLengthCodec().decode(e,t,r,n),i=this._getDataCodec(),o=new Uint8Array(a),s=0;s<a;s+=1)o[s]=i.decode(e,t,r,n);return o}},{key:"_getLengthCodec",value:function(){var e=this.parameters.lengthsEncoding;return this.instantiateCodec(e,"int")}},{key:"_getDataCodec",value:function(){var e=this.parameters.valuesEncoding;return this.instantiateCodec(e,"byte")}}]),r}(de);"_getLengthCodec _getDataCodec".split(" ").forEach((function(e){return $(ge,e)}));var me=function(e){(0,p.Z)(r,e);var t=(0,v.Z)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;if((0,i.Z)(this,r),"int"!==(e=t.call(this,n,a)).dataType)throw new m("".concat(e.dataType," decoding not yet implemented by BETA codec"));return e}return(0,o.Z)(r,[{key:"decode",value:function(e,t,r,n){return this._getBits(t.content,n.coreBlock,this.parameters.length)-this.parameters.offset}}]),r}(de),be=function(e){(0,p.Z)(r,e);var t=(0,v.Z)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;if((0,i.Z)(this,r),"int"!==(e=t.call(this,n,a)).dataType)throw new m("".concat(e.dataType," decoding not yet implemented by GAMMA codec"));return e}return(0,o.Z)(r,[{key:"decode",value:function(e,t,r,n){for(var a=1;0===this._getBits(t.content,n.coreBlock,1);)a+=1;return(this._getBits(t.content,n.coreBlock,a-1)|1<<a-1)-this.parameters.offset}}]),r}(de),we=function(e){(0,p.Z)(r,e);var t=(0,v.Z)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;if((0,i.Z)(this,r),"int"!==(e=t.call(this,n,a)).dataType)throw new m("".concat(e.dataType," decoding not yet implemented by SUBEXP codec"));return e}return(0,o.Z)(r,[{key:"decode",value:function(e,t,r,n){for(var a,i,o=0;this._getBits(t.content,n.coreBlock,1);)o+=1;return 0===o?(a=this.parameters.K,i=this._getBits(t.content,n.coreBlock,a)):i=1<<(a=o+this.parameters.K-1)|this._getBits(t.content,n.coreBlock,a),i-this.parameters.offset}}]),r}(de),ke={1:ve,3:pe,4:ge,5:ye,6:me,7:we,9:be};function Ae(e,t){var r,n=(r="ignore"===t?0:e.codecId,ke[r]);if(!n)throw new m("no codec implemented for codec ID ".concat(e.codecId));return new n(e.parameters,t,Ae)}var Se={BF:"int",CF:"int",RI:"int",RL:"int",AP:"int",RG:"int",MF:"int",NS:"int",NP:"int",TS:"int",NF:"int",TC:"byte",TN:"int",FN:"int",FC:"byte",FP:"int",BS:"byte",IN:"byteArray",SC:"byteArray",DL:"int",BA:"byte",BB:"byteArray",RS:"int",PD:"int",HC:"int",MQ:"int",RN:"byteArray",QS:"byte",QQ:"byteArray",TL:"int",TM:"ignore",TV:"ignore"};var _e=function(){function e(t){(0,i.Z)(this,e),Object.assign(this,t),this.readNamesIncluded=t.preservation.RN,this.APdelta=t.preservation.AP,this.referenceRequired=!!t.preservation.RR,this.tagIdsDictionary=t.preservation.TD,this.substitutionMatrix=function(e){for(var t=new Array(5),r=0;r<5;r+=1)t[r]=new Array(4);return t[0][e[0]>>6&3]="C",t[0][e[0]>>4&3]="G",t[0][e[0]>>2&3]="T",t[0][e[0]>>0&3]="N",t[1][e[1]>>6&3]="A",t[1][e[1]>>4&3]="G",t[1][e[1]>>2&3]="T",t[1][e[1]>>0&3]="N",t[2][e[2]>>6&3]="A",t[2][e[2]>>4&3]="C",t[2][e[2]>>2&3]="T",t[2][e[2]>>0&3]="N",t[3][e[3]>>6&3]="A",t[3][e[3]>>4&3]="C",t[3][e[3]>>2&3]="G",t[3][e[3]>>0&3]="N",t[4][e[4]>>6&3]="A",t[4][e[4]>>4&3]="C",t[4][e[4]>>2&3]="G",t[4][e[4]>>0&3]="T",t}(t.preservation.SM),this.dataSeriesCodecCache=new Map,this.tagCodecCache={}}return(0,o.Z)(e,[{key:"getCodecForTag",value:function(e){if(!this.tagCodecCache[e]){var t=this.tagEncoding[e];t&&(this.tagCodecCache[e]=Ae(t,"byteArray"))}return this.tagCodecCache[e]}},{key:"getTagNames",value:function(e){return this.tagIdsDictionary[e]}},{key:"getCodecForDataSeries",value:function(e){var t=this.dataSeriesCodecCache.get(e);if(void 0===t){var r=this.dataSeriesEncoding[e];if(r){var n=Se[e];if(!n)throw new b("data series name ".concat(e," not defined in file compression header"));t=Ae(r,n),this.dataSeriesCodecCache.set(e,t)}}return t}},{key:"toJSON",value:function(){var e=this,t={};return Object.keys(this).forEach((function(r){/Cache$/.test(r)||(t[r]=e[r])})),t}}]),e}(),xe=r(49882).Buffer,Be=function(){function e(t,r){(0,i.Z)(this,e),this.file=t,this.filePosition=r}return(0,o.Z)(e,[{key:"getHeader",value:function(){return this._readContainerHeader(this.filePosition)}},{key:"getCompressionHeaderBlock",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,r,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHeader();case 2:if(e.sent.numRecords){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,this.file.getSectionParsers();case 7:return t=e.sent,e.next=10,this.getFirstBlock();case 10:if("COMPRESSION_HEADER"===(r=e.sent).contentType){e.next=13;break}throw new b("invalid content type ".concat(r.contentType," in what is supposed to be the compression header block"));case 13:return a=Y(r.content,t.cramCompressionHeader.parser,0,r.contentPosition),r.content=a,e.abrupt("return",r);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getFirstBlock",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHeader();case 2:return t=e.sent,e.abrupt("return",this.file.readBlock(t._endPosition));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCompressionScheme",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCompressionHeaderBlock();case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",void 0);case 5:return e.abrupt("return",new _e(t.content));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSlice",value:function(e,t){return new he(this,e,t)}},{key:"_readContainerHeader",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a,i,o,s,c,u,f,h,l,d;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.file.getSectionParsers();case 2:return r=e.sent,a=r.cramContainerHeader1,i=r.cramContainerHeader2,e.next=6,this.file.stat();case 6:if(o=e.sent,s=o.size,!(t>=s)){e.next=10;break}return e.abrupt("return",void 0);case 10:return c=xe.allocUnsafe(a.maxLength),e.next=13,this.file.read(c,0,a.maxLength,t);case 13:if(u=Y(c,a.parser),n=u.numLandmarks,f=-128&n?-16384&n?-2097152&n?-268435456&n?5:4:3:2:1,!(t+u.length>=s)){e.next=18;break}return console.warn("".concat(this.file,": container header at ").concat(t," indicates that the container has length ").concat(u.length,", which extends beyond the length of the file. Skipping this container.")),e.abrupt("return",void 0);case 18:return h=xe.allocUnsafe(i.maxLength(u.numLandmarks)),e.next=21,this.file.read(h,0,i.maxLength(u.numLandmarks),t+u._size-f);case 21:if(l=Y(h,i.parser),!this.file.validateChecksums||void 0===l.crc32){e.next=25;break}return e.next=25,this.file.checkCrc32(t,u._size+l._size-f-4,l.crc32,"container header beginning at position ".concat(t));case 25:return d=Object.assign(u,l,{_size:u._size+l._size-f,_endPosition:u._size+l._size-f+t}),e.abrupt("return",d);case 27:case"end":return e.stop()}var n}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();"getHeader getCompressionHeaderBlock getCompressionScheme".split(" ").forEach((function(e){return $(Be,e)}));var Re=r(52809),Ce=r(66344),Ee=r.n(Ce),Me=function(){function e(t){var r=t.fetch,n=t.size,a=void 0===n?1e7:n,o=t.chunkSize,s=void 0===o?32768:o;if((0,i.Z)(this,e),!r)throw new Error("fetch function required");this.fetch=r,this.chunkSize=s,this.lruCache=new(d())({maxSize:Math.floor(a/s)})}return(0,o.Z)(e,[{key:"get",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,i){var o,s,c,u,f,h,l,d=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length<r+a)){e.next=2;break}throw new Error("output buffer not big enough for request");case 2:for(o=Math.floor(i/this.chunkSize),s=Math.floor((i+a)/this.chunkSize),c=new Array(s-o+1),u=function(e){c[e-o]=d._getChunk(e).then((function(t){return{data:t,chunkNumber:e}}))},f=o;f<=s;f+=1)u(f);return e.next=9,Promise.all(c);case 9:h=e.sent,l=i-h[0].chunkNumber*this.chunkSize,h.forEach((function(e){var n=e.data,c=e.chunkNumber,u=c*d.chunkSize,f=0,h=d.chunkSize,p=r+(c-o)*d.chunkSize-l;c===o&&(p=r,f=l),c===s&&(h=i+a-u),n.copy(t,p,f,h)}));case 12:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"_getChunk",value:function(e){var t=this.lruCache.get(e);if(t)return t;var r=this.fetch(e*this.chunkSize,this.chunkSize);return this.lruCache.set(e,r),r}}]),e}(),Fe=r(49882).Buffer,Ie=function(){function e(t){var r=this;(0,i.Z)(this,e),this.position=0,this.url=t,this.cache=new Me({fetch:function(e,t){return r._fetch(e,t)}})}return(0,o.Z)(e,[{key:"_fetch",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r){var a,i,o,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={},r<1/0?a.range="bytes=".concat(t,"-").concat(t+r):r===1/0&&0!==t&&(a.range="bytes=".concat(t,"-")),e.next=4,Ee()(this.url,{method:"GET",headers:a,redirect:"follow",mode:"cors"});case 4:if((200!==(i=e.sent).status||0!==t)&&206!==i.status){e.next=14;break}return e.t0=Fe,e.next=9,i.arrayBuffer();case 9:return e.t1=e.sent,o=e.t0.from.call(e.t0,e.t1),(s=/\/(\d+)$/.exec(i.headers.get("content-range")))[1]&&(this._stat={size:parseInt(s[1],10)}),e.abrupt("return",o);case 14:throw new Error("HTTP ".concat(i.status," fetching ").concat(this.url));case 15:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"read",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=n;return null===a&&(a=this.position,this.position+=r),this.cache.get(e,t,r,n)}},{key:"readFile",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee()(this.url,{method:"GET",redirect:"follow",mode:"cors"});case 2:return t=e.sent,e.t0=Fe,e.next=6,t.arrayBuffer();case 6:return e.t1=e.sent,e.abrupt("return",e.t0.from.call(e.t0,e.t1));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stat",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._stat){e.next=6;break}return t=Fe.allocUnsafe(10),e.next=4,this.read(t,0,10,0);case 4:if(this._stat){e.next=6;break}throw new Error("unable to determine size of file at ".concat(this.url));case 6:return e.abrupt("return",this._stat);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Ze=r(4978),Ue=r.n(Ze);function Pe(e,t,r){if(r)return r;if(e)return function(e){var t=Re.parse(e),r=t.protocol,n=t.pathname;return"file:"===r?new(Ue())(unescape(n)):new Ie(e)}(e);if(t)return new(Ue())(t);throw new Error("no url, path, or filehandle provided, cannot open")}var qe=r(46840);function De(e){var t=e.split(/\r?\n/),r=[];return t.forEach((function(e){var t=e.split(/\t/),n=(0,qe.Z)(t),a=n[0],i=n.slice(1).map((function(e){var t=e.split(":",2),r=(0,re.Z)(t,2);return{tag:r[0],value:r[1]}}));a&&r.push({tag:a.substr(1),data:i})})),r}var Le=r(49882).Buffer;var Te=function(){function e(t){if((0,i.Z)(this,e),this.file=Pe(t.url,t.path,t.filehandle),this.validateChecksums=!0,this.fetchReferenceSequenceCallback=t.seqFetch,this.options={checkSequenceMD5:!1!==t.checkSequenceMD5,cacheSize:void 0!==t.cacheSize?t.cacheSize:2e4},this.featureCache=new(d())({maxSize:this.options.cacheSize}),function(){var e=new Uint32Array([287454020]),t=new Uint8Array(e.buffer);return 68===t[0]?0:17===t[0]?1:2}()>0)throw new Error("Detected big-endian machine, may be unable to run")}return(0,o.Z)(e,[{key:"toString",value:function(){return this.file.filename?this.file.filename:this.file.url?this.file.url:"(cram file)"}},{key:"read",value:function(e,t,r,n){return this.file.read(e,t,r,n)}},{key:"stat",value:function(){return this.file.stat()}},{key:"getDefinition",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Le.allocUnsafe(D.maxLength),e.next=3,this.file.read(t,0,D.maxLength,0);case 3:if(2===(r=D.parser.parse(t).result).majorVersion||3===r.majorVersion){e.next=6;break}throw new m("CRAM version ".concat(r.majorVersion," not supported"));case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSamHeader",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,r,a,i,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getContainerById(0);case 2:if(t=e.sent){e.next=5;break}throw new b("file contains no containers");case 5:return e.next=7,t.getFirstBlock();case 7:return r=e.sent,a=r.content,i=a.readInt32LE(0),4,o=a.toString("utf8",4,4+i),this.header=o,e.abrupt("return",De(o));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeaderText",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSamHeader();case 2:return e.abrupt("return",this.header);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSectionParsers",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDefinition();case 2:return t=e.sent,r=t.majorVersion,e.abrupt("return",G(r));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getContainerById",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a,i,o,s,c,u,f,h,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSectionParsers();case 2:return r=e.sent,a=r.cramFileDefinition.maxLength,e.next=6,this.file.stat();case 6:i=e.sent,o=i.size,s=r.cramContainerHeader1,u=0;case 10:if(!(u<=t)){e.next=36;break}if(!(a+s.maxLength+8>=o)){e.next=13;break}return e.abrupt("return",void 0);case 13:return c=this.getContainerAtPosition(a),e.next=16,c.getHeader();case 16:if(f=e.sent){e.next=19;break}throw new b("container ".concat(t," not found in file"));case 19:if(0!==u){e.next=32;break}a=f._endPosition,h=0;case 22:if(!(h<f.numBlocks)){e.next=30;break}return e.next=25,this.readBlock(a);case 25:l=e.sent,a=l._endPosition;case 27:h+=1,e.next=22;break;case 30:e.next=33;break;case 32:a+=f._size+f.length;case 33:u+=1,e.next=10;break;case 36:return e.abrupt("return",c);case 37:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkCrc32",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,i){var o,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=Le.allocUnsafe(r),e.next=3,this.file.read(o,0,r,t);case 3:if((s=h().unsigned(o))===a){e.next=6;break}throw new b("crc mismatch in ".concat(i,": recorded CRC32 = ").concat(a,", but calculated CRC32 = ").concat(s));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"containerCount",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,r,a,i,o,s,c,u,f;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSectionParsers();case 2:return t=e.sent,e.next=5,this.file.stat();case 5:r=e.sent,a=r.size,i=t.cramContainerHeader1,o=0,s=t.cramFileDefinition.maxLength;case 10:if(!(s+i.maxLength+8<a)){e.next=33;break}return e.next=13,this.getContainerAtPosition(s).getHeader();case 13:if(c=e.sent){e.next=16;break}return e.abrupt("break",33);case 16:if(0!==o){e.next=29;break}s=c._endPosition,u=0;case 19:if(!(u<c.numBlocks)){e.next=27;break}return e.next=22,this.readBlock(s);case 22:f=e.sent,s=f._endPosition;case 24:u+=1,e.next=19;break;case 27:e.next=30;break;case 29:s+=c._size+c.length;case 30:o+=1,e.next=10;break;case 33:return e.abrupt("return",o);case 34:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getContainerAtPosition",value:function(e){return new Be(this,e)}},{key:"readBlockHeader",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a,i,o,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSectionParsers();case 2:return r=e.sent,a=r.cramBlockHeader,e.next=6,this.file.stat();case 6:if(i=e.sent,o=i.size,!(t+a.maxLength>=o)){e.next=10;break}return e.abrupt("return",void 0);case 10:return s=Le.allocUnsafe(a.maxLength),e.next=13,this.file.read(s,0,a.maxLength,t);case 13:return e.abrupt("return",Y(s,a.parser,0,t));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_parseSection",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r){var a,i,o,s,c,u,f=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=f.length>2&&void 0!==f[2]?f[2]:t.maxLength,!(i=f.length>3?f[3]:void 0)){e.next=6;break}o=i,e.next=15;break;case 6:return e.next=8,this.file.stat();case 8:if(s=e.sent,c=s.size,!(r+a>=c)){e.next=12;break}return e.abrupt("return",void 0);case 12:return o=Le.allocUnsafe(a),e.next=15,this.file.read(o,0,a,r);case 15:if((u=Y(o,t.parser,0,r))._size===a){e.next=18;break}throw new b("section read error: requested size ".concat(a," does not equal parsed size ").concat(u._size));case 18:return e.abrupt("return",u);case 19:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_uncompress",value:function(e,t,r){if("gzip"===e)u(t).copy(r);else if("bzip2"===e){var n=bzip2.array(t),a=bzip2.header(n),i=0;do{var o=bzip2.decompress(n,a);-1!=o&&(Le.from(o).copy(r,i),i+=o.length,a-=o.length)}while(-1!=o)}else if("rans"===e)!function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===e.length)return t.fill(0),t;var n=new U(e,r),a=n.get();if(0!==a&&1!==a)throw new b("Invalid rANS order ".concat(a));if(n.getInt()!==n.remaining()-4)throw new b("Incorrect input length.");var i=n.getInt(),o=new U(t||F.allocUnsafe(i));if(o.length<i)throw new b("Output buffer too small to fit ".concat(i," bytes."));switch(a){case 0:return I(n,o);case 1:return Z(n,o);default:throw new b("Invalid rANS order: ".concat(a))}}(t,r);else if("rans4x16"===e)Q().r4x16_uncompress(t,r);else if("arith"===e)Q().arith_uncompress(t,r);else if("fqzcomp"===e)Q().fqzcomp_uncompress(t,r);else{if("tok3"!==e)throw new m("".concat(e," decompression not yet implemented"));Q().tok3_uncompress(t,r)}}},{key:"readBlock",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a,i,o,s,c,u,f;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDefinition();case 2:return r=e.sent,a=r.majorVersion,e.next=6,this.getSectionParsers();case 6:return i=e.sent,e.next=9,this.readBlockHeader(t);case 9:if(o=e.sent,s=o._endPosition,o.contentPosition=o._endPosition,c=Le.allocUnsafe(o.uncompressedSize),"raw"===o.compressionMethod){e.next=20;break}return u=Le.allocUnsafe(o.compressedSize),e.next=17,this.read(u,0,o.compressedSize,s);case 17:this._uncompress(o.compressionMethod,u,c),e.next=22;break;case 20:return e.next=22,this.read(c,0,o.uncompressedSize,s);case 22:if(o.content=c,!(a>=3)){e.next=35;break}return e.next=26,this._parseSection(i.cramBlockCrc32,s+o.compressedSize);case 26:if(f=e.sent,o.crc32=f.crc32,!this.validateChecksums){e.next=31;break}return e.next=31,this.checkCrc32(t,o._size+o.compressedSize,o.crc32,"block data");case 31:o._endPosition=f._endPosition,o._size=o.compressedSize+i.cramBlockCrc32.maxLength,e.next=37;break;case 35:o._endPosition=s+o.compressedSize,o._size=o.compressedSize;case 37:return e.abrupt("return",o);case 38:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();"getDefinition getSectionParsers getSamHeader".split(" ").forEach((function(e){return $(Te,e)}));var Ne=Te,ze=function(){function e(t){if((0,i.Z)(this,e),t.cram?this.cram=t.cram:this.cram=new Ne({url:t.cramUrl,path:t.cramPath,filehandle:t.cramFilehandle,seqFetch:t.seqFetch,checkSequenceMD5:t.checkSequenceMD5,cacheSize:t.cacheSize}),!(this.cram instanceof Ne))throw new Error("invalid arguments: no cramfile");if(this.index=t.index,!this.index.getEntriesForRange)throw new Error("invalid arguments: not an index");this.fetchSizeLimit=t.fetchSizeLimit||3e6}return(0,o.Z)(e,[{key:"getRecordsForRange",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r,a){var i,o,s,c,u,f,h,l,d,p,v,y,g,b,w,A,S,_,x,B,R,C,E,M,F,I,Z,U=this,P=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=P.length>3&&void 0!==P[3]?P[3]:{}).viewAsPairs=o.viewAsPairs||!1,o.pairAcrossChr=o.pairAcrossChr||!1,o.maxInsertSize=o.maxInsertSize||2e5,"string"!==typeof t){e.next=6;break}throw new m("string sequence names not yet supported");case 6:return s=t,e.next=9,this.index.getEntriesForRange(s,r,a);case 9:if(c=e.sent,!((u=c.map((function(e){return e.sliceBytes})).reduce((function(e,t){return e+t}),0))>this.fetchSizeLimit)){e.next=13;break}throw new k("data size of ".concat(u.toLocaleString()," bytes exceeded fetch size limit of ").concat(this.fetchSizeLimit.toLocaleString()," bytes"));case 13:return f=function(e){return e.sequenceId===t&&e.alignmentStart<=a&&e.alignmentStart+e.lengthOnRef-1>=r},e.next=16,Promise.all(c.map((function(e){return U.getRecordsInSlice(e,f)})));case 16:if(h=e.sent,l=(i=Array.prototype).concat.apply(i,(0,ee.Z)(h)),!o.viewAsPairs){e.next=42;break}for(d={},p={},v=0;v<l.length;v+=1)y=l[v].readName,g=l[v].uniqueId,d[y]||(d[y]=0),d[y]+=1,p[g]=1;for(b={},Object.entries(d).forEach((function(e){var t=(0,re.Z)(e,2),r=t[0];1===t[1]&&(b[r]=!0)})),w=[],A=0;A<l.length;A+=1)S=l[A].readName,b[S]&&l[A].mate&&(l[A].mate.sequenceId===s||o.pairAcrossChr)&&Math.abs(l[A].alignmentStart-l[A].mate.alignmentStart)<o.maxInsertSize&&(_=this.index.getEntriesForRange(l[A].mate.sequenceId,l[A].mate.alignmentStart,l[A].mate.alignmentStart+1),w.push(_));return e.next=28,Promise.all(w);case 28:for(x=e.sent,B=[],R=0;R<x.length;R+=1)(C=B).push.apply(C,(0,ee.Z)(x[R]));if(B=B.sort((function(e,t){return e.toString().localeCompare(t.toString())})).filter((function(e,t,r){return!t||e.toString()!==r[t-1].toString()})),E=[],M=[],!((F=B.map((function(e){return e.sliceBytes})).reduce((function(e,t){return e+t}),0))>this.fetchSizeLimit)){e.next=37;break}throw new Error("mate data size of ".concat(F.toLocaleString()," bytes exceeded fetch size limit of ").concat(this.fetchSizeLimit.toLocaleString()," bytes"));case 37:return B.forEach((function(e){var t=U.cram.featureCache.get(e.toString());t||(t=U.getRecordsInSlice(e,(function(){return!0})),U.cram.featureCache.set(e.toString(),t)),E.push(t);var r=t.then((function(e){for(var t=[],r=0;r<e.length;r+=1){var n=e[r];b[n.readName]&&!p[n.uniqueId]&&t.push(n)}return t}));M.push(r)})),e.next=40,Promise.all(M);case 40:(I=e.sent).length&&(Z=I.reduce((function(e,t){return e.concat(t)})),l=l.concat(Z));case 42:return e.abrupt("return",l);case 43:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getRecordsInSlice",value:function(e,t){var r=e.containerStart,n=e.sliceStart,a=e.sliceBytes;return this.cram.getContainerAtPosition(r).getSlice(n,a).getRecords(t)}},{key:"hasDataForReferenceSequence",value:function(e){return this.index.hasDataForReferenceSequence(e)}}]),e}(),We=r(89410),Oe=r.n(We),He=function(){function e(t){(0,i.Z)(this,e),Object.assign(this,t)}return(0,o.Z)(e,[{key:"toString",value:function(){return"".concat(this.start,":").concat(this.span,":").concat(this.containerStart,":").concat(this.sliceStart,":").concat(this.sliceBytes)}}]),e}();function je(e,t){if(t.some((function(e){return void 0===e})))throw new b("invalid .crai index file");var r=(0,re.Z)(t,6),n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],c=r[5];e[n]||(e[n]=[]),e[n].push(new He({start:a,span:i,containerStart:o,sliceStart:s,sliceBytes:c}))}var Ge=function(){function e(t){var r=this;(0,i.Z)(this,e);var n=Pe(t.url,t.path,t.filehandle);this._parseCache=new(Oe())({cache:new(d())({maxSize:1}),fill:function(e,t){return r.parseIndex({signal:t})}}),this.readFile=n.readFile.bind(n)}return(0,o.Z)(e,[{key:"parseIndex",value:function(){var e={};return this.readFile().then((function(e){return 31===e[0]&&139===e[1]?u(e):e})).then((function(t){if(t.length>4&&21578050===t.readUInt32LE(0))throw new b("invalid .crai index file. note: file appears to be a .bai index. this is technically legal but please open a github issue if you need support");for(var r=[],n="",a=0;a<t.length;a+=1){var i=t[a];if(i>=48&&i<=57||!n&&45===i)n+=String.fromCharCode(i);else if(9===i)r.push(Number.parseInt(n,10)),n="";else if(10===i)r.push(Number.parseInt(n,10)),n="",je(e,r),r=[];else if(13!==i&&32!==i)throw new b("invalid .crai index file")}return n&&r.push(Number.parseInt(n,10)),6===r.length&&je(e,r),Object.entries(e).forEach((function(t){var r=(0,re.Z)(t,2),n=r[0],a=r[1];e[n]=a.sort((function(e,t){return e.start-t.start||e.span-t.span}))})),e}))}},{key:"getIndex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._parseCache.get("index",null,e.signal)}},{key:"hasDataForReferenceSequence",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIndex();case 2:return e.t0=t,e.abrupt("return",!!e.sent[e.t0]);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getEntriesForRange",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r,a){var i,o,s,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIndex();case 2:if(e.t0=t,i=e.sent[e.t0]){e.next=6;break}return e.abrupt("return",[]);case 6:for(o=function(e){var t=e.start,n=e.start+e.span;return t>a?-1:n<=r?1:0},s=[],c=0;c<i.length;c+=1)0===o(i[c])&&s.push(i[c]);return e.abrupt("return",s);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),e}()},91371:function(e,t,r){"use strict";var n=r(66132).default,a=r(51068).default,i=r(93041).default,o=r(50085).default,s=r(15198).default,c=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(o(this,t),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}return s(t,[{key:"_set",value:function(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}},{key:"get",value:function(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){var t=this.oldCache.get(e);return this._set(e,t),t}}},{key:"set",value:function(e,t){return this.cache.has(e)?this.cache.set(e,t):this._set(e,t),this}},{key:"has",value:function(e){return this.cache.has(e)||this.oldCache.has(e)}},{key:"peek",value:function(e){return this.cache.has(e)?this.cache.get(e):this.oldCache.has(e)?this.oldCache.get(e):void 0}},{key:"delete",value:function(e){var t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}},{key:"clear",value:function(){this.cache.clear(),this.oldCache.clear(),this._size=0}},{key:"keys",value:n().mark((function e(){var t,r,o,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i(this),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return o=a(r.value,1),s=o[0],e.next=7,s;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"values",value:n().mark((function e(){var t,r,o,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i(this),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return o=a(r.value,2),s=o[1],e.next=7,s;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:e,value:n().mark((function e(){var t,r,o,s,c,u,f,h;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i(this.cache),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return o=r.value,e.next=7,o;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:s=i(this.oldCache),e.prev=18,s.s();case 20:if((c=s.n()).done){e.next=28;break}if(u=c.value,f=a(u,1),h=f[0],this.cache.has(h)){e.next=26;break}return e.next=26,u;case 26:e.next=20;break;case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(18),s.e(e.t1);case 33:return e.prev=33,s.f(),e.finish(33);case 36:case"end":return e.stop()}}),e,this,[[1,11,14,17],[18,30,33,36]])}))},{key:"size",get:function(){var e,t=0,r=i(this.oldCache.keys());try{for(r.s();!(e=r.n()).done;){var n=e.value;this.cache.has(n)||t++}}catch(a){r.e(a)}finally{r.f()}return this._size+t}}]),t}(Symbol.iterator);e.exports=c},15870:function(e,t,r){var n=r(49882).Buffer,a=r(51068).default,i=r(50085).default,o=r(15198).default,s=r(12712),c=r(64548),u=r(37539),f=r(46883),h=128;e.exports=function(){"use strict";function e(){i(this,e)}return o(e,[{key:"decode",value:function(e){return this.stream=new c(e),this.decodeStream(this.stream)}},{key:"decodeStream",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.stream.ReadByte();16&r||(t=this.stream.ReadUint7());var n=t,i=1&r;if(8&r)return this.decodeStripe(this.stream,t);if(r&h){var o,s=this.decodePackMeta(this.stream),c=a(s,2);o=c[0],n=c[1]}if(32&r)var u=this.decodeCat(this.stream,n);else if(4&r)u=this.decodeExt(this.stream,n);else if(64&r)u=i?this.decodeRLE1(this.stream,n):this.decodeRLE0(this.stream,n);else u=i?this.decode1(this.stream,n):this.decode0(this.stream,n);return r&h&&(u=this.decodePack(u,o,t)),u}},{key:"encode",value:function(e,t){if(this.stream=new c("",0,1.1*e.length+100),this.stream.WriteByte(t),16&t||this.stream.WriteUint7(e.length),8&t)return n.concat([this.stream.buf.slice(0,this.stream.pos),this.encodeStripe(this.stream,e,t>>8)]);var r,i=1&t,o=e.length;if(t&h){var s=this.encodePack(e),u=a(s,3);r=u[0],e=u[1],o=u[2]}return t&h&&this.stream.WriteStream(r),64&t?i?this.encodeRLE1(e,o,this.stream):this.encodeRLE0(e,o,this.stream):i?this.encode1(e,o,this.stream):this.encode0(e,o,this.stream)}},{key:"decode0",value:function(e,t){var r=new n.allocUnsafe(t),a=e.ReadByte();0==a&&(a=256);var i=new u(a),o=new s(e);o.RangeStartDecode(e);for(var c=0;c<t;c++)r[c]=i.ModelDecode(e,o);return r}},{key:"encode0",value:function(e,t,r){for(var n=0,a=0;a<t;a++)n<e[a]&&(n=e[a]);n++;var i=new u(n);r.WriteByte(n);var o=new s(r);for(a=0;a<t;a++)i.ModelEncode(r,o,e[a]);return o.RangeFinishEncode(r),r.buf.slice(0,r.pos)}},{key:"decode1",value:function(e,t){var r=new n.allocUnsafe(t),a=e.ReadByte();0==a&&(a=256);for(var i=new Array(a),o=0;o<a;o++)i[o]=new u(a);var c=new s(e);c.RangeStartDecode(e);var f=0;for(o=0;o<t;o++)r[o]=i[f].ModelDecode(e,c),f=r[o];return r}},{key:"encode1",value:function(e,t,r){for(var n=0,a=0;a<t;a++)n<e[a]&&(n=e[a]);n++;var i=new Array(n);for(a=0;a<n;a++)i[a]=new u(n);r.WriteByte(n);var o=new s(r),c=0;for(a=0;a<t;a++)i[c].ModelEncode(r,o,e[a]),c=e[a];return o.RangeFinishEncode(r),r.buf.slice(0,r.pos)}},{key:"decodeExt",value:function(e,t){var r=new n.allocUnsafe(t),a=f.array(e.buf.slice(e.pos)),i=f.header(a),o=0;do{var s=f.decompress(a,i);-1!=s&&(n.from(s).copy(r,o),o+=s.length,i-=s.length)}while(-1!=s);return r}},{key:"encodeExt",value:function(e,t){}},{key:"decodeRLE0",value:function(e,t){var r=new n.allocUnsafe(t),a=e.ReadByte();0==a&&(a=256);for(var i=new u(a),o=new Array(258),c=0;c<=257;c++)o[c]=new u(4);var f=new s(e);f.RangeStartDecode(e);for(c=0;c<t;){r[c]=i.ModelDecode(e,f);for(var h=o[r[c]].ModelDecode(e,f),l=h,d=256;3==h;)h=o[d].ModelDecode(e,f),d=257,l+=h;for(var p=1;p<=l;p++)r[c+p]=r[c];c+=l+1}return r}},{key:"encodeRLE0",value:function(e,t,r){for(var n=0,a=0;a<t;a++)n<e[a]&&(n=e[a]);n++;var i=new u(n),o=new Array(258);for(a=0;a<=257;a++)o[a]=new u(4);r.WriteByte(n);var c=new s(r);for(a=0;a<t;){i.ModelEncode(r,c,e[a]);for(var f=1;a+f<t&&e[a+f]==e[a];)f++;f--;var h=e[a];e[a];a+=f+1;var l=f>=3?3:f;for(o[h].ModelEncode(r,c,l),f-=l,h=256;3==l;)l=f>=3?3:f,o[h].ModelEncode(r,c,l),h=257,f-=l}return c.RangeFinishEncode(r),r.buf.slice(0,r.pos)}},{key:"decodeRLE1",value:function(e,t){var r=new n.allocUnsafe(t),a=e.ReadByte();0==a&&(a=256);for(var i=new Array(a),o=0;o<a;o++)i[o]=new u(a);var c=new Array(258);for(o=0;o<=257;o++)c[o]=new u(4);var f=new s(e);f.RangeStartDecode(e);var h=0;for(o=0;o<t;){r[o]=i[h].ModelDecode(e,f),h=r[o];for(var l=c[r[o]].ModelDecode(e,f),d=l,p=256;3==l;)l=c[p].ModelDecode(e,f),p=257,d+=l;for(var v=1;v<=d;v++)r[o+v]=r[o];o+=d+1}return r}},{key:"encodeRLE1",value:function(e,t,r){for(var n=0,a=0;a<t;a++)n<e[a]&&(n=e[a]);n++;var i=new Array(n);for(a=0;a<n;a++)i[a]=new u(n);var o=new Array(258);for(a=0;a<=257;a++)o[a]=new u(4);r.WriteByte(n);for(var c=new s(r),f=(a=0,0);a<t;){i[f].ModelEncode(r,c,e[a]);for(var h=1;a+h<t&&e[a+h]==e[a];)h++;h--;var l=e[a];f=e[a],a+=h+1;var d=h>=3?3:h;for(o[l].ModelEncode(r,c,d),h-=d,l=256;3==d;)d=h>=3?3:h,o[l].ModelEncode(r,c,d),l=257,h-=d}return c.RangeFinishEncode(r),r.buf.slice(0,r.pos)}},{key:"decodePackMeta",value:function(e){this.nsym=e.ReadByte();for(var t=new Array(this.nsym),r=0;r<this.nsym;r++)t[r]=e.ReadByte();return[t,e.ReadUint7()]}},{key:"decodePack",value:function(e,t,r){var a=new n.allocUnsafe(r);if(this.nsym<=1)for(var i=0;i<r;i++)a[i]=t[0];else if(this.nsym<=2){i=0;for(var o=0;i<r;i++){if(i%8==0)var s=e[o++];a[i]=t[1&s],s>>=1}}else if(this.nsym<=4)for(i=0,o=0;i<r;i++){if(i%4==0)s=e[o++];a[i]=t[3&s],s>>=2}else{if(!(this.nsym<=16))return e;for(i=0,o=0;i<r;i++){if(i%2==0)s=e[o++];a[i]=t[15&s],s>>=4}}return a}},{key:"packMeta",value:function(e){for(var t=new c("",0,1024),r=new Array(256),n=0;n<e.length;n++)r[e[n]]=1;var a=0;for(n=0;n<256;n++)r[n]&&(r[n]=++a);t.WriteByte(a);for(n=0;n<256;n++)r[n]&&(t.WriteByte(n),r[n]--);return[t,r,a]}},{key:"encodePack",value:function(e){var t,r,i,o=this.packMeta(e),s=a(o,3);t=s[0],r=s[1],i=s[2];var c=e.length,u=0;if(i<=1)return t.WriteUint7(0),[t,new n.allocUnsafe(0),0];if(i<=2){for(var f=new n.allocUnsafe(Math.floor((c+7)/8)),h=(u=0,0);u<(-8&c);u+=8,h++)f[h]=(r[e[u+0]]<<0)+(r[e[u+1]]<<1)+(r[e[u+2]]<<2)+(r[e[u+3]]<<3)+(r[e[u+4]]<<4)+(r[e[u+5]]<<5)+(r[e[u+6]]<<6)+(r[e[u+7]]<<7);if(u<c){f[h]=0;for(var l=0;u<c;)f[h]|=r[e[u++]]<<l,l++;h++}return t.WriteUint7(h),[t,f,f.length]}if(i<=4){for(f=new n.allocUnsafe(Math.floor((c+3)/4)),u=0,h=0;u<(-4&c);u+=4,h++)f[h]=(r[e[u+0]]<<0)+(r[e[u+1]]<<2)+(r[e[u+2]]<<4)+(r[e[u+3]]<<6);if(u<c){f[h]=0;for(l=0;u<c;)f[h]|=r[e[u++]]<<l,l+=2;h++}return t.WriteUint7(h),[t,f,f.length]}if(i<=16){for(f=new n.allocUnsafe(Math.floor((c+1)/2)),u=0,h=0;u<(-2&c);u+=2,h++)f[h]=(r[e[u+0]]<<0)+(r[e[u+1]]<<4);return u<c&&(f[h++]=r[e[u++]]),t.WriteUint7(h),[t,f,f.length]}return t.WriteUint7(e.length),[t,e,e.length]}},{key:"encodeStripe",value:function(e,t,r){0==r&&(r=4);for(var n=new Array(r),a=new Array(r),i=0;i<r;i++)a[i]=Math.floor(t.length/r)+(t.length%r>i),n[i]=new Array(a[i]);for(var o=0,s=0;s<t.length;s+=r,o++)for(var u=0;u<r;u++)o<n[u].length&&(n[u][o]=t[s+u]);var f=new Array(r),h=0;for(i=0;i<r;i++){var l=this.encode(n[i],0),d=this.encode(n[i],1);f[i]=d.length<l.length?d:l,h+=f[i].length}var p=new c("",0,h+5*r+1);p.WriteByte(r);for(i=0;i<r;i++)p.WriteUint7(f[i].length);for(i=0;i<r;i++)p.WriteData(f[i],f[i].length);return p.buf.slice(0,p.buf.pos)}},{key:"decodeStripe",value:function(e,t){for(var r=e.ReadByte(),a=new Array(r),i=new Array(r),o=0;o<r;o++)a[o]=e.ReadUint7();var s=new Array(r);for(o=0;o<r;o++)i[o]=Math.floor(t/r)+(t%r>o),s[o]=this.decodeStream(e,i[o]);var c=new n.allocUnsafe(t);for(o=0;o<r;o++)for(var u=0;u<i[o];u++)c[u*r+o]=s[o][u];return c}},{key:"decodeCat",value:function(e,t){for(var r=new n.allocUnsafe(t),a=0;a<t;a++)r[a]=e.ReadByte();return r}}]),e}()},12712:function(e,t,r){var n=r(50085).default,a=r(15198).default;e.exports=function(){"use strict";function e(t){n(this,e),this.low=0,this.range=4294967295,this.code=0,this.FFnum=0,this.carry=0,this.cache=0}return a(e,[{key:"RangeStartDecode",value:function(e){for(var t=0;t<5;t++)this.code=(this.code<<8)+e.ReadByte();this.code&=4294967295,this.code>>>=0}},{key:"RangeGetFrequency",value:function(e){return this.range=Math.floor(this.range/e),Math.floor(this.code/this.range)}},{key:"RangeDecode",value:function(e,t,r,n){for(this.code-=t*this.range,this.range*=r;this.range<1<<24;)this.range*=256,this.code=256*this.code+e.ReadByte()}},{key:"RangeShiftLow",value:function(e){if(this.low<4278190080|this.carry){for(e.WriteByte(this.cache+this.carry);this.FFnum;)e.WriteByte(this.carry-1),this.FFnum--;this.cache=this.low>>>24,this.carry=0}else this.FFnum++;this.low<<=8,this.low>>>=0}},{key:"RangeEncode",value:function(e,t,r,n){var a=this.low;for(this.range=Math.floor(this.range/n),this.low+=t*this.range,this.low>>>=0,this.range*=r,this.low<a&&(0!=this.carry&&console.log("ERROR: Multiple carry"),this.carry=1);this.range<1<<24;)this.range*=256,this.RangeShiftLow(e)}},{key:"RangeFinishEncode",value:function(e){for(var t=0;t<5;t++)this.RangeShiftLow(e)}}]),e}()},37539:function(e,t,r){var n=r(50085).default,a=r(15198).default;e.exports=function(){"use strict";function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256;n(this,e),this.total_freq=t,this.max_sym=t-1,this.S=new Array,this.F=new Array;for(var r=0;r<=this.max_sym;r++)this.S[r]=r,this.F[r]=1}return a(e,[{key:"ModelDecode",value:function(e,t){for(var r=t.RangeGetFrequency(this.total_freq),n=0,a=0;n+this.F[a]<=r;)n+=this.F[a++];t.RangeDecode(e,n,this.F[a],this.total_freq),this.F[a]+=16,this.total_freq+=16,this.total_freq>65519&&this.ModelRenormalise();var i=this.S[a];if(a>0&&this.F[a]>this.F[a-1]){var o=this.F[a];this.F[a]=this.F[a-1],this.F[a-1]=o,o=this.S[a],this.S[a]=this.S[a-1],this.S[a-1]=o}return i}},{key:"ModelRenormalise",value:function(){this.total_freq=0;for(var e=0;e<=this.max_sym;e++)this.F[e]-=Math.floor(this.F[e]/2),this.total_freq+=this.F[e]}},{key:"ModelEncode",value:function(e,t,r){for(var n=0,a=0;this.S[a]!=r;a++)n+=this.F[a];t.RangeEncode(e,n,this.F[a],this.total_freq),this.F[a]+=16,this.total_freq+=16,this.total_freq>65519&&this.ModelRenormalise();r=this.S[a];if(a>0&&this.F[a]>this.F[a-1]){var i=this.F[a];this.F[a]=this.F[a-1],this.F[a-1]=i,i=this.S[a],this.S[a]=this.S[a-1],this.S[a-1]=i}}}]),e}()},69665:function(e,t,r){var n=r(49882).Buffer,a=r(40475),i=r(81260).default,o=r(64548),s=r(37539),c=r(12712);function u(e,t,r){for(var n=0,a=0,i=-1,o=new Array(1024);a<r;){var s=e.ReadByte();if(o[n++]=s,a+=s,s==i){var c=e.ReadByte();for(a+=s*c;c--;)o[n++]=s}i=s}var u=0;for(n=0,a=0;a<r;){var f=0;do{var h=o[n++];f+=h}while(255==h);for(;f--;)t[a++]=u;u++}}function f(e,t,r){var n=e.context;return t.qctx=(t.qctx<<e.qshift)+e.qtab[r],n+=(t.qctx&(1<<e.qbits)-1)<<e.qloc,e.do_pos&&(n+=e.ptab[Math.min(t.p,1023)]<<e.ploc),e.do_delta&&(n+=e.dtab[Math.min(t.delta,255)]<<e.dloc,t.delta+=t.prevq!=r?1:0,t.prevq=r),e.do_sel&&(n+=t.s<<e.sloc),t.p--,65535&n}function h(e){var t={};t.context=e.ReadUint16(),t.pflags=e.ReadByte(),t.do_dedup=2&t.pflags,t.fixed_len=4&t.pflags,t.do_sel=8&t.pflags,t.do_qmap=16&t.pflags,t.do_pos=32&t.pflags,t.do_delta=64&t.pflags,t.do_qtab=128&t.pflags,t.max_sym=e.ReadByte();var r=e.ReadByte();if(t.qbits=r>>4,t.qshift=15&r,r=e.ReadByte(),t.qloc=r>>4,t.sloc=15&r,r=e.ReadByte(),t.ploc=r>>4,t.dloc=15&r,t.qmap=new Array(256),16&t.pflags)for(var n=0;n<t.max_sym;n++)t.qmap[n]=e.ReadByte();else for(n=0;n<256;n++)t.qmap[n]=n;if(t.qtab=new Array(1024),t.qbits>0&&128&t.pflags)u(e,t.qtab,256);else for(n=0;n<256;n++)t.qtab[n]=n;return t.ptab=new Array(1024),32&t.pflags&&u(e,t.ptab,1024),t.dtab=new Array(256),64&t.pflags&&u(e,t.dtab,256),t}function l(e,t,r,n,a,i){r.max_sel>0?a.s=n.sel.ModelDecode(e,t):a.s=0,a.x=r.stab[a.s];var o=r.params[a.x];if(o.fixed_len>=0){var s=n.len[0].ModelDecode(e,t);s|=n.len[1].ModelDecode(e,t)<<8,s|=n.len[2].ModelDecode(e,t)<<16,s|=n.len[3].ModelDecode(e,t)<<24,o.fixed_len>0&&(o.fixed_len=-s)}else s=-o.fixed_len;a.len=s,r.do_rev&&(i[a.rec]=n.rev.ModelDecode(e,t)),a.is_dup=0,2&o.pflags&&n.dup.ModelDecode(e,t)&&(a.is_dup=1),a.p=s,a.delta=0,a.qctx=0,a.prevq=0,a.rec++}function d(e,t){var r=e.ReadUint7(),a=function(e){var t={max_sym:0};if(5==e.ReadByte()){var r=e.ReadByte(),n=1&r?e.ReadByte():1,a=r.nparam>1?r.nparam-1:0,i=new Array(256);if(2&r)a=e.ReadByte(),u(e,i,256);else{for(var o=0;o<n;o++)i[o]=o;for(;o<256;o++)i[o]=n-1}t.do_rev=4&r,t.stab=i,t.max_sel=a,t.params=new Array(t.nparam);for(var s=0;s<n;s++)t.params[s]=h(e),t.max_sym<t.params[s].max_sym&&(t.max_sym=t.params[s].max_sym);return t}console.error("Invalid FQZComp version number")}(e);if(a){var i=a.params,o=new Array(t.length),d=function(e){var t={};t.qual=new Array(65536);for(var r=0;r<65536;r++)t.qual[r]=new s(e.max_sym+1);for(t.len=new Array(4),r=0;r<4;r++)t.len[r]=new s(256);return t.rev=new s(2),t.dup=new s(2),e.max_sel>0&&(t.sel=new s(e.max_sel+1)),t}(a),p=new c(e);p.RangeStartDecode(e);for(var v=new n.allocUnsafe(r),y={qctx:0,prevq:0,delta:0,p:0,s:0,x:0,len:0,is_dup:0,rec:0},g=0;g<r;){if(0==y.p){if(l(e,p,a,d,y,o),y.is_dup>0&&d.dup.ModelDecode(e,p)){for(var m=0;m<len;m++)v[g+m]=v[g+m-y.len];g+=y.len,y.p=0;continue}t.push(y.len);var b=(i=a.params[y.x]).context}var w=d.qual[b].ModelDecode(e,p);v[g++]=i.qmap[w],b=f(i,y,w)}return a.do_rev&&function(e,t,r,n){var a=0,i=0;for(;i<t;){if(r[a])for(var o=0,s=n[a]-1;o<s;){var c=e[i+o];e[i+o]=e[i+s],e[i+s]=c,o++,s--}i+=n[a++]}}(v,r,o,t),v}}function p(e,t,r){for(var n=0,a=0,i=new Array(2*r),o=0;n<r;){for(var s=n;n<r&&t[n]==a;)n++;var c=n-s;do{var u=Math.min(255,c);i[o++]=u,c-=u}while(255==u);a++}var f=-1,h=new Array(2*r),l=0;for(n=0;n<o;){var d=i[n++];if(h[l++]=d,d==f){for(s=n;n<o&&i[n]==f&&n-s<255;)n++;h[l++]=n-s}else f=d}e.WriteData(h,l)}e.exports={decode:function(e,t){return d(new o(e),t)},encode:function(e,t,r){for(var n=new Array(2),u=new Array(2),f=new Array(2),h=new Array(2),l=new Array(256),d=0;d<2;d++)n[d]=new Array(256),u[d]=new Array(256),f[d]=new Array(1024),h[d]=new Array(256);(y=new o("",0,1.1*e.length+100)).WriteUint7(e.length);var v=function(e,t,r,n){for(var a,o=r[0],s=0;s<r.length&&r[s]==o;s++);var c=s==r.length?1:0,u=0,f=0;for(s=0;s<256;s++)n[0][s]=0;var h=0,l=0;for(s=0;s<e.length;s++)0==l&&(l=t[h<t.length-1?h++:h]),n[0][e[s]]++,l--;for(s=0;s<256;s++)n[0][s]&&(f<s&&(f=s),u++);var d=5,p=0;return u<=16&&(p=1,d=u<=2?1:u<=4?2:u<=8?3:4),[(a={qbits:8+(d>4),qshift:d,qloc:7,pbits:7,pshift:t[0]>128?1:0,ploc:0,dbits:d>4?0:1,dshift:3,dloc:15,sbits:0,sloc:15,do_stab:0,context:0,max_sym:f,nsym:u,do_qmap:p,do_dedup:0,fixed_len:1==t.length?1:0,do_sel:0,do_rev:0,do_pos:1,do_delta:d<=4?1:0,do_qtab:0},i(a,"qbits",8+(d>4)-(0==c)),i(a,"sbits",1),i(a,"sloc",15-(d<=4)),i(a,"do_stab",1),i(a,"do_sel",1),a)]}(e,t,r,n),y=function(e,t,r,n,a,i,o){for(var s=[0,1,1,1,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],c=0;c<t.length;c++)o[c]=c;for(;c<256;c++)o[c]=t.length-1;e.WriteByte(5);var u=(t.length>1?1:0)|(t[0].do_stab?2:0);if(e.WriteByte(u),1&u&&e.WriteByte(t.length),2&u){var f=1<<t[0].sbits;f>0&&f--,e.WriteByte(f),p(e,o,256)}for(var h=0;h<t.length;h++){if(e.WriteUint16(t[h].context),e.WriteByte((t[h].do_qtab?128:0)|(t[h].do_delta?64:0)|(t[h].do_pos?32:0)|(t[h].do_qmap?16:0)|(t[h].do_sel?8:0)|(t[h].fixed_len?4:0)|(t[h].do_dedup?2:0)),t[h].do_qmap?e.WriteByte(t[h].nsym):e.WriteByte(t[h].max_sym),e.WriteByte(t[h].qbits<<4|t[h].qshift),e.WriteByte(t[h].qloc<<4|t[h].sloc),e.WriteByte(t[h].ploc<<4|t[h].dloc),t[h].do_qmap){t[h].max_sym=t[h].nsym;var l=0;for(c=0;c<256;c++)r[h][c]&&(e.WriteByte(c),r[h][c]=l++);for(;l<t[h].nsym;l++)e.WriteByte(0)}else for(c=0;c<256;c++)r[h][c]=c;if(t[h].qbits>0){for(c=0;c<256;c++)n[h][c]=c;t[h].do_qtab&&p(e,n[h],256)}if(t[h].pbits>0){for(c=0;c<1024;c++)a[h][c]=Math.min((1<<t[h].pbits)-1,c>>t[h].pshift);p(e,a[h],1024)}if(t[h].dbits>0){for(c=0;c<256;c++)s[c]>(1<<t[h].dbits)-1&&(s[c]=(1<<t[h].dbits)-1);for(c=0;c<256;c++)i[h][c]=s[Math.min(s.length-1,c>>t[h].dshift)];p(e,i[h],256)}}return e}(y,v,n,u,f,h,l);return function(e,t,r,n,i,o,u,f,h,l){var d=1<<i[0].sbits;d>0&&d--;for(var p=t.length,v=0,y=0;y<i.length;y++)v<i[y].max_sym&&(v=i[y].max_sym);for(var g=new Array(65536),m=0;m<65536;m++)g[m]=new s(v+1);var b=new Array(4);for(m=0;m<4;m++)b[m]=new s(256);new s(2),new s(2);for(var w=new s(d+1),k=new c(t),A=(y=0,m=0,0);m<p;){if(0==y){var S=n[A];i[0].sbits>0&&w.ModelEncode(e,k,S);var _=l[S],x=r[Math.min(r.length-1,A++)];i[_].fixed_len?i[_].fixed_len>0&&(b[0].ModelEncode(e,k,255&x),b[1].ModelEncode(e,k,x>>8&255),b[2].ModelEncode(e,k,x>>16&255),b[3].ModelEncode(e,k,x>>24&255),i[_].fixed_len=-1):(b[0].ModelEncode(e,k,255&x),b[1].ModelEncode(e,k,x>>8&255),b[2].ModelEncode(e,k,x>>16&255),b[3].ModelEncode(e,k,x>>24&255)),i[_].do_dedup&&a.exit(1),y=x;var B=0,R=i[_].context,C=0,E=0}var M=t[m++],F=o[_][M];g[R].ModelEncode(e,k,F),C=(C<<i[_].qshift)+u[_][F],R=i[_].context,R+=(C&(1<<i[_].qbits)-1)<<i[_].qloc,i[_].pbits>0&&(R+=f[_][Math.min(y,1023)]<<i[_].ploc),i[_].dbits>0&&(R+=h[_][Math.min(B,255)]<<i[_].dloc,B+=E!=F?1:0,E=F),i[_].do_sel&&(R+=S<<i[_].sloc),R&=65535,y--}return k.RangeFinishEncode(e),e.buf.slice(0,e.pos)}(y,e,t,r,v,n,u,f,h,l)}}},38536:function(e,t,r){"use strict";var n=r(49882).Buffer,a=r(33453),i=r(76761),o=r(15870),s=r(69665),c=r(88999);e.exports={r4x8_uncompress:function(e,t){a.decode(e).copy(t,0,0)},r4x16_uncompress:function(e,t){i.decode(e).copy(t,0,0)},arith_uncompress:function(e,t){o.decode(e).copy(t,0,0)},fqzcomp_uncompress:function(e,t){var r=new Array;s.decode(e,r).copy(t,0,0)},tok3_uncompress:function(e,t){var r=c.decode(e,0,"\0");n.from(r,"binary").copy(t,0,0)}}},64548:function(e,t,r){var n=r(49882).Buffer,a=r(50085).default,i=r(15198).default;e.exports=function(){"use strict";function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;a(this,e),0!=i?(this.buf=n.allocUnsafe(i),this.length=i):(this.buf=t,this.length=t.length),this.pos=r}return i(e,[{key:"EOF",value:function(){return this.pos>=this.length}},{key:"ReadData",value:function(e){var t=this.buf.slice(this.pos,this.pos+e);return this.pos+=e,t}},{key:"ReadByte",value:function(){var e=this.buf[this.pos];return this.pos++,e}},{key:"ReadChar",value:function(){var e=this.buf[this.pos];return this.pos++,String.fromCharCode(e)}},{key:"ReadUint16",value:function(){var e=this.ReadByte();return e|=this.ReadByte()<<8}},{key:"ReadUint32",value:function(){var e=this.buf.readInt32LE(this.pos);return this.pos+=4,e}},{key:"ReadString",value:function(){var e="";do{var t=this.buf[this.pos++];t&&(e+=String.fromCharCode(t))}while(t);return e}},{key:"ReadUint7",value:function(){var e=0;do{var t=this.ReadByte();e=e<<7|127&t}while(128&t);return e}},{key:"ReadITF8",value:function(){var e=this.buf[this.pos];return this.pos++,e>=240?(e=(15&e)<<28,e+=(this.buf[this.pos+0]<<20)+(this.buf[this.pos+1]<<12)+(this.buf[this.pos+2]<<4)+(this.buf[this.pos+3]>>4),this.pos+=4):e>=224?(e=(15&e)<<24,e+=(this.buf[this.pos+0]<<16)+(this.buf[this.pos+1]<<8)+(this.buf[this.pos+2]<<0),this.pos+=3):e>=192?(e=(31&e)<<16,e+=(this.buf[this.pos+0]<<8)+(this.buf[this.pos+1]<<0),this.pos+=2):e>=128&&(e=(63&e)<<8,e+=this.buf[this.pos],this.pos++),e}},{key:"WriteByte",value:function(e){this.buf[this.pos++]=e}},{key:"WriteChar",value:function(e){this.buf[this.pos++]=e.charCodeAt(0)}},{key:"WriteString",value:function(e){for(var t=0;t<e.length;t++)this.buf[this.pos++]=e.charCodeAt(t);this.buf[this.pos++]=0}},{key:"WriteData",value:function(e,t){for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]}},{key:"WriteStream",value:function(e){this.WriteData(e.buf,e.pos)}},{key:"WriteUint16",value:function(e){this.WriteByte(255&e),this.WriteByte(e>>8&255)}},{key:"WriteUint32",value:function(e){this.buf.writeInt32LE(e,this.pos),this.pos+=4}},{key:"WriteUint7",value:function(e){var t=0,r=e;do{t+=7,r>>=7}while(r>0);do{t-=7,this.WriteByte((e>>t&127)+((t>0)<<7))}while(t>0)}},{key:"WriteITF8",value:function(e){e<0&&(e=1+e),e<=127?this.buf[this.pos++]=e:e<=16383?(this.buf[this.pos++]=128|Math.floor(e/256),this.buf[this.pos++]=255&e):e<131071?(this.buf[this.pos++]=192|Math.floor(e/65536),this.buf[this.pos++]=255&Math.floor(e/256),this.buf[this.pos++]=255&e):e<268435455?(this.buf[this.pos++]=224|Math.floor(e/16777216),this.buf[this.pos++]=255&Math.floor(e/65536),this.buf[this.pos++]=255&Math.floor(e/256),this.buf[this.pos++]=255&e):(this.buf[this.pos++]=240|Math.floor(e/268435456),this.buf[this.pos++]=255&Math.floor(e/1048576),this.buf[this.pos++]=255&Math.floor(e/4096),this.buf[this.pos++]=255&Math.floor(e/4),this.buf[this.pos++]=15&e)}},{key:"WriteByteNeg",value:function(e){this.buf[--this.pos]=e}}]),e}()},33453:function(e,t,r){var n=r(49882).Buffer,a=r(64548);function i(e){return 4095&e}function o(e,t){for(var r=0;t>=e[r+1];)r++;return r}function s(e){for(var t=new Array(4096),r=0,n=0;n<4096;n++){for(;n>=e[r+1];)r++;t[n]=r}return t}function c(e,t,r){return r*(e>>12)+(4095&e)-t}function u(e,t){for(;t<1<<23;)t=(t<<8)+e.ReadByte();return t}function f(e,t){t.WriteByteNeg(e>>24&255),t.WriteByteNeg(e>>16&255),t.WriteByteNeg(e>>8&255),t.WriteByteNeg(e>>0&255)}function h(e,t,r,n,a){return e=function(e,t,r,n){for(var a=(1<<23>>n<<8)*r;e>=a;)t.WriteByteNeg(255&e),e>>=8;return e}(e,t,n,a),e=(Math.floor(e/n)<<a)+e%n+r}function l(e,t,r){for(var n=0;n<256;n++)t[n]=0;var a=e.ReadByte(),i=a,o=0;do{var s=e.ReadITF8();t[a]=s,o>0?(o--,a++):(a=e.ReadByte())==i+1&&(o=e.ReadByte()),i=a}while(0!=a);r[0]=0;for(n=0;n<=255;n++)r[n+1]=r[n]+t[n]}function d(e){for(var t=0,r=0;r<256;r++)t+=e[r];var n=4096,a=n/t;do{var i=0,o=0,s=0;t=0;for(r=0;r<256;r++)0!=e[r]&&(i<e[r]&&(i=e[r],o=r),e[r]=Math.floor(e[r]*a),0==e[r]&&(e[r]=1),t+=e[r]);t<n?e[o]+=n-t:t-n<e[o]/2&&e[o]>2?e[o]-=t-n:t!=n&&(a*=.99,s=1)}while(s)}function p(e,t){for(var r=0,n=0;n<256;n++)if(t[n]){if(r>0)r--;else if(e.WriteByte(n),n>0&&t[n-1]>0){for(r=n+1;r<256&&t[r];r++);r-=n+1,e.WriteByte(r)}e.WriteITF8(t[n])}e.WriteByte(0)}e.exports={decode:function(e){var t=new a(e),r=t.ReadByte(),f=(t.ReadUint32(),t.ReadUint32());return 0==r?function(e,t){var r=new Array(256),a=new Array(256);l(e,r,a);for(var o=s(a),f=new Array(4),h=0;h<4;h++)f[h]=e.ReadUint32();var d=new n.allocUnsafe(t);for(h=0;h<t;h++){var p=h%4,v=o[i(f[p])];d[h]=v,f[p]=c(f[p],a[v],r[v]),f[p]=u(e,f[p])}return d}(t,f):function(e,t){var r=new Array(256),a=new Array(256);!function(e,t,r){for(var n=0;n<256;n++){t[n]=new Array(256),r[n]=new Array(256);for(var a=0;a<256;a++)t[n][a]=0}var i=e.ReadByte(),o=i,s=0;do{l(e,t[i],r[i]),s>0?(s--,i++):(i=e.ReadByte())==o+1&&(s=e.ReadByte()),o=i}while(0!=i)}(e,r,a);for(var f=new Array(256),h=0;h<256;h++)f[h]=s(a[h]);for(var d=new Array(4),p=new Array(4),v=0;v<4;v++)d[v]=e.ReadUint32(),p[v]=0;var y=new n.allocUnsafe(t),g=Math.floor(t/4);for(h=0;h<g;h++)for(v=0;v<4;v++){var m=i(d[v]),b=f[p[v]][m];y[h+v*g]=b,d[v]=c(d[v],a[p[v]][b],r[p[v]][b]),d[v]=u(e,d[v]),p[v]=b}h*=4;for(;h<t;){m=i(d[3]),b=o(a[p[3]],m);y[h++]=b,d[3]=c(d[3],a[p[3]][b],r[p[3]][b]),d[3]=u(e,d[3]),p[3]=b}return y}(t,f)},encode:function(e,t){return 0==t?function(e){var t=e.length,r=new a("",0,780);r.WriteByte(0),r.WriteUint32(0),r.WriteUint32(0);var i=new Array(256);(function(e,t){for(var r=0;r<256;r++)t[r]=0;for(r=0;r<e.length;r++)t[e[r]]++})(e,i),d(i),p(r,i);var o=new Array(256);o[0]=0;for(var s=1;s<256;s++)o[s]=o[s-1]+i[s-1];var c=new Array(4);for(s=0;s<4;s++)c[s]=1<<23;var u=Math.floor(1.05*t+100),l=new a("",u,u);for(s=t-1;s>=0;s--)c[s%4]=h(c[s%4],l,o[e[s]],i[e[s]],12);for(s=3;s>=0;s--)f(c[s],l);var v=r.pos;return r.buf.writeInt32LE(v-9+(l.length-l.pos),1),r.buf.writeInt32LE(t,5),n.concat([r.buf.slice(0,r.pos),l.buf.slice(l.pos,l.length)],r.pos+l.length-l.pos)}(e):function(e){var t=e.length,r=new a("",0,198156);r.WriteByte(1),r.WriteUint32(0),r.WriteUint32(0);for(var i=new Array(256),o=new Array(256),s=new Array(256),c=0;c<256;c++)o[c]=new Array(256),s[c]=new Array(256);(function(e,t,r){for(var n=0;n<256;n++){r[n]=0;for(var a=0;a<256;a++)t[n][a]=0}var i=0;for(n=0;n<e.length;n++)r[e[n]]++,t[i][e[n]]++,i=e[n];t[0][e[1*(e.length>>2)]]++,t[0][e[2*(e.length>>2)]]++,t[0][e[3*(e.length>>2)]]++,r[0]+=3})(e,o,i),function(e,t){for(var r=0;r<256;r++)t[r]&&d(e[r])}(o,i),function(e,t,r){for(var n=0,a=0;a<256;a++)if(r[a]){if(n>0)n--;else if(e.WriteByte(a),a>0&&r[a-1]>0){for(n=a+1;n<256&&r[n];n++);n-=a+1,e.WriteByte(n)}p(e,t[a])}e.WriteByte(0)}(r,o,i);for(c=0;c<256;c++)if(i[c]){s[c][0]=0;for(var u=1;u<256;u++)s[c][u]=s[c][u-1]+o[c][u-1]}var l=new Array(4),v=new Array(4);for(u=0;u<4;u++)l[u]=1<<23,v[u]=0;var y=new a("",t,t),g=Math.floor(t/4),m=new Array(4),b=new Array(4);for(u=0;u<4;u++)m[u]=(u+1)*g-2,b[u]=e[m[u]+1];b[3]=e[t-1];for(c=t-2;c>4*g-2;c--)l[3]=h(l[3],y,s[e[c]][b[3]],o[e[c]][b[3]],12),b[3]=e[c];for(;m[0]>=0;)for(u=3;u>=0;u--){var w=e[m[u]];l[u]=h(l[u],y,s[w][b[u]],o[w][b[u]],12),b[u]=w,m[u]--}for(u=3;u>=0;u--)l[u]=h(l[u],y,s[0][b[u]],o[0][b[u]],12);for(c=3;c>=0;c--)f(l[c],y);var k=r.pos;return r.buf.writeInt32LE(k-9+(y.length-y.pos),1),r.buf.writeInt32LE(t,5),n.concat([r.buf.slice(0,r.pos),y.buf.slice(y.pos,y.length)],r.pos+y.length-y.pos)}(e)}}},76761:function(e,t,r){var n=r(49882).Buffer,a=r(51068).default,i=r(64548);function o(e,t){return e&(1<<t)-1}function s(e,t){for(var r=0;t>=e[r+1];)r++;return r}function c(e,t){for(var r=1<<t,n=new Array(r),a=0,i=0;i<r;i++){for(;i>=e[a+1];)a++;n[i]=a}return n}function u(e,t,r,n){return r*(e>>n)+(e&(1<<n)-1)-t}function f(e,t){return t<32768&&(t=(t<<16)+e.ReadUint16()),t}function h(e,t){t.WriteByteNeg(e>>24&255),t.WriteByteNeg(e>>16&255),t.WriteByteNeg(e>>8&255),t.WriteByteNeg(e>>0&255)}function l(e,t,r,n,a){return e=function(e,t,r,n){for(var a=(1<<31-n)*r;e>=a;)t.WriteByteNeg(e>>8&255),t.WriteByteNeg(255&e),e>>=16;return e}(e,t,n,a),e=(Math.floor(e/n)<<a)+e%n+r}function d(e,t,r){0==r&&(r=4);for(var n=new Array(r),a=new Array(r),o=0;o<r;o++)a[o]=Math.floor(t.length/r)+(t.length%r>o),n[o]=new Array(a[o]);for(var s=0,c=0;c<t.length;c+=r,s++)for(var u=0;u<r;u++)s<n[u].length&&(n[u][s]=t[c+u]);var f=new Array(r),h=0;for(o=0;o<r;o++){var l=v(n[o],0),d=v(n[o],1);f[o]=d.length<l.length?d:l,h+=f[o].length}var p=new i("",0,h+5*r+1);p.WriteByte(r);for(o=0;o<r;o++)p.WriteUint7(f[o].length);for(o=0;o<r;o++)p.WriteData(f[o],f[o].length);return p.buf.slice(0,p.buf.pos)}function p(e,t){var r=e.ReadByte(),h=1&r,l=8&r,d=32&r,v=64&r,m=128&r;if(16&r||(t=e.ReadUint7()),l)return function(e,t){for(var r=e.ReadByte(),a=new Array(r),i=new Array(r),o=0;o<r;o++)a[o]=e.ReadUint7();var s=new Array(r);for(o=0;o<r;o++)i[o]=Math.floor(t/r)+(t%r>o),s[o]=p(e,i[o]);var c=new n.allocUnsafe(t);for(o=0;o<r;o++)for(var u=0;u<i[o];u++)c[u*r+o]=s[o][u];return c}(e,t);if(m){var w=t,k=function(e){for(var t=e.ReadByte(),r=new Array(t),n=0;n<t;n++)r[n]=e.ReadByte();return[r,t,e.ReadUint7()]}(e),A=a(k,3),S=A[0],_=A[1];t=A[2]}if(v){var x=t,B=function(e){var t=e.ReadUint7(),r=e.ReadUint7();if(1&t)var n=e.ReadData((t-1)/2);else{var a=e.ReadUint7();n=e.ReadData(a),n=g(new i(n),t/2)}n=new i(n);var o=new Array(256),s=n.ReadByte();0==s&&(s=256);for(var c=0;c<s;c++)o[n.ReadByte()]=1;return[o,n,r]}(e),R=a(B,3),C=R[0],E=R[1];t=R[2]}if(d)var M=e.ReadData(t);else if(0==h)M=g(e,t);else M=function(e,t){var r=(d=e.ReadByte())>>4,a=e;if(1&d){var h=e.ReadUint7(),l=e.ReadUint7(),d=new i(e.ReadData(l));a=new i(g(d,h))}var p=new Array(256),v=new Array(256);!function(e,t,r,n){for(var a=0;a<256;a++){t[a]=new Array(256),r[a]=new Array(256);for(var i=0;i<256;i++)t[a][i]=0}var o=y(e);for(a=0;a<256;a++)if(o[a]){var s=0;for(i=0;i<256;i++)o[i]&&(s>0?s--:(t[a][i]=e.ReadUint7(),0==t[a][i]&&(s=e.ReadByte())));b(t[a],n),r[a][0]=0;for(i=0;i<256;i++)r[a][i+1]=r[a][i]+t[a][i]}}(a,p,v,r);for(var m=new Array(256),w=0;w<256;w++)m[w]=c(v[w],r);for(var k=new Array(4),A=new Array(4),S=0;S<4;S++)k[S]=e.ReadUint32(),A[S]=0;var _=new n.allocUnsafe(t),x=Math.floor(t/4);for(w=0;w<x;w++)for(S=0;S<4;S++){var B=o(k[S],r),R=m[A[S]][B];_[w+S*x]=R,k[S]=u(k[S],v[A[S]][R],p[A[S]][R],r),k[S]=f(e,k[S]),A[S]=R}w*=4;for(;w<t;){B=o(k[3],r),R=s(v[A[3]],B);_[w++]=R,k[3]=u(k[3],v[A[3]][R],p[A[3]][R],r),k[3]=f(e,k[3]),A[3]=R}return _}(e,t);return v&&(M=function(e,t,r,a){new i(e);for(var o=new n.allocUnsafe(a),s=0,c=0;s<a;c++){var u=e[c];if(t[u])for(var f=r.ReadUint7(),h=0;h<=f;h++)o[s++]=u;else o[s++]=u}return o}(M,C,E,x)),m&&(M=function(e,t,r,a){var i=new n.allocUnsafe(a),o=0;if(r<=1)for(var s=0;s<a;s++)i[s]=t[0];else if(r<=2)for(s=0;s<a;s++){if(s%8==0)var c=e[o++];i[s]=t[1&c],c>>=1}else if(r<=4)for(s=0;s<a;s++)s%4==0&&(c=e[o++]),i[s]=t[3&c],c>>=2;else if(r<=16)for(s=0;s<a;s++)s%2==0&&(c=e[o++]),i[s]=t[15&c],c>>=4;return i}(M,S,_,w)),M}function v(e,t){var r=new i("",0,10);r.WriteByte(t);var o=1&t,s=8&t,c=32&t,u=64&t,f=128&t,p=t>>8;if(16&t||r.WriteUint7(e.length),s)return n.concat([r.buf.slice(0,r.pos),d(0,e,p)]);var v=new n.alloc(0);if(f){var y=function(e){for(var t=new Array(256),r=0;r<256;r++)t[r]=0;for(r=0;r<e.length;r++)t[e[r]]++;var a=new Array(256),o=0;for(r=0;r<256;r++)t[r]>0&&(a[r]=o++);if(!(o>16)){if(o<=1)var s=new n.allocUnsafe(0);else if(o<=2){s=new n.allocUnsafe(Math.ceil(e.length/8));var c=-1;for(r=0;r<e.length;r++)r%8==0&&(s[++c]=0),s[c]+=a[e[r]]<<r%8}else if(o<=4)for(s=new n.allocUnsafe(Math.ceil(e.length/4)),c=-1,r=0;r<e.length;r++)r%4==0&&(s[++c]=0),s[c]+=a[e[r]]<<r%4*2;else for(s=new n.allocUnsafe(Math.ceil(e.length/2)),c=-1,r=0;r<e.length;r++)r%2==0&&(s[++c]=0),s[c]+=a[e[r]]<<r%2*4;var u=new i("",0,o+5);for(u.WriteByte(o),c=0,r=0;r<256;r++)t[r]>0&&(t[r]=c++,u.WriteByte(r));return u.WriteUint7(s.length),[u.buf.slice(0,u.pos),s]}}(e),g=a(y,2);v=g[0],e=g[1]}var A=new n.alloc(0);if(u){var S=function(e){for(var t=new Array(256),r=0;r<256;r++)t[r]=0;var a=-1;for(r=0;r<e.length;r++)t[e[r]]+=e[r]==a?1:-1,a=e[r];var o=0;for(r=0;r<256;r++)t[r]>0&&o++;for(o||(o=1,t[0]=1),(f=new i("",0,o+1+e.length)).WriteByte(o),r=0;r<256;r++)t[r]>0&&f.WriteByte(r);var s=new n.allocUnsafe(e.length),c=0;for(r=0;r<e.length;r++)if(s[c++]=e[r],t[e[r]]>0){a=e[r];for(var u=0;r+u+1<e.length&&e[r+u+1]==a;)u++;f.WriteUint7(u),r+=u}var f,h=k(f.buf.slice(0,f.pos)),l=new i("",0,16);return l.WriteUint7(2*f.pos),l.WriteUint7(c),l.WriteUint7(h.length),[f=n.concat([l.buf.slice(0,l.pos),h]),s.slice(0,c)]}(e),_=a(S,2);A=_[0],e=_[1]}if(e.length<4&&1==o&&(o=0,r.buf[0]&=-2),c)var x=e;else if(0==o)x=k(e);else x=function(e){for(var t=e.length,r=new i("",0,198156),a=new Array(256),o=new Array(256),s=new Array(256),c=0;c<256;c++)o[c]=new Array(256),s[c]=new Array(256);var u=12;(function(e,t,r){for(var n=0;n<256;n++){r[n]=0;for(var a=0;a<256;a++)t[n][a]=0}var i=0;for(n=0;n<e.length;n++)r[i]++,t[i][e[n]]++,i=e[n];r[i]++,t[0][e[1*(e.length>>2)]]++,t[0][e[2*(e.length>>2)]]++,t[0][e[3*(e.length>>2)]]++,r[0]+=3})(e,o,a),function(e,t,r){for(var n=0;n<256;n++)if(t[n]){var a=Math.ceil(Math.log2(t[n]));a>r&&(a=r),m(e[n],a)}}(o,a,u);var f=new i("",0,198156);!function(e,t,r){w(e,r);for(var n=0;n<256;n++)if(r[n])for(var a=0,i=0;i<256;i++)if(r[i])if(a)a--;else if(e.WriteUint7(t[n][i]),!t[n][i]){for(var o=i+1;o<256;o++)if(r[o]){if(0!=t[n][o])break;a++}e.WriteByte(a)}}(f,o,a);var d=k(f.buf.slice(0,f.pos));d.length<f.pos?(r.WriteByte(1|u<<4),r.WriteUint7(f.pos),r.WriteUint7(d.length),r.WriteData(d,d.length)):(r.WriteByte(0|u<<4),r.WriteData(f.buf,f.pos));!function(e,t,r){for(var n=0;n<256;n++)t[n]&&b(e[n],r)}(o,a,u);for(c=0;c<256;c++)if(a[c]){s[c][0]=0;for(var p=1;p<256;p++)s[c][p]=s[c][p-1]+o[c][p-1]}var v=new Array(4),y=new Array(4);for(p=0;p<4;p++)v[p]=32768,y[p]=0;var g=new i("",1.05*t+100>>0,1.05*t+100>>0),A=Math.floor(t/4),S=new Array(4),_=new Array(4);for(p=0;p<4;p++)S[p]=(p+1)*A-2,_[p]=e[S[p]+1];_[3]=e[t-1];for(c=t-2;c>4*A-2;c--)v[3]=l(v[3],g,s[e[c]][_[3]],o[e[c]][_[3]],u),_[3]=e[c];for(;S[0]>=0;)for(p=3;p>=0;p--){var x=e[S[p]];v[p]=l(v[p],g,s[x][_[p]],o[x][_[p]],u),_[p]=x,S[p]--}for(p=3;p>=0;p--)v[p]=l(v[p],g,s[0][_[p]],o[0][_[p]],u);for(c=3;c>=0;c--)h(v[c],g);return n.concat([r.buf.slice(0,r.pos),g.buf.slice(g.pos,g.length)],r.pos+g.length-g.pos)}(e);return n.concat([r.buf.slice(0,r.pos),v,A,x])}function y(e){for(var t=new Array(256),r=0;r<256;r++)t[r]=0;var n=0,a=e.ReadByte(),i=a;do{t[a]=1,n>0?(n--,a++):(a=e.ReadByte())==i+1&&(n=e.ReadByte()),i=a}while(0!=a);return t}function g(e,t){var r=new Array(256),a=new Array(256);!function(e,t,r){for(var n=0;n<256;n++)t[n]=0;var a=y(e);for(n=0;n<256;n++)a[n]>0&&(t[n]=e.ReadUint7());for(b(t,12),r[0]=0,n=0;n<=255;n++)r[n+1]=r[n]+t[n]}(e,r,a);for(var i=c(a,12),s=new Array(4),h=0;h<4;h++)s[h]=e.ReadUint32();var l=new n.allocUnsafe(t);for(h=0;h<t;h++){var d=h%4,p=i[o(s[d],12)];l[h]=p,s[d]=u(s[d],a[p],r[p],12),s[d]=f(e,s[d])}return l}function m(e,t){for(var r=0,n=0;n<256;n++)r+=e[n];var a=1<<t,i=a/r;do{var o=0,s=0,c=0;r=0;for(n=0;n<256;n++)0!=e[n]&&(o<e[n]&&(o=e[n],s=n),e[n]=Math.floor(e[n]*i),0==e[n]&&(e[n]=1),r+=e[n]);r<a?e[s]+=a-r:r-a<e[s]/2&&e[s]>2?e[s]-=r-a:r!=a&&(i=a/r,c=1)}while(c)}function b(e,t){for(var r=0,n=0;n<256;n++)r+=e[n];if(0!=r&&r!=1<<t){for(var a=0;r<1<<t;)r*=2,a++;for(n=0;n<256;n++)e[n]<<=a}}function w(e,t){for(var r=0,n=0;n<256;n++)if(t[n])if(r>0)r--;else if(e.WriteByte(n),n>0&&t[n-1]>0){for(r=n+1;r<256&&t[r];r++);r-=n+1,e.WriteByte(r)}e.WriteByte(0)}function k(e){var t=e.length,r=new i("",0,780),a=new Array(256);!function(e,t){for(var r=0;r<256;r++)t[r]=0;for(r=0;r<e.length;r++)t[e[r]]++}(e,a);var o=Math.ceil(Math.log2(t));o>12&&(o=12),m(a,o),function(e,t){w(e,t);for(var r=0;r<256;r++)t[r]&&e.WriteUint7(t[r])}(r,a),m(a,12);var s=new Array(256);s[0]=0;for(var c=1;c<256;c++)s[c]=s[c-1]+a[c-1];var u=new Array(4);for(c=0;c<4;c++)u[c]=32768;var f=new i("",1.05*t+100>>0,1.05*t+100>>0);for(c=t-1;c>=0;c--)u[c%4]=l(u[c%4],f,s[e[c]],a[e[c]],12);for(c=3;c>=0;c--)h(u[c],f);return n.concat([r.buf.slice(0,r.pos),f.buf.slice(f.pos,f.length)],r.pos+f.length-f.pos)}e.exports={decode:function(e){return p(new i(e),0)},encode:v}},88999:function(e,t,r){var n=r(49882).Buffer,a=r(51068).default,i=r(64548),o=r(76761),s=new(r(15870));function c(e,t){for(var r=e+"";r.length<t;)r="0"+r;return r}function u(e,t,r,n){var a=e[0][0].ReadByte(),i=n-e[0][a].ReadUint32();if(5==a)return t[n]=t[i],r[n]=r[i],t[n];var o=1;t[n]="",r[n]=new Array(256);do{switch(a=e[o][0].ReadByte()){case 2:r[n][o]=e[o][2].ReadChar();break;case 1:r[n][o]=e[o][1].ReadString();break;case 7:r[n][o]=e[o][7].ReadUint32();break;case 3:var s=e[o][3].ReadUint32(),u=e[o][4].ReadByte();r[n][o]=c(s,u);break;case 8:r[n][o]=(r[i][o]>>0)+e[o][8].ReadByte();break;case 9:s=(r[i][o]>>0)+e[o][9].ReadByte(),u=r[i][o].length;r[n][o]=c(s,u);break;case 10:r[n][o]=r[i][o];break;default:r[n][o]=""}t[n]+=r[n][o++]}while(12!=a);return t[n]}function f(e,t,r,n,a,i){for(var o=0;o<n.length;o++)if(!(r>0&&5==t[o][0].type)&&t[o][r])switch(e[0].WriteByte(t[o][r].type),t[o][r].type){case 6:e[6].WriteUint32(t[o][r].val);break;case 5:e[5].WriteUint32(t[o][r].val);break;case 1:e[1].WriteString(t[o][r].val);break;case 2:e[2].WriteChar(t[o][r].val);break;case 7:e[7].WriteUint32(t[o][r].val);break;case 3:e[3].WriteUint32(t[o][r].val),e[4].WriteByte(t[o][r].val.length);break;case 8:case 9:e[t[o][r].type].WriteByte(t[o][r].val)}}function h(e,t,r,n){for(var a=0;a<=12;a++)if(!(e[a].pos<=0)){n.WriteByte(a+(0==a?128:0)),e[a]=e[a].buf.slice(0,e[a].pos);var i=l(e[a],r);n.WriteUint7(i.length),n.WriteData(i,i.length)}}function l(e,t){var r,n=1<<30,a=[0,1,64,65,128,129,201];for(var i in a){var c=a[i];if(!(1&c&&e.length<100)&&!(8&c&&e.length%4!=0)){try{var u=t?s.encode(e,c):o.encode(e,c)}catch(f){u=0}u&&n>u.length&&(n=u.length,r=u)}}return r}function d(e,t,r,n,a){var i=0,o=a-1;e[a]=new Array(256),t[n]?e[a][0]={type:5,val:a-t[n]}:e[a][0]={type:6,val:0==a?0:1},t[n]=a;for(var s=n.match(/([a-zA-Z0-9]{1,9})|([^a-zA-Z0-9]+)/g),c=0;c<s.length;c++){var u=c+1,f=1,h=s[c];if(s[c].match(/^0+[0-9]*$/g)?f=3:s[c].match(/^[0-9]+$/g)?f=7:1==s[c].length&&(f=2),o>=0&&e[o][u])if(e[o][u].str==s[c])f=10,h="";else if(7==e[o][u].type||8==e[o][u].type){var l=h-e[o][u].str;r[u]++,l>=0&&l<256&&r[u]>a/2&&(f=8,h=l)}else if((3==e[o][u].type||9==e[o][u].type)&&e[o][u].str.length==h.length){l=h-e[o][u].str;r[u]++,l>=0&&l<256&&r[u]>a/2&&(f=9,h=l)}e[a][u]={str:s[c],val:h,type:f},i<e[a][u].val.length+3&&(i=e[a][u].val.length+3)}return e[a][++u]={type:12},[u+1,i]}e.exports={encode:function(e,t){var r=e.toString();"\n"==r[r.length-1]&&(r=r.substring(0,r.length-1));var n=r.split("\n"),o=new i("",0,2*r.length+1e4);o.WriteUint32(r.length),o.WriteUint32(n.length),o.WriteByte(t);for(var s=new Array(n.length),c={},u=new Array(256).fill(0),l=0,p=0,v=0;v<n.length;v++){var y=d(s,c,u,n[v],v),g=a(y,2),m=g[0],b=g[1];l<m&&(l=m),p<b&&(p=b)}for(var w=0;w<l;w++){for(var k=new Array(13),A=0;A<=12;A++)k[A]=new i("",0,n.length*p);f(k,s,w,n,l,p),h(k,w,t,o)}return o.buf.slice(0,o.pos)},decode:function(e,t,r){(e=new i(e)).ReadUint32();var a=e.ReadUint32(),c=e.ReadByte(),f=function(e,t,r,a){for(var c=-1,u=new Array(256);!e.EOF();){var f=e.ReadByte(),h=128&f,l=64&f,d=63&f;if(h&&(u[++c]=new Array(13)),0!=d&&h){var p=new Array(a-1).fill(10);u[c][0]=new i(n.from([d].concat(p)))}if(l){var v=e.ReadByte(),y=e.ReadByte();u[c][d]=new i(u[v][y].buf)}else{var g=e.ReadUint7(),m=e.ReadData(g);u[c][d]=r?s.decode(m):o.decode(m),u[c][d]=new i(u[c][d])}}return u}(e,0,c,a),h=new Array(a),l=new Array(a),d="";"undefined"===typeof r&&(r="\n");for(var p=0;p<a;p++)d+=u(f,h,l,p)+r;return d}}},28313:function(e,t,r){"use strict";var n=r(50085).default,a=r(15198).default,i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(28909),s=i(r(32984)),c=i(r(77088)),u=function(){function e(t){var r=t.fill,a=t.cache;if(n(this,e),"function"!==typeof r)throw new TypeError("must pass a fill function");if("object"!==typeof a)throw new TypeError("must pass a cache object");if("function"!==typeof a.get||"function"!==typeof a.set||"function"!==typeof a.delete)throw new TypeError("cache must implement get(key), set(key, val), and and delete(key)");this.cache=a,this.fillCallback=r}return a(e,[{key:"evict",value:function(e,t){this.cache.get(e)===t&&this.cache.delete(e)}},{key:"fill",value:function(e,t,r,n){var a=this,i=new s.default,o=new c.default;o.addCallback(n);var u={aborter:i,promise:this.fillCallback(t,i.signal,(function(e){o.callback(e)})),settled:!1,statusReporter:o,get aborted(){return this.aborter.signal.aborted}};u.aborter.addSignal(r),u.aborter.signal.addEventListener("abort",(function(){u.settled||a.evict(e,u)})),u.promise.then((function(){u.settled=!0}),(function(){u.settled=!0,a.evict(e,u)})).catch((function(e){throw console.error(e),e})),this.cache.set(e,u)}},{key:"has",value:function(e){return this.cache.has(e)}},{key:"get",value:function(t,r,n,a){if(!n&&r instanceof o.AbortSignal)throw new TypeError("second get argument appears to be an AbortSignal, perhaps you meant to pass `null` for the fill data?");var i=this.cache.get(t);return i?i.aborted&&!i.settled?(this.evict(t,i),this.get(t,r,n,a)):i.settled?i.promise:(i.aborter.addSignal(n),i.statusReporter.addCallback(a),e.checkSinglePromise(i.promise,n)):(this.fill(t,r,n,a),e.checkSinglePromise(this.cache.get(t).promise,n))}},{key:"delete",value:function(e){var t=this.cache.get(e);t&&(t.settled||t.aborter.abort(),this.cache.delete(e))}},{key:"clear",value:function(){for(var e=this.cache.keys(),t=0,r=e.next();!r.done;r=e.next())this.delete(r.value),t+=1;return t}}],[{key:"isAbortException",value:function(e){return"AbortError"===e.name||"ERR_ABORTED"===e.code||"AbortError: aborted"===e.message||"Error: aborted"===e.message}},{key:"checkSinglePromise",value:function(e,t){function r(){if(t&&t.aborted)throw Object.assign(new Error("aborted"),{code:"ERR_ABORTED"})}return e.then((function(e){return r(),e}),(function(e){throw r(),e}))}}]),e}();t.default=u},32984:function(e,t,r){"use strict";var n=r(15198).default,a=r(50085).default;Object.defineProperty(t,"__esModule",{value:!0});var i=r(28909),o=n((function e(){a(this,e)})),s=function(){function e(){a(this,e),this.signals=new Set,this.abortController=new i.AbortController}return n(e,[{key:"addSignal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new o;if(this.signal.aborted)throw new Error("cannot add a signal, already aborted!");this.signals.add(t),t.aborted?this.handleAborted(t):"function"===typeof t.addEventListener&&t.addEventListener("abort",(function(){e.handleAborted(t)}))}},{key:"handleAborted",value:function(e){this.signals.delete(e),0===this.signals.size&&this.abortController.abort()}},{key:"signal",get:function(){return this.abortController.signal}},{key:"abort",value:function(){this.abortController.abort()}}]),e}();t.default=s},77088:function(e,t,r){"use strict";var n=r(50085).default,a=r(15198).default;Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){n(this,e),this.callbacks=new Set}return a(e,[{key:"addCallback",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this.callbacks.add(e),e(this.currentMessage)}},{key:"callback",value:function(e){this.currentMessage=e,this.callbacks.forEach((function(t){t(e)}))}}]),e}();t.default=i},28909:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbortSignal=t.AbortController=void 0;var n=r(82741),a=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof r.g)return r.g;throw new Error("unable to locate global object")},i="undefined"===typeof a().AbortController?n.AbortController:a().AbortController;t.AbortController=i;var o="undefined"===typeof a().AbortController?n.AbortSignal:a().AbortSignal;t.AbortSignal=o},89410:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(r(28313));t.default=a.default},46883:function(e){var t={array:function(e){var t=0,r=0,n=[0,1,3,7,15,31,63,127,255];return function(a){for(var i=0;a>0;){var o=8-t;a>=o?(i<<=o,i|=n[o]&e[r++],t=0,a-=o):(i<<=a,i|=(e[r]&n[a]<<8-a-t)>>8-a-t,t+=a,a=0)}return i}},simple:function(e){var r,n,a=t.header(e),i=[],o=0;do{-1!=(n=t.decompress(e,a))&&(i.push(n),o+=n.byteLength)}while(-1!=n);r=new Uint8Array(o),o=0;for(var s=0;s<i.length;++s)n=i[s],r.set(n,o),o+=n.byteLength;return r},header:function(e){if(4348520!=e(24))throw"No magic number found";var t=e(8)-48;if(t<1||t>9)throw"Not a BZIP archive";return t},decompress:function(e,t,r){for(var n=9e5,a="",i=0;i<6;i++)a+=e(8).toString(16);if("177245385090"==a)return-1;if("314159265359"!=a)throw"eek not valid bzip data";if(e(32),e(1))throw"unsupported obsolete version";var o=e(24);if(o>n)throw"Initial position larger than buffer size";var s=e(16),c=new Uint8Array(256),u=0;for(i=0;i<16;i++)if(s&1<<15-i){var f=e(16);for(v=0;v<16;v++)f&1<<15-v&&(c[u++]=16*i+v)}var h=e(3);if(h<2||h>6)throw"another error";var l=e(15);if(0==l)throw"meh";var d=[];for(i=0;i<h;i++)d[i]=i;var p=new Uint8Array(32768);for(i=0;i<l;i++){for(var v=0;e(1);v++)if(v>=h)throw"whoops another error";var y=d[v];d.splice(v,1),d.splice(0,0,y),p[i]=y}var g=u+2,m=[];for(v=0;v<h;v++){var b,w,k,A=new Uint8Array(258),S=new Uint8Array(21);s=e(5);for(i=0;i<g;i++){for(;;){if(s<1||s>20)throw"I gave up a while ago on writing error messages";if(!e(1))break;e(1)?s--:s++}A[i]=s}b=w=A[0];for(i=1;i<g;i++)A[i]>w?w=A[i]:A[i]<b&&(b=A[i]);(k=m[v]={}).permute=new Uint32Array(258),k.limit=new Uint32Array(21),k.base=new Uint32Array(21),k.minLen=b,k.maxLen=w;var _=k.base.subarray(1),x=k.limit.subarray(1),B=0;for(i=b;i<=w;i++)for(s=0;s<g;s++)A[s]==i&&(k.permute[B++]=s);for(i=b;i<=w;i++)S[i]=x[i]=0;for(i=0;i<g;i++)S[A[i]]++;for(B=s=0,i=b;i<w;i++)B+=S[i],x[i]=B-1,B<<=1,_[i+1]=B-(s+=S[i]);x[w]=B+S[w]-1,_[b]=0}var R,C,E,M=new Uint32Array(256);for(i=0;i<256;i++)d[i]=i;R=C=g=E=0;for(var F=new Uint32Array(n);;){if(!g--){if(g=49,E>=l)throw"meow i'm a kitty, that's an error";_=(k=m[p[E++]]).base.subarray(1),x=k.limit.subarray(1)}for(v=e(i=k.minLen);;){if(i>k.maxLen)throw"rawr i'm a dinosaur";if(v<=x[i])break;i++,v=v<<1|e(1)}if((v-=_[i])<0||v>=258)throw"moo i'm a cow";var I=k.permute[v];if(0!=I&&1!=I){if(R){if(R=0,C+s>=n)throw"Boom.";for(M[y=c[d[0]]]+=s;s--;)F[C++]=y}if(I>u)break;if(C>=n)throw"I can't think of anything. Error";y=d[i=I-1],d.splice(i,1),d.splice(0,0,y),M[y=c[y]]++,F[C++]=y}else R||(R=1,s=0),s+=0==I?R:2*R,R<<=1}if(o<0||o>=C)throw"I'm a monkey and I'm throwing something at someone, namely you";for(v=0,i=0;i<256;i++)f=v+M[i],M[i]=v,v=f;for(i=0;i<C;i++)F[M[y=255&F[i]]]|=i<<8,M[y]++;var Z=0,U=0,P=0;C&&(U=255&(Z=F[o]),Z>>=8,P=-1);var q,D,L,T=new Uint8Array(n),N=0;for(r||(r=1/0);C;){for(C--,D=U,U=255&(Z=F[Z]),Z>>=8,3==P++?(q=U,L=D,U=-1):(q=1,L=U);q--;)if(T[N++]=L,!--r)return T;U!=D&&(P=0)}return T.subarray(0,N)}};e.exports=t},68160:function(e){var t={utf8:{stringToBytes:function(e){return t.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(t.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t},bytesToString:function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")}}};e.exports=t},66344:function(e,t){var r="undefined"!==typeof self?self:this,n=function(){function e(){this.fetch=!1,this.DOMException=r.DOMException}return e.prototype=r,new e}();!function(e){!function(t){var r="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,a="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in e,o="ArrayBuffer"in e;if(o)var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&s.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!==typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function f(e){return"string"!==typeof e&&(e=String(e)),e}function h(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function l(e){this.map={},e instanceof l?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function d(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function v(e){var t=new FileReader,r=p(t);return t.readAsArrayBuffer(e),r}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"===typeof e?this._bodyText=e:a&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:i&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():o&&a&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"===typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var e=d(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?d(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(v)}),this.text=function(){var e=d(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,r=p(t);return t.readAsText(e),r}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}l.prototype.append=function(e,t){e=u(e),t=f(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},l.prototype.delete=function(e){delete this.map[u(e)]},l.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},l.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},l.prototype.set=function(e,t){this.map[u(e)]=f(t)},l.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},l.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),h(e)},l.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),h(e)},l.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),h(e)},n&&(l.prototype[Symbol.iterator]=l.prototype.entries);var m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(e,t){var r=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new l(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new l(t.headers)),this.method=function(e){var t=e.toUpperCase();return m.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function w(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),a=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(a))}})),t}function k(e){var t=new l;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var a=r.join(":").trim();t.append(n,a)}})),t}function A(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new l(t.headers),this.url=t.url||"",this._initBody(e)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},g.call(b.prototype),g.call(A.prototype),A.prototype.clone=function(){return new A(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},A.error=function(){var e=new A(null,{status:0,statusText:""});return e.type="error",e};var S=[301,302,303,307,308];A.redirect=function(e,t){if(-1===S.indexOf(t))throw new RangeError("Invalid status code");return new A(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(x){t.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function _(e,r){return new Promise((function(n,i){var o=new b(e,r);if(o.signal&&o.signal.aborted)return i(new t.DOMException("Aborted","AbortError"));var s=new XMLHttpRequest;function c(){s.abort()}s.onload=function(){var e={status:s.status,statusText:s.statusText,headers:k(s.getAllResponseHeaders()||"")};e.url="responseURL"in s?s.responseURL:e.headers.get("X-Request-URL");var t="response"in s?s.response:s.responseText;n(new A(t,e))},s.onerror=function(){i(new TypeError("Network request failed"))},s.ontimeout=function(){i(new TypeError("Network request failed"))},s.onabort=function(){i(new t.DOMException("Aborted","AbortError"))},s.open(o.method,o.url,!0),"include"===o.credentials?s.withCredentials=!0:"omit"===o.credentials&&(s.withCredentials=!1),"responseType"in s&&a&&(s.responseType="blob"),o.headers.forEach((function(e,t){s.setRequestHeader(t,e)})),o.signal&&(o.signal.addEventListener("abort",c),s.onreadystatechange=function(){4===s.readyState&&o.signal.removeEventListener("abort",c)}),s.send("undefined"===typeof o._bodyInit?null:o._bodyInit)}))}_.polyfill=!0,e.fetch||(e.fetch=_,e.Headers=l,e.Request=b,e.Response=A),t.Headers=l,t.Request=b,t.Response=A,t.fetch=_,Object.defineProperty(t,"__esModule",{value:!0})}({})}(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var a=n;(t=a.fetch).default=a.fetch,t.fetch=a.fetch,t.Headers=a.Headers,t.Request=a.Request,t.Response=a.Response,e.exports=t},29016:function(e){!function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&r.rotl(e,8)|4278255360&r.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=r.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],r=0,n=0;r<e.length;r++,n+=8)t[n>>>5]|=e[r]<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],r=0;r<32*e.length;r+=8)t.push(e[r>>>5]>>>24-r%32&255);return t},bytesToHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push((e[r]>>>4).toString(16)),t.push((15&e[r]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},bytesToBase64:function(e){for(var r=[],n=0;n<e.length;n+=3)for(var a=e[n]<<16|e[n+1]<<8|e[n+2],i=0;i<4;i++)8*n+6*i<=8*e.length?r.push(t.charAt(a>>>6*(3-i)&63)):r.push("=");return r.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var r=[],n=0,a=0;n<e.length;a=++n%4)0!=a&&r.push((t.indexOf(e.charAt(n-1))&Math.pow(2,-2*a+8)-1)<<2*a|t.indexOf(e.charAt(n))>>>6-2*a);return r}};e.exports=r}()},34635:function(e){function t(e){return!!e.constructor&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(t(e)||function(e){return"function"===typeof e.readFloatLE&&"function"===typeof e.slice&&t(e.slice(0,0))}(e)||!!e._isBuffer)}},16318:function(e,t,r){!function(){var t=r(29016),n=r(68160).utf8,a=r(34635),i=r(68160).bin,o=function e(r,o){r.constructor==String?r=o&&"binary"===o.encoding?i.stringToBytes(r):n.stringToBytes(r):a(r)?r=Array.prototype.slice.call(r,0):Array.isArray(r)||r.constructor===Uint8Array||(r=r.toString());for(var s=t.bytesToWords(r),c=8*r.length,u=1732584193,f=-271733879,h=-1732584194,l=271733878,d=0;d<s.length;d++)s[d]=16711935&(s[d]<<8|s[d]>>>24)|4278255360&(s[d]<<24|s[d]>>>8);s[c>>>5]|=128<<c%32,s[14+(c+64>>>9<<4)]=c;var p=e._ff,v=e._gg,y=e._hh,g=e._ii;for(d=0;d<s.length;d+=16){var m=u,b=f,w=h,k=l;u=p(u,f,h,l,s[d+0],7,-680876936),l=p(l,u,f,h,s[d+1],12,-389564586),h=p(h,l,u,f,s[d+2],17,606105819),f=p(f,h,l,u,s[d+3],22,-1044525330),u=p(u,f,h,l,s[d+4],7,-176418897),l=p(l,u,f,h,s[d+5],12,1200080426),h=p(h,l,u,f,s[d+6],17,-1473231341),f=p(f,h,l,u,s[d+7],22,-45705983),u=p(u,f,h,l,s[d+8],7,1770035416),l=p(l,u,f,h,s[d+9],12,-1958414417),h=p(h,l,u,f,s[d+10],17,-42063),f=p(f,h,l,u,s[d+11],22,-1990404162),u=p(u,f,h,l,s[d+12],7,1804603682),l=p(l,u,f,h,s[d+13],12,-40341101),h=p(h,l,u,f,s[d+14],17,-1502002290),u=v(u,f=p(f,h,l,u,s[d+15],22,1236535329),h,l,s[d+1],5,-165796510),l=v(l,u,f,h,s[d+6],9,-1069501632),h=v(h,l,u,f,s[d+11],14,643717713),f=v(f,h,l,u,s[d+0],20,-373897302),u=v(u,f,h,l,s[d+5],5,-701558691),l=v(l,u,f,h,s[d+10],9,38016083),h=v(h,l,u,f,s[d+15],14,-660478335),f=v(f,h,l,u,s[d+4],20,-405537848),u=v(u,f,h,l,s[d+9],5,568446438),l=v(l,u,f,h,s[d+14],9,-1019803690),h=v(h,l,u,f,s[d+3],14,-187363961),f=v(f,h,l,u,s[d+8],20,1163531501),u=v(u,f,h,l,s[d+13],5,-1444681467),l=v(l,u,f,h,s[d+2],9,-51403784),h=v(h,l,u,f,s[d+7],14,1735328473),u=y(u,f=v(f,h,l,u,s[d+12],20,-1926607734),h,l,s[d+5],4,-378558),l=y(l,u,f,h,s[d+8],11,-2022574463),h=y(h,l,u,f,s[d+11],16,1839030562),f=y(f,h,l,u,s[d+14],23,-35309556),u=y(u,f,h,l,s[d+1],4,-1530992060),l=y(l,u,f,h,s[d+4],11,1272893353),h=y(h,l,u,f,s[d+7],16,-155497632),f=y(f,h,l,u,s[d+10],23,-1094730640),u=y(u,f,h,l,s[d+13],4,681279174),l=y(l,u,f,h,s[d+0],11,-358537222),h=y(h,l,u,f,s[d+3],16,-722521979),f=y(f,h,l,u,s[d+6],23,76029189),u=y(u,f,h,l,s[d+9],4,-640364487),l=y(l,u,f,h,s[d+12],11,-421815835),h=y(h,l,u,f,s[d+15],16,530742520),u=g(u,f=y(f,h,l,u,s[d+2],23,-995338651),h,l,s[d+0],6,-198630844),l=g(l,u,f,h,s[d+7],10,1126891415),h=g(h,l,u,f,s[d+14],15,-1416354905),f=g(f,h,l,u,s[d+5],21,-57434055),u=g(u,f,h,l,s[d+12],6,1700485571),l=g(l,u,f,h,s[d+3],10,-1894986606),h=g(h,l,u,f,s[d+10],15,-1051523),f=g(f,h,l,u,s[d+1],21,-2054922799),u=g(u,f,h,l,s[d+8],6,1873313359),l=g(l,u,f,h,s[d+15],10,-30611744),h=g(h,l,u,f,s[d+6],15,-1560198380),f=g(f,h,l,u,s[d+13],21,1309151649),u=g(u,f,h,l,s[d+4],6,-145523070),l=g(l,u,f,h,s[d+11],10,-1120210379),h=g(h,l,u,f,s[d+2],15,718787259),f=g(f,h,l,u,s[d+9],21,-343485551),u=u+m>>>0,f=f+b>>>0,h=h+w>>>0,l=l+k>>>0}return t.endian([u,f,h,l])};o._ff=function(e,t,r,n,a,i,o){var s=e+(t&r|~t&n)+(a>>>0)+o;return(s<<i|s>>>32-i)+t},o._gg=function(e,t,r,n,a,i,o){var s=e+(t&n|r&~n)+(a>>>0)+o;return(s<<i|s>>>32-i)+t},o._hh=function(e,t,r,n,a,i,o){var s=e+(t^r^n)+(a>>>0)+o;return(s<<i|s>>>32-i)+t},o._ii=function(e,t,r,n,a,i,o){var s=e+(r^(t|~n))+(a>>>0)+o;return(s<<i|s>>>32-i)+t},o._blocksize=16,o._digestsize=16,e.exports=function(e,r){if(void 0===e||null===e)throw new Error("Illegal argument "+e);var n=t.wordsToBytes(o(e,r));return r&&r.asBytes?n:r&&r.asString?i.bytesToString(n):t.bytesToHex(n)}}()}}]);
//# sourceMappingURL=6925.ccdf122d.chunk.js.map