{"version":3,"file":"static/js/8320.8cbda464.chunk.js","mappings":"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","sources":["../../../plugins/legacy-jbrowse/src/JBrowse1Connection/jb1ToJb2.ts"],"sourcesContent":["import { openLocation } from '@jbrowse/core/util/io'\nimport { objectHash } from '@jbrowse/core/util'\nimport {\n  generateUnknownTrackConf,\n  generateUnsupportedTrackConf,\n  guessAdapter,\n  guessTrackType,\n  UNKNOWN,\n  UNSUPPORTED,\n} from '@jbrowse/core/util/tracks'\nimport { Track, RefSeqs, RefSeq } from './types'\n\ninterface Jb2Track {\n  trackId: string\n  name: string\n  description?: string\n  category?: string[]\n  adapter?: Jb2Adapter\n  type?: string\n  defaultRendering?: string\n}\n\ninterface Jb2Adapter {\n  type: string\n  features?: Jb2Feature[]\n  bamLocation?: Jb2Location\n  cramLocation?: Jb2Location\n  craiLocation?: Jb2Location\n  fastaLocation?: Jb2Location\n  faiLocation?: Jb2Location\n  gziLocation?: Jb2Location\n  twoBitLocation?: Jb2Location\n  bigWigLocation?: Jb2Location\n  bigBedLocation?: Jb2Location\n  vcfGzLocation?: Jb2Location\n  gffLocation?: Jb2Location\n  gffGzLocation?: Jb2Location\n  gtfLocation?: Jb2Location\n  bedGzLocation?: Jb2Location\n  index?: { location: Jb2Location; indexType?: string }\n  rootUrlTemplate?: Jb2Location\n  sequenceAdapter?: Jb2Adapter\n}\n\ninterface Jb2Feature {\n  refName: string\n  uniqueId: string\n  start: number\n  end: number\n}\n\ninterface Jb2Location {\n  uri?: string\n  localPath?: string\n  blobId?: string\n  locationType?: string\n}\n\nexport function convertTrackConfig(\n  jb1TrackConfig: Track,\n  dataRoot: string,\n  sequenceAdapter: Jb2Adapter,\n): Jb2Track {\n  const jb2TrackConfig: Jb2Track = {\n    trackId: objectHash(jb1TrackConfig),\n    name: jb1TrackConfig.key || jb1TrackConfig.label,\n  }\n\n  const description =\n    jb1TrackConfig.metadata &&\n    (jb1TrackConfig.metadata.description || jb1TrackConfig.metadata.Description)\n  if (description) {\n    jb2TrackConfig.description = description\n  }\n\n  const category =\n    jb1TrackConfig.category ||\n    (jb1TrackConfig.metadata && jb1TrackConfig.metadata.category)\n  jb2TrackConfig.category = category ? category.split(/\\s*\\/\\s*/) : []\n\n  const { storeClass } = jb1TrackConfig\n  if (!jb1TrackConfig.urlTemplate) {\n    if (!(storeClass && storeClass.endsWith('FromConfig'))) {\n      const trackIdentifier = jb1TrackConfig.key || jb1TrackConfig.label\n      console.warn(\n        `Could not import JBrowse1 track \"${trackIdentifier}\" because it does not have a \"urlTemplate\" or is not a \"FromConfig\" track`,\n      )\n      return generateUnsupportedTrackConf(\n        jb2TrackConfig.name,\n        trackIdentifier,\n        jb2TrackConfig.category,\n      )\n    }\n    return generateFromConfigTrackConfig(jb1TrackConfig, jb2TrackConfig)\n  }\n\n  const resolveUrlTemplate = (urlTemplate: string) => {\n    return new URL(urlTemplate, `${dataRoot}/`).href\n      .replaceAll(/%7B/gi, '{')\n      .replaceAll(/%7D/gi, '}')\n  }\n  const urlTemplate = resolveUrlTemplate(jb1TrackConfig.urlTemplate)\n\n  if (storeClass) {\n    if (storeClass === 'JBrowse/Store/SeqFeature/BAM') {\n      const adapter: Jb2Adapter = {\n        type: 'BamAdapter',\n        bamLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n      }\n      if (jb1TrackConfig.baiUrlTemplate) {\n        adapter.index = {\n          location: {\n            uri: resolveUrlTemplate(jb1TrackConfig.baiUrlTemplate),\n            locationType: 'UriLocation',\n          },\n        }\n      } else if (jb1TrackConfig.csiUrlTemplate) {\n        adapter.index = {\n          location: {\n            uri: resolveUrlTemplate(jb1TrackConfig.csiUrlTemplate),\n            locationType: 'UriLocation',\n          },\n          indexType: 'CSI',\n        }\n      } else {\n        adapter.index = {\n          location: { uri: `${urlTemplate}.bai`, locationType: 'UriLocation' },\n        }\n      }\n      return {\n        ...jb2TrackConfig,\n        type: 'AlignmentsTrack',\n        adapter,\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/CRAM') {\n      const adapter: Jb2Adapter = {\n        type: 'CramAdapter',\n        cramLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n        sequenceAdapter,\n      }\n      adapter.craiLocation = jb1TrackConfig.craiUrlTemplate\n        ? {\n            uri: resolveUrlTemplate(jb1TrackConfig.craiUrlTemplate),\n            locationType: 'UriLocation',\n          }\n        : {\n            uri: `${urlTemplate}.crai`,\n            locationType: 'UriLocation',\n          }\n      return {\n        ...jb2TrackConfig,\n        type: 'AlignmentsTrack',\n        adapter,\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/NCList') {\n      return {\n        ...jb2TrackConfig,\n        type: 'FeatureTrack',\n        adapter: {\n          type: 'NCListAdapter',\n          rootUrlTemplate: { uri: urlTemplate, locationType: 'UriLocation' },\n        },\n      }\n    }\n    if (\n      storeClass === 'JBrowse/Store/SeqFeature/BigWig' ||\n      storeClass === 'JBrowse/Store/BigWig'\n    ) {\n      if (jb1TrackConfig.type && jb1TrackConfig.type.endsWith('XYPlot')) {\n        jb2TrackConfig.defaultRendering = 'xyplot'\n      } else if (\n        jb1TrackConfig.type &&\n        jb1TrackConfig.type.endsWith('Density')\n      ) {\n        jb2TrackConfig.defaultRendering = 'density'\n      }\n      return {\n        ...jb2TrackConfig,\n        type: 'QuantitativeTrack',\n        adapter: {\n          type: 'BigWigAdapter',\n          bigWigLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n        },\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/VCFTabix') {\n      const adapter: Jb2Adapter = {\n        type: 'VcfTabixAdapter',\n        vcfGzLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n      }\n      if (jb1TrackConfig.tbiUrlTemplate) {\n        adapter.index = {\n          location: {\n            uri: resolveUrlTemplate(jb1TrackConfig.tbiUrlTemplate),\n            locationType: 'UriLocation',\n          },\n        }\n      } else if (jb1TrackConfig.csiUrlTemplate) {\n        adapter.index = {\n          location: {\n            uri: resolveUrlTemplate(jb1TrackConfig.csiUrlTemplate),\n            locationType: 'UriLocation',\n          },\n          indexType: 'CSI',\n        }\n      } else {\n        adapter.index = {\n          location: { uri: `${urlTemplate}.tbi`, locationType: 'UriLocation' },\n        }\n      }\n      return {\n        ...jb2TrackConfig,\n        type: 'VariantTrack',\n        adapter,\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/VCFTribble') {\n      return generateUnsupportedTrackConf(\n        jb2TrackConfig.name,\n        `VCFTribble (${urlTemplate})`,\n        jb2TrackConfig.category,\n      )\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/GFF3') {\n      return {\n        ...jb2TrackConfig,\n        type: 'FeatureTrack',\n        adapter: {\n          type: 'Gff3Adapter',\n          gffLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n        },\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/BigBed') {\n      return {\n        ...jb2TrackConfig,\n        type: 'FeatureTrack',\n        adapter: {\n          type: 'BigBedAdapter',\n          bigBedLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n        },\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/GFF3Tabix') {\n      const adapter: Jb2Adapter = {\n        type: 'Gff3TabixAdapter',\n        gffGzLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n      }\n      if (jb1TrackConfig.tbiUrlTemplate) {\n        adapter.index = {\n          location: {\n            uri: resolveUrlTemplate(jb1TrackConfig.tbiUrlTemplate),\n            locationType: 'UriLocation',\n          },\n        }\n      } else if (jb1TrackConfig.csiUrlTemplate) {\n        adapter.index = {\n          location: {\n            uri: resolveUrlTemplate(jb1TrackConfig.csiUrlTemplate),\n            locationType: 'UriLocation',\n          },\n          indexType: 'CSI',\n        }\n      } else {\n        adapter.index = {\n          location: { uri: `${urlTemplate}.tbi`, locationType: 'UriLocation' },\n        }\n      }\n      return {\n        ...jb2TrackConfig,\n        type: 'FeatureTrack',\n        adapter,\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/BED') {\n      return generateUnsupportedTrackConf(\n        jb2TrackConfig.name,\n        `BED (${urlTemplate})`,\n        jb2TrackConfig.category,\n      )\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/BEDTabix') {\n      const adapter: Jb2Adapter = {\n        type: 'BedTabixAdapter',\n        bedGzLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n      }\n      if (jb1TrackConfig.tbiUrlTemplate) {\n        adapter.index = {\n          location: {\n            uri: resolveUrlTemplate(jb1TrackConfig.tbiUrlTemplate),\n            locationType: 'UriLocation',\n          },\n        }\n      } else if (jb1TrackConfig.csiUrlTemplate) {\n        adapter.index = {\n          location: {\n            uri: resolveUrlTemplate(jb1TrackConfig.csiUrlTemplate),\n            locationType: 'UriLocation',\n          },\n          indexType: 'CSI',\n        }\n      } else {\n        adapter.index = {\n          location: { uri: `${urlTemplate}.tbi`, locationType: 'UriLocation' },\n        }\n      }\n      return {\n        ...jb2TrackConfig,\n        type: 'FeatureTrack',\n        adapter,\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/GTF') {\n      return {\n        ...jb2TrackConfig,\n        type: 'FeatureTrack',\n        adapter: {\n          type: 'GtfAdapter',\n          gtfLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n        },\n      }\n    }\n    if (\n      storeClass === 'JBrowse/Store/SeqFeature/StaticChunked' ||\n      storeClass === 'JBrowse/Store/Sequence/StaticChunked'\n    ) {\n      return generateUnsupportedTrackConf(\n        jb2TrackConfig.name,\n        `StaticChunked (${urlTemplate})`,\n        jb2TrackConfig.category,\n      )\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/UnindexedFasta') {\n      return generateUnsupportedTrackConf(\n        jb2TrackConfig.name,\n        `UnindexedFasta (${urlTemplate})`,\n        jb2TrackConfig.category,\n      )\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/IndexedFasta') {\n      const adapter: Jb2Adapter = {\n        type: 'IndexedFastaAdapter',\n        fastaLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n      }\n      adapter.faiLocation = jb1TrackConfig.faiUrlTemplate\n        ? {\n            uri: resolveUrlTemplate(jb1TrackConfig.faiUrlTemplate),\n            locationType: 'UriLocation',\n          }\n        : {\n            uri: `${urlTemplate}.fai`,\n            locationType: 'UriLocation',\n          }\n      return {\n        ...jb2TrackConfig,\n        type: 'SequenceTrack',\n        adapter,\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/BgzipIndexedFasta') {\n      const adapter: Jb2Adapter = {\n        type: 'BgzipFastaAdapter',\n        fastaLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n      }\n      adapter.faiLocation = jb1TrackConfig.faiUrlTemplate\n        ? {\n            uri: resolveUrlTemplate(jb1TrackConfig.faiUrlTemplate),\n            locationType: 'UriLocation',\n          }\n        : {\n            uri: `${urlTemplate}.fai`,\n            locationType: 'UriLocation',\n          }\n      adapter.gziLocation = jb1TrackConfig.gziUrlTemplate\n        ? {\n            uri: resolveUrlTemplate(jb1TrackConfig.gziUrlTemplate),\n            locationType: 'UriLocation',\n          }\n        : {\n            uri: `${urlTemplate}.gzi`,\n            locationType: 'UriLocation',\n          }\n      return {\n        ...jb2TrackConfig,\n        type: 'ReferenceSequenceTrack',\n        adapter,\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/TwoBit') {\n      return {\n        ...jb2TrackConfig,\n        type: 'ReferenceSequenceTrack',\n        adapter: {\n          type: 'TwoBitAdapter',\n          twoBitLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n        },\n      }\n    }\n  }\n\n  // If we don't recognize the store class, make a best effort to guess by file type\n  jb2TrackConfig.adapter = guessAdapter(\n    { uri: urlTemplate, locationType: 'UriLocation' },\n    undefined,\n    urlTemplate,\n  )\n  if (!jb2TrackConfig.adapter) {\n    throw new Error('Could not determine adapter')\n  }\n\n  if (jb2TrackConfig.adapter.type === UNSUPPORTED) {\n    return generateUnsupportedTrackConf(\n      jb2TrackConfig.name,\n      urlTemplate,\n      jb2TrackConfig.category,\n    )\n  }\n  if (jb2TrackConfig.adapter.type === UNKNOWN) {\n    return generateUnknownTrackConf(\n      jb2TrackConfig.name,\n      urlTemplate,\n      jb2TrackConfig.category,\n    )\n  }\n\n  jb2TrackConfig.type = guessTrackType(jb2TrackConfig.adapter.type)\n\n  if (jb2TrackConfig.type === 'QuantitativeTrack') {\n    if (jb1TrackConfig.type && jb1TrackConfig.type.endsWith('XYPlot')) {\n      jb2TrackConfig.defaultRendering = 'xyplot'\n    } else if (jb1TrackConfig.type && jb1TrackConfig.type.endsWith('Density')) {\n      jb2TrackConfig.defaultRendering = 'density'\n    }\n  }\n\n  return jb2TrackConfig\n}\n\nfunction generateFromConfigTrackConfig(\n  jb1TrackConfig: Track,\n  jb2TrackConfig: Jb2Track,\n): Jb2Track {\n  const jb1Features = jb1TrackConfig.features || []\n  const jb2Features = jb1Features.map((feature): Jb2Feature => {\n    const jb2Feature: Jb2Feature = JSON.parse(JSON.stringify(feature))\n    jb2Feature.refName = feature.seq_id\n    jb2Feature.uniqueId = `${feature.seq_id}:${feature.start}-${feature.end}:${\n      feature.name || ''\n    }`\n    return jb2Feature\n  })\n  jb2TrackConfig.adapter = {\n    type: 'FromConfigAdapter',\n    features: jb2Features,\n  }\n  jb2TrackConfig.type = 'FeatureTrack'\n  return jb2TrackConfig\n}\n\nexport async function createRefSeqsAdapter(\n  refSeqs: string | RefSeqs,\n): Promise<Jb2Adapter> {\n  if (typeof refSeqs === 'string') {\n    // assume refSeqs is a url if it is string\n    refSeqs = {\n      url: refSeqs,\n    }\n  }\n\n  // check refseq urls\n  if (refSeqs.url) {\n    if (refSeqs.url.match(/.fai$/)) {\n      return {\n        type: 'IndexedFastaAdapter',\n        fastaLocation: {\n          uri: refSeqs.url.slice(0, -4),\n          locationType: 'UriLocation',\n        },\n        faiLocation: {\n          uri: refSeqs.url,\n          locationType: 'UriLocation',\n        },\n      }\n    }\n    if (refSeqs.url.match(/.2bit$/)) {\n      return {\n        type: 'TwoBitAdapter',\n        twoBitLocation: { uri: refSeqs.url, locationType: 'UriLocation' },\n      }\n    }\n    if (refSeqs.url.match(/.fa$/)) {\n      throw new Error('Unindexed FASTA adapter not available')\n    }\n    if (refSeqs.url.match(/.sizes/)) {\n      throw new Error('chromosome SIZES adapter not available')\n    }\n    const refSeqsJson = await openLocation({\n      uri: refSeqs.url,\n      locationType: 'UriLocation',\n    }).readFile('utf8')\n    const refSeqsData: RefSeq[] = JSON.parse(refSeqsJson)\n    return refSeqAdapterFromConfig(refSeqsData)\n  }\n  if ('data' in refSeqs) {\n    return refSeqAdapterFromConfig(refSeqs.data || [])\n  }\n  throw new Error(\n    `Could not determine adapter for JBrowse1 refSeqs: ${\n      refSeqs.url || JSON.stringify(refSeqs)\n    }`,\n  )\n}\n\nfunction refSeqAdapterFromConfig(refSeqsData: RefSeq[]): Jb2Adapter {\n  const features = refSeqsData.map(\n    (refSeq): Jb2Feature => ({\n      refName: refSeq.name,\n      uniqueId: refSeq.name,\n      start: refSeq.start,\n      end: refSeq.end,\n    }),\n  )\n  return {\n    type: 'FromConfigAdapter',\n    features,\n  }\n}\n"],"names":["convertTrackConfig","jb1TrackConfig","dataRoot","sequenceAdapter","jb2TrackConfig","trackId","objectHash","name","key","label","description","metadata","Description","category","split","storeClass","urlTemplate","endsWith","trackIdentifier","console","warn","concat","generateUnsupportedTrackConf","jb1Features","features","jb2Features","map","feature","jb2Feature","JSON","parse","stringify","refName","seq_id","uniqueId","start","end","adapter","type","generateFromConfigTrackConfig","resolveUrlTemplate","URL","href","replaceAll","bamLocation","uri","locationType","baiUrlTemplate","index","location","csiUrlTemplate","indexType","_objectSpread","cramLocation","craiLocation","craiUrlTemplate","rootUrlTemplate","defaultRendering","bigWigLocation","vcfGzLocation","tbiUrlTemplate","gffLocation","bigBedLocation","gffGzLocation","bedGzLocation","gtfLocation","fastaLocation","faiLocation","faiUrlTemplate","gziLocation","gziUrlTemplate","twoBitLocation","guessAdapter","undefined","Error","UNSUPPORTED","UNKNOWN","generateUnknownTrackConf","guessTrackType","createRefSeqsAdapter","_x","_createRefSeqsAdapter","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","refSeqs","refSeqsJson","refSeqsData","wrap","_context","prev","next","url","match","abrupt","slice","openLocation","readFile","sent","refSeqAdapterFromConfig","data","stop","refSeq"],"sourceRoot":""}