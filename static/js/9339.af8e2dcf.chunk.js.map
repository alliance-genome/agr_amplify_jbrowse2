{"version":3,"file":"static/js/9339.af8e2dcf.chunk.js","mappings":"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","sources":["../../../packages/core/BaseFeatureWidget/SequenceFeatureDetails/util.ts","../../../packages/core/BaseFeatureWidget/SequenceFeatureDetails/CDNASequence.tsx","../../../packages/core/BaseFeatureWidget/SequenceFeatureDetails/ProteinSequence.tsx","../../../packages/core/BaseFeatureWidget/SequenceFeatureDetails/GenomicSequence.tsx","../../../packages/core/BaseFeatureWidget/SequenceFeatureDetails/CDSSequence.tsx","../../../packages/core/BaseFeatureWidget/SequenceFeatureDetails/SequencePanel.tsx"],"sourcesContent":["// note that these are currently put into the style section instead of being\n// defined in classes to aid copy and paste to an external document e.g. word\nexport const intronColor = undefined\nexport const utrColor = 'rgb(200,240,240)'\nexport const proteinColor = 'rgb(220,160,220)'\nexport const cdsColor = 'rgb(220,220,180)'\nexport const updownstreamColor = 'rgba(250,200,200)'\nexport const genomeColor = 'rgb(200,280,200)'\n","import React from 'react'\nimport { Feat } from '../util'\nimport { cdsColor, intronColor, updownstreamColor, utrColor } from './util'\n\nexport default function CDNASequence({\n  utr,\n  cds,\n  exons,\n  sequence,\n  upstream,\n  downstream,\n  includeIntrons,\n  collapseIntron,\n  intronBp,\n}: {\n  utr: Feat[]\n  cds: Feat[]\n  exons: Feat[]\n  sequence: string\n  upstream?: string\n  downstream?: string\n  includeIntrons?: boolean\n  collapseIntron?: boolean\n  intronBp: number\n}) {\n  const chunks = (\n    cds.length ? [...cds, ...utr].sort((a, b) => a.start - b.start) : exons\n  ).filter(f => f.start !== f.end)\n  return (\n    <>\n      {upstream ? (\n        <span style={{ background: updownstreamColor }}>{upstream}</span>\n      ) : null}\n\n      {chunks.map((chunk, idx) => {\n        const intron = sequence.slice(chunk.end, chunks[idx + 1]?.start)\n\n        return (\n          <React.Fragment key={JSON.stringify(chunk)}>\n            <span\n              style={{\n                background: chunk.type === 'CDS' ? cdsColor : utrColor,\n              }}\n            >\n              {sequence.slice(chunk.start, chunk.end)}\n            </span>\n            {includeIntrons && idx < chunks.length - 1 ? (\n              <span style={{ background: intronColor }}>\n                {collapseIntron && intron.length > intronBp * 2\n                  ? `${intron.slice(0, intronBp)}...${intron.slice(-intronBp)}`\n                  : intron}\n              </span>\n            ) : null}\n          </React.Fragment>\n        )\n      })}\n\n      {downstream ? (\n        <span style={{ background: updownstreamColor }}>{downstream}</span>\n      ) : null}\n    </>\n  )\n}\n","import React from 'react'\nimport { Feat, stitch } from '../util'\nimport { proteinColor } from './util'\n\nexport default function ProteinSequence({\n  cds,\n  sequence,\n  codonTable,\n}: {\n  cds: Feat[]\n  sequence: string\n  codonTable: Record<string, string>\n}) {\n  const str = stitch(cds, sequence)\n  let protein = ''\n  for (let i = 0; i < str.length; i += 3) {\n    // use & symbol for undefined codon, or partial slice\n    protein += codonTable[str.slice(i, i + 3)] || '&'\n  }\n\n  return <span style={{ background: proteinColor }}>{protein}</span>\n}\n","import React from 'react'\nimport { genomeColor, updownstreamColor } from './util'\n\nexport default function GenomicSequence({\n  sequence,\n  upstream,\n  downstream,\n}: {\n  sequence: string\n  upstream?: string\n  downstream?: string\n}) {\n  return (\n    <>\n      {upstream ? (\n        <span style={{ background: updownstreamColor }}>{upstream}</span>\n      ) : null}\n\n      <span style={{ background: genomeColor }}>{sequence}</span>\n\n      {downstream ? (\n        <span style={{ background: updownstreamColor }}>{downstream}</span>\n      ) : null}\n    </>\n  )\n}\n","import React from 'react'\nimport { cdsColor } from './util'\nimport { Feat, stitch } from '../util'\n\nexport default function CDSSequence({\n  cds,\n  sequence,\n}: {\n  cds: Feat[]\n  sequence: string\n}) {\n  return <span style={{ background: cdsColor }}>{stitch(cds, sequence)}</span>\n}\n","import React from 'react'\n\nimport { defaultCodonTable, generateCodonTable, revcom } from '../../util'\nimport {\n  ParentFeat,\n  SeqState,\n  calculateUTRs,\n  calculateUTRs2,\n  dedupe,\n  revlist,\n} from '../util'\nimport CDNASequence from './CDNASequence'\nimport ProteinSequence from './ProteinSequence'\nimport GenomicSequence from './GenomicSequence'\nimport CDSSequence from './CDSSequence'\n\ninterface SeqPanelProps {\n  sequence: SeqState\n  feature: ParentFeat\n  mode: string\n  intronBp?: number\n}\nconst SeqPanel = React.forwardRef<HTMLDivElement, SeqPanelProps>(\n  function SeqPanel2(props, ref) {\n    const { feature, mode, intronBp = 10 } = props\n    let {\n      sequence: { seq, upstream = '', downstream = '' },\n    } = props\n    const { subfeatures = [] } = feature\n\n    const children = subfeatures\n      .sort((a, b) => a.start - b.start)\n      .map(sub => ({\n        ...sub,\n        start: sub.start - feature.start,\n        end: sub.end - feature.start,\n      }))\n\n    // we filter duplicate entries in cds and exon lists duplicate entries may be\n    // rare but was seen in Gencode v36 track NCList, likely a bug on GFF3 or\n    // probably worth ignoring here (produces broken protein translations if\n    // included)\n    //\n    // position 1:224,800,006..225,203,064 gene ENSG00000185842.15 first\n    // transcript ENST00000445597.6\n    //\n    // http://localhost:3000/?config=test_data%2Fconfig.json&session=share-FUl7G1isvF&password=HXh5Y\n\n    let cds = dedupe(children.filter(sub => sub.type === 'CDS'))\n    let utr = dedupe(children.filter(sub => sub.type.match(/utr/i)))\n    let exons = dedupe(children.filter(sub => sub.type === 'exon'))\n\n    if (!utr.length && cds.length && exons.length) {\n      utr = calculateUTRs(cds, exons)\n    }\n    if (!utr.length && cds.length && !exons.length) {\n      utr = calculateUTRs2(cds, {\n        start: 0,\n        end: feature.end - feature.start,\n        type: 'gene',\n      })\n    }\n\n    if (feature.strand === -1) {\n      // doing this in a single assignment is needed because downstream and\n      // upstream are swapped so this avoids a temp variable\n      ;[seq, upstream, downstream] = [\n        revcom(seq),\n        revcom(downstream),\n        revcom(upstream),\n      ]\n      cds = revlist(cds, seq.length)\n      exons = revlist(exons, seq.length)\n      utr = revlist(utr, seq.length)\n    }\n    const codonTable = generateCodonTable(defaultCodonTable)\n\n    return (\n      <div ref={ref} data-testid=\"sequence_panel\">\n        <div\n          style={{\n            /* raw styles instead of className so that html copy works */\n            fontFamily: 'monospace',\n            wordWrap: 'break-word',\n            overflow: 'auto',\n            color: 'black',\n            fontSize: 12,\n            maxWidth: 600,\n            maxHeight: 300,\n          }}\n        >\n          <span style={{ background: 'white' }}>\n            {`>${\n              feature.name ||\n              feature.id ||\n              `${feature.refName}:${feature.start + 1}-${feature.end}`\n            }-${mode}\\n`}\n          </span>\n          <br />\n          {mode === 'genomic' ? (\n            <GenomicSequence sequence={seq} />\n          ) : mode === 'genomic_sequence_updownstream' ? (\n            <GenomicSequence\n              sequence={seq}\n              upstream={upstream}\n              downstream={downstream}\n            />\n          ) : mode === 'cds' ? (\n            <CDSSequence cds={cds} sequence={seq} />\n          ) : mode === 'cdna' ? (\n            <CDNASequence\n              exons={exons}\n              cds={cds}\n              utr={utr}\n              sequence={seq}\n              intronBp={intronBp}\n            />\n          ) : mode === 'protein' ? (\n            <ProteinSequence cds={cds} codonTable={codonTable} sequence={seq} />\n          ) : mode === 'gene' ? (\n            <CDNASequence\n              exons={exons}\n              cds={cds}\n              utr={utr}\n              sequence={seq}\n              includeIntrons\n              intronBp={intronBp}\n            />\n          ) : mode === 'gene_collapsed_intron' ? (\n            <CDNASequence\n              exons={exons}\n              cds={cds}\n              sequence={seq}\n              utr={utr}\n              includeIntrons\n              collapseIntron\n              intronBp={intronBp}\n            />\n          ) : mode === 'gene_updownstream' ? (\n            <CDNASequence\n              exons={exons}\n              cds={cds}\n              sequence={seq}\n              utr={utr}\n              upstream={upstream}\n              downstream={downstream}\n              includeIntrons\n              intronBp={intronBp}\n            />\n          ) : mode === 'gene_updownstream_collapsed_intron' ? (\n            <CDNASequence\n              exons={exons}\n              cds={cds}\n              sequence={seq}\n              utr={utr}\n              upstream={upstream}\n              downstream={downstream}\n              includeIntrons\n              collapseIntron\n              intronBp={intronBp}\n            />\n          ) : (\n            <div>Unknown type</div>\n          )}\n        </div>\n      </div>\n    )\n  },\n)\n\nexport default SeqPanel\n"],"names":["cdsColor","updownstreamColor","CDNASequence","utr","cds","exons","sequence","upstream","downstream","includeIntrons","collapseIntron","intronBp","chunks","length","sort","a","b","start","filter","f","end","React","style","background","map","chunk","idx","intron","slice","key","JSON","stringify","type","undefined","ProteinSequence","codonTable","str","stitch","protein","i","GenomicSequence","CDSSequence","props","ref","feature","mode","seq","subfeatures","children","sub","dedupe","match","calculateUTRs","calculateUTRs2","strand","revcom","revlist","generateCodonTable","defaultCodonTable","fontFamily","wordWrap","overflow","color","fontSize","maxWidth","maxHeight","name","id","refName"],"sourceRoot":""}