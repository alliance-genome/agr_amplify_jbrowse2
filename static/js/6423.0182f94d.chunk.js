"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[6423],{6423:(e,t,n)=>{n.r(t),n.d(t,{default:()=>k});var a=n(66204),r=n(38684),o=n(29520),s=n(80013),i=n(82051),l=n(10126),c=n(46338),d=n(53447),u=n(39780),m=n(70539),h=n(62301),f=n(7146),p=n(80846),b=n(78937),g=n(43800),x=n(43306),Z=n.n(x),v=n(35421),w=n(90872),C=n(24728),S=n(8459);const E=(0,r.ZL)()({dialogContent:{width:"80em"},textAreaFont:{fontFamily:"Courier New"}}),k=(0,p.observer)((function({model:e,handleClose:t}){const{classes:n}=E(),r=(0,w.getSession)(e),[p,x]=(0,a.useState)(),[k,y]=(0,a.useState)(),[W,$]=(0,a.useState)(!1),[R,q]=(0,a.useState)(!1),[G,N]=(0,a.useState)(!1),{leftOffset:A,rightOffset:M}=e,T=Boolean(void 0===k);(0,a.useEffect)((()=>{let t=!0;const n=new AbortController;return(async()=>{try{const a=e.getSelectedRegions(A,M);if(0===a.length)throw new Error("Selected region is out of bounds");const r=await async function(e,t,n){const a=(0,w.getSession)(e),{leftOffset:r,rightOffset:o}=e;if(!r||!o)throw new Error("no offsets on model to use for range");if(r.assemblyName!==o.assemblyName)throw new Error("not able to fetch sequences from multiple assemblies");const{rpcManager:s,assemblyManager:i}=a,l=r.assemblyName||o.assemblyName||"",c=i.get(l);if(!c)throw new Error(`assembly ${l} not found`);const d=(0,g.getConf)(c,["sequence","adapter"]),u="getSequence";return s.call(u,"CoreGetFeatures",{adapterConfig:d,regions:t,sessionId:u,signal:n})}(e,a,n.signal);t&&y(r)}catch(e){console.error(e),t&&x(e)}})(),()=>{n.abort(),t=!1}}),[e,r,A,M]);const j=k?k.filter((e=>!!e)).map((e=>{let t=e.get("seq");const n=e.get("refName"),a=e.get("start")+1,r=e.get("end"),o=`${n}:${a}-${r}`;if(t?.length!==r-a+1)throw new Error(`${o} returned ${t.length.toLocaleString()} bases, but should have returned ${(r-a).toLocaleString()}`);return W&&(t=(0,w.reverse)(t)),G&&(t=(0,w.complement)(t)),{header:o+(W?"-rev":"")+(G?"-comp":""),seq:t}})).map((e=>{return`>${e.header}\n${t=e.seq,t.replaceAll(/(.{1,80})/g,"$1\n").trimEnd()}`;var t})).join("\n"):"",L=!!j&&j.length>1e6;return a.createElement(v.Dialog,{maxWidth:"xl",open:!0,onClose:()=>{t(),e.setOffsets()},title:"Reference sequence"},a.createElement(o.Z,null,p?a.createElement(s.Z,{color:"error"},`${p}`):T?a.createElement(i.Z,null,"Retrieving reference sequence...",a.createElement(l.Z,{style:{marginLeft:10},size:20,disableShrink:!0})):null,a.createElement(c.Z,{"data-testid":"rubberband-sequence",variant:"outlined",multiline:!0,minRows:5,maxRows:10,disabled:L,className:n.dialogContent,fullWidth:!0,value:L?"Reference sequence too large to display, use the download FASTA button":j,InputProps:{readOnly:!0,classes:{input:n.textAreaFont}}}),a.createElement(d.Z,null,a.createElement(u.Z,{control:a.createElement(m.Z,{value:W,onChange:e=>$(e.target.checked)}),label:"Reverse sequence"}),a.createElement(u.Z,{control:a.createElement(m.Z,{value:G,onChange:e=>N(e.target.checked)}),label:"Complement sequence"})),a.createElement(s.Z,{style:{margin:10}},'Note: Check both boxes for the "reverse complement"')),a.createElement(h.Z,null,a.createElement(f.Z,{onClick:()=>{Z()(j),q(!0),setTimeout((()=>q(!1)),500)},disabled:T||!!p||L,color:"primary",startIcon:a.createElement(C.pt,null)},R?"Copied":"Copy to clipboard"),a.createElement(f.Z,{onClick:()=>{(0,b.saveAs)(new Blob([j||""],{type:"text/x-fasta;charset=utf-8"}),"jbrowse_ref_seq.fa")},disabled:T||!!p,color:"primary",startIcon:a.createElement(S.Z,null)},"Download FASTA"),a.createElement(f.Z,{onClick:t,variant:"contained"},"Close")))}))},8459:(e,t,n)=>{var a=n(57739);t.Z=void 0;var r=a(n(53948)),o=n(43188),s=(0,r.default)((0,o.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"GetApp");t.Z=s},82051:(e,t,n)=>{n.d(t,{Z:()=>C});var a=n(55559),r=n(30984),o=n(66204),s=n(56317),i=n(46730),l=n(95201),c=n(58029),d=n(77877),u=n(605),m=n(71684),h=n(43188);const f=["className","component","disableGutters","fixed","maxWidth","classes"],p=(0,m.Z)(),b=(0,u.Z)("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`maxWidth${(0,i.Z)(String(n.maxWidth))}`],n.fixed&&t.fixed,n.disableGutters&&t.disableGutters]}}),g=e=>(0,d.Z)({props:e,name:"MuiContainer",defaultTheme:p});var x=n(40118),Z=n(61125),v=n(57369);const w=function(e={}){const{createStyledComponent:t=b,useThemeProps:n=g,componentName:d="MuiContainer"}=e,u=t((({theme:e,ownerState:t})=>(0,r.Z)({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!t.disableGutters&&{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}})),(({theme:e,ownerState:t})=>t.fixed&&Object.keys(e.breakpoints.values).reduce(((t,n)=>{const a=n,r=e.breakpoints.values[a];return 0!==r&&(t[e.breakpoints.up(a)]={maxWidth:`${r}${e.breakpoints.unit}`}),t}),{})),(({theme:e,ownerState:t})=>(0,r.Z)({},"xs"===t.maxWidth&&{[e.breakpoints.up("xs")]:{maxWidth:Math.max(e.breakpoints.values.xs,444)}},t.maxWidth&&"xs"!==t.maxWidth&&{[e.breakpoints.up(t.maxWidth)]:{maxWidth:`${e.breakpoints.values[t.maxWidth]}${e.breakpoints.unit}`}}))),m=o.forwardRef((function(e,t){const o=n(e),{className:m,component:p="div",disableGutters:b=!1,fixed:g=!1,maxWidth:x="lg"}=o,Z=(0,a.Z)(o,f),v=(0,r.Z)({},o,{component:p,disableGutters:b,fixed:g,maxWidth:x}),w=((e,t)=>{const{classes:n,fixed:a,disableGutters:r,maxWidth:o}=e,s={root:["root",o&&`maxWidth${(0,i.Z)(String(o))}`,a&&"fixed",r&&"disableGutters"]};return(0,c.Z)(s,(e=>(0,l.Z)(t,e)),n)})(v,d);return(0,h.jsx)(u,(0,r.Z)({as:p,ownerState:v,className:(0,s.Z)(w.root,m),ref:t},Z))}));return m}({createStyledComponent:(0,Z.ZP)("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`maxWidth${(0,x.Z)(String(n.maxWidth))}`],n.fixed&&t.fixed,n.disableGutters&&t.disableGutters]}}),useThemeProps:e=>(0,v.Z)({props:e,name:"MuiContainer"})}),C=w}}]);
//# sourceMappingURL=6423.0182f94d.chunk.js.map